
Running comparison for experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805
Directory path: experiments/inpainting/gann_4_night_20180708_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_75.0/images
Optimal number of principal components:  28
Reconstruction error:  13.617154
Energy conservation:  0.75260687
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_75.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [3.933204310299706, 3.122616625208579],
                   'kl_div': 0.34270343,
                   'ks_tests': {10000: KstestResult(statistic=0.1735, pvalue=8.153402218979191e-132, statistic_location=0.006351147, statistic_sign=1),
                                20000: KstestResult(statistic=0.17785000000000006, pvalue=3.5536132041202704e-277, statistic_location=0.0068172896, statistic_sign=1),
                                30000: KstestResult(statistic=0.17666666666666675, pvalue=0.0, statistic_location=0.0064727347, statistic_sign=1),
                                40000: KstestResult(statistic=0.17727499999999996, pvalue=0.0, statistic_location=0.0062732557, statistic_sign=1),
                                50000: KstestResult(statistic=0.17718, pvalue=0.0, statistic_location=0.0064945035, statistic_sign=1),
                                60000: KstestResult(statistic=0.17795000000000005, pvalue=0.0, statistic_location=0.006496919, statistic_sign=1),
                                70000: KstestResult(statistic=0.17775714285714295, pvalue=0.0, statistic_location=0.006375987, statistic_sign=1),
                                80000: KstestResult(statistic=0.17835, pvalue=0.0, statistic_location=0.0067044026, statistic_sign=1),
                                90000: KstestResult(statistic=0.17785555555555554, pvalue=0.0, statistic_location=0.0064869593, statistic_sign=1),
                                100000: KstestResult(statistic=0.17804999999999993, pvalue=0.0, statistic_location=0.006496919, statistic_sign=1),
                                110000: KstestResult(statistic=0.1758727272727273, pvalue=0.0, statistic_location=0.0062732226, statistic_sign=1)},
                   'moments': {'mean_error': 0.089624844,
                               'means': [-1.1889718e-05, -0.00014120444],
                               'stds': [0.017084507, 0.005724251],
                               'variance_ratio': 7.6873765}},
 'originals': {'gan': {'mae': 0.044734325259923935,
                       'mse': 0.00500924838706851,
                       'psnr': 27.33820915222168,
                       'rmse': 0.07077604532241821,
                       'ssim': 0.9471726417541504},
               'pca': {'mae': 0.012110504321753979,
                       'mse': 0.0002775319735519588,
                       'psnr': 39.85746383666992,
                       'rmse': 0.016659291461110115,
                       'ssim': 0.997299075126648}},
 'reconstructions': {'mae': 0.0422346293926239,
                     'mse': 0.004769552499055862,
                     'psnr': 27.50581932067871,
                     'rmse': 0.06906194984912872,
                     'ssim': 0.9490401744842529},
 'residual_spectra_pcagan': {'cosine': [0.34343964,
                                        0.046671513,
                                        0.35853878,
                                        0.38089007,
                                        0.11009173,
                                        0.3820085,
                                        0.38673422,
                                        0.4272165,
                                        0.41434944,
                                        0.43771836,
                                        0.28981212],
                             'mae': [0.010747899,
                                     0.013445543,
                                     0.009009605,
                                     0.0099248905,
                                     0.012080315,
                                     0.008427441,
                                     0.008732222,
                                     0.008629529,
                                     0.008779396,
                                     0.008577374,
                                     0.011291079],
                             'max_mae': 0.013445543,
                             'max_mse': 0.00041909638,
                             'max_rmse': 0.020471843,
                             'median_distance': 1.4567341,
                             'median_mae': 0.009009605,
                             'min_cosine': 0.046671513,
                             'mse': [0.00029238177,
                                     0.00041909638,
                                     0.00021220741,
                                     0.00023995843,
                                     0.00038781163,
                                     0.00018692666,
                                     0.0001646164,
                                     0.00018175709,
                                     0.00020041916,
                                     0.0001733329,
                                     0.00041457653],
                             'rmse': [0.017099174,
                                      0.020471843,
                                      0.014567341,
                                      0.0154905915,
                                      0.019692933,
                                      0.0136721125,
                                      0.012830293,
                                      0.0134817315,
                                      0.014156948,
                                      0.013165595,
                                      0.020361152]},
 'residuals': {'mae': 0.00996775459498167,
               'mse': 0.00026118947425857186,
               'psnr': 21.101953506469727,
               'rmse': 0.0161613579839468,
               'ssds': [32.106564, 3.6065357],
               'ssim': 0.42482277750968933},
 'spectra_pcagan': {'cosine': [0.99313724,
                               0.9993878,
                               0.99795735,
                               0.9909491,
                               0.99258065,
                               0.9975602,
                               0.9970936,
                               0.974709,
                               0.9952419,
                               0.99185556,
                               0.98542666],
                    'mae': [0.02870932,
                            0.021971656,
                            0.036849637,
                            0.023879908,
                            0.021159599,
                            0.038431775,
                            0.030050958,
                            0.19354723,
                            0.022766506,
                            0.020423783,
                            0.026790522],
                    'max_mae': 0.19354723,
                    'max_mse': 0.039538015,
                    'max_rmse': 0.19884168,
                    'median_mae': 0.026790522,
                    'min_cosine': 0.974709,
                    'mse': [0.0015098801,
                            0.0006931768,
                            0.0021719316,
                            0.0010126228,
                            0.00079318037,
                            0.0022500278,
                            0.0014750938,
                            0.039538015,
                            0.00093513937,
                            0.0007303378,
                            0.0013556759],
                    'rmse': [0.038857177,
                             0.02632825,
                             0.046603985,
                             0.031821735,
                             0.028163457,
                             0.047434457,
                             0.03840695,
                             0.19884168,
                             0.03058005,
                             0.027024763,
                             0.036819503]},
 'spectra_realgan': {'cosine': [0.99175334,
                                0.9993863,
                                0.99747366,
                                0.9885625,
                                0.9924071,
                                0.99695754,
                                0.9963519,
                                0.9731585,
                                0.9935512,
                                0.9888125,
                                0.9826634],
                     'mae': [0.0322774,
                             0.021971013,
                             0.03922895,
                             0.027653692,
                             0.021448659,
                             0.040448003,
                             0.033102296,
                             0.19353063,
                             0.027468912,
                             0.024600834,
                             0.030347236],
                     'max_mae': 0.19353063,
                     'max_mse': 0.03980545,
                     'max_rmse': 0.19951303,
                     'median_mae': 0.030347236,
                     'min_cosine': 0.9731585,
                     'mse': [0.0018117565,
                             0.00069365045,
                             0.0024994782,
                             0.0012799335,
                             0.00081188104,
                             0.0025711525,
                             0.0017536068,
                             0.03980545,
                             0.0012606254,
                             0.0009979106,
                             0.0016162811],
                     'rmse': [0.042564735,
                              0.026337245,
                              0.04999478,
                              0.035776157,
                              0.028493525,
                              0.05070653,
                              0.04187609,
                              0.19951303,
                              0.035505287,
                              0.031589724,
                              0.040202998]},
 'spectra_realpca': {'cosine': [0.998524,
                                0.9999991,
                                0.99947935,
                                0.9973239,
                                0.99985516,
                                0.9993365,
                                0.99913037,
                                0.99832195,
                                0.9983588,
                                0.99661446,
                                0.9969157],
                     'mae': [0.014289813,
                             0.00051789236,
                             0.015632367,
                             0.01363663,
                             0.003017865,
                             0.0155633455,
                             0.0153696155,
                             0.014147959,
                             0.014126042,
                             0.0136203,
                             0.013293715],
                     'max_mae': 0.015632367,
                     'max_mse': 0.00039357343,
                     'max_rmse': 0.019838685,
                     'median_mae': 0.014126042,
                     'min_cosine': 0.99661446,
                     'mse': [0.00032567282,
                             4.2951135e-07,
                             0.00039357343,
                             0.00029808687,
                             1.4569146e-05,
                             0.00038750595,
                             0.00037890143,
                             0.00035086364,
                             0.0003196673,
                             0.00029596762,
                             0.00028761406],
                     'rmse': [0.018046407,
                              0.0006553712,
                              0.019838685,
                              0.017265193,
                              0.003816955,
                              0.019685172,
                              0.01946539,
                              0.018731354,
                              0.017879242,
                              0.01720371,
                              0.016959189]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_75.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628
Directory path: experiments/inpainting/gann_4_night_20180708_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_75.0/images
Optimal number of principal components:  28
Reconstruction error:  13.617154
Energy conservation:  0.75260687
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_75.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.079875858281184, 2.9900081864408943],
                   'kl_div': 0.58548343,
                   'ks_tests': {10000: KstestResult(statistic=0.2379, pvalue=1.399386368739167e-248, statistic_location=-0.0066433116, statistic_sign=-1),
                                20000: KstestResult(statistic=0.24165000000000003, pvalue=0.0, statistic_location=-0.0065081697, statistic_sign=-1),
                                30000: KstestResult(statistic=0.24216666666666664, pvalue=0.0, statistic_location=-0.0065187253, statistic_sign=-1),
                                40000: KstestResult(statistic=0.24069999999999997, pvalue=0.0, statistic_location=-0.006414307, statistic_sign=-1),
                                50000: KstestResult(statistic=0.23922000000000002, pvalue=0.0, statistic_location=-0.0061206855, statistic_sign=-1),
                                60000: KstestResult(statistic=0.235, pvalue=0.0, statistic_location=-0.0061009964, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2384, pvalue=0.0, statistic_location=-0.0060610445, statistic_sign=-1),
                                80000: KstestResult(statistic=0.23662500000000003, pvalue=0.0, statistic_location=-0.0056874175, statistic_sign=-1),
                                90000: KstestResult(statistic=0.23812222222222224, pvalue=0.0, statistic_location=-0.006406799, statistic_sign=-1),
                                100000: KstestResult(statistic=0.23368, pvalue=0.0, statistic_location=-0.0061041526, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2349181818181818, pvalue=0.0, statistic_location=-0.006408877, statistic_sign=-1),
                                120000: KstestResult(statistic=0.2381166666666667, pvalue=0.0, statistic_location=-0.006787124, statistic_sign=-1),
                                130000: KstestResult(statistic=0.2367769230769231, pvalue=0.0, statistic_location=-0.006498238, statistic_sign=-1),
                                140000: KstestResult(statistic=0.23582142857142854, pvalue=0.0, statistic_location=-0.006527802, statistic_sign=-1),
                                150000: KstestResult(statistic=0.23684, pvalue=0.0, statistic_location=-0.006560494, statistic_sign=-1),
                                160000: KstestResult(statistic=0.23708125000000002, pvalue=0.0, statistic_location=-0.006540414, statistic_sign=-1),
                                170000: KstestResult(statistic=0.23713529411764706, pvalue=0.0, statistic_location=-0.0065512657, statistic_sign=-1),
                                180000: KstestResult(statistic=0.23634444444444447, pvalue=0.0, statistic_location=-0.0061070453, statistic_sign=-1),
                                190000: KstestResult(statistic=0.2361105263157895, pvalue=0.0, statistic_location=-0.006393112, statistic_sign=-1),
                                200000: KstestResult(statistic=0.23621999999999999, pvalue=0.0, statistic_location=-0.006516522, statistic_sign=-1),
                                210000: KstestResult(statistic=0.23659523809523808, pvalue=0.0, statistic_location=-0.006543383, statistic_sign=-1),
                                220000: KstestResult(statistic=0.23637727272727274, pvalue=0.0, statistic_location=-0.0065295654, statistic_sign=-1)},
                   'moments': {'mean_error': -0.18977258,
                               'means': [-0.0014181881, -7.440022e-05],
                               'stds': [0.01881039, 0.005329335],
                               'variance_ratio': 10.480144}},
 'originals': {'gan': {'mae': 0.04141571745276451,
                       'mse': 0.003690458834171295,
                       'psnr': 29.55628204345703,
                       'rmse': 0.06074914708733559,
                       'ssim': 0.9063165783882141},
               'pca': {'mae': 0.010284173302352428,
                       'mse': 0.00022895849542692304,
                       'psnr': 41.80537414550781,
                       'rmse': 0.015131374821066856,
                       'ssim': 0.9942281246185303}},
 'reconstructions': {'mae': 0.03981654345989227,
                     'mse': 0.0034859897568821907,
                     'psnr': 29.979679107666016,
                     'rmse': 0.059042271226644516,
                     'ssim': 0.9094463586807251},
 'residual_spectra_pcagan': {'cosine': [0.05076048,
                                        0.056526188,
                                        0.3376407,
                                        0.27990454,
                                        0.2984656,
                                        0.4035723,
                                        0.03232699,
                                        0.30697426,
                                        0.36742404,
                                        0.093807764,
                                        0.36543924,
                                        0.32937464,
                                        0.3789181,
                                        0.3150399,
                                        0.33581474,
                                        0.3551596,
                                        0.38033485,
                                        0.3645797,
                                        0.2220769,
                                        0.024821514,
                                        0.3801874,
                                        0.04154204],
                             'mae': [0.014141828,
                                     0.015141442,
                                     0.012486172,
                                     0.013905169,
                                     0.012007193,
                                     0.009919017,
                                     0.01450641,
                                     0.011284024,
                                     0.011887535,
                                     0.01360561,
                                     0.009873036,
                                     0.011190424,
                                     0.010084819,
                                     0.011155253,
                                     0.01186201,
                                     0.011710624,
                                     0.009711053,
                                     0.0113485865,
                                     0.011606919,
                                     0.012810485,
                                     0.009857435,
                                     0.011893309],
                             'max_mae': 0.015141442,
                             'max_mse': 0.0004903616,
                             'max_rmse': 0.022144109,
                             'median_distance': 1.7761648,
                             'median_mae': 0.011786317,
                             'min_cosine': 0.024821514,
                             'mse': [0.0003959071,
                                     0.0004903616,
                                     0.0003905231,
                                     0.00036968125,
                                     0.00031733568,
                                     0.00020089626,
                                     0.00043656092,
                                     0.00031362192,
                                     0.0002968008,
                                     0.00048457555,
                                     0.00021994382,
                                     0.0002679033,
                                     0.000249197,
                                     0.0004102554,
                                     0.00031856337,
                                     0.00033136425,
                                     0.0002472951,
                                     0.00028484385,
                                     0.00024979707,
                                     0.00033037766,
                                     0.0002875798,
                                     0.0003089549],
                             'rmse': [0.019897414,
                                      0.022144109,
                                      0.019761657,
                                      0.019227097,
                                      0.01781392,
                                      0.014173788,
                                      0.02089404,
                                      0.017709374,
                                      0.017227909,
                                      0.022013078,
                                      0.014830503,
                                      0.016367752,
                                      0.015785975,
                                      0.020254763,
                                      0.017848343,
                                      0.018203413,
                                      0.01572562,
                                      0.016877318,
                                      0.01580497,
                                      0.018176295,
                                      0.016958179,
                                      0.017577114]},
 'residuals': {'mae': 0.011908561922609806,
               'mse': 0.0003273791226092726,
               'psnr': 20.121002197265625,
               'rmse': 0.018093621358275414,
               'ssds': [78.28488, 6.2495885],
               'ssim': 0.32829248905181885},
 'spectra_pcagan': {'cosine': [0.9989498,
                               0.9994034,
                               0.98481643,
                               0.9946995,
                               0.99687874,
                               0.99312,
                               0.9991672,
                               0.9968066,
                               0.9848139,
                               0.9885699,
                               0.9966849,
                               0.9948468,
                               0.97822386,
                               0.99189174,
                               0.95973533,
                               0.98005944,
                               0.9894403,
                               0.98115057,
                               0.9889462,
                               0.9993166,
                               0.98519075,
                               0.99743176],
                    'mae': [0.017096018,
                            0.020165402,
                            0.025664715,
                            0.048501927,
                            0.057457667,
                            0.030341046,
                            0.019978909,
                            0.054335527,
                            0.032376934,
                            0.026085498,
                            0.047087222,
                            0.04294657,
                            0.17963105,
                            0.030730737,
                            0.057671417,
                            0.032933503,
                            0.025505545,
                            0.04037452,
                            0.02666256,
                            0.017710792,
                            0.022572918,
                            0.020133352],
                    'max_mae': 0.17963105,
                    'max_mse': 0.034946203,
                    'max_rmse': 0.18693903,
                    'median_mae': 0.030535892,
                    'min_cosine': 0.95973533,
                    'mse': [0.0004702475,
                            0.00059232657,
                            0.0011244762,
                            0.0036615124,
                            0.0054806927,
                            0.0015528126,
                            0.0006228537,
                            0.0043205544,
                            0.0017380739,
                            0.0011626846,
                            0.0032796478,
                            0.0029119623,
                            0.034946203,
                            0.0018012234,
                            0.004264915,
                            0.0018785995,
                            0.001131595,
                            0.0024739087,
                            0.0011585548,
                            0.0004767456,
                            0.00096840627,
                            0.0006737787],
                    'rmse': [0.02168519,
                             0.024337761,
                             0.03353321,
                             0.06051043,
                             0.0740317,
                             0.039405745,
                             0.024957037,
                             0.06573092,
                             0.04169021,
                             0.034098163,
                             0.05726821,
                             0.0539626,
                             0.18693903,
                             0.04244082,
                             0.06530631,
                             0.043342814,
                             0.03363919,
                             0.049738403,
                             0.03403755,
                             0.021834504,
                             0.031119227,
                             0.025957247]},
 'spectra_realgan': {'cosine': [0.99894327,
                                0.99940234,
                                0.981453,
                                0.9941538,
                                0.99652416,
                                0.9916951,
                                0.99916625,
                                0.99628115,
                                0.9822148,
                                0.9884819,
                                0.99601847,
                                0.99405795,
                                0.97664857,
                                0.9902268,
                                0.95711,
                                0.9767986,
                                0.98647815,
                                0.9784224,
                                0.98825794,
                                0.9993156,
                                0.9809228,
                                0.99741125],
                     'mae': [0.017146071,
                             0.020168338,
                             0.02870621,
                             0.05080038,
                             0.059404433,
                             0.03350953,
                             0.019985916,
                             0.055692006,
                             0.035312057,
                             0.02621586,
                             0.048675224,
                             0.044680156,
                             0.1796594,
                             0.034048,
                             0.05834629,
                             0.035970148,
                             0.02896034,
                             0.04211719,
                             0.027531927,
                             0.017711481,
                             0.026319299,
                             0.020185547],
                     'max_mae': 0.1796594,
                     'max_mse': 0.035222784,
                     'max_rmse': 0.18767734,
                     'median_mae': 0.033778764,
                     'min_cosine': 0.95711,
                     'mse': [0.00047266582,
                             0.00059270475,
                             0.0013652451,
                             0.004039467,
                             0.005812719,
                             0.0018575712,
                             0.0006232369,
                             0.0046497514,
                             0.0020181763,
                             0.0011730577,
                             0.0036266036,
                             0.0031747727,
                             0.035222784,
                             0.0021111225,
                             0.004506631,
                             0.0021810557,
                             0.0014073144,
                             0.002753931,
                             0.0012253441,
                             0.0004769699,
                             0.0012224698,
                             0.0006764925],
                     'rmse': [0.02174088,
                              0.024345528,
                              0.036949225,
                              0.0635568,
                              0.07624119,
                              0.04309955,
                              0.024964713,
                              0.068189085,
                              0.044924118,
                              0.03424993,
                              0.06022129,
                              0.05634512,
                              0.18767734,
                              0.045946952,
                              0.067131445,
                              0.046701774,
                              0.03751419,
                              0.05247791,
                              0.035004918,
                              0.021839641,
                              0.034963835,
                              0.02600947]},
 'spectra_realpca': {'cosine': [0.99999577,
                                0.9999996,
                                0.9969421,
                                0.99941164,
                                0.9996319,
                                0.998524,
                                0.9999991,
                                0.99947935,
                                0.9973239,
                                0.99985516,
                                0.9993365,
                                0.99913037,
                                0.99832195,
                                0.9983588,
                                0.99661446,
                                0.9969157,
                                0.99694353,
                                0.9971789,
                                0.9995171,
                                0.9999993,
                                0.9957694,
                                0.9999861],
                     'mae': [0.0010454402,
                             0.00044841852,
                             0.011764755,
                             0.01591812,
                             0.016939634,
                             0.014289813,
                             0.00051789236,
                             0.015632367,
                             0.01363663,
                             0.003017865,
                             0.0155633455,
                             0.0153696155,
                             0.014147959,
                             0.014126042,
                             0.0136203,
                             0.013293715,
                             0.013524008,
                             0.013737186,
                             0.0052760025,
                             0.00045296966,
                             0.012522697,
                             0.0014070444],
                     'max_mae': 0.016939634,
                     'max_mse': 0.00046133078,
                     'max_rmse': 0.021478612,
                     'median_mae': 0.013572155,
                     'min_cosine': 0.9957694,
                     'mse': [1.7398515e-06,
                             3.2170183e-07,
                             0.00022204642,
                             0.00040721294,
                             0.00046133078,
                             0.00032567282,
                             4.2951135e-07,
                             0.00039357343,
                             0.00029808687,
                             1.4569146e-05,
                             0.00038750595,
                             0.00037890143,
                             0.00035086364,
                             0.0003196673,
                             0.00029596762,
                             0.00028761406,
                             0.00029219373,
                             0.0002987152,
                             4.476863e-05,
                             3.321907e-07,
                             0.00025240667,
                             3.1674235e-06],
                     'rmse': [0.0013190344,
                              0.0005671877,
                              0.014901223,
                              0.020179518,
                              0.021478612,
                              0.018046407,
                              0.0006553712,
                              0.019838685,
                              0.017265193,
                              0.003816955,
                              0.019685172,
                              0.01946539,
                              0.018731354,
                              0.017879242,
                              0.01720371,
                              0.016959189,
                              0.017093675,
                              0.01728338,
                              0.006690936,
                              0.00057635986,
                              0.01588731,
                              0.0017797257]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_75.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354
Directory path: experiments/inpainting/gann_4_night_20180708_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_75.0/images
Optimal number of principal components:  28
Reconstruction error:  13.617154
Energy conservation:  0.75260687
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_75.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.061857105227111, 2.8471967918420797],
                   'kl_div': 0.69273925,
                   'ks_tests': {10000: KstestResult(statistic=0.2485, pvalue=1.9840091278927288e-271, statistic_location=-0.0059606703, statistic_sign=-1),
                                20000: KstestResult(statistic=0.23964999999999997, pvalue=0.0, statistic_location=-0.0049640355, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2399666666666667, pvalue=0.0, statistic_location=-0.0050826883, statistic_sign=-1),
                                40000: KstestResult(statistic=0.24552499999999997, pvalue=0.0, statistic_location=-0.0047269017, statistic_sign=-1),
                                50000: KstestResult(statistic=0.24146, pvalue=0.0, statistic_location=-0.0050350437, statistic_sign=-1),
                                60000: KstestResult(statistic=0.24078333333333335, pvalue=0.0, statistic_location=-0.0055014226, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2387571428571429, pvalue=0.0, statistic_location=-0.005395688, statistic_sign=-1),
                                80000: KstestResult(statistic=0.2387875, pvalue=0.0, statistic_location=-0.005352242, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2437888888888889, pvalue=0.0, statistic_location=-0.0048547983, statistic_sign=-1),
                                100000: KstestResult(statistic=0.24192999999999998, pvalue=0.0, statistic_location=-0.0046635373, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2399818181818182, pvalue=0.0, statistic_location=-0.0053084716, statistic_sign=-1),
                                120000: KstestResult(statistic=0.24034166666666668, pvalue=0.0, statistic_location=-0.0050470177, statistic_sign=-1),
                                130000: KstestResult(statistic=0.24316923076923075, pvalue=0.0, statistic_location=-0.005232877, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2402142857142857, pvalue=0.0, statistic_location=-0.0053133927, statistic_sign=-1),
                                150000: KstestResult(statistic=0.238, pvalue=0.0, statistic_location=-0.005427275, statistic_sign=-1),
                                160000: KstestResult(statistic=0.24004375, pvalue=0.0, statistic_location=-0.005399592, statistic_sign=-1),
                                170000: KstestResult(statistic=0.23970000000000002, pvalue=0.0, statistic_location=-0.004877165, statistic_sign=-1),
                                180000: KstestResult(statistic=0.24107222222222222, pvalue=0.0, statistic_location=-0.004854815, statistic_sign=-1),
                                190000: KstestResult(statistic=0.24034736842105264, pvalue=0.0, statistic_location=-0.004851954, statistic_sign=-1),
                                200000: KstestResult(statistic=0.239585, pvalue=0.0, statistic_location=-0.004413383, statistic_sign=-1),
                                210000: KstestResult(statistic=0.2395952380952381, pvalue=0.0, statistic_location=-0.0048547694, statistic_sign=-1),
                                220000: KstestResult(statistic=0.2395363636363636, pvalue=0.0, statistic_location=-0.00545159, statistic_sign=-1),
                                230000: KstestResult(statistic=0.24091304347826087, pvalue=0.0, statistic_location=-0.0050775595, statistic_sign=-1),
                                240000: KstestResult(statistic=0.23947916666666663, pvalue=0.0, statistic_location=-0.0053096227, statistic_sign=-1),
                                250000: KstestResult(statistic=0.241048, pvalue=0.0, statistic_location=-0.0052558146, statistic_sign=-1),
                                260000: KstestResult(statistic=0.23995, pvalue=0.0, statistic_location=-0.004876515, statistic_sign=-1),
                                270000: KstestResult(statistic=0.24049259259259256, pvalue=0.0, statistic_location=-0.005452752, statistic_sign=-1),
                                280000: KstestResult(statistic=0.24204285714285712, pvalue=0.0, statistic_location=-0.0053223744, statistic_sign=-1),
                                290000: KstestResult(statistic=0.23996206896551725, pvalue=0.0, statistic_location=-0.005451277, statistic_sign=-1),
                                300000: KstestResult(statistic=0.24031, pvalue=0.0, statistic_location=-0.005034426, statistic_sign=-1),
                                310000: KstestResult(statistic=0.24013225806451616, pvalue=0.0, statistic_location=-0.004860492, statistic_sign=-1),
                                320000: KstestResult(statistic=0.242525, pvalue=0.0, statistic_location=-0.0053111315, statistic_sign=-1),
                                330000: KstestResult(statistic=0.24035757575757577, pvalue=0.0, statistic_location=-0.005452957, statistic_sign=-1)},
                   'moments': {'mean_error': -0.05395061,
                               'means': [-0.0005078844, -4.2648167e-05],
                               'stds': [0.017889043, 0.004895093],
                               'variance_ratio': 11.956012}},
 'originals': {'gan': {'mae': 0.03434794396162033,
                       'mse': 0.0026877601630985737,
                       'psnr': 30.955209732055664,
                       'rmse': 0.051843613386154175,
                       'ssim': 0.9331126809120178},
               'pca': {'mae': 0.008434087969362736,
                       'mse': 0.00017584272427484393,
                       'psnr': 43.03314971923828,
                       'rmse': 0.013260570354759693,
                       'ssim': 0.9960013628005981}},
 'reconstructions': {'mae': 0.03292309492826462,
                     'mse': 0.002527737058699131,
                     'psnr': 31.457077026367188,
                     'rmse': 0.050276607275009155,
                     'ssim': 0.935370922088623},
 'residual_spectra_pcagan': {'cosine': [0.10141276,
                                        0.07995924,
                                        0.4344129,
                                        0.18138933,
                                        0.42091185,
                                        0.076180585,
                                        0.04715041,
                                        0.051650733,
                                        0.3443881,
                                        0.27615032,
                                        0.31015775,
                                        0.41610613,
                                        0.033350334,
                                        0.3121244,
                                        0.39145264,
                                        0.10469359,
                                        0.38093546,
                                        0.33184516,
                                        0.38372797,
                                        0.32549056,
                                        0.3499056,
                                        0.36746642,
                                        0.39524087,
                                        0.38068342,
                                        0.22572047,
                                        0.023424609,
                                        0.38516027,
                                        0.040793978,
                                        0.4508836,
                                        0.09727651,
                                        0.255764,
                                        0.0780246,
                                        0.020420434],
                             'mae': [0.010779707,
                                     0.011632769,
                                     0.008926962,
                                     0.011777825,
                                     0.009735672,
                                     0.014429675,
                                     0.014279038,
                                     0.015044552,
                                     0.012332141,
                                     0.013912978,
                                     0.011615319,
                                     0.009594282,
                                     0.014325142,
                                     0.011135904,
                                     0.011323369,
                                     0.013084414,
                                     0.0094709415,
                                     0.011061583,
                                     0.0098310765,
                                     0.010862136,
                                     0.011592165,
                                     0.01143389,
                                     0.009481602,
                                     0.011080272,
                                     0.011519583,
                                     0.0126091,
                                     0.0096767275,
                                     0.011954573,
                                     0.009587103,
                                     0.010864833,
                                     0.0099608535,
                                     0.011550511,
                                     0.013450536],
                             'max_mae': 0.015044552,
                             'max_mse': 0.00047184524,
                             'max_rmse': 0.021721998,
                             'median_distance': 1.6700507,
                             'median_mae': 0.01143389,
                             'min_cosine': 0.020420434,
                             'mse': [0.0002175075,
                                     0.00025484926,
                                     0.00017957715,
                                     0.00034720174,
                                     0.00018841123,
                                     0.00043037685,
                                     0.00040655147,
                                     0.00047184524,
                                     0.00037627463,
                                     0.00037661352,
                                     0.00029726178,
                                     0.00019066398,
                                     0.00042029528,
                                     0.00030176388,
                                     0.00025368962,
                                     0.00041241912,
                                     0.00019589493,
                                     0.00026773577,
                                     0.00023543532,
                                     0.00037705482,
                                     0.0002937281,
                                     0.00031864888,
                                     0.00022542069,
                                     0.00026091008,
                                     0.00024203464,
                                     0.00032348925,
                                     0.00027856472,
                                     0.0003213882,
                                     0.0002216913,
                                     0.00021619187,
                                     0.0002182454,
                                     0.00027890693,
                                     0.0003651184],
                             'rmse': [0.014748136,
                                      0.015964,
                                      0.01340064,
                                      0.01863335,
                                      0.013726297,
                                      0.020745525,
                                      0.02016312,
                                      0.021721998,
                                      0.019397799,
                                      0.019406533,
                                      0.01724128,
                                      0.013808113,
                                      0.020501105,
                                      0.017371353,
                                      0.015927637,
                                      0.020308105,
                                      0.013996247,
                                      0.016362634,
                                      0.015343902,
                                      0.019417899,
                                      0.017138498,
                                      0.017850738,
                                      0.015014016,
                                      0.016152712,
                                      0.015557462,
                                      0.017985808,
                                      0.016690258,
                                      0.017927302,
                                      0.014889302,
                                      0.014703465,
                                      0.014773131,
                                      0.016700506,
                                      0.019108072]},
 'residuals': {'mae': 0.011512641794979572,
               'mse': 0.0002959322009701282,
               'psnr': 20.559589385986328,
               'rmse': 0.017202680930495262,
               'ssds': [105.69071, 7.9080133],
               'ssim': 0.32863250374794006},
 'spectra_pcagan': {'cosine': [0.997284,
                               0.9992278,
                               0.9868541,
                               0.9945576,
                               0.98621106,
                               0.99849707,
                               0.9989302,
                               0.9994096,
                               0.98467165,
                               0.9946485,
                               0.9968978,
                               0.99316233,
                               0.9991758,
                               0.9968112,
                               0.9851404,
                               0.9890504,
                               0.9967479,
                               0.99484116,
                               0.9781726,
                               0.9921314,
                               0.9602203,
                               0.9807013,
                               0.9896378,
                               0.9813123,
                               0.98891073,
                               0.9993127,
                               0.98501635,
                               0.99738646,
                               0.98850673,
                               0.9954228,
                               0.99554604,
                               0.9983572,
                               0.9996885],
                    'mae': [0.018427186,
                            0.014915045,
                            0.020897085,
                            0.020407917,
                            0.021233693,
                            0.018244023,
                            0.017292844,
                            0.019900711,
                            0.02576438,
                            0.04861495,
                            0.05724742,
                            0.030184008,
                            0.019976696,
                            0.05362447,
                            0.03206611,
                            0.025645206,
                            0.046804674,
                            0.043390572,
                            0.1802309,
                            0.029937955,
                            0.057360496,
                            0.032406062,
                            0.025179379,
                            0.0404874,
                            0.026733335,
                            0.017824603,
                            0.022513377,
                            0.0201264,
                            0.021399233,
                            0.020527683,
                            0.021403065,
                            0.018876232,
                            0.01681902],
                    'max_mae': 0.1802309,
                    'max_mse': 0.035179466,
                    'max_rmse': 0.1875619,
                    'median_mae': 0.022513377,
                    'min_cosine': 0.9602203,
                    'mse': [0.0005516573,
                            0.00035572614,
                            0.0007487782,
                            0.00071551884,
                            0.0007776213,
                            0.00057012145,
                            0.0004826454,
                            0.00057855085,
                            0.0011312895,
                            0.0036951043,
                            0.005437287,
                            0.0015399127,
                            0.0006217344,
                            0.0042373664,
                            0.0017005728,
                            0.001108295,
                            0.0032398289,
                            0.0029415337,
                            0.035179466,
                            0.0017276339,
                            0.0042158244,
                            0.0018144451,
                            0.0011006271,
                            0.0024538601,
                            0.0011644302,
                            0.00048147936,
                            0.00097538217,
                            0.00067927496,
                            0.0007679079,
                            0.0006800095,
                            0.00075473177,
                            0.00057454064,
                            0.00041214627],
                    'rmse': [0.023487385,
                             0.018860703,
                             0.027363813,
                             0.026749184,
                             0.027885862,
                             0.023877217,
                             0.021969192,
                             0.024053084,
                             0.033634648,
                             0.06078737,
                             0.073737964,
                             0.03924172,
                             0.024934603,
                             0.06509506,
                             0.041238002,
                             0.033291064,
                             0.056919493,
                             0.05423591,
                             0.1875619,
                             0.041564815,
                             0.06492938,
                             0.042596303,
                             0.0331757,
                             0.04953645,
                             0.03412375,
                             0.021942638,
                             0.031231109,
                             0.026062904,
                             0.027711151,
                             0.026076991,
                             0.027472382,
                             0.023969578,
                             0.020301387]},
 'spectra_realgan': {'cosine': [0.9972508,
                                0.99922156,
                                0.98322415,
                                0.99424064,
                                0.98270684,
                                0.99848765,
                                0.9989239,
                                0.99940866,
                                0.981297,
                                0.99410677,
                                0.996538,
                                0.991725,
                                0.99917454,
                                0.9962871,
                                0.98253864,
                                0.9889617,
                                0.9960905,
                                0.9940449,
                                0.9766166,
                                0.99047923,
                                0.9575873,
                                0.9774089,
                                0.98670185,
                                0.97857773,
                                0.98822314,
                                0.99931175,
                                0.9807604,
                                0.99736637,
                                0.98409027,
                                0.9953629,
                                0.99517846,
                                0.9983457,
                                0.9996883],
                     'mae': [0.018541973,
                             0.014985775,
                             0.02386623,
                             0.021071842,
                             0.024249297,
                             0.018311137,
                             0.017341804,
                             0.019904897,
                             0.028784147,
                             0.050913088,
                             0.059168056,
                             0.033459667,
                             0.019981585,
                             0.055011425,
                             0.034977544,
                             0.025771717,
                             0.04837447,
                             0.045064226,
                             0.18023518,
                             0.033359118,
                             0.05806257,
                             0.035551503,
                             0.02864438,
                             0.042166773,
                             0.02758376,
                             0.01782493,
                             0.026277808,
                             0.020177415,
                             0.025291367,
                             0.020647034,
                             0.02213609,
                             0.018928431,
                             0.016816901],
                     'max_mae': 0.18023518,
                     'max_mse': 0.03544975,
                     'max_rmse': 0.18828104,
                     'median_mae': 0.025771717,
                     'min_cosine': 0.9575873,
                     'mse': [0.0005579767,
                             0.00035868282,
                             0.00095437805,
                             0.0007570531,
                             0.0009759412,
                             0.00057374855,
                             0.00048503466,
                             0.0005789531,
                             0.0013730446,
                             0.004070552,
                             0.005776141,
                             0.0018476726,
                             0.0006221676,
                             0.004566814,
                             0.001981098,
                             0.0011185799,
                             0.0035820676,
                             0.0032059592,
                             0.03544975,
                             0.0020360264,
                             0.0044579804,
                             0.002119876,
                             0.0013743711,
                             0.002734498,
                             0.0012311827,
                             0.00048168044,
                             0.0012288567,
                             0.00068194215,
                             0.0010366916,
                             0.0006882513,
                             0.0008001519,
                             0.000576772,
                             0.00041220107],
                     'rmse': [0.023621531,
                              0.018938923,
                              0.03089301,
                              0.027514597,
                              0.031240057,
                              0.023953049,
                              0.022023503,
                              0.024061445,
                              0.037054617,
                              0.06380088,
                              0.07600093,
                              0.042984564,
                              0.024943288,
                              0.067578204,
                              0.044509526,
                              0.033445176,
                              0.059850376,
                              0.05662119,
                              0.18828104,
                              0.04512235,
                              0.06676811,
                              0.04604211,
                              0.037072513,
                              0.052292425,
                              0.035088215,
                              0.02194722,
                              0.035055052,
                              0.026114022,
                              0.032197695,
                              0.026234543,
                              0.028286956,
                              0.024016079,
                              0.020302735]},
 'spectra_realpca': {'cosine': [0.9999804,
                                0.9999973,
                                0.9963215,
                                0.99971956,
                                0.9962664,
                                0.999995,
                                0.99999577,
                                0.9999996,
                                0.9969421,
                                0.99941164,
                                0.9996319,
                                0.998524,
                                0.9999991,
                                0.99947935,
                                0.9973239,
                                0.99985516,
                                0.9993365,
                                0.99913037,
                                0.99832195,
                                0.9983588,
                                0.99661446,
                                0.9969157,
                                0.99694353,
                                0.9971789,
                                0.9995171,
                                0.9999993,
                                0.9957694,
                                0.9999861,
                                0.9957167,
                                0.9999574,
                                0.9996655,
                                0.9999942,
                                0.9999999],
                     'mae': [0.001565924,
                             0.000861088,
                             0.011316796,
                             0.0047977017,
                             0.01142036,
                             0.0010585892,
                             0.0010454402,
                             0.00044841852,
                             0.011764755,
                             0.01591812,
                             0.016939634,
                             0.014289813,
                             0.00051789236,
                             0.015632367,
                             0.01363663,
                             0.003017865,
                             0.0155633455,
                             0.0153696155,
                             0.014147959,
                             0.014126042,
                             0.0136203,
                             0.013293715,
                             0.013524008,
                             0.013737186,
                             0.0052760025,
                             0.00045296966,
                             0.012522697,
                             0.0014070444,
                             0.012601127,
                             0.0019766646,
                             0.0051890234,
                             0.0010082165,
                             0.00027755913],
                     'max_mae': 0.016939634,
                     'max_mse': 0.00046133078,
                     'max_rmse': 0.021478612,
                     'median_mae': 0.01142036,
                     'min_cosine': 0.9957167,
                     'mse': [3.943768e-06,
                             1.185524e-06,
                             0.00020562811,
                             3.677975e-05,
                             0.000208655,
                             1.7861478e-06,
                             1.7398515e-06,
                             3.2170183e-07,
                             0.00022204642,
                             0.00040721294,
                             0.00046133078,
                             0.00032567282,
                             4.2951135e-07,
                             0.00039357343,
                             0.00029808687,
                             1.4569146e-05,
                             0.00038750595,
                             0.00037890143,
                             0.00035086364,
                             0.0003196673,
                             0.00029596762,
                             0.00028761406,
                             0.00029219373,
                             0.0002987152,
                             4.476863e-05,
                             3.321907e-07,
                             0.00025240667,
                             3.1674235e-06,
                             0.00025654663,
                             6.314423e-06,
                             4.3117278e-05,
                             1.6410418e-06,
                             1.245496e-07],
                     'rmse': [0.0019858922,
                              0.0010888177,
                              0.0143397385,
                              0.006064631,
                              0.014444895,
                              0.0013364684,
                              0.0013190344,
                              0.0005671877,
                              0.014901223,
                              0.020179518,
                              0.021478612,
                              0.018046407,
                              0.0006553712,
                              0.019838685,
                              0.017265193,
                              0.003816955,
                              0.019685172,
                              0.01946539,
                              0.018731354,
                              0.017879242,
                              0.01720371,
                              0.016959189,
                              0.017093675,
                              0.01728338,
                              0.006690936,
                              0.00057635986,
                              0.01588731,
                              0.0017797257,
                              0.016017074,
                              0.0025128515,
                              0.0065663746,
                              0.0012810315,
                              0.00035291584]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_75.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516
Directory path: experiments/inpainting/gann_4_night_20180722_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_75.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_75.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.35918432275619, 3.1215890132546327],
                   'kl_div': 0.8423621,
                   'ks_tests': {10000: KstestResult(statistic=0.2934, pvalue=1e-323, statistic_location=0.008742152, statistic_sign=1),
                                20000: KstestResult(statistic=0.3052, pvalue=0.0, statistic_location=0.008706387, statistic_sign=1),
                                30000: KstestResult(statistic=0.30166666666666664, pvalue=0.0, statistic_location=0.008422637, statistic_sign=1),
                                40000: KstestResult(statistic=0.30325, pvalue=0.0, statistic_location=0.008790506, statistic_sign=1),
                                50000: KstestResult(statistic=0.30158000000000007, pvalue=0.0, statistic_location=0.008701702, statistic_sign=1),
                                60000: KstestResult(statistic=0.3030333333333334, pvalue=0.0, statistic_location=0.008377151, statistic_sign=1),
                                70000: KstestResult(statistic=0.30489999999999995, pvalue=0.0, statistic_location=0.0087550245, statistic_sign=1),
                                80000: KstestResult(statistic=0.30038750000000003, pvalue=0.0, statistic_location=0.0087554315, statistic_sign=1),
                                90000: KstestResult(statistic=0.3035888888888889, pvalue=0.0, statistic_location=0.008098444, statistic_sign=1),
                                100000: KstestResult(statistic=0.30306, pvalue=0.0, statistic_location=0.008359695, statistic_sign=1),
                                110000: KstestResult(statistic=0.30474545454545454, pvalue=0.0, statistic_location=0.008698792, statistic_sign=1)},
                   'moments': {'mean_error': 0.08277822,
                               'means': [-0.00073593855, -0.00044577167],
                               'stds': [0.022726193, 0.005489738],
                               'variance_ratio': 8.24979}},
 'originals': {'gan': {'mae': 0.05885758250951767,
                       'mse': 0.005448393989354372,
                       'psnr': 27.10418128967285,
                       'rmse': 0.07381323724985123,
                       'ssim': 0.603545069694519},
               'pca': {'mae': 0.012983637861907482,
                       'mse': 0.0002722899953369051,
                       'psnr': 40.598304748535156,
                       'rmse': 0.016501212492585182,
                       'ssim': 0.9844791293144226}},
 'reconstructions': {'mae': 0.057177815586328506,
                     'mse': 0.005125264637172222,
                     'psnr': 27.851459503173828,
                     'rmse': 0.07159095257520676,
                     'ssim': 0.6051655411720276},
 'residual_spectra_pcagan': {'cosine': [0.26564148,
                                        0.23854306,
                                        0.23416865,
                                        0.26053408,
                                        0.25381,
                                        0.33885944,
                                        0.29297134,
                                        0.24404314,
                                        0.2251663,
                                        0.22150944,
                                        0.2624583],
                             'mae': [0.014994153,
                                     0.017118374,
                                     0.017104134,
                                     0.016188318,
                                     0.014930034,
                                     0.014704486,
                                     0.013270199,
                                     0.018236991,
                                     0.020036701,
                                     0.018978633,
                                     0.016830673],
                             'max_mae': 0.020036701,
                             'max_mse': 0.0006272451,
                             'max_rmse': 0.025044862,
                             'median_distance': 2.189767,
                             'median_mae': 0.016830673,
                             'min_cosine': 0.22150944,
                             'mse': [0.0003872383,
                                     0.0006108163,
                                     0.0005075031,
                                     0.00041695996,
                                     0.00047950787,
                                     0.00036319596,
                                     0.0003557844,
                                     0.0005323883,
                                     0.0006272451,
                                     0.0005663711,
                                     0.0004724926],
                             'rmse': [0.019678371,
                                      0.024714697,
                                      0.022527829,
                                      0.020419598,
                                      0.021897668,
                                      0.0190577,
                                      0.018862247,
                                      0.023073541,
                                      0.025044862,
                                      0.023798551,
                                      0.021736896]},
 'residuals': {'mae': 0.016581155359745026,
               'mse': 0.0004835911968257278,
               'psnr': 8.197175025939941,
               'rmse': 0.021990707144141197,
               'ssds': [56.87184, 3.3369234],
               'ssim': 0.12163029611110687},
 'spectra_pcagan': {'cosine': [0.99116933,
                               0.9842978,
                               0.96088547,
                               0.95188564,
                               0.95586,
                               0.972211,
                               0.975154,
                               0.93962836,
                               0.9159561,
                               0.91690403,
                               0.9272211],
                    'mae': [0.071225174,
                            0.07258539,
                            0.06246844,
                            0.06437354,
                            0.045106705,
                            0.042673133,
                            0.03895635,
                            0.054263283,
                            0.06242841,
                            0.059908032,
                            0.05496742],
                    'max_mae': 0.07258539,
                    'max_mse': 0.007976555,
                    'max_rmse': 0.08931156,
                    'median_mae': 0.059908032,
                    'min_cosine': 0.9159561,
                    'mse': [0.0075000906,
                            0.007976555,
                            0.005692697,
                            0.006373456,
                            0.0031035342,
                            0.0027325316,
                            0.0024625135,
                            0.004419792,
                            0.0059709065,
                            0.005377533,
                            0.004768304],
                    'rmse': [0.08660306,
                             0.08931156,
                             0.075449966,
                             0.07983393,
                             0.055709373,
                             0.052273624,
                             0.04962372,
                             0.066481516,
                             0.07727164,
                             0.07333166,
                             0.069052905]},
 'spectra_realgan': {'cosine': [0.99050224,
                                0.98320454,
                                0.958425,
                                0.9485156,
                                0.95228004,
                                0.96986884,
                                0.97265184,
                                0.9365318,
                                0.912984,
                                0.91408354,
                                0.92231876],
                     'mae': [0.073525995,
                             0.07423982,
                             0.06392931,
                             0.066407725,
                             0.046533234,
                             0.044256676,
                             0.041072655,
                             0.05594315,
                             0.06368616,
                             0.06099438,
                             0.056844275],
                     'max_mae': 0.07423982,
                     'max_mse': 0.00842498,
                     'max_rmse': 0.09178769,
                     'median_mae': 0.06099438,
                     'min_cosine': 0.912984,
                     'mse': [0.008046477,
                             0.00842498,
                             0.0059988564,
                             0.0067990287,
                             0.0033501007,
                             0.0030101966,
                             0.0027172633,
                             0.004679983,
                             0.006192801,
                             0.005587246,
                             0.0051254076],
                     'rmse': [0.08970216,
                              0.09178769,
                              0.07745229,
                              0.08245622,
                              0.057880055,
                              0.05486526,
                              0.052127376,
                              0.068410404,
                              0.07869435,
                              0.07474788,
                              0.07159195]},
 'spectra_realpca': {'cosine': [0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349],
                     'mae': [0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197],
                     'max_mae': 0.015567541,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.012521197,
                     'min_cosine': 0.9963109,
                     'mse': [0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102],
                     'rmse': [0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_75.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115
Directory path: experiments/inpainting/gann_4_night_20180722_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_75.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_75.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.22363691969865, 3.112562869251242],
                   'kl_div': 0.6277143,
                   'ks_tests': {10000: KstestResult(statistic=0.2542, pvalue=3.81479491631945e-284, statistic_location=0.008550624, statistic_sign=1),
                                20000: KstestResult(statistic=0.25669999999999993, pvalue=0.0, statistic_location=0.008502156, statistic_sign=1),
                                30000: KstestResult(statistic=0.25393333333333323, pvalue=0.0, statistic_location=0.008268139, statistic_sign=1),
                                40000: KstestResult(statistic=0.253475, pvalue=0.0, statistic_location=0.00812634, statistic_sign=1),
                                50000: KstestResult(statistic=0.2539800000000001, pvalue=0.0, statistic_location=0.008342601, statistic_sign=1),
                                60000: KstestResult(statistic=0.25158333333333327, pvalue=0.0, statistic_location=0.008360098, statistic_sign=1),
                                70000: KstestResult(statistic=0.2531, pvalue=0.0, statistic_location=0.008613158, statistic_sign=1),
                                80000: KstestResult(statistic=0.25388749999999993, pvalue=0.0, statistic_location=0.008355305, statistic_sign=1),
                                90000: KstestResult(statistic=0.2528, pvalue=0.0, statistic_location=0.008110162, statistic_sign=1),
                                100000: KstestResult(statistic=0.25197, pvalue=0.0, statistic_location=0.008010646, statistic_sign=1),
                                110000: KstestResult(statistic=0.2538090909090909, pvalue=0.0, statistic_location=0.008445602, statistic_sign=1),
                                120000: KstestResult(statistic=0.25185, pvalue=0.0, statistic_location=0.008458698, statistic_sign=1),
                                130000: KstestResult(statistic=0.25245384615384614, pvalue=0.0, statistic_location=0.008125339, statistic_sign=1),
                                140000: KstestResult(statistic=0.2527357142857143, pvalue=0.0, statistic_location=0.008395274, statistic_sign=1),
                                150000: KstestResult(statistic=0.25327999999999995, pvalue=0.0, statistic_location=0.008268575, statistic_sign=1),
                                160000: KstestResult(statistic=0.25265625, pvalue=0.0, statistic_location=0.008400353, statistic_sign=1),
                                170000: KstestResult(statistic=0.2529588235294118, pvalue=0.0, statistic_location=0.008448577, statistic_sign=1),
                                180000: KstestResult(statistic=0.25398333333333334, pvalue=0.0, statistic_location=0.008471068, statistic_sign=1),
                                190000: KstestResult(statistic=0.2514052631578948, pvalue=0.0, statistic_location=0.008583182, statistic_sign=1),
                                200000: KstestResult(statistic=0.25241500000000006, pvalue=0.0, statistic_location=0.008454197, statistic_sign=1),
                                210000: KstestResult(statistic=0.25174285714285716, pvalue=0.0, statistic_location=0.007913588, statistic_sign=1),
                                220000: KstestResult(statistic=0.2527454545454545, pvalue=0.0, statistic_location=0.00859022, statistic_sign=1)},
                   'moments': {'mean_error': 0.0038906129,
                               'means': [-0.00054423965, -5.0476283e-05],
                               'stds': [0.019667108, 0.0054564234],
                               'variance_ratio': 8.458123}},
 'originals': {'gan': {'mae': 0.05455929413437843,
                       'mse': 0.004739472642540932,
                       'psnr': 27.725784301757812,
                       'rmse': 0.06884382665157318,
                       'ssim': 0.6566916704177856},
               'pca': {'mae': 0.013096767477691174,
                       'mse': 0.00027656604652293026,
                       'psnr': 40.53063201904297,
                       'rmse': 0.016630275174975395,
                       'ssim': 0.9780802726745605}},
 'reconstructions': {'mae': 0.05278368294239044,
                     'mse': 0.004443435464054346,
                     'psnr': 28.471435546875,
                     'rmse': 0.0666591003537178,
                     'ssim': 0.6628926396369934},
 'residual_spectra_pcagan': {'cosine': [0.28260374,
                                        0.25427267,
                                        0.268355,
                                        0.29584593,
                                        0.23188978,
                                        0.28962916,
                                        0.25852224,
                                        0.26286912,
                                        0.29332796,
                                        0.2820993,
                                        0.37338552,
                                        0.32056358,
                                        0.26874948,
                                        0.25312474,
                                        0.2513672,
                                        0.27952856,
                                        0.23953755,
                                        0.28502464,
                                        0.30253372,
                                        0.32720825,
                                        0.27045548,
                                        0.29371408],
                             'mae': [0.010502031,
                                     0.010798579,
                                     0.010070845,
                                     0.010413214,
                                     0.012834576,
                                     0.012951301,
                                     0.0151773235,
                                     0.014890109,
                                     0.013906689,
                                     0.012997799,
                                     0.012823609,
                                     0.011811436,
                                     0.016060349,
                                     0.017822467,
                                     0.016626589,
                                     0.01516656,
                                     0.016007427,
                                     0.013797997,
                                     0.013872792,
                                     0.012407163,
                                     0.016223252,
                                     0.01292536],
                             'max_mae': 0.017822467,
                             'max_mse': 0.0005019679,
                             'max_rmse': 0.02240464,
                             'median_distance': 1.8121607,
                             'median_mae': 0.013397898,
                             'min_cosine': 0.23188978,
                             'mse': [0.00025930666,
                                     0.00030546763,
                                     0.00030148434,
                                     0.00024392085,
                                     0.00033087173,
                                     0.0003042353,
                                     0.0004983933,
                                     0.0003948954,
                                     0.00032153615,
                                     0.00038831035,
                                     0.0002838249,
                                     0.00029352694,
                                     0.00043116504,
                                     0.0005019679,
                                     0.00044528552,
                                     0.0003979254,
                                     0.00041768374,
                                     0.00035424353,
                                     0.0003210409,
                                     0.00029152032,
                                     0.00044081043,
                                     0.0003259229],
                             'rmse': [0.016103001,
                                      0.017477632,
                                      0.017363304,
                                      0.015617966,
                                      0.01818988,
                                      0.017442342,
                                      0.022324724,
                                      0.019871976,
                                      0.01793143,
                                      0.019705592,
                                      0.016847104,
                                      0.017132629,
                                      0.020764515,
                                      0.02240464,
                                      0.02110179,
                                      0.019948067,
                                      0.020437313,
                                      0.018821359,
                                      0.017917614,
                                      0.017073967,
                                      0.020995487,
                                      0.018053336]},
 'residuals': {'mae': 0.013640339486300945,
               'mse': 0.0003569700347725302,
               'psnr': 20.099227905273438,
               'rmse': 0.0188936498016119,
               'ssds': [85.1597, 6.550493],
               'ssim': 0.16781511902809143},
 'spectra_pcagan': {'cosine': [0.9902773,
                               0.99058205,
                               0.98593557,
                               0.98166245,
                               0.98475355,
                               0.99134403,
                               0.98469067,
                               0.9618693,
                               0.9533671,
                               0.9566785,
                               0.97290313,
                               0.9757846,
                               0.94132704,
                               0.91703165,
                               0.91814286,
                               0.9270977,
                               0.9028449,
                               0.9609457,
                               0.9464992,
                               0.9642788,
                               0.9262062,
                               0.9555533],
                    'mae': [0.04954987,
                            0.04831482,
                            0.04154204,
                            0.037994385,
                            0.056879994,
                            0.070389315,
                            0.07150371,
                            0.061738495,
                            0.06303579,
                            0.044605147,
                            0.042243615,
                            0.038479164,
                            0.05336855,
                            0.06202688,
                            0.0593197,
                            0.054996807,
                            0.06251957,
                            0.0451165,
                            0.05207317,
                            0.041342534,
                            0.058123376,
                            0.046077438],
                    'max_mae': 0.07150371,
                    'max_mse': 0.007799086,
                    'max_rmse': 0.08831243,
                    'median_mae': 0.05272086,
                    'min_cosine': 0.9028449,
                    'mse': [0.0040059844,
                            0.0040321765,
                            0.0028679508,
                            0.0023258596,
                            0.0047913417,
                            0.0073422515,
                            0.007799086,
                            0.005567095,
                            0.0061341664,
                            0.0030706367,
                            0.0026718352,
                            0.002433345,
                            0.004295135,
                            0.0059063034,
                            0.0053027747,
                            0.0047799936,
                            0.006218094,
                            0.0031185155,
                            0.00393515,
                            0.00280235,
                            0.00520777,
                            0.003147773],
                    'rmse': [0.063292846,
                             0.06349942,
                             0.053553253,
                             0.04822717,
                             0.069219515,
                             0.08568694,
                             0.08831243,
                             0.07461297,
                             0.07832092,
                             0.055413324,
                             0.0516898,
                             0.049328946,
                             0.06553728,
                             0.07685248,
                             0.07282016,
                             0.0691375,
                             0.07885489,
                             0.05584367,
                             0.062730774,
                             0.05293723,
                             0.07216488,
                             0.056105018]},
 'spectra_realgan': {'cosine': [0.9896691,
                                0.9898579,
                                0.98456603,
                                0.9791487,
                                0.983875,
                                0.9906742,
                                0.9836056,
                                0.95940924,
                                0.950004,
                                0.9531188,
                                0.9706316,
                                0.9733282,
                                0.93827266,
                                0.91403544,
                                0.91530865,
                                0.92216086,
                                0.9011053,
                                0.9585088,
                                0.94279194,
                                0.9608301,
                                0.92520034,
                                0.95235986],
                     'mae': [0.05091956,
                             0.05065085,
                             0.044404034,
                             0.041118804,
                             0.058669947,
                             0.07273627,
                             0.07316233,
                             0.063168325,
                             0.06512662,
                             0.046040375,
                             0.04382759,
                             0.040590435,
                             0.05506352,
                             0.06331624,
                             0.060418434,
                             0.056880366,
                             0.06340985,
                             0.046374947,
                             0.05363102,
                             0.043673262,
                             0.059573457,
                             0.04754814],
                     'max_mae': 0.07316233,
                     'max_mse': 0.008238449,
                     'max_rmse': 0.0907659,
                     'median_mae': 0.05434727,
                     'min_cosine': 0.9011053,
                     'mse': [0.0042169,
                             0.00437998,
                             0.003240988,
                             0.0026799885,
                             0.0051155905,
                             0.007887149,
                             0.008238449,
                             0.005872001,
                             0.006557111,
                             0.0033155568,
                             0.0029443847,
                             0.0026845408,
                             0.004551976,
                             0.006129314,
                             0.005513082,
                             0.0051394324,
                             0.0063526644,
                             0.0033178928,
                             0.004240858,
                             0.0030703791,
                             0.005419961,
                             0.0034001968],
                     'rmse': [0.064937666,
                              0.066181414,
                              0.056929674,
                              0.051768605,
                              0.07152335,
                              0.088809624,
                              0.0907659,
                              0.07662898,
                              0.080975994,
                              0.057580873,
                              0.054262184,
                              0.051812556,
                              0.06746833,
                              0.07828993,
                              0.07425013,
                              0.07168984,
                              0.07970361,
                              0.057601154,
                              0.06512187,
                              0.055411004,
                              0.07362039,
                              0.058311205]},
 'spectra_realpca': {'cosine': [0.99914396,
                                0.9992311,
                                0.9983727,
                                0.9974544,
                                0.99898773,
                                0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349,
                                0.99650675,
                                0.9971242,
                                0.9965543,
                                0.9968424,
                                0.9962396,
                                0.99634945],
                     'mae': [0.014836307,
                             0.01447966,
                             0.013651306,
                             0.013377094,
                             0.014316244,
                             0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197,
                             0.012154227,
                             0.011967489,
                             0.012771271,
                             0.012152725,
                             0.013049042,
                             0.0125535],
                     'max_mae': 0.015567541,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.012704127,
                     'min_cosine': 0.9962396,
                     'mse': [0.00034976797,
                             0.00033549307,
                             0.00029904975,
                             0.00028346918,
                             0.00032609524,
                             0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102,
                             0.00023534271,
                             0.00023139741,
                             0.00026069232,
                             0.00023610053,
                             0.0002807898,
                             0.0002510656],
                     'rmse': [0.018702084,
                              0.01831647,
                              0.017293055,
                              0.016836543,
                              0.018058106,
                              0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779,
                              0.015340883,
                              0.015211753,
                              0.016145969,
                              0.015365563,
                              0.016756784,
                              0.01584505]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_75.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453
Directory path: experiments/inpainting/gann_4_night_20180722_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_75.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_75.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.111089078084709, 3.1001794530905693],
                   'kl_div': 0.49720812,
                   'ks_tests': {10000: KstestResult(statistic=0.2183, pvalue=4.7110756681238793e-209, statistic_location=0.0087755695, statistic_sign=1),
                                20000: KstestResult(statistic=0.21875, pvalue=0.0, statistic_location=0.007927142, statistic_sign=1),
                                30000: KstestResult(statistic=0.21660000000000001, pvalue=0.0, statistic_location=0.007780277, statistic_sign=1),
                                40000: KstestResult(statistic=0.21734999999999993, pvalue=0.0, statistic_location=0.0076101194, statistic_sign=1),
                                50000: KstestResult(statistic=0.21996000000000004, pvalue=0.0, statistic_location=0.008343312, statistic_sign=1),
                                60000: KstestResult(statistic=0.22043333333333337, pvalue=0.0, statistic_location=0.0074571036, statistic_sign=1),
                                70000: KstestResult(statistic=0.21751428571428577, pvalue=0.0, statistic_location=0.007815789, statistic_sign=1),
                                80000: KstestResult(statistic=0.21582500000000004, pvalue=0.0, statistic_location=0.008025893, statistic_sign=1),
                                90000: KstestResult(statistic=0.21895555555555557, pvalue=0.0, statistic_location=0.007494113, statistic_sign=1),
                                100000: KstestResult(statistic=0.21888000000000007, pvalue=0.0, statistic_location=0.007437637, statistic_sign=1),
                                110000: KstestResult(statistic=0.21673636363636362, pvalue=0.0, statistic_location=0.007463329, statistic_sign=1),
                                120000: KstestResult(statistic=0.21833333333333338, pvalue=0.0, statistic_location=0.0078108083, statistic_sign=1),
                                130000: KstestResult(statistic=0.21759230769230764, pvalue=0.0, statistic_location=0.008334139, statistic_sign=1),
                                140000: KstestResult(statistic=0.21969285714285713, pvalue=0.0, statistic_location=0.0074432585, statistic_sign=1),
                                150000: KstestResult(statistic=0.21767333333333339, pvalue=0.0, statistic_location=0.007919169, statistic_sign=1),
                                160000: KstestResult(statistic=0.21795624999999996, pvalue=0.0, statistic_location=0.007783788, statistic_sign=1),
                                170000: KstestResult(statistic=0.21972941176470595, pvalue=0.0, statistic_location=0.0077846106, statistic_sign=1),
                                180000: KstestResult(statistic=0.21835555555555564, pvalue=0.0, statistic_location=0.007521605, statistic_sign=1),
                                190000: KstestResult(statistic=0.21798421052631578, pvalue=0.0, statistic_location=0.0075507206, statistic_sign=1),
                                200000: KstestResult(statistic=0.21694000000000002, pvalue=0.0, statistic_location=0.0074307323, statistic_sign=1),
                                210000: KstestResult(statistic=0.2189619047619047, pvalue=0.0, statistic_location=0.007864193, statistic_sign=1),
                                220000: KstestResult(statistic=0.21777727272727265, pvalue=0.0, statistic_location=0.0080255335, statistic_sign=1),
                                230000: KstestResult(statistic=0.2185086956521739, pvalue=0.0, statistic_location=0.00751871, statistic_sign=1),
                                240000: KstestResult(statistic=0.21749166666666675, pvalue=0.0, statistic_location=0.0074339863, statistic_sign=1),
                                250000: KstestResult(statistic=0.218144, pvalue=0.0, statistic_location=0.0075513753, statistic_sign=1),
                                260000: KstestResult(statistic=0.21665, pvalue=0.0, statistic_location=0.0075169187, statistic_sign=1),
                                270000: KstestResult(statistic=0.218237037037037, pvalue=0.0, statistic_location=0.0075197574, statistic_sign=1),
                                280000: KstestResult(statistic=0.21833214285714286, pvalue=0.0, statistic_location=0.0077822823, statistic_sign=1),
                                290000: KstestResult(statistic=0.2186517241379311, pvalue=0.0, statistic_location=0.0078630345, statistic_sign=1),
                                300000: KstestResult(statistic=0.21838000000000002, pvalue=0.0, statistic_location=0.007479384, statistic_sign=1),
                                310000: KstestResult(statistic=0.21696774193548396, pvalue=0.0, statistic_location=0.007550083, statistic_sign=1),
                                320000: KstestResult(statistic=0.21923749999999997, pvalue=0.0, statistic_location=0.0078637805, statistic_sign=1),
                                330000: KstestResult(statistic=0.2168606060606061, pvalue=0.0, statistic_location=0.0075245555, statistic_sign=1)},
                   'moments': {'mean_error': -0.0042404295,
                               'means': [-0.00039863147, -2.1693977e-05],
                               'stds': [0.017679268, 0.005385532],
                               'variance_ratio': 8.627582}},
 'originals': {'gan': {'mae': 0.05171003192663193,
                       'mse': 0.004362098407000303,
                       'psnr': 28.81952667236328,
                       'rmse': 0.06604618579149246,
                       'ssim': 0.7228677272796631},
               'pca': {'mae': 0.013429644517600536,
                       'mse': 0.00029108254238963127,
                       'psnr': 40.7747917175293,
                       'rmse': 0.01706114038825035,
                       'ssim': 0.9816524982452393}},
 'reconstructions': {'mae': 0.04971151053905487,
                     'mse': 0.004055059049278498,
                     'psnr': 29.33498191833496,
                     'rmse': 0.06367934495210648,
                     'ssim': 0.7297914624214172},
 'residual_spectra_pcagan': {'cosine': [0.43865642,
                                        0.24162422,
                                        0.33851382,
                                        0.2904345,
                                        0.31440586,
                                        0.27107003,
                                        0.29740414,
                                        0.26412457,
                                        0.30329663,
                                        0.31571752,
                                        0.2341939,
                                        0.30094036,
                                        0.27264938,
                                        0.28328276,
                                        0.31187657,
                                        0.30602232,
                                        0.39502403,
                                        0.35032323,
                                        0.28461316,
                                        0.2715893,
                                        0.27236634,
                                        0.28819954,
                                        0.25545248,
                                        0.30801818,
                                        0.32594854,
                                        0.35910082,
                                        0.2935288,
                                        0.30909878,
                                        0.3610874,
                                        0.37976265,
                                        0.32860368,
                                        0.33697698,
                                        0.28380537],
                             'mae': [0.010307829,
                                     0.011543067,
                                     0.009078416,
                                     0.009397869,
                                     0.009183342,
                                     0.010454051,
                                     0.0099123595,
                                     0.010413985,
                                     0.009421885,
                                     0.010166941,
                                     0.012307652,
                                     0.012033404,
                                     0.014177274,
                                     0.01385857,
                                     0.012729086,
                                     0.011991444,
                                     0.011697062,
                                     0.011068564,
                                     0.014922364,
                                     0.016551461,
                                     0.015271266,
                                     0.014176084,
                                     0.014681517,
                                     0.012756438,
                                     0.012809018,
                                     0.011260095,
                                     0.014887729,
                                     0.01216543,
                                     0.009162823,
                                     0.009436313,
                                     0.009196771,
                                     0.009405595,
                                     0.011066853],
                             'max_mae': 0.016551461,
                             'max_mse': 0.0004356272,
                             'max_rmse': 0.020871684,
                             'median_distance': 1.6654694,
                             'median_mae': 0.011543067,
                             'min_cosine': 0.2341939,
                             'mse': [0.00020070293,
                                     0.000314841,
                                     0.00018760165,
                                     0.00023998735,
                                     0.00018848691,
                                     0.00030048433,
                                     0.00024126201,
                                     0.0002852728,
                                     0.00024048776,
                                     0.00021730617,
                                     0.00032217198,
                                     0.00026426348,
                                     0.00043222724,
                                     0.0003413647,
                                     0.00027737874,
                                     0.00032536022,
                                     0.00023890019,
                                     0.0002495822,
                                     0.00038487438,
                                     0.0004356272,
                                     0.00037485873,
                                     0.00036444768,
                                     0.00036045545,
                                     0.00030593012,
                                     0.00027573522,
                                     0.00023915702,
                                     0.00037236547,
                                     0.00028663193,
                                     0.00018535437,
                                     0.00018155565,
                                     0.00020665588,
                                     0.00022121977,
                                     0.0002972659],
                             'rmse': [0.014166966,
                                      0.017743759,
                                      0.013696775,
                                      0.015491525,
                                      0.013729054,
                                      0.017334484,
                                      0.015532611,
                                      0.016890021,
                                      0.015507667,
                                      0.014741308,
                                      0.017949149,
                                      0.016256183,
                                      0.020790076,
                                      0.018476058,
                                      0.01665469,
                                      0.018037744,
                                      0.015456396,
                                      0.01579817,
                                      0.019618215,
                                      0.020871684,
                                      0.019361269,
                                      0.019090513,
                                      0.018985664,
                                      0.017490858,
                                      0.016605277,
                                      0.015464703,
                                      0.019296773,
                                      0.016930208,
                                      0.013614491,
                                      0.013474259,
                                      0.01437553,
                                      0.014873459,
                                      0.017241402]},
 'residuals': {'mae': 0.011742199771106243,
               'mse': 0.00028363082674331963,
               'psnr': 21.098011016845703,
               'rmse': 0.01684134267270565,
               'ssds': [103.19576, 9.571429],
               'ssim': 0.22103337943553925},
 'spectra_pcagan': {'cosine': [0.9963698,
                               0.99438685,
                               0.9956266,
                               0.9947156,
                               0.9958619,
                               0.9941898,
                               0.99029875,
                               0.99031955,
                               0.9854418,
                               0.9806126,
                               0.9842539,
                               0.99106264,
                               0.98436266,
                               0.9612392,
                               0.95402,
                               0.95667464,
                               0.9732843,
                               0.9759182,
                               0.9413496,
                               0.9185366,
                               0.9188191,
                               0.92797846,
                               0.90390915,
                               0.9617075,
                               0.94762224,
                               0.9649784,
                               0.9271132,
                               0.9554265,
                               0.9740822,
                               0.9776025,
                               0.98743755,
                               0.98771983,
                               0.9894869],
                    'mae': [0.02895067,
                            0.04266675,
                            0.049023084,
                            0.048572775,
                            0.056023497,
                            0.061252892,
                            0.0495633,
                            0.04903637,
                            0.042492125,
                            0.03926784,
                            0.057685602,
                            0.071342446,
                            0.07214283,
                            0.062262837,
                            0.062302727,
                            0.04457293,
                            0.04187726,
                            0.038644116,
                            0.053261742,
                            0.06150753,
                            0.059135124,
                            0.054507904,
                            0.062075067,
                            0.044807233,
                            0.0516789,
                            0.041154943,
                            0.057749476,
                            0.046301115,
                            0.03875649,
                            0.0349078,
                            0.036869936,
                            0.038954005,
                            0.04113254],
                    'max_mae': 0.07214283,
                    'max_mse': 0.0079698,
                    'max_rmse': 0.089273736,
                    'median_mae': 0.049023084,
                    'min_cosine': 0.90390915,
                    'mse': [0.0012863175,
                            0.003211473,
                            0.0038858878,
                            0.0039039506,
                            0.004709052,
                            0.006123947,
                            0.0039803,
                            0.0041435203,
                            0.0029436299,
                            0.0024493064,
                            0.004946753,
                            0.0075787306,
                            0.0079698,
                            0.0056669,
                            0.0060025654,
                            0.0030856284,
                            0.0026376077,
                            0.0024500329,
                            0.004291196,
                            0.005813097,
                            0.0052758013,
                            0.0047103073,
                            0.0061652604,
                            0.0030924445,
                            0.0038729415,
                            0.0027854885,
                            0.0051631485,
                            0.0031829113,
                            0.0024941468,
                            0.0020058854,
                            0.0023234044,
                            0.002516884,
                            0.0031486047],
                    'rmse': [0.03586527,
                             0.05666986,
                             0.06233689,
                             0.0624816,
                             0.06862253,
                             0.07825565,
                             0.06308962,
                             0.064370185,
                             0.05425523,
                             0.049490467,
                             0.07033315,
                             0.08705591,
                             0.089273736,
                             0.07527881,
                             0.077476226,
                             0.055548433,
                             0.051357646,
                             0.049497806,
                             0.06550722,
                             0.07624367,
                             0.07263471,
                             0.06863168,
                             0.07851917,
                             0.05560975,
                             0.06223296,
                             0.052777726,
                             0.07185505,
                             0.056417298,
                             0.049941435,
                             0.044787113,
                             0.048201706,
                             0.050168555,
                             0.056112427]},
 'spectra_realgan': {'cosine': [0.99594945,
                                0.993599,
                                0.9950832,
                                0.9941495,
                                0.9954565,
                                0.99380606,
                                0.9896941,
                                0.98959345,
                                0.9840586,
                                0.9780391,
                                0.98338234,
                                0.99038804,
                                0.983271,
                                0.9587497,
                                0.95064867,
                                0.95316404,
                                0.97102016,
                                0.97345513,
                                0.93828213,
                                0.9155233,
                                0.9159966,
                                0.92306614,
                                0.90216774,
                                0.95925295,
                                0.9439704,
                                0.96156967,
                                0.92616457,
                                0.95225024,
                                0.9714461,
                                0.9741205,
                                0.98563623,
                                0.98602635,
                                0.98827475],
                     'mae': [0.030195968,
                             0.04384645,
                             0.05171915,
                             0.051315956,
                             0.0585284,
                             0.064356156,
                             0.05100211,
                             0.051354375,
                             0.045245912,
                             0.04232188,
                             0.059441272,
                             0.07366079,
                             0.073836826,
                             0.063720815,
                             0.06439157,
                             0.04602444,
                             0.04345906,
                             0.040787138,
                             0.05499627,
                             0.062789485,
                             0.06026786,
                             0.056387287,
                             0.0629972,
                             0.04607277,
                             0.05318295,
                             0.04348565,
                             0.059214,
                             0.047780782,
                             0.041187927,
                             0.037686408,
                             0.039182164,
                             0.041614648,
                             0.04437734],
                     'max_mae': 0.073836826,
                     'max_mse': 0.008408905,
                     'max_rmse': 0.091700085,
                     'median_mae': 0.051315956,
                     'min_cosine': 0.90216774,
                     'mse': [0.0013965998,
                             0.0033654594,
                             0.0043091304,
                             0.0043066847,
                             0.0051687118,
                             0.00663488,
                             0.004193502,
                             0.0044916635,
                             0.0033190364,
                             0.002811561,
                             0.005270784,
                             0.008125987,
                             0.008408905,
                             0.005973664,
                             0.0064246827,
                             0.0033273175,
                             0.0029098277,
                             0.0027023253,
                             0.0045493,
                             0.0060367663,
                             0.005485335,
                             0.0050676977,
                             0.006299948,
                             0.0032926055,
                             0.0041749026,
                             0.0030507362,
                             0.0053743967,
                             0.0034350727,
                             0.0027860254,
                             0.0022955164,
                             0.0025833887,
                             0.0028579237,
                             0.0035189064],
                     'rmse': [0.03737111,
                              0.05801258,
                              0.065643966,
                              0.06562533,
                              0.07189375,
                              0.08145477,
                              0.06475726,
                              0.06701987,
                              0.057611078,
                              0.053024154,
                              0.07260016,
                              0.090144254,
                              0.091700085,
                              0.077289484,
                              0.08015412,
                              0.057682905,
                              0.05394282,
                              0.051983897,
                              0.0674485,
                              0.07769663,
                              0.07406305,
                              0.071187764,
                              0.07937221,
                              0.05738123,
                              0.064613484,
                              0.05523347,
                              0.07331028,
                              0.058609493,
                              0.052782815,
                              0.047911547,
                              0.05082705,
                              0.05345955,
                              0.05932037]},
 'spectra_realpca': {'cosine': [0.99945366,
                                0.99925643,
                                0.99947244,
                                0.99940675,
                                0.9995555,
                                0.99957067,
                                0.99914396,
                                0.9992311,
                                0.9983727,
                                0.9974544,
                                0.99898773,
                                0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349,
                                0.99650675,
                                0.9971242,
                                0.9965543,
                                0.9968424,
                                0.9962396,
                                0.99634945,
                                0.99715966,
                                0.99691385,
                                0.9982245,
                                0.99834263,
                                0.9988524],
                     'mae': [0.011083274,
                             0.014802759,
                             0.015157819,
                             0.015070052,
                             0.015472084,
                             0.015633475,
                             0.014836307,
                             0.01447966,
                             0.013651306,
                             0.013377094,
                             0.014316244,
                             0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197,
                             0.012154227,
                             0.011967489,
                             0.012771271,
                             0.012152725,
                             0.013049042,
                             0.0125535,
                             0.013193458,
                             0.0130807385,
                             0.013555716,
                             0.013718692,
                             0.014281331],
                     'max_mae': 0.015633475,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.013377094,
                     'min_cosine': 0.9962396,
                     'mse': [0.00019629093,
                             0.00035259564,
                             0.00036871652,
                             0.00035998295,
                             0.00038198216,
                             0.00038844542,
                             0.00034976797,
                             0.00033549307,
                             0.00029904975,
                             0.00028346918,
                             0.00032609524,
                             0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102,
                             0.00023534271,
                             0.00023139741,
                             0.00026069232,
                             0.00023610053,
                             0.0002807898,
                             0.0002510656,
                             0.00027758113,
                             0.00027334486,
                             0.00029565947,
                             0.00030083008,
                             0.0003258427],
                     'rmse': [0.014010387,
                              0.01877753,
                              0.019201992,
                              0.018973216,
                              0.019544363,
                              0.019709019,
                              0.018702084,
                              0.01831647,
                              0.017293055,
                              0.016836543,
                              0.018058106,
                              0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779,
                              0.015340883,
                              0.015211753,
                              0.016145969,
                              0.015365563,
                              0.016756784,
                              0.01584505,
                              0.016660767,
                              0.016533144,
                              0.017194752,
                              0.017344454,
                              0.018051114]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_75.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957
Directory path: experiments/inpainting/gann_4_night_20180723_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_75.0/images
Optimal number of principal components:  20
Reconstruction error:  20.51343
Energy conservation:  0.75627077
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_75.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.075287224842861, 3.3845477817773846],
                   'kl_div': 0.2801371,
                   'ks_tests': {10000: KstestResult(statistic=0.1742, pvalue=6.974570016064144e-133, statistic_location=0.009419666, statistic_sign=1),
                                20000: KstestResult(statistic=0.17584999999999995, pvalue=6.069280549640125e-271, statistic_location=0.007975119, statistic_sign=1),
                                30000: KstestResult(statistic=0.17580000000000007, pvalue=0.0, statistic_location=0.009018047, statistic_sign=1),
                                40000: KstestResult(statistic=0.17415000000000003, pvalue=0.0, statistic_location=0.008947041, statistic_sign=1),
                                50000: KstestResult(statistic=0.17801999999999996, pvalue=0.0, statistic_location=0.008266248, statistic_sign=1),
                                60000: KstestResult(statistic=0.17263333333333342, pvalue=0.0, statistic_location=0.00844147, statistic_sign=1),
                                70000: KstestResult(statistic=0.17714285714285716, pvalue=0.0, statistic_location=0.009169591, statistic_sign=1),
                                80000: KstestResult(statistic=0.17728749999999993, pvalue=0.0, statistic_location=0.008985822, statistic_sign=1),
                                90000: KstestResult(statistic=0.17600000000000005, pvalue=0.0, statistic_location=0.00844422, statistic_sign=1),
                                100000: KstestResult(statistic=0.17654000000000003, pvalue=0.0, statistic_location=0.00893309, statistic_sign=1),
                                110000: KstestResult(statistic=0.1765545454545454, pvalue=0.0, statistic_location=0.008937949, statistic_sign=1)},
                   'moments': {'mean_error': 0.10846802,
                               'means': [0.00018858185, -6.229886e-05],
                               'stds': [0.018317485, 0.0071770716],
                               'variance_ratio': 5.631032}},
 'originals': {'gan': {'mae': 0.03907380998134613,
                       'mse': 0.0029817589092999697,
                       'psnr': 25.58672332763672,
                       'rmse': 0.05460548400878906,
                       'ssim': 0.6819353699684143},
               'pca': {'mae': 0.013585607521235943,
                       'mse': 0.00030991295352578163,
                       'psnr': 35.66434860229492,
                       'rmse': 0.017604345455765724,
                       'ssim': 0.9150453209877014}},
 'reconstructions': {'mae': 0.03592219948768616,
                     'mse': 0.0026815745513886213,
                     'psnr': 26.2928466796875,
                     'rmse': 0.05178392305970192,
                     'ssim': 0.7209099531173706},
 'residual_spectra_pcagan': {'cosine': [0.45446852,
                                        0.31939033,
                                        0.43145394,
                                        0.43150795,
                                        0.36244014,
                                        0.42983136,
                                        0.42913267,
                                        0.42434287,
                                        0.3371833,
                                        0.1584371,
                                        0.3721279],
                             'mae': [0.010285479,
                                     0.011303319,
                                     0.011063864,
                                     0.009769737,
                                     0.0109868115,
                                     0.010601907,
                                     0.01052306,
                                     0.01151767,
                                     0.0120478785,
                                     0.012033706,
                                     0.011532934],
                             'max_mae': 0.0120478785,
                             'max_mse': 0.0004187269,
                             'max_rmse': 0.020462818,
                             'median_distance': 1.6582584,
                             'median_mae': 0.011063864,
                             'min_cosine': 0.1584371,
                             'mse': [0.0002177372,
                                     0.0004187269,
                                     0.00025899912,
                                     0.0002204315,
                                     0.00035610746,
                                     0.00022990932,
                                     0.00024960705,
                                     0.0002749821,
                                     0.0003263073,
                                     0.0003086883,
                                     0.00029684842],
                             'rmse': [0.0147559205,
                                      0.020462818,
                                      0.01609345,
                                      0.014846936,
                                      0.01887081,
                                      0.015162761,
                                      0.015798958,
                                      0.016582584,
                                      0.018063977,
                                      0.017569527,
                                      0.017229289]},
 'residuals': {'mae': 0.011060577817261219,
               'mse': 0.00028712223866023123,
               'psnr': 17.08592414855957,
               'rmse': 0.016944682225584984,
               'ssds': [36.911907, 5.666515],
               'ssim': 0.3518405258655548},
 'spectra_pcagan': {'cosine': [0.76593584,
                               0.9760165,
                               0.97814053,
                               0.98354197,
                               0.9790692,
                               0.9768605,
                               0.9812013,
                               0.9820179,
                               0.98697764,
                               0.9914583,
                               0.9904894],
                    'mae': [0.124742605,
                            0.03344942,
                            0.028684616,
                            0.023635767,
                            0.026302796,
                            0.028344959,
                            0.026812414,
                            0.027660053,
                            0.026354669,
                            0.024863666,
                            0.02429324],
                    'max_mae': 0.124742605,
                    'max_mse': 0.016980968,
                    'max_rmse': 0.13031104,
                    'median_mae': 0.026812414,
                    'min_cosine': 0.76593584,
                    'mse': [0.016980968,
                            0.0019278281,
                            0.0013148609,
                            0.00096602575,
                            0.0012749155,
                            0.0013131227,
                            0.001176578,
                            0.0012980358,
                            0.0011894476,
                            0.0010308514,
                            0.0010246885],
                    'rmse': [0.13031104,
                             0.04390704,
                             0.03626101,
                             0.031080956,
                             0.035705958,
                             0.036237035,
                             0.03430128,
                             0.036028266,
                             0.03448837,
                             0.032106873,
                             0.032010756]},
 'spectra_realgan': {'cosine': [0.7618336,
                                0.9706652,
                                0.971932,
                                0.977976,
                                0.9730694,
                                0.9714618,
                                0.97605956,
                                0.9772716,
                                0.9843964,
                                0.99122137,
                                0.9883585],
                     'mae': [0.12481378,
                             0.037247345,
                             0.032845873,
                             0.028152691,
                             0.03085426,
                             0.03197264,
                             0.030473484,
                             0.031204315,
                             0.029412396,
                             0.02533522,
                             0.027499884],
                     'max_mae': 0.12481378,
                     'max_mse': 0.01731206,
                     'max_rmse': 0.1315753,
                     'median_mae': 0.03085426,
                     'min_cosine': 0.7618336,
                     'mse': [0.01731206,
                             0.002327086,
                             0.0017006851,
                             0.0013080896,
                             0.0016379841,
                             0.0016348987,
                             0.0015083412,
                             0.0016238202,
                             0.0014298834,
                             0.0010628916,
                             0.00125361],
                     'rmse': [0.1315753,
                              0.04823988,
                              0.041239362,
                              0.03616752,
                              0.040472016,
                              0.04043388,
                              0.03883737,
                              0.04029665,
                              0.037813798,
                              0.03260202,
                              0.035406355]},
 'spectra_realpca': {'cosine': [0.9947879,
                                0.9943803,
                                0.99411017,
                                0.993906,
                                0.9935526,
                                0.9938409,
                                0.994852,
                                0.9951222,
                                0.99724233,
                                0.9996732,
                                0.9975704],
                     'mae': [0.014474161,
                             0.015715634,
                             0.0149840275,
                             0.015105676,
                             0.015465939,
                             0.014921992,
                             0.0143155195,
                             0.014318667,
                             0.012465642,
                             0.0049975677,
                             0.01267686],
                     'max_mae': 0.015715634,
                     'max_mse': 0.000396761,
                     'max_rmse': 0.01991886,
                     'median_mae': 0.014474161,
                     'min_cosine': 0.9935526,
                     'mse': [0.00034248424,
                             0.000396761,
                             0.00035971313,
                             0.00036490193,
                             0.00038220672,
                             0.00035684567,
                             0.00032700258,
                             0.00032956395,
                             0.00025109647,
                             3.9820112e-05,
                             0.0002586464],
                     'rmse': [0.01850633,
                              0.01991886,
                              0.018966105,
                              0.019102406,
                              0.019550107,
                              0.018890359,
                              0.018083213,
                              0.018153897,
                              0.015846023,
                              0.0063103177,
                              0.016082488]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_75.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431
Directory path: experiments/inpainting/gann_4_night_20180723_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_75.0/images
Optimal number of principal components:  20
Reconstruction error:  20.51343
Energy conservation:  0.75627077
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_75.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.070708789508587, 3.2274177984901677],
                   'kl_div': 0.39007005,
                   'ks_tests': {10000: KstestResult(statistic=0.2108, pvalue=7.40838600930741e-195, statistic_location=0.006746047, statistic_sign=1),
                                20000: KstestResult(statistic=0.2178, pvalue=0.0, statistic_location=0.005768204, statistic_sign=1),
                                30000: KstestResult(statistic=0.21023333333333338, pvalue=0.0, statistic_location=0.00769327, statistic_sign=1),
                                40000: KstestResult(statistic=0.20845000000000002, pvalue=0.0, statistic_location=0.007783523, statistic_sign=1),
                                50000: KstestResult(statistic=0.21198000000000006, pvalue=0.0, statistic_location=0.006398385, statistic_sign=1),
                                60000: KstestResult(statistic=0.21086666666666676, pvalue=0.0, statistic_location=0.0067256168, statistic_sign=1),
                                70000: KstestResult(statistic=0.20929999999999993, pvalue=0.0, statistic_location=0.0062544937, statistic_sign=1),
                                80000: KstestResult(statistic=0.21023749999999997, pvalue=0.0, statistic_location=0.0066664624, statistic_sign=1),
                                90000: KstestResult(statistic=0.2087888888888888, pvalue=0.0, statistic_location=0.0067558, statistic_sign=1),
                                100000: KstestResult(statistic=0.20875, pvalue=0.0, statistic_location=0.006373764, statistic_sign=1),
                                110000: KstestResult(statistic=0.20806363636363645, pvalue=0.0, statistic_location=0.0066866744, statistic_sign=1),
                                120000: KstestResult(statistic=0.20891666666666664, pvalue=0.0, statistic_location=0.006708611, statistic_sign=1),
                                130000: KstestResult(statistic=0.20683076923076926, pvalue=0.0, statistic_location=0.0067833327, statistic_sign=1),
                                140000: KstestResult(statistic=0.21074285714285712, pvalue=0.0, statistic_location=0.006331003, statistic_sign=1),
                                150000: KstestResult(statistic=0.20957333333333328, pvalue=0.0, statistic_location=0.006473208, statistic_sign=1),
                                160000: KstestResult(statistic=0.21096250000000005, pvalue=0.0, statistic_location=0.00677582, statistic_sign=1),
                                170000: KstestResult(statistic=0.2081294117647059, pvalue=0.0, statistic_location=0.0067847697, statistic_sign=1),
                                180000: KstestResult(statistic=0.20658888888888882, pvalue=0.0, statistic_location=0.006458774, statistic_sign=1),
                                190000: KstestResult(statistic=0.20806842105263157, pvalue=0.0, statistic_location=0.0067154635, statistic_sign=1),
                                200000: KstestResult(statistic=0.20897, pvalue=0.0, statistic_location=0.007551095, statistic_sign=1),
                                210000: KstestResult(statistic=0.2062952380952381, pvalue=0.0, statistic_location=0.006707742, statistic_sign=1),
                                220000: KstestResult(statistic=0.20880454545454552, pvalue=0.0, statistic_location=0.006342801, statistic_sign=1)},
                   'moments': {'mean_error': 0.22145483,
                               'means': [0.0011001013, 1.772641e-05],
                               'stds': [0.017806092, 0.0063230717],
                               'variance_ratio': 7.095331}},
 'originals': {'gan': {'mae': 0.03808063641190529,
                       'mse': 0.0028092951979488134,
                       'psnr': 27.170915603637695,
                       'rmse': 0.05300278589129448,
                       'ssim': 0.6384130120277405},
               'pca': {'mae': 0.011610309593379498,
                       'mse': 0.00025869038654491305,
                       'psnr': 37.697845458984375,
                       'rmse': 0.01608385518193245,
                       'ssim': 0.9442765712738037}},
 'reconstructions': {'mae': 0.035223014652729034,
                     'mse': 0.0025500571355223656,
                     'psnr': 27.76015281677246,
                     'rmse': 0.05049809068441391,
                     'ssim': 0.6615154147148132},
 'residual_spectra_pcagan': {'cosine': [0.50419956,
                                        0.38936856,
                                        0.32843378,
                                        0.4292171,
                                        0.39259803,
                                        0.38227406,
                                        0.41350156,
                                        0.4844118,
                                        0.4820219,
                                        0.44311818,
                                        0.41313913,
                                        0.44543213,
                                        0.4610978,
                                        0.4143333,
                                        0.125448,
                                        0.3700698,
                                        0.22899392,
                                        0.14927693,
                                        0.1038503,
                                        0.114393815,
                                        0.08526691,
                                        0.12030413],
                             'mae': [0.008557263,
                                     0.0094609605,
                                     0.010839469,
                                     0.009691272,
                                     0.010751697,
                                     0.011472317,
                                     0.009845275,
                                     0.008864425,
                                     0.009407417,
                                     0.0101907635,
                                     0.011387692,
                                     0.010906506,
                                     0.010590394,
                                     0.010924149,
                                     0.012431022,
                                     0.011508812,
                                     0.01239899,
                                     0.0142173115,
                                     0.013583067,
                                     0.01267769,
                                     0.013276588,
                                     0.011773086],
                             'max_mae': 0.0142173115,
                             'max_mse': 0.00048513737,
                             'max_rmse': 0.022025835,
                             'median_distance': 1.6487005,
                             'median_mae': 0.010915328,
                             'min_cosine': 0.08526691,
                             'mse': [0.0001637874,
                                     0.00026286065,
                                     0.00038516382,
                                     0.00020510859,
                                     0.0002792713,
                                     0.0003393868,
                                     0.00024128042,
                                     0.00017763059,
                                     0.00017701458,
                                     0.00021829245,
                                     0.00027366675,
                                     0.0002376698,
                                     0.00021503966,
                                     0.00024650965,
                                     0.00033118066,
                                     0.0003221096,
                                     0.00029477794,
                                     0.0003764206,
                                     0.00036790498,
                                     0.00029725835,
                                     0.00048513737,
                                     0.00026998215],
                             'rmse': [0.012797945,
                                      0.016212977,
                                      0.019625591,
                                      0.014321613,
                                      0.016711412,
                                      0.018422455,
                                      0.015533203,
                                      0.013327813,
                                      0.013304682,
                                      0.014774723,
                                      0.016542876,
                                      0.015416543,
                                      0.014664231,
                                      0.015700625,
                                      0.01819837,
                                      0.017947413,
                                      0.0171691,
                                      0.019401561,
                                      0.01918085,
                                      0.017241182,
                                      0.022025835,
                                      0.016431134]},
 'residuals': {'mae': 0.011125280521810055,
               'mse': 0.00028033883427269757,
               'psnr': 17.189762115478516,
               'rmse': 0.01674332283437252,
               'ssds': [70.01845, 8.795902],
               'ssim': 0.37696224451065063},
 'spectra_pcagan': {'cosine': [0.9886145,
                               0.990077,
                               0.97737855,
                               0.98925626,
                               0.98053634,
                               0.7846096,
                               0.9807579,
                               0.9849125,
                               0.98295,
                               0.9811841,
                               0.97272444,
                               0.9826627,
                               0.98298395,
                               0.98931265,
                               0.99015653,
                               0.9906249,
                               0.99116707,
                               0.9916757,
                               0.9933599,
                               0.9457089,
                               0.9925302,
                               0.99515444],
                    'mae': [0.026375555,
                            0.027605053,
                            0.02776786,
                            0.027820935,
                            0.029725129,
                            0.123103015,
                            0.027677948,
                            0.02269361,
                            0.02433086,
                            0.02543125,
                            0.032620728,
                            0.02795064,
                            0.02796262,
                            0.023915224,
                            0.02603866,
                            0.029238941,
                            0.02609906,
                            0.027890677,
                            0.028395545,
                            0.11299986,
                            0.025484256,
                            0.02377897],
                    'max_mae': 0.123103015,
                    'max_mse': 0.016913364,
                    'max_rmse': 0.13005139,
                    'median_mae': 0.027722903,
                    'min_cosine': 0.7846096,
                    'mse': [0.0011584007,
                            0.0014998997,
                            0.0014424964,
                            0.0013380407,
                            0.0014768166,
                            0.016913364,
                            0.0013726098,
                            0.00090722693,
                            0.0010283354,
                            0.0010954618,
                            0.0017524564,
                            0.0012532254,
                            0.0012722566,
                            0.0009761762,
                            0.0011983726,
                            0.0014090489,
                            0.0011068179,
                            0.0012754917,
                            0.00137605,
                            0.014106096,
                            0.0012180662,
                            0.0009245484],
                    'rmse': [0.034035284,
                             0.03872854,
                             0.03798021,
                             0.03657924,
                             0.038429372,
                             0.13005139,
                             0.03704875,
                             0.030120209,
                             0.032067668,
                             0.033097763,
                             0.04186235,
                             0.035400923,
                             0.035668705,
                             0.031243818,
                             0.034617517,
                             0.0375373,
                             0.033268873,
                             0.035714027,
                             0.037095148,
                             0.11876909,
                             0.034900807,
                             0.030406388]},
 'spectra_realgan': {'cosine': [0.9842208,
                                0.9872109,
                                0.9718724,
                                0.98597884,
                                0.97520435,
                                0.78050876,
                                0.975519,
                                0.97932196,
                                0.97710794,
                                0.97518355,
                                0.9669335,
                                0.97754604,
                                0.97861266,
                                0.9863813,
                                0.9898533,
                                0.98819584,
                                0.9905373,
                                0.9913935,
                                0.9933227,
                                0.9453743,
                                0.9923465,
                                0.99505585],
                     'mae': [0.031444363,
                             0.033352233,
                             0.032225236,
                             0.032827936,
                             0.03417889,
                             0.123184584,
                             0.032406453,
                             0.027348395,
                             0.028829599,
                             0.030070966,
                             0.03589161,
                             0.03158621,
                             0.031075833,
                             0.027466256,
                             0.02667299,
                             0.03191186,
                             0.02713453,
                             0.028455514,
                             0.02842969,
                             0.11331327,
                             0.025894398,
                             0.024073124],
                     'max_mae': 0.123184584,
                     'max_mse': 0.017245129,
                     'max_rmse': 0.13132071,
                     'median_mae': 0.0312601,
                     'min_cosine': 0.78050876,
                     'mse': [0.0016161589,
                             0.0019656885,
                             0.001808355,
                             0.0017652699,
                             0.0018786415,
                             0.017245129,
                             0.0017570672,
                             0.0012541803,
                             0.0013845725,
                             0.0014579779,
                             0.0020971887,
                             0.0015852305,
                             0.0015708206,
                             0.0012460144,
                             0.001240877,
                             0.0016644049,
                             0.0011870369,
                             0.0013203077,
                             0.0013790524,
                             0.014195839,
                             0.0012407847,
                             0.00094389485],
                     'rmse': [0.040201478,
                              0.044336088,
                              0.04252476,
                              0.042015117,
                              0.043343298,
                              0.13132071,
                              0.041917384,
                              0.03541441,
                              0.037209842,
                              0.038183477,
                              0.045795072,
                              0.039814953,
                              0.03963358,
                              0.03529893,
                              0.035226084,
                              0.040797118,
                              0.0344534,
                              0.03633604,
                              0.037135594,
                              0.119146295,
                              0.035224773,
                              0.030722871]},
 'spectra_realpca': {'cosine': [0.9957725,
                                0.99692875,
                                0.9941627,
                                0.99658483,
                                0.9946467,
                                0.9947879,
                                0.9943803,
                                0.99411017,
                                0.993906,
                                0.9935526,
                                0.9938409,
                                0.994852,
                                0.9951222,
                                0.99724233,
                                0.9996732,
                                0.9975704,
                                0.9992286,
                                0.9997131,
                                0.99992466,
                                0.9999209,
                                0.99985796,
                                0.99993706],
                     'mae': [0.016331542,
                             0.016945701,
                             0.015321953,
                             0.016330251,
                             0.015651466,
                             0.014474161,
                             0.015715634,
                             0.0149840275,
                             0.015105676,
                             0.015465939,
                             0.014921992,
                             0.0143155195,
                             0.014318667,
                             0.012465642,
                             0.0049975677,
                             0.01267686,
                             0.0077655762,
                             0.0052841185,
                             0.0029786183,
                             0.0029765458,
                             0.0037339434,
                             0.0026654287],
                     'max_mae': 0.016945701,
                     'max_mse': 0.0004611332,
                     'max_rmse': 0.021474011,
                     'median_mae': 0.014396414,
                     'min_cosine': 0.9935526,
                     'mse': [0.00042371172,
                             0.0004611332,
                             0.00037283712,
                             0.0004255138,
                             0.00039598346,
                             0.00034248424,
                             0.000396761,
                             0.00035971313,
                             0.00036490193,
                             0.00038220672,
                             0.00035684567,
                             0.00032700258,
                             0.00032956395,
                             0.00025109647,
                             3.9820112e-05,
                             0.0002586464,
                             9.6630785e-05,
                             4.416568e-05,
                             1.4232934e-05,
                             1.4109123e-05,
                             2.2441951e-05,
                             1.138664e-05],
                     'rmse': [0.02058426,
                              0.021474011,
                              0.01930899,
                              0.020627987,
                              0.019899333,
                              0.01850633,
                              0.01991886,
                              0.018966105,
                              0.019102406,
                              0.019550107,
                              0.018890359,
                              0.018083213,
                              0.018153897,
                              0.015846023,
                              0.0063103177,
                              0.016082488,
                              0.009830096,
                              0.0066457265,
                              0.003772656,
                              0.0037562114,
                              0.004737294,
                              0.0033744096]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_75.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707
Directory path: experiments/inpainting/gann_4_night_20180723_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_75.0/images
Optimal number of principal components:  20
Reconstruction error:  20.51343
Energy conservation:  0.75627077
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_75.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.060522481510419, 3.1895489521633893],
                   'kl_div': 0.40402925,
                   'ks_tests': {10000: KstestResult(statistic=0.1915, pvalue=1.1365288461626946e-160, statistic_location=0.00706687, statistic_sign=1),
                                20000: KstestResult(statistic=0.1905, pvalue=2.79741e-318, statistic_location=0.0068581114, statistic_sign=1),
                                30000: KstestResult(statistic=0.1911666666666667, pvalue=0.0, statistic_location=0.0067784768, statistic_sign=1),
                                40000: KstestResult(statistic=0.19174999999999998, pvalue=0.0, statistic_location=0.006093182, statistic_sign=1),
                                50000: KstestResult(statistic=0.1895, pvalue=0.0, statistic_location=0.0068655484, statistic_sign=1),
                                60000: KstestResult(statistic=0.19341666666666657, pvalue=0.0, statistic_location=0.0067090644, statistic_sign=1),
                                70000: KstestResult(statistic=0.18778571428571433, pvalue=0.0, statistic_location=0.006893878, statistic_sign=1),
                                80000: KstestResult(statistic=0.18943750000000004, pvalue=0.0, statistic_location=0.006727417, statistic_sign=1),
                                90000: KstestResult(statistic=0.18973333333333342, pvalue=0.0, statistic_location=0.006310406, statistic_sign=1),
                                100000: KstestResult(statistic=0.18972, pvalue=0.0, statistic_location=0.0070984904, statistic_sign=1),
                                110000: KstestResult(statistic=0.1865, pvalue=0.0, statistic_location=0.00707284, statistic_sign=1),
                                120000: KstestResult(statistic=0.18931666666666658, pvalue=0.0, statistic_location=0.0070347646, statistic_sign=1),
                                130000: KstestResult(statistic=0.18958461538461535, pvalue=0.0, statistic_location=0.00678022, statistic_sign=1),
                                140000: KstestResult(statistic=0.18802857142857143, pvalue=0.0, statistic_location=0.0068448177, statistic_sign=1),
                                150000: KstestResult(statistic=0.18712000000000006, pvalue=0.0, statistic_location=0.0067415335, statistic_sign=1),
                                160000: KstestResult(statistic=0.1901625, pvalue=0.0, statistic_location=0.0067810463, statistic_sign=1),
                                170000: KstestResult(statistic=0.18871764705882355, pvalue=0.0, statistic_location=0.0065080216, statistic_sign=1),
                                180000: KstestResult(statistic=0.18764999999999998, pvalue=0.0, statistic_location=0.0068953605, statistic_sign=1),
                                190000: KstestResult(statistic=0.18874210526315793, pvalue=0.0, statistic_location=0.0064623607, statistic_sign=1),
                                200000: KstestResult(statistic=0.18887500000000002, pvalue=0.0, statistic_location=0.0064617833, statistic_sign=1),
                                210000: KstestResult(statistic=0.18731428571428577, pvalue=0.0, statistic_location=0.0062559173, statistic_sign=1),
                                220000: KstestResult(statistic=0.19015000000000004, pvalue=0.0, statistic_location=0.00672715, statistic_sign=1),
                                230000: KstestResult(statistic=0.18808260869565216, pvalue=0.0, statistic_location=-0.006749958, statistic_sign=-1),
                                240000: KstestResult(statistic=0.18923749999999995, pvalue=0.0, statistic_location=0.0063782604, statistic_sign=1),
                                250000: KstestResult(statistic=0.18956800000000007, pvalue=0.0, statistic_location=0.0068173446, statistic_sign=1),
                                260000: KstestResult(statistic=0.18721538461538456, pvalue=0.0, statistic_location=0.0064863646, statistic_sign=1),
                                270000: KstestResult(statistic=0.18827407407407415, pvalue=0.0, statistic_location=0.0069269515, statistic_sign=1),
                                280000: KstestResult(statistic=0.1885607142857143, pvalue=0.0, statistic_location=0.006800364, statistic_sign=1),
                                290000: KstestResult(statistic=0.18793448275862068, pvalue=0.0, statistic_location=0.006254263, statistic_sign=1),
                                300000: KstestResult(statistic=0.1887133333333334, pvalue=0.0, statistic_location=0.0062545678, statistic_sign=1),
                                310000: KstestResult(statistic=0.18921612903225804, pvalue=0.0, statistic_location=0.006771927, statistic_sign=1),
                                320000: KstestResult(statistic=0.18918124999999997, pvalue=0.0, statistic_location=0.006405454, statistic_sign=1),
                                330000: KstestResult(statistic=0.18836666666666668, pvalue=0.0, statistic_location=0.0067874966, statistic_sign=1)},
                   'moments': {'mean_error': 0.04118875,
                               'means': [4.6829733e-05, 2.7683072e-05],
                               'stds': [0.017160652, 0.0061129085],
                               'variance_ratio': 7.233079}},
 'originals': {'gan': {'mae': 0.036337513476610184,
                       'mse': 0.0025025750510394573,
                       'psnr': 28.304943084716797,
                       'rmse': 0.05002574250102043,
                       'ssim': 0.6518795490264893},
               'pca': {'mae': 0.011432462371885777,
                       'mse': 0.00025673193158581853,
                       'psnr': 38.509952545166016,
                       'rmse': 0.016022857278585434,
                       'ssim': 0.9638211131095886}},
 'reconstructions': {'mae': 0.03356758877635002,
                     'mse': 0.0022468522656708956,
                     'psnr': 29.089008331298828,
                     'rmse': 0.04740097373723984,
                     'ssim': 0.6660338044166565},
 'residual_spectra_pcagan': {'cosine': [0.45768914,
                                        0.42622688,
                                        0.44534984,
                                        0.3661679,
                                        0.47434965,
                                        0.3543175,
                                        0.39460754,
                                        0.35703874,
                                        0.41279513,
                                        0.41332847,
                                        0.36863565,
                                        0.46523863,
                                        0.34949344,
                                        0.46257046,
                                        0.46838507,
                                        0.40898016,
                                        0.4652928,
                                        0.46867505,
                                        0.44502878,
                                        0.37003708,
                                        0.1728949,
                                        0.3897404,
                                        0.25094348,
                                        0.14482388,
                                        0.09346503,
                                        0.12308694,
                                        0.119928755,
                                        0.08196314,
                                        0.13575315,
                                        0.14905462,
                                        0.23800324,
                                        0.20285434,
                                        0.10195004],
                             'mae': [0.009242811,
                                     0.009847251,
                                     0.009070186,
                                     0.010111032,
                                     0.009001897,
                                     0.010232212,
                                     0.009806801,
                                     0.010360871,
                                     0.0097470535,
                                     0.010034174,
                                     0.01081398,
                                     0.010085118,
                                     0.010931907,
                                     0.010497432,
                                     0.009256578,
                                     0.010366756,
                                     0.0099961115,
                                     0.009982973,
                                     0.010840967,
                                     0.0115671335,
                                     0.011558891,
                                     0.011239304,
                                     0.011602545,
                                     0.013498895,
                                     0.013016098,
                                     0.012054673,
                                     0.013513159,
                                     0.013394466,
                                     0.011454589,
                                     0.011545307,
                                     0.010789356,
                                     0.011273577,
                                     0.012689289],
                             'max_mae': 0.013513159,
                             'max_mse': 0.000346352,
                             'max_rmse': 0.018610535,
                             'median_distance': 1.5817491,
                             'median_mae': 0.010789356,
                             'min_cosine': 0.08196314,
                             'mse': [0.00018782458,
                                     0.00022737856,
                                     0.0001921901,
                                     0.0003084706,
                                     0.00017563504,
                                     0.00030197433,
                                     0.00025019303,
                                     0.0002964395,
                                     0.00024057379,
                                     0.00021789904,
                                     0.00030135407,
                                     0.0002154687,
                                     0.00034581235,
                                     0.00021865444,
                                     0.00018251181,
                                     0.0002745204,
                                     0.00019195557,
                                     0.0002044394,
                                     0.0002480661,
                                     0.0002751391,
                                     0.0002613551,
                                     0.00027810154,
                                     0.00029769534,
                                     0.00033888422,
                                     0.00031051727,
                                     0.00026323306,
                                     0.00033125526,
                                     0.000346352,
                                     0.00024734077,
                                     0.00024572792,
                                     0.00022723516,
                                     0.0002424137,
                                     0.00032847753],
                             'rmse': [0.013704911,
                                      0.015079077,
                                      0.013863265,
                                      0.017563332,
                                      0.013252737,
                                      0.017377408,
                                      0.015817491,
                                      0.017217418,
                                      0.015510442,
                                      0.014761404,
                                      0.017359553,
                                      0.014678852,
                                      0.01859603,
                                      0.014786969,
                                      0.013509694,
                                      0.016568657,
                                      0.013854803,
                                      0.01429823,
                                      0.015750114,
                                      0.016587317,
                                      0.01616648,
                                      0.016676376,
                                      0.01725385,
                                      0.018408809,
                                      0.0176215,
                                      0.016224459,
                                      0.01820042,
                                      0.018610535,
                                      0.015727071,
                                      0.01567571,
                                      0.015074321,
                                      0.01556964,
                                      0.018123949]},
 'residuals': {'mae': 0.010891617275774479,
               'mse': 0.0002598511928226799,
               'psnr': 17.519346237182617,
               'rmse': 0.016119901090860367,
               'ssds': [97.18146, 12.331537],
               'ssim': 0.358794629573822},
 'spectra_pcagan': {'cosine': [0.9890303,
                               0.98662025,
                               0.9894224,
                               0.98868346,
                               0.98807025,
                               0.9920207,
                               0.98577666,
                               0.98805994,
                               0.97670317,
                               0.9872559,
                               0.97523665,
                               0.7661051,
                               0.9762119,
                               0.97791815,
                               0.98348284,
                               0.97884023,
                               0.97660595,
                               0.9816246,
                               0.98222136,
                               0.9868132,
                               0.99111766,
                               0.99062973,
                               0.99214226,
                               0.9915379,
                               0.9938635,
                               0.9383453,
                               0.9919597,
                               0.9927448,
                               0.9953144,
                               0.99367666,
                               0.99185556,
                               0.99335504,
                               0.9936688],
                    'mae': [0.025376203,
                            0.0258043,
                            0.024723766,
                            0.026214346,
                            0.03336301,
                            0.035385706,
                            0.028597858,
                            0.030743511,
                            0.029830717,
                            0.032901704,
                            0.032861855,
                            0.12492466,
                            0.033365812,
                            0.028853184,
                            0.023649322,
                            0.026502892,
                            0.028466608,
                            0.026514905,
                            0.027561905,
                            0.026549017,
                            0.02528202,
                            0.024266696,
                            0.027346302,
                            0.029022919,
                            0.027867634,
                            0.118578,
                            0.028039575,
                            0.030240836,
                            0.02284809,
                            0.02536632,
                            0.027684167,
                            0.024127243,
                            0.02486929],
                    'max_mae': 0.12492466,
                    'max_mse': 0.017039774,
                    'max_rmse': 0.13053648,
                    'median_mae': 0.027684167,
                    'min_cosine': 0.7661051,
                    'mse': [0.0011803865,
                            0.001232098,
                            0.0011168781,
                            0.0013607398,
                            0.0017281108,
                            0.0023477084,
                            0.0014347687,
                            0.0018346321,
                            0.001477456,
                            0.0018075106,
                            0.0018192427,
                            0.017039774,
                            0.0019095221,
                            0.0013282627,
                            0.0009694025,
                            0.0012850992,
                            0.0013274011,
                            0.0011497915,
                            0.0012828541,
                            0.0012054297,
                            0.0010719043,
                            0.0010103586,
                            0.0013067955,
                            0.0013625844,
                            0.0013169039,
                            0.015370493,
                            0.0012658213,
                            0.0014674222,
                            0.00085826777,
                            0.0010365896,
                            0.0012328171,
                            0.00095131004,
                            0.0010577868],
                    'rmse': [0.034356754,
                             0.035101254,
                             0.03341973,
                             0.03688821,
                             0.04157055,
                             0.048453156,
                             0.037878342,
                             0.042832606,
                             0.03843769,
                             0.042514827,
                             0.04265258,
                             0.13053648,
                             0.04369808,
                             0.03644534,
                             0.03113523,
                             0.03584828,
                             0.036433518,
                             0.033908576,
                             0.035816953,
                             0.0347193,
                             0.03273995,
                             0.031786136,
                             0.03614963,
                             0.0369132,
                             0.03628917,
                             0.123977795,
                             0.03557838,
                             0.038306948,
                             0.029296208,
                             0.032196112,
                             0.035111494,
                             0.030843314,
                             0.032523632]},
 'spectra_realgan': {'cosine': [0.9853551,
                                0.98257864,
                                0.98564094,
                                0.98512715,
                                0.9843188,
                                0.9903068,
                                0.98180044,
                                0.9852755,
                                0.9705353,
                                0.9841144,
                                0.9703512,
                                0.7619955,
                                0.97085553,
                                0.9717362,
                                0.9779669,
                                0.97282666,
                                0.9712273,
                                0.97642034,
                                0.9774265,
                                0.984213,
                                0.99088174,
                                0.9885115,
                                0.9913723,
                                0.9913689,
                                0.9938202,
                                0.9379977,
                                0.9917644,
                                0.9926512,
                                0.99520636,
                                0.9935132,
                                0.9913482,
                                0.993093,
                                0.993575],
                     'mae': [0.030534301,
                             0.030794553,
                             0.030062726,
                             0.031358715,
                             0.0377374,
                             0.04009977,
                             0.033143446,
                             0.035897423,
                             0.034251146,
                             0.03718541,
                             0.036719628,
                             0.12499839,
                             0.037203338,
                             0.032993086,
                             0.028171163,
                             0.031047769,
                             0.0320552,
                             0.03024404,
                             0.031109659,
                             0.02962783,
                             0.025748422,
                             0.027458014,
                             0.028598959,
                             0.029364506,
                             0.027919048,
                             0.11888948,
                             0.02840619,
                             0.030440006,
                             0.023155866,
                             0.025686359,
                             0.028442373,
                             0.024692245,
                             0.025101565],
                     'max_mae': 0.12499839,
                     'max_mse': 0.017371684,
                     'max_rmse': 0.13180168,
                     'median_mae': 0.030534301,
                     'min_cosine': 0.7619955,
                     'mse': [0.0015804126,
                             0.0016182037,
                             0.0015270484,
                             0.001777265,
                             0.0022208274,
                             0.0028394815,
                             0.0018551685,
                             0.002299127,
                             0.0018833398,
                             0.0022369968,
                             0.0021927992,
                             0.017371684,
                             0.0023089284,
                             0.00171257,
                             0.0013086325,
                             0.0016490074,
                             0.001648104,
                             0.0014853238,
                             0.0016119785,
                             0.0014476015,
                             0.0011036283,
                             0.0012378474,
                             0.0014115707,
                             0.0013876347,
                             0.0013201368,
                             0.015463282,
                             0.0012952108,
                             0.0014871956,
                             0.000878042,
                             0.0010615019,
                             0.0013003623,
                             0.0009891455,
                             0.0010749026],
                     'rmse': [0.039754402,
                              0.040226903,
                              0.03907747,
                              0.04215762,
                              0.047125656,
                              0.053286783,
                              0.04307167,
                              0.047949214,
                              0.043397464,
                              0.0472969,
                              0.046827335,
                              0.13180168,
                              0.04805131,
                              0.04138321,
                              0.036175027,
                              0.040607974,
                              0.040596846,
                              0.038539898,
                              0.040149454,
                              0.03804736,
                              0.033220902,
                              0.035183053,
                              0.037570875,
                              0.03725097,
                              0.036333688,
                              0.12435145,
                              0.03598904,
                              0.038564175,
                              0.029631773,
                              0.0325807,
                              0.03606054,
                              0.031450685,
                              0.032785706]},
 'spectra_realpca': {'cosine': [0.99601054,
                                0.99566513,
                                0.99600375,
                                0.99626696,
                                0.99631697,
                                0.99813324,
                                0.9957725,
                                0.99692875,
                                0.9941627,
                                0.99658483,
                                0.9946467,
                                0.9947879,
                                0.9943803,
                                0.99411017,
                                0.993906,
                                0.9935526,
                                0.9938409,
                                0.994852,
                                0.9951222,
                                0.99724233,
                                0.9996732,
                                0.9975704,
                                0.9992286,
                                0.9997131,
                                0.99992466,
                                0.9999209,
                                0.99985796,
                                0.99993706,
                                0.9999054,
                                0.9998343,
                                0.99946487,
                                0.9996495,
                                0.99984187],
                     'mae': [0.0161406,
                             0.015828239,
                             0.016397031,
                             0.016448775,
                             0.016431835,
                             0.017388247,
                             0.016331542,
                             0.016945701,
                             0.015321953,
                             0.016330251,
                             0.015651466,
                             0.014474161,
                             0.015715634,
                             0.0149840275,
                             0.015105676,
                             0.015465939,
                             0.014921992,
                             0.0143155195,
                             0.014318667,
                             0.012465642,
                             0.0049975677,
                             0.01267686,
                             0.0077655762,
                             0.0052841185,
                             0.0029786183,
                             0.0029765458,
                             0.0037339434,
                             0.0026654287,
                             0.0032963653,
                             0.0038671033,
                             0.0063736853,
                             0.0055835187,
                             0.0040890384],
                     'max_mae': 0.017388247,
                     'max_mse': 0.00048165597,
                     'max_rmse': 0.021946661,
                     'median_mae': 0.014474161,
                     'min_cosine': 0.9935526,
                     'mse': [0.00041757675,
                             0.00040209712,
                             0.00042637286,
                             0.0004341235,
                             0.0004354663,
                             0.00048165597,
                             0.00042371172,
                             0.0004611332,
                             0.00037283712,
                             0.0004255138,
                             0.00039598346,
                             0.00034248424,
                             0.000396761,
                             0.00035971313,
                             0.00036490193,
                             0.00038220672,
                             0.00035684567,
                             0.00032700258,
                             0.00032956395,
                             0.00025109647,
                             3.9820112e-05,
                             0.0002586464,
                             9.6630785e-05,
                             4.416568e-05,
                             1.4232934e-05,
                             1.4109123e-05,
                             2.2441951e-05,
                             1.138664e-05,
                             1.7301365e-05,
                             2.4229488e-05,
                             6.5459644e-05,
                             5.0106217e-05,
                             2.6575899e-05],
                     'rmse': [0.020434694,
                              0.02005236,
                              0.020648798,
                              0.02083563,
                              0.02086783,
                              0.021946661,
                              0.02058426,
                              0.021474011,
                              0.01930899,
                              0.020627987,
                              0.019899333,
                              0.01850633,
                              0.01991886,
                              0.018966105,
                              0.019102406,
                              0.019550107,
                              0.018890359,
                              0.018083213,
                              0.018153897,
                              0.015846023,
                              0.0063103177,
                              0.016082488,
                              0.009830096,
                              0.0066457265,
                              0.003772656,
                              0.0037562114,
                              0.004737294,
                              0.0033744096,
                              0.004159491,
                              0.0049223457,
                              0.008090713,
                              0.0070785745,
                              0.005155182]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_75.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529
Directory path: experiments/inpainting/gann_4_night_20180901_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_75.0/images
Optimal number of principal components:  30
Reconstruction error:  8.096993
Energy conservation:  0.7562086
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_75.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.932551248322828, 1.9750489020032176],
                   'kl_div': 1.3488775,
                   'ks_tests': {10000: KstestResult(statistic=0.3452, pvalue=0.0, statistic_location=-0.002768767, statistic_sign=-1),
                                20000: KstestResult(statistic=0.34625000000000006, pvalue=0.0, statistic_location=-0.002576252, statistic_sign=-1),
                                30000: KstestResult(statistic=0.3453, pvalue=0.0, statistic_location=-0.0025833193, statistic_sign=-1),
                                40000: KstestResult(statistic=0.34505, pvalue=0.0, statistic_location=-0.002598639, statistic_sign=-1),
                                50000: KstestResult(statistic=0.34484000000000004, pvalue=0.0, statistic_location=-0.0024586003, statistic_sign=-1),
                                60000: KstestResult(statistic=0.34500000000000003, pvalue=0.0, statistic_location=-0.00245923, statistic_sign=-1),
                                70000: KstestResult(statistic=0.3415857142857143, pvalue=0.0, statistic_location=-0.002679056, statistic_sign=-1),
                                80000: KstestResult(statistic=0.3447, pvalue=0.0, statistic_location=-0.0026938254, statistic_sign=-1),
                                90000: KstestResult(statistic=0.3463666666666667, pvalue=0.0, statistic_location=-0.002675075, statistic_sign=-1),
                                100000: KstestResult(statistic=0.34572, pvalue=0.0, statistic_location=-0.002467596, statistic_sign=-1),
                                110000: KstestResult(statistic=0.34386363636363637, pvalue=0.0, statistic_location=-0.0026942007, statistic_sign=-1)},
                   'moments': {'mean_error': 0.46914536,
                               'means': [0.0006159432, 5.0142775e-05],
                               'stds': [0.023046242, 0.0021672936],
                               'variance_ratio': 174.57695}},
 'originals': {'gan': {'mae': 0.10246788710355759,
                       'mse': 0.08953791111707687,
                       'psnr': 15.509013175964355,
                       'rmse': 0.29922884702682495,
                       'ssim': 0.8870316743850708},
               'pca': {'mae': 0.002285177120938897,
                       'mse': 1.5052462913445197e-05,
                       'psnr': 53.556129455566406,
                       'rmse': 0.003879750380292535,
                       'ssim': 0.9992150068283081}},
 'reconstructions': {'mae': 0.10217544436454773,
                     'mse': 0.08951731026172638,
                     'psnr': 15.813135147094727,
                     'rmse': 0.29919442534446716,
                     'ssim': 0.8875628709793091},
 'residual_spectra_pcagan': {'cosine': [0.043190885,
                                        0.24009566,
                                        0.25362012,
                                        0.07254789,
                                        0.0829708,
                                        0.12258306,
                                        0.11032948,
                                        0.05726607,
                                        0.062197424,
                                        0.043851163,
                                        0.01542024],
                             'mae': [0.0114147365,
                                     0.011406642,
                                     0.0096344,
                                     0.011174226,
                                     0.0111533785,
                                     0.0093564,
                                     0.010162008,
                                     0.010790046,
                                     0.010257234,
                                     0.010089674,
                                     0.025216639],
                             'max_mae': 0.025216639,
                             'max_mse': 0.003104558,
                             'max_rmse': 0.05571856,
                             'median_distance': 1.5954914,
                             'median_mae': 0.010790046,
                             'min_cosine': 0.01542024,
                             'mse': [0.00028277756,
                                     0.00043060604,
                                     0.00023552186,
                                     0.0002776248,
                                     0.00033801357,
                                     0.00020568461,
                                     0.00020269518,
                                     0.00024642466,
                                     0.00025455933,
                                     0.00021390733,
                                     0.003104558],
                             'rmse': [0.016815992,
                                      0.02075105,
                                      0.015346722,
                                      0.016662076,
                                      0.018385146,
                                      0.014341709,
                                      0.014237106,
                                      0.015697919,
                                      0.015954915,
                                      0.014625572,
                                      0.05571856]},
 'residuals': {'mae': 0.011877763085067272,
               'mse': 0.0005265793297439814,
               'psnr': 5.571915149688721,
               'rmse': 0.022947316989302635,
               'ssds': [58.465424, 0.5169596],
               'ssim': 0.5919278860092163},
 'spectra_pcagan': {'cosine': [0.9990713,
                               0.9940995,
                               0.9962215,
                               0.99784505,
                               0.9987627,
                               0.99666524,
                               0.9972407,
                               0.9985392,
                               0.997305,
                               0.99884087,
                               -0.64514136],
                    'mae': [0.015074661,
                            0.020614909,
                            0.017852712,
                            0.018639881,
                            0.014625095,
                            0.015819302,
                            0.016905935,
                            0.015490077,
                            0.016331729,
                            0.014174603,
                            0.95840096],
                    'max_mae': 0.95840096,
                    'max_mse': 0.98008054,
                    'max_rmse': 0.9899902,
                    'median_mae': 0.016331729,
                    'min_cosine': -0.64514136,
                    'mse': [0.00038079527,
                            0.00070218777,
                            0.0005364736,
                            0.0005664845,
                            0.00037188389,
                            0.00043345042,
                            0.0004514804,
                            0.0003880301,
                            0.00044817256,
                            0.00033098797,
                            0.98008054],
                    'rmse': [0.019513976,
                             0.026498826,
                             0.0231619,
                             0.023800936,
                             0.019284291,
                             0.020819472,
                             0.021248069,
                             0.01969848,
                             0.021170087,
                             0.018193075,
                             0.9899902]},
 'spectra_realgan': {'cosine': [0.99906915,
                                0.9933958,
                                0.99578017,
                                0.9978164,
                                0.9987539,
                                0.99656457,
                                0.9971878,
                                0.99853414,
                                0.99725324,
                                0.9988347,
                                -0.6451682],
                     'mae': [0.015093413,
                             0.021834007,
                             0.018909004,
                             0.01878682,
                             0.014685913,
                             0.016091838,
                             0.017106565,
                             0.015522933,
                             0.016487284,
                             0.014210428,
                             0.95841867],
                     'max_mae': 0.95841867,
                     'max_mse': 0.98011833,
                     'max_rmse': 0.99000925,
                     'median_mae': 0.016487284,
                     'min_cosine': -0.6451682,
                     'mse': [0.00038180794,
                             0.0007860678,
                             0.00059797306,
                             0.00057443464,
                             0.00037425736,
                             0.00044651533,
                             0.00046026468,
                             0.00038939103,
                             0.0004553615,
                             0.00033263222,
                             0.98011833],
                     'rmse': [0.019539906,
                              0.0280369,
                              0.024453487,
                              0.023967367,
                              0.019345732,
                              0.02113091,
                              0.02145378,
                              0.019732993,
                              0.0213392,
                              0.018238207,
                              0.99000925]},
 'spectra_realpca': {'cosine': [0.99999857,
                                0.9993647,
                                0.99961066,
                                0.99998057,
                                0.999995,
                                0.9998897,
                                0.9999531,
                                0.9999937,
                                0.9999642,
                                0.99999493,
                                0.9999991],
                     'mae': [0.00058486545,
                             0.0068638893,
                             0.0057356027,
                             0.0015831428,
                             0.0009617701,
                             0.0029753179,
                             0.0021760708,
                             0.0010263586,
                             0.0018991131,
                             0.000941412,
                             0.00038940445],
                     'max_mae': 0.0068638893,
                     'max_mse': 7.561327e-05,
                     'max_rmse': 0.008695589,
                     'median_mae': 0.0015831428,
                     'min_cosine': 0.9993647,
                     'mse': [5.4866075e-07,
                             7.561327e-05,
                             5.304762e-05,
                             4.008526e-06,
                             1.4747428e-06,
                             1.4107513e-05,
                             7.570475e-06,
                             1.6935887e-06,
                             5.8347537e-06,
                             1.4338805e-06,
                             2.440484e-07],
                     'rmse': [0.00074071635,
                              0.008695589,
                              0.00728338,
                              0.0020021303,
                              0.0012143899,
                              0.003755997,
                              0.0027514496,
                              0.0013013795,
                              0.0024155234,
                              0.0011974475,
                              0.00049401255]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_75.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319
Directory path: experiments/inpainting/gann_4_night_20180901_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_75.0/images
Optimal number of principal components:  30
Reconstruction error:  8.096993
Energy conservation:  0.7562086
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_75.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.940780002103074, 2.3069910370682805],
                   'kl_div': 1.0402173,
                   'ks_tests': {10000: KstestResult(statistic=0.301, pvalue=1e-323, statistic_location=-0.0027375957, statistic_sign=-1),
                                20000: KstestResult(statistic=0.3097, pvalue=0.0, statistic_location=-0.0025107525, statistic_sign=-1),
                                30000: KstestResult(statistic=0.29723333333333335, pvalue=0.0, statistic_location=-0.0025392855, statistic_sign=-1),
                                40000: KstestResult(statistic=0.300275, pvalue=0.0, statistic_location=-0.0030015092, statistic_sign=-1),
                                50000: KstestResult(statistic=0.30238000000000004, pvalue=0.0, statistic_location=-0.002852337, statistic_sign=-1),
                                60000: KstestResult(statistic=0.3016666666666667, pvalue=0.0, statistic_location=-0.0026133228, statistic_sign=-1),
                                70000: KstestResult(statistic=0.30468571428571434, pvalue=0.0, statistic_location=-0.0024014786, statistic_sign=-1),
                                80000: KstestResult(statistic=0.3032125, pvalue=0.0, statistic_location=-0.0027695652, statistic_sign=-1),
                                90000: KstestResult(statistic=0.3012888888888889, pvalue=0.0, statistic_location=-0.002873553, statistic_sign=-1),
                                100000: KstestResult(statistic=0.29922, pvalue=0.0, statistic_location=-0.0027040988, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2994818181818182, pvalue=0.0, statistic_location=-0.0028126733, statistic_sign=-1),
                                120000: KstestResult(statistic=0.2997666666666667, pvalue=0.0, statistic_location=-0.0031547844, statistic_sign=-1),
                                130000: KstestResult(statistic=0.3000153846153846, pvalue=0.0, statistic_location=-0.0026743775, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2988071428571429, pvalue=0.0, statistic_location=-0.0028510652, statistic_sign=-1),
                                150000: KstestResult(statistic=0.30291333333333337, pvalue=0.0, statistic_location=-0.0028504748, statistic_sign=-1),
                                160000: KstestResult(statistic=0.3004625, pvalue=0.0, statistic_location=-0.0029416867, statistic_sign=-1),
                                170000: KstestResult(statistic=0.2998470588235294, pvalue=0.0, statistic_location=-0.0031414647, statistic_sign=-1),
                                180000: KstestResult(statistic=0.3003388888888889, pvalue=0.0, statistic_location=-0.0029285476, statistic_sign=-1),
                                190000: KstestResult(statistic=0.30216842105263153, pvalue=0.0, statistic_location=-0.002674494, statistic_sign=-1),
                                200000: KstestResult(statistic=0.29968, pvalue=0.0, statistic_location=-0.0026743775, statistic_sign=-1),
                                210000: KstestResult(statistic=0.2987904761904762, pvalue=0.0, statistic_location=-0.0029012337, statistic_sign=-1),
                                220000: KstestResult(statistic=0.30060000000000003, pvalue=0.0, statistic_location=-0.0029044598, statistic_sign=-1)},
                   'moments': {'mean_error': -0.003693408,
                               'means': [-0.00023313925, 3.8724347e-06],
                               'stds': [0.0203259, 0.0031679424],
                               'variance_ratio': 37.543846}},
 'originals': {'gan': {'mae': 0.0791468694806099,
                       'mse': 0.051039062440395355,
                       'psnr': 18.142791748046875,
                       'rmse': 0.2259182631969452,
                       'ssim': 0.575168788433075},
               'pca': {'mae': 0.0040217675268650055,
                       'mse': 5.0119990191888064e-05,
                       'psnr': 48.48032760620117,
                       'rmse': 0.007079547271132469,
                       'ssim': 0.9991142749786377}},
 'reconstructions': {'mae': 0.07866690307855606,
                     'mse': 0.05099064111709595,
                     'psnr': 18.405534744262695,
                     'rmse': 0.22581107914447784,
                     'ssim': 0.575848400592804},
 'residual_spectra_pcagan': {'cosine': [0.33947933,
                                        0.2953872,
                                        0.22565234,
                                        0.24804735,
                                        0.3147627,
                                        0.046841793,
                                        0.25238293,
                                        0.26930967,
                                        0.0746883,
                                        0.08921401,
                                        0.14014861,
                                        0.10927131,
                                        0.054876294,
                                        0.07465253,
                                        0.050691314,
                                        0.012893211,
                                        0.055917177,
                                        0.029789288,
                                        0.02758183,
                                        0.07036719,
                                        0.061663233,
                                        0.36181],
                             'mae': [0.009656959,
                                     0.010887446,
                                     0.0112891095,
                                     0.0110729365,
                                     0.009966905,
                                     0.011204271,
                                     0.010998253,
                                     0.009315127,
                                     0.010734227,
                                     0.01051981,
                                     0.009056688,
                                     0.010097,
                                     0.010243225,
                                     0.009826587,
                                     0.009523081,
                                     0.025697129,
                                     0.010540155,
                                     0.012862674,
                                     0.011436346,
                                     0.010951175,
                                     0.011392338,
                                     0.008370731],
                             'max_mae': 0.025697129,
                             'max_mse': 0.0032346863,
                             'max_rmse': 0.0568743,
                             'median_distance': 1.5811006,
                             'median_mae': 0.01063719,
                             'min_cosine': 0.012893211,
                             'mse': [0.00021061003,
                                     0.00034416333,
                                     0.00054150546,
                                     0.0003388658,
                                     0.00028713365,
                                     0.0002711643,
                                     0.00038622657,
                                     0.00020592709,
                                     0.00024637746,
                                     0.00027510716,
                                     0.00018260548,
                                     0.00019971805,
                                     0.00021182703,
                                     0.00021176261,
                                     0.00017613945,
                                     0.0032346863,
                                     0.00021414556,
                                     0.00033328737,
                                     0.00025362454,
                                     0.00024327004,
                                     0.00031297663,
                                     0.00018122418],
                             'rmse': [0.014512409,
                                      0.01855164,
                                      0.02327027,
                                      0.018408308,
                                      0.016945018,
                                      0.016467066,
                                      0.019652648,
                                      0.01435016,
                                      0.015696416,
                                      0.016586354,
                                      0.01351316,
                                      0.0141321635,
                                      0.014554279,
                                      0.014552065,
                                      0.013271754,
                                      0.0568743,
                                      0.014633713,
                                      0.01825616,
                                      0.015925594,
                                      0.015597116,
                                      0.017691145,
                                      0.013461953]},
 'residuals': {'mae': 0.011165553703904152,
               'mse': 0.00040283400448970497,
               'psnr': 16.797632217407227,
               'rmse': 0.020070724189281464,
               'ssds': [90.90281, 2.207882],
               'ssim': 0.6165701150894165},
 'spectra_pcagan': {'cosine': [0.96940666,
                               0.9874873,
                               0.98005253,
                               0.9872869,
                               0.9961588,
                               0.99905205,
                               0.99404186,
                               0.99624527,
                               0.9978509,
                               0.99879354,
                               0.99678993,
                               0.9971717,
                               0.9985271,
                               0.9973079,
                               0.9988782,
                               -0.6444877,
                               0.99869937,
                               0.99948335,
                               0.9991629,
                               0.9951631,
                               0.0061005997,
                               0.98962766],
                    'mae': [0.03566324,
                            0.046110425,
                            0.03291748,
                            0.03447942,
                            0.017498983,
                            0.015081302,
                            0.020691935,
                            0.01777921,
                            0.018556219,
                            0.0144941425,
                            0.015642023,
                            0.017166993,
                            0.0155213075,
                            0.01638349,
                            0.013994501,
                            0.95866513,
                            0.015693564,
                            0.014385559,
                            0.014915371,
                            0.022012558,
                            0.34486628,
                            0.028152743],
                    'max_mae': 0.95866513,
                    'max_mse': 0.9809831,
                    'max_rmse': 0.9904459,
                    'median_mae': 0.017639097,
                    'min_cosine': -0.6444877,
                    'mse': [0.0017415049,
                            0.002985328,
                            0.0019208286,
                            0.0017754547,
                            0.00055008807,
                            0.0003809692,
                            0.00070847693,
                            0.0005293365,
                            0.0005589821,
                            0.00036361118,
                            0.00041729704,
                            0.00046508427,
                            0.0003909924,
                            0.000448851,
                            0.0003203138,
                            0.9809831,
                            0.0003937913,
                            0.00033307067,
                            0.00035929453,
                            0.000736323,
                            0.124237515,
                            0.0011940433],
                    'rmse': [0.041731343,
                             0.054638155,
                             0.043827258,
                             0.042136144,
                             0.023453956,
                             0.019518433,
                             0.02661723,
                             0.023007315,
                             0.023642803,
                             0.019068591,
                             0.02042785,
                             0.021565812,
                             0.019773528,
                             0.021186104,
                             0.017897312,
                             0.9904459,
                             0.019844176,
                             0.018250223,
                             0.018955067,
                             0.027135272,
                             0.35247344,
                             0.034554932]},
 'spectra_realgan': {'cosine': [0.9670778,
                                0.9860739,
                                0.9780557,
                                0.98576266,
                                0.9951324,
                                0.99904984,
                                0.993334,
                                0.9958081,
                                0.9978229,
                                0.99878496,
                                0.99668676,
                                0.99711907,
                                0.9985224,
                                0.9972569,
                                0.99887186,
                                -0.6445148,
                                0.9986888,
                                0.9994831,
                                0.9991609,
                                0.9950985,
                                0.00620771,
                                0.98793983],
                     'mae': [0.03637817,
                             0.046589788,
                             0.034258008,
                             0.035527002,
                             0.019814119,
                             0.015101448,
                             0.02191781,
                             0.018824134,
                             0.018703619,
                             0.014546591,
                             0.015915832,
                             0.017371306,
                             0.015557715,
                             0.016533135,
                             0.014031367,
                             0.95868284,
                             0.01574498,
                             0.0143905,
                             0.014926655,
                             0.02216288,
                             0.34483683,
                             0.029416408],
                     'max_mae': 0.95868284,
                     'max_mse': 0.9810211,
                     'max_rmse': 0.9904651,
                     'median_mae': 0.018763877,
                     'min_cosine': -0.6445148,
                     'mse': [0.0018786305,
                             0.0031433513,
                             0.0020680984,
                             0.0019107212,
                             0.00067015114,
                             0.00038199013,
                             0.00079278374,
                             0.0005900748,
                             0.0005667468,
                             0.00036588818,
                             0.000430694,
                             0.00047388955,
                             0.0003922552,
                             0.0004558564,
                             0.00032200202,
                             0.9810211,
                             0.0003959076,
                             0.0003332668,
                             0.00035991942,
                             0.0007465529,
                             0.12421885,
                             0.001340763],
                     'rmse': [0.04334317,
                              0.056065597,
                              0.04547635,
                              0.043711796,
                              0.025887277,
                              0.019544568,
                              0.028156416,
                              0.024291456,
                              0.023806445,
                              0.019128203,
                              0.020753168,
                              0.021769004,
                              0.019805433,
                              0.021350794,
                              0.017944414,
                              0.9904651,
                              0.019897427,
                              0.018255597,
                              0.018971542,
                              0.02732312,
                              0.35244694,
                              0.03661643]},
 'spectra_realpca': {'cosine': [0.99751765,
                                0.99876887,
                                0.99795455,
                                0.99833894,
                                0.9990391,
                                0.99999857,
                                0.9993647,
                                0.99961066,
                                0.99998057,
                                0.999995,
                                0.9998897,
                                0.9999531,
                                0.9999937,
                                0.9999642,
                                0.99999493,
                                0.9999991,
                                0.9999961,
                                0.9999998,
                                0.9999989,
                                0.99996644,
                                0.9999672,
                                0.9982157],
                     'mae': [0.0094779,
                             0.010615811,
                             0.009999165,
                             0.009903858,
                             0.008227854,
                             0.00058486545,
                             0.0068638893,
                             0.0057356027,
                             0.0015831428,
                             0.0009617701,
                             0.0029753179,
                             0.0021760708,
                             0.0010263586,
                             0.0018991131,
                             0.000941412,
                             0.00038940445,
                             0.0008469713,
                             0.00033167627,
                             0.00054847245,
                             0.001721576,
                             0.0014669864,
                             0.010201662],
                     'max_mae': 0.010615811,
                     'max_mse': 0.00018985306,
                     'max_rmse': 0.013778717,
                     'median_mae': 0.0018103445,
                     'min_cosine': 0.99751765,
                     'mse': [0.00014358076,
                             0.00018985306,
                             0.00015999268,
                             0.00015624512,
                             0.00010898917,
                             5.4866075e-07,
                             7.561327e-05,
                             5.304762e-05,
                             4.008526e-06,
                             1.4747428e-06,
                             1.4107513e-05,
                             7.570475e-06,
                             1.6935887e-06,
                             5.8347537e-06,
                             1.4338805e-06,
                             2.440484e-07,
                             1.1634829e-06,
                             1.7790103e-07,
                             4.8344305e-07,
                             4.8032775e-06,
                             3.477622e-06,
                             0.00016829606],
                     'rmse': [0.011982519,
                              0.013778717,
                              0.012648821,
                              0.012499805,
                              0.010439788,
                              0.00074071635,
                              0.008695589,
                              0.00728338,
                              0.0020021303,
                              0.0012143899,
                              0.003755997,
                              0.0027514496,
                              0.0013013795,
                              0.0024155234,
                              0.0011974475,
                              0.00049401255,
                              0.0010786486,
                              0.00042178316,
                              0.0006953007,
                              0.002191638,
                              0.0018648383,
                              0.012972897]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_75.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809
Directory path: experiments/inpainting/gann_4_night_20180901_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_75.0/images
Optimal number of principal components:  30
Reconstruction error:  8.096993
Energy conservation:  0.7562086
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_75.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9130967822707543, 2.50837585288916],
                   'kl_div': 0.8304477,
                   'ks_tests': {10000: KstestResult(statistic=0.2684, pvalue=3.880027e-317, statistic_location=-0.002962659, statistic_sign=-1),
                                20000: KstestResult(statistic=0.26080000000000003, pvalue=0.0, statistic_location=-0.0030624787, statistic_sign=-1),
                                30000: KstestResult(statistic=0.26536666666666664, pvalue=0.0, statistic_location=-0.0033157729, statistic_sign=-1),
                                40000: KstestResult(statistic=0.26365000000000005, pvalue=0.0, statistic_location=-0.0034736954, statistic_sign=-1),
                                50000: KstestResult(statistic=0.26644, pvalue=0.0, statistic_location=-0.0028361042, statistic_sign=-1),
                                60000: KstestResult(statistic=0.26381666666666664, pvalue=0.0, statistic_location=-0.0034654187, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2635, pvalue=0.0, statistic_location=-0.0029064976, statistic_sign=-1),
                                80000: KstestResult(statistic=0.264725, pvalue=0.0, statistic_location=-0.003307268, statistic_sign=-1),
                                90000: KstestResult(statistic=0.26293333333333335, pvalue=0.0, statistic_location=-0.0031358083, statistic_sign=-1),
                                100000: KstestResult(statistic=0.26095, pvalue=0.0, statistic_location=-0.0032310649, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2638636363636364, pvalue=0.0, statistic_location=-0.0030689128, statistic_sign=-1),
                                120000: KstestResult(statistic=0.2647166666666667, pvalue=0.0, statistic_location=-0.0028634528, statistic_sign=-1),
                                130000: KstestResult(statistic=0.2661769230769231, pvalue=0.0, statistic_location=-0.0030827858, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2647785714285714, pvalue=0.0, statistic_location=-0.002985802, statistic_sign=-1),
                                150000: KstestResult(statistic=0.26355333333333336, pvalue=0.0, statistic_location=-0.0030047018, statistic_sign=-1),
                                160000: KstestResult(statistic=0.26418125, pvalue=0.0, statistic_location=-0.0030695796, statistic_sign=-1),
                                170000: KstestResult(statistic=0.2649470588235294, pvalue=0.0, statistic_location=-0.0029875413, statistic_sign=-1),
                                180000: KstestResult(statistic=0.26513333333333333, pvalue=0.0, statistic_location=-0.0030904962, statistic_sign=-1),
                                190000: KstestResult(statistic=0.26193684210526313, pvalue=0.0, statistic_location=-0.0029391143, statistic_sign=-1),
                                200000: KstestResult(statistic=0.26426499999999997, pvalue=0.0, statistic_location=-0.00324715, statistic_sign=-1),
                                210000: KstestResult(statistic=0.2657333333333334, pvalue=0.0, statistic_location=-0.003263954, statistic_sign=-1),
                                220000: KstestResult(statistic=0.26417727272727276, pvalue=0.0, statistic_location=-0.0030907104, statistic_sign=-1),
                                230000: KstestResult(statistic=0.26575652173913045, pvalue=0.0, statistic_location=-0.0031996602, statistic_sign=-1),
                                240000: KstestResult(statistic=0.2617041666666667, pvalue=0.0, statistic_location=-0.0031466526, statistic_sign=-1),
                                250000: KstestResult(statistic=0.26594799999999996, pvalue=0.0, statistic_location=-0.0033169081, statistic_sign=-1),
                                260000: KstestResult(statistic=0.2629730769230769, pvalue=0.0, statistic_location=-0.0030686287, statistic_sign=-1),
                                270000: KstestResult(statistic=0.26441111111111115, pvalue=0.0, statistic_location=-0.0032876483, statistic_sign=-1),
                                280000: KstestResult(statistic=0.26377142857142855, pvalue=0.0, statistic_location=-0.0031050732, statistic_sign=-1),
                                290000: KstestResult(statistic=0.26388275862068966, pvalue=0.0, statistic_location=-0.0030711559, statistic_sign=-1),
                                300000: KstestResult(statistic=0.26415333333333335, pvalue=0.0, statistic_location=-0.003058456, statistic_sign=-1),
                                310000: KstestResult(statistic=0.2649096774193549, pvalue=0.0, statistic_location=-0.0030640527, statistic_sign=-1),
                                320000: KstestResult(statistic=0.26445625, pvalue=0.0, statistic_location=-0.002950183, statistic_sign=-1),
                                330000: KstestResult(statistic=0.2650121212121212, pvalue=0.0, statistic_location=-0.003090402, statistic_sign=-1)},
                   'moments': {'mean_error': -0.047075316,
                               'means': [-0.00039741758, -2.3412e-05],
                               'stds': [0.018622587, 0.0036979874],
                               'variance_ratio': 20.609453}},
 'originals': {'gan': {'mae': 0.061107855290174484,
                       'mse': 0.03438358008861542,
                       'psnr': 19.85433006286621,
                       'rmse': 0.18542809784412384,
                       'ssim': 0.6147010922431946},
               'pca': {'mae': 0.005048355553299189,
                       'mse': 6.865335308248177e-05,
                       'psnr': 47.11382293701172,
                       'rmse': 0.008285732008516788,
                       'ssim': 0.9976303577423096}},
 'reconstructions': {'mae': 0.06044131889939308,
                     'mse': 0.03432011604309082,
                     'psnr': 20.12495231628418,
                     'rmse': 0.18525689840316772,
                     'ssim': 0.6160770654678345},
 'residual_spectra_pcagan': {'cosine': [0.34498772,
                                        0.3798406,
                                        0.33372396,
                                        0.40497303,
                                        0.39682677,
                                        0.26689136,
                                        0.37140915,
                                        0.32390088,
                                        0.24558142,
                                        0.24990094,
                                        0.33183363,
                                        0.04733871,
                                        0.26742896,
                                        0.29181638,
                                        0.083617,
                                        0.08600508,
                                        0.14503673,
                                        0.10897935,
                                        0.054853402,
                                        0.08765148,
                                        0.05471707,
                                        0.011236211,
                                        0.06635359,
                                        0.030369174,
                                        0.038787916,
                                        0.0759019,
                                        0.066590205,
                                        0.39379618,
                                        0.28631312,
                                        0.2500699,
                                        0.041549277,
                                        0.044578034,
                                        0.040461455],
                             'mae': [0.008651698,
                                     0.007897059,
                                     0.008437804,
                                     0.008010473,
                                     0.007993656,
                                     0.010093335,
                                     0.009200672,
                                     0.010204454,
                                     0.010596789,
                                     0.011011038,
                                     0.009605498,
                                     0.01078267,
                                     0.010779469,
                                     0.008967942,
                                     0.01034921,
                                     0.010173466,
                                     0.008975289,
                                     0.009896776,
                                     0.009806674,
                                     0.00961203,
                                     0.009298208,
                                     0.02585755,
                                     0.010298397,
                                     0.012576177,
                                     0.010977425,
                                     0.010726011,
                                     0.011136393,
                                     0.007869969,
                                     0.009530905,
                                     0.010876117,
                                     0.011185701,
                                     0.01155854,
                                     0.010033802],
                             'max_mae': 0.02585755,
                             'max_mse': 0.003310748,
                             'max_rmse': 0.057539098,
                             'median_distance': 1.5114571,
                             'median_mae': 0.010093335,
                             'min_cosine': 0.011236211,
                             'mse': [0.00020668168,
                                     0.00015031538,
                                     0.00020814693,
                                     0.00015618415,
                                     0.00014235906,
                                     0.0003268325,
                                     0.00017754281,
                                     0.00028116273,
                                     0.00045021143,
                                     0.00033519277,
                                     0.00025654578,
                                     0.000244771,
                                     0.00033416873,
                                     0.0001803195,
                                     0.00022604437,
                                     0.00024032306,
                                     0.00018075985,
                                     0.00019177758,
                                     0.00018307149,
                                     0.00019130888,
                                     0.00016817625,
                                     0.003310748,
                                     0.00020155792,
                                     0.00031577752,
                                     0.00022845026,
                                     0.00023263122,
                                     0.0003016245,
                                     0.00014796454,
                                     0.0002373934,
                                     0.0004347702,
                                     0.0002792285,
                                     0.00027264518,
                                     0.00021227045],
                             'rmse': [0.014376428,
                                      0.012260317,
                                      0.014427298,
                                      0.0124973655,
                                      0.0119314315,
                                      0.01807851,
                                      0.013324519,
                                      0.016767908,
                                      0.021218186,
                                      0.01830827,
                                      0.016017046,
                                      0.01564516,
                                      0.018280283,
                                      0.01342831,
                                      0.015034772,
                                      0.015502357,
                                      0.013444696,
                                      0.013848378,
                                      0.013530391,
                                      0.013831445,
                                      0.0129682785,
                                      0.057539098,
                                      0.014197109,
                                      0.01777013,
                                      0.015114571,
                                      0.015252253,
                                      0.01736734,
                                      0.0121640675,
                                      0.015407576,
                                      0.020851143,
                                      0.016710132,
                                      0.016511971,
                                      0.014569504]},
 'residuals': {'mae': 0.010393068194389343,
               'mse': 0.0003335441870149225,
               'psnr': 17.765766143798828,
               'rmse': 0.0182631928473711,
               'ssds': [114.495995, 4.512954],
               'ssim': 0.6199700832366943},
 'spectra_pcagan': {'cosine': [0.98357725,
                               0.9813363,
                               0.98553866,
                               0.98799783,
                               0.98354423,
                               0.9839049,
                               0.9691632,
                               0.98782754,
                               0.9808446,
                               0.98752224,
                               0.99621874,
                               0.9990518,
                               0.9939644,
                               0.9962016,
                               0.99787605,
                               0.9987795,
                               0.99666566,
                               0.9971661,
                               0.9985047,
                               0.99725646,
                               0.99883,
                               -0.64587766,
                               0.9986649,
                               0.9994672,
                               0.99916905,
                               0.99491954,
                               0.007280601,
                               0.9895461,
                               0.9795117,
                               0.97486085,
                               0.99950695,
                               0.9982031,
                               0.99902934],
                    'mae': [0.023527041,
                            0.027024137,
                            0.022304779,
                            0.022518048,
                            0.02525335,
                            0.026032312,
                            0.03591548,
                            0.04594823,
                            0.032603566,
                            0.034516126,
                            0.017061334,
                            0.0151411835,
                            0.020800587,
                            0.017804671,
                            0.0184005,
                            0.0146248005,
                            0.015791837,
                            0.017117206,
                            0.015665373,
                            0.016488492,
                            0.014237494,
                            0.95918524,
                            0.015861573,
                            0.014690536,
                            0.014886545,
                            0.022427954,
                            0.34438375,
                            0.028472474,
                            0.03695816,
                            0.031588297,
                            0.014714361,
                            0.017927038,
                            0.0146911135],
                    'max_mae': 0.95918524,
                    'max_mse': 0.9814554,
                    'max_rmse': 0.99068433,
                    'median_mae': 0.020800587,
                    'min_cosine': -0.64587766,
                    'mse': [0.000938407,
                            0.0010721739,
                            0.0008580267,
                            0.00079949386,
                            0.0009436553,
                            0.0011461,
                            0.0017572182,
                            0.0029633883,
                            0.0018815134,
                            0.0018005787,
                            0.00051880575,
                            0.00038054248,
                            0.0007162358,
                            0.00053006556,
                            0.00054896367,
                            0.00036910624,
                            0.00043012406,
                            0.00046217843,
                            0.00039681033,
                            0.00045735756,
                            0.00033406782,
                            0.9814554,
                            0.0004052763,
                            0.00034563616,
                            0.00035864205,
                            0.0007662603,
                            0.12385575,
                            0.0012127375,
                            0.0020655748,
                            0.0015599517,
                            0.00036046575,
                            0.00051110954,
                            0.00036217857],
                    'rmse': [0.030633429,
                             0.03274407,
                             0.029292092,
                             0.028275322,
                             0.030718973,
                             0.033854097,
                             0.041919187,
                             0.05443701,
                             0.043376416,
                             0.042433225,
                             0.022777308,
                             0.019507498,
                             0.026762582,
                             0.023023153,
                             0.023429973,
                             0.019212138,
                             0.020739432,
                             0.021498336,
                             0.019920098,
                             0.02138592,
                             0.018277522,
                             0.99068433,
                             0.020131476,
                             0.018591292,
                             0.018937847,
                             0.027681407,
                             0.35193145,
                             0.034824383,
                             0.045448594,
                             0.039496224,
                             0.018985936,
                             0.022607733,
                             0.01903099]},
 'spectra_realgan': {'cosine': [0.98116416,
                                0.9792906,
                                0.9832459,
                                0.98577976,
                                0.9814677,
                                0.98156124,
                                0.9668413,
                                0.9864012,
                                0.97883904,
                                0.9860042,
                                0.99519145,
                                0.9990496,
                                0.9932539,
                                0.9957636,
                                0.99784756,
                                0.9987711,
                                0.996565,
                                0.9971138,
                                0.9984994,
                                0.9972058,
                                0.9988238,
                                -0.64590436,
                                0.998654,
                                0.99946684,
                                0.999167,
                                0.9948542,
                                0.0073883943,
                                0.9878665,
                                0.97839326,
                                0.97260165,
                                0.99950576,
                                0.9981981,
                                0.99902624],
                     'mae': [0.025522962,
                             0.02819047,
                             0.024054082,
                             0.024406085,
                             0.026515229,
                             0.02765658,
                             0.0366096,
                             0.04644786,
                             0.033958904,
                             0.03557728,
                             0.01940579,
                             0.015161359,
                             0.022016011,
                             0.018857328,
                             0.018548708,
                             0.01466665,
                             0.016057845,
                             0.017318573,
                             0.015701028,
                             0.016630571,
                             0.01427325,
                             0.95920295,
                             0.01591568,
                             0.014694339,
                             0.014899051,
                             0.02259362,
                             0.3443543,
                             0.029696891,
                             0.03761046,
                             0.032620154,
                             0.014728023,
                             0.01795012,
                             0.014717337],
                     'max_mae': 0.95920295,
                     'max_mse': 0.9814932,
                     'max_rmse': 0.99070334,
                     'median_mae': 0.022016011,
                     'min_cosine': -0.64590436,
                     'mse': [0.0010776102,
                             0.0011927221,
                             0.0009870987,
                             0.00093792914,
                             0.0010650458,
                             0.0012817222,
                             0.0018940758,
                             0.0031226284,
                             0.0020291568,
                             0.0019350204,
                             0.0006385489,
                             0.00038157578,
                             0.000800654,
                             0.0005906596,
                             0.00055675977,
                             0.00037131037,
                             0.00044307986,
                             0.00047080207,
                             0.0003982088,
                             0.00046431867,
                             0.00033573667,
                             0.9814932,
                             0.00040745668,
                             0.00034584056,
                             0.00035928897,
                             0.00077649346,
                             0.123837024,
                             0.0013584506,
                             0.0021697725,
                             0.0016991112,
                             0.0003608177,
                             0.00051253545,
                             0.00036351563],
                     'rmse': [0.032826975,
                              0.03453581,
                              0.031418126,
                              0.030625628,
                              0.03263504,
                              0.03580115,
                              0.04352098,
                              0.055880483,
                              0.04504616,
                              0.04398887,
                              0.025269525,
                              0.019533964,
                              0.02829583,
                              0.02430349,
                              0.023595758,
                              0.019269416,
                              0.021049462,
                              0.021697974,
                              0.01995517,
                              0.021548055,
                              0.018323118,
                              0.99070334,
                              0.020185556,
                              0.018596789,
                              0.01895492,
                              0.027865632,
                              0.35190484,
                              0.036857165,
                              0.046580818,
                              0.041220278,
                              0.018995203,
                              0.022639247,
                              0.019066086]},
 'spectra_realpca': {'cosine': [0.9975561,
                                0.9975661,
                                0.99749243,
                                0.99782383,
                                0.99755895,
                                0.99749285,
                                0.99751765,
                                0.99876887,
                                0.99795455,
                                0.99833894,
                                0.9990391,
                                0.99999857,
                                0.9993647,
                                0.99961066,
                                0.99998057,
                                0.999995,
                                0.9998897,
                                0.9999531,
                                0.9999937,
                                0.9999642,
                                0.99999493,
                                0.9999991,
                                0.9999961,
                                0.9999998,
                                0.9999989,
                                0.99996644,
                                0.9999672,
                                0.9982157,
                                0.9982887,
                                0.9975543,
                                0.99999905,
                                0.9999959,
                                0.9999971],
                     'mae': [0.009294056,
                             0.009360022,
                             0.009491721,
                             0.009153274,
                             0.009361109,
                             0.009699999,
                             0.0094779,
                             0.010615811,
                             0.009999165,
                             0.009903858,
                             0.008227854,
                             0.00058486545,
                             0.0068638893,
                             0.0057356027,
                             0.0015831428,
                             0.0009617701,
                             0.0029753179,
                             0.0021760708,
                             0.0010263586,
                             0.0018991131,
                             0.000941412,
                             0.00038940445,
                             0.0008469713,
                             0.00033167627,
                             0.00054847245,
                             0.001721576,
                             0.0014669864,
                             0.010201662,
                             0.010100618,
                             0.009512758,
                             0.00052618585,
                             0.0008383152,
                             0.0007788234],
                     'max_mae': 0.010615811,
                     'max_mse': 0.00018985306,
                     'max_rmse': 0.013778717,
                     'median_mae': 0.0029753179,
                     'min_cosine': 0.99749243,
                     'mse': [0.00013859132,
                             0.00014004015,
                             0.00014268626,
                             0.00013440436,
                             0.00014049768,
                             0.00015246523,
                             0.00014358076,
                             0.00018985306,
                             0.00015999268,
                             0.00015624512,
                             0.00010898917,
                             5.4866075e-07,
                             7.561327e-05,
                             5.304762e-05,
                             4.008526e-06,
                             1.4747428e-06,
                             1.4107513e-05,
                             7.570475e-06,
                             1.6935887e-06,
                             5.8347537e-06,
                             1.4338805e-06,
                             2.440484e-07,
                             1.1634829e-06,
                             1.7790103e-07,
                             4.8344305e-07,
                             4.8032775e-06,
                             3.477622e-06,
                             0.00016829606,
                             0.0001666077,
                             0.00014506913,
                             4.4543611e-07,
                             1.1295116e-06,
                             9.839586e-07],
                     'rmse': [0.011772482,
                              0.011833856,
                              0.011945135,
                              0.01159329,
                              0.0118531715,
                              0.012347681,
                              0.011982519,
                              0.013778717,
                              0.012648821,
                              0.012499805,
                              0.010439788,
                              0.00074071635,
                              0.008695589,
                              0.00728338,
                              0.0020021303,
                              0.0012143899,
                              0.003755997,
                              0.0027514496,
                              0.0013013795,
                              0.0024155234,
                              0.0011974475,
                              0.00049401255,
                              0.0010786486,
                              0.00042178316,
                              0.0006953007,
                              0.002191638,
                              0.0018648383,
                              0.012972897,
                              0.012907661,
                              0.012044465,
                              0.00066741003,
                              0.0010627848,
                              0.0009919469]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_75.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521
Directory path: experiments/inpainting/gann_4_night_20180904_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_75.0/images
Optimal number of principal components:  35
Reconstruction error:  6.076127
Energy conservation:  0.7515212
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_75.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9519870688369956, 1.0191235869251105],
                   'kl_div': 2.3309255,
                   'ks_tests': {10000: KstestResult(statistic=0.4889, pvalue=0.0, statistic_location=0.0015859557, statistic_sign=1),
                                20000: KstestResult(statistic=0.48055000000000003, pvalue=0.0, statistic_location=0.0014978833, statistic_sign=1),
                                30000: KstestResult(statistic=0.4859, pvalue=0.0, statistic_location=0.0014577103, statistic_sign=1),
                                40000: KstestResult(statistic=0.4892250000000001, pvalue=0.0, statistic_location=0.0014943252, statistic_sign=1),
                                50000: KstestResult(statistic=0.4821399999999999, pvalue=0.0, statistic_location=0.0014410913, statistic_sign=1),
                                60000: KstestResult(statistic=0.48503333333333337, pvalue=0.0, statistic_location=0.0013510962, statistic_sign=1),
                                70000: KstestResult(statistic=0.4844285714285715, pvalue=0.0, statistic_location=0.0013382621, statistic_sign=1),
                                80000: KstestResult(statistic=0.48426250000000004, pvalue=0.0, statistic_location=0.001322973, statistic_sign=1),
                                90000: KstestResult(statistic=0.4825555555555556, pvalue=0.0, statistic_location=0.0014400687, statistic_sign=1),
                                100000: KstestResult(statistic=0.47938000000000003, pvalue=0.0, statistic_location=0.0015037102, statistic_sign=1),
                                110000: KstestResult(statistic=0.4842727272727273, pvalue=0.0, statistic_location=0.0015094652, statistic_sign=1)},
                   'moments': {'mean_error': 2.2083187,
                               'means': [0.00041185232, -3.0676417e-06],
                               'stds': [0.018056862, 0.000585708],
                               'variance_ratio': 863.058}},
 'originals': {'gan': {'mae': 0.01545684039592743,
                       'mse': 0.0004065525426995009,
                       'psnr': 33.48262023925781,
                       'rmse': 0.020163148641586304,
                       'ssim': 0.9744040966033936},
               'pca': {'mae': 0.0006203162483870983,
                       'mse': 8.88828253664542e-07,
                       'psnr': 60.511817932128906,
                       'rmse': 0.0009427769109606743,
                       'ssim': 0.9999724626541138}},
 'reconstructions': {'mae': 0.01544083934277296,
                     'mse': 0.00040572124999016523,
                     'psnr': 33.917720794677734,
                     'rmse': 0.02014252357184887,
                     'ssim': 0.9744181632995605},
 'residual_spectra_pcagan': {'cosine': [0.010118812,
                                        0.026238177,
                                        0.03541713,
                                        0.025703667,
                                        0.025393473,
                                        0.013422328,
                                        0.026549062,
                                        0.022457562,
                                        0.061386332,
                                        0.051000696,
                                        0.03578085],
                             'mae': [0.0112607265,
                                     0.013134433,
                                     0.012189287,
                                     0.011824666,
                                     0.013406221,
                                     0.011488458,
                                     0.011102788,
                                     0.010490987,
                                     0.010613024,
                                     0.010388848,
                                     0.010805031],
                             'max_mae': 0.013406221,
                             'max_mse': 0.000539055,
                             'max_rmse': 0.023217557,
                             'median_distance': 1.7332199,
                             'median_mae': 0.0112607265,
                             'min_cosine': 0.010118812,
                             'mse': [0.00026703716,
                                     0.00048498763,
                                     0.00031805932,
                                     0.00029320308,
                                     0.000539055,
                                     0.00030187648,
                                     0.00028541355,
                                     0.00025477674,
                                     0.0003004051,
                                     0.00023531013,
                                     0.0003047842],
                             'rmse': [0.01634127,
                                      0.022022435,
                                      0.017834218,
                                      0.017123174,
                                      0.023217557,
                                      0.017374594,
                                      0.016894188,
                                      0.015961727,
                                      0.017332198,
                                      0.015339822,
                                      0.01745807]},
 'residuals': {'mae': 0.011518586426973343,
               'mse': 0.00032590076443739235,
               'psnr': -5.484184265136719,
               'rmse': 0.0180527213960886,
               'ssds': [35.88386, 0.037736617],
               'ssim': 0.2915688753128052},
 'spectra_pcagan': {'cosine': [0.9992128,
                               0.9991767,
                               0.9991693,
                               0.9996014,
                               0.99972045,
                               0.99956834,
                               0.99955666,
                               0.9992275,
                               0.99838597,
                               0.9985811,
                               0.9981304],
                    'mae': [0.016225807,
                            0.016145745,
                            0.016554208,
                            0.014094757,
                            0.0133670475,
                            0.013898467,
                            0.01364565,
                            0.01464251,
                            0.017084148,
                            0.016966563,
                            0.017224329],
                    'max_mae': 0.017224329,
                    'max_mse': 0.0005130021,
                    'max_rmse': 0.022649549,
                    'median_mae': 0.016145745,
                    'min_cosine': 0.9981304,
                    'mse': [0.00043022865,
                            0.00046900898,
                            0.00044479928,
                            0.00031649863,
                            0.00032549267,
                            0.00031633273,
                            0.0003061929,
                            0.00035775427,
                            0.0005130021,
                            0.00047517585,
                            0.0005084478],
                    'rmse': [0.020741954,
                             0.021656616,
                             0.021090265,
                             0.017790409,
                             0.018041415,
                             0.017785745,
                             0.017498368,
                             0.018914392,
                             0.022649549,
                             0.021798529,
                             0.022548787]},
 'spectra_realgan': {'cosine': [0.9992126,
                                0.99917644,
                                0.99916816,
                                0.9996012,
                                0.99972034,
                                0.9995682,
                                0.9995564,
                                0.99922657,
                                0.9983751,
                                0.9985745,
                                0.9981253],
                     'mae': [0.016234554,
                             0.016154349,
                             0.016564753,
                             0.014099496,
                             0.013370059,
                             0.013901434,
                             0.013646585,
                             0.014649001,
                             0.017152673,
                             0.017003642,
                             0.017248679],
                     'max_mae': 0.017248679,
                     'max_mse': 0.00051665533,
                     'max_rmse': 0.022730054,
                     'median_mae': 0.016154349,
                     'min_cosine': 0.9981253,
                     'mse': [0.00043040805,
                             0.00046921865,
                             0.00044538383,
                             0.00031671172,
                             0.00032554567,
                             0.00031648148,
                             0.00030633356,
                             0.0003581814,
                             0.00051665533,
                             0.0004774572,
                             0.0005097011],
                     'rmse': [0.020746278,
                              0.021661455,
                              0.02110412,
                              0.017796397,
                              0.018042885,
                              0.017789926,
                              0.017502388,
                              0.018925682,
                              0.022730054,
                              0.021850795,
                              0.022576561]},
 'spectra_realpca': {'cosine': [0.99999934,
                                0.9999994,
                                0.99999934,
                                0.9999998,
                                0.99999976,
                                0.99999976,
                                0.9999997,
                                0.99999875,
                                0.99998903,
                                0.999993,
                                0.99999225],
                     'mae': [0.00045365116,
                             0.00042183243,
                             0.00047759947,
                             0.0002704274,
                             0.00022101321,
                             0.0002719757,
                             0.0003107461,
                             0.00061416166,
                             0.0014609596,
                             0.0011796823,
                             0.0011414303],
                     'max_mae': 0.0014609596,
                     'max_mse': 3.417467e-06,
                     'max_rmse': 0.0018486392,
                     'median_mae': 0.00045365116,
                     'min_cosine': 0.99998903,
                     'mse': [3.2920963e-07,
                             2.8376212e-07,
                             3.6697304e-07,
                             1.168028e-07,
                             7.9068194e-08,
                             1.1934713e-07,
                             1.550277e-07,
                             6.0718133e-07,
                             3.417467e-06,
                             2.2277804e-06,
                             2.0744908e-06],
                     'rmse': [0.00057376793,
                              0.0005326933,
                              0.000605783,
                              0.00034176424,
                              0.00028119067,
                              0.00034546654,
                              0.00039373557,
                              0.0007792184,
                              0.0018486392,
                              0.0014925752,
                              0.0014403092]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_75.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743
Directory path: experiments/inpainting/gann_4_night_20180904_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_75.0/images
Optimal number of principal components:  35
Reconstruction error:  6.076127
Energy conservation:  0.7515212
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_75.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9538435048012626, 1.490407440452529],
                   'kl_div': 1.8389081,
                   'ks_tests': {10000: KstestResult(statistic=0.3919, pvalue=0.0, statistic_location=0.0016836594, statistic_sign=1),
                                20000: KstestResult(statistic=0.3944500000000001, pvalue=0.0, statistic_location=0.0016836594, statistic_sign=1),
                                30000: KstestResult(statistic=0.3948666666666666, pvalue=0.0, statistic_location=0.0018113619, statistic_sign=1),
                                40000: KstestResult(statistic=0.396675, pvalue=0.0, statistic_location=0.0016745923, statistic_sign=1),
                                50000: KstestResult(statistic=0.39542, pvalue=0.0, statistic_location=0.001687781, statistic_sign=1),
                                60000: KstestResult(statistic=0.39154999999999995, pvalue=0.0, statistic_location=0.0017153574, statistic_sign=1),
                                70000: KstestResult(statistic=0.39170000000000005, pvalue=0.0, statistic_location=0.0017017545, statistic_sign=1),
                                80000: KstestResult(statistic=0.39412500000000006, pvalue=0.0, statistic_location=0.0018556435, statistic_sign=1),
                                90000: KstestResult(statistic=0.39483333333333337, pvalue=0.0, statistic_location=0.0016985512, statistic_sign=1),
                                100000: KstestResult(statistic=0.38960000000000006, pvalue=0.0, statistic_location=0.0017030309, statistic_sign=1),
                                110000: KstestResult(statistic=0.3959454545454546, pvalue=0.0, statistic_location=0.001805668, statistic_sign=1),
                                120000: KstestResult(statistic=0.39205, pvalue=0.0, statistic_location=0.0016814258, statistic_sign=1),
                                130000: KstestResult(statistic=0.39413846153846155, pvalue=0.0, statistic_location=0.001731012, statistic_sign=1),
                                140000: KstestResult(statistic=0.39462857142857144, pvalue=0.0, statistic_location=0.0016999033, statistic_sign=1),
                                150000: KstestResult(statistic=0.39292666666666665, pvalue=0.0, statistic_location=0.0018834241, statistic_sign=1),
                                160000: KstestResult(statistic=0.3938125, pvalue=0.0, statistic_location=0.0016852054, statistic_sign=1),
                                170000: KstestResult(statistic=0.3925352941176471, pvalue=0.0, statistic_location=0.0016983035, statistic_sign=1),
                                180000: KstestResult(statistic=0.39246666666666663, pvalue=0.0, statistic_location=0.0017869251, statistic_sign=1),
                                190000: KstestResult(statistic=0.3921526315789474, pvalue=0.0, statistic_location=0.0017018439, statistic_sign=1),
                                200000: KstestResult(statistic=0.395185, pvalue=0.0, statistic_location=0.001699599, statistic_sign=1),
                                210000: KstestResult(statistic=0.39085238095238095, pvalue=0.0, statistic_location=0.0017980523, statistic_sign=1),
                                220000: KstestResult(statistic=0.3942818181818182, pvalue=0.0, statistic_location=0.001770718, statistic_sign=1)},
                   'moments': {'mean_error': 0.13536298,
                               'means': [-0.00020164356, -3.907148e-06],
                               'stds': [0.016210506, 0.0014967893],
                               'variance_ratio': 164.95724}},
 'originals': {'gan': {'mae': 0.022803151980042458,
                       'mse': 0.0012678931234404445,
                       'psnr': 29.031415939331055,
                       'rmse': 0.035607486963272095,
                       'ssim': 0.9156925082206726},
               'pca': {'mae': 0.001552067813463509,
                       'mse': 1.094268009182997e-05,
                       'psnr': 50.03611755371094,
                       'rmse': 0.003307972103357315,
                       'ssim': 0.9998089671134949}},
 'reconstructions': {'mae': 0.022668160498142242,
                     'mse': 0.001257890136912465,
                     'psnr': 29.430927276611328,
                     'rmse': 0.035466745495796204,
                     'ssim': 0.9157301187515259},
 'residual_spectra_pcagan': {'cosine': [0.04365119,
                                        0.052750498,
                                        0.013517632,
                                        0.02104321,
                                        0.0044043087,
                                        0.008673296,
                                        0.026838655,
                                        0.034176003,
                                        0.024879826,
                                        0.03311115,
                                        0.010066493,
                                        0.019550279,
                                        0.053939145,
                                        0.048753005,
                                        0.06278868,
                                        0.039480243,
                                        0.043249395,
                                        0.10853161,
                                        0.3157175,
                                        0.24232934,
                                        0.032692857,
                                        0.1599886],
                             'mae': [0.0096509755,
                                     0.010203096,
                                     0.011319845,
                                     0.011755106,
                                     0.011311308,
                                     0.010616138,
                                     0.012187874,
                                     0.010806003,
                                     0.011548169,
                                     0.012157811,
                                     0.010565572,
                                     0.01126541,
                                     0.0098426845,
                                     0.011225905,
                                     0.012022455,
                                     0.0107517345,
                                     0.010333953,
                                     0.010848129,
                                     0.0088014705,
                                     0.009021222,
                                     0.011038498,
                                     0.009973642],
                             'max_mae': 0.012187874,
                             'max_mse': 0.00036490065,
                             'max_rmse': 0.019102372,
                             'median_distance': 1.582374,
                             'median_mae': 0.010827066,
                             'min_cosine': 0.0044043087,
                             'mse': [0.0001930616,
                                     0.00024627565,
                                     0.00033685335,
                                     0.00027191074,
                                     0.00029886374,
                                     0.0002213867,
                                     0.0003563166,
                                     0.00023317337,
                                     0.00026213258,
                                     0.000345476,
                                     0.0002308638,
                                     0.0002519638,
                                     0.00019032804,
                                     0.00036490065,
                                     0.00029232146,
                                     0.00025541833,
                                     0.00022112856,
                                     0.00024882262,
                                     0.00015333675,
                                     0.00017609258,
                                     0.00034085484,
                                     0.00024805707],
                             'rmse': [0.01389466,
                                      0.015693173,
                                      0.018353565,
                                      0.016489716,
                                      0.017287675,
                                      0.014879069,
                                      0.01887635,
                                      0.015270015,
                                      0.016190508,
                                      0.018586984,
                                      0.015194203,
                                      0.015873367,
                                      0.013795943,
                                      0.019102372,
                                      0.017097412,
                                      0.015981812,
                                      0.014870392,
                                      0.015774112,
                                      0.012382922,
                                      0.013269988,
                                      0.018462254,
                                      0.015749827]},
 'residuals': {'mae': 0.010783955454826355,
               'mse': 0.0002608881623018533,
               'psnr': 7.072147846221924,
               'rmse': 0.01615203358232975,
               'ssds': [57.820404, 0.4928843],
               'ssim': 0.33648309111595154},
 'spectra_pcagan': {'cosine': [0.9987443,
                               0.99892765,
                               0.99886286,
                               0.99955535,
                               0.99901843,
                               0.99927986,
                               0.9992361,
                               0.9992922,
                               0.99960256,
                               0.99975973,
                               0.99960387,
                               0.9995223,
                               0.999223,
                               0.99806815,
                               0.99762523,
                               0.9979817,
                               0.9666623,
                               0.9950242,
                               0.98546696,
                               0.9888122,
                               0.99527484,
                               0.9902956],
                    'mae': [0.016715946,
                            0.017757006,
                            0.017112149,
                            0.013828865,
                            0.016745664,
                            0.015714396,
                            0.01565602,
                            0.015724719,
                            0.013693671,
                            0.011836995,
                            0.012666819,
                            0.013929986,
                            0.01591192,
                            0.018240292,
                            0.02526438,
                            0.018752618,
                            0.12167284,
                            0.022891497,
                            0.028844528,
                            0.022277292,
                            0.020415992,
                            0.023045903],
                    'max_mae': 0.12167284,
                    'max_mse': 0.015766643,
                    'max_rmse': 0.12556529,
                    'median_mae': 0.016928907,
                    'min_cosine': 0.9666623,
                    'mse': [0.00045235184,
                            0.00051426317,
                            0.00051580707,
                            0.000314231,
                            0.0004667954,
                            0.0003929611,
                            0.00042603063,
                            0.00039451872,
                            0.0003028048,
                            0.00023669345,
                            0.0002729316,
                            0.00031446415,
                            0.00041284485,
                            0.00060634536,
                            0.0009995364,
                            0.00058636634,
                            0.015766643,
                            0.0008829584,
                            0.0012597748,
                            0.00085402775,
                            0.00079174386,
                            0.00090949057],
                    'rmse': [0.021268565,
                             0.022677371,
                             0.022711387,
                             0.017726563,
                             0.021605449,
                             0.019823248,
                             0.02064051,
                             0.019862495,
                             0.017401287,
                             0.0153848445,
                             0.016520642,
                             0.017733138,
                             0.020318585,
                             0.024624081,
                             0.031615444,
                             0.024215002,
                             0.12556529,
                             0.029714616,
                             0.035493307,
                             0.029223753,
                             0.028137943,
                             0.030157762]},
 'spectra_realgan': {'cosine': [0.9987399,
                                0.9989246,
                                0.99886274,
                                0.999555,
                                0.99901736,
                                0.9992793,
                                0.999236,
                                0.9992907,
                                0.9996023,
                                0.9997594,
                                0.99960357,
                                0.99952227,
                                0.9992209,
                                0.9980579,
                                0.9976139,
                                0.9979758,
                                0.9666683,
                                0.9949554,
                                0.98430437,
                                0.9879502,
                                0.99525434,
                                0.98986393],
                     'mae': [0.016758023,
                             0.01777045,
                             0.017112492,
                             0.013835669,
                             0.016758364,
                             0.01572712,
                             0.015651569,
                             0.015733361,
                             0.01369864,
                             0.0118416445,
                             0.012671673,
                             0.013935602,
                             0.015933665,
                             0.018292569,
                             0.02528477,
                             0.018783312,
                             0.12164714,
                             0.023065964,
                             0.029757706,
                             0.023322502,
                             0.020487133,
                             0.023599945],
                     'max_mae': 0.12164714,
                     'max_mse': 0.015762387,
                     'max_rmse': 0.12554835,
                     'median_mae': 0.016935427,
                     'min_cosine': 0.9666683,
                     'mse': [0.0004542083,
                             0.00051534595,
                             0.0005156452,
                             0.00031450595,
                             0.00046751465,
                             0.0003933024,
                             0.00042608738,
                             0.00039522097,
                             0.00030302297,
                             0.00023685937,
                             0.0002731058,
                             0.00031458124,
                             0.00041394672,
                             0.0006094676,
                             0.0010027267,
                             0.0005876273,
                             0.015762387,
                             0.0008939488,
                             0.0013501385,
                             0.00091968756,
                             0.00079519866,
                             0.0009491169],
                     'rmse': [0.021312162,
                              0.022701232,
                              0.022707822,
                              0.017734315,
                              0.021622088,
                              0.019831853,
                              0.020641884,
                              0.019880164,
                              0.017407555,
                              0.015390236,
                              0.016525913,
                              0.017736439,
                              0.02034568,
                              0.024687398,
                              0.03166586,
                              0.024241025,
                              0.12554835,
                              0.029898977,
                              0.03674423,
                              0.030326352,
                              0.028199267,
                              0.030807741]},
 'spectra_realpca': {'cosine': [0.99999565,
                                0.99999857,
                                0.999999,
                                0.9999998,
                                0.99999875,
                                0.99999934,
                                0.9999994,
                                0.99999934,
                                0.9999998,
                                0.99999976,
                                0.99999976,
                                0.9999997,
                                0.99999875,
                                0.99998903,
                                0.999993,
                                0.99999225,
                                0.9999927,
                                0.99994934,
                                0.9987005,
                                0.99902076,
                                0.999982,
                                0.9995717],
                     'mae': [0.000951218,
                             0.0006213345,
                             0.00048709963,
                             0.00028251487,
                             0.00056023285,
                             0.00045365116,
                             0.00042183243,
                             0.00047759947,
                             0.0002704274,
                             0.00022101321,
                             0.0002719757,
                             0.0003107461,
                             0.00061416166,
                             0.0014609596,
                             0.0011796823,
                             0.0011414303,
                             0.0010707764,
                             0.0022736809,
                             0.007930361,
                             0.0067991456,
                             0.0013246322,
                             0.0050210184],
                     'max_mae': 0.007930361,
                     'max_mse': 0.00010091914,
                     'max_rmse': 0.010045852,
                     'median_mae': 0.00061774807,
                     'min_cosine': 0.9987005,
                     'mse': [1.4533631e-06,
                             6.201972e-07,
                             3.8210854e-07,
                             1.2861855e-07,
                             5.0698674e-07,
                             3.2920963e-07,
                             2.8376212e-07,
                             3.6697304e-07,
                             1.168028e-07,
                             7.9068194e-08,
                             1.1934713e-07,
                             1.550277e-07,
                             6.0718133e-07,
                             3.417467e-06,
                             2.2277804e-06,
                             2.0744908e-06,
                             1.8518832e-06,
                             8.254432e-06,
                             0.00010091914,
                             7.3731295e-05,
                             2.7968777e-06,
                             4.031695e-05],
                     'rmse': [0.001205555,
                              0.000787526,
                              0.0006181493,
                              0.00035863428,
                              0.00071203,
                              0.00057376793,
                              0.0005326933,
                              0.000605783,
                              0.00034176424,
                              0.00028119067,
                              0.00034546654,
                              0.00039373557,
                              0.0007792184,
                              0.0018486392,
                              0.0014925752,
                              0.0014403092,
                              0.0013608391,
                              0.0028730528,
                              0.010045852,
                              0.008586693,
                              0.0016723868,
                              0.006349563]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_75.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658
Directory path: experiments/inpainting/gann_4_night_20180904_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_75.0/images
Optimal number of principal components:  35
Reconstruction error:  6.076127
Energy conservation:  0.7515212
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_75.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9187742426194503, 2.003979595441819],
                   'kl_div': 1.3109593,
                   'ks_tests': {10000: KstestResult(statistic=0.3323, pvalue=1e-323, statistic_location=0.0019124015, statistic_sign=1),
                                20000: KstestResult(statistic=0.3363999999999999, pvalue=0.0, statistic_location=0.002319057, statistic_sign=1),
                                30000: KstestResult(statistic=0.33486666666666665, pvalue=0.0, statistic_location=0.0020973114, statistic_sign=1),
                                40000: KstestResult(statistic=0.33762499999999995, pvalue=0.0, statistic_location=0.0017980523, statistic_sign=1),
                                50000: KstestResult(statistic=0.3328, pvalue=0.0, statistic_location=0.0018867933, statistic_sign=1),
                                60000: KstestResult(statistic=0.3348833333333333, pvalue=0.0, statistic_location=0.001894854, statistic_sign=1),
                                70000: KstestResult(statistic=0.3380714285714286, pvalue=0.0, statistic_location=0.0020283451, statistic_sign=1),
                                80000: KstestResult(statistic=0.3344125, pvalue=0.0, statistic_location=0.0017199251, statistic_sign=1),
                                90000: KstestResult(statistic=0.33609999999999995, pvalue=0.0, statistic_location=0.001862444, statistic_sign=1),
                                100000: KstestResult(statistic=0.33781000000000005, pvalue=0.0, statistic_location=0.0019912939, statistic_sign=1),
                                110000: KstestResult(statistic=0.33641818181818184, pvalue=0.0, statistic_location=0.0019957814, statistic_sign=1),
                                120000: KstestResult(statistic=0.3356916666666667, pvalue=0.0, statistic_location=0.0020188782, statistic_sign=1),
                                130000: KstestResult(statistic=0.3355461538461538, pvalue=0.0, statistic_location=0.002104368, statistic_sign=1),
                                140000: KstestResult(statistic=0.3343285714285714, pvalue=0.0, statistic_location=0.0020256913, statistic_sign=1),
                                150000: KstestResult(statistic=0.33628666666666673, pvalue=0.0, statistic_location=0.00198466, statistic_sign=1),
                                160000: KstestResult(statistic=0.3357875, pvalue=0.0, statistic_location=0.0018789786, statistic_sign=1),
                                170000: KstestResult(statistic=0.3372294117647059, pvalue=0.0, statistic_location=0.0019936715, statistic_sign=1),
                                180000: KstestResult(statistic=0.33720555555555565, pvalue=0.0, statistic_location=0.0017847351, statistic_sign=1),
                                190000: KstestResult(statistic=0.3367684210526316, pvalue=0.0, statistic_location=0.0018912801, statistic_sign=1),
                                200000: KstestResult(statistic=0.3372050000000001, pvalue=0.0, statistic_location=0.0019911793, statistic_sign=1),
                                210000: KstestResult(statistic=0.3363380952380952, pvalue=0.0, statistic_location=0.0018633483, statistic_sign=1),
                                220000: KstestResult(statistic=0.33604545454545454, pvalue=0.0, statistic_location=0.0018734683, statistic_sign=1),
                                230000: KstestResult(statistic=0.3391130434782609, pvalue=0.0, statistic_location=0.0020205448, statistic_sign=1),
                                240000: KstestResult(statistic=0.33642916666666667, pvalue=0.0, statistic_location=0.0018932633, statistic_sign=1),
                                250000: KstestResult(statistic=0.33516, pvalue=0.0, statistic_location=0.0018912801, statistic_sign=1),
                                260000: KstestResult(statistic=0.3375230769230769, pvalue=0.0, statistic_location=0.001993983, statistic_sign=1),
                                270000: KstestResult(statistic=0.33348888888888895, pvalue=0.0, statistic_location=0.0020924082, statistic_sign=1),
                                280000: KstestResult(statistic=0.3382964285714286, pvalue=0.0, statistic_location=0.0019911793, statistic_sign=1),
                                290000: KstestResult(statistic=0.3354793103448276, pvalue=0.0, statistic_location=0.0018910894, statistic_sign=1),
                                300000: KstestResult(statistic=0.3361033333333334, pvalue=0.0, statistic_location=0.0018903386, statistic_sign=1),
                                310000: KstestResult(statistic=0.3372516129032258, pvalue=0.0, statistic_location=0.0018908608, statistic_sign=1),
                                320000: KstestResult(statistic=0.3370875, pvalue=0.0, statistic_location=0.0018910894, statistic_sign=1),
                                330000: KstestResult(statistic=0.33589090909090913, pvalue=0.0, statistic_location=0.0019992464, statistic_sign=1)},
                   'moments': {'mean_error': 0.25529075,
                               'means': [0.00036934364, -4.638905e-06],
                               'stds': [0.015899327, 0.0026138418],
                               'variance_ratio': 36.231113}},
 'originals': {'gan': {'mae': 0.024683130905032158,
                       'mse': 0.0012823825236409903,
                       'psnr': 30.239980697631836,
                       'rmse': 0.03581036999821663,
                       'ssim': 0.9119805693626404},
               'pca': {'mae': 0.003227424342185259,
                       'mse': 3.762477354030125e-05,
                       'psnr': 45.98453140258789,
                       'rmse': 0.0061339037492871284,
                       'ssim': 0.99906325340271}},
 'reconstructions': {'mae': 0.024292314425110817,
                     'mse': 0.0012444641906768084,
                     'psnr': 30.789447784423828,
                     'rmse': 0.03527696430683136,
                     'ssim': 0.9123581647872925},
 'residual_spectra_pcagan': {'cosine': [0.26821035,
                                        0.38354892,
                                        0.29492414,
                                        0.051567145,
                                        0.049609035,
                                        0.02610425,
                                        0.0541922,
                                        0.051534727,
                                        0.017724933,
                                        0.0062979157,
                                        0.023427956,
                                        -0.003986637,
                                        0.036732085,
                                        0.037461746,
                                        0.025645582,
                                        0.018194964,
                                        0.00600843,
                                        0.025272552,
                                        0.043180447,
                                        0.08038045,
                                        0.059750337,
                                        0.03043523,
                                        0.047902085,
                                        0.11515338,
                                        0.3169389,
                                        0.24513984,
                                        0.030613901,
                                        0.22018676,
                                        0.31456876,
                                        0.24956377,
                                        0.30331445,
                                        0.2342348,
                                        0.3302943],
                             'mae': [0.009325801,
                                     0.008218806,
                                     0.008849798,
                                     0.009797035,
                                     0.00937259,
                                     0.0111588,
                                     0.010573451,
                                     0.0114412755,
                                     0.012344828,
                                     0.012607108,
                                     0.011016786,
                                     0.011003389,
                                     0.0114959255,
                                     0.010233136,
                                     0.011370062,
                                     0.011472888,
                                     0.01144791,
                                     0.010749458,
                                     0.009353686,
                                     0.009760293,
                                     0.008852463,
                                     0.012387766,
                                     0.009948617,
                                     0.010234478,
                                     0.008930128,
                                     0.009284323,
                                     0.011040971,
                                     0.008934626,
                                     0.009471676,
                                     0.010357247,
                                     0.009342722,
                                     0.010288975,
                                     0.008513466],
                             'max_mae': 0.012607108,
                             'max_mse': 0.00047226588,
                             'max_rmse': 0.021731678,
                             'median_distance': 1.5145172,
                             'median_mae': 0.010234478,
                             'min_cosine': -0.003986637,
                             'mse': [0.00022442911,
                                     0.00015192284,
                                     0.00019697087,
                                     0.00019896428,
                                     0.00016947348,
                                     0.00030923533,
                                     0.00021734957,
                                     0.00029678922,
                                     0.00047226588,
                                     0.00034910117,
                                     0.00028529487,
                                     0.0002580758,
                                     0.0002987844,
                                     0.00020247097,
                                     0.00026332,
                                     0.00027611115,
                                     0.00029063955,
                                     0.00023327349,
                                     0.00016674667,
                                     0.00018510375,
                                     0.00014597381,
                                     0.0003792311,
                                     0.00019948384,
                                     0.00023659653,
                                     0.00016972193,
                                     0.00019196187,
                                     0.00034290124,
                                     0.00017015921,
                                     0.00022937622,
                                     0.00039170808,
                                     0.00024311178,
                                     0.00022365784,
                                     0.00015670745],
                             'rmse': [0.014980958,
                                      0.0123256985,
                                      0.014034631,
                                      0.01410547,
                                      0.013018198,
                                      0.017585088,
                                      0.0147427805,
                                      0.017227571,
                                      0.021731678,
                                      0.01868425,
                                      0.016890675,
                                      0.016064737,
                                      0.01728538,
                                      0.01422923,
                                      0.016227137,
                                      0.016616592,
                                      0.017048154,
                                      0.0152732935,
                                      0.012913043,
                                      0.013605284,
                                      0.012081962,
                                      0.019473856,
                                      0.014123875,
                                      0.015381695,
                                      0.013027737,
                                      0.013855031,
                                      0.018517593,
                                      0.013044509,
                                      0.015145171,
                                      0.019791616,
                                      0.015592042,
                                      0.014955195,
                                      0.012518285]},
 'residuals': {'mae': 0.010278196074068546,
               'mse': 0.0002462700940668583,
               'psnr': 9.38254451751709,
               'rmse': 0.015692995861172676,
               'ssds': [83.46498, 2.2546158],
               'ssim': 0.37448230385780334},
 'spectra_pcagan': {'cosine': [0.98296195,
                               0.986451,
                               0.9827875,
                               0.998699,
                               0.99876827,
                               0.9986979,
                               0.9982822,
                               0.99867654,
                               0.998383,
                               0.99947137,
                               0.9990593,
                               0.9991577,
                               0.9993177,
                               0.9992585,
                               0.99959487,
                               0.99976325,
                               0.9995595,
                               0.9995773,
                               0.9992235,
                               0.9984892,
                               0.99867946,
                               0.99773467,
                               0.9669916,
                               0.99555475,
                               0.98528713,
                               0.9816363,
                               0.99408615,
                               0.98952943,
                               0.9767035,
                               0.9792496,
                               0.98837197,
                               0.98468375,
                               0.98340875],
                    'mae': [0.02836265,
                            0.025071649,
                            0.026598183,
                            0.016689885,
                            0.017350577,
                            0.01794137,
                            0.023161642,
                            0.01762148,
                            0.020328652,
                            0.014706951,
                            0.016858144,
                            0.016443294,
                            0.015136722,
                            0.015418158,
                            0.013863266,
                            0.012075042,
                            0.0135686435,
                            0.013174502,
                            0.01575472,
                            0.017247418,
                            0.016105598,
                            0.021138068,
                            0.11903364,
                            0.020412957,
                            0.027951764,
                            0.030747741,
                            0.022598581,
                            0.02677164,
                            0.041116387,
                            0.037727654,
                            0.023255352,
                            0.028277747,
                            0.029136276],
                    'max_mae': 0.11903364,
                    'max_mse': 0.01522274,
                    'max_rmse': 0.12338047,
                    'median_mae': 0.020328652,
                    'min_cosine': 0.9669916,
                    'mse': [0.0013117746,
                            0.0010372958,
                            0.0011812261,
                            0.00046843014,
                            0.00048153597,
                            0.00055725384,
                            0.00080161303,
                            0.0005416186,
                            0.0007700442,
                            0.00038391745,
                            0.00047532568,
                            0.00043848096,
                            0.0003920458,
                            0.00039705244,
                            0.00030860121,
                            0.00024358305,
                            0.00030748246,
                            0.00027782083,
                            0.00040816556,
                            0.00048473978,
                            0.0004209675,
                            0.00076937454,
                            0.01522274,
                            0.00072209415,
                            0.0011769731,
                            0.0013961399,
                            0.0009129368,
                            0.0010979717,
                            0.0022994434,
                            0.0023459434,
                            0.0009393876,
                            0.0012155394,
                            0.0012798036],
                    'rmse': [0.03621843,
                             0.032207076,
                             0.03436897,
                             0.021643247,
                             0.021943929,
                             0.023606224,
                             0.02831277,
                             0.0232727,
                             0.02774967,
                             0.01959381,
                             0.021801965,
                             0.020939937,
                             0.019800147,
                             0.019926175,
                             0.01756705,
                             0.0156071475,
                             0.017535178,
                             0.016667958,
                             0.020203108,
                             0.022016807,
                             0.020517493,
                             0.0277376,
                             0.12338047,
                             0.02687181,
                             0.03430704,
                             0.037364956,
                             0.030214844,
                             0.033135656,
                             0.04795251,
                             0.04843494,
                             0.030649431,
                             0.034864586,
                             0.035774343]},
 'spectra_realgan': {'cosine': [0.98141617,
                                0.9843961,
                                0.98138016,
                                0.99869436,
                                0.9987652,
                                0.99869514,
                                0.9982768,
                                0.9986742,
                                0.998383,
                                0.999471,
                                0.9990577,
                                0.99915767,
                                0.9993173,
                                0.9992574,
                                0.9995947,
                                0.9997632,
                                0.9995594,
                                0.9995769,
                                0.99922174,
                                0.9984779,
                                0.99867415,
                                0.99772626,
                                0.96699965,
                                0.9954845,
                                0.9839894,
                                0.9809003,
                                0.99406874,
                                0.9890089,
                                0.9749178,
                                0.9770463,
                                0.9866508,
                                0.98371345,
                                0.98208374],
                     'mae': [0.029628074,
                             0.02700189,
                             0.027749643,
                             0.01672471,
                             0.01736071,
                             0.017963676,
                             0.023198184,
                             0.017638557,
                             0.020329196,
                             0.014715689,
                             0.016875643,
                             0.016449021,
                             0.01514646,
                             0.015429361,
                             0.013867778,
                             0.012075955,
                             0.013570692,
                             0.013181887,
                             0.01576668,
                             0.017302837,
                             0.016132269,
                             0.021172037,
                             0.119012624,
                             0.020584086,
                             0.02904295,
                             0.03127465,
                             0.02266131,
                             0.027384903,
                             0.041742865,
                             0.03928473,
                             0.025127655,
                             0.029080918,
                             0.030065676],
                     'max_mae': 0.119012624,
                     'max_mse': 0.015218199,
                     'max_rmse': 0.123362064,
                     'median_mae': 0.020329196,
                     'min_cosine': 0.96699965,
                     'mse': [0.0014243955,
                             0.0011916466,
                             0.0012813956,
                             0.00046999526,
                             0.0004825057,
                             0.00055833557,
                             0.0008045093,
                             0.0005425089,
                             0.0007697753,
                             0.00038416838,
                             0.0004764196,
                             0.0004385655,
                             0.00039241716,
                             0.00039764633,
                             0.00030881263,
                             0.000243631,
                             0.0003075732,
                             0.00027812115,
                             0.00040910655,
                             0.00048806457,
                             0.00042268314,
                             0.0007709653,
                             0.015218199,
                             0.00073372514,
                             0.0012791257,
                             0.0014532296,
                             0.0009157033,
                             0.0011495346,
                             0.0024376146,
                             0.0025421786,
                             0.0010732627,
                             0.0012942909,
                             0.0013785195],
                     'rmse': [0.037741166,
                              0.034520235,
                              0.035796586,
                              0.021679373,
                              0.021966012,
                              0.023629125,
                              0.028363874,
                              0.02329182,
                              0.027744824,
                              0.019600214,
                              0.021827038,
                              0.020941956,
                              0.019809522,
                              0.019941071,
                              0.017573066,
                              0.015608683,
                              0.017537765,
                              0.016676964,
                              0.020226382,
                              0.022092184,
                              0.020559259,
                              0.027766261,
                              0.123362064,
                              0.02708736,
                              0.035764866,
                              0.03812125,
                              0.03026059,
                              0.033904787,
                              0.049372204,
                              0.050420024,
                              0.032760687,
                              0.035976253,
                              0.03712842]},
 'spectra_realpca': {'cosine': [0.99861485,
                                0.9980981,
                                0.9984068,
                                0.99999744,
                                0.9999963,
                                0.9999983,
                                0.99999565,
                                0.99999857,
                                0.999999,
                                0.9999998,
                                0.99999875,
                                0.99999934,
                                0.9999994,
                                0.99999934,
                                0.9999998,
                                0.99999976,
                                0.99999976,
                                0.9999997,
                                0.99999875,
                                0.99998903,
                                0.999993,
                                0.99999225,
                                0.9999927,
                                0.99994934,
                                0.9987005,
                                0.99902076,
                                0.999982,
                                0.9995717,
                                0.9981845,
                                0.99783415,
                                0.9982478,
                                0.99897295,
                                0.99855924],
                     'mae': [0.007834895,
                             0.009342803,
                             0.008311819,
                             0.0007283651,
                             0.00090253714,
                             0.0006701696,
                             0.000951218,
                             0.0006213345,
                             0.00048709963,
                             0.00028251487,
                             0.00056023285,
                             0.00045365116,
                             0.00042183243,
                             0.00047759947,
                             0.0002704274,
                             0.00022101321,
                             0.0002719757,
                             0.0003107461,
                             0.00061416166,
                             0.0014609596,
                             0.0011796823,
                             0.0011414303,
                             0.0010707764,
                             0.0022736809,
                             0.007930361,
                             0.0067991456,
                             0.0013246322,
                             0.0050210184,
                             0.009241262,
                             0.010780843,
                             0.009269759,
                             0.007161289,
                             0.008115768],
                     'max_mae': 0.010780843,
                     'max_mse': 0.00018613558,
                     'max_rmse': 0.013643151,
                     'median_mae': 0.0010707764,
                     'min_cosine': 0.99783415,
                     'mse': [9.894515e-05,
                             0.00014046425,
                             0.0001105844,
                             8.4592665e-07,
                             1.3136008e-06,
                             7.131776e-07,
                             1.4533631e-06,
                             6.201972e-07,
                             3.8210854e-07,
                             1.2861855e-07,
                             5.0698674e-07,
                             3.2920963e-07,
                             2.8376212e-07,
                             3.6697304e-07,
                             1.168028e-07,
                             7.9068194e-08,
                             1.1934713e-07,
                             1.550277e-07,
                             6.0718133e-07,
                             3.417467e-06,
                             2.2277804e-06,
                             2.0744908e-06,
                             1.8518832e-06,
                             8.254432e-06,
                             0.00010091914,
                             7.3731295e-05,
                             2.7968777e-06,
                             4.031695e-05,
                             0.00013701041,
                             0.00018613558,
                             0.00013670909,
                             8.212965e-05,
                             0.00010602723],
                     'rmse': [0.009947117,
                              0.0118517615,
                              0.0105159115,
                              0.0009197427,
                              0.0011461242,
                              0.00084449846,
                              0.001205555,
                              0.000787526,
                              0.0006181493,
                              0.00035863428,
                              0.00071203,
                              0.00057376793,
                              0.0005326933,
                              0.000605783,
                              0.00034176424,
                              0.00028119067,
                              0.00034546654,
                              0.00039373557,
                              0.0007792184,
                              0.0018486392,
                              0.0014925752,
                              0.0014403092,
                              0.0013608391,
                              0.0028730528,
                              0.010045852,
                              0.008586693,
                              0.0016723868,
                              0.006349563,
                              0.011705145,
                              0.013643151,
                              0.011692266,
                              0.009062541,
                              0.010296953]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_75.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734
Directory path: experiments/inpainting/gann_4_night_20210905_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_75.0/images
Optimal number of principal components:  37
Reconstruction error:  4.376094
Energy conservation:  0.7508095
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_75.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.8998554886731998, 2.3078176771501724],
                   'kl_div': 0.9991761,
                   'ks_tests': {10000: KstestResult(statistic=0.3022, pvalue=1e-323, statistic_location=-0.0026455498, statistic_sign=-1),
                                20000: KstestResult(statistic=0.3095, pvalue=0.0, statistic_location=-0.0036408603, statistic_sign=-1),
                                30000: KstestResult(statistic=0.30843333333333334, pvalue=0.0, statistic_location=-0.0026477687, statistic_sign=-1),
                                40000: KstestResult(statistic=0.31035, pvalue=0.0, statistic_location=-0.0028390102, statistic_sign=-1),
                                50000: KstestResult(statistic=0.31112, pvalue=0.0, statistic_location=-0.0029932857, statistic_sign=-1),
                                60000: KstestResult(statistic=0.30635, pvalue=0.0, statistic_location=-0.0030834628, statistic_sign=-1),
                                70000: KstestResult(statistic=0.3050285714285714, pvalue=0.0, statistic_location=-0.0028338563, statistic_sign=-1),
                                80000: KstestResult(statistic=0.3086125, pvalue=0.0, statistic_location=-0.002670559, statistic_sign=-1),
                                90000: KstestResult(statistic=0.30432222222222227, pvalue=0.0, statistic_location=-0.002754704, statistic_sign=-1),
                                100000: KstestResult(statistic=0.30657999999999996, pvalue=0.0, statistic_location=-0.0030374937, statistic_sign=-1),
                                110000: KstestResult(statistic=0.30336363636363634, pvalue=0.0, statistic_location=-0.0030159252, statistic_sign=-1)},
                   'moments': {'mean_error': -0.41921854,
                               'means': [-0.0013864677, 1.2816979e-05],
                               'stds': [0.016771028, 0.0029382175],
                               'variance_ratio': 27.149988}},
 'originals': {'gan': {'mae': 0.023048492148518562,
                       'mse': 0.0009045902406796813,
                       'psnr': 30.321165084838867,
                       'rmse': 0.03007640689611435,
                       'ssim': 0.9525915384292603},
               'pca': {'mae': 0.004348712507635355,
                       'mse': 4.889603951596655e-05,
                       'psnr': 43.47279357910156,
                       'rmse': 0.006992570124566555,
                       'ssim': 0.9977636933326721}},
 'reconstructions': {'mae': 0.022380631417036057,
                     'mse': 0.0008548429468646646,
                     'psnr': 31.04666519165039,
                     'rmse': 0.029237696900963783,
                     'ssim': 0.9545780420303345},
 'residual_spectra_pcagan': {'cosine': [0.058551203,
                                        0.024428755,
                                        0.040733293,
                                        0.050879586,
                                        0.062139474,
                                        0.053220924,
                                        0.25160095,
                                        0.30929974,
                                        0.23995535,
                                        0.27158245,
                                        0.2123329],
                             'mae': [0.01057498,
                                     0.011935155,
                                     0.010144947,
                                     0.011211145,
                                     0.011156387,
                                     0.010125369,
                                     0.010022765,
                                     0.008441971,
                                     0.009453231,
                                     0.0103811,
                                     0.010566296],
                             'max_mae': 0.011935155,
                             'max_mse': 0.00040601648,
                             'max_rmse': 0.020149851,
                             'median_distance': 1.6639953,
                             'median_mae': 0.0103811,
                             'min_cosine': 0.024428755,
                             'mse': [0.00023328624,
                                     0.00037921502,
                                     0.00023624468,
                                     0.00028019628,
                                     0.00040601648,
                                     0.00027688802,
                                     0.00023236351,
                                     0.0001582134,
                                     0.0002931235,
                                     0.00024390101,
                                     0.00028846058],
                             'rmse': [0.015273711,
                                      0.019473445,
                                      0.0153702535,
                                      0.016739065,
                                      0.020149851,
                                      0.016639953,
                                      0.015243474,
                                      0.012578291,
                                      0.01712085,
                                      0.015617331,
                                      0.016984127]},
 'residuals': {'mae': 0.010364849120378494,
               'mse': 0.00027526443591341376,
               'psnr': 8.668869018554688,
               'rmse': 0.016591094434261322,
               'ssds': [31.150585, 0.94965285],
               'ssim': 0.32628026604652405},
 'spectra_pcagan': {'cosine': [0.99846315,
                               0.99865824,
                               0.9980843,
                               0.9954096,
                               0.9943059,
                               0.9958649,
                               0.98482573,
                               0.9856955,
                               0.98706573,
                               0.988087,
                               0.9893018],
                    'mae': [0.017721372,
                            0.017567867,
                            0.017625343,
                            0.02490699,
                            0.023547137,
                            0.02014378,
                            0.0264497,
                            0.025701575,
                            0.023425909,
                            0.023622718,
                            0.025474563],
                    'max_mae': 0.0264497,
                    'max_mse': 0.0011413983,
                    'max_rmse': 0.033784587,
                    'median_mae': 0.023547137,
                    'min_cosine': 0.98482573,
                    'mse': [0.0005247131,
                            0.0005381906,
                            0.0005157787,
                            0.0010053511,
                            0.00091800594,
                            0.00072173454,
                            0.0011413983,
                            0.0010389108,
                            0.00096191996,
                            0.00096061523,
                            0.0010766535],
                    'rmse': [0.022906616,
                             0.023198934,
                             0.022710763,
                             0.031707272,
                             0.030298613,
                             0.026865117,
                             0.033784587,
                             0.03223214,
                             0.031014834,
                             0.030993793,
                             0.032812398]},
 'spectra_realgan': {'cosine': [0.9984581,
                                0.9986554,
                                0.9980743,
                                0.9953859,
                                0.99427646,
                                0.9958381,
                                0.9834676,
                                0.9838166,
                                0.98543996,
                                0.98703104,
                                0.98846376],
                     'mae': [0.01776105,
                             0.017581858,
                             0.017673125,
                             0.024944488,
                             0.023610247,
                             0.020209735,
                             0.027729858,
                             0.027509784,
                             0.025184192,
                             0.024926096,
                             0.026402982],
                     'max_mae': 0.027729858,
                     'max_mse': 0.00124579,
                     'max_rmse': 0.03529575,
                     'median_mae': 0.024926096,
                     'min_cosine': 0.9834676,
                     'mse': [0.00052663725,
                             0.00053920137,
                             0.0005184876,
                             0.0010091491,
                             0.0009227438,
                             0.00072642736,
                             0.00124579,
                             0.0011789066,
                             0.0010824143,
                             0.001048085,
                             0.0011526513],
                     'rmse': [0.022948578,
                              0.02322071,
                              0.022770323,
                              0.031767108,
                              0.030376699,
                              0.026952317,
                              0.03529575,
                              0.03433521,
                              0.032900065,
                              0.03237414,
                              0.03395072]},
 'spectra_realpca': {'cosine': [0.9999947,
                                0.9999979,
                                0.99999267,
                                0.9999751,
                                0.99998426,
                                0.99997044,
                                0.9985143,
                                0.99840724,
                                0.9984143,
                                0.99876976,
                                0.9991493],
                     'mae': [0.0010534272,
                             0.000715983,
                             0.001095254,
                             0.0016460891,
                             0.0012564235,
                             0.0017419645,
                             0.008410009,
                             0.008514912,
                             0.008557384,
                             0.007891973,
                             0.006952423],
                     'max_mae': 0.008557384,
                     'max_mse': 0.000116914,
                     'max_rmse': 0.010812677,
                     'median_mae': 0.0017419645,
                     'min_cosine': 0.99840724,
                     'mse': [1.7830276e-06,
                             8.230201e-07,
                             1.9531146e-06,
                             4.333904e-06,
                             2.5211157e-06,
                             4.8758293e-06,
                             0.00011266394,
                             0.00011686871,
                             0.000116914,
                             9.8343095e-05,
                             7.67767e-05],
                     'rmse': [0.0013353006,
                              0.0009072046,
                              0.0013975388,
                              0.002081803,
                              0.0015878022,
                              0.002208128,
                              0.010614327,
                              0.010810583,
                              0.010812677,
                              0.009916808,
                              0.008762231]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_75.0

Running comparison for experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726
Directory path: experiments/inpainting/gann_4_night_20210905_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_75.0/images
Optimal number of principal components:  37
Reconstruction error:  4.376094
Energy conservation:  0.7508095
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_75.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9022391383209563, 2.4121776736961547],
                   'kl_div': 0.8899352,
                   'ks_tests': {10000: KstestResult(statistic=0.294, pvalue=1e-323, statistic_location=-0.004014073, statistic_sign=-1),
                                20000: KstestResult(statistic=0.30255, pvalue=0.0, statistic_location=-0.0033797314, statistic_sign=-1),
                                30000: KstestResult(statistic=0.29856666666666665, pvalue=0.0, statistic_location=-0.0038960227, statistic_sign=-1),
                                40000: KstestResult(statistic=0.30125, pvalue=0.0, statistic_location=-0.003512159, statistic_sign=-1),
                                50000: KstestResult(statistic=0.30455999999999994, pvalue=0.0, statistic_location=-0.003563264, statistic_sign=-1),
                                60000: KstestResult(statistic=0.3021833333333333, pvalue=0.0, statistic_location=-0.0035819886, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2974857142857143, pvalue=0.0, statistic_location=-0.0037733112, statistic_sign=-1),
                                80000: KstestResult(statistic=0.29823750000000004, pvalue=0.0, statistic_location=-0.0036910325, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2989777777777778, pvalue=0.0, statistic_location=-0.0034699398, statistic_sign=-1),
                                100000: KstestResult(statistic=0.29944, pvalue=0.0, statistic_location=-0.0037503364, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2988363636363637, pvalue=0.0, statistic_location=-0.0036452394, statistic_sign=-1),
                                120000: KstestResult(statistic=0.2969333333333334, pvalue=0.0, statistic_location=-0.0037510581, statistic_sign=-1),
                                130000: KstestResult(statistic=0.30089230769230774, pvalue=0.0, statistic_location=-0.0037864633, statistic_sign=-1),
                                140000: KstestResult(statistic=0.29774999999999996, pvalue=0.0, statistic_location=-0.003680258, statistic_sign=-1),
                                150000: KstestResult(statistic=0.3016, pvalue=0.0, statistic_location=-0.003570458, statistic_sign=-1),
                                160000: KstestResult(statistic=0.29706875, pvalue=0.0, statistic_location=-0.0037679337, statistic_sign=-1),
                                170000: KstestResult(statistic=0.3001235294117647, pvalue=0.0, statistic_location=-0.0035049692, statistic_sign=-1),
                                180000: KstestResult(statistic=0.30075, pvalue=0.0, statistic_location=-0.003693421, statistic_sign=-1),
                                190000: KstestResult(statistic=0.2990947368421053, pvalue=0.0, statistic_location=-0.0037885741, statistic_sign=-1),
                                200000: KstestResult(statistic=0.29751, pvalue=0.0, statistic_location=-0.0036866502, statistic_sign=-1),
                                210000: KstestResult(statistic=0.29754761904761906, pvalue=0.0, statistic_location=-0.0037399773, statistic_sign=-1),
                                220000: KstestResult(statistic=0.29967727272727274, pvalue=0.0, statistic_location=-0.0034547187, statistic_sign=-1)},
                   'moments': {'mean_error': -0.375409,
                               'means': [-0.0014589109, 2.539549e-06],
                               'stds': [0.01597184, 0.0031543556],
                               'variance_ratio': 20.16353}},
 'originals': {'gan': {'mae': 0.02928788773715496,
                       'mse': 0.0015978638548403978,
                       'psnr': 30.15612030029297,
                       'rmse': 0.039973288774490356,
                       'ssim': 0.8410401344299316},
               'pca': {'mae': 0.0051679364405572414,
                       'mse': 6.640469655394554e-05,
                       'psnr': 44.01885223388672,
                       'rmse': 0.00814890768378973,
                       'ssim': 0.9937222003936768}},
 'reconstructions': {'mae': 0.02848721295595169,
                     'mse': 0.0015319862868636847,
                     'psnr': 30.38829231262207,
                     'rmse': 0.039140596985816956,
                     'ssim': 0.8432669043540955},
 'residual_spectra_pcagan': {'cosine': [0.13623734,
                                        0.12128381,
                                        0.0138964765,
                                        0.024938928,
                                        0.047539864,
                                        0.05373078,
                                        0.02742433,
                                        0.0535372,
                                        0.057549447,
                                        0.074382745,
                                        0.062188074,
                                        0.28401253,
                                        0.34688148,
                                        0.24967796,
                                        0.27141342,
                                        0.2304812,
                                        0.27721295,
                                        0.26883027,
                                        0.32285506,
                                        0.31946722,
                                        0.2552452,
                                        0.23473379],
                             'mae': [0.010101165,
                                     0.009880089,
                                     0.011760659,
                                     0.012689445,
                                     0.011134481,
                                     0.00994233,
                                     0.011329321,
                                     0.009627669,
                                     0.010776323,
                                     0.011002168,
                                     0.009444167,
                                     0.009336129,
                                     0.007893274,
                                     0.0092981,
                                     0.010373926,
                                     0.01012168,
                                     0.0084373,
                                     0.010407651,
                                     0.008516242,
                                     0.008733046,
                                     0.010171559,
                                     0.010948915],
                             'max_mae': 0.012689445,
                             'max_mse': 0.00040893245,
                             'max_rmse': 0.020222079,
                             'median_distance': 1.5738316,
                             'median_mae': 0.010111422,
                             'min_cosine': 0.0138964765,
                             'mse': [0.00021447899,
                                     0.00025791067,
                                     0.00040893245,
                                     0.0003152977,
                                     0.0002920187,
                                     0.00019896706,
                                     0.00032248217,
                                     0.00019529156,
                                     0.00024853667,
                                     0.00034860533,
                                     0.00021644837,
                                     0.00017577386,
                                     0.00012437817,
                                     0.00026398283,
                                     0.00024683613,
                                     0.00025362294,
                                     0.00021106415,
                                     0.0002468539,
                                     0.00015033923,
                                     0.00017724629,
                                     0.00030776134,
                                     0.00027395572],
                             'rmse': [0.0146451015,
                                      0.016059598,
                                      0.020222079,
                                      0.017756624,
                                      0.017088555,
                                      0.014105569,
                                      0.017957788,
                                      0.013974676,
                                      0.015765047,
                                      0.018670976,
                                      0.014712185,
                                      0.013257974,
                                      0.011152497,
                                      0.016247548,
                                      0.015711019,
                                      0.015925543,
                                      0.014528047,
                                      0.015711585,
                                      0.01226129,
                                      0.0133133875,
                                      0.017543128,
                                      0.016551608]},
 'residuals': {'mae': 0.010087530128657818,
               'mse': 0.00024776291684247553,
               'psnr': 15.09996223449707,
               'rmse': 0.01574048586189747,
               'ssds': [56.58993, 2.1889825],
               'ssim': 0.3760949373245239},
 'spectra_pcagan': {'cosine': [0.99142945,
                               0.9904381,
                               0.9871951,
                               0.99796605,
                               0.99890393,
                               0.99846894,
                               0.9986067,
                               0.99805146,
                               0.9952279,
                               0.99368834,
                               0.995837,
                               0.98462284,
                               0.9855092,
                               0.98629606,
                               0.9869704,
                               0.9882304,
                               0.9898169,
                               0.98191696,
                               0.990578,
                               0.9921506,
                               0.9876161,
                               0.98651296],
                    'mae': [0.03304648,
                            0.025601113,
                            0.102318265,
                            0.023051215,
                            0.018338608,
                            0.017625881,
                            0.017874014,
                            0.01789341,
                            0.025329392,
                            0.025235588,
                            0.02108714,
                            0.02678909,
                            0.026119824,
                            0.024520077,
                            0.025187183,
                            0.026040949,
                            0.02443421,
                            0.031805947,
                            0.028056385,
                            0.027056376,
                            0.0283439,
                            0.03096365],
                    'max_mae': 0.102318265,
                    'max_mse': 0.011328928,
                    'max_rmse': 0.10643744,
                    'median_mae': 0.025465254,
                    'min_cosine': 0.98191696,
                    'mse': [0.001560896,
                            0.0010948335,
                            0.011328928,
                            0.0008603315,
                            0.0005656008,
                            0.0005181383,
                            0.00055577164,
                            0.00052979746,
                            0.0010281531,
                            0.0010235931,
                            0.000768023,
                            0.001155034,
                            0.0010572727,
                            0.0010423526,
                            0.0010667326,
                            0.0011158439,
                            0.0010328918,
                            0.0016796048,
                            0.0013554984,
                            0.0013123178,
                            0.001430762,
                            0.0016213201],
                    'rmse': [0.03950818,
                             0.033088267,
                             0.10643744,
                             0.029331408,
                             0.023782363,
                             0.02276265,
                             0.023574809,
                             0.02301733,
                             0.032064825,
                             0.031993642,
                             0.027713228,
                             0.033985794,
                             0.03251573,
                             0.032285485,
                             0.03266087,
                             0.03340425,
                             0.032138634,
                             0.04098298,
                             0.036817096,
                             0.036225926,
                             0.037825413,
                             0.04026562]},
 'spectra_realgan': {'cosine': [0.991234,
                                0.9902626,
                                0.9871953,
                                0.9979617,
                                0.9989008,
                                0.9984643,
                                0.99860394,
                                0.998041,
                                0.99520445,
                                0.9936565,
                                0.9958092,
                                0.98329705,
                                0.9835998,
                                0.98469776,
                                0.98593915,
                                0.98738843,
                                0.9882227,
                                0.98030233,
                                0.989524,
                                0.99125016,
                                0.9861597,
                                0.98525906],
                     'mae': [0.033293895,
                             0.025828512,
                             0.10232019,
                             0.02308644,
                             0.018353792,
                             0.017655713,
                             0.01789041,
                             0.017943969,
                             0.025359243,
                             0.02530277,
                             0.021159083,
                             0.028000256,
                             0.027902536,
                             0.026169267,
                             0.026349189,
                             0.026939942,
                             0.026175225,
                             0.0333342,
                             0.029743442,
                             0.029068222,
                             0.029867416,
                             0.03258977],
                     'max_mae': 0.10232019,
                     'max_mse': 0.011329138,
                     'max_rmse': 0.10643842,
                     'median_mae': 0.026262207,
                     'min_cosine': 0.98030233,
                     'mse': [0.001588716,
                             0.0011122464,
                             0.011329138,
                             0.0008625923,
                             0.00056717417,
                             0.0005198567,
                             0.0005567768,
                             0.0005326561,
                             0.0010319254,
                             0.0010287644,
                             0.0007730521,
                             0.0012569834,
                             0.0011995675,
                             0.0011607338,
                             0.0011529156,
                             0.0011925377,
                             0.0011627642,
                             0.0018270246,
                             0.0015063094,
                             0.0014590629,
                             0.0015643383,
                             0.0017678709],
                     'rmse': [0.039858703,
                              0.03335036,
                              0.10643842,
                              0.029369922,
                              0.02381542,
                              0.022800365,
                              0.02359612,
                              0.023079343,
                              0.032123595,
                              0.03207436,
                              0.027803814,
                              0.03545396,
                              0.034634773,
                              0.03406954,
                              0.033954613,
                              0.03453314,
                              0.03409933,
                              0.04274371,
                              0.038811203,
                              0.03819768,
                              0.039551716,
                              0.042046055]},
 'spectra_realpca': {'cosine': [0.9998558,
                                0.9997929,
                                0.99999934,
                                0.9999984,
                                0.9999985,
                                0.9999947,
                                0.9999979,
                                0.99999267,
                                0.9999751,
                                0.99998426,
                                0.99997044,
                                0.9985143,
                                0.99840724,
                                0.9984143,
                                0.99876976,
                                0.9991493,
                                0.99838734,
                                0.99845856,
                                0.9988427,
                                0.99902415,
                                0.9984794,
                                0.9986886],
                     'mae': [0.0033712978,
                             0.0036665145,
                             0.00037142434,
                             0.0006194582,
                             0.000632585,
                             0.0010534272,
                             0.000715983,
                             0.001095254,
                             0.0016460891,
                             0.0012564235,
                             0.0017419645,
                             0.008410009,
                             0.008514912,
                             0.008557384,
                             0.007891973,
                             0.006952423,
                             0.009033255,
                             0.009222136,
                             0.009958779,
                             0.010015078,
                             0.009323559,
                             0.009644698],
                     'max_mae': 0.010015078,
                     'max_mse': 0.0001637736,
                     'max_rmse': 0.012797406,
                     'median_mae': 0.005309469,
                     'min_cosine': 0.99838734,
                     'mse': [1.8374323e-05,
                             2.1647405e-05,
                             2.2119964e-07,
                             6.0983774e-07,
                             6.4244057e-07,
                             1.7830276e-06,
                             8.230201e-07,
                             1.9531146e-06,
                             4.333904e-06,
                             2.5211157e-06,
                             4.8758293e-06,
                             0.00011266394,
                             0.00011686871,
                             0.000116914,
                             9.8343095e-05,
                             7.67767e-05,
                             0.00013162925,
                             0.00013647648,
                             0.0001637736,
                             0.00016143757,
                             0.00013918403,
                             0.00014905092],
                     'rmse': [0.004286528,
                              0.004652677,
                              0.00047031866,
                              0.0007809211,
                              0.0008015239,
                              0.0013353006,
                              0.0009072046,
                              0.0013975388,
                              0.002081803,
                              0.0015878022,
                              0.002208128,
                              0.010614327,
                              0.010810583,
                              0.010812677,
                              0.009916808,
                              0.008762231,
                              0.011472979,
                              0.011682315,
                              0.012797406,
                              0.0127058085,
                              0.011797628,
                              0.0122086415]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_75.0

Running comparison for experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226
Directory path: experiments/inpainting/gann_4_night_20210905_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 75.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_75.0/images
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_75.0/images
Optimal number of principal components:  37
Reconstruction error:  4.376094
Energy conservation:  0.7508095
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_75.0
saved spectra in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_75.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_75.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_75.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.867696224533345, 2.3378512434837697],
                   'kl_div': 0.9224904,
                   'ks_tests': {10000: KstestResult(statistic=0.2928, pvalue=1e-323, statistic_location=-0.0040237326, statistic_sign=-1),
                                20000: KstestResult(statistic=0.28725, pvalue=0.0, statistic_location=-0.0033947444, statistic_sign=-1),
                                30000: KstestResult(statistic=0.28576666666666667, pvalue=0.0, statistic_location=-0.0032764636, statistic_sign=-1),
                                40000: KstestResult(statistic=0.29062499999999997, pvalue=0.0, statistic_location=-0.0031049456, statistic_sign=-1),
                                50000: KstestResult(statistic=0.29258, pvalue=0.0, statistic_location=-0.0031445194, statistic_sign=-1),
                                60000: KstestResult(statistic=0.28908333333333336, pvalue=0.0, statistic_location=-0.0029977602, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2869285714285714, pvalue=0.0, statistic_location=-0.0029915979, statistic_sign=-1),
                                80000: KstestResult(statistic=0.2880375, pvalue=0.0, statistic_location=-0.0027850126, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2896222222222222, pvalue=0.0, statistic_location=-0.0029743705, statistic_sign=-1),
                                100000: KstestResult(statistic=0.2869, pvalue=0.0, statistic_location=-0.0029322235, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2875909090909091, pvalue=0.0, statistic_location=-0.0029684184, statistic_sign=-1),
                                120000: KstestResult(statistic=0.28754166666666664, pvalue=0.0, statistic_location=-0.0032541417, statistic_sign=-1),
                                130000: KstestResult(statistic=0.28833846153846154, pvalue=0.0, statistic_location=-0.0031978087, statistic_sign=-1),
                                140000: KstestResult(statistic=0.28832142857142856, pvalue=0.0, statistic_location=-0.0029383034, statistic_sign=-1),
                                150000: KstestResult(statistic=0.28796, pvalue=0.0, statistic_location=-0.003100737, statistic_sign=-1),
                                160000: KstestResult(statistic=0.2904625, pvalue=0.0, statistic_location=-0.0031190068, statistic_sign=-1),
                                170000: KstestResult(statistic=0.2891941176470588, pvalue=0.0, statistic_location=-0.003058767, statistic_sign=-1),
                                180000: KstestResult(statistic=0.2870666666666667, pvalue=0.0, statistic_location=-0.002973429, statistic_sign=-1),
                                190000: KstestResult(statistic=0.2890473684210526, pvalue=0.0, statistic_location=-0.0030132532, statistic_sign=-1),
                                200000: KstestResult(statistic=0.289435, pvalue=0.0, statistic_location=-0.0030479147, statistic_sign=-1),
                                210000: KstestResult(statistic=0.2876714285714286, pvalue=0.0, statistic_location=-0.0030152556, statistic_sign=-1),
                                220000: KstestResult(statistic=0.2852818181818182, pvalue=0.0, statistic_location=-0.0033970987, statistic_sign=-1),
                                230000: KstestResult(statistic=0.2881434782608696, pvalue=0.0, statistic_location=-0.0032131514, statistic_sign=-1),
                                240000: KstestResult(statistic=0.28836666666666666, pvalue=0.0, statistic_location=-0.003019045, statistic_sign=-1),
                                250000: KstestResult(statistic=0.288636, pvalue=0.0, statistic_location=-0.003048704, statistic_sign=-1),
                                260000: KstestResult(statistic=0.28909615384615384, pvalue=0.0, statistic_location=-0.0030584931, statistic_sign=-1),
                                270000: KstestResult(statistic=0.29029629629629633, pvalue=0.0, statistic_location=-0.0030159457, statistic_sign=-1),
                                280000: KstestResult(statistic=0.28962142857142853, pvalue=0.0, statistic_location=-0.0030769072, statistic_sign=-1),
                                290000: KstestResult(statistic=0.2875379310344828, pvalue=0.0, statistic_location=-0.0030601025, statistic_sign=-1),
                                300000: KstestResult(statistic=0.2882133333333333, pvalue=0.0, statistic_location=-0.0030769072, statistic_sign=-1),
                                310000: KstestResult(statistic=0.28776129032258063, pvalue=0.0, statistic_location=-0.003072217, statistic_sign=-1),
                                320000: KstestResult(statistic=0.28859375, pvalue=0.0, statistic_location=-0.0030769072, statistic_sign=-1),
                                330000: KstestResult(statistic=0.2876878787878788, pvalue=0.0, statistic_location=-0.0029963297, statistic_sign=-1)},
                   'moments': {'mean_error': -0.15167886,
                               'means': [-0.00065364566, -1.2990146e-05],
                               'stds': [0.015172766, 0.0030322685],
                               'variance_ratio': 21.169495}},
 'originals': {'gan': {'mae': 0.0476018451154232,
                       'mse': 0.015234922058880329,
                       'psnr': 23.57074737548828,
                       'rmse': 0.12342982739210129,
                       'ssim': 0.8455874919891357},
               'pca': {'mae': 0.004812328610569239,
                       'mse': 6.095473509049043e-05,
                       'psnr': 47.86379623413086,
                       'rmse': 0.007807351183146238,
                       'ssim': 0.9947311878204346}},
 'reconstructions': {'mae': 0.046944864094257355,
                     'mse': 0.01517827995121479,
                     'psnr': 23.901643753051758,
                     'rmse': 0.12320016324520111,
                     'ssim': 0.8485621213912964},
 'residual_spectra_pcagan': {'cosine': [0.13778079,
                                        0.01880651,
                                        0.070040256,
                                        0.030786088,
                                        0.04997413,
                                        0.037078448,
                                        0.1529678,
                                        0.12947899,
                                        0.012555865,
                                        0.03293964,
                                        0.048360486,
                                        0.05403283,
                                        0.033580173,
                                        0.06133031,
                                        0.05930849,
                                        0.07647584,
                                        0.06757545,
                                        0.3078219,
                                        0.36840835,
                                        0.28022975,
                                        0.29222542,
                                        0.23711771,
                                        0.29785427,
                                        0.29193002,
                                        0.34625682,
                                        0.33282635,
                                        0.2548363,
                                        0.24150941,
                                        0.2832636,
                                        0.27283004,
                                        0.043308333,
                                        0.29352573,
                                        0.31891188],
                             'mae': [0.0088144,
                                     0.009118395,
                                     0.008256352,
                                     0.01023295,
                                     0.009072222,
                                     0.010218399,
                                     0.008936345,
                                     0.009245221,
                                     0.011257988,
                                     0.012264931,
                                     0.010836535,
                                     0.009628774,
                                     0.01070367,
                                     0.009139064,
                                     0.010122142,
                                     0.0103068575,
                                     0.009221736,
                                     0.008598365,
                                     0.0073467535,
                                     0.008605133,
                                     0.009647347,
                                     0.009627507,
                                     0.00806471,
                                     0.009646221,
                                     0.008070724,
                                     0.008243086,
                                     0.0099073425,
                                     0.010353793,
                                     0.009148787,
                                     0.0104250945,
                                     0.013187396,
                                     0.010609745,
                                     0.007947667],
                             'max_mae': 0.013187396,
                             'max_mse': 0.00045973607,
                             'max_rmse': 0.021441456,
                             'median_distance': 1.4473394,
                             'median_mae': 0.009627507,
                             'min_cosine': 0.012555865,
                             'mse': [0.00018299432,
                                     0.00017914128,
                                     0.00013939851,
                                     0.00026664048,
                                     0.00016519109,
                                     0.00031202965,
                                     0.00016839776,
                                     0.00021942797,
                                     0.00034188744,
                                     0.00029103205,
                                     0.00027353657,
                                     0.0001926748,
                                     0.00027394615,
                                     0.0001695379,
                                     0.00021254295,
                                     0.00030650734,
                                     0.00020717955,
                                     0.00015167262,
                                     0.000108204746,
                                     0.0002167046,
                                     0.00020195503,
                                     0.00023542748,
                                     0.00017968978,
                                     0.00020947914,
                                     0.00013196691,
                                     0.00015227993,
                                     0.00029238727,
                                     0.00024926988,
                                     0.00020004947,
                                     0.00025743307,
                                     0.00045973607,
                                     0.0002180646,
                                     0.0001558629],
                             'rmse': [0.01352754,
                                      0.013384367,
                                      0.011806715,
                                      0.01632913,
                                      0.012852669,
                                      0.017664362,
                                      0.012976816,
                                      0.014813101,
                                      0.018490199,
                                      0.017059661,
                                      0.01653894,
                                      0.013880734,
                                      0.01655132,
                                      0.013020672,
                                      0.014578853,
                                      0.017507352,
                                      0.014393733,
                                      0.012315543,
                                      0.010402151,
                                      0.01472089,
                                      0.014211088,
                                      0.0153436465,
                                      0.013404842,
                                      0.0144733945,
                                      0.011487685,
                                      0.012340175,
                                      0.017099336,
                                      0.015788283,
                                      0.014143884,
                                      0.016044721,
                                      0.021441456,
                                      0.014767011,
                                      0.012484507]},
 'residuals': {'mae': 0.009600170888006687,
               'mse': 0.00022188635193742812,
               'psnr': 15.579017639160156,
               'rmse': 0.014895849861204624,
               'ssds': [76.11101, 3.0342813],
               'ssim': 0.4782247245311737},
 'spectra_pcagan': {'cosine': [0.9956343,
                               0.9987676,
                               0.9988372,
                               0.99757004,
                               0.9983848,
                               0.99774784,
                               0.99229425,
                               0.9903333,
                               0.987506,
                               0.9980493,
                               0.9988872,
                               0.99843806,
                               0.99866825,
                               0.9981137,
                               0.9954213,
                               0.99412847,
                               0.99585795,
                               0.9852299,
                               0.98511684,
                               0.98714745,
                               0.98754597,
                               0.9889755,
                               0.98955566,
                               0.9834769,
                               0.99085,
                               0.99223614,
                               0.9872754,
                               0.98676056,
                               0.9878532,
                               0.95049953,
                               0.22046116,
                               0.952654,
                               0.98822784],
                    'mae': [0.01972744,
                            0.01587153,
                            0.014362869,
                            0.023805242,
                            0.01646659,
                            0.020163722,
                            0.031144848,
                            0.025654485,
                            0.101558596,
                            0.022758478,
                            0.018368026,
                            0.017745538,
                            0.017507847,
                            0.017533202,
                            0.024580916,
                            0.024129914,
                            0.020755846,
                            0.026235303,
                            0.02610721,
                            0.023454621,
                            0.02429425,
                            0.025737323,
                            0.023836514,
                            0.030053126,
                            0.02792185,
                            0.026821047,
                            0.028082397,
                            0.030509632,
                            0.026537104,
                            0.052219152,
                            0.6607747,
                            0.061356153,
                            0.023105104],
                    'max_mae': 0.6607747,
                    'max_mse': 0.45397392,
                    'max_rmse': 0.67377585,
                    'median_mae': 0.02429425,
                    'min_cosine': 0.22046116,
                    'mse': [0.0006665144,
                            0.00041945642,
                            0.00035432444,
                            0.0008333045,
                            0.00044399514,
                            0.0007139305,
                            0.0013810028,
                            0.0011042233,
                            0.011159827,
                            0.0008345109,
                            0.0005690003,
                            0.000529634,
                            0.00053359166,
                            0.0005084733,
                            0.0009807859,
                            0.00095122436,
                            0.0007493637,
                            0.0011129667,
                            0.0010808285,
                            0.0009561053,
                            0.0009998982,
                            0.0010870458,
                            0.0009954066,
                            0.001526636,
                            0.0013249654,
                            0.0012888855,
                            0.0014094027,
                            0.0015693108,
                            0.0012498933,
                            0.0035864427,
                            0.45397392,
                            0.005086311,
                            0.00090211985],
                    'rmse': [0.02581694,
                             0.020480635,
                             0.018823508,
                             0.028867014,
                             0.021071192,
                             0.026719479,
                             0.037161846,
                             0.033229854,
                             0.10564008,
                             0.028887901,
                             0.023853727,
                             0.023013778,
                             0.023099603,
                             0.022549354,
                             0.031317502,
                             0.030841926,
                             0.027374508,
                             0.033361156,
                             0.032875955,
                             0.030920953,
                             0.031621166,
                             0.032970376,
                             0.031550065,
                             0.03907219,
                             0.036400072,
                             0.03590105,
                             0.03754201,
                             0.03961453,
                             0.035353832,
                             0.059886917,
                             0.67377585,
                             0.07131838,
                             0.03003531]},
 'spectra_realgan': {'cosine': [0.99551606,
                                0.99876493,
                                0.99883413,
                                0.997566,
                                0.9983778,
                                0.99773633,
                                0.9921049,
                                0.99015915,
                                0.9875064,
                                0.99804497,
                                0.99888396,
                                0.9984333,
                                0.9986654,
                                0.99810326,
                                0.9953988,
                                0.994098,
                                0.9958298,
                                0.9838775,
                                0.98321396,
                                0.9855097,
                                0.9865277,
                                0.98814803,
                                0.9879648,
                                0.9818447,
                                0.9897903,
                                0.9913576,
                                0.98584014,
                                0.98552793,
                                0.98651755,
                                0.94852936,
                                0.22058095,
                                0.95217735,
                                0.9869008],
                     'mae': [0.020037163,
                             0.015912298,
                             0.014391309,
                             0.02383715,
                             0.016507246,
                             0.020245578,
                             0.03139955,
                             0.025884777,
                             0.10156025,
                             0.022796238,
                             0.018384373,
                             0.017779708,
                             0.01753409,
                             0.017570792,
                             0.024619982,
                             0.024194844,
                             0.020818587,
                             0.027516488,
                             0.027907956,
                             0.025198987,
                             0.025496673,
                             0.026611973,
                             0.02561454,
                             0.03171153,
                             0.029572068,
                             0.028770914,
                             0.02958039,
                             0.032048162,
                             0.028307134,
                             0.052727368,
                             0.6607541,
                             0.061087567,
                             0.024481047],
                     'max_mae': 0.6607541,
                     'max_mse': 0.45394385,
                     'max_rmse': 0.67375356,
                     'median_mae': 0.025496673,
                     'min_cosine': 0.22058095,
                     'mse': [0.00068472617,
                             0.00042061144,
                             0.0003551947,
                             0.0008353174,
                             0.00044600377,
                             0.0007178382,
                             0.0014078106,
                             0.0011215064,
                             0.0111599825,
                             0.0008367442,
                             0.00057064893,
                             0.00053135736,
                             0.00053462305,
                             0.00051128387,
                             0.0009844021,
                             0.00095617236,
                             0.0007544017,
                             0.0012169129,
                             0.001222649,
                             0.0010774499,
                             0.0010844469,
                             0.0011621618,
                             0.0011252312,
                             0.0016751301,
                             0.0014774735,
                             0.0014325716,
                             0.0015413531,
                             0.0017133727,
                             0.0013875432,
                             0.0037367165,
                             0.45394385,
                             0.005122593,
                             0.001004422],
                     'rmse': [0.026167274,
                              0.020508815,
                              0.01884661,
                              0.028901858,
                              0.021118801,
                              0.026792502,
                              0.037520804,
                              0.0334889,
                              0.10564082,
                              0.02892653,
                              0.02388826,
                              0.02305119,
                              0.023121918,
                              0.022611586,
                              0.031375185,
                              0.030922037,
                              0.027466375,
                              0.034884278,
                              0.034966398,
                              0.03282453,
                              0.03293094,
                              0.034090493,
                              0.033544466,
                              0.040928353,
                              0.038437918,
                              0.037849326,
                              0.03926007,
                              0.041392908,
                              0.03724974,
                              0.061128687,
                              0.67375356,
                              0.0715723,
                              0.031692617]},
 'spectra_realpca': {'cosine': [0.99989575,
                                0.99999744,
                                0.99999577,
                                0.99999595,
                                0.9999937,
                                0.99999267,
                                0.9998558,
                                0.9997929,
                                0.99999934,
                                0.9999984,
                                0.9999985,
                                0.9999947,
                                0.9999979,
                                0.99999267,
                                0.9999751,
                                0.99998426,
                                0.99997044,
                                0.9985143,
                                0.99840724,
                                0.9984143,
                                0.99876976,
                                0.9991493,
                                0.99838734,
                                0.99845856,
                                0.9988427,
                                0.99902415,
                                0.9984794,
                                0.9986886,
                                0.9986024,
                                0.99830604,
                                0.99997336,
                                0.9985202,
                                0.9985482],
                     'mae': [0.0031454263,
                             0.0007373916,
                             0.00090732984,
                             0.00086358807,
                             0.0010268812,
                             0.0011517572,
                             0.0033712978,
                             0.0036665145,
                             0.00037142434,
                             0.0006194582,
                             0.000632585,
                             0.0010534272,
                             0.000715983,
                             0.001095254,
                             0.0016460891,
                             0.0012564235,
                             0.0017419645,
                             0.008410009,
                             0.008514912,
                             0.008557384,
                             0.007891973,
                             0.006952423,
                             0.009033255,
                             0.009222136,
                             0.009958779,
                             0.010015078,
                             0.009323559,
                             0.009644698,
                             0.009488003,
                             0.008830904,
                             0.0011180174,
                             0.009519771,
                             0.008323157],
                     'max_mae': 0.010015078,
                     'max_mse': 0.0001637736,
                     'max_rmse': 0.012797406,
                     'median_mae': 0.0033712978,
                     'min_cosine': 0.99830604,
                     'mse': [1.590104e-05,
                             8.77703e-07,
                             1.3200578e-06,
                             1.1892789e-06,
                             1.690278e-06,
                             2.1108972e-06,
                             1.8374323e-05,
                             2.1647405e-05,
                             2.2119964e-07,
                             6.0983774e-07,
                             6.4244057e-07,
                             1.7830276e-06,
                             8.230201e-07,
                             1.9531146e-06,
                             4.333904e-06,
                             2.5211157e-06,
                             4.8758293e-06,
                             0.00011266394,
                             0.00011686871,
                             0.000116914,
                             9.8343095e-05,
                             7.67767e-05,
                             0.00013162925,
                             0.00013647648,
                             0.0001637736,
                             0.00016143757,
                             0.00013918403,
                             0.00014905092,
                             0.00014374306,
                             0.0001259726,
                             2.0219632e-06,
                             0.00014514827,
                             0.00011062762],
                     'rmse': [0.003987611,
                              0.000936858,
                              0.0011489376,
                              0.0010905407,
                              0.001300107,
                              0.0014528927,
                              0.004286528,
                              0.004652677,
                              0.00047031866,
                              0.0007809211,
                              0.0008015239,
                              0.0013353006,
                              0.0009072046,
                              0.0013975388,
                              0.002081803,
                              0.0015878022,
                              0.002208128,
                              0.010614327,
                              0.010810583,
                              0.010812677,
                              0.009916808,
                              0.008762231,
                              0.011472979,
                              0.011682315,
                              0.012797406,
                              0.0127058085,
                              0.011797628,
                              0.0122086415,
                              0.01198929,
                              0.011223751,
                              0.0014219575,
                              0.01204775,
                              0.010517966]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_75.0
