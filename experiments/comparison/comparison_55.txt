
Running comparison for experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805
Directory path: experiments/inpainting/gann_4_night_20180708_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_55.0/images
Optimal number of principal components:  13
Reconstruction error:  24.740229
Energy conservation:  0.5505255
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_55.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [3.933204310299706, 3.2380521776903515],
                   'kl_div': 0.25567195,
                   'ks_tests': {10000: KstestResult(statistic=0.1561, pvalue=1.1140769342723562e-106, statistic_location=0.00738652, statistic_sign=1),
                                20000: KstestResult(statistic=0.15664999999999996, pvalue=8.656783244419264e-215, statistic_location=0.0069940058, statistic_sign=1),
                                30000: KstestResult(statistic=0.1583, pvalue=0.0, statistic_location=0.0071007647, statistic_sign=1),
                                40000: KstestResult(statistic=0.16095000000000004, pvalue=0.0, statistic_location=0.007971681, statistic_sign=1),
                                50000: KstestResult(statistic=0.15648000000000006, pvalue=0.0, statistic_location=0.0071004843, statistic_sign=1),
                                60000: KstestResult(statistic=0.15613333333333324, pvalue=0.0, statistic_location=0.007948109, statistic_sign=1),
                                70000: KstestResult(statistic=0.15577142857142867, pvalue=0.0, statistic_location=0.007606972, statistic_sign=1),
                                80000: KstestResult(statistic=0.15797499999999998, pvalue=0.0, statistic_location=0.0066317488, statistic_sign=1),
                                90000: KstestResult(statistic=0.15904444444444443, pvalue=0.0, statistic_location=0.0070690527, statistic_sign=1),
                                100000: KstestResult(statistic=0.15644000000000002, pvalue=0.0, statistic_location=0.0064765583, statistic_sign=1),
                                110000: KstestResult(statistic=0.1575727272727273, pvalue=0.0, statistic_location=0.0074573345, statistic_sign=1)},
                   'moments': {'mean_error': 0.081561945,
                               'means': [-1.1889718e-05, -0.00015241769],
                               'stds': [0.017084507, 0.00624488],
                               'variance_ratio': 6.3329725}},
 'originals': {'gan': {'mae': 0.044734351336956024,
                       'mse': 0.00500925537198782,
                       'psnr': 27.338207244873047,
                       'rmse': 0.0707760900259018,
                       'ssim': 0.9471726417541504},
               'pca': {'mae': 0.013159286230802536,
                       'mse': 0.00030305024120025337,
                       'psnr': 39.49566650390625,
                       'rmse': 0.017408337444067,
                       'ssim': 0.9967907071113586}},
 'reconstructions': {'mae': 0.041841771453619,
                     'mse': 0.004742657300084829,
                     'psnr': 27.550596237182617,
                     'rmse': 0.06886695325374603,
                     'ssim': 0.9495745897293091},
 'residual_spectra_pcagan': {'cosine': [0.3473119,
                                        0.0735697,
                                        0.3605883,
                                        0.3852768,
                                        0.39418605,
                                        0.3827963,
                                        0.39248574,
                                        0.43396395,
                                        0.41961512,
                                        0.44156632,
                                        0.29558203],
                             'mae': [0.010730487,
                                     0.013340338,
                                     0.009005384,
                                     0.00991208,
                                     0.009951076,
                                     0.008415045,
                                     0.008696238,
                                     0.008567171,
                                     0.008742141,
                                     0.00854922,
                                     0.011260023],
                             'max_mae': 0.013340338,
                             'max_mse': 0.0004177664,
                             'max_rmse': 0.020439334,
                             'median_distance': 1.455501,
                             'median_mae': 0.009005384,
                             'min_cosine': 0.0735697,
                             'mse': [0.00029149494,
                                     0.0004177664,
                                     0.00021184828,
                                     0.00023900402,
                                     0.00033153128,
                                     0.00018681018,
                                     0.00016373247,
                                     0.00018046475,
                                     0.00019935939,
                                     0.00017260254,
                                     0.00041299776],
                             'rmse': [0.017073223,
                                      0.020439334,
                                      0.014555009,
                                      0.0154597545,
                                      0.018208,
                                      0.013667853,
                                      0.012795799,
                                      0.013433717,
                                      0.014119469,
                                      0.013137829,
                                      0.020322347]},
 'residuals': {'mae': 0.009742654860019684,
               'mse': 0.00025523744989186525,
               'psnr': 21.3366756439209,
               'rmse': 0.015976153314113617,
               'ssds': [32.106564, 4.2923546],
               'ssim': 0.4676477313041687},
 'spectra_pcagan': {'cosine': [0.99315774,
                               0.9993965,
                               0.99795836,
                               0.9909625,
                               0.9948019,
                               0.9975653,
                               0.9971081,
                               0.9748344,
                               0.99526703,
                               0.9919024,
                               0.985434],
                    'mae': [0.028671421,
                            0.022051929,
                            0.036992487,
                            0.023876015,
                            0.016875628,
                            0.038602784,
                            0.030018067,
                            0.1933236,
                            0.022691352,
                            0.020346867,
                            0.026809325],
                    'max_mae': 0.1933236,
                    'max_mse': 0.039437555,
                    'max_rmse': 0.19858891,
                    'median_mae': 0.026809325,
                    'min_cosine': 0.9748344,
                    'mse': [0.001507636,
                            0.00069424644,
                            0.002183901,
                            0.0010114358,
                            0.00057804154,
                            0.0022668326,
                            0.0014747467,
                            0.039437555,
                            0.0009323001,
                            0.0007267411,
                            0.0013557991],
                    'rmse': [0.03882829,
                             0.026348557,
                             0.046732225,
                             0.03180308,
                             0.024042495,
                             0.047611266,
                             0.03840243,
                             0.19858891,
                             0.03053359,
                             0.026958136,
                             0.03682118]},
 'spectra_realgan': {'cosine': [0.99175346,
                                0.9993864,
                                0.9974738,
                                0.9885626,
                                0.992407,
                                0.99695754,
                                0.996352,
                                0.97315854,
                                0.99355114,
                                0.98881245,
                                0.9826634],
                     'mae': [0.032277416,
                             0.021971023,
                             0.039228965,
                             0.027653707,
                             0.021448666,
                             0.04044802,
                             0.03310232,
                             0.19353077,
                             0.027468923,
                             0.024600843,
                             0.030347247],
                     'max_mae': 0.19353077,
                     'max_mse': 0.039805513,
                     'max_rmse': 0.1995132,
                     'median_mae': 0.030347247,
                     'min_cosine': 0.97315854,
                     'mse': [0.001811758,
                             0.00069365103,
                             0.0024994803,
                             0.0012799344,
                             0.00081188173,
                             0.002571155,
                             0.0017536087,
                             0.039805513,
                             0.0012606264,
                             0.0009979114,
                             0.0016162823],
                     'rmse': [0.04256475,
                              0.026337255,
                              0.049994804,
                              0.03577617,
                              0.028493538,
                              0.050706558,
                              0.04187611,
                              0.1995132,
                              0.035505302,
                              0.031589735,
                              0.040203013]},
 'spectra_realpca': {'cosine': [0.99849606,
                                0.9999902,
                                0.99947345,
                                0.997289,
                                0.9976831,
                                0.99932504,
                                0.99911404,
                                0.99827105,
                                0.998323,
                                0.99656874,
                                0.996856],
                     'mae': [0.014436444,
                             0.0018061962,
                             0.015721083,
                             0.013731447,
                             0.012007393,
                             0.015733592,
                             0.015509613,
                             0.014362335,
                             0.01428723,
                             0.013711784,
                             0.013445041],
                     'max_mae': 0.015733592,
                     'max_mse': 0.00039840513,
                     'max_rmse': 0.019960089,
                     'median_mae': 0.01428723,
                     'min_cosine': 0.99656874,
                     'mse': [0.0003321513,
                             5.2665528e-06,
                             0.00039840513,
                             0.00030212075,
                             0.00023287244,
                             0.00039471572,
                             0.00038651424,
                             0.00036148977,
                             0.00032678354,
                             0.00029997114,
                             0.00029326195],
                     'rmse': [0.018225018,
                              0.002294897,
                              0.019960089,
                              0.017381622,
                              0.015260158,
                              0.019867454,
                              0.019659964,
                              0.019012885,
                              0.018077156,
                              0.017319676,
                              0.017124893]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_55.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628
Directory path: experiments/inpainting/gann_4_night_20180708_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_55.0/images
Optimal number of principal components:  13
Reconstruction error:  24.740229
Energy conservation:  0.5505255
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_55.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.079875858281184, 3.22656754339982],
                   'kl_div': 0.38543096,
                   'ks_tests': {10000: KstestResult(statistic=0.2099, pvalue=3.458794151196446e-193, statistic_location=-0.0071195117, statistic_sign=-1),
                                20000: KstestResult(statistic=0.2051, pvalue=0.0, statistic_location=-0.0075197294, statistic_sign=-1),
                                30000: KstestResult(statistic=0.20046666666666668, pvalue=0.0, statistic_location=-0.007291317, statistic_sign=-1),
                                40000: KstestResult(statistic=0.19824999999999998, pvalue=0.0, statistic_location=-0.008082643, statistic_sign=-1),
                                50000: KstestResult(statistic=0.20422, pvalue=0.0, statistic_location=-0.0073880404, statistic_sign=-1),
                                60000: KstestResult(statistic=0.20245, pvalue=0.0, statistic_location=-0.0075802207, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2021857142857143, pvalue=0.0, statistic_location=-0.0073472504, statistic_sign=-1),
                                80000: KstestResult(statistic=0.203175, pvalue=0.0, statistic_location=-0.007919867, statistic_sign=-1),
                                90000: KstestResult(statistic=0.20442222222222223, pvalue=0.0, statistic_location=-0.0075188056, statistic_sign=-1),
                                100000: KstestResult(statistic=0.20382, pvalue=0.0, statistic_location=-0.007409308, statistic_sign=-1),
                                110000: KstestResult(statistic=0.20488181818181816, pvalue=0.0, statistic_location=-0.007498108, statistic_sign=-1),
                                120000: KstestResult(statistic=0.2013333333333333, pvalue=0.0, statistic_location=-0.0073524565, statistic_sign=-1),
                                130000: KstestResult(statistic=0.20453846153846156, pvalue=0.0, statistic_location=-0.007488124, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2074642857142857, pvalue=0.0, statistic_location=-0.008092284, statistic_sign=-1),
                                150000: KstestResult(statistic=0.20678666666666667, pvalue=0.0, statistic_location=-0.0072242357, statistic_sign=-1),
                                160000: KstestResult(statistic=0.20215000000000002, pvalue=0.0, statistic_location=-0.0075017503, statistic_sign=-1),
                                170000: KstestResult(statistic=0.20428235294117647, pvalue=0.0, statistic_location=-0.0075186775, statistic_sign=-1),
                                180000: KstestResult(statistic=0.20291666666666663, pvalue=0.0, statistic_location=-0.007315159, statistic_sign=-1),
                                190000: KstestResult(statistic=0.20247894736842104, pvalue=0.0, statistic_location=-0.007385509, statistic_sign=-1),
                                200000: KstestResult(statistic=0.203825, pvalue=0.0, statistic_location=-0.007932166, statistic_sign=-1),
                                210000: KstestResult(statistic=0.20460952380952382, pvalue=0.0, statistic_location=-0.007409211, statistic_sign=-1),
                                220000: KstestResult(statistic=0.2026090909090909, pvalue=0.0, statistic_location=-0.007561281, statistic_sign=-1)},
                   'moments': {'mean_error': -0.15418693,
                               'means': [-0.0014181881, -0.00010102044],
                               'stds': [0.01881039, 0.0062530776],
                               'variance_ratio': 7.437112}},
 'originals': {'gan': {'mae': 0.041415736079216,
                       'mse': 0.003690463025122881,
                       'psnr': 29.55628204345703,
                       'rmse': 0.06074918061494827,
                       'ssim': 0.9063164591789246},
               'pca': {'mae': 0.01189412921667099,
                       'mse': 0.0002645536442287266,
                       'psnr': 41.159271240234375,
                       'rmse': 0.016265105456113815,
                       'ssim': 0.9938334226608276}},
 'reconstructions': {'mae': 0.03931526094675064,
                     'mse': 0.0034528470132499933,
                     'psnr': 30.002639770507812,
                     'rmse': 0.058760929852724075,
                     'ssim': 0.9098153114318848},
 'residual_spectra_pcagan': {'cosine': [0.2744954,
                                        0.115704544,
                                        0.3607014,
                                        0.28833145,
                                        0.30274537,
                                        0.40624467,
                                        0.057793394,
                                        0.30884743,
                                        0.3713412,
                                        0.35990638,
                                        0.37015176,
                                        0.33329967,
                                        0.38395044,
                                        0.3218235,
                                        0.33896485,
                                        0.36294338,
                                        0.38500944,
                                        0.3667346,
                                        0.48831734,
                                        0.055911984,
                                        0.39357245,
                                        0.47981068],
                             'mae': [0.013356216,
                                     0.01507696,
                                     0.012315668,
                                     0.013867563,
                                     0.011983072,
                                     0.009898415,
                                     0.014438629,
                                     0.011277541,
                                     0.011880239,
                                     0.011727733,
                                     0.009855029,
                                     0.011177141,
                                     0.010048878,
                                     0.011129065,
                                     0.011838401,
                                     0.011678152,
                                     0.009685986,
                                     0.011333098,
                                     0.009985306,
                                     0.012773438,
                                     0.0097317975,
                                     0.00949102],
                             'max_mae': 0.01507696,
                             'max_mse': 0.00048639145,
                             'max_rmse': 0.022054285,
                             'median_distance': 1.7743464,
                             'median_mae': 0.011505624,
                             'min_cosine': 0.055911984,
                             'mse': [0.0003671753,
                                     0.00048639145,
                                     0.0003834456,
                                     0.00036773883,
                                     0.00031644272,
                                     0.00020037875,
                                     0.0004360746,
                                     0.00031322235,
                                     0.00029581983,
                                     0.00042554783,
                                     0.00021906519,
                                     0.00026712054,
                                     0.00024807968,
                                     0.00040835148,
                                     0.00031779145,
                                     0.00032929506,
                                     0.00024626215,
                                     0.00028432897,
                                     0.00020009499,
                                     0.0003295511,
                                     0.0002841041,
                                     0.00023814874],
                             'rmse': [0.019161819,
                                      0.022054285,
                                      0.019581767,
                                      0.019176519,
                                      0.017788837,
                                      0.01415552,
                                      0.0208824,
                                      0.017698089,
                                      0.017199414,
                                      0.02062881,
                                      0.014800851,
                                      0.016343823,
                                      0.015750546,
                                      0.020207709,
                                      0.017826706,
                                      0.018146489,
                                      0.015692743,
                                      0.016862057,
                                      0.0141454935,
                                      0.018153543,
                                      0.016855389,
                                      0.015432069]},
 'residuals': {'mae': 0.01157042384147644,
               'mse': 0.0003165650414302945,
               'psnr': 20.611164093017578,
               'rmse': 0.017792275175452232,
               'ssds': [78.28488, 8.604421],
               'ssim': 0.3410426676273346},
 'spectra_pcagan': {'cosine': [0.99909776,
                               0.9994092,
                               0.98503214,
                               0.9947139,
                               0.9968817,
                               0.993133,
                               0.999177,
                               0.99680644,
                               0.9848028,
                               0.9911499,
                               0.99669284,
                               0.9948568,
                               0.97833467,
                               0.9919278,
                               0.95971364,
                               0.9800638,
                               0.9894769,
                               0.9810976,
                               0.9910574,
                               0.9993198,
                               0.9854356,
                               0.99827343],
                    'mae': [0.015871154,
                            0.020091264,
                            0.02545034,
                            0.04843809,
                            0.057614893,
                            0.030342538,
                            0.019972341,
                            0.05450388,
                            0.032430224,
                            0.022397904,
                            0.047299847,
                            0.042983692,
                            0.17940445,
                            0.030722033,
                            0.057724103,
                            0.032962505,
                            0.025512876,
                            0.04050192,
                            0.023888668,
                            0.017690392,
                            0.022342578,
                            0.016790066],
                    'max_mae': 0.17940445,
                    'max_mse': 0.03485393,
                    'max_rmse': 0.18669207,
                    'median_mae': 0.030532286,
                    'min_cosine': 0.95971364,
                    'mse': [0.0004125699,
                            0.00058703555,
                            0.001107045,
                            0.003655565,
                            0.0055053914,
                            0.0015545785,
                            0.0006218214,
                            0.0043424387,
                            0.0017429492,
                            0.00091107894,
                            0.0033005502,
                            0.002918128,
                            0.03485393,
                            0.0018009319,
                            0.0042683086,
                            0.0018820637,
                            0.001133629,
                            0.002488594,
                            0.00095676706,
                            0.00047582082,
                            0.00095379876,
                            0.00048964255],
                    'rmse': [0.020311818,
                             0.024228817,
                             0.033272285,
                             0.060461268,
                             0.07419833,
                             0.039428145,
                             0.024936346,
                             0.06589718,
                             0.041748643,
                             0.030184085,
                             0.057450414,
                             0.0540197,
                             0.18669207,
                             0.04243739,
                             0.06533229,
                             0.043382756,
                             0.03366941,
                             0.04988581,
                             0.030931652,
                             0.021813318,
                             0.030883633,
                             0.022127869]},
 'spectra_realgan': {'cosine': [0.99894327,
                                0.99940234,
                                0.98145306,
                                0.99415404,
                                0.9965239,
                                0.991695,
                                0.99916625,
                                0.99628097,
                                0.9822146,
                                0.9884819,
                                0.9960184,
                                0.994058,
                                0.97664857,
                                0.99022675,
                                0.95710987,
                                0.97679853,
                                0.98647827,
                                0.9784223,
                                0.9882579,
                                0.99931574,
                                0.98092294,
                                0.997411],
                     'mae': [0.017146079,
                             0.020168345,
                             0.028706223,
                             0.050800398,
                             0.059404463,
                             0.033509545,
                             0.019985925,
                             0.055692036,
                             0.03531207,
                             0.02621587,
                             0.048675243,
                             0.044680182,
                             0.17965956,
                             0.03404801,
                             0.05834632,
                             0.035970166,
                             0.028960349,
                             0.04211721,
                             0.02753194,
                             0.017711489,
                             0.026319312,
                             0.020185553],
                     'max_mae': 0.17965956,
                     'max_mse': 0.035222843,
                     'max_rmse': 0.1876775,
                     'median_mae': 0.03377878,
                     'min_cosine': 0.95710987,
                     'mse': [0.00047266626,
                             0.00059270527,
                             0.0013652463,
                             0.00403947,
                             0.005812725,
                             0.0018575729,
                             0.0006232374,
                             0.004649755,
                             0.0020181779,
                             0.0011730588,
                             0.0036266067,
                             0.0031747771,
                             0.035222843,
                             0.0021111243,
                             0.004506634,
                             0.0021810574,
                             0.0014073155,
                             0.0027539334,
                             0.0012253452,
                             0.00047697028,
                             0.0012224708,
                             0.0006764928],
                     'rmse': [0.02174089,
                              0.02434554,
                              0.03694924,
                              0.06355683,
                              0.07624123,
                              0.04309957,
                              0.024964724,
                              0.068189114,
                              0.044924136,
                              0.034249946,
                              0.060221314,
                              0.05634516,
                              0.1876775,
                              0.045946974,
                              0.06713147,
                              0.046701793,
                              0.037514202,
                              0.052477933,
                              0.035004932,
                              0.021839648,
                              0.03496385,
                              0.026009476]},
 'spectra_realpca': {'cosine': [0.999855,
                                0.9999973,
                                0.9966793,
                                0.99939656,
                                0.99962324,
                                0.99849606,
                                0.9999902,
                                0.99947345,
                                0.997289,
                                0.9976831,
                                0.99932504,
                                0.99911404,
                                0.99827105,
                                0.998323,
                                0.99656874,
                                0.996856,
                                0.99687207,
                                0.9971235,
                                0.99749017,
                                0.99999785,
                                0.9955789,
                                0.9991658],
                     'mae': [0.0061270352,
                             0.0010843779,
                             0.012251034,
                             0.016100701,
                             0.017140046,
                             0.014436444,
                             0.0018061962,
                             0.015721083,
                             0.013731447,
                             0.012007393,
                             0.015733592,
                             0.015509613,
                             0.014362335,
                             0.01428723,
                             0.013711784,
                             0.013445041,
                             0.01367129,
                             0.013869209,
                             0.012101767,
                             0.00086512987,
                             0.0128151765,
                             0.010892901],
                     'max_mae': 0.017140046,
                     'max_mse': 0.00047310776,
                     'max_rmse': 0.02175104,
                     'median_mae': 0.013691537,
                     'min_cosine': 0.9955789,
                     'mse': [6.049119e-05,
                             1.8744743e-06,
                             0.00024107091,
                             0.00041772876,
                             0.00047310776,
                             0.0003321513,
                             5.2665528e-06,
                             0.00039840513,
                             0.00030212075,
                             0.00023287244,
                             0.00039471572,
                             0.00038651424,
                             0.00036148977,
                             0.00032678354,
                             0.00029997114,
                             0.00029326195,
                             0.00029917713,
                             0.00030469717,
                             0.0002325269,
                             1.2060055e-06,
                             0.00026373842,
                             0.00019100995],
                     'rmse': [0.0077776085,
                              0.0013691144,
                              0.015526459,
                              0.020438414,
                              0.02175104,
                              0.018225018,
                              0.002294897,
                              0.019960089,
                              0.017381622,
                              0.015260158,
                              0.019867454,
                              0.019659964,
                              0.019012885,
                              0.018077156,
                              0.017319676,
                              0.017124893,
                              0.017296737,
                              0.017455578,
                              0.015248833,
                              0.0010981829,
                              0.016240025,
                              0.013820635]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_55.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354
Directory path: experiments/inpainting/gann_4_night_20180708_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_55.0/images
Optimal number of principal components:  13
Reconstruction error:  24.740229
Energy conservation:  0.5505255
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_55.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.061857105227111, 3.2691413788720136],
                   'kl_div': 0.33948344,
                   'ks_tests': {10000: KstestResult(statistic=0.1831, pvalue=7.654135182749848e-147, statistic_location=-0.0077219997, statistic_sign=-1),
                                20000: KstestResult(statistic=0.17905, pvalue=5.975479444079356e-281, statistic_location=-0.0072061317, statistic_sign=-1),
                                30000: KstestResult(statistic=0.18356666666666666, pvalue=0.0, statistic_location=-0.0072307014, statistic_sign=-1),
                                40000: KstestResult(statistic=0.17610000000000003, pvalue=0.0, statistic_location=-0.0074966997, statistic_sign=-1),
                                50000: KstestResult(statistic=0.17796, pvalue=0.0, statistic_location=-0.0072095883, statistic_sign=-1),
                                60000: KstestResult(statistic=0.18135, pvalue=0.0, statistic_location=-0.007832721, statistic_sign=-1),
                                70000: KstestResult(statistic=0.17840000000000003, pvalue=0.0, statistic_location=-0.0072012977, statistic_sign=-1),
                                80000: KstestResult(statistic=0.175725, pvalue=0.0, statistic_location=-0.007192513, statistic_sign=-1),
                                90000: KstestResult(statistic=0.18043333333333333, pvalue=0.0, statistic_location=-0.007440267, statistic_sign=-1),
                                100000: KstestResult(statistic=0.18062, pvalue=0.0, statistic_location=-0.0076214243, statistic_sign=-1),
                                110000: KstestResult(statistic=0.17959090909090908, pvalue=0.0, statistic_location=-0.0075830757, statistic_sign=-1),
                                120000: KstestResult(statistic=0.17765833333333336, pvalue=0.0, statistic_location=-0.0074091363, statistic_sign=-1),
                                130000: KstestResult(statistic=0.18193846153846155, pvalue=0.0, statistic_location=-0.007694355, statistic_sign=-1),
                                140000: KstestResult(statistic=0.18038571428571426, pvalue=0.0, statistic_location=-0.007247273, statistic_sign=-1),
                                150000: KstestResult(statistic=0.17822666666666667, pvalue=0.0, statistic_location=-0.0071028434, statistic_sign=-1),
                                160000: KstestResult(statistic=0.180725, pvalue=0.0, statistic_location=-0.007520445, statistic_sign=-1),
                                170000: KstestResult(statistic=0.17681764705882352, pvalue=0.0, statistic_location=-0.0076322313, statistic_sign=-1),
                                180000: KstestResult(statistic=0.18007777777777775, pvalue=0.0, statistic_location=-0.007980259, statistic_sign=-1),
                                190000: KstestResult(statistic=0.1809473684210526, pvalue=0.0, statistic_location=-0.007821552, statistic_sign=-1),
                                200000: KstestResult(statistic=0.180345, pvalue=0.0, statistic_location=-0.0072064316, statistic_sign=-1),
                                210000: KstestResult(statistic=0.17947619047619046, pvalue=0.0, statistic_location=-0.0075876433, statistic_sign=-1),
                                220000: KstestResult(statistic=0.17763636363636362, pvalue=0.0, statistic_location=-0.0074691987, statistic_sign=-1),
                                230000: KstestResult(statistic=0.1785695652173913, pvalue=0.0, statistic_location=-0.008064723, statistic_sign=-1),
                                240000: KstestResult(statistic=0.17833749999999998, pvalue=0.0, statistic_location=-0.007960875, statistic_sign=-1),
                                250000: KstestResult(statistic=0.17887999999999998, pvalue=0.0, statistic_location=-0.007196891, statistic_sign=-1),
                                260000: KstestResult(statistic=0.17835384615384614, pvalue=0.0, statistic_location=-0.007395847, statistic_sign=-1),
                                270000: KstestResult(statistic=0.17876666666666668, pvalue=0.0, statistic_location=-0.0076935776, statistic_sign=-1),
                                280000: KstestResult(statistic=0.18076071428571427, pvalue=0.0, statistic_location=-0.007497315, statistic_sign=-1),
                                290000: KstestResult(statistic=0.17868620689655174, pvalue=0.0, statistic_location=-0.007247638, statistic_sign=-1),
                                300000: KstestResult(statistic=0.17827, pvalue=0.0, statistic_location=-0.007205856, statistic_sign=-1),
                                310000: KstestResult(statistic=0.1775, pvalue=0.0, statistic_location=-0.007390364, statistic_sign=-1),
                                320000: KstestResult(statistic=0.17958437500000002, pvalue=0.0, statistic_location=-0.007294953, statistic_sign=-1),
                                330000: KstestResult(statistic=0.1785090909090909, pvalue=0.0, statistic_location=-0.0072054947, statistic_sign=-1)},
                   'moments': {'mean_error': -0.04162131,
                               'means': [-0.0005078844, -3.0286052e-05],
                               'stds': [0.017889043, 0.006553229],
                               'variance_ratio': 6.414694}},
 'originals': {'gan': {'mae': 0.03434796258807182,
                       'mse': 0.0026877636555582285,
                       'psnr': 30.955209732055664,
                       'rmse': 0.05184364691376686,
                       'ssim': 0.9331125020980835},
               'pca': {'mae': 0.011109936982393265,
                       'mse': 0.00023351795971393585,
                       'psnr': 41.78458023071289,
                       'rmse': 0.015281294472515583,
                       'ssim': 0.9954299330711365}},
 'reconstructions': {'mae': 0.03197595477104187,
                     'mse': 0.00247265980578959,
                     'psnr': 31.53614044189453,
                     'rmse': 0.04972584545612335,
                     'ssim': 0.9358773827552795},
 'residual_spectra_pcagan': {'cosine': [0.5734774,
                                        0.18736501,
                                        0.4712658,
                                        0.39554626,
                                        0.45412248,
                                        0.38546735,
                                        0.2699027,
                                        0.1129897,
                                        0.36687225,
                                        0.2857349,
                                        0.3148631,
                                        0.41970015,
                                        0.054306407,
                                        0.31455737,
                                        0.39565778,
                                        0.38936067,
                                        0.38740692,
                                        0.33635837,
                                        0.3901642,
                                        0.33352846,
                                        0.35307223,
                                        0.3752553,
                                        0.40114146,
                                        0.3838762,
                                        0.49613625,
                                        0.04613175,
                                        0.39879173,
                                        0.47421512,
                                        0.46474147,
                                        0.5288196,
                                        0.5345095,
                                        0.547242,
                                        0.050930187],
                             'mae': [0.008279508,
                                     0.011440692,
                                     0.008679945,
                                     0.010205145,
                                     0.009489601,
                                     0.012666913,
                                     0.013491953,
                                     0.01497833,
                                     0.012161662,
                                     0.013870617,
                                     0.01158899,
                                     0.009564529,
                                     0.01427389,
                                     0.011124226,
                                     0.011313123,
                                     0.011190065,
                                     0.009440101,
                                     0.011040968,
                                     0.009779785,
                                     0.010823425,
                                     0.011567691,
                                     0.011398287,
                                     0.00944407,
                                     0.011058622,
                                     0.009861025,
                                     0.012575586,
                                     0.009549227,
                                     0.009504092,
                                     0.009490647,
                                     0.008785248,
                                     0.0078904005,
                                     0.008829272,
                                     0.013431066],
                             'max_mae': 0.01497833,
                             'max_mse': 0.0004680188,
                             'max_rmse': 0.021633742,
                             'median_distance': 1.6334672,
                             'median_mae': 0.011040968,
                             'min_cosine': 0.04613175,
                             'mse': [0.0001474846,
                                     0.0002475607,
                                     0.00017221611,
                                     0.0003028898,
                                     0.00018179651,
                                     0.00036829428,
                                     0.00037794365,
                                     0.0004680188,
                                     0.00036947083,
                                     0.00037438606,
                                     0.0002963018,
                                     0.00018997045,
                                     0.000420183,
                                     0.00030125692,
                                     0.0002527084,
                                     0.0003537519,
                                     0.00019475522,
                                     0.00026682147,
                                     0.00023405897,
                                     0.00037489613,
                                     0.00029297642,
                                     0.00031658934,
                                     0.00022415952,
                                     0.0002601653,
                                     0.0001922486,
                                     0.00032298503,
                                     0.0002750747,
                                     0.0002494257,
                                     0.00021822259,
                                     0.00015729258,
                                     0.0001667855,
                                     0.00019655883,
                                     0.00036434454],
                             'rmse': [0.012144324,
                                      0.015734062,
                                      0.013123114,
                                      0.01740373,
                                      0.013483194,
                                      0.019190995,
                                      0.019440772,
                                      0.021633742,
                                      0.019221624,
                                      0.01934906,
                                      0.01721342,
                                      0.013782977,
                                      0.020498365,
                                      0.017356755,
                                      0.015896805,
                                      0.018808294,
                                      0.013955473,
                                      0.016334672,
                                      0.015298986,
                                      0.019362235,
                                      0.017116554,
                                      0.017792957,
                                      0.014971958,
                                      0.01612964,
                                      0.013865374,
                                      0.017971784,
                                      0.016585376,
                                      0.015793217,
                                      0.014772359,
                                      0.012541634,
                                      0.012914546,
                                      0.014019944,
                                      0.019087812]},
 'residuals': {'mae': 0.01087238360196352,
               'mse': 0.00027671499992720783,
               'psnr': 21.519123077392578,
               'rmse': 0.016634752973914146,
               'ssds': [105.69071, 14.172049],
               'ssim': 0.35622429847717285},
 'spectra_pcagan': {'cosine': [0.9982393,
                               0.9992559,
                               0.98745286,
                               0.9956635,
                               0.9868338,
                               0.9988454,
                               0.9990767,
                               0.9994155,
                               0.98488325,
                               0.99466544,
                               0.9969015,
                               0.9931774,
                               0.999185,
                               0.99681103,
                               0.9851283,
                               0.99160624,
                               0.99675655,
                               0.99485177,
                               0.97828305,
                               0.99216896,
                               0.9601961,
                               0.9807056,
                               0.98967534,
                               0.9812661,
                               0.9910247,
                               0.9993156,
                               0.9852643,
                               0.99823046,
                               0.9887116,
                               0.9967612,
                               0.9968396,
                               0.9989855,
                               0.9996891],
                    'mae': [0.014615836,
                            0.014638738,
                            0.020387832,
                            0.01791161,
                            0.020611124,
                            0.0154203335,
                            0.016098944,
                            0.019825185,
                            0.025558496,
                            0.048546858,
                            0.057412233,
                            0.030179907,
                            0.019985104,
                            0.053794526,
                            0.032111485,
                            0.021944994,
                            0.04700968,
                            0.043434624,
                            0.18000492,
                            0.029931817,
                            0.05741478,
                            0.03243037,
                            0.025199084,
                            0.04061889,
                            0.023957014,
                            0.01780708,
                            0.02227295,
                            0.016775766,
                            0.021205937,
                            0.01681901,
                            0.018827545,
                            0.015648466,
                            0.016805347],
                    'max_mae': 0.18000492,
                    'max_mse': 0.035087056,
                    'max_rmse': 0.18731539,
                    'median_mae': 0.021944994,
                    'min_cosine': 0.9601961,
                    'mse': [0.00036117755,
                            0.00034210685,
                            0.00071491033,
                            0.00056991645,
                            0.0007426256,
                            0.00044154882,
                            0.00042591523,
                            0.0005733449,
                            0.0011141722,
                            0.0036873317,
                            0.005461017,
                            0.0015411167,
                            0.00062088476,
                            0.0042587994,
                            0.0017054863,
                            0.0008580673,
                            0.003260339,
                            0.0029476278,
                            0.035087056,
                            0.0017267063,
                            0.0042193844,
                            0.001817723,
                            0.0011023645,
                            0.002467882,
                            0.00096232106,
                            0.00048063818,
                            0.00096060295,
                            0.0004944576,
                            0.0007548869,
                            0.00048395022,
                            0.0005966961,
                            0.0004050516,
                            0.00041167368],
                    'rmse': [0.01900467,
                             0.018496132,
                             0.026737807,
                             0.023872923,
                             0.027251158,
                             0.021013062,
                             0.020637713,
                             0.023944622,
                             0.033379216,
                             0.0607234,
                             0.073898695,
                             0.03925706,
                             0.02491756,
                             0.06525948,
                             0.041297533,
                             0.029292786,
                             0.057099376,
                             0.05429206,
                             0.18731539,
                             0.041553654,
                             0.06495679,
                             0.042634763,
                             0.033201873,
                             0.04967778,
                             0.0310213,
                             0.021923462,
                             0.030993596,
                             0.022236403,
                             0.027475204,
                             0.02199887,
                             0.024427364,
                             0.020125894,
                             0.020289743]},
 'spectra_realgan': {'cosine': [0.9972508,
                                0.9992217,
                                0.9832243,
                                0.9942407,
                                0.9827068,
                                0.99848765,
                                0.9989239,
                                0.99940866,
                                0.981297,
                                0.9941067,
                                0.9965379,
                                0.99172515,
                                0.99917454,
                                0.99628705,
                                0.98253846,
                                0.98896176,
                                0.9960904,
                                0.9940449,
                                0.9766165,
                                0.9904791,
                                0.95758724,
                                0.9774088,
                                0.98670197,
                                0.97857785,
                                0.9882232,
                                0.99931186,
                                0.9807606,
                                0.99736637,
                                0.9840904,
                                0.9953628,
                                0.9951784,
                                0.99834573,
                                0.9996884],
                     'mae': [0.01854198,
                             0.014985778,
                             0.023866238,
                             0.021071851,
                             0.024249308,
                             0.018311145,
                             0.017341811,
                             0.019904904,
                             0.028784158,
                             0.050913114,
                             0.059168078,
                             0.03345968,
                             0.019981595,
                             0.055011444,
                             0.03497756,
                             0.025771726,
                             0.048374493,
                             0.04506426,
                             0.18023531,
                             0.033359133,
                             0.05806259,
                             0.03555152,
                             0.02864439,
                             0.04216679,
                             0.02758377,
                             0.017824937,
                             0.026277814,
                             0.02017742,
                             0.02529138,
                             0.020647043,
                             0.022136098,
                             0.018928431,
                             0.016816907],
                     'max_mae': 0.18023531,
                     'max_mse': 0.035449803,
                     'max_rmse': 0.18828118,
                     'median_mae': 0.025771726,
                     'min_cosine': 0.95758724,
                     'mse': [0.00055797707,
                             0.00035868314,
                             0.00095437886,
                             0.0007570537,
                             0.0009759421,
                             0.0005737491,
                             0.00048503513,
                             0.0005789536,
                             0.0013730456,
                             0.004070556,
                             0.0057761464,
                             0.0018476741,
                             0.0006221682,
                             0.0045668185,
                             0.0019810996,
                             0.0011185808,
                             0.0035820708,
                             0.0032059634,
                             0.035449803,
                             0.0020360278,
                             0.004457984,
                             0.0021198776,
                             0.0013743723,
                             0.0027345,
                             0.0012311836,
                             0.00048168088,
                             0.0012288577,
                             0.0006819425,
                             0.0010366923,
                             0.0006882518,
                             0.0008001526,
                             0.0005767722,
                             0.0004122014],
                     'rmse': [0.023621539,
                              0.018938933,
                              0.030893022,
                              0.027514609,
                              0.031240072,
                              0.02395306,
                              0.022023514,
                              0.024061454,
                              0.03705463,
                              0.06380091,
                              0.076000966,
                              0.04298458,
                              0.0249433,
                              0.06757824,
                              0.044509545,
                              0.03344519,
                              0.059850402,
                              0.056621227,
                              0.18828118,
                              0.045122366,
                              0.06676814,
                              0.04604213,
                              0.03707253,
                              0.052292448,
                              0.035088226,
                              0.02194723,
                              0.035055067,
                              0.026114028,
                              0.032197706,
                              0.026234554,
                              0.02828697,
                              0.024016082,
                              0.020302743]},
 'spectra_realpca': {'cosine': [0.9990598,
                                0.99997747,
                                0.99547684,
                                0.9984612,
                                0.99554443,
                                0.99967504,
                                0.999855,
                                0.9999973,
                                0.9966793,
                                0.99939656,
                                0.99962324,
                                0.99849606,
                                0.9999902,
                                0.99947345,
                                0.997289,
                                0.9976831,
                                0.99932504,
                                0.99911404,
                                0.99827105,
                                0.998323,
                                0.99656874,
                                0.996856,
                                0.99687207,
                                0.9971235,
                                0.99749017,
                                0.99999785,
                                0.9955789,
                                0.9991658,
                                0.9955438,
                                0.99859023,
                                0.9983489,
                                0.99938774,
                                0.9999993],
                     'mae': [0.010809037,
                             0.0025281152,
                             0.012520232,
                             0.01121875,
                             0.0124389175,
                             0.008571122,
                             0.0061270352,
                             0.0010843779,
                             0.012251034,
                             0.016100701,
                             0.017140046,
                             0.014436444,
                             0.0018061962,
                             0.015721083,
                             0.013731447,
                             0.012007393,
                             0.015733592,
                             0.015509613,
                             0.014362335,
                             0.01428723,
                             0.013711784,
                             0.013445041,
                             0.01367129,
                             0.013869209,
                             0.012101767,
                             0.00086512987,
                             0.0128151765,
                             0.010892901,
                             0.012858136,
                             0.011405036,
                             0.011556202,
                             0.010474503,
                             0.0005770122],
                     'max_mae': 0.017140046,
                     'max_mse': 0.00047310776,
                     'max_rmse': 0.02175104,
                     'median_mae': 0.0124389175,
                     'min_cosine': 0.99547684,
                     'mse': [0.00018880212,
                             1.0233087e-05,
                             0.00025278248,
                             0.00020166092,
                             0.00024897757,
                             0.000117724725,
                             6.049119e-05,
                             1.8744743e-06,
                             0.00024107091,
                             0.00041772876,
                             0.00047310776,
                             0.0003321513,
                             5.2665528e-06,
                             0.00039840513,
                             0.00030212075,
                             0.00023287244,
                             0.00039471572,
                             0.00038651424,
                             0.00036148977,
                             0.00032678354,
                             0.00029997114,
                             0.00029326195,
                             0.00029917713,
                             0.00030469717,
                             0.0002325269,
                             1.2060055e-06,
                             0.00026373842,
                             0.00019100995,
                             0.00026688405,
                             0.00020893221,
                             0.00021285465,
                             0.00017652015,
                             5.3872975e-07],
                     'rmse': [0.013740528,
                              0.0031989196,
                              0.015899135,
                              0.014200737,
                              0.015779022,
                              0.010850103,
                              0.0077776085,
                              0.0013691144,
                              0.015526459,
                              0.020438414,
                              0.02175104,
                              0.018225018,
                              0.002294897,
                              0.019960089,
                              0.017381622,
                              0.015260158,
                              0.019867454,
                              0.019659964,
                              0.019012885,
                              0.018077156,
                              0.017319676,
                              0.017124893,
                              0.017296737,
                              0.017455578,
                              0.015248833,
                              0.0010981829,
                              0.016240025,
                              0.013820635,
                              0.016336586,
                              0.014454488,
                              0.014589539,
                              0.013286089,
                              0.00073398213]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_55.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516
Directory path: experiments/inpainting/gann_4_night_20180722_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_55.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_55.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.35918432275619, 3.1215890132546327],
                   'kl_div': 0.8423621,
                   'ks_tests': {10000: KstestResult(statistic=0.301, pvalue=1e-323, statistic_location=0.00874018, statistic_sign=1),
                                20000: KstestResult(statistic=0.2973, pvalue=0.0, statistic_location=0.008846423, statistic_sign=1),
                                30000: KstestResult(statistic=0.3049333333333334, pvalue=0.0, statistic_location=0.008711049, statistic_sign=1),
                                40000: KstestResult(statistic=0.3000750000000001, pvalue=0.0, statistic_location=0.008701768, statistic_sign=1),
                                50000: KstestResult(statistic=0.30178000000000005, pvalue=0.0, statistic_location=0.008112694, statistic_sign=1),
                                60000: KstestResult(statistic=0.3019666666666666, pvalue=0.0, statistic_location=0.008747961, statistic_sign=1),
                                70000: KstestResult(statistic=0.3016714285714286, pvalue=0.0, statistic_location=0.00844541, statistic_sign=1),
                                80000: KstestResult(statistic=0.30327499999999996, pvalue=0.0, statistic_location=0.0082498975, statistic_sign=1),
                                90000: KstestResult(statistic=0.30428888888888894, pvalue=0.0, statistic_location=0.008770529, statistic_sign=1),
                                100000: KstestResult(statistic=0.3029700000000001, pvalue=0.0, statistic_location=0.008808844, statistic_sign=1),
                                110000: KstestResult(statistic=0.3018545454545455, pvalue=0.0, statistic_location=0.0086704455, statistic_sign=1)},
                   'moments': {'mean_error': 0.08277822,
                               'means': [-0.00073593855, -0.00044577167],
                               'stds': [0.022726193, 0.005489738],
                               'variance_ratio': 8.24979}},
 'originals': {'gan': {'mae': 0.05885758250951767,
                       'mse': 0.005448393989354372,
                       'psnr': 27.10418128967285,
                       'rmse': 0.07381323724985123,
                       'ssim': 0.603545069694519},
               'pca': {'mae': 0.012983637861907482,
                       'mse': 0.0002722899953369051,
                       'psnr': 40.598304748535156,
                       'rmse': 0.016501212492585182,
                       'ssim': 0.9844791293144226}},
 'reconstructions': {'mae': 0.057177815586328506,
                     'mse': 0.005125264637172222,
                     'psnr': 27.851459503173828,
                     'rmse': 0.07159095257520676,
                     'ssim': 0.6051655411720276},
 'residual_spectra_pcagan': {'cosine': [0.26564148,
                                        0.23854306,
                                        0.23416865,
                                        0.26053408,
                                        0.25381,
                                        0.33885944,
                                        0.29297134,
                                        0.24404314,
                                        0.2251663,
                                        0.22150944,
                                        0.2624583],
                             'mae': [0.014994153,
                                     0.017118374,
                                     0.017104134,
                                     0.016188318,
                                     0.014930034,
                                     0.014704486,
                                     0.013270199,
                                     0.018236991,
                                     0.020036701,
                                     0.018978633,
                                     0.016830673],
                             'max_mae': 0.020036701,
                             'max_mse': 0.0006272451,
                             'max_rmse': 0.025044862,
                             'median_distance': 2.189767,
                             'median_mae': 0.016830673,
                             'min_cosine': 0.22150944,
                             'mse': [0.0003872383,
                                     0.0006108163,
                                     0.0005075031,
                                     0.00041695996,
                                     0.00047950787,
                                     0.00036319596,
                                     0.0003557844,
                                     0.0005323883,
                                     0.0006272451,
                                     0.0005663711,
                                     0.0004724926],
                             'rmse': [0.019678371,
                                      0.024714697,
                                      0.022527829,
                                      0.020419598,
                                      0.021897668,
                                      0.0190577,
                                      0.018862247,
                                      0.023073541,
                                      0.025044862,
                                      0.023798551,
                                      0.021736896]},
 'residuals': {'mae': 0.016581155359745026,
               'mse': 0.0004835911968257278,
               'psnr': 8.197175025939941,
               'rmse': 0.021990707144141197,
               'ssds': [56.87184, 3.3369234],
               'ssim': 0.12163029611110687},
 'spectra_pcagan': {'cosine': [0.99116933,
                               0.9842978,
                               0.96088547,
                               0.95188564,
                               0.95586,
                               0.972211,
                               0.975154,
                               0.93962836,
                               0.9159561,
                               0.91690403,
                               0.9272211],
                    'mae': [0.071225174,
                            0.07258539,
                            0.06246844,
                            0.06437354,
                            0.045106705,
                            0.042673133,
                            0.03895635,
                            0.054263283,
                            0.06242841,
                            0.059908032,
                            0.05496742],
                    'max_mae': 0.07258539,
                    'max_mse': 0.007976555,
                    'max_rmse': 0.08931156,
                    'median_mae': 0.059908032,
                    'min_cosine': 0.9159561,
                    'mse': [0.0075000906,
                            0.007976555,
                            0.005692697,
                            0.006373456,
                            0.0031035342,
                            0.0027325316,
                            0.0024625135,
                            0.004419792,
                            0.0059709065,
                            0.005377533,
                            0.004768304],
                    'rmse': [0.08660306,
                             0.08931156,
                             0.075449966,
                             0.07983393,
                             0.055709373,
                             0.052273624,
                             0.04962372,
                             0.066481516,
                             0.07727164,
                             0.07333166,
                             0.069052905]},
 'spectra_realgan': {'cosine': [0.99050224,
                                0.98320454,
                                0.958425,
                                0.9485156,
                                0.95228004,
                                0.96986884,
                                0.97265184,
                                0.9365318,
                                0.912984,
                                0.91408354,
                                0.92231876],
                     'mae': [0.073525995,
                             0.07423982,
                             0.06392931,
                             0.066407725,
                             0.046533234,
                             0.044256676,
                             0.041072655,
                             0.05594315,
                             0.06368616,
                             0.06099438,
                             0.056844275],
                     'max_mae': 0.07423982,
                     'max_mse': 0.00842498,
                     'max_rmse': 0.09178769,
                     'median_mae': 0.06099438,
                     'min_cosine': 0.912984,
                     'mse': [0.008046477,
                             0.00842498,
                             0.0059988564,
                             0.0067990287,
                             0.0033501007,
                             0.0030101966,
                             0.0027172633,
                             0.004679983,
                             0.006192801,
                             0.005587246,
                             0.0051254076],
                     'rmse': [0.08970216,
                              0.09178769,
                              0.07745229,
                              0.08245622,
                              0.057880055,
                              0.05486526,
                              0.052127376,
                              0.068410404,
                              0.07869435,
                              0.07474788,
                              0.07159195]},
 'spectra_realpca': {'cosine': [0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349],
                     'mae': [0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197],
                     'max_mae': 0.015567541,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.012521197,
                     'min_cosine': 0.9963109,
                     'mse': [0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102],
                     'rmse': [0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_55.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115
Directory path: experiments/inpainting/gann_4_night_20180722_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_55.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_55.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.22363691969865, 3.112562869251242],
                   'kl_div': 0.6277143,
                   'ks_tests': {10000: KstestResult(statistic=0.2541, pvalue=6.414419874041901e-284, statistic_location=0.008102104, statistic_sign=1),
                                20000: KstestResult(statistic=0.2510500000000001, pvalue=0.0, statistic_location=0.0088564595, statistic_sign=1),
                                30000: KstestResult(statistic=0.25370000000000004, pvalue=0.0, statistic_location=0.00814515, statistic_sign=1),
                                40000: KstestResult(statistic=0.2537750000000001, pvalue=0.0, statistic_location=0.00862585, statistic_sign=1),
                                50000: KstestResult(statistic=0.2531199999999999, pvalue=0.0, statistic_location=0.008311856, statistic_sign=1),
                                60000: KstestResult(statistic=0.25278333333333336, pvalue=0.0, statistic_location=0.008485798, statistic_sign=1),
                                70000: KstestResult(statistic=0.2523428571428571, pvalue=0.0, statistic_location=0.008408322, statistic_sign=1),
                                80000: KstestResult(statistic=0.251425, pvalue=0.0, statistic_location=0.008502156, statistic_sign=1),
                                90000: KstestResult(statistic=0.25445555555555555, pvalue=0.0, statistic_location=0.008404488, statistic_sign=1),
                                100000: KstestResult(statistic=0.25111000000000006, pvalue=0.0, statistic_location=0.008667776, statistic_sign=1),
                                110000: KstestResult(statistic=0.25339999999999996, pvalue=0.0, statistic_location=0.008485571, statistic_sign=1),
                                120000: KstestResult(statistic=0.2506666666666667, pvalue=0.0, statistic_location=0.008400586, statistic_sign=1),
                                130000: KstestResult(statistic=0.25138461538461543, pvalue=0.0, statistic_location=0.008110917, statistic_sign=1),
                                140000: KstestResult(statistic=0.2541785714285715, pvalue=0.0, statistic_location=0.00833746, statistic_sign=1),
                                150000: KstestResult(statistic=0.2536466666666667, pvalue=0.0, statistic_location=0.008299056, statistic_sign=1),
                                160000: KstestResult(statistic=0.25339999999999996, pvalue=0.0, statistic_location=0.008486006, statistic_sign=1),
                                170000: KstestResult(statistic=0.2540117647058824, pvalue=0.0, statistic_location=0.008084377, statistic_sign=1),
                                180000: KstestResult(statistic=0.2535722222222222, pvalue=0.0, statistic_location=0.008113654, statistic_sign=1),
                                190000: KstestResult(statistic=0.2528842105263157, pvalue=0.0, statistic_location=0.008058108, statistic_sign=1),
                                200000: KstestResult(statistic=0.25172000000000005, pvalue=0.0, statistic_location=0.008589283, statistic_sign=1),
                                210000: KstestResult(statistic=0.2526142857142857, pvalue=0.0, statistic_location=0.008400586, statistic_sign=1),
                                220000: KstestResult(statistic=0.25258181818181824, pvalue=0.0, statistic_location=0.008482646, statistic_sign=1)},
                   'moments': {'mean_error': 0.0038906129,
                               'means': [-0.00054423965, -5.0476283e-05],
                               'stds': [0.019667108, 0.0054564234],
                               'variance_ratio': 8.458123}},
 'originals': {'gan': {'mae': 0.05455929413437843,
                       'mse': 0.004739472642540932,
                       'psnr': 27.725784301757812,
                       'rmse': 0.06884382665157318,
                       'ssim': 0.6566916704177856},
               'pca': {'mae': 0.013096767477691174,
                       'mse': 0.00027656604652293026,
                       'psnr': 40.53063201904297,
                       'rmse': 0.016630275174975395,
                       'ssim': 0.9780802726745605}},
 'reconstructions': {'mae': 0.05278368294239044,
                     'mse': 0.004443435464054346,
                     'psnr': 28.471435546875,
                     'rmse': 0.0666591003537178,
                     'ssim': 0.6628926396369934},
 'residual_spectra_pcagan': {'cosine': [0.28260374,
                                        0.25427267,
                                        0.268355,
                                        0.29584593,
                                        0.23188978,
                                        0.28962916,
                                        0.25852224,
                                        0.26286912,
                                        0.29332796,
                                        0.2820993,
                                        0.37338552,
                                        0.32056358,
                                        0.26874948,
                                        0.25312474,
                                        0.2513672,
                                        0.27952856,
                                        0.23953755,
                                        0.28502464,
                                        0.30253372,
                                        0.32720825,
                                        0.27045548,
                                        0.29371408],
                             'mae': [0.010502031,
                                     0.010798579,
                                     0.010070845,
                                     0.010413214,
                                     0.012834576,
                                     0.012951301,
                                     0.0151773235,
                                     0.014890109,
                                     0.013906689,
                                     0.012997799,
                                     0.012823609,
                                     0.011811436,
                                     0.016060349,
                                     0.017822467,
                                     0.016626589,
                                     0.01516656,
                                     0.016007427,
                                     0.013797997,
                                     0.013872792,
                                     0.012407163,
                                     0.016223252,
                                     0.01292536],
                             'max_mae': 0.017822467,
                             'max_mse': 0.0005019679,
                             'max_rmse': 0.02240464,
                             'median_distance': 1.8121607,
                             'median_mae': 0.013397898,
                             'min_cosine': 0.23188978,
                             'mse': [0.00025930666,
                                     0.00030546763,
                                     0.00030148434,
                                     0.00024392085,
                                     0.00033087173,
                                     0.0003042353,
                                     0.0004983933,
                                     0.0003948954,
                                     0.00032153615,
                                     0.00038831035,
                                     0.0002838249,
                                     0.00029352694,
                                     0.00043116504,
                                     0.0005019679,
                                     0.00044528552,
                                     0.0003979254,
                                     0.00041768374,
                                     0.00035424353,
                                     0.0003210409,
                                     0.00029152032,
                                     0.00044081043,
                                     0.0003259229],
                             'rmse': [0.016103001,
                                      0.017477632,
                                      0.017363304,
                                      0.015617966,
                                      0.01818988,
                                      0.017442342,
                                      0.022324724,
                                      0.019871976,
                                      0.01793143,
                                      0.019705592,
                                      0.016847104,
                                      0.017132629,
                                      0.020764515,
                                      0.02240464,
                                      0.02110179,
                                      0.019948067,
                                      0.020437313,
                                      0.018821359,
                                      0.017917614,
                                      0.017073967,
                                      0.020995487,
                                      0.018053336]},
 'residuals': {'mae': 0.013640339486300945,
               'mse': 0.0003569700347725302,
               'psnr': 20.099227905273438,
               'rmse': 0.0188936498016119,
               'ssds': [85.1597, 6.550493],
               'ssim': 0.16781511902809143},
 'spectra_pcagan': {'cosine': [0.9902773,
                               0.99058205,
                               0.98593557,
                               0.98166245,
                               0.98475355,
                               0.99134403,
                               0.98469067,
                               0.9618693,
                               0.9533671,
                               0.9566785,
                               0.97290313,
                               0.9757846,
                               0.94132704,
                               0.91703165,
                               0.91814286,
                               0.9270977,
                               0.9028449,
                               0.9609457,
                               0.9464992,
                               0.9642788,
                               0.9262062,
                               0.9555533],
                    'mae': [0.04954987,
                            0.04831482,
                            0.04154204,
                            0.037994385,
                            0.056879994,
                            0.070389315,
                            0.07150371,
                            0.061738495,
                            0.06303579,
                            0.044605147,
                            0.042243615,
                            0.038479164,
                            0.05336855,
                            0.06202688,
                            0.0593197,
                            0.054996807,
                            0.06251957,
                            0.0451165,
                            0.05207317,
                            0.041342534,
                            0.058123376,
                            0.046077438],
                    'max_mae': 0.07150371,
                    'max_mse': 0.007799086,
                    'max_rmse': 0.08831243,
                    'median_mae': 0.05272086,
                    'min_cosine': 0.9028449,
                    'mse': [0.0040059844,
                            0.0040321765,
                            0.0028679508,
                            0.0023258596,
                            0.0047913417,
                            0.0073422515,
                            0.007799086,
                            0.005567095,
                            0.0061341664,
                            0.0030706367,
                            0.0026718352,
                            0.002433345,
                            0.004295135,
                            0.0059063034,
                            0.0053027747,
                            0.0047799936,
                            0.006218094,
                            0.0031185155,
                            0.00393515,
                            0.00280235,
                            0.00520777,
                            0.003147773],
                    'rmse': [0.063292846,
                             0.06349942,
                             0.053553253,
                             0.04822717,
                             0.069219515,
                             0.08568694,
                             0.08831243,
                             0.07461297,
                             0.07832092,
                             0.055413324,
                             0.0516898,
                             0.049328946,
                             0.06553728,
                             0.07685248,
                             0.07282016,
                             0.0691375,
                             0.07885489,
                             0.05584367,
                             0.062730774,
                             0.05293723,
                             0.07216488,
                             0.056105018]},
 'spectra_realgan': {'cosine': [0.9896691,
                                0.9898579,
                                0.98456603,
                                0.9791487,
                                0.983875,
                                0.9906742,
                                0.9836056,
                                0.95940924,
                                0.950004,
                                0.9531188,
                                0.9706316,
                                0.9733282,
                                0.93827266,
                                0.91403544,
                                0.91530865,
                                0.92216086,
                                0.9011053,
                                0.9585088,
                                0.94279194,
                                0.9608301,
                                0.92520034,
                                0.95235986],
                     'mae': [0.05091956,
                             0.05065085,
                             0.044404034,
                             0.041118804,
                             0.058669947,
                             0.07273627,
                             0.07316233,
                             0.063168325,
                             0.06512662,
                             0.046040375,
                             0.04382759,
                             0.040590435,
                             0.05506352,
                             0.06331624,
                             0.060418434,
                             0.056880366,
                             0.06340985,
                             0.046374947,
                             0.05363102,
                             0.043673262,
                             0.059573457,
                             0.04754814],
                     'max_mae': 0.07316233,
                     'max_mse': 0.008238449,
                     'max_rmse': 0.0907659,
                     'median_mae': 0.05434727,
                     'min_cosine': 0.9011053,
                     'mse': [0.0042169,
                             0.00437998,
                             0.003240988,
                             0.0026799885,
                             0.0051155905,
                             0.007887149,
                             0.008238449,
                             0.005872001,
                             0.006557111,
                             0.0033155568,
                             0.0029443847,
                             0.0026845408,
                             0.004551976,
                             0.006129314,
                             0.005513082,
                             0.0051394324,
                             0.0063526644,
                             0.0033178928,
                             0.004240858,
                             0.0030703791,
                             0.005419961,
                             0.0034001968],
                     'rmse': [0.064937666,
                              0.066181414,
                              0.056929674,
                              0.051768605,
                              0.07152335,
                              0.088809624,
                              0.0907659,
                              0.07662898,
                              0.080975994,
                              0.057580873,
                              0.054262184,
                              0.051812556,
                              0.06746833,
                              0.07828993,
                              0.07425013,
                              0.07168984,
                              0.07970361,
                              0.057601154,
                              0.06512187,
                              0.055411004,
                              0.07362039,
                              0.058311205]},
 'spectra_realpca': {'cosine': [0.99914396,
                                0.9992311,
                                0.9983727,
                                0.9974544,
                                0.99898773,
                                0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349,
                                0.99650675,
                                0.9971242,
                                0.9965543,
                                0.9968424,
                                0.9962396,
                                0.99634945],
                     'mae': [0.014836307,
                             0.01447966,
                             0.013651306,
                             0.013377094,
                             0.014316244,
                             0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197,
                             0.012154227,
                             0.011967489,
                             0.012771271,
                             0.012152725,
                             0.013049042,
                             0.0125535],
                     'max_mae': 0.015567541,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.012704127,
                     'min_cosine': 0.9962396,
                     'mse': [0.00034976797,
                             0.00033549307,
                             0.00029904975,
                             0.00028346918,
                             0.00032609524,
                             0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102,
                             0.00023534271,
                             0.00023139741,
                             0.00026069232,
                             0.00023610053,
                             0.0002807898,
                             0.0002510656],
                     'rmse': [0.018702084,
                              0.01831647,
                              0.017293055,
                              0.016836543,
                              0.018058106,
                              0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779,
                              0.015340883,
                              0.015211753,
                              0.016145969,
                              0.015365563,
                              0.016756784,
                              0.01584505]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_55.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453
Directory path: experiments/inpainting/gann_4_night_20180722_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_55.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_55.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.111089078084709, 3.1001794530905693],
                   'kl_div': 0.49720812,
                   'ks_tests': {10000: KstestResult(statistic=0.2193, pvalue=5.514645424099267e-211, statistic_location=0.0074411063, statistic_sign=1),
                                20000: KstestResult(statistic=0.21575, pvalue=0.0, statistic_location=0.007798452, statistic_sign=1),
                                30000: KstestResult(statistic=0.2232333333333334, pvalue=0.0, statistic_location=0.0071259784, statistic_sign=1),
                                40000: KstestResult(statistic=0.21409999999999996, pvalue=0.0, statistic_location=0.007455174, statistic_sign=1),
                                50000: KstestResult(statistic=0.22031999999999996, pvalue=0.0, statistic_location=0.008113716, statistic_sign=1),
                                60000: KstestResult(statistic=0.21665, pvalue=0.0, statistic_location=0.007485771, statistic_sign=1),
                                70000: KstestResult(statistic=0.2157285714285715, pvalue=0.0, statistic_location=0.0077822823, statistic_sign=1),
                                80000: KstestResult(statistic=0.21823749999999997, pvalue=0.0, statistic_location=0.008089357, statistic_sign=1),
                                90000: KstestResult(statistic=0.21872222222222226, pvalue=0.0, statistic_location=0.007800718, statistic_sign=1),
                                100000: KstestResult(statistic=0.22018000000000004, pvalue=0.0, statistic_location=0.007438726, statistic_sign=1),
                                110000: KstestResult(statistic=0.22257272727272726, pvalue=0.0, statistic_location=0.0075404607, statistic_sign=1),
                                120000: KstestResult(statistic=0.21855000000000002, pvalue=0.0, statistic_location=0.0077848337, statistic_sign=1),
                                130000: KstestResult(statistic=0.21619230769230768, pvalue=0.0, statistic_location=0.00747356, statistic_sign=1),
                                140000: KstestResult(statistic=0.21852142857142864, pvalue=0.0, statistic_location=0.007518027, statistic_sign=1),
                                150000: KstestResult(statistic=0.21772666666666673, pvalue=0.0, statistic_location=0.0075506438, statistic_sign=1),
                                160000: KstestResult(statistic=0.2178, pvalue=0.0, statistic_location=0.0075253835, statistic_sign=1),
                                170000: KstestResult(statistic=0.2158, pvalue=0.0, statistic_location=0.0074388147, statistic_sign=1),
                                180000: KstestResult(statistic=0.21931666666666672, pvalue=0.0, statistic_location=0.007529405, statistic_sign=1),
                                190000: KstestResult(statistic=0.2179526315789474, pvalue=0.0, statistic_location=0.007874073, statistic_sign=1),
                                200000: KstestResult(statistic=0.21941999999999995, pvalue=0.0, statistic_location=0.0077831824, statistic_sign=1),
                                210000: KstestResult(statistic=0.21824285714285718, pvalue=0.0, statistic_location=0.0078074276, statistic_sign=1),
                                220000: KstestResult(statistic=0.21565, pvalue=0.0, statistic_location=0.008108158, statistic_sign=1),
                                230000: KstestResult(statistic=0.21836956521739126, pvalue=0.0, statistic_location=0.007879695, statistic_sign=1),
                                240000: KstestResult(statistic=0.21743333333333337, pvalue=0.0, statistic_location=0.0075507206, statistic_sign=1),
                                250000: KstestResult(statistic=0.21819199999999994, pvalue=0.0, statistic_location=0.0077891406, statistic_sign=1),
                                260000: KstestResult(statistic=0.21832692307692303, pvalue=0.0, statistic_location=0.007904628, statistic_sign=1),
                                270000: KstestResult(statistic=0.21816666666666673, pvalue=0.0, statistic_location=0.008006807, statistic_sign=1),
                                280000: KstestResult(statistic=0.2188214285714285, pvalue=0.0, statistic_location=0.007470891, statistic_sign=1),
                                290000: KstestResult(statistic=0.21829655172413798, pvalue=0.0, statistic_location=0.0078124544, statistic_sign=1),
                                300000: KstestResult(statistic=0.21858, pvalue=0.0, statistic_location=0.0075301956, statistic_sign=1),
                                310000: KstestResult(statistic=0.21716451612903231, pvalue=0.0, statistic_location=0.007846595, statistic_sign=1),
                                320000: KstestResult(statistic=0.21848749999999995, pvalue=0.0, statistic_location=0.0078633195, statistic_sign=1),
                                330000: KstestResult(statistic=0.21910000000000007, pvalue=0.0, statistic_location=0.007523282, statistic_sign=1)},
                   'moments': {'mean_error': -0.0042404295,
                               'means': [-0.00039863147, -2.1693977e-05],
                               'stds': [0.017679268, 0.005385532],
                               'variance_ratio': 8.627582}},
 'originals': {'gan': {'mae': 0.05171003192663193,
                       'mse': 0.004362098407000303,
                       'psnr': 28.81952667236328,
                       'rmse': 0.06604618579149246,
                       'ssim': 0.7228677272796631},
               'pca': {'mae': 0.013429644517600536,
                       'mse': 0.00029108254238963127,
                       'psnr': 40.7747917175293,
                       'rmse': 0.01706114038825035,
                       'ssim': 0.9816524982452393}},
 'reconstructions': {'mae': 0.04971151053905487,
                     'mse': 0.004055059049278498,
                     'psnr': 29.33498191833496,
                     'rmse': 0.06367934495210648,
                     'ssim': 0.7297914624214172},
 'residual_spectra_pcagan': {'cosine': [0.43865642,
                                        0.24162422,
                                        0.33851382,
                                        0.2904345,
                                        0.31440586,
                                        0.27107003,
                                        0.29740414,
                                        0.26412457,
                                        0.30329663,
                                        0.31571752,
                                        0.2341939,
                                        0.30094036,
                                        0.27264938,
                                        0.28328276,
                                        0.31187657,
                                        0.30602232,
                                        0.39502403,
                                        0.35032323,
                                        0.28461316,
                                        0.2715893,
                                        0.27236634,
                                        0.28819954,
                                        0.25545248,
                                        0.30801818,
                                        0.32594854,
                                        0.35910082,
                                        0.2935288,
                                        0.30909878,
                                        0.3610874,
                                        0.37976265,
                                        0.32860368,
                                        0.33697698,
                                        0.28380537],
                             'mae': [0.010307829,
                                     0.011543067,
                                     0.009078416,
                                     0.009397869,
                                     0.009183342,
                                     0.010454051,
                                     0.0099123595,
                                     0.010413985,
                                     0.009421885,
                                     0.010166941,
                                     0.012307652,
                                     0.012033404,
                                     0.014177274,
                                     0.01385857,
                                     0.012729086,
                                     0.011991444,
                                     0.011697062,
                                     0.011068564,
                                     0.014922364,
                                     0.016551461,
                                     0.015271266,
                                     0.014176084,
                                     0.014681517,
                                     0.012756438,
                                     0.012809018,
                                     0.011260095,
                                     0.014887729,
                                     0.01216543,
                                     0.009162823,
                                     0.009436313,
                                     0.009196771,
                                     0.009405595,
                                     0.011066853],
                             'max_mae': 0.016551461,
                             'max_mse': 0.0004356272,
                             'max_rmse': 0.020871684,
                             'median_distance': 1.6654694,
                             'median_mae': 0.011543067,
                             'min_cosine': 0.2341939,
                             'mse': [0.00020070293,
                                     0.000314841,
                                     0.00018760165,
                                     0.00023998735,
                                     0.00018848691,
                                     0.00030048433,
                                     0.00024126201,
                                     0.0002852728,
                                     0.00024048776,
                                     0.00021730617,
                                     0.00032217198,
                                     0.00026426348,
                                     0.00043222724,
                                     0.0003413647,
                                     0.00027737874,
                                     0.00032536022,
                                     0.00023890019,
                                     0.0002495822,
                                     0.00038487438,
                                     0.0004356272,
                                     0.00037485873,
                                     0.00036444768,
                                     0.00036045545,
                                     0.00030593012,
                                     0.00027573522,
                                     0.00023915702,
                                     0.00037236547,
                                     0.00028663193,
                                     0.00018535437,
                                     0.00018155565,
                                     0.00020665588,
                                     0.00022121977,
                                     0.0002972659],
                             'rmse': [0.014166966,
                                      0.017743759,
                                      0.013696775,
                                      0.015491525,
                                      0.013729054,
                                      0.017334484,
                                      0.015532611,
                                      0.016890021,
                                      0.015507667,
                                      0.014741308,
                                      0.017949149,
                                      0.016256183,
                                      0.020790076,
                                      0.018476058,
                                      0.01665469,
                                      0.018037744,
                                      0.015456396,
                                      0.01579817,
                                      0.019618215,
                                      0.020871684,
                                      0.019361269,
                                      0.019090513,
                                      0.018985664,
                                      0.017490858,
                                      0.016605277,
                                      0.015464703,
                                      0.019296773,
                                      0.016930208,
                                      0.013614491,
                                      0.013474259,
                                      0.01437553,
                                      0.014873459,
                                      0.017241402]},
 'residuals': {'mae': 0.011742199771106243,
               'mse': 0.00028363082674331963,
               'psnr': 21.098011016845703,
               'rmse': 0.01684134267270565,
               'ssds': [103.19576, 9.571429],
               'ssim': 0.22103337943553925},
 'spectra_pcagan': {'cosine': [0.9963698,
                               0.99438685,
                               0.9956266,
                               0.9947156,
                               0.9958619,
                               0.9941898,
                               0.99029875,
                               0.99031955,
                               0.9854418,
                               0.9806126,
                               0.9842539,
                               0.99106264,
                               0.98436266,
                               0.9612392,
                               0.95402,
                               0.95667464,
                               0.9732843,
                               0.9759182,
                               0.9413496,
                               0.9185366,
                               0.9188191,
                               0.92797846,
                               0.90390915,
                               0.9617075,
                               0.94762224,
                               0.9649784,
                               0.9271132,
                               0.9554265,
                               0.9740822,
                               0.9776025,
                               0.98743755,
                               0.98771983,
                               0.9894869],
                    'mae': [0.02895067,
                            0.04266675,
                            0.049023084,
                            0.048572775,
                            0.056023497,
                            0.061252892,
                            0.0495633,
                            0.04903637,
                            0.042492125,
                            0.03926784,
                            0.057685602,
                            0.071342446,
                            0.07214283,
                            0.062262837,
                            0.062302727,
                            0.04457293,
                            0.04187726,
                            0.038644116,
                            0.053261742,
                            0.06150753,
                            0.059135124,
                            0.054507904,
                            0.062075067,
                            0.044807233,
                            0.0516789,
                            0.041154943,
                            0.057749476,
                            0.046301115,
                            0.03875649,
                            0.0349078,
                            0.036869936,
                            0.038954005,
                            0.04113254],
                    'max_mae': 0.07214283,
                    'max_mse': 0.0079698,
                    'max_rmse': 0.089273736,
                    'median_mae': 0.049023084,
                    'min_cosine': 0.90390915,
                    'mse': [0.0012863175,
                            0.003211473,
                            0.0038858878,
                            0.0039039506,
                            0.004709052,
                            0.006123947,
                            0.0039803,
                            0.0041435203,
                            0.0029436299,
                            0.0024493064,
                            0.004946753,
                            0.0075787306,
                            0.0079698,
                            0.0056669,
                            0.0060025654,
                            0.0030856284,
                            0.0026376077,
                            0.0024500329,
                            0.004291196,
                            0.005813097,
                            0.0052758013,
                            0.0047103073,
                            0.0061652604,
                            0.0030924445,
                            0.0038729415,
                            0.0027854885,
                            0.0051631485,
                            0.0031829113,
                            0.0024941468,
                            0.0020058854,
                            0.0023234044,
                            0.002516884,
                            0.0031486047],
                    'rmse': [0.03586527,
                             0.05666986,
                             0.06233689,
                             0.0624816,
                             0.06862253,
                             0.07825565,
                             0.06308962,
                             0.064370185,
                             0.05425523,
                             0.049490467,
                             0.07033315,
                             0.08705591,
                             0.089273736,
                             0.07527881,
                             0.077476226,
                             0.055548433,
                             0.051357646,
                             0.049497806,
                             0.06550722,
                             0.07624367,
                             0.07263471,
                             0.06863168,
                             0.07851917,
                             0.05560975,
                             0.06223296,
                             0.052777726,
                             0.07185505,
                             0.056417298,
                             0.049941435,
                             0.044787113,
                             0.048201706,
                             0.050168555,
                             0.056112427]},
 'spectra_realgan': {'cosine': [0.99594945,
                                0.993599,
                                0.9950832,
                                0.9941495,
                                0.9954565,
                                0.99380606,
                                0.9896941,
                                0.98959345,
                                0.9840586,
                                0.9780391,
                                0.98338234,
                                0.99038804,
                                0.983271,
                                0.9587497,
                                0.95064867,
                                0.95316404,
                                0.97102016,
                                0.97345513,
                                0.93828213,
                                0.9155233,
                                0.9159966,
                                0.92306614,
                                0.90216774,
                                0.95925295,
                                0.9439704,
                                0.96156967,
                                0.92616457,
                                0.95225024,
                                0.9714461,
                                0.9741205,
                                0.98563623,
                                0.98602635,
                                0.98827475],
                     'mae': [0.030195968,
                             0.04384645,
                             0.05171915,
                             0.051315956,
                             0.0585284,
                             0.064356156,
                             0.05100211,
                             0.051354375,
                             0.045245912,
                             0.04232188,
                             0.059441272,
                             0.07366079,
                             0.073836826,
                             0.063720815,
                             0.06439157,
                             0.04602444,
                             0.04345906,
                             0.040787138,
                             0.05499627,
                             0.062789485,
                             0.06026786,
                             0.056387287,
                             0.0629972,
                             0.04607277,
                             0.05318295,
                             0.04348565,
                             0.059214,
                             0.047780782,
                             0.041187927,
                             0.037686408,
                             0.039182164,
                             0.041614648,
                             0.04437734],
                     'max_mae': 0.073836826,
                     'max_mse': 0.008408905,
                     'max_rmse': 0.091700085,
                     'median_mae': 0.051315956,
                     'min_cosine': 0.90216774,
                     'mse': [0.0013965998,
                             0.0033654594,
                             0.0043091304,
                             0.0043066847,
                             0.0051687118,
                             0.00663488,
                             0.004193502,
                             0.0044916635,
                             0.0033190364,
                             0.002811561,
                             0.005270784,
                             0.008125987,
                             0.008408905,
                             0.005973664,
                             0.0064246827,
                             0.0033273175,
                             0.0029098277,
                             0.0027023253,
                             0.0045493,
                             0.0060367663,
                             0.005485335,
                             0.0050676977,
                             0.006299948,
                             0.0032926055,
                             0.0041749026,
                             0.0030507362,
                             0.0053743967,
                             0.0034350727,
                             0.0027860254,
                             0.0022955164,
                             0.0025833887,
                             0.0028579237,
                             0.0035189064],
                     'rmse': [0.03737111,
                              0.05801258,
                              0.065643966,
                              0.06562533,
                              0.07189375,
                              0.08145477,
                              0.06475726,
                              0.06701987,
                              0.057611078,
                              0.053024154,
                              0.07260016,
                              0.090144254,
                              0.091700085,
                              0.077289484,
                              0.08015412,
                              0.057682905,
                              0.05394282,
                              0.051983897,
                              0.0674485,
                              0.07769663,
                              0.07406305,
                              0.071187764,
                              0.07937221,
                              0.05738123,
                              0.064613484,
                              0.05523347,
                              0.07331028,
                              0.058609493,
                              0.052782815,
                              0.047911547,
                              0.05082705,
                              0.05345955,
                              0.05932037]},
 'spectra_realpca': {'cosine': [0.99945366,
                                0.99925643,
                                0.99947244,
                                0.99940675,
                                0.9995555,
                                0.99957067,
                                0.99914396,
                                0.9992311,
                                0.9983727,
                                0.9974544,
                                0.99898773,
                                0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349,
                                0.99650675,
                                0.9971242,
                                0.9965543,
                                0.9968424,
                                0.9962396,
                                0.99634945,
                                0.99715966,
                                0.99691385,
                                0.9982245,
                                0.99834263,
                                0.9988524],
                     'mae': [0.011083274,
                             0.014802759,
                             0.015157819,
                             0.015070052,
                             0.015472084,
                             0.015633475,
                             0.014836307,
                             0.01447966,
                             0.013651306,
                             0.013377094,
                             0.014316244,
                             0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197,
                             0.012154227,
                             0.011967489,
                             0.012771271,
                             0.012152725,
                             0.013049042,
                             0.0125535,
                             0.013193458,
                             0.0130807385,
                             0.013555716,
                             0.013718692,
                             0.014281331],
                     'max_mae': 0.015633475,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.013377094,
                     'min_cosine': 0.9962396,
                     'mse': [0.00019629093,
                             0.00035259564,
                             0.00036871652,
                             0.00035998295,
                             0.00038198216,
                             0.00038844542,
                             0.00034976797,
                             0.00033549307,
                             0.00029904975,
                             0.00028346918,
                             0.00032609524,
                             0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102,
                             0.00023534271,
                             0.00023139741,
                             0.00026069232,
                             0.00023610053,
                             0.0002807898,
                             0.0002510656,
                             0.00027758113,
                             0.00027334486,
                             0.00029565947,
                             0.00030083008,
                             0.0003258427],
                     'rmse': [0.014010387,
                              0.01877753,
                              0.019201992,
                              0.018973216,
                              0.019544363,
                              0.019709019,
                              0.018702084,
                              0.01831647,
                              0.017293055,
                              0.016836543,
                              0.018058106,
                              0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779,
                              0.015340883,
                              0.015211753,
                              0.016145969,
                              0.015365563,
                              0.016756784,
                              0.01584505,
                              0.016660767,
                              0.016533144,
                              0.017194752,
                              0.017344454,
                              0.018051114]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_55.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957
Directory path: experiments/inpainting/gann_4_night_20180723_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_55.0/images
Optimal number of principal components:  1
Reconstruction error:  37.32791
Energy conservation:  0.5564905
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_55.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.075287224842861, 3.4964184850129745],
                   'kl_div': 0.20606722,
                   'ks_tests': {10000: KstestResult(statistic=0.1513, pvalue=3.205460466221225e-100, statistic_location=0.010323053, statistic_sign=1),
                                20000: KstestResult(statistic=0.14750000000000008, pvalue=2.320074038452634e-190, statistic_location=0.010133004, statistic_sign=1),
                                30000: KstestResult(statistic=0.15290000000000004, pvalue=1.1616868544040619e-306, statistic_location=0.009199279, statistic_sign=1),
                                40000: KstestResult(statistic=0.1503, pvalue=0.0, statistic_location=0.010347193, statistic_sign=1),
                                50000: KstestResult(statistic=0.14927999999999997, pvalue=0.0, statistic_location=0.010345682, statistic_sign=1),
                                60000: KstestResult(statistic=0.1503833333333333, pvalue=0.0, statistic_location=0.010325839, statistic_sign=1),
                                70000: KstestResult(statistic=0.1519285714285714, pvalue=0.0, statistic_location=0.010343267, statistic_sign=1),
                                80000: KstestResult(statistic=0.15059999999999996, pvalue=0.0, statistic_location=0.010353884, statistic_sign=1),
                                90000: KstestResult(statistic=0.14933333333333332, pvalue=0.0, statistic_location=0.009804127, statistic_sign=1),
                                100000: KstestResult(statistic=0.15141000000000004, pvalue=0.0, statistic_location=0.009798285, statistic_sign=1),
                                110000: KstestResult(statistic=0.15010909090909086, pvalue=0.0, statistic_location=0.009434223, statistic_sign=1)},
                   'moments': {'mean_error': 0.07655598,
                               'means': [0.00018858185, 7.818885e-05],
                               'stds': [0.018317485, 0.007997076],
                               'variance_ratio': 4.478869}},
 'originals': {'gan': {'mae': 0.039080649614334106,
                       'mse': 0.0029828031547367573,
                       'psnr': 25.586721420288086,
                       'rmse': 0.054615046828985214,
                       'ssim': 0.6815907955169678},
               'pca': {'mae': 0.015239655040204525,
                       'mse': 0.0003732801997102797,
                       'psnr': 34.66868209838867,
                       'rmse': 0.01932046003639698,
                       'ssim': 0.9052591919898987}},
 'reconstructions': {'mae': 0.03522789478302002,
                     'mse': 0.0026523121632635593,
                     'psnr': 26.152782440185547,
                     'rmse': 0.051500603556632996,
                     'ssim': 0.7235210537910461},
 'residual_spectra_pcagan': {'cosine': [0.49722892,
                                        0.3240914,
                                        0.4364389,
                                        0.44185713,
                                        0.37728757,
                                        0.44706908,
                                        0.4521612,
                                        0.43837196,
                                        0.4147927,
                                        0.43419728,
                                        0.41694158],
                             'mae': [0.009953221,
                                     0.011259149,
                                     0.0109881675,
                                     0.009651379,
                                     0.010863328,
                                     0.010445458,
                                     0.010327345,
                                     0.011400976,
                                     0.011446331,
                                     0.010200861,
                                     0.011071397],
                             'max_mae': 0.011446331,
                             'max_mse': 0.00041735388,
                             'max_rmse': 0.02042924,
                             'median_distance': 1.6050719,
                             'median_mae': 0.010863328,
                             'min_cosine': 0.3240914,
                             'mse': [0.0002065896,
                                     0.00041735388,
                                     0.0002576256,
                                     0.0002180222,
                                     0.00035156336,
                                     0.0002257124,
                                     0.00024340535,
                                     0.00027091225,
                                     0.00030462252,
                                     0.0002574948,
                                     0.00028478488],
                             'rmse': [0.014373225,
                                      0.02042924,
                                      0.016050719,
                                      0.0147655755,
                                      0.018750023,
                                      0.015023728,
                                      0.015601453,
                                      0.016459413,
                                      0.017453438,
                                      0.016046645,
                                      0.01687557]},
 'residuals': {'mae': 0.010691600851714611,
               'mse': 0.00027618970489129424,
               'psnr': 17.64501190185547,
               'rmse': 0.01661895588040352,
               'ssds': [36.911907, 7.035464],
               'ssim': 0.36256638169288635},
 'spectra_pcagan': {'cosine': [0.76163626,
                               0.97629756,
                               0.9786622,
                               0.9838063,
                               0.9794047,
                               0.97732747,
                               0.9818559,
                               0.98232406,
                               0.98810315,
                               0.993833,
                               0.9911037],
                    'mae': [0.12606625,
                            0.033039965,
                            0.028330218,
                            0.023389474,
                            0.026058083,
                            0.028030232,
                            0.026332555,
                            0.027417487,
                            0.025055585,
                            0.020544477,
                            0.02324248],
                    'max_mae': 0.12606625,
                    'max_mse': 0.017294303,
                    'max_rmse': 0.1315078,
                    'median_mae': 0.026332555,
                    'min_cosine': 0.76163626,
                    'mse': [0.017294303,
                            0.0018945434,
                            0.001283867,
                            0.00095048296,
                            0.0012539864,
                            0.0012882113,
                            0.0011364926,
                            0.0012786449,
                            0.0010834228,
                            0.00075091916,
                            0.00096056063],
                    'rmse': [0.1315078,
                             0.04352635,
                             0.03583109,
                             0.030829905,
                             0.03541167,
                             0.03589166,
                             0.033711907,
                             0.035758145,
                             0.032915387,
                             0.027402904,
                             0.030992912]},
 'spectra_realgan': {'cosine': [0.7618132,
                                0.9706433,
                                0.9719446,
                                0.977983,
                                0.97307557,
                                0.9714739,
                                0.97608113,
                                0.977296,
                                0.98441505,
                                0.99123144,
                                0.9883725],
                     'mae': [0.12483563,
                             0.037253868,
                             0.032851625,
                             0.028157623,
                             0.030859664,
                             0.031978235,
                             0.03047882,
                             0.031209778,
                             0.02941755,
                             0.025339656,
                             0.027504697],
                     'max_mae': 0.12483563,
                     'max_mse': 0.017318122,
                     'max_rmse': 0.13159834,
                     'median_mae': 0.030859664,
                     'min_cosine': 0.7618132,
                     'mse': [0.017318122,
                             0.0023279006,
                             0.0017012808,
                             0.001308548,
                             0.0016385578,
                             0.0016354714,
                             0.0015088693,
                             0.0016243889,
                             0.0014303842,
                             0.001063264,
                             0.0012540491],
                     'rmse': [0.13159834,
                              0.04824832,
                              0.041246586,
                              0.036173858,
                              0.0404791,
                              0.04044096,
                              0.03884417,
                              0.040303707,
                              0.03782042,
                              0.03260773,
                              0.035412557]},
 'spectra_realpca': {'cosine': [0.9941098,
                                0.99416333,
                                0.9936037,
                                0.993588,
                                0.99322087,
                                0.9932172,
                                0.9941703,
                                0.99471545,
                                0.99618137,
                                0.99729186,
                                0.9969032],
                     'mae': [0.0153628765,
                             0.016044892,
                             0.015603104,
                             0.015481151,
                             0.015898915,
                             0.01568693,
                             0.015209607,
                             0.014896314,
                             0.014717062,
                             0.014370954,
                             0.014364395],
                     'max_mae': 0.016044892,
                     'max_mse': 0.0004121807,
                     'max_rmse': 0.020302234,
                     'median_mae': 0.0153628765,
                     'min_cosine': 0.9932172,
                     'mse': [0.00038744128,
                             0.0004121807,
                             0.00039086267,
                             0.00038415138,
                             0.00040199846,
                             0.00039318297,
                             0.00037064194,
                             0.00035742685,
                             0.00034816508,
                             0.00032996802,
                             0.00033006273],
                     'rmse': [0.019683529,
                              0.020302234,
                              0.019770248,
                              0.01959978,
                              0.0200499,
                              0.019828841,
                              0.019252064,
                              0.018905737,
                              0.018659182,
                              0.018165022,
                              0.018167628]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_55.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431
Directory path: experiments/inpainting/gann_4_night_20180723_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_55.0/images
Optimal number of principal components:  1
Reconstruction error:  37.32791
Energy conservation:  0.5564905
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_55.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.070708789508587, 3.5066548983187453],
                   'kl_div': 0.19183466,
                   'ks_tests': {10000: KstestResult(statistic=0.1477, pvalue=1.6432525291147535e-95, statistic_location=0.0110379625, statistic_sign=1),
                                20000: KstestResult(statistic=0.15700000000000003, pvalue=9.399979312862314e-216, statistic_location=0.009071335, statistic_sign=1),
                                30000: KstestResult(statistic=0.1518666666666667, pvalue=1.62777851360599e-302, statistic_location=0.011285234, statistic_sign=1),
                                40000: KstestResult(statistic=0.1483, pvalue=0.0, statistic_location=0.010410644, statistic_sign=1),
                                50000: KstestResult(statistic=0.15496, pvalue=0.0, statistic_location=0.009317552, statistic_sign=1),
                                60000: KstestResult(statistic=0.15421666666666667, pvalue=0.0, statistic_location=0.009624319, statistic_sign=1),
                                70000: KstestResult(statistic=0.1572, pvalue=0.0, statistic_location=0.009301251, statistic_sign=1),
                                80000: KstestResult(statistic=0.15144999999999997, pvalue=0.0, statistic_location=0.010379412, statistic_sign=1),
                                90000: KstestResult(statistic=0.15326666666666666, pvalue=0.0, statistic_location=0.009895294, statistic_sign=1),
                                100000: KstestResult(statistic=0.15048000000000006, pvalue=0.0, statistic_location=0.009886615, statistic_sign=1),
                                110000: KstestResult(statistic=0.15068181818181814, pvalue=0.0, statistic_location=0.009599522, statistic_sign=1),
                                120000: KstestResult(statistic=0.15393333333333337, pvalue=0.0, statistic_location=0.009463128, statistic_sign=1),
                                130000: KstestResult(statistic=0.15153076923076925, pvalue=0.0, statistic_location=0.010626844, statistic_sign=1),
                                140000: KstestResult(statistic=0.1509571428571429, pvalue=0.0, statistic_location=0.010136297, statistic_sign=1),
                                150000: KstestResult(statistic=0.15225333333333335, pvalue=0.0, statistic_location=0.010136297, statistic_sign=1),
                                160000: KstestResult(statistic=0.14998750000000005, pvalue=0.0, statistic_location=0.009615298, statistic_sign=1),
                                170000: KstestResult(statistic=0.14927647058823534, pvalue=0.0, statistic_location=0.009126674, statistic_sign=1),
                                180000: KstestResult(statistic=0.15262222222222221, pvalue=0.0, statistic_location=0.0096101705, statistic_sign=1),
                                190000: KstestResult(statistic=0.15048421052631578, pvalue=0.0, statistic_location=0.009464461, statistic_sign=1),
                                200000: KstestResult(statistic=0.1514850000000001, pvalue=0.0, statistic_location=0.010140823, statistic_sign=1),
                                210000: KstestResult(statistic=0.1519761904761905, pvalue=0.0, statistic_location=0.009341689, statistic_sign=1),
                                220000: KstestResult(statistic=0.15363181818181826, pvalue=0.0, statistic_location=0.009573277, statistic_sign=1)},
                   'moments': {'mean_error': 0.16780457,
                               'means': [0.0011001013, 6.326892e-05],
                               'stds': [0.017806092, 0.00808623],
                               'variance_ratio': 4.192596}},
 'originals': {'gan': {'mae': 0.038087304681539536,
                       'mse': 0.0028102791402488947,
                       'psnr': 27.170915603637695,
                       'rmse': 0.05301206558942795,
                       'ssim': 0.6383501887321472},
               'pca': {'mae': 0.01515172328799963,
                       'mse': 0.0003704703995026648,
                       'psnr': 36.02420425415039,
                       'rmse': 0.01924760825932026,
                       'ssim': 0.9280337691307068}},
 'reconstructions': {'mae': 0.03391638398170471,
                     'mse': 0.0024530470836907625,
                     'psnr': 27.814680099487305,
                     'rmse': 0.04952824488282204,
                     'ssim': 0.6689038872718811},
 'residual_spectra_pcagan': {'cosine': [0.5079951,
                                        0.3937583,
                                        0.33680183,
                                        0.4334264,
                                        0.40612775,
                                        0.41281027,
                                        0.4218578,
                                        0.50377035,
                                        0.49244198,
                                        0.45941406,
                                        0.43792796,
                                        0.4740008,
                                        0.47784123,
                                        0.49302512,
                                        0.46467963,
                                        0.42274934,
                                        0.45041078,
                                        0.44436386,
                                        0.4656129,
                                        0.5096901,
                                        0.3612277,
                                        0.52482975],
                             'mae': [0.008516513,
                                     0.009436671,
                                     0.010655085,
                                     0.009657092,
                                     0.01062305,
                                     0.011241151,
                                     0.009801728,
                                     0.008692186,
                                     0.009297976,
                                     0.010066298,
                                     0.011186055,
                                     0.010658029,
                                     0.010479355,
                                     0.010294387,
                                     0.010323269,
                                     0.010973703,
                                     0.010967226,
                                     0.01244181,
                                     0.011362965,
                                     0.010458437,
                                     0.011269257,
                                     0.009446785],
                             'max_mae': 0.01244181,
                             'max_mse': 0.00042531118,
                             'max_rmse': 0.020623075,
                             'median_distance': 1.5608661,
                             'median_mae': 0.0104688965,
                             'min_cosine': 0.33680183,
                             'mse': [0.00016293838,
                                     0.00026180534,
                                     0.00038291942,
                                     0.00020422763,
                                     0.00027568737,
                                     0.0003297554,
                                     0.00023924588,
                                     0.00017321331,
                                     0.00017469886,
                                     0.0002142632,
                                     0.0002667101,
                                     0.00022988566,
                                     0.00021074977,
                                     0.00022530678,
                                     0.00026348553,
                                     0.00030650597,
                                     0.00024805457,
                                     0.00030891356,
                                     0.00029128313,
                                     0.00022294908,
                                     0.00042531118,
                                     0.00019843571],
                             'rmse': [0.012764731,
                                      0.0161804,
                                      0.019568328,
                                      0.014290824,
                                      0.016603837,
                                      0.018159168,
                                      0.015467575,
                                      0.013161053,
                                      0.013217369,
                                      0.014637732,
                                      0.016331261,
                                      0.015161981,
                                      0.014517223,
                                      0.015010223,
                                      0.016232237,
                                      0.017507313,
                                      0.015749749,
                                      0.017575936,
                                      0.017067019,
                                      0.0149314795,
                                      0.020623075,
                                      0.0140867205]},
 'residuals': {'mae': 0.010356773622334003,
               'mse': 0.00025528849801048636,
               'psnr': 19.211566925048828,
               'rmse': 0.015977749601006508,
               'ssds': [70.01845, 14.385978],
               'ssim': 0.4118771553039551},
 'spectra_pcagan': {'cosine': [0.9887463,
                               0.990139,
                               0.9779671,
                               0.9892989,
                               0.9810675,
                               0.7804825,
                               0.9810114,
                               0.9854521,
                               0.98324066,
                               0.9815486,
                               0.9734479,
                               0.98342425,
                               0.98339427,
                               0.9904055,
                               0.99274224,
                               0.9912833,
                               0.99298567,
                               0.9935543,
                               0.9950227,
                               0.9476585,
                               0.99394304,
                               0.99658066],
                    'mae': [0.02606924,
                            0.027398705,
                            0.027143838,
                            0.027696613,
                            0.029187916,
                            0.12437559,
                            0.027417261,
                            0.022199407,
                            0.024055727,
                            0.025110302,
                            0.032202877,
                            0.027299978,
                            0.027692815,
                            0.022493802,
                            0.021887505,
                            0.0284531,
                            0.022840876,
                            0.023932846,
                            0.023748504,
                            0.112930715,
                            0.021393595,
                            0.020629162],
                    'max_mae': 0.12437559,
                    'max_mse': 0.017227633,
                    'max_rmse': 0.13125408,
                    'median_mae': 0.02660654,
                    'min_cosine': 0.7804825,
                    'mse': [0.0011375411,
                            0.0014836584,
                            0.0014017262,
                            0.0013274117,
                            0.00143827,
                            0.017227633,
                            0.0013474034,
                            0.0008749589,
                            0.0010115086,
                            0.0010736282,
                            0.00171012,
                            0.0012049923,
                            0.0012453889,
                            0.00087740936,
                            0.00090184907,
                            0.0013397846,
                            0.00088122766,
                            0.0009903678,
                            0.0010467389,
                            0.013796326,
                            0.0009570788,
                            0.00069201685],
                    'rmse': [0.033727452,
                             0.038518287,
                             0.037439633,
                             0.036433663,
                             0.037924528,
                             0.13125408,
                             0.036706995,
                             0.029579705,
                             0.031804223,
                             0.032766268,
                             0.0413536,
                             0.034713,
                             0.035290066,
                             0.029621096,
                             0.030030802,
                             0.036603067,
                             0.029685479,
                             0.03147011,
                             0.032353345,
                             0.11745776,
                             0.03093669,
                             0.026306214]},
 'spectra_realgan': {'cosine': [0.9842078,
                                0.9871999,
                                0.9718724,
                                0.985967,
                                0.97519636,
                                0.78046894,
                                0.97550553,
                                0.979332,
                                0.9771153,
                                0.9751869,
                                0.96695566,
                                0.97756875,
                                0.97863656,
                                0.9863973,
                                0.98986506,
                                0.988211,
                                0.99054843,
                                0.9914029,
                                0.9933298,
                                0.9454759,
                                0.99235487,
                                0.99506116],
                     'mae': [0.031449873,
                             0.033358075,
                             0.03223088,
                             0.032833684,
                             0.034184877,
                             0.12320614,
                             0.032412127,
                             0.02735318,
                             0.028834647,
                             0.030076234,
                             0.035897896,
                             0.031591743,
                             0.031081274,
                             0.02747107,
                             0.026677659,
                             0.03191745,
                             0.02713928,
                             0.028460499,
                             0.028434673,
                             0.11333312,
                             0.025898932,
                             0.024077341],
                     'max_mae': 0.12320614,
                     'max_mse': 0.017251171,
                     'max_rmse': 0.1313437,
                     'median_mae': 0.03126557,
                     'min_cosine': 0.78046894,
                     'mse': [0.001616725,
                             0.001966377,
                             0.0018089884,
                             0.0017658881,
                             0.0018792998,
                             0.017251171,
                             0.0017576824,
                             0.0012546197,
                             0.0013850576,
                             0.0014584885,
                             0.0020979233,
                             0.0015857856,
                             0.0015713709,
                             0.0012464509,
                             0.0012413118,
                             0.001664988,
                             0.0011874527,
                             0.0013207701,
                             0.0013795355,
                             0.014200812,
                             0.0012412195,
                             0.0009442255],
                     'rmse': [0.04020852,
                              0.04434385,
                              0.042532206,
                              0.04202247,
                              0.04335089,
                              0.1313437,
                              0.041924722,
                              0.03542061,
                              0.03721636,
                              0.038190164,
                              0.045803092,
                              0.039821923,
                              0.03964052,
                              0.035305113,
                              0.035232253,
                              0.040804263,
                              0.034459434,
                              0.0363424,
                              0.037142098,
                              0.119167164,
                              0.035230946,
                              0.030728253]},
 'spectra_realpca': {'cosine': [0.9956891,
                                0.9968456,
                                0.9937453,
                                0.99647313,
                                0.99432063,
                                0.9941098,
                                0.99416333,
                                0.9936037,
                                0.993588,
                                0.99322087,
                                0.9932172,
                                0.9941703,
                                0.99471545,
                                0.99618137,
                                0.99729186,
                                0.9969032,
                                0.9973674,
                                0.99799657,
                                0.9983731,
                                0.9982278,
                                0.99801546,
                                0.9983513],
                     'mae': [0.016451024,
                             0.017186759,
                             0.015872382,
                             0.016606808,
                             0.016171038,
                             0.0153628765,
                             0.016044892,
                             0.015603104,
                             0.015481151,
                             0.015898915,
                             0.01568693,
                             0.015209607,
                             0.014896314,
                             0.014717062,
                             0.014370954,
                             0.014364395,
                             0.014272489,
                             0.013810243,
                             0.0138713,
                             0.013732071,
                             0.014032854,
                             0.013694668],
                     'max_mae': 0.017186759,
                     'max_mse': 0.00047408525,
                     'max_rmse': 0.021773499,
                     'median_mae': 0.015286242,
                     'min_cosine': 0.9932172,
                     'mse': [0.0004324034,
                             0.00047408525,
                             0.00039966742,
                             0.00043955294,
                             0.00042048618,
                             0.00038744128,
                             0.0004121807,
                             0.00039086267,
                             0.00038415138,
                             0.00040199846,
                             0.00039318297,
                             0.00037064194,
                             0.00035742685,
                             0.00034816508,
                             0.00032996802,
                             0.00033006273,
                             0.0003302328,
                             0.0003088054,
                             0.00030680178,
                             0.00031553913,
                             0.00031555345,
                             0.00030113885],
                     'rmse': [0.020794312,
                              0.021773499,
                              0.019991685,
                              0.020965518,
                              0.02050576,
                              0.019683529,
                              0.020302234,
                              0.019770248,
                              0.01959978,
                              0.0200499,
                              0.019828841,
                              0.019252064,
                              0.018905737,
                              0.018659182,
                              0.018165022,
                              0.018167628,
                              0.018172309,
                              0.01757286,
                              0.017515758,
                              0.017763421,
                              0.017763825,
                              0.017353352]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_55.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707
Directory path: experiments/inpainting/gann_4_night_20180723_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_55.0/images
Optimal number of principal components:  1
Reconstruction error:  37.32791
Energy conservation:  0.5564905
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_55.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.060522481510419, 3.5009956763846626],
                   'kl_div': 0.18481323,
                   'ks_tests': {10000: KstestResult(statistic=0.1297, pvalue=1.0992201222433738e-73, statistic_location=0.01010556, statistic_sign=1),
                                20000: KstestResult(statistic=0.12975000000000003, pvalue=3.0691882024556377e-147, statistic_location=0.010243685, statistic_sign=1),
                                30000: KstestResult(statistic=0.12996666666666667, pvalue=2.282875625228206e-221, statistic_location=0.010584898, statistic_sign=1),
                                40000: KstestResult(statistic=0.1316250000000001, pvalue=1.3427438663615187e-302, statistic_location=0.009642599, statistic_sign=1),
                                50000: KstestResult(statistic=0.13007999999999997, pvalue=0.0, statistic_location=0.010696972, statistic_sign=1),
                                60000: KstestResult(statistic=0.12816666666666665, pvalue=0.0, statistic_location=0.009504475, statistic_sign=1),
                                70000: KstestResult(statistic=0.1284428571428572, pvalue=0.0, statistic_location=0.010732054, statistic_sign=1),
                                80000: KstestResult(statistic=0.1288625, pvalue=0.0, statistic_location=0.009902348, statistic_sign=1),
                                90000: KstestResult(statistic=0.12993333333333335, pvalue=0.0, statistic_location=0.0103511885, statistic_sign=1),
                                100000: KstestResult(statistic=0.12935999999999992, pvalue=0.0, statistic_location=0.009611409, statistic_sign=1),
                                110000: KstestResult(statistic=0.12763636363636366, pvalue=0.0, statistic_location=0.009638978, statistic_sign=1),
                                120000: KstestResult(statistic=0.13037500000000002, pvalue=0.0, statistic_location=0.009882064, statistic_sign=1),
                                130000: KstestResult(statistic=0.12901538461538453, pvalue=0.0, statistic_location=0.00961195, statistic_sign=1),
                                140000: KstestResult(statistic=0.12939999999999996, pvalue=0.0, statistic_location=0.010442419, statistic_sign=1),
                                150000: KstestResult(statistic=0.12947999999999993, pvalue=0.0, statistic_location=0.009374521, statistic_sign=1),
                                160000: KstestResult(statistic=0.13108750000000002, pvalue=0.0, statistic_location=0.010007564, statistic_sign=1),
                                170000: KstestResult(statistic=0.1290941176470588, pvalue=0.0, statistic_location=0.0100156255, statistic_sign=1),
                                180000: KstestResult(statistic=0.12968333333333337, pvalue=0.0, statistic_location=0.009849504, statistic_sign=1),
                                190000: KstestResult(statistic=0.12967894736842112, pvalue=0.0, statistic_location=0.009610847, statistic_sign=1),
                                200000: KstestResult(statistic=0.12857000000000007, pvalue=0.0, statistic_location=0.010589963, statistic_sign=1),
                                210000: KstestResult(statistic=0.13003333333333333, pvalue=0.0, statistic_location=0.010410586, statistic_sign=1),
                                220000: KstestResult(statistic=0.12911363636363637, pvalue=0.0, statistic_location=0.01037818, statistic_sign=1),
                                230000: KstestResult(statistic=0.12872608695652177, pvalue=0.0, statistic_location=0.010040523, statistic_sign=1),
                                240000: KstestResult(statistic=0.12792916666666665, pvalue=0.0, statistic_location=0.010044046, statistic_sign=1),
                                250000: KstestResult(statistic=0.13072800000000007, pvalue=0.0, statistic_location=0.0098967, statistic_sign=1),
                                260000: KstestResult(statistic=0.1291961538461538, pvalue=0.0, statistic_location=0.010007472, statistic_sign=1),
                                270000: KstestResult(statistic=0.12978518518518523, pvalue=0.0, statistic_location=0.010275854, statistic_sign=1),
                                280000: KstestResult(statistic=0.12839999999999996, pvalue=0.0, statistic_location=0.0104103265, statistic_sign=1),
                                290000: KstestResult(statistic=0.13022068965517242, pvalue=0.0, statistic_location=0.009844746, statistic_sign=1),
                                300000: KstestResult(statistic=0.1291, pvalue=0.0, statistic_location=0.010017264, statistic_sign=1),
                                310000: KstestResult(statistic=0.129016129032258, pvalue=0.0, statistic_location=0.009896525, statistic_sign=1),
                                320000: KstestResult(statistic=0.1297718750000001, pvalue=0.0, statistic_location=0.010586942, statistic_sign=1),
                                330000: KstestResult(statistic=0.12918181818181818, pvalue=0.0, statistic_location=0.009610847, statistic_sign=1)},
                   'moments': {'mean_error': 0.039026465,
                               'means': [4.6829733e-05, -2.5352574e-05],
                               'stds': [0.017160652, 0.008039438],
                               'variance_ratio': 4.0468526}},
 'originals': {'gan': {'mae': 0.03634387254714966,
                       'mse': 0.002503450959920883,
                       'psnr': 28.304943084716797,
                       'rmse': 0.05003449693322182,
                       'ssim': 0.6518727540969849},
               'pca': {'mae': 0.015256275422871113,
                       'mse': 0.00037564767990261316,
                       'psnr': 36.753177642822266,
                       'rmse': 0.019381633028388023,
                       'ssim': 0.9370474815368652}},
 'reconstructions': {'mae': 0.03217441588640213,
                     'mse': 0.0021439767442643642,
                     'psnr': 29.188785552978516,
                     'rmse': 0.046303097158670425,
                     'ssim': 0.6720669865608215},
 'residual_spectra_pcagan': {'cosine': [0.46280694,
                                        0.42908224,
                                        0.4485824,
                                        0.3723156,
                                        0.47799316,
                                        0.35842064,
                                        0.3966747,
                                        0.36205736,
                                        0.42108402,
                                        0.41949308,
                                        0.38530084,
                                        0.5089599,
                                        0.35357076,
                                        0.46764103,
                                        0.48056498,
                                        0.42451936,
                                        0.48404557,
                                        0.49388403,
                                        0.45988375,
                                        0.4522839,
                                        0.479768,
                                        0.4342832,
                                        0.45464528,
                                        0.45082676,
                                        0.47556105,
                                        0.52569693,
                                        0.47055554,
                                        0.46243423,
                                        0.5190771,
                                        0.5270974,
                                        0.5379233,
                                        0.5334589,
                                        0.4372685],
                             'mae': [0.009200426,
                                     0.009786001,
                                     0.009020552,
                                     0.010061527,
                                     0.008967212,
                                     0.010203884,
                                     0.009777578,
                                     0.010333325,
                                     0.009613474,
                                     0.010012924,
                                     0.010656165,
                                     0.00974055,
                                     0.010904565,
                                     0.010421906,
                                     0.0091466885,
                                     0.010237687,
                                     0.009821953,
                                     0.009764892,
                                     0.010714889,
                                     0.010939448,
                                     0.009688253,
                                     0.0107483845,
                                     0.01006907,
                                     0.011798442,
                                     0.010968133,
                                     0.00987337,
                                     0.011535484,
                                     0.011351655,
                                     0.009364166,
                                     0.009473162,
                                     0.0087627685,
                                     0.009109559,
                                     0.010697824],
                             'max_mae': 0.011798442,
                             'max_mse': 0.00034473842,
                             'max_rmse': 0.018567134,
                             'median_distance': 1.5450668,
                             'median_mae': 0.010012924,
                             'min_cosine': 0.35357076,
                             'mse': [0.00018670871,
                                     0.00022672334,
                                     0.00019156521,
                                     0.00030684748,
                                     0.00017484983,
                                     0.00030096318,
                                     0.00024974914,
                                     0.00029521418,
                                     0.00023872318,
                                     0.00021656709,
                                     0.00029688526,
                                     0.00020386316,
                                     0.00034473842,
                                     0.00021733755,
                                     0.0001798306,
                                     0.00027022944,
                                     0.00018764412,
                                     0.00019807722,
                                     0.00024389198,
                                     0.0002534503,
                                     0.00020775213,
                                     0.0002661654,
                                     0.00025221275,
                                     0.0002755704,
                                     0.00024261355,
                                     0.0001934982,
                                     0.0002616691,
                                     0.00027411708,
                                     0.00018431357,
                                     0.00018156672,
                                     0.00017118725,
                                     0.00018091527,
                                     0.00026864698],
                             'rmse': [0.013664139,
                                      0.015057335,
                                      0.013840709,
                                      0.017517062,
                                      0.01322308,
                                      0.01734829,
                                      0.015803453,
                                      0.017181799,
                                      0.015450669,
                                      0.014716218,
                                      0.017230358,
                                      0.014278065,
                                      0.018567134,
                                      0.014742373,
                                      0.013410093,
                                      0.016438657,
                                      0.0136983255,
                                      0.014073991,
                                      0.015617041,
                                      0.015920123,
                                      0.014413609,
                                      0.016314577,
                                      0.015881207,
                                      0.016600313,
                                      0.015576057,
                                      0.013910363,
                                      0.01617619,
                                      0.01655648,
                                      0.013576213,
                                      0.013474669,
                                      0.013083855,
                                      0.0134504745,
                                      0.016390454]},
 'residuals': {'mae': 0.010083815082907677,
               'mse': 0.00023466935090254992,
               'psnr': 19.942420959472656,
               'rmse': 0.015318921767175198,
               'ssds': [97.18146, 21.328897],
               'ssim': 0.41037213802337646},
 'spectra_pcagan': {'cosine': [0.98911756,
                               0.9867175,
                               0.9894729,
                               0.98879904,
                               0.9881075,
                               0.9920359,
                               0.98586,
                               0.98813164,
                               0.9774954,
                               0.98735213,
                               0.97603744,
                               0.76180047,
                               0.9764946,
                               0.97843117,
                               0.9837356,
                               0.97917336,
                               0.9770709,
                               0.98228383,
                               0.9825257,
                               0.9879658,
                               0.993476,
                               0.99124295,
                               0.99388415,
                               0.9933848,
                               0.99534637,
                               0.9400053,
                               0.9935038,
                               0.9938017,
                               0.99674195,
                               0.99544245,
                               0.9939824,
                               0.99537677,
                               0.995172],
                    'mae': [0.025403416,
                            0.025611347,
                            0.024644459,
                            0.026017841,
                            0.03326511,
                            0.03505089,
                            0.028350241,
                            0.030533817,
                            0.029135162,
                            0.03265596,
                            0.032138504,
                            0.12625188,
                            0.032962095,
                            0.028516605,
                            0.023430554,
                            0.026276046,
                            0.028157728,
                            0.025993658,
                            0.02731576,
                            0.025239987,
                            0.021106832,
                            0.02322372,
                            0.025064684,
                            0.025636047,
                            0.023551175,
                            0.118536204,
                            0.024845926,
                            0.029161539,
                            0.018338477,
                            0.020720711,
                            0.024048926,
                            0.019759115,
                            0.020811405],
                    'max_mae': 0.12625188,
                    'max_mse': 0.01735428,
                    'max_rmse': 0.13173564,
                    'median_mae': 0.025993658,
                    'min_cosine': 0.76180047,
                    'mse': [0.0011822496,
                            0.0012229802,
                            0.0011145048,
                            0.0013478335,
                            0.001718116,
                            0.0023167424,
                            0.001417616,
                            0.0018149437,
                            0.0014245185,
                            0.0017848305,
                            0.0017567852,
                            0.01735428,
                            0.0018762416,
                            0.001297769,
                            0.00095453224,
                            0.0012643152,
                            0.0013025863,
                            0.0011094145,
                            0.0012635714,
                            0.0010969121,
                            0.0007932823,
                            0.00094631844,
                            0.001123102,
                            0.0010730015,
                            0.0010190097,
                            0.015098785,
                            0.0010188612,
                            0.0013200733,
                            0.0005839896,
                            0.0007298255,
                            0.00095240516,
                            0.0006635466,
                            0.00080829347],
                    'rmse': [0.034383856,
                             0.034971133,
                             0.0333842,
                             0.03671285,
                             0.04145016,
                             0.04813255,
                             0.03765124,
                             0.042602155,
                             0.037742794,
                             0.042247254,
                             0.04191402,
                             0.13173564,
                             0.043315604,
                             0.036024563,
                             0.030895505,
                             0.03555721,
                             0.03609136,
                             0.033307873,
                             0.03554675,
                             0.033119664,
                             0.028165268,
                             0.030762289,
                             0.033512715,
                             0.0327567,
                             0.03192193,
                             0.12287711,
                             0.031919606,
                             0.036332812,
                             0.024165876,
                             0.027015284,
                             0.030861063,
                             0.025759399,
                             0.028430503]},
 'spectra_realgan': {'cosine': [0.9853446,
                                0.98256767,
                                0.98563063,
                                0.9851163,
                                0.98430246,
                                0.990299,
                                0.9817857,
                                0.98526233,
                                0.9705344,
                                0.9840986,
                                0.9703405,
                                0.76197344,
                                0.9708338,
                                0.9717489,
                                0.97797406,
                                0.97283286,
                                0.97123957,
                                0.9764412,
                                0.9774506,
                                0.98423177,
                                0.9908921,
                                0.9885252,
                                0.99138296,
                                0.99137866,
                                0.99382675,
                                0.93811303,
                                0.9917736,
                                0.9926594,
                                0.99521136,
                                0.9935207,
                                0.9913594,
                                0.9931009,
                                0.9935819],
                     'mae': [0.030539649,
                             0.030799946,
                             0.030067993,
                             0.031364214,
                             0.037744008,
                             0.040106792,
                             0.033149246,
                             0.03590371,
                             0.034257147,
                             0.037191924,
                             0.036726058,
                             0.12502028,
                             0.03720985,
                             0.03299886,
                             0.028176099,
                             0.031053208,
                             0.032060817,
                             0.030249339,
                             0.031115105,
                             0.029633017,
                             0.025752932,
                             0.027462823,
                             0.028603967,
                             0.029369647,
                             0.027923938,
                             0.118910305,
                             0.028411163,
                             0.030445337,
                             0.023159923,
                             0.025690857,
                             0.02844735,
                             0.02469657,
                             0.025105963],
                     'max_mae': 0.12502028,
                     'max_mse': 0.01737777,
                     'max_rmse': 0.13182476,
                     'median_mae': 0.030539649,
                     'min_cosine': 0.76197344,
                     'mse': [0.0015809664,
                             0.0016187706,
                             0.0015275833,
                             0.0017778876,
                             0.0022216057,
                             0.0028404759,
                             0.0018558182,
                             0.0022999325,
                             0.0018839997,
                             0.0022377805,
                             0.0021935673,
                             0.01737777,
                             0.002309737,
                             0.0017131699,
                             0.001309091,
                             0.001649585,
                             0.0016486815,
                             0.001485844,
                             0.0016125431,
                             0.0014481085,
                             0.001104015,
                             0.0012382809,
                             0.0014120649,
                             0.0013881207,
                             0.0013205992,
                             0.015468698,
                             0.0012956643,
                             0.0014877166,
                             0.00087834947,
                             0.0010618739,
                             0.0013008178,
                             0.0009894918,
                             0.0010752791],
                     'rmse': [0.03976137,
                              0.040233947,
                              0.03908431,
                              0.042165004,
                              0.04713391,
                              0.053296115,
                              0.04307921,
                              0.04795761,
                              0.043405063,
                              0.047305185,
                              0.046835534,
                              0.13182476,
                              0.048059724,
                              0.041390456,
                              0.036181364,
                              0.04061508,
                              0.040603958,
                              0.038546648,
                              0.040156484,
                              0.03805402,
                              0.03322672,
                              0.035189215,
                              0.03757745,
                              0.037257493,
                              0.03634005,
                              0.12437322,
                              0.035995338,
                              0.03857093,
                              0.02963696,
                              0.032586407,
                              0.036066853,
                              0.031456187,
                              0.032791447]},
 'spectra_realpca': {'cosine': [0.99592394,
                                0.99552435,
                                0.9958711,
                                0.99616116,
                                0.99626154,
                                0.9981005,
                                0.9956891,
                                0.9968456,
                                0.9937453,
                                0.99647313,
                                0.99432063,
                                0.9941098,
                                0.99416333,
                                0.9936037,
                                0.993588,
                                0.99322087,
                                0.9932172,
                                0.9941703,
                                0.99471545,
                                0.99618137,
                                0.99729186,
                                0.9969032,
                                0.9973674,
                                0.99799657,
                                0.9983731,
                                0.9982278,
                                0.99801546,
                                0.9983513,
                                0.99839914,
                                0.9978632,
                                0.9973172,
                                0.9976903,
                                0.9981454],
                     'mae': [0.016293611,
                             0.016118683,
                             0.016647164,
                             0.016692823,
                             0.016566422,
                             0.017548027,
                             0.016451024,
                             0.017186759,
                             0.015872382,
                             0.016606808,
                             0.016171038,
                             0.0153628765,
                             0.016044892,
                             0.015603104,
                             0.015481151,
                             0.015898915,
                             0.01568693,
                             0.015209607,
                             0.014896314,
                             0.014717062,
                             0.014370954,
                             0.014364395,
                             0.014272489,
                             0.013810243,
                             0.0138713,
                             0.013732071,
                             0.014032854,
                             0.013694668,
                             0.013622743,
                             0.0140278,
                             0.014324599,
                             0.014308351,
                             0.013968963],
                     'max_mae': 0.017548027,
                     'max_mse': 0.0004912639,
                     'max_rmse': 0.022164475,
                     'median_mae': 0.0153628765,
                     'min_cosine': 0.9932172,
                     'mse': [0.0004262989,
                             0.0004150114,
                             0.0004401752,
                             0.00044638838,
                             0.00044198942,
                             0.0004912639,
                             0.0004324034,
                             0.00047408525,
                             0.00039966742,
                             0.00043955294,
                             0.00042048618,
                             0.00038744128,
                             0.0004121807,
                             0.00039086267,
                             0.00038415138,
                             0.00040199846,
                             0.00039318297,
                             0.00037064194,
                             0.00035742685,
                             0.00034816508,
                             0.00032996802,
                             0.00033006273,
                             0.0003302328,
                             0.0003088054,
                             0.00030680178,
                             0.00031553913,
                             0.00031555345,
                             0.00030113885,
                             0.00029916505,
                             0.00031643105,
                             0.00032870966,
                             0.00032910553,
                             0.00031148677],
                     'rmse': [0.020647008,
                              0.020371828,
                              0.020980353,
                              0.021127906,
                              0.021023545,
                              0.022164475,
                              0.020794312,
                              0.021773499,
                              0.019991685,
                              0.020965518,
                              0.02050576,
                              0.019683529,
                              0.020302234,
                              0.019770248,
                              0.01959978,
                              0.0200499,
                              0.019828841,
                              0.019252064,
                              0.018905737,
                              0.018659182,
                              0.018165022,
                              0.018167628,
                              0.018172309,
                              0.01757286,
                              0.017515758,
                              0.017763421,
                              0.017763825,
                              0.017353352,
                              0.017296389,
                              0.017788509,
                              0.018130353,
                              0.018141266,
                              0.017648987]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_55.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529
Directory path: experiments/inpainting/gann_4_night_20180901_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_55.0/images
Optimal number of principal components:  15
Reconstruction error:  14.584131
Energy conservation:  0.5608882
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_55.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.932551248322828, 3.0518192578308594],
                   'kl_div': 0.38647515,
                   'ks_tests': {10000: KstestResult(statistic=0.1869, pvalue=5.092091374716373e-153, statistic_location=-0.0066271387, statistic_sign=-1),
                                20000: KstestResult(statistic=0.17870000000000003, pvalue=7.584172290419547e-280, statistic_location=-0.005969012, statistic_sign=-1),
                                30000: KstestResult(statistic=0.18020000000000003, pvalue=0.0, statistic_location=0.0062052226, statistic_sign=1),
                                40000: KstestResult(statistic=0.17677500000000002, pvalue=0.0, statistic_location=0.0068970094, statistic_sign=1),
                                50000: KstestResult(statistic=0.17988000000000004, pvalue=0.0, statistic_location=-0.006089297, statistic_sign=-1),
                                60000: KstestResult(statistic=0.1794, pvalue=0.0, statistic_location=0.006721025, statistic_sign=1),
                                70000: KstestResult(statistic=0.17935714285714288, pvalue=0.0, statistic_location=0.0064070732, statistic_sign=1),
                                80000: KstestResult(statistic=0.17762500000000003, pvalue=0.0, statistic_location=0.006281778, statistic_sign=1),
                                90000: KstestResult(statistic=0.1792555555555555, pvalue=0.0, statistic_location=0.006281778, statistic_sign=1),
                                100000: KstestResult(statistic=0.17743, pvalue=0.0, statistic_location=-0.00663447, statistic_sign=-1),
                                110000: KstestResult(statistic=0.18080000000000007, pvalue=0.0, statistic_location=0.00627755, statistic_sign=1)},
                   'moments': {'mean_error': 0.17316562,
                               'means': [0.0006159432, -6.3748215e-05],
                               'stds': [0.023046242, 0.005335677],
                               'variance_ratio': 15.939472}},
 'originals': {'gan': {'mae': 0.10246788710355759,
                       'mse': 0.08953791111707687,
                       'psnr': 15.509013175964355,
                       'rmse': 0.29922884702682495,
                       'ssim': 0.8870316743850708},
               'pca': {'mae': 0.006495438050478697,
                       'mse': 7.993657345650718e-05,
                       'psnr': 46.2637939453125,
                       'rmse': 0.008940725587308407,
                       'ssim': 0.9914649128913879}},
 'reconstructions': {'mae': 0.10085136443376541,
                     'mse': 0.08947132527828217,
                     'psnr': 15.774408340454102,
                     'rmse': 0.2991175651550293,
                     'ssim': 0.8935096263885498},
 'residual_spectra_pcagan': {'cosine': [0.1074059,
                                        0.29642245,
                                        0.3771902,
                                        0.37714466,
                                        0.30413976,
                                        0.37140927,
                                        0.39951086,
                                        0.35368785,
                                        0.37377933,
                                        0.31780577,
                                        0.02466043],
                             'mae': [0.011347775,
                                     0.010882339,
                                     0.008809464,
                                     0.009903065,
                                     0.010078369,
                                     0.008204348,
                                     0.008956842,
                                     0.009712753,
                                     0.008784896,
                                     0.009331758,
                                     0.025213372],
                             'max_mae': 0.025213372,
                             'max_mse': 0.003103708,
                             'max_rmse': 0.05571093,
                             'median_distance': 1.4824612,
                             'median_mae': 0.009712753,
                             'min_cosine': 0.02466043,
                             'mse': [0.0002800626,
                                     0.0004167217,
                                     0.0002159105,
                                     0.00023939963,
                                     0.00030844583,
                                     0.00018043075,
                                     0.00017271204,
                                     0.00021630664,
                                     0.00021976909,
                                     0.00019265321,
                                     0.003103708],
                             'rmse': [0.016735071,
                                      0.020413762,
                                      0.0146938935,
                                      0.015472544,
                                      0.017562626,
                                      0.0134324515,
                                      0.013141995,
                                      0.014707367,
                                      0.014824611,
                                      0.013879958,
                                      0.05571093]},
 'residuals': {'mae': 0.01102045364677906,
               'mse': 0.0005041927215643227,
               'psnr': 11.16614818572998,
               'rmse': 0.022454235702753067,
               'ssds': [58.465424, 3.1320581],
               'ssim': 0.6458294987678528},
 'spectra_pcagan': {'cosine': [0.9990841,
                               0.99430114,
                               0.99658954,
                               0.99831593,
                               0.9989697,
                               0.99741936,
                               0.99785495,
                               0.9988229,
                               0.99796396,
                               0.99901056,
                               -0.64525646],
                    'mae': [0.014976652,
                            0.020333614,
                            0.017172314,
                            0.016815163,
                            0.0130058685,
                            0.013453598,
                            0.014711416,
                            0.013737083,
                            0.013679306,
                            0.01300661,
                            0.95847344],
                    'max_mae': 0.95847344,
                    'max_mse': 0.9802332,
                    'max_rmse': 0.99006724,
                    'median_mae': 0.014711416,
                    'min_cosine': -0.64525646,
                    'mse': [0.00037614678,
                            0.0006772052,
                            0.00048911537,
                            0.0004724042,
                            0.0003098779,
                            0.00033776424,
                            0.00035343535,
                            0.00031295815,
                            0.00033965128,
                            0.00028270343,
                            0.9802332],
                    'rmse': [0.019394504,
                             0.026023166,
                             0.022115953,
                             0.021734862,
                             0.017603349,
                             0.018378364,
                             0.018799877,
                             0.017690623,
                             0.01842963,
                             0.016813787,
                             0.99006724]},
 'spectra_realgan': {'cosine': [0.99906915,
                                0.9933958,
                                0.99578017,
                                0.9978164,
                                0.9987539,
                                0.99656457,
                                0.9971878,
                                0.99853414,
                                0.99725324,
                                0.9988347,
                                -0.6451682],
                     'mae': [0.015093413,
                             0.021834007,
                             0.018909004,
                             0.01878682,
                             0.014685913,
                             0.016091838,
                             0.017106565,
                             0.015522933,
                             0.016487284,
                             0.014210428,
                             0.95841867],
                     'max_mae': 0.95841867,
                     'max_mse': 0.98011833,
                     'max_rmse': 0.99000925,
                     'median_mae': 0.016487284,
                     'min_cosine': -0.6451682,
                     'mse': [0.00038180794,
                             0.0007860678,
                             0.00059797306,
                             0.00057443464,
                             0.00037425736,
                             0.00044651533,
                             0.00046026468,
                             0.00038939103,
                             0.0004553615,
                             0.00033263222,
                             0.98011833],
                     'rmse': [0.019539906,
                              0.0280369,
                              0.024453487,
                              0.023967367,
                              0.019345732,
                              0.02113091,
                              0.02145378,
                              0.019732993,
                              0.0213392,
                              0.018238207,
                              0.99000925]},
 'spectra_realpca': {'cosine': [0.999988,
                                0.9989679,
                                0.99913305,
                                0.9995079,
                                0.9997867,
                                0.9990574,
                                0.9992914,
                                0.9997365,
                                0.99928963,
                                0.9998295,
                                0.9999965],
                     'mae': [0.0016627628,
                             0.0087484745,
                             0.0085561825,
                             0.007945795,
                             0.0062895194,
                             0.008635291,
                             0.008401103,
                             0.006584082,
                             0.008415357,
                             0.005476343,
                             0.000734913],
                     'max_mae': 0.0087484745,
                     'max_mse': 0.00012283467,
                     'max_rmse': 0.01108308,
                     'median_mae': 0.007945795,
                     'min_cosine': 0.9989679,
                     'mse': [4.4670937e-06,
                             0.00012283467,
                             0.00011810292,
                             0.0001012558,
                             6.3142994e-05,
                             0.000120528195,
                             0.00011404256,
                             7.01429e-05,
                             0.000115232244,
                             4.8668368e-05,
                             8.8455425e-07],
                     'rmse': [0.00211355,
                              0.01108308,
                              0.0108675165,
                              0.010062594,
                              0.007946257,
                              0.010978533,
                              0.010679071,
                              0.008375136,
                              0.010734628,
                              0.006976272,
                              0.00094050745]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_55.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319
Directory path: experiments/inpainting/gann_4_night_20180901_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_55.0/images
Optimal number of principal components:  15
Reconstruction error:  14.584131
Energy conservation:  0.5608882
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_55.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.940780002103074, 3.004001986241356],
                   'kl_div': 0.42360708,
                   'ks_tests': {10000: KstestResult(statistic=0.2072, pvalue=3.179677456517462e-188, statistic_location=-0.0059278877, statistic_sign=-1),
                                20000: KstestResult(statistic=0.19455, pvalue=0.0, statistic_location=-0.006751308, statistic_sign=-1),
                                30000: KstestResult(statistic=0.20126666666666668, pvalue=0.0, statistic_location=-0.00635138, statistic_sign=-1),
                                40000: KstestResult(statistic=0.19420000000000004, pvalue=0.0, statistic_location=-0.0061009973, statistic_sign=-1),
                                50000: KstestResult(statistic=0.19862000000000002, pvalue=0.0, statistic_location=-0.005989358, statistic_sign=-1),
                                60000: KstestResult(statistic=0.19808333333333333, pvalue=0.0, statistic_location=-0.0061465707, statistic_sign=-1),
                                70000: KstestResult(statistic=0.1956285714285714, pvalue=0.0, statistic_location=-0.0063614515, statistic_sign=-1),
                                80000: KstestResult(statistic=0.19416250000000002, pvalue=0.0, statistic_location=-0.006373439, statistic_sign=-1),
                                90000: KstestResult(statistic=0.19663333333333335, pvalue=0.0, statistic_location=-0.0058659473, statistic_sign=-1),
                                100000: KstestResult(statistic=0.19849000000000003, pvalue=0.0, statistic_location=-0.0059947446, statistic_sign=-1),
                                110000: KstestResult(statistic=0.19880909090909094, pvalue=0.0, statistic_location=-0.0062590167, statistic_sign=-1),
                                120000: KstestResult(statistic=0.20053333333333334, pvalue=0.0, statistic_location=-0.0060101952, statistic_sign=-1),
                                130000: KstestResult(statistic=0.19863076923076922, pvalue=0.0, statistic_location=-0.0063474504, statistic_sign=-1),
                                140000: KstestResult(statistic=0.19305714285714287, pvalue=0.0, statistic_location=-0.006248256, statistic_sign=-1),
                                150000: KstestResult(statistic=0.19812000000000002, pvalue=0.0, statistic_location=-0.0060094967, statistic_sign=-1),
                                160000: KstestResult(statistic=0.1972625, pvalue=0.0, statistic_location=-0.00599223, statistic_sign=-1),
                                170000: KstestResult(statistic=0.1941, pvalue=0.0, statistic_location=-0.0059233904, statistic_sign=-1),
                                180000: KstestResult(statistic=0.19706111111111113, pvalue=0.0, statistic_location=-0.0063355956, statistic_sign=-1),
                                190000: KstestResult(statistic=0.19678947368421051, pvalue=0.0, statistic_location=-0.006256409, statistic_sign=-1),
                                200000: KstestResult(statistic=0.19802, pvalue=0.0, statistic_location=-0.0063607777, statistic_sign=-1),
                                210000: KstestResult(statistic=0.19844761904761907, pvalue=0.0, statistic_location=-0.0062453337, statistic_sign=-1),
                                220000: KstestResult(statistic=0.1978909090909091, pvalue=0.0, statistic_location=-0.0061163325, statistic_sign=-1)},
                   'moments': {'mean_error': 0.011748218,
                               'means': [-0.00023313925, -5.5769604e-05],
                               'stds': [0.0203259, 0.0050931433],
                               'variance_ratio': 12.370145}},
 'originals': {'gan': {'mae': 0.0791468694806099,
                       'mse': 0.051039062440395355,
                       'psnr': 18.142791748046875,
                       'rmse': 0.2259182631969452,
                       'ssim': 0.575168788433075},
               'pca': {'mae': 0.006987081840634346,
                       'mse': 9.580815822118893e-05,
                       'psnr': 45.63506317138672,
                       'rmse': 0.00978816393762827,
                       'ssim': 0.9943362474441528}},
 'reconstructions': {'mae': 0.07787544280290604,
                     'mse': 0.05095084384083748,
                     'psnr': 18.377574920654297,
                     'rmse': 0.22572293877601624,
                     'ssim': 0.5779223442077637},
 'residual_spectra_pcagan': {'cosine': [0.3413002,
                                        0.2967994,
                                        0.22774784,
                                        0.25358558,
                                        0.32588902,
                                        0.11123743,
                                        0.3104651,
                                        0.40131563,
                                        0.39998916,
                                        0.34024152,
                                        0.39857966,
                                        0.40236917,
                                        0.38426453,
                                        0.41352698,
                                        0.34800264,
                                        0.022841502,
                                        0.26310757,
                                        0.04859244,
                                        0.094407454,
                                        0.39763054,
                                        0.3216344,
                                        0.36212406],
                             'mae': [0.009638379,
                                     0.010881995,
                                     0.011279802,
                                     0.011043159,
                                     0.009809052,
                                     0.011137043,
                                     0.010449208,
                                     0.008455692,
                                     0.009442033,
                                     0.009385031,
                                     0.007882437,
                                     0.008861227,
                                     0.009130707,
                                     0.00831299,
                                     0.008735315,
                                     0.0256966,
                                     0.010049414,
                                     0.012834028,
                                     0.011369928,
                                     0.009694544,
                                     0.010531107,
                                     0.008366279],
                             'max_mae': 0.0256966,
                             'max_mse': 0.0032338463,
                             'max_rmse': 0.056866918,
                             'median_distance': 1.5075307,
                             'median_mae': 0.009751798,
                             'min_cosine': 0.022841502,
                             'mse': [0.00021032119,
                                     0.00034385902,
                                     0.0005409755,
                                     0.00033784736,
                                     0.00028487903,
                                     0.00026841782,
                                     0.00037265412,
                                     0.00018628093,
                                     0.00020812034,
                                     0.00024486487,
                                     0.00015704757,
                                     0.00016967731,
                                     0.00018109445,
                                     0.00017649282,
                                     0.0001552015,
                                     0.0032338463,
                                     0.0001999675,
                                     0.00033277794,
                                     0.00025154458,
                                     0.00020582047,
                                     0.00028166082,
                                     0.00018117316],
                             'rmse': [0.014502455,
                                      0.018543435,
                                      0.02325888,
                                      0.018380625,
                                      0.016878359,
                                      0.016383462,
                                      0.019304251,
                                      0.013648477,
                                      0.014426377,
                                      0.015648158,
                                      0.012531863,
                                      0.013026024,
                                      0.013457133,
                                      0.0132850595,
                                      0.012457989,
                                      0.056866918,
                                      0.014140987,
                                      0.018242203,
                                      0.015860157,
                                      0.014346444,
                                      0.016782753,
                                      0.013460058]},
 'residuals': {'mae': 0.010590272024273872,
               'mse': 0.0003874783287756145,
               'psnr': 19.20166778564453,
               'rmse': 0.01968446932733059,
               'ssds': [90.90281, 5.7074823],
               'ssim': 0.6520751118659973},
 'spectra_pcagan': {'cosine': [0.9693826,
                               0.98750305,
                               0.9800426,
                               0.9872934,
                               0.9962547,
                               0.9990647,
                               0.99424005,
                               0.99661493,
                               0.99832463,
                               0.99900126,
                               0.9975448,
                               0.9977865,
                               0.9988105,
                               0.9979702,
                               0.9990476,
                               -0.6446029,
                               0.9988109,
                               0.99948525,
                               0.99917173,
                               0.99593043,
                               0.0069045075,
                               0.9895983],
                    'mae': [0.03569397,
                            0.04606027,
                            0.032947883,
                            0.034522656,
                            0.017210126,
                            0.014993524,
                            0.020416057,
                            0.017074496,
                            0.01675169,
                            0.012852559,
                            0.013256235,
                            0.015003912,
                            0.013783847,
                            0.013751556,
                            0.012830069,
                            0.9587376,
                            0.0149847,
                            0.014374005,
                            0.014847646,
                            0.020174332,
                            0.34472507,
                            0.028267508],
                    'max_mae': 0.9587376,
                    'max_mse': 0.98113596,
                    'max_rmse': 0.9905231,
                    'median_mae': 0.016913094,
                    'min_cosine': -0.6446029,
                    'mse': [0.0017429474,
                            0.0029799,
                            0.0019225291,
                            0.0017768326,
                            0.00053743046,
                            0.00037634434,
                            0.0006837228,
                            0.00048137794,
                            0.00046420726,
                            0.0003013327,
                            0.00032153272,
                            0.00036718883,
                            0.00031619568,
                            0.00033973574,
                            0.00027210265,
                            0.98113596,
                            0.0003627486,
                            0.00033260076,
                            0.0003561028,
                            0.0006273074,
                            0.12401941,
                            0.0012011119],
                    'rmse': [0.04174862,
                             0.05458846,
                             0.043846656,
                             0.042152494,
                             0.023182547,
                             0.019399596,
                             0.026148094,
                             0.021940326,
                             0.02154547,
                             0.017358938,
                             0.017931333,
                             0.019162172,
                             0.017781893,
                             0.018431922,
                             0.016495535,
                             0.9905231,
                             0.01904596,
                             0.018237345,
                             0.018870687,
                             0.025046105,
                             0.35216388,
                             0.03465706]},
 'spectra_realgan': {'cosine': [0.9670778,
                                0.9860739,
                                0.9780557,
                                0.98576266,
                                0.9951324,
                                0.99904984,
                                0.993334,
                                0.9958081,
                                0.9978229,
                                0.99878496,
                                0.99668676,
                                0.99711907,
                                0.9985224,
                                0.9972569,
                                0.99887186,
                                -0.6445148,
                                0.9986888,
                                0.9994831,
                                0.9991609,
                                0.9950985,
                                0.00620771,
                                0.98793983],
                     'mae': [0.03637817,
                             0.046589788,
                             0.034258008,
                             0.035527002,
                             0.019814119,
                             0.015101448,
                             0.02191781,
                             0.018824134,
                             0.018703619,
                             0.014546591,
                             0.015915832,
                             0.017371306,
                             0.015557715,
                             0.016533135,
                             0.014031367,
                             0.95868284,
                             0.01574498,
                             0.0143905,
                             0.014926655,
                             0.02216288,
                             0.34483683,
                             0.029416408],
                     'max_mae': 0.95868284,
                     'max_mse': 0.9810211,
                     'max_rmse': 0.9904651,
                     'median_mae': 0.018763877,
                     'min_cosine': -0.6445148,
                     'mse': [0.0018786305,
                             0.0031433513,
                             0.0020680984,
                             0.0019107212,
                             0.00067015114,
                             0.00038199013,
                             0.00079278374,
                             0.0005900748,
                             0.0005667468,
                             0.00036588818,
                             0.000430694,
                             0.00047388955,
                             0.0003922552,
                             0.0004558564,
                             0.00032200202,
                             0.9810211,
                             0.0003959076,
                             0.0003332668,
                             0.00035991942,
                             0.0007465529,
                             0.12421885,
                             0.001340763],
                     'rmse': [0.04334317,
                              0.056065597,
                              0.04547635,
                              0.043711796,
                              0.025887277,
                              0.019544568,
                              0.028156416,
                              0.024291456,
                              0.023806445,
                              0.019128203,
                              0.020753168,
                              0.021769004,
                              0.019805433,
                              0.021350794,
                              0.017944414,
                              0.9904651,
                              0.019897427,
                              0.018255597,
                              0.018971542,
                              0.02732312,
                              0.35244694,
                              0.03661643]},
 'spectra_realpca': {'cosine': [0.99747556,
                                0.9987605,
                                0.99793774,
                                0.9982931,
                                0.9989346,
                                0.999988,
                                0.9989679,
                                0.99913305,
                                0.9995079,
                                0.9997867,
                                0.9990574,
                                0.9992914,
                                0.9997365,
                                0.99928963,
                                0.9998295,
                                0.9999965,
                                0.999898,
                                0.9999981,
                                0.9999915,
                                0.9991923,
                                0.9988019,
                                0.99818444],
                     'mae': [0.0095539475,
                             0.0106405765,
                             0.010033954,
                             0.010035484,
                             0.008657412,
                             0.0016627628,
                             0.0087484745,
                             0.0085561825,
                             0.007945795,
                             0.0062895194,
                             0.008635291,
                             0.008401103,
                             0.006584082,
                             0.008415357,
                             0.005476343,
                             0.000734913,
                             0.0042795646,
                             0.00083263684,
                             0.0014913286,
                             0.008467521,
                             0.007982623,
                             0.010290919],
                     'max_mae': 0.0106405765,
                     'max_mse': 0.00019107551,
                     'max_rmse': 0.013823006,
                     'median_mae': 0.00840823,
                     'min_cosine': 0.99747556,
                     'mse': [0.00014601901,
                             0.00019107551,
                             0.00016131518,
                             0.00016057467,
                             0.00012086496,
                             4.4670937e-06,
                             0.00012283467,
                             0.00011810292,
                             0.0001012558,
                             6.3142994e-05,
                             0.000120528195,
                             0.00011404256,
                             7.01429e-05,
                             0.000115232244,
                             4.8668368e-05,
                             8.8455425e-07,
                             2.9550883e-05,
                             1.1203878e-06,
                             3.5709795e-06,
                             0.000115467265,
                             0.00012756647,
                             0.00017135176],
                     'rmse': [0.012083832,
                              0.013823006,
                              0.012700992,
                              0.012671806,
                              0.010993861,
                              0.00211355,
                              0.01108308,
                              0.0108675165,
                              0.010062594,
                              0.007946257,
                              0.010978533,
                              0.010679071,
                              0.008375136,
                              0.010734628,
                              0.006976272,
                              0.00094050745,
                              0.0054360726,
                              0.0010584837,
                              0.0018897036,
                              0.010745569,
                              0.011294533,
                              0.013090139]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_55.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809
Directory path: experiments/inpainting/gann_4_night_20180901_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_55.0/images
Optimal number of principal components:  15
Reconstruction error:  14.584131
Energy conservation:  0.5608882
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_55.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9130967822707543, 3.0069764279701774],
                   'kl_div': 0.3969893,
                   'ks_tests': {10000: KstestResult(statistic=0.1979, pvalue=1.2383074661322037e-171, statistic_location=-0.006390329, statistic_sign=-1),
                                20000: KstestResult(statistic=0.1972, pvalue=0.0, statistic_location=-0.005985602, statistic_sign=-1),
                                30000: KstestResult(statistic=0.19129999999999997, pvalue=0.0, statistic_location=-0.0062114615, statistic_sign=-1),
                                40000: KstestResult(statistic=0.19242499999999998, pvalue=0.0, statistic_location=-0.006246049, statistic_sign=-1),
                                50000: KstestResult(statistic=0.19208000000000003, pvalue=0.0, statistic_location=-0.00583118, statistic_sign=-1),
                                60000: KstestResult(statistic=0.19546666666666668, pvalue=0.0, statistic_location=-0.006387073, statistic_sign=-1),
                                70000: KstestResult(statistic=0.19175714285714285, pvalue=0.0, statistic_location=-0.006575424, statistic_sign=-1),
                                80000: KstestResult(statistic=0.19213750000000002, pvalue=0.0, statistic_location=-0.005989297, statistic_sign=-1),
                                90000: KstestResult(statistic=0.1945888888888889, pvalue=0.0, statistic_location=-0.0056896987, statistic_sign=-1),
                                100000: KstestResult(statistic=0.19287, pvalue=0.0, statistic_location=-0.0055131577, statistic_sign=-1),
                                110000: KstestResult(statistic=0.19176363636363639, pvalue=0.0, statistic_location=-0.006406097, statistic_sign=-1),
                                120000: KstestResult(statistic=0.19251666666666667, pvalue=0.0, statistic_location=-0.005561076, statistic_sign=-1),
                                130000: KstestResult(statistic=0.1925, pvalue=0.0, statistic_location=-0.0056380318, statistic_sign=-1),
                                140000: KstestResult(statistic=0.19088571428571427, pvalue=0.0, statistic_location=-0.0065432168, statistic_sign=-1),
                                150000: KstestResult(statistic=0.19238666666666668, pvalue=0.0, statistic_location=-0.005766022, statistic_sign=-1),
                                160000: KstestResult(statistic=0.19199999999999998, pvalue=0.0, statistic_location=-0.0057553872, statistic_sign=-1),
                                170000: KstestResult(statistic=0.1909294117647059, pvalue=0.0, statistic_location=-0.005993301, statistic_sign=-1),
                                180000: KstestResult(statistic=0.1925222222222222, pvalue=0.0, statistic_location=-0.006010874, statistic_sign=-1),
                                190000: KstestResult(statistic=0.1907842105263158, pvalue=0.0, statistic_location=-0.006208444, statistic_sign=-1),
                                200000: KstestResult(statistic=0.19073500000000004, pvalue=0.0, statistic_location=-0.006003651, statistic_sign=-1),
                                210000: KstestResult(statistic=0.19263333333333332, pvalue=0.0, statistic_location=-0.006115999, statistic_sign=-1),
                                220000: KstestResult(statistic=0.1916090909090909, pvalue=0.0, statistic_location=-0.005696683, statistic_sign=-1),
                                230000: KstestResult(statistic=0.19145217391304348, pvalue=0.0, statistic_location=-0.0059321504, statistic_sign=-1),
                                240000: KstestResult(statistic=0.19253749999999997, pvalue=0.0, statistic_location=-0.0056939907, statistic_sign=-1),
                                250000: KstestResult(statistic=0.19060000000000002, pvalue=0.0, statistic_location=-0.0058726813, statistic_sign=-1),
                                260000: KstestResult(statistic=0.1933423076923077, pvalue=0.0, statistic_location=-0.005939969, statistic_sign=-1),
                                270000: KstestResult(statistic=0.19251111111111113, pvalue=0.0, statistic_location=-0.0056506395, statistic_sign=-1),
                                280000: KstestResult(statistic=0.19259285714285712, pvalue=0.0, statistic_location=-0.005694981, statistic_sign=-1),
                                290000: KstestResult(statistic=0.19150689655172412, pvalue=0.0, statistic_location=-0.0056957174, statistic_sign=-1),
                                300000: KstestResult(statistic=0.19352333333333332, pvalue=0.0, statistic_location=-0.0058712587, statistic_sign=-1),
                                310000: KstestResult(statistic=0.19273225806451616, pvalue=0.0, statistic_location=-0.0056956597, statistic_sign=-1),
                                320000: KstestResult(statistic=0.191759375, pvalue=0.0, statistic_location=-0.005696683, statistic_sign=-1),
                                330000: KstestResult(statistic=0.19205454545454545, pvalue=0.0, statistic_location=-0.0061385715, statistic_sign=-1)},
                   'moments': {'mean_error': -0.02433131,
                               'means': [-0.00039741758, -6.366162e-05],
                               'stds': [0.018622587, 0.0050764927],
                               'variance_ratio': 10.398164}},
 'originals': {'gan': {'mae': 0.061107855290174484,
                       'mse': 0.03438358008861542,
                       'psnr': 19.85433006286621,
                       'rmse': 0.18542809784412384,
                       'ssim': 0.6147010922431946},
               'pca': {'mae': 0.007305982988327742,
                       'mse': 0.00010286938049830496,
                       'psnr': 45.326229095458984,
                       'rmse': 0.010142453946173191,
                       'ssim': 0.9948617219924927}},
 'reconstructions': {'mae': 0.05985763669013977,
                     'mse': 0.03429058566689491,
                     'psnr': 20.097341537475586,
                     'rmse': 0.18517717719078064,
                     'ssim': 0.6171274781227112},
 'residual_spectra_pcagan': {'cosine': [0.34666777,
                                        0.38266212,
                                        0.33788443,
                                        0.40835875,
                                        0.3995728,
                                        0.2673344,
                                        0.37394112,
                                        0.32487637,
                                        0.24788304,
                                        0.25505292,
                                        0.34552598,
                                        0.11310642,
                                        0.3308871,
                                        0.42859304,
                                        0.41381672,
                                        0.36468986,
                                        0.39949682,
                                        0.41328108,
                                        0.41225037,
                                        0.43891886,
                                        0.3541327,
                                        0.021302318,
                                        0.27269232,
                                        0.055094875,
                                        0.10246634,
                                        0.40682548,
                                        0.33070147,
                                        0.39429823,
                                        0.29109696,
                                        0.25409007,
                                        0.07577223,
                                        0.39346755,
                                        0.111345574],
                             'mae': [0.0086208545,
                                     0.007877739,
                                     0.008392344,
                                     0.007972272,
                                     0.007966313,
                                     0.010083216,
                                     0.009178776,
                                     0.01019948,
                                     0.01058713,
                                     0.010985766,
                                     0.00944038,
                                     0.0107081365,
                                     0.010217872,
                                     0.008086171,
                                     0.0090211,
                                     0.009023056,
                                     0.007790806,
                                     0.008616745,
                                     0.008693576,
                                     0.008087222,
                                     0.008485026,
                                     0.025855282,
                                     0.009799233,
                                     0.0125466045,
                                     0.010906967,
                                     0.00947632,
                                     0.010243023,
                                     0.007865186,
                                     0.009492609,
                                     0.010845597,
                                     0.011152016,
                                     0.010119156,
                                     0.009943719],
                             'max_mae': 0.025855282,
                             'max_mse': 0.0033099414,
                             'max_rmse': 0.05753209,
                             'median_distance': 1.4481921,
                             'median_mae': 0.00947632,
                             'min_cosine': 0.021302318,
                             'mse': [0.0002064167,
                                     0.00014993783,
                                     0.00020752013,
                                     0.00015566648,
                                     0.00014200133,
                                     0.00032676698,
                                     0.00017715537,
                                     0.00028096314,
                                     0.00044967872,
                                     0.00033425158,
                                     0.00025387915,
                                     0.00024218622,
                                     0.0003204414,
                                     0.00016090267,
                                     0.00018865433,
                                     0.00020972604,
                                     0.00015557704,
                                     0.00016116377,
                                     0.00015240727,
                                     0.00015564125,
                                     0.00014753579,
                                     0.0033099414,
                                     0.00018739075,
                                     0.00031508613,
                                     0.00022639436,
                                     0.00019526065,
                                     0.0002698142,
                                     0.0001478927,
                                     0.0002366806,
                                     0.0004338274,
                                     0.0002781316,
                                     0.00023091605,
                                     0.00020998731],
                             'rmse': [0.01436721,
                                      0.01224491,
                                      0.014405559,
                                      0.012476637,
                                      0.011916431,
                                      0.018076697,
                                      0.013309972,
                                      0.016761955,
                                      0.02120563,
                                      0.01828255,
                                      0.015933586,
                                      0.015562333,
                                      0.017900877,
                                      0.012684741,
                                      0.013735149,
                                      0.014481922,
                                      0.012473052,
                                      0.012695029,
                                      0.012345334,
                                      0.012475627,
                                      0.012146431,
                                      0.05753209,
                                      0.013689074,
                                      0.017750666,
                                      0.015046407,
                                      0.0139735695,
                                      0.016426021,
                                      0.012161114,
                                      0.015384427,
                                      0.020828525,
                                      0.016677277,
                                      0.015195922,
                                      0.014490939]},
 'residuals': {'mae': 0.00994786899536848,
               'mse': 0.00032181196729652584,
               'psnr': 20.00811767578125,
               'rmse': 0.017939118668437004,
               'ssds': [114.495995, 8.50567],
               'ssim': 0.6449310779571533},
 'spectra_pcagan': {'cosine': [0.98365396,
                               0.9813812,
                               0.9855718,
                               0.9880644,
                               0.9835415,
                               0.98387825,
                               0.9691355,
                               0.98784244,
                               0.98083466,
                               0.9875289,
                               0.99631816,
                               0.9990643,
                               0.99416345,
                               0.9965712,
                               0.9983387,
                               0.9989873,
                               0.9974122,
                               0.9977829,
                               0.9987887,
                               0.99792,
                               0.9990007,
                               -0.6459927,
                               0.99877566,
                               0.9994691,
                               0.99917823,
                               0.9956808,
                               0.008090675,
                               0.9895168,
                               0.979445,
                               0.974813,
                               0.99951124,
                               0.9985633,
                               0.9990451],
                    'mae': [0.023459291,
                            0.026995312,
                            0.022304269,
                            0.022449639,
                            0.025282167,
                            0.02611062,
                            0.03594752,
                            0.045901198,
                            0.03263282,
                            0.0345613,
                            0.016761616,
                            0.01505144,
                            0.020506585,
                            0.017080924,
                            0.016597332,
                            0.012993892,
                            0.013431109,
                            0.014946945,
                            0.013952676,
                            0.013856778,
                            0.013073248,
                            0.9592576,
                            0.015175525,
                            0.014681746,
                            0.014822528,
                            0.020658989,
                            0.34424445,
                            0.028590573,
                            0.0371577,
                            0.031650208,
                            0.014707292,
                            0.01589514,
                            0.0145635465],
                    'max_mae': 0.9592576,
                    'max_mse': 0.9816082,
                    'max_rmse': 0.99076146,
                    'median_mae': 0.020506585,
                    'min_cosine': -0.6459927,
                    'mse': [0.00093397254,
                            0.0010695104,
                            0.00085666735,
                            0.0007952888,
                            0.00094408396,
                            0.0011494055,
                            0.0017588653,
                            0.002958045,
                            0.0018832164,
                            0.0018019895,
                            0.000505958,
                            0.00037598977,
                            0.0006907407,
                            0.00048146368,
                            0.00045647103,
                            0.000306739,
                            0.00033496885,
                            0.00036355865,
                            0.0003219874,
                            0.00034802876,
                            0.00028551905,
                            0.9816082,
                            0.00037455073,
                            0.00034516864,
                            0.00035547686,
                            0.00065798336,
                            0.12363721,
                            0.0012198921,
                            0.0020795544,
                            0.0015626638,
                            0.00035995583,
                            0.00040907302,
                            0.00035710318],
                    'rmse': [0.030560965,
                             0.03270337,
                             0.02926888,
                             0.028200865,
                             0.030725949,
                             0.033902884,
                             0.041938826,
                             0.054387912,
                             0.04339604,
                             0.042449847,
                             0.02249351,
                             0.019390456,
                             0.026281947,
                             0.02194228,
                             0.021365182,
                             0.017513966,
                             0.018302154,
                             0.019067215,
                             0.017944008,
                             0.01865553,
                             0.01689731,
                             0.99076146,
                             0.019353313,
                             0.018578714,
                             0.018854095,
                             0.025651187,
                             0.35162082,
                             0.034926955,
                             0.04560213,
                             0.03953054,
                             0.018972501,
                             0.020225553,
                             0.018897174]},
 'spectra_realgan': {'cosine': [0.98116416,
                                0.9792906,
                                0.9832459,
                                0.98577976,
                                0.9814677,
                                0.98156124,
                                0.9668413,
                                0.9864012,
                                0.97883904,
                                0.9860042,
                                0.99519145,
                                0.9990496,
                                0.9932539,
                                0.9957636,
                                0.99784756,
                                0.9987711,
                                0.996565,
                                0.9971138,
                                0.9984994,
                                0.9972058,
                                0.9988238,
                                -0.64590436,
                                0.998654,
                                0.99946684,
                                0.999167,
                                0.9948542,
                                0.0073883943,
                                0.9878665,
                                0.97839326,
                                0.97260165,
                                0.99950576,
                                0.9981981,
                                0.99902624],
                     'mae': [0.025522962,
                             0.02819047,
                             0.024054082,
                             0.024406085,
                             0.026515229,
                             0.02765658,
                             0.0366096,
                             0.04644786,
                             0.033958904,
                             0.03557728,
                             0.01940579,
                             0.015161359,
                             0.022016011,
                             0.018857328,
                             0.018548708,
                             0.01466665,
                             0.016057845,
                             0.017318573,
                             0.015701028,
                             0.016630571,
                             0.01427325,
                             0.95920295,
                             0.01591568,
                             0.014694339,
                             0.014899051,
                             0.02259362,
                             0.3443543,
                             0.029696891,
                             0.03761046,
                             0.032620154,
                             0.014728023,
                             0.01795012,
                             0.014717337],
                     'max_mae': 0.95920295,
                     'max_mse': 0.9814932,
                     'max_rmse': 0.99070334,
                     'median_mae': 0.022016011,
                     'min_cosine': -0.64590436,
                     'mse': [0.0010776102,
                             0.0011927221,
                             0.0009870987,
                             0.00093792914,
                             0.0010650458,
                             0.0012817222,
                             0.0018940758,
                             0.0031226284,
                             0.0020291568,
                             0.0019350204,
                             0.0006385489,
                             0.00038157578,
                             0.000800654,
                             0.0005906596,
                             0.00055675977,
                             0.00037131037,
                             0.00044307986,
                             0.00047080207,
                             0.0003982088,
                             0.00046431867,
                             0.00033573667,
                             0.9814932,
                             0.00040745668,
                             0.00034584056,
                             0.00035928897,
                             0.00077649346,
                             0.123837024,
                             0.0013584506,
                             0.0021697725,
                             0.0016991112,
                             0.0003608177,
                             0.00051253545,
                             0.00036351563],
                     'rmse': [0.032826975,
                              0.03453581,
                              0.031418126,
                              0.030625628,
                              0.03263504,
                              0.03580115,
                              0.04352098,
                              0.055880483,
                              0.04504616,
                              0.04398887,
                              0.025269525,
                              0.019533964,
                              0.02829583,
                              0.02430349,
                              0.023595758,
                              0.019269416,
                              0.021049462,
                              0.021697974,
                              0.01995517,
                              0.021548055,
                              0.018323118,
                              0.99070334,
                              0.020185556,
                              0.018596789,
                              0.01895492,
                              0.027865632,
                              0.35190484,
                              0.036857165,
                              0.046580818,
                              0.041220278,
                              0.018995203,
                              0.022639247,
                              0.019066086]},
 'spectra_realpca': {'cosine': [0.9974984,
                                0.9975337,
                                0.997381,
                                0.9977518,
                                0.99749625,
                                0.9974665,
                                0.99747556,
                                0.9987605,
                                0.99793774,
                                0.9982931,
                                0.9989346,
                                0.999988,
                                0.9989679,
                                0.99913305,
                                0.9995079,
                                0.9997867,
                                0.9990574,
                                0.9992914,
                                0.9997365,
                                0.99928963,
                                0.9998295,
                                0.9999965,
                                0.999898,
                                0.9999981,
                                0.9999915,
                                0.9991923,
                                0.9988019,
                                0.99818444,
                                0.9982433,
                                0.9975009,
                                0.99999684,
                                0.9996793,
                                0.9999821],
                     'mae': [0.009417682,
                             0.00943431,
                             0.009719118,
                             0.00928917,
                             0.009485875,
                             0.0097743785,
                             0.0095539475,
                             0.0106405765,
                             0.010033954,
                             0.010035484,
                             0.008657412,
                             0.0016627628,
                             0.0087484745,
                             0.0085561825,
                             0.007945795,
                             0.0062895194,
                             0.008635291,
                             0.008401103,
                             0.006584082,
                             0.008415357,
                             0.005476343,
                             0.000734913,
                             0.0042795646,
                             0.00083263684,
                             0.0014913286,
                             0.008467521,
                             0.007982623,
                             0.010290919,
                             0.010248691,
                             0.009620459,
                             0.0009804774,
                             0.0074595655,
                             0.0019519264],
                     'max_mae': 0.0106405765,
                     'max_mse': 0.00019107551,
                     'max_rmse': 0.013823006,
                     'median_mae': 0.0085561825,
                     'min_cosine': 0.997381,
                     'mse': [0.00014186898,
                             0.00014189759,
                             0.00014902708,
                             0.0001388617,
                             0.00014410586,
                             0.00015409762,
                             0.00014601901,
                             0.00019107551,
                             0.00016131518,
                             0.00016057467,
                             0.00012086496,
                             4.4670937e-06,
                             0.00012283467,
                             0.00011810292,
                             0.0001012558,
                             6.3142994e-05,
                             0.000120528195,
                             0.00011404256,
                             7.01429e-05,
                             0.000115232244,
                             4.8668368e-05,
                             8.8455425e-07,
                             2.9550883e-05,
                             1.1203878e-06,
                             3.5709795e-06,
                             0.000115467265,
                             0.00012756647,
                             0.00017135176,
                             0.00017122513,
                             0.00014823639,
                             1.550296e-06,
                             8.9953515e-05,
                             6.0865264e-06],
                     'rmse': [0.011910876,
                              0.011912078,
                              0.012207665,
                              0.011783959,
                              0.01200441,
                              0.012413606,
                              0.012083832,
                              0.013823006,
                              0.012700992,
                              0.012671806,
                              0.010993861,
                              0.00211355,
                              0.01108308,
                              0.0108675165,
                              0.010062594,
                              0.007946257,
                              0.010978533,
                              0.010679071,
                              0.008375136,
                              0.010734628,
                              0.006976272,
                              0.00094050745,
                              0.0054360726,
                              0.0010584837,
                              0.0018897036,
                              0.010745569,
                              0.011294533,
                              0.013090139,
                              0.013085302,
                              0.012175237,
                              0.0012451088,
                              0.009484382,
                              0.0024670886]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_55.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521
Directory path: experiments/inpainting/gann_4_night_20180904_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_55.0/images
Optimal number of principal components:  22
Reconstruction error:  10.991643
Energy conservation:  0.55050445
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_55.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9519870688369956, 1.55485022826766],
                   'kl_div': 1.8006767,
                   'ks_tests': {10000: KstestResult(statistic=0.4376, pvalue=0.0, statistic_location=0.0022117803, statistic_sign=1),
                                20000: KstestResult(statistic=0.4386000000000001, pvalue=0.0, statistic_location=0.0022831839, statistic_sign=1),
                                30000: KstestResult(statistic=0.4436, pvalue=0.0, statistic_location=0.0023373594, statistic_sign=1),
                                40000: KstestResult(statistic=0.437975, pvalue=0.0, statistic_location=0.0023092255, statistic_sign=1),
                                50000: KstestResult(statistic=0.44045999999999996, pvalue=0.0, statistic_location=0.0022272917, statistic_sign=1),
                                60000: KstestResult(statistic=0.43676666666666664, pvalue=0.0, statistic_location=0.002285973, statistic_sign=1),
                                70000: KstestResult(statistic=0.44107142857142856, pvalue=0.0, statistic_location=0.0022813044, statistic_sign=1),
                                80000: KstestResult(statistic=0.43867500000000004, pvalue=0.0, statistic_location=0.0022055805, statistic_sign=1),
                                90000: KstestResult(statistic=0.4406333333333333, pvalue=0.0, statistic_location=0.0022308724, statistic_sign=1),
                                100000: KstestResult(statistic=0.43734000000000006, pvalue=0.0, statistic_location=0.002313371, statistic_sign=1),
                                110000: KstestResult(statistic=0.44179999999999997, pvalue=0.0, statistic_location=0.0023836233, statistic_sign=1)},
                   'moments': {'mean_error': 1.1193277,
                               'means': [0.00041185232, -1.3546696e-05],
                               'stds': [0.018056862, 0.0011902646],
                               'variance_ratio': 230.5207}},
 'originals': {'gan': {'mae': 0.015456689521670341,
                       'mse': 0.00040654480108059943,
                       'psnr': 33.4825325012207,
                       'rmse': 0.020162956789135933,
                       'ssim': 0.9744048714637756},
               'pca': {'mae': 0.0012620434863492846,
                       'mse': 3.6854830796073657e-06,
                       'psnr': 54.33505630493164,
                       'rmse': 0.0019197611836716533,
                       'ssim': 0.9998993277549744}},
 'reconstructions': {'mae': 0.01538114808499813,
                     'mse': 0.000402748555643484,
                     'psnr': 33.94965744018555,
                     'rmse': 0.020068597048521042,
                     'ssim': 0.9744901061058044},
 'residual_spectra_pcagan': {'cosine': [0.030401114,
                                        0.066735834,
                                        0.047334686,
                                        0.031826787,
                                        0.040955823,
                                        0.049120344,
                                        0.05976841,
                                        0.06699208,
                                        0.09010701,
                                        0.13477995,
                                        0.112943396],
                             'mae': [0.011259568,
                                     0.013105268,
                                     0.01217544,
                                     0.011819108,
                                     0.013397946,
                                     0.011480908,
                                     0.011090304,
                                     0.010472828,
                                     0.010571798,
                                     0.010292283,
                                     0.010663301],
                             'max_mae': 0.013397946,
                             'max_mse': 0.0005385758,
                             'max_rmse': 0.023207236,
                             'median_distance': 1.7294308,
                             'median_mae': 0.011259568,
                             'min_cosine': 0.030401114,
                             'mse': [0.00026680282,
                                     0.00048357144,
                                     0.00031771293,
                                     0.00029307697,
                                     0.0005385758,
                                     0.0003012855,
                                     0.00028464547,
                                     0.00025376264,
                                     0.0002990931,
                                     0.00023163154,
                                     0.00030125273],
                             'rmse': [0.0163341,
                                      0.021990258,
                                      0.017824503,
                                      0.017119491,
                                      0.023207236,
                                      0.017357579,
                                      0.01687144,
                                      0.01592993,
                                      0.017294308,
                                      0.015219446,
                                      0.017356634]},
 'residuals': {'mae': 0.011484432965517044,
               'mse': 0.00032467374694533646,
               'psnr': 0.01142710167914629,
               'rmse': 0.018018705770373344,
               'ssds': [35.88386, 0.15585907],
               'ssim': 0.29224300384521484},
 'spectra_pcagan': {'cosine': [0.99921435,
                               0.9991799,
                               0.99917096,
                               0.99960196,
                               0.9997209,
                               0.99956924,
                               0.99955803,
                               0.99923176,
                               0.9983966,
                               0.99860674,
                               0.9981752],
                    'mae': [0.016197447,
                            0.016111074,
                            0.016524909,
                            0.014082489,
                            0.013352449,
                            0.013898523,
                            0.013622202,
                            0.014607288,
                            0.017021518,
                            0.016818607,
                            0.016956119],
                    'max_mae': 0.017021518,
                    'max_mse': 0.00050998485,
                    'max_rmse': 0.022582844,
                    'median_mae': 0.016111074,
                    'min_cosine': 0.9981752,
                    'mse': [0.0004289196,
                            0.00046720897,
                            0.0004437934,
                            0.00031602505,
                            0.0003249717,
                            0.0003159838,
                            0.00030498276,
                            0.0003556326,
                            0.00050998485,
                            0.00046644188,
                            0.0004962896],
                    'rmse': [0.020710373,
                             0.021615017,
                             0.021066405,
                             0.017777093,
                             0.018026972,
                             0.017775934,
                             0.017463755,
                             0.018858224,
                             0.022582844,
                             0.021597266,
                             0.022277558]},
 'spectra_realgan': {'cosine': [0.99921274,
                                0.9991764,
                                0.99916804,
                                0.99960107,
                                0.99972034,
                                0.99956834,
                                0.9995564,
                                0.9992266,
                                0.9983752,
                                0.9985745,
                                0.9981254],
                     'mae': [0.0162344,
                             0.016154194,
                             0.016564593,
                             0.014099362,
                             0.013369933,
                             0.0139013035,
                             0.013646457,
                             0.014648861,
                             0.017152509,
                             0.01700348,
                             0.017248513],
                     'max_mae': 0.017248513,
                     'max_mse': 0.00051664555,
                     'max_rmse': 0.022729838,
                     'median_mae': 0.016154194,
                     'min_cosine': 0.9981254,
                     'mse': [0.00043039984,
                             0.0004692097,
                             0.0004453753,
                             0.00031670564,
                             0.0003255395,
                             0.00031647543,
                             0.00030632774,
                             0.00035817453,
                             0.00051664555,
                             0.00047744805,
                             0.0005096913],
                     'rmse': [0.02074608,
                              0.02166125,
                              0.021103917,
                              0.017796226,
                              0.018042713,
                              0.017789757,
                              0.01750222,
                              0.0189255,
                              0.022729838,
                              0.021850584,
                              0.022576343]},
 'spectra_realpca': {'cosine': [0.999998,
                                0.9999979,
                                0.9999968,
                                0.9999994,
                                0.9999997,
                                0.9999994,
                                0.99999875,
                                0.9999926,
                                0.99997824,
                                0.9999647,
                                0.99995065],
                     'mae': [0.00078844477,
                             0.0008629759,
                             0.0010254622,
                             0.00049342954,
                             0.000422405,
                             0.0005434548,
                             0.0007372323,
                             0.0014467888,
                             0.0020508245,
                             0.002645011,
                             0.0028664493],
                     'max_mae': 0.0028664493,
                     'max_mse': 1.3256387e-05,
                     'max_rmse': 0.0036409323,
                     'median_mae': 0.0008629759,
                     'min_cosine': 0.99995065,
                     'mse': [9.937802e-07,
                             1.2021951e-06,
                             1.6923826e-06,
                             3.9434963e-07,
                             2.8794295e-07,
                             4.7546388e-07,
                             8.775788e-07,
                             3.3648628e-06,
                             6.7484034e-06,
                             1.1246967e-05,
                             1.3256387e-05],
                     'rmse': [0.0009968852,
                              0.0010964465,
                              0.0013009161,
                              0.00062797265,
                              0.00053660315,
                              0.0006895389,
                              0.00093679177,
                              0.0018343562,
                              0.002597769,
                              0.0033536498,
                              0.0036409323]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_55.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743
Directory path: experiments/inpainting/gann_4_night_20180904_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_55.0/images
Optimal number of principal components:  22
Reconstruction error:  10.991643
Energy conservation:  0.55050445
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_55.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9538435048012626, 2.151565125505239],
                   'kl_div': 1.2072681,
                   'ks_tests': {10000: KstestResult(statistic=0.3221, pvalue=1e-323, statistic_location=0.002603692, statistic_sign=1),
                                20000: KstestResult(statistic=0.3282999999999999, pvalue=0.0, statistic_location=0.00251087, statistic_sign=1),
                                30000: KstestResult(statistic=0.3216333333333333, pvalue=0.0, statistic_location=0.00244774, statistic_sign=1),
                                40000: KstestResult(statistic=0.322125, pvalue=0.0, statistic_location=0.0025641676, statistic_sign=1),
                                50000: KstestResult(statistic=0.32736, pvalue=0.0, statistic_location=0.0024588334, statistic_sign=1),
                                60000: KstestResult(statistic=0.3285166666666667, pvalue=0.0, statistic_location=0.0025531033, statistic_sign=1),
                                70000: KstestResult(statistic=0.3274285714285714, pvalue=0.0, statistic_location=0.0023872391, statistic_sign=1),
                                80000: KstestResult(statistic=0.32781250000000006, pvalue=0.0, statistic_location=0.002482968, statistic_sign=1),
                                90000: KstestResult(statistic=0.32556666666666667, pvalue=0.0, statistic_location=0.002474891, statistic_sign=1),
                                100000: KstestResult(statistic=0.3260700000000001, pvalue=0.0, statistic_location=0.002476018, statistic_sign=1),
                                110000: KstestResult(statistic=0.32784545454545455, pvalue=0.0, statistic_location=0.0024820762, statistic_sign=1),
                                120000: KstestResult(statistic=0.3268833333333334, pvalue=0.0, statistic_location=0.0025033974, statistic_sign=1),
                                130000: KstestResult(statistic=0.32761538461538464, pvalue=0.0, statistic_location=0.0025570071, statistic_sign=1),
                                140000: KstestResult(statistic=0.3269357142857142, pvalue=0.0, statistic_location=0.0025948584, statistic_sign=1),
                                150000: KstestResult(statistic=0.3247333333333333, pvalue=0.0, statistic_location=0.002458714, statistic_sign=1),
                                160000: KstestResult(statistic=0.32751874999999997, pvalue=0.0, statistic_location=0.0026172963, statistic_sign=1),
                                170000: KstestResult(statistic=0.32623529411764707, pvalue=0.0, statistic_location=0.0023981775, statistic_sign=1),
                                180000: KstestResult(statistic=0.3256444444444444, pvalue=0.0, statistic_location=0.0025608956, statistic_sign=1),
                                190000: KstestResult(statistic=0.3258, pvalue=0.0, statistic_location=0.0026306738, statistic_sign=1),
                                200000: KstestResult(statistic=0.32728500000000005, pvalue=0.0, statistic_location=0.0023981775, statistic_sign=1),
                                210000: KstestResult(statistic=0.3260857142857143, pvalue=0.0, statistic_location=0.0024806936, statistic_sign=1),
                                220000: KstestResult(statistic=0.3270590909090909, pvalue=0.0, statistic_location=0.0024823193, statistic_sign=1)},
                   'moments': {'mean_error': 0.07362634,
                               'means': [-0.00020164356, -1.8060684e-05],
                               'stds': [0.016210506, 0.002881981],
                               'variance_ratio': 34.584232}},
 'originals': {'gan': {'mae': 0.02280293218791485,
                       'mse': 0.001267868559807539,
                       'psnr': 29.031415939331055,
                       'rmse': 0.03560714051127434,
                       'ssim': 0.9156925082206726},
               'pca': {'mae': 0.003197010839357972,
                       'mse': 3.6559049476636574e-05,
                       'psnr': 44.68028259277344,
                       'rmse': 0.0060464078560471535,
                       'ssim': 0.9992527961730957}},
 'reconstructions': {'mae': 0.022275259718298912,
                     'mse': 0.001232463400810957,
                     'psnr': 29.402494430541992,
                     'rmse': 0.03510645776987076,
                     'ssim': 0.9159579873085022},
 'residual_spectra_pcagan': {'cosine': [0.06835514,
                                        0.0889206,
                                        0.0482394,
                                        0.030445363,
                                        0.04852379,
                                        0.029949332,
                                        0.06876708,
                                        0.050802883,
                                        0.025520384,
                                        0.04260276,
                                        0.047222164,
                                        0.059814125,
                                        0.09042302,
                                        0.073121205,
                                        0.1407799,
                                        0.12212853,
                                        0.13995706,
                                        0.32766405,
                                        0.41446027,
                                        0.38027102,
                                        0.3151063,
                                        0.33751696],
                             'mae': [0.009626568,
                                     0.010171643,
                                     0.011292868,
                                     0.011754135,
                                     0.011284537,
                                     0.010611994,
                                     0.012166215,
                                     0.010795988,
                                     0.011548894,
                                     0.012148867,
                                     0.010556433,
                                     0.011247124,
                                     0.009799426,
                                     0.011194856,
                                     0.011913654,
                                     0.010613587,
                                     0.010178201,
                                     0.010034266,
                                     0.008282942,
                                     0.008324613,
                                     0.009791959,
                                     0.009044844],
                             'max_mae': 0.012166215,
                             'max_mse': 0.0003638082,
                             'max_rmse': 0.019073756,
                             'median_distance': 1.5752592,
                             'median_mae': 0.0106127905,
                             'min_cosine': 0.025520384,
                             'mse': [0.0001925651,
                                     0.00024510754,
                                     0.0003361117,
                                     0.00027178286,
                                     0.0002980614,
                                     0.00022119489,
                                     0.00035512005,
                                     0.00023285899,
                                     0.00026212627,
                                     0.00034518048,
                                     0.00023038036,
                                     0.00025119947,
                                     0.00018927571,
                                     0.0003638082,
                                     0.00028779643,
                                     0.00025197826,
                                     0.00021724257,
                                     0.00022470586,
                                     0.0001410417,
                                     0.00016007226,
                                     0.00030729064,
                                     0.00022557308],
                             'rmse': [0.013876783,
                                      0.01565591,
                                      0.01833335,
                                      0.016485838,
                                      0.017264456,
                                      0.014872622,
                                      0.018844629,
                                      0.015259718,
                                      0.016190315,
                                      0.018579034,
                                      0.015178286,
                                      0.015849274,
                                      0.013757751,
                                      0.019073756,
                                      0.016964564,
                                      0.015873823,
                                      0.014739151,
                                      0.014990192,
                                      0.011876098,
                                      0.012651967,
                                      0.017529707,
                                      0.015019091]},
 'residuals': {'mae': 0.010562893934547901,
               'mse': 0.00025502152857370675,
               'psnr': 11.456392288208008,
               'rmse': 0.015969393774867058,
               'ssds': [57.820404, 1.8273426],
               'ssim': 0.343676894903183},
 'spectra_pcagan': {'cosine': [0.998751,
                               0.99893355,
                               0.9988678,
                               0.99955565,
                               0.999023,
                               0.99928105,
                               0.999239,
                               0.99929434,
                               0.99960256,
                               0.9997599,
                               0.9996047,
                               0.9995238,
                               0.9992278,
                               0.99808013,
                               0.9976612,
                               0.9980334,
                               0.96670634,
                               0.99562913,
                               0.9862168,
                               0.989991,
                               0.99612343,
                               0.9913886],
                    'mae': [0.016676016,
                            0.017730463,
                            0.017053824,
                            0.013826616,
                            0.01671235,
                            0.015691957,
                            0.0156134395,
                            0.015693272,
                            0.013691427,
                            0.011827701,
                            0.01265775,
                            0.013908119,
                            0.015897732,
                            0.018163627,
                            0.02511852,
                            0.018460264,
                            0.12159228,
                            0.021468546,
                            0.028258877,
                            0.02079897,
                            0.017723888,
                            0.021490112],
                    'max_mae': 0.12159228,
                    'max_mse': 0.015734019,
                    'max_rmse': 0.12543532,
                    'median_mae': 0.016883086,
                    'min_cosine': 0.96670634,
                    'mse': [0.00045057107,
                            0.0005123231,
                            0.0005133644,
                            0.00031409736,
                            0.0004651895,
                            0.0003918967,
                            0.00042440268,
                            0.00039325908,
                            0.00030268577,
                            0.00023627939,
                            0.00027232652,
                            0.0003134606,
                            0.00041166606,
                            0.00060249213,
                            0.0009890046,
                            0.0005720632,
                            0.015734019,
                            0.00078524335,
                            0.0012002779,
                            0.00076454744,
                            0.0006605103,
                            0.00080451433],
                    'rmse': [0.02122666,
                             0.022634557,
                             0.022657545,
                             0.017722793,
                             0.021568252,
                             0.01979638,
                             0.020601036,
                             0.019830761,
                             0.017397868,
                             0.015371382,
                             0.016502319,
                             0.017704818,
                             0.020289555,
                             0.024545714,
                             0.031448442,
                             0.023917843,
                             0.12543532,
                             0.028022194,
                             0.03464503,
                             0.027650451,
                             0.025700396,
                             0.028363962]},
 'spectra_realgan': {'cosine': [0.9987398,
                                0.99892455,
                                0.99886286,
                                0.999555,
                                0.9990173,
                                0.9992794,
                                0.999236,
                                0.99929076,
                                0.99960214,
                                0.9997594,
                                0.9996036,
                                0.99952215,
                                0.99922085,
                                0.9980578,
                                0.99761367,
                                0.99797565,
                                0.9666653,
                                0.9949551,
                                0.9843034,
                                0.9879496,
                                0.995254,
                                0.9898634],
                     'mae': [0.016757865,
                             0.017770281,
                             0.017112328,
                             0.013835536,
                             0.016758204,
                             0.01572697,
                             0.01565142,
                             0.01573321,
                             0.013698511,
                             0.011841531,
                             0.012671553,
                             0.013935469,
                             0.015933512,
                             0.018292394,
                             0.02528453,
                             0.018783132,
                             0.121645994,
                             0.023065744,
                             0.029757421,
                             0.02332228,
                             0.020486938,
                             0.023599723],
                     'max_mae': 0.121645994,
                     'max_mse': 0.015762085,
                     'max_rmse': 0.12554714,
                     'median_mae': 0.016935267,
                     'min_cosine': 0.9666653,
                     'mse': [0.0004541996,
                             0.0005153361,
                             0.0005156354,
                             0.0003145,
                             0.00046750574,
                             0.0003932949,
                             0.00042607926,
                             0.00039521343,
                             0.00030301718,
                             0.00023685484,
                             0.00027310062,
                             0.00031457527,
                             0.0004139388,
                             0.00060945604,
                             0.0010027075,
                             0.00058761606,
                             0.015762085,
                             0.00089393166,
                             0.001350113,
                             0.0009196701,
                             0.0007951835,
                             0.0009490988],
                     'rmse': [0.02131196,
                              0.022701016,
                              0.022707608,
                              0.017734148,
                              0.021621881,
                              0.019831665,
                              0.020641688,
                              0.019879976,
                              0.01740739,
                              0.015390089,
                              0.016525757,
                              0.01773627,
                              0.020345487,
                              0.024687164,
                              0.031665556,
                              0.024240794,
                              0.12554714,
                              0.02989869,
                              0.036743883,
                              0.030326063,
                              0.028198998,
                              0.030807447]},
 'spectra_realpca': {'cosine': [0.9999883,
                                0.9999947,
                                0.9999952,
                                0.9999996,
                                0.999994,
                                0.999998,
                                0.9999979,
                                0.9999968,
                                0.9999994,
                                0.9999997,
                                0.9999994,
                                0.99999875,
                                0.9999926,
                                0.99997824,
                                0.9999647,
                                0.99995065,
                                0.9999332,
                                0.9993157,
                                0.9978809,
                                0.9977538,
                                0.99913144,
                                0.9983324],
                     'mae': [0.0015504936,
                             0.0011692372,
                             0.0011541566,
                             0.00040357685,
                             0.0012730774,
                             0.00078844477,
                             0.0008629759,
                             0.0010254622,
                             0.00049342954,
                             0.000422405,
                             0.0005434548,
                             0.0007372323,
                             0.0014467888,
                             0.0020508245,
                             0.002645011,
                             0.0028664493,
                             0.0032431236,
                             0.008336911,
                             0.010075749,
                             0.010285605,
                             0.009102783,
                             0.009857057],
                     'max_mae': 0.010285605,
                     'max_mse': 0.00016897684,
                     'max_rmse': 0.012999109,
                     'median_mae': 0.001359933,
                     'min_cosine': 0.9977538,
                     'mse': [3.8495295e-06,
                             2.1596318e-06,
                             2.1187063e-06,
                             2.6128566e-07,
                             2.5912273e-06,
                             9.937802e-07,
                             1.2021951e-06,
                             1.6923826e-06,
                             3.9434963e-07,
                             2.8794295e-07,
                             4.7546388e-07,
                             8.775788e-07,
                             3.3648628e-06,
                             6.7484034e-06,
                             1.1246967e-05,
                             1.3256387e-05,
                             1.7056182e-05,
                             0.000111286034,
                             0.00016448823,
                             0.00016897684,
                             0.00013419989,
                             0.00015677119],
                     'rmse': [0.0019620217,
                              0.0014695686,
                              0.0014555777,
                              0.0005111611,
                              0.0016097289,
                              0.0009968852,
                              0.0010964465,
                              0.0013009161,
                              0.00062797265,
                              0.00053660315,
                              0.0006895389,
                              0.00093679177,
                              0.0018343562,
                              0.002597769,
                              0.0033536498,
                              0.0036409323,
                              0.004129913,
                              0.010549219,
                              0.012825296,
                              0.012999109,
                              0.011584467,
                              0.01252083]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_55.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658
Directory path: experiments/inpainting/gann_4_night_20180904_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_55.0/images
Optimal number of principal components:  22
Reconstruction error:  10.991643
Energy conservation:  0.55050445
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_55.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9187742426194503, 2.4604476554372186],
                   'kl_div': 0.8887627,
                   'ks_tests': {10000: KstestResult(statistic=0.2949, pvalue=1e-323, statistic_location=0.0027442325, statistic_sign=1),
                                20000: KstestResult(statistic=0.28869999999999996, pvalue=0.0, statistic_location=0.003288846, statistic_sign=1),
                                30000: KstestResult(statistic=0.29103333333333337, pvalue=0.0, statistic_location=0.002559786, statistic_sign=1),
                                40000: KstestResult(statistic=0.2846000000000001, pvalue=0.0, statistic_location=0.003112902, statistic_sign=1),
                                50000: KstestResult(statistic=0.28752, pvalue=0.0, statistic_location=0.0025624093, statistic_sign=1),
                                60000: KstestResult(statistic=0.28546666666666665, pvalue=0.0, statistic_location=0.0025606093, statistic_sign=1),
                                70000: KstestResult(statistic=0.28835714285714287, pvalue=0.0, statistic_location=0.0031676884, statistic_sign=1),
                                80000: KstestResult(statistic=0.28598749999999995, pvalue=0.0, statistic_location=0.003031333, statistic_sign=1),
                                90000: KstestResult(statistic=0.28833333333333333, pvalue=0.0, statistic_location=0.00291641, statistic_sign=1),
                                100000: KstestResult(statistic=0.2877599999999999, pvalue=0.0, statistic_location=0.0027882182, statistic_sign=1),
                                110000: KstestResult(statistic=0.29056363636363636, pvalue=0.0, statistic_location=0.0028638076, statistic_sign=1),
                                120000: KstestResult(statistic=0.28646666666666665, pvalue=0.0, statistic_location=0.0029305979, statistic_sign=1),
                                130000: KstestResult(statistic=0.2879615384615384, pvalue=0.0, statistic_location=0.00291334, statistic_sign=1),
                                140000: KstestResult(statistic=0.2882071428571429, pvalue=0.0, statistic_location=0.003032506, statistic_sign=1),
                                150000: KstestResult(statistic=0.28888, pvalue=0.0, statistic_location=0.0028938248, statistic_sign=1),
                                160000: KstestResult(statistic=0.28490625, pvalue=0.0, statistic_location=0.0027017142, statistic_sign=1),
                                170000: KstestResult(statistic=0.2886882352941177, pvalue=0.0, statistic_location=0.0029122261, statistic_sign=1),
                                180000: KstestResult(statistic=0.28684444444444446, pvalue=0.0, statistic_location=0.0029146946, statistic_sign=1),
                                190000: KstestResult(statistic=0.28673157894736845, pvalue=0.0, statistic_location=0.0028554494, statistic_sign=1),
                                200000: KstestResult(statistic=0.28774999999999995, pvalue=0.0, statistic_location=0.0029333406, statistic_sign=1),
                                210000: KstestResult(statistic=0.2874523809523809, pvalue=0.0, statistic_location=0.0026311334, statistic_sign=1),
                                220000: KstestResult(statistic=0.2873636363636364, pvalue=0.0, statistic_location=0.0026928952, statistic_sign=1),
                                230000: KstestResult(statistic=0.2848521739130434, pvalue=0.0, statistic_location=0.0029128564, statistic_sign=1),
                                240000: KstestResult(statistic=0.2882625000000001, pvalue=0.0, statistic_location=0.0030083174, statistic_sign=1),
                                250000: KstestResult(statistic=0.2884, pvalue=0.0, statistic_location=0.0029081171, statistic_sign=1),
                                260000: KstestResult(statistic=0.28708846153846146, pvalue=0.0, statistic_location=0.0030355952, statistic_sign=1),
                                270000: KstestResult(statistic=0.28691851851851846, pvalue=0.0, statistic_location=0.0029146946, statistic_sign=1),
                                280000: KstestResult(statistic=0.28793928571428573, pvalue=0.0, statistic_location=0.0030310573, statistic_sign=1),
                                290000: KstestResult(statistic=0.28727931034482757, pvalue=0.0, statistic_location=0.0031437208, statistic_sign=1),
                                300000: KstestResult(statistic=0.28617000000000004, pvalue=0.0, statistic_location=0.0027767639, statistic_sign=1),
                                310000: KstestResult(statistic=0.2893709677419355, pvalue=0.0, statistic_location=0.002996014, statistic_sign=1),
                                320000: KstestResult(statistic=0.288578125, pvalue=0.0, statistic_location=0.0029137563, statistic_sign=1),
                                330000: KstestResult(statistic=0.28819696969696973, pvalue=0.0, statistic_location=0.0029137465, statistic_sign=1)},
                   'moments': {'mean_error': 0.18224569,
                               'means': [0.00036934364, -1.20024415e-05],
                               'stds': [0.015899327, 0.0036399176],
                               'variance_ratio': 16.461544}},
 'originals': {'gan': {'mae': 0.024682894349098206,
                       'mse': 0.001282358425669372,
                       'psnr': 30.239980697631836,
                       'rmse': 0.03581003099679947,
                       'ssim': 0.9119789004325867},
               'pca': {'mae': 0.004800671711564064,
                       'mse': 6.756947550456971e-05,
                       'psnr': 43.42303466796875,
                       'rmse': 0.008220065385103226,
                       'ssim': 0.9974955916404724}},
 'reconstructions': {'mae': 0.023911090567708015,
                     'mse': 0.0012134576682001352,
                     'psnr': 30.880292892456055,
                     'rmse': 0.03483472019433975,
                     'ssim': 0.9138369560241699},
 'residual_spectra_pcagan': {'cosine': [0.36684725,
                                        0.41748184,
                                        0.3768353,
                                        0.108518995,
                                        0.070397206,
                                        0.046422683,
                                        0.08509528,
                                        0.08642219,
                                        0.04946522,
                                        0.025742693,
                                        0.052149873,
                                        0.028413247,
                                        0.07029182,
                                        0.06599891,
                                        0.033202544,
                                        0.04125439,
                                        0.0438796,
                                        0.034516238,
                                        0.08779123,
                                        0.11164041,
                                        0.16130947,
                                        0.09241707,
                                        0.15327069,
                                        0.36924404,
                                        0.40169492,
                                        0.37344015,
                                        0.31940794,
                                        0.43483925,
                                        0.3577684,
                                        0.26059723,
                                        0.34263343,
                                        0.35021695,
                                        0.41759884],
                             'mae': [0.008681916,
                                     0.007983336,
                                     0.008217147,
                                     0.009730252,
                                     0.009362911,
                                     0.01113823,
                                     0.010545998,
                                     0.011414146,
                                     0.012310851,
                                     0.012601712,
                                     0.01099953,
                                     0.010999673,
                                     0.011470738,
                                     0.010204257,
                                     0.011367304,
                                     0.011462846,
                                     0.011438828,
                                     0.010740379,
                                     0.0093154125,
                                     0.00973042,
                                     0.008744115,
                                     0.012270242,
                                     0.009790811,
                                     0.009126391,
                                     0.008467601,
                                     0.008548845,
                                     0.009779765,
                                     0.007842721,
                                     0.009163604,
                                     0.010261989,
                                     0.009075305,
                                     0.009657529,
                                     0.007984555],
                             'max_mae': 0.012601712,
                             'max_mse': 0.00047127056,
                             'max_rmse': 0.021708766,
                             'median_distance': 1.4710923,
                             'median_mae': 0.009779765,
                             'min_cosine': 0.025742693,
                             'mse': [0.00020927993,
                                     0.00014707838,
                                     0.00018511448,
                                     0.00019717516,
                                     0.00016905363,
                                     0.0003087727,
                                     0.00021641128,
                                     0.0002955046,
                                     0.00047127056,
                                     0.00034885455,
                                     0.00028470103,
                                     0.00025771273,
                                     0.0002978215,
                                     0.00020186244,
                                     0.00026318664,
                                     0.00027575533,
                                     0.00029009342,
                                     0.0002331873,
                                     0.00016578125,
                                     0.0001839856,
                                     0.00014265999,
                                     0.00037635645,
                                     0.00019525987,
                                     0.00020714011,
                                     0.00015823332,
                                     0.00017580307,
                                     0.00030815523,
                                     0.0001450263,
                                     0.00022198408,
                                     0.00038935707,
                                     0.00023630247,
                                     0.00020756642,
                                     0.00014522784],
                             'rmse': [0.01446651,
                                      0.012127588,
                                      0.013605678,
                                      0.014041907,
                                      0.013002062,
                                      0.01757193,
                                      0.014710924,
                                      0.017190248,
                                      0.021708766,
                                      0.018677648,
                                      0.016873086,
                                      0.016053434,
                                      0.017257506,
                                      0.01420783,
                                      0.016223028,
                                      0.016605882,
                                      0.01703213,
                                      0.015270472,
                                      0.012875607,
                                      0.013564129,
                                      0.011944036,
                                      0.01939991,
                                      0.013973542,
                                      0.014392363,
                                      0.0125790825,
                                      0.013259075,
                                      0.01755435,
                                      0.012042686,
                                      0.01489913,
                                      0.019732133,
                                      0.015372133,
                                      0.014407165,
                                      0.0120510515]},
 'residuals': {'mae': 0.01001301221549511,
               'mse': 0.00023974770738277584,
               'psnr': 12.42313289642334,
               'rmse': 0.015483788214623928,
               'ssds': [83.46498, 4.372204],
               'ssim': 0.39096155762672424},
 'spectra_pcagan': {'cosine': [0.98405176,
                               0.98673713,
                               0.98385876,
                               0.9987132,
                               0.99877256,
                               0.998701,
                               0.9982912,
                               0.99868226,
                               0.9983894,
                               0.99947137,
                               0.9990627,
                               0.9991594,
                               0.9993206,
                               0.99926114,
                               0.9995954,
                               0.99976367,
                               0.99956036,
                               0.99957836,
                               0.99922806,
                               0.9984997,
                               0.9987071,
                               0.99777484,
                               0.9670364,
                               0.9962241,
                               0.9860299,
                               0.98297966,
                               0.9949473,
                               0.9907271,
                               0.97731787,
                               0.97943014,
                               0.9888431,
                               0.9855896,
                               0.98439234],
                    'mae': [0.027504183,
                            0.024792692,
                            0.025733728,
                            0.016557809,
                            0.017319702,
                            0.017909333,
                            0.023120426,
                            0.01758225,
                            0.020258134,
                            0.014702938,
                            0.016844526,
                            0.01642339,
                            0.015102815,
                            0.015383307,
                            0.013855719,
                            0.0120588085,
                            0.01356219,
                            0.01315354,
                            0.015734257,
                            0.017186912,
                            0.015926862,
                            0.02093784,
                            0.118948475,
                            0.018385367,
                            0.027374655,
                            0.029682642,
                            0.02046702,
                            0.025625534,
                            0.0407587,
                            0.037616536,
                            0.022729844,
                            0.02751623,
                            0.028309591],
                    'max_mae': 0.118948475,
                    'max_mse': 0.015190541,
                    'max_rmse': 0.12324991,
                    'median_mae': 0.018385367,
                    'min_cosine': 0.9670364,
                    'mse': [0.0012337222,
                            0.0010161513,
                            0.0011072506,
                            0.00046254502,
                            0.00047928657,
                            0.0005559513,
                            0.0007997345,
                            0.00053943606,
                            0.00076677557,
                            0.00038373334,
                            0.0004744153,
                            0.00043734632,
                            0.0003904221,
                            0.00039565418,
                            0.00030820936,
                            0.00024309197,
                            0.00030687996,
                            0.00027710656,
                            0.00040706102,
                            0.00048125887,
                            0.00041192383,
                            0.0007578864,
                            0.015190541,
                            0.00061238033,
                            0.0011184674,
                            0.0012940166,
                            0.0007792454,
                            0.0009857662,
                            0.0022463843,
                            0.0023304196,
                            0.00090366945,
                            0.0011417457,
                            0.0012056346],
                    'rmse': [0.03512438,
                             0.031877127,
                             0.033275373,
                             0.02150686,
                             0.021892615,
                             0.02357862,
                             0.028279576,
                             0.023225764,
                             0.027690712,
                             0.019589113,
                             0.021781078,
                             0.020912826,
                             0.019759102,
                             0.019891057,
                             0.017555892,
                             0.015591407,
                             0.01751799,
                             0.016646517,
                             0.020175753,
                             0.021937612,
                             0.020295907,
                             0.027529737,
                             0.12324991,
                             0.02474632,
                             0.033443496,
                             0.035972442,
                             0.027914967,
                             0.031396914,
                             0.047396038,
                             0.04827442,
                             0.030061096,
                             0.033789728,
                             0.03472225]},
 'spectra_realgan': {'cosine': [0.9814151,
                                0.9843953,
                                0.98137957,
                                0.9986943,
                                0.998765,
                                0.9986951,
                                0.9982768,
                                0.99867433,
                                0.998383,
                                0.99947095,
                                0.99905765,
                                0.9991577,
                                0.99931717,
                                0.99925745,
                                0.99959457,
                                0.99976313,
                                0.9995594,
                                0.99957687,
                                0.9992216,
                                0.99847776,
                                0.998674,
                                0.99772626,
                                0.96699667,
                                0.99548423,
                                0.9839885,
                                0.9808992,
                                0.99406844,
                                0.9890083,
                                0.9749159,
                                0.9770477,
                                0.9866501,
                                0.9837127,
                                0.9820825],
                     'mae': [0.029627789,
                             0.027001632,
                             0.027749378,
                             0.016724551,
                             0.017360544,
                             0.017963506,
                             0.023197964,
                             0.017638387,
                             0.020329002,
                             0.0147155505,
                             0.016875483,
                             0.016448867,
                             0.015146317,
                             0.015429215,
                             0.0138676455,
                             0.0120758405,
                             0.013570564,
                             0.013181763,
                             0.015766531,
                             0.017302673,
                             0.016132116,
                             0.021171836,
                             0.119011484,
                             0.020583889,
                             0.029042676,
                             0.031274352,
                             0.022661095,
                             0.027384646,
                             0.04174247,
                             0.039284356,
                             0.025127416,
                             0.02908064,
                             0.03006539],
                     'max_mae': 0.119011484,
                     'max_mse': 0.01521791,
                     'max_rmse': 0.123360895,
                     'median_mae': 0.020329002,
                     'min_cosine': 0.96699667,
                     'mse': [0.0014243682,
                             0.001191624,
                             0.001281371,
                             0.00046998626,
                             0.0004824965,
                             0.000558325,
                             0.000804494,
                             0.0005424986,
                             0.00076976063,
                             0.0003841611,
                             0.00047641053,
                             0.00043855715,
                             0.00039240968,
                             0.0003976388,
                             0.00030880672,
                             0.00024362636,
                             0.0003075674,
                             0.00027811585,
                             0.00040909872,
                             0.00048805523,
                             0.00042267505,
                             0.00077095063,
                             0.01521791,
                             0.0007337112,
                             0.0012791012,
                             0.001453202,
                             0.00091568584,
                             0.0011495127,
                             0.0024375678,
                             0.0025421302,
                             0.0010732422,
                             0.0012942661,
                             0.0013784932],
                     'rmse': [0.037740804,
                              0.034519907,
                              0.035796244,
                              0.021679167,
                              0.021965804,
                              0.023628902,
                              0.028363604,
                              0.023291599,
                              0.02774456,
                              0.019600028,
                              0.02182683,
                              0.020941757,
                              0.019809334,
                              0.019940883,
                              0.017572897,
                              0.015608535,
                              0.0175376,
                              0.016676806,
                              0.02022619,
                              0.022091972,
                              0.020559063,
                              0.027765999,
                              0.123360895,
                              0.027087104,
                              0.035764527,
                              0.03812089,
                              0.030260302,
                              0.033904463,
                              0.04937173,
                              0.050419543,
                              0.032760374,
                              0.03597591,
                              0.037128065]},
 'spectra_realpca': {'cosine': [0.9974736,
                                0.99771124,
                                0.9973466,
                                0.99998635,
                                0.99999243,
                                0.9999957,
                                0.9999883,
                                0.9999947,
                                0.9999952,
                                0.9999996,
                                0.999994,
                                0.999998,
                                0.9999979,
                                0.9999968,
                                0.9999994,
                                0.9999997,
                                0.9999994,
                                0.99999875,
                                0.9999926,
                                0.99997824,
                                0.9999647,
                                0.99995065,
                                0.9999332,
                                0.9993157,
                                0.9978809,
                                0.9977538,
                                0.99913144,
                                0.9983324,
                                0.9977092,
                                0.9976534,
                                0.99782395,
                                0.9979078,
                                0.99766535],
                     'mae': [0.010625599,
                             0.010198998,
                             0.010769402,
                             0.0016813418,
                             0.0012885311,
                             0.0010379493,
                             0.0015504936,
                             0.0011692372,
                             0.0011541566,
                             0.00040357685,
                             0.0012730774,
                             0.00078844477,
                             0.0008629759,
                             0.0010254622,
                             0.00049342954,
                             0.000422405,
                             0.0005434548,
                             0.0007372323,
                             0.0014467888,
                             0.0020508245,
                             0.002645011,
                             0.0028664493,
                             0.0032431236,
                             0.008336911,
                             0.010075749,
                             0.010285605,
                             0.009102783,
                             0.009857057,
                             0.010380163,
                             0.011213521,
                             0.010281349,
                             0.010256317,
                             0.010354739],
                     'max_mae': 0.011213521,
                     'max_mse': 0.00020165842,
                     'max_rmse': 0.014200648,
                     'median_mae': 0.0020508245,
                     'min_cosine': 0.9973466,
                     'mse': [0.0001803697,
                             0.00016896063,
                             0.00018405967,
                             4.5408115e-06,
                             2.6619339e-06,
                             1.7261617e-06,
                             3.8495295e-06,
                             2.1596318e-06,
                             2.1187063e-06,
                             2.6128566e-07,
                             2.5912273e-06,
                             9.937802e-07,
                             1.2021951e-06,
                             1.6923826e-06,
                             3.9434963e-07,
                             2.8794295e-07,
                             4.7546388e-07,
                             8.775788e-07,
                             3.3648628e-06,
                             6.7484034e-06,
                             1.1246967e-05,
                             1.3256387e-05,
                             1.7056182e-05,
                             0.000111286034,
                             0.00016448823,
                             0.00016897684,
                             0.00013419989,
                             0.00015677119,
                             0.0001728683,
                             0.00020165842,
                             0.00016973678,
                             0.00016720056,
                             0.0001717104],
                     'rmse': [0.013430178,
                              0.012998486,
                              0.013566859,
                              0.002130918,
                              0.0016315434,
                              0.0013138347,
                              0.0019620217,
                              0.0014695686,
                              0.0014555777,
                              0.0005111611,
                              0.0016097289,
                              0.0009968852,
                              0.0010964465,
                              0.0013009161,
                              0.00062797265,
                              0.00053660315,
                              0.0006895389,
                              0.00093679177,
                              0.0018343562,
                              0.002597769,
                              0.0033536498,
                              0.0036409323,
                              0.004129913,
                              0.010549219,
                              0.012825296,
                              0.012999109,
                              0.011584467,
                              0.01252083,
                              0.013147939,
                              0.014200648,
                              0.013028307,
                              0.012930606,
                              0.013103832]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_55.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734
Directory path: experiments/inpainting/gann_4_night_20210905_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_55.0/images
Optimal number of principal components:  25
Reconstruction error:  7.652385
Energy conservation:  0.5642458
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_55.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.8998554886731998, 2.7421112428408754],
                   'kl_div': 0.601315,
                   'ks_tests': {10000: KstestResult(statistic=0.2542, pvalue=3.81479491631945e-284, statistic_location=-0.0056510884, statistic_sign=-1),
                                20000: KstestResult(statistic=0.24950000000000003, pvalue=0.0, statistic_location=-0.005002613, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2454333333333333, pvalue=0.0, statistic_location=-0.005178554, statistic_sign=-1),
                                40000: KstestResult(statistic=0.24230000000000002, pvalue=0.0, statistic_location=-0.0050208643, statistic_sign=-1),
                                50000: KstestResult(statistic=0.24588, pvalue=0.0, statistic_location=-0.0050027203, statistic_sign=-1),
                                60000: KstestResult(statistic=0.2450166666666667, pvalue=0.0, statistic_location=-0.0049672667, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2446714285714286, pvalue=0.0, statistic_location=-0.0051741563, statistic_sign=-1),
                                80000: KstestResult(statistic=0.24546250000000003, pvalue=0.0, statistic_location=-0.0049718656, statistic_sign=-1),
                                90000: KstestResult(statistic=0.24946666666666664, pvalue=0.0, statistic_location=-0.0050293, statistic_sign=-1),
                                100000: KstestResult(statistic=0.24689, pvalue=0.0, statistic_location=-0.005052818, statistic_sign=-1),
                                110000: KstestResult(statistic=0.24404545454545454, pvalue=0.0, statistic_location=-0.0049944133, statistic_sign=-1)},
                   'moments': {'mean_error': -0.2960647,
                               'means': [-0.0013864677, 6.586324e-07],
                               'stds': [0.016771028, 0.0039454657],
                               'variance_ratio': 12.489852}},
 'originals': {'gan': {'mae': 0.023048721253871918,
                       'mse': 0.0009046081686392426,
                       'psnr': 30.321165084838867,
                       'rmse': 0.030076704919338226,
                       'ssim': 0.9525943994522095},
               'pca': {'mae': 0.006321675144135952,
                       'mse': 7.90270569268614e-05,
                       'psnr': 41.38100814819336,
                       'rmse': 0.008889716118574142,
                       'ssim': 0.9952012300491333}},
 'reconstructions': {'mae': 0.021935539320111275,
                     'mse': 0.0008266061777248979,
                     'psnr': 31.185779571533203,
                     'rmse': 0.028750760480761528,
                     'ssim': 0.9569728970527649},
 'residual_spectra_pcagan': {'cosine': [0.08354172,
                                        0.0663645,
                                        0.07431881,
                                        0.25383425,
                                        0.23850703,
                                        0.23941933,
                                        0.26600623,
                                        0.3230365,
                                        0.25585783,
                                        0.2984313,
                                        0.26527628],
                             'mae': [0.010559262,
                                     0.011897297,
                                     0.010119491,
                                     0.010615086,
                                     0.010429674,
                                     0.009366039,
                                     0.009934715,
                                     0.008369981,
                                     0.009394074,
                                     0.010254765,
                                     0.010295305],
                             'max_mae': 0.011897297,
                             'max_mse': 0.00038429335,
                             'max_rmse': 0.019603401,
                             'median_distance': 1.6184855,
                             'median_mae': 0.010254765,
                             'min_cosine': 0.0663645,
                             'mse': [0.00023246507,
                                     0.00037782968,
                                     0.00023531265,
                                     0.00026279053,
                                     0.00038429335,
                                     0.00026194955,
                                     0.0002306067,
                                     0.00015673754,
                                     0.00029065387,
                                     0.0002398786,
                                     0.00028081503],
                             'rmse': [0.015246805,
                                      0.019437842,
                                      0.0153399035,
                                      0.016210815,
                                      0.019603401,
                                      0.016184855,
                                      0.01518574,
                                      0.012519486,
                                      0.017048573,
                                      0.015488015,
                                      0.016757537]},
 'residuals': {'mae': 0.010112335905432701,
               'mse': 0.000268484785920009,
               'psnr': 8.467695236206055,
               'rmse': 0.016385504975914955,
               'ssds': [31.150585, 1.7123214],
               'ssim': 0.3574071526527405},
 'spectra_pcagan': {'cosine': [0.99846673,
                               0.9986634,
                               0.99809194,
                               0.99586797,
                               0.9947902,
                               0.9962866,
                               0.9850354,
                               0.9856448,
                               0.9872237,
                               0.9882864,
                               0.98967654],
                    'mae': [0.01771564,
                            0.017523764,
                            0.0175825,
                            0.023669323,
                            0.022410769,
                            0.018667521,
                            0.026284028,
                            0.02573087,
                            0.023271622,
                            0.023324085,
                            0.02511081],
                    'max_mae': 0.026284028,
                    'max_mse': 0.0011263969,
                    'max_rmse': 0.033561837,
                    'median_mae': 0.023271622,
                    'min_cosine': 0.9850354,
                    'mse': [0.0005241982,
                            0.0005359602,
                            0.00051376474,
                            0.0009221965,
                            0.0008398974,
                            0.0006510752,
                            0.0011263969,
                            0.0010430258,
                            0.0009501137,
                            0.0009436365,
                            0.0010424034],
                    'rmse': [0.022895375,
                             0.023150815,
                             0.02266638,
                             0.030367687,
                             0.028980983,
                             0.025516175,
                             0.033561837,
                             0.03229591,
                             0.030823914,
                             0.030718667,
                             0.03228627]},
 'spectra_realgan': {'cosine': [0.99845815,
                                0.99865544,
                                0.9980743,
                                0.99538624,
                                0.9942768,
                                0.9958385,
                                0.9834681,
                                0.9838169,
                                0.9854402,
                                0.98703146,
                                0.9884645],
                     'mae': [0.017761227,
                             0.017582031,
                             0.0176733,
                             0.024944736,
                             0.023610482,
                             0.020209933,
                             0.027730133,
                             0.027510053,
                             0.02518444,
                             0.024926346,
                             0.02640324],
                     'max_mae': 0.027730133,
                     'max_mse': 0.0012458147,
                     'max_rmse': 0.0352961,
                     'median_mae': 0.024926346,
                     'min_cosine': 0.9834681,
                     'mse': [0.00052664767,
                             0.000539212,
                             0.00051849784,
                             0.001009169,
                             0.0009227619,
                             0.00072644174,
                             0.0012458147,
                             0.0011789299,
                             0.0010824356,
                             0.0010481058,
                             0.0011526741],
                     'rmse': [0.022948805,
                              0.02322094,
                              0.022770548,
                              0.03176742,
                              0.030376997,
                              0.026952583,
                              0.0352961,
                              0.03433555,
                              0.03290039,
                              0.03237446,
                              0.033951055]},
 'spectra_realpca': {'cosine': [0.999989,
                                0.99999326,
                                0.9999866,
                                0.9995749,
                                0.9994848,
                                0.99951196,
                                0.9982844,
                                0.9982231,
                                0.99827164,
                                0.9985133,
                                0.9987211],
                     'mae': [0.0015149367,
                             0.0012944982,
                             0.0015015544,
                             0.0067861513,
                             0.007204044,
                             0.0070885294,
                             0.00903815,
                             0.009006072,
                             0.00892873,
                             0.008660964,
                             0.008514802],
                     'max_mae': 0.00903815,
                     'max_mse': 0.00013036083,
                     'max_rmse': 0.011417567,
                     'median_mae': 0.007204044,
                     'min_cosine': 0.9982231,
                     'mse': [3.6589142e-06,
                             2.6835821e-06,
                             3.602588e-06,
                             7.387273e-05,
                             8.268084e-05,
                             8.0665726e-05,
                             0.00013011997,
                             0.00013036083,
                             0.00012741465,
                             0.000118846,
                             0.00011539166],
                     'rmse': [0.0019128289,
                              0.0016381643,
                              0.0018980484,
                              0.008594925,
                              0.009092901,
                              0.00898141,
                              0.011407014,
                              0.011417567,
                              0.011287809,
                              0.010901651,
                              0.010742051]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_55.0

Running comparison for experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726
Directory path: experiments/inpainting/gann_4_night_20210905_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_55.0/images
Optimal number of principal components:  25
Reconstruction error:  7.652385
Energy conservation:  0.5642458
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_55.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9022391383209563, 2.7330554276672814],
                   'kl_div': 0.6005905,
                   'ks_tests': {10000: KstestResult(statistic=0.258, pvalue=8.640619513491106e-293, statistic_location=-0.004540805, statistic_sign=-1),
                                20000: KstestResult(statistic=0.24995, pvalue=0.0, statistic_location=-0.004386076, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2527666666666667, pvalue=0.0, statistic_location=-0.004730216, statistic_sign=-1),
                                40000: KstestResult(statistic=0.255775, pvalue=0.0, statistic_location=-0.0045314124, statistic_sign=-1),
                                50000: KstestResult(statistic=0.26118, pvalue=0.0, statistic_location=-0.004554046, statistic_sign=-1),
                                60000: KstestResult(statistic=0.2542, pvalue=0.0, statistic_location=-0.004696125, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2524857142857143, pvalue=0.0, statistic_location=-0.0044794297, statistic_sign=-1),
                                80000: KstestResult(statistic=0.25417500000000004, pvalue=0.0, statistic_location=-0.005198693, statistic_sign=-1),
                                90000: KstestResult(statistic=0.25335555555555556, pvalue=0.0, statistic_location=-0.0049726507, statistic_sign=-1),
                                100000: KstestResult(statistic=0.25607, pvalue=0.0, statistic_location=-0.004801566, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2575727272727273, pvalue=0.0, statistic_location=-0.0048281197, statistic_sign=-1),
                                120000: KstestResult(statistic=0.25525, pvalue=0.0, statistic_location=-0.0052272202, statistic_sign=-1),
                                130000: KstestResult(statistic=0.2536615384615385, pvalue=0.0, statistic_location=-0.0049684504, statistic_sign=-1),
                                140000: KstestResult(statistic=0.25784285714285715, pvalue=0.0, statistic_location=-0.0051787198, statistic_sign=-1),
                                150000: KstestResult(statistic=0.2561133333333333, pvalue=0.0, statistic_location=-0.004975084, statistic_sign=-1),
                                160000: KstestResult(statistic=0.2555875, pvalue=0.0, statistic_location=-0.004785467, statistic_sign=-1),
                                170000: KstestResult(statistic=0.25470588235294117, pvalue=0.0, statistic_location=-0.0047964887, statistic_sign=-1),
                                180000: KstestResult(statistic=0.25303333333333333, pvalue=0.0, statistic_location=-0.00487411, statistic_sign=-1),
                                190000: KstestResult(statistic=0.2549578947368421, pvalue=0.0, statistic_location=-0.004761926, statistic_sign=-1),
                                200000: KstestResult(statistic=0.25516, pvalue=0.0, statistic_location=-0.0048362673, statistic_sign=-1),
                                210000: KstestResult(statistic=0.25502380952380954, pvalue=0.0, statistic_location=-0.004797171, statistic_sign=-1),
                                220000: KstestResult(statistic=0.25538636363636363, pvalue=0.0, statistic_location=-0.004848916, statistic_sign=-1)},
                   'moments': {'mean_error': -0.29610336,
                               'means': [-0.0014589109, 8.929954e-06],
                               'stds': [0.01597184, 0.0039205216],
                               'variance_ratio': 12.229702}},
 'originals': {'gan': {'mae': 0.029288172721862793,
                       'mse': 0.001597895403392613,
                       'psnr': 30.15612030029297,
                       'rmse': 0.03997368365526199,
                       'ssim': 0.8410302996635437},
               'pca': {'mae': 0.0067116692662239075,
                       'mse': 9.063312609214336e-05,
                       'psnr': 42.657833099365234,
                       'rmse': 0.009520143270492554,
                       'ssim': 0.991543173789978}},
 'reconstructions': {'mae': 0.028171733021736145,
                     'mse': 0.0015083933249115944,
                     'psnr': 30.445556640625,
                     'rmse': 0.038838040083646774,
                     'ssim': 0.8445849418640137},
 'residual_spectra_pcagan': {'cosine': [0.32599753,
                                        0.2510981,
                                        0.0483028,
                                        0.06926998,
                                        0.072766185,
                                        0.08150186,
                                        0.07118995,
                                        0.08162799,
                                        0.27021956,
                                        0.2550362,
                                        0.28078654,
                                        0.30329153,
                                        0.3650665,
                                        0.26714352,
                                        0.29989037,
                                        0.28462198,
                                        0.27891445,
                                        0.2707858,
                                        0.32389566,
                                        0.3211658,
                                        0.25428137,
                                        0.239562],
                             'mae': [0.009441226,
                                     0.009287886,
                                     0.011732661,
                                     0.01266927,
                                     0.011120608,
                                     0.009923967,
                                     0.011289793,
                                     0.009602332,
                                     0.010193856,
                                     0.010284802,
                                     0.008683556,
                                     0.009258698,
                                     0.0078095603,
                                     0.009224304,
                                     0.010250419,
                                     0.009827437,
                                     0.008417851,
                                     0.010381722,
                                     0.008513207,
                                     0.008717788,
                                     0.010153502,
                                     0.010932112],
                             'max_mae': 0.01266927,
                             'max_mse': 0.00040806155,
                             'max_rmse': 0.020200534,
                             'median_distance': 1.5625429,
                             'median_mae': 0.009875702,
                             'min_cosine': 0.0483028,
                             'mse': [0.00019532659,
                                     0.00024578953,
                                     0.00040806155,
                                     0.00031400772,
                                     0.00029110088,
                                     0.00019821686,
                                     0.00032114456,
                                     0.00019455273,
                                     0.00023113847,
                                     0.00032747246,
                                     0.0002002389,
                                     0.00017366586,
                                     0.00012256531,
                                     0.00026141497,
                                     0.00024252405,
                                     0.00024615426,
                                     0.00021086584,
                                     0.00024658145,
                                     0.00015023253,
                                     0.00017703124,
                                     0.0003078855,
                                     0.00027329093],
                             'rmse': [0.013975929,
                                      0.015677676,
                                      0.020200534,
                                      0.017720263,
                                      0.017061679,
                                      0.014078951,
                                      0.017920507,
                                      0.013948216,
                                      0.015203239,
                                      0.0180962,
                                      0.014150579,
                                      0.013178234,
                                      0.011070922,
                                      0.016168332,
                                      0.015573184,
                                      0.015689304,
                                      0.014521221,
                                      0.015702913,
                                      0.012256938,
                                      0.013305308,
                                      0.017546667,
                                      0.016531514]},
 'residuals': {'mae': 0.00989620666950941,
               'mse': 0.0002426937426207587,
               'psnr': 15.13836669921875,
               'rmse': 0.015578631311655045,
               'ssds': [56.58993, 3.3815095],
               'ssim': 0.39384058117866516},
 'spectra_pcagan': {'cosine': [0.9921217,
                               0.99133325,
                               0.9871917,
                               0.9979797,
                               0.9989066,
                               0.99847215,
                               0.99861217,
                               0.9980592,
                               0.9956903,
                               0.9941717,
                               0.9962741,
                               0.9848426,
                               0.9854565,
                               0.9864587,
                               0.9871666,
                               0.9885868,
                               0.98987305,
                               0.98198014,
                               0.9905783,
                               0.99216837,
                               0.9876477,
                               0.9865791],
                    'mae': [0.032343443,
                            0.024181353,
                            0.10234372,
                            0.022951342,
                            0.018350543,
                            0.017614782,
                            0.017829226,
                            0.017857395,
                            0.024099033,
                            0.024208318,
                            0.019724717,
                            0.026629819,
                            0.02615952,
                            0.024380818,
                            0.024895791,
                            0.025706131,
                            0.024358956,
                            0.03179898,
                            0.028055888,
                            0.027031146,
                            0.028315408,
                            0.030941721],
                    'max_mae': 0.10234372,
                    'max_mse': 0.011332594,
                    'max_rmse': 0.106454656,
                    'median_mae': 0.024638304,
                    'min_cosine': 0.98198014,
                    'mse': [0.0014685306,
                            0.0009967448,
                            0.011332594,
                            0.00085389765,
                            0.0005657389,
                            0.0005175966,
                            0.0005534587,
                            0.00052779814,
                            0.00094440696,
                            0.0009457384,
                            0.00069421646,
                            0.0011395932,
                            0.0010616989,
                            0.0010301865,
                            0.0010497335,
                            0.001083368,
                            0.0010282755,
                            0.0016768852,
                            0.0013553967,
                            0.001310299,
                            0.0014304821,
                            0.0016180119],
                    'rmse': [0.038321413,
                             0.031571265,
                             0.106454656,
                             0.029221527,
                             0.023785265,
                             0.02275075,
                             0.023525704,
                             0.022973858,
                             0.030731205,
                             0.03075286,
                             0.026347987,
                             0.03375786,
                             0.03258372,
                             0.03209652,
                             0.03239959,
                             0.032914557,
                             0.032066736,
                             0.040949788,
                             0.036815714,
                             0.036198054,
                             0.037821714,
                             0.04022452]},
 'spectra_realgan': {'cosine': [0.9912347,
                                0.99026316,
                                0.9871963,
                                0.99796176,
                                0.99890083,
                                0.99846447,
                                0.99860394,
                                0.99804103,
                                0.99520475,
                                0.9936569,
                                0.9958095,
                                0.98329765,
                                0.9835999,
                                0.984698,
                                0.9859396,
                                0.9873891,
                                0.98822236,
                                0.98030156,
                                0.98952353,
                                0.99124986,
                                0.9861594,
                                0.98525864],
                     'mae': [0.033294223,
                             0.025828766,
                             0.10232119,
                             0.023086667,
                             0.018353976,
                             0.017655889,
                             0.017890586,
                             0.017944146,
                             0.025359493,
                             0.025303021,
                             0.02115929,
                             0.028000534,
                             0.02790281,
                             0.026169525,
                             0.026349448,
                             0.026940206,
                             0.026175488,
                             0.033334527,
                             0.029743722,
                             0.0290685,
                             0.029867712,
                             0.032590088],
                     'max_mae': 0.10232119,
                     'max_mse': 0.011329362,
                     'max_rmse': 0.10643948,
                     'median_mae': 0.026262468,
                     'min_cosine': 0.98030156,
                     'mse': [0.0015887473,
                             0.0011122684,
                             0.011329362,
                             0.0008626093,
                             0.00056718534,
                             0.000519867,
                             0.0005567879,
                             0.0005326666,
                             0.0010319458,
                             0.0010287849,
                             0.0007730675,
                             0.0012570083,
                             0.0011995912,
                             0.0011607567,
                             0.0011529385,
                             0.0011925612,
                             0.0011627872,
                             0.0018270607,
                             0.0015063379,
                             0.001459091,
                             0.0015643693,
                             0.0017679054],
                     'rmse': [0.039859094,
                              0.033350687,
                              0.10643948,
                              0.029370211,
                              0.023815654,
                              0.022800593,
                              0.023596354,
                              0.023079572,
                              0.032123912,
                              0.03207468,
                              0.027804092,
                              0.035454314,
                              0.034635115,
                              0.03406988,
                              0.03395495,
                              0.03453348,
                              0.034099665,
                              0.04274413,
                              0.03881157,
                              0.03819805,
                              0.039552107,
                              0.04204647]},
 'spectra_realpca': {'cosine': [0.9992242,
                                0.9989453,
                                0.99999064,
                                0.9999919,
                                0.99999434,
                                0.999989,
                                0.99999326,
                                0.9999866,
                                0.9995749,
                                0.9994848,
                                0.99951196,
                                0.9982844,
                                0.9982231,
                                0.99827164,
                                0.9985133,
                                0.9987211,
                                0.99833924,
                                0.9983699,
                                0.99882877,
                                0.99901325,
                                0.99842626,
                                0.9986432],
                     'mae': [0.007848191,
                             0.008265789,
                             0.0013894726,
                             0.0013601385,
                             0.0012237126,
                             0.0015149367,
                             0.0012944982,
                             0.0015015544,
                             0.0067861513,
                             0.007204044,
                             0.0070885294,
                             0.00903815,
                             0.009006072,
                             0.00892873,
                             0.008660964,
                             0.008514802,
                             0.009185303,
                             0.0094544655,
                             0.010022803,
                             0.010065931,
                             0.009492627,
                             0.009809859],
                     'max_mae': 0.010065931,
                     'max_mse': 0.00016578924,
                     'max_rmse': 0.012875917,
                     'median_mae': 0.008390295,
                     'min_cosine': 0.9982231,
                     'mse': [9.883504e-05,
                             0.000110152614,
                             3.108478e-06,
                             2.9798011e-06,
                             2.391747e-06,
                             3.6589142e-06,
                             2.6835821e-06,
                             3.602588e-06,
                             7.387273e-05,
                             8.268084e-05,
                             8.0665726e-05,
                             0.00013011997,
                             0.00013036083,
                             0.00012741465,
                             0.000118846,
                             0.00011539166,
                             0.00013555151,
                             0.00014430446,
                             0.00016578924,
                             0.00016326724,
                             0.00014405244,
                             0.00015419867],
                     'rmse': [0.009941582,
                              0.010495362,
                              0.0017630877,
                              0.00172621,
                              0.0015465274,
                              0.0019128289,
                              0.0016381643,
                              0.0018980484,
                              0.008594925,
                              0.009092901,
                              0.00898141,
                              0.011407014,
                              0.011417567,
                              0.011287809,
                              0.010901651,
                              0.010742051,
                              0.011642659,
                              0.012012679,
                              0.012875917,
                              0.012777607,
                              0.012002185,
                              0.012417676]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_55.0

Running comparison for experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226
Directory path: experiments/inpainting/gann_4_night_20210905_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 55.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_55.0/images
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_55.0/images
Optimal number of principal components:  25
Reconstruction error:  7.652385
Energy conservation:  0.5642458
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_55.0
saved spectra in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_55.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_55.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_55.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.867696224533345, 2.6480922741732082],
                   'kl_div': 0.64023364,
                   'ks_tests': {10000: KstestResult(statistic=0.242, pvalue=2.6998218879161325e-257, statistic_location=-0.0040851543, statistic_sign=-1),
                                20000: KstestResult(statistic=0.24860000000000002, pvalue=0.0, statistic_location=-0.0040213857, statistic_sign=-1),
                                30000: KstestResult(statistic=0.24503333333333335, pvalue=0.0, statistic_location=-0.004315964, statistic_sign=-1),
                                40000: KstestResult(statistic=0.25, pvalue=0.0, statistic_location=-0.0042039524, statistic_sign=-1),
                                50000: KstestResult(statistic=0.24510000000000004, pvalue=0.0, statistic_location=-0.0045401105, statistic_sign=-1),
                                60000: KstestResult(statistic=0.24719999999999998, pvalue=0.0, statistic_location=-0.0037326217, statistic_sign=-1),
                                70000: KstestResult(statistic=0.25005714285714287, pvalue=0.0, statistic_location=-0.0042491704, statistic_sign=-1),
                                80000: KstestResult(statistic=0.25002500000000005, pvalue=0.0, statistic_location=-0.0045145587, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2501333333333333, pvalue=0.0, statistic_location=-0.0040159393, statistic_sign=-1),
                                100000: KstestResult(statistic=0.251, pvalue=0.0, statistic_location=-0.004060494, statistic_sign=-1),
                                110000: KstestResult(statistic=0.24923636363636364, pvalue=0.0, statistic_location=-0.004311693, statistic_sign=-1),
                                120000: KstestResult(statistic=0.24580000000000002, pvalue=0.0, statistic_location=-0.0041862438, statistic_sign=-1),
                                130000: KstestResult(statistic=0.25043076923076923, pvalue=0.0, statistic_location=-0.00419592, statistic_sign=-1),
                                140000: KstestResult(statistic=0.24928571428571428, pvalue=0.0, statistic_location=-0.0043446934, statistic_sign=-1),
                                150000: KstestResult(statistic=0.24774666666666667, pvalue=0.0, statistic_location=-0.0041093417, statistic_sign=-1),
                                160000: KstestResult(statistic=0.24901875, pvalue=0.0, statistic_location=-0.00399497, statistic_sign=-1),
                                170000: KstestResult(statistic=0.2487823529411765, pvalue=0.0, statistic_location=-0.004016712, statistic_sign=-1),
                                180000: KstestResult(statistic=0.24860000000000002, pvalue=0.0, statistic_location=-0.0040432215, statistic_sign=-1),
                                190000: KstestResult(statistic=0.2504263157894737, pvalue=0.0, statistic_location=-0.0040273573, statistic_sign=-1),
                                200000: KstestResult(statistic=0.248365, pvalue=0.0, statistic_location=-0.004219629, statistic_sign=-1),
                                210000: KstestResult(statistic=0.24924285714285715, pvalue=0.0, statistic_location=-0.004021221, statistic_sign=-1),
                                220000: KstestResult(statistic=0.24723636363636364, pvalue=0.0, statistic_location=-0.004101515, statistic_sign=-1),
                                230000: KstestResult(statistic=0.249, pvalue=0.0, statistic_location=-0.0040219445, statistic_sign=-1),
                                240000: KstestResult(statistic=0.24905833333333335, pvalue=0.0, statistic_location=-0.004021677, statistic_sign=-1),
                                250000: KstestResult(statistic=0.24912800000000002, pvalue=0.0, statistic_location=-0.0043067634, statistic_sign=-1),
                                260000: KstestResult(statistic=0.25018076923076926, pvalue=0.0, statistic_location=-0.0043085944, statistic_sign=-1),
                                270000: KstestResult(statistic=0.24931111111111115, pvalue=0.0, statistic_location=-0.0040219445, statistic_sign=-1),
                                280000: KstestResult(statistic=0.2472285714285714, pvalue=0.0, statistic_location=-0.004097301, statistic_sign=-1),
                                290000: KstestResult(statistic=0.24751034482758622, pvalue=0.0, statistic_location=-0.004083425, statistic_sign=-1),
                                300000: KstestResult(statistic=0.24875666666666663, pvalue=0.0, statistic_location=-0.004195949, statistic_sign=-1),
                                310000: KstestResult(statistic=0.248, pvalue=0.0, statistic_location=-0.0041957516, statistic_sign=-1),
                                320000: KstestResult(statistic=0.249625, pvalue=0.0, statistic_location=-0.004343041, statistic_sign=-1),
                                330000: KstestResult(statistic=0.24792424242424238, pvalue=0.0, statistic_location=-0.0039915172, statistic_sign=-1)},
                   'moments': {'mean_error': -0.12499185,
                               'means': [-0.00065364566, -5.0000285e-06],
                               'stds': [0.015172766, 0.0036873394],
                               'variance_ratio': 13.618101}},
 'originals': {'gan': {'mae': 0.04760230705142021,
                       'mse': 0.01523522287607193,
                       'psnr': 23.570749282836914,
                       'rmse': 0.12343104183673859,
                       'ssim': 0.8455835580825806},
               'pca': {'mae': 0.006130519323050976,
                       'mse': 8.057065133471042e-05,
                       'psnr': 46.586830139160156,
                       'rmse': 0.008976115845143795,
                       'ssim': 0.9933499693870544}},
 'reconstructions': {'mae': 0.046690892428159714,
                     'mse': 0.015163532458245754,
                     'psnr': 23.840593338012695,
                     'rmse': 0.12314029783010483,
                     'ssim': 0.8490118384361267},
 'residual_spectra_pcagan': {'cosine': [0.28210312,
                                        0.063660175,
                                        0.123593,
                                        0.0540748,
                                        0.09667583,
                                        0.113330275,
                                        0.36559966,
                                        0.2790777,
                                        0.053275593,
                                        0.072696865,
                                        0.07138441,
                                        0.082460225,
                                        0.074040495,
                                        0.08907726,
                                        0.28796768,
                                        0.27073765,
                                        0.2883002,
                                        0.32972917,
                                        0.3886294,
                                        0.29679513,
                                        0.32125464,
                                        0.29691932,
                                        0.30139473,
                                        0.29708046,
                                        0.34784883,
                                        0.33503038,
                                        0.2552326,
                                        0.24787578,
                                        0.2906307,
                                        0.28507128,
                                        0.039904613,
                                        0.29671338,
                                        0.33153394],
                             'mae': [0.008333847,
                                     0.009101271,
                                     0.008201319,
                                     0.010195667,
                                     0.009024546,
                                     0.010076621,
                                     0.008182751,
                                     0.008584085,
                                     0.011226946,
                                     0.012252767,
                                     0.01082095,
                                     0.009612222,
                                     0.010660037,
                                     0.009114499,
                                     0.009516045,
                                     0.0095251985,
                                     0.008429504,
                                     0.008501215,
                                     0.007251468,
                                     0.008526356,
                                     0.009502919,
                                     0.009300457,
                                     0.00803888,
                                     0.009614661,
                                     0.0080616865,
                                     0.008223419,
                                     0.009874277,
                                     0.010329876,
                                     0.009095603,
                                     0.010392912,
                                     0.01319079,
                                     0.010595099,
                                     0.007823199],
                             'max_mae': 0.01319079,
                             'max_mse': 0.00045974288,
                             'max_rmse': 0.021441616,
                             'median_distance': 1.4111798,
                             'median_mae': 0.009300457,
                             'min_cosine': 0.039904613,
                             'mse': [0.00017171416,
                                     0.00017838848,
                                     0.0001379216,
                                     0.0002661825,
                                     0.00016404998,
                                     0.0003084434,
                                     0.00014939642,
                                     0.00020616455,
                                     0.00034097204,
                                     0.0002898338,
                                     0.00027273217,
                                     0.00019192345,
                                     0.00027278962,
                                     0.00016883646,
                                     0.00019558759,
                                     0.00028548585,
                                     0.00019091526,
                                     0.00014936716,
                                     0.00010630033,
                                     0.00021445067,
                                     0.00019802645,
                                     0.00022745357,
                                     0.00017928005,
                                     0.00020878282,
                                     0.00013180364,
                                     0.0001520284,
                                     0.00029231352,
                                     0.0002484259,
                                     0.00019914286,
                                     0.00025553402,
                                     0.00045974288,
                                     0.0002176117,
                                     0.00015448665],
                             'rmse': [0.013103975,
                                      0.013356215,
                                      0.011744003,
                                      0.0163151,
                                      0.0128082,
                                      0.017562557,
                                      0.012222783,
                                      0.014358431,
                                      0.018465428,
                                      0.017024506,
                                      0.016514605,
                                      0.013853644,
                                      0.016516345,
                                      0.012993708,
                                      0.013985263,
                                      0.016896326,
                                      0.013817209,
                                      0.012221586,
                                      0.010310205,
                                      0.014644135,
                                      0.014072187,
                                      0.015081564,
                                      0.01338955,
                                      0.014449319,
                                      0.011480576,
                                      0.01232998,
                                      0.017097179,
                                      0.015761532,
                                      0.014111798,
                                      0.015985431,
                                      0.021441616,
                                      0.014751668,
                                      0.012429266]},
 'residuals': {'mae': 0.009429730474948883,
               'mse': 0.0002177602582378313,
               'psnr': 15.609163284301758,
               'rmse': 0.0147567018866539,
               'ssds': [76.11101, 4.4868298],
               'ssim': 0.4928777515888214},
 'spectra_pcagan': {'cosine': [0.9959498,
                               0.9987741,
                               0.9988507,
                               0.9975739,
                               0.99839705,
                               0.9977772,
                               0.9929823,
                               0.99126375,
                               0.9875031,
                               0.99806243,
                               0.99889,
                               0.99844146,
                               0.9986735,
                               0.9981211,
                               0.99588436,
                               0.99461156,
                               0.9962935,
                               0.9854375,
                               0.9850639,
                               0.9873021,
                               0.9877449,
                               0.9893461,
                               0.9896071,
                               0.98355204,
                               0.9908505,
                               0.99225444,
                               0.9873094,
                               0.98682994,
                               0.9878877,
                               0.9508084,
                               0.22002022,
                               0.952506,
                               0.9883768],
                    'mae': [0.0189117,
                            0.015824052,
                            0.014292939,
                            0.023834562,
                            0.016404495,
                            0.020109866,
                            0.030418787,
                            0.024204401,
                            0.10158447,
                            0.022667019,
                            0.01837681,
                            0.017740136,
                            0.017462784,
                            0.017489089,
                            0.023289857,
                            0.023024537,
                            0.019305756,
                            0.026068347,
                            0.026170233,
                            0.023299808,
                            0.023995036,
                            0.025405793,
                            0.02377643,
                            0.030029891,
                            0.027903443,
                            0.026794361,
                            0.028059384,
                            0.03048502,
                            0.026522133,
                            0.052066535,
                            0.66085505,
                            0.06151704,
                            0.022909708],
                    'max_mae': 0.66085505,
                    'max_mse': 0.45408764,
                    'max_rmse': 0.67386025,
                    'median_mae': 0.023834562,
                    'min_cosine': 0.22002022,
                    'mse': [0.0006186299,
                            0.0004171473,
                            0.0003503311,
                            0.00083410303,
                            0.000440946,
                            0.0007073673,
                            0.0012895365,
                            0.0010023747,
                            0.011163338,
                            0.0008281534,
                            0.00056908734,
                            0.00052900764,
                            0.0005312856,
                            0.00050659286,
                            0.0008970251,
                            0.0008734148,
                            0.0006759925,
                            0.0010979698,
                            0.0010851197,
                            0.0009445465,
                            0.0009829561,
                            0.0010532091,
                            0.0009911365,
                            0.0015226576,
                            0.0013247504,
                            0.0012866644,
                            0.0014087809,
                            0.001565283,
                            0.0012495791,
                            0.003562904,
                            0.45408764,
                            0.0051085334,
                            0.00089056423],
                    'rmse': [0.024872271,
                             0.020424183,
                             0.018717134,
                             0.028880842,
                             0.020998714,
                             0.026596379,
                             0.03591012,
                             0.0316603,
                             0.1056567,
                             0.028777655,
                             0.023855552,
                             0.023000166,
                             0.023049634,
                             0.022507617,
                             0.029950377,
                             0.029553592,
                             0.025999855,
                             0.033135626,
                             0.032941155,
                             0.030733475,
                             0.031352133,
                             0.032453183,
                             0.03148232,
                             0.039021246,
                             0.03639712,
                             0.035870105,
                             0.03753373,
                             0.03956366,
                             0.035349388,
                             0.059690066,
                             0.67386025,
                             0.07147401,
                             0.029842323]},
 'spectra_realgan': {'cosine': [0.9955164,
                                0.9987649,
                                0.99883413,
                                0.99756616,
                                0.9983779,
                                0.9977365,
                                0.9921055,
                                0.9901596,
                                0.98750746,
                                0.998045,
                                0.998884,
                                0.99843335,
                                0.99866533,
                                0.99810344,
                                0.9953992,
                                0.99409825,
                                0.99583006,
                                0.9838781,
                                0.9832142,
                                0.9855101,
                                0.9865281,
                                0.9881487,
                                0.9879645,
                                0.981844,
                                0.98978984,
                                0.99135745,
                                0.98583984,
                                0.9855272,
                                0.986517,
                                0.9485304,
                                0.22053947,
                                0.9521743,
                                0.98690134],
                     'mae': [0.02003736,
                             0.015912456,
                             0.01439145,
                             0.023837384,
                             0.016507413,
                             0.02024578,
                             0.03139986,
                             0.025885034,
                             0.101561256,
                             0.022796463,
                             0.018384555,
                             0.017779883,
                             0.017534263,
                             0.017570963,
                             0.024620226,
                             0.024195084,
                             0.020818792,
                             0.02751676,
                             0.027908234,
                             0.025199236,
                             0.025496928,
                             0.026612235,
                             0.025614794,
                             0.03171184,
                             0.029572342,
                             0.028771188,
                             0.029580686,
                             0.032048475,
                             0.028307416,
                             0.052727886,
                             0.6607605,
                             0.061088167,
                             0.024481287],
                     'max_mae': 0.6607605,
                     'max_mse': 0.45395273,
                     'max_rmse': 0.6737601,
                     'median_mae': 0.025496928,
                     'min_cosine': 0.22053947,
                     'mse': [0.00068473973,
                             0.00042061973,
                             0.00035520172,
                             0.000835334,
                             0.00044601268,
                             0.0007178525,
                             0.0014078384,
                             0.0011215287,
                             0.011160203,
                             0.0008367609,
                             0.0005706602,
                             0.0005313679,
                             0.00053463364,
                             0.00051129406,
                             0.0009844217,
                             0.00095619133,
                             0.0007544167,
                             0.0012169371,
                             0.0012226732,
                             0.0010774712,
                             0.0010844683,
                             0.0011621849,
                             0.0011252535,
                             0.0016751633,
                             0.0014775015,
                             0.0014325989,
                             0.0015413836,
                             0.0017134062,
                             0.0013875705,
                             0.0037367907,
                             0.45395273,
                             0.005122695,
                             0.0010044419],
                     'rmse': [0.026167532,
                              0.020509016,
                              0.018846795,
                              0.028902145,
                              0.021119012,
                              0.02679277,
                              0.037521172,
                              0.03348923,
                              0.105641864,
                              0.02892682,
                              0.023888495,
                              0.023051418,
                              0.023122147,
                              0.022611812,
                              0.031375494,
                              0.030922344,
                              0.027466647,
                              0.034884624,
                              0.034966744,
                              0.032824855,
                              0.03293127,
                              0.034090832,
                              0.033544797,
                              0.04092876,
                              0.038438283,
                              0.037849687,
                              0.03926046,
                              0.04139331,
                              0.03725011,
                              0.061129294,
                              0.6737601,
                              0.071573004,
                              0.03169293]},
 'spectra_realpca': {'cosine': [0.99955875,
                                0.9999933,
                                0.99998045,
                                0.99998605,
                                0.99998105,
                                0.9999628,
                                0.9992242,
                                0.9989453,
                                0.99999064,
                                0.9999919,
                                0.99999434,
                                0.999989,
                                0.99999326,
                                0.9999866,
                                0.9995749,
                                0.9994848,
                                0.99951196,
                                0.9982844,
                                0.9982231,
                                0.99827164,
                                0.9985133,
                                0.9987211,
                                0.99833924,
                                0.9983699,
                                0.99882877,
                                0.99901325,
                                0.99842626,
                                0.9986432,
                                0.998518,
                                0.9981548,
                                0.9999427,
                                0.9984734,
                                0.99835116],
                     'mae': [0.0064566317,
                             0.0011670388,
                             0.001923758,
                             0.0016022433,
                             0.001783893,
                             0.0025621888,
                             0.007848191,
                             0.008265789,
                             0.0013894726,
                             0.0013601385,
                             0.0012237126,
                             0.0015149367,
                             0.0012944982,
                             0.0015015544,
                             0.0067861513,
                             0.007204044,
                             0.0070885294,
                             0.00903815,
                             0.009006072,
                             0.00892873,
                             0.008660964,
                             0.008514802,
                             0.009185303,
                             0.0094544655,
                             0.010022803,
                             0.010065931,
                             0.009492627,
                             0.009809859,
                             0.009790528,
                             0.009223073,
                             0.0016267156,
                             0.009667927,
                             0.008846406],
                     'max_mae': 0.010065931,
                     'max_mse': 0.00016578924,
                     'max_rmse': 0.012875917,
                     'median_mae': 0.007848191,
                     'min_cosine': 0.9981548,
                     'mse': [6.7396446e-05,
                             2.1823453e-06,
                             5.9697627e-06,
                             4.129147e-06,
                             5.1542966e-06,
                             1.0558978e-05,
                             9.883504e-05,
                             0.000110152614,
                             3.108478e-06,
                             2.9798011e-06,
                             2.391747e-06,
                             3.6589142e-06,
                             2.6835821e-06,
                             3.602588e-06,
                             7.387273e-05,
                             8.268084e-05,
                             8.0665726e-05,
                             0.00013011997,
                             0.00013036083,
                             0.00012741465,
                             0.000118846,
                             0.00011539166,
                             0.00013555151,
                             0.00014430446,
                             0.00016578924,
                             0.00016326724,
                             0.00014405244,
                             0.00015419867,
                             0.00015250182,
                             0.00013720854,
                             4.3296186e-06,
                             0.00014984151,
                             0.00012563009],
                     'rmse': [0.008209534,
                              0.0014772763,
                              0.0024433099,
                              0.0020320301,
                              0.0022703076,
                              0.003249458,
                              0.009941582,
                              0.010495362,
                              0.0017630877,
                              0.00172621,
                              0.0015465274,
                              0.0019128289,
                              0.0016381643,
                              0.0018980484,
                              0.008594925,
                              0.009092901,
                              0.00898141,
                              0.011407014,
                              0.011417567,
                              0.011287809,
                              0.010901651,
                              0.010742051,
                              0.011642659,
                              0.012012679,
                              0.012875917,
                              0.012777607,
                              0.012002185,
                              0.012417676,
                              0.012349162,
                              0.011713604,
                              0.0020807735,
                              0.012240977,
                              0.011208483]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_55.0
