
Running comparison for experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144929/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144929
Directory path: experiments/inpainting/gann_4_night_20180708_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144929/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144929/comparison_90.0/images
Optimal number of principal components:  44
Reconstruction error:  5.172227
Energy conservation:  0.90603215
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144929/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144929/comparison_90.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144929/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144929/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144929/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144929/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.109324612990918, 2.9635758484081416],
                   'kl_div': 0.63716614,
                   'ks_tests': {10000: KstestResult(statistic=0.2716, pvalue=1e-323, statistic_location=-0.007037569, statistic_sign=-1),
                                20000: KstestResult(statistic=0.27790000000000004, pvalue=0.0, statistic_location=-0.007252874, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2720666666666667, pvalue=0.0, statistic_location=-0.0070661674, statistic_sign=-1),
                                40000: KstestResult(statistic=0.26882500000000004, pvalue=0.0, statistic_location=-0.0063347733, statistic_sign=-1),
                                50000: KstestResult(statistic=0.26986, pvalue=0.0, statistic_location=-0.006911812, statistic_sign=-1),
                                60000: KstestResult(statistic=0.2720666666666667, pvalue=0.0, statistic_location=-0.0064591905, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2719285714285714, pvalue=0.0, statistic_location=-0.006827905, statistic_sign=-1),
                                80000: KstestResult(statistic=0.2729625, pvalue=0.0, statistic_location=-0.006576419, statistic_sign=-1),
                                90000: KstestResult(statistic=0.27143333333333336, pvalue=0.0, statistic_location=-0.006391394, statistic_sign=-1),
                                100000: KstestResult(statistic=0.27432, pvalue=0.0, statistic_location=-0.006331982, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2721272727272727, pvalue=0.0, statistic_location=-0.0063926093, statistic_sign=-1)},
                   'moments': {'mean_error': -0.48173693,
                               'means': [-0.0027493825, -7.265051e-05],
                               'stds': [0.019861331, 0.0050573694],
                               'variance_ratio': 13.025618}},
 'originals': {'gan': {'mae': 0.053523529320955276,
                       'mse': 0.005720214452594519,
                       'psnr': 26.776519775390625,
                       'rmse': 0.07563210278749466,
                       'ssim': 0.9457948207855225},
               'pca': {'mae': 0.010652859695255756,
                       'mse': 0.00022872966655995697,
                       'psnr': 40.70917510986328,
                       'rmse': 0.015123811550438404,
                       'ssim': 0.9975161552429199}},
 'reconstructions': {'mae': 0.05221354588866234,
                     'mse': 0.005523270927369595,
                     'psnr': 26.88043785095215,
                     'rmse': 0.07431871443986893,
                     'ssim': 0.9477294683456421},
 'residual_spectra_pcagan': {'cosine': [0.34754682,
                                        0.018041367,
                                        0.2884659,
                                        0.30200762,
                                        0.011199103,
                                        0.33305305,
                                        0.30383188,
                                        0.3510716,
                                        0.2868002,
                                        0.17638545,
                                        0.27178636],
                             'mae': [0.01091546,
                                     0.015465232,
                                     0.012015744,
                                     0.013235327,
                                     0.01449247,
                                     0.010707206,
                                     0.0125245135,
                                     0.01067666,
                                     0.01209734,
                                     0.014572901,
                                     0.013194614],
                             'max_mae': 0.015465232,
                             'max_mse': 0.0005277251,
                             'max_rmse': 0.022972267,
                             'median_distance': 1.8953106,
                             'median_mae': 0.0125245135,
                             'min_cosine': 0.011199103,
                             'mse': [0.00025201798,
                                     0.00050433225,
                                     0.00034187044,
                                     0.00035922023,
                                     0.0005277251,
                                     0.00025568216,
                                     0.000316614,
                                     0.0002571419,
                                     0.00046822467,
                                     0.0004528759,
                                     0.00039681199],
                             'rmse': [0.015875075,
                                      0.022457343,
                                      0.018489739,
                                      0.018953105,
                                      0.022972267,
                                      0.015990064,
                                      0.01779365,
                                      0.016035644,
                                      0.0216385,
                                      0.021280881,
                                      0.01992014]},
 'residuals': {'mae': 0.012717952020466328,
               'mse': 0.00037568327388726175,
               'psnr': 18.711185455322266,
               'rmse': 0.019382551312446594,
               'ssds': [44.223083, 2.814023],
               'ssim': 0.2925039827823639},
 'spectra_pcagan': {'cosine': [0.99238926,
                               0.99909556,
                               0.99659824,
                               0.98288715,
                               0.9876235,
                               0.9963457,
                               0.9941516,
                               0.97803175,
                               0.9911889,
                               0.94749343,
                               0.97730434],
                    'mae': [0.03178447,
                            0.020012112,
                            0.055990666,
                            0.034606434,
                            0.027284054,
                            0.049815074,
                            0.046054766,
                            0.17672095,
                            0.03302128,
                            0.063801415,
                            0.035257753],
                    'max_mae': 0.17672095,
                    'max_mse': 0.03403022,
                    'max_rmse': 0.18447281,
                    'median_mae': 0.035257753,
                    'min_cosine': 0.94749343,
                    'mse': [0.0017278915,
                            0.0006323141,
                            0.0046113823,
                            0.0019483581,
                            0.0012438991,
                            0.0036923122,
                            0.0033432923,
                            0.03403022,
                            0.002004409,
                            0.0053883367,
                            0.0021335655],
                    'rmse': [0.041567914,
                             0.025145857,
                             0.06790716,
                             0.04414021,
                             0.035268955,
                             0.0607644,
                             0.05782121,
                             0.18447281,
                             0.044770624,
                             0.07340529,
                             0.046190534]},
 'spectra_realgan': {'cosine': [0.99111706,
                                0.99909526,
                                0.9960827,
                                0.98077023,
                                0.98758465,
                                0.9957012,
                                0.9934008,
                                0.97671163,
                                0.9896965,
                                0.94682777,
                                0.9749594],
                     'mae': [0.03464494,
                             0.020015163,
                             0.057349402,
                             0.036696892,
                             0.02733016,
                             0.051300593,
                             0.04760721,
                             0.17657268,
                             0.035776936,
                             0.06396055,
                             0.037504364],
                     'max_mae': 0.17657268,
                     'max_mse': 0.034198746,
                     'max_rmse': 0.18492903,
                     'median_mae': 0.037504364,
                     'min_cosine': 0.94682777,
                     'mse': [0.0020059098,
                             0.000632446,
                             0.004937755,
                             0.0021782517,
                             0.0012472821,
                             0.00403334,
                             0.0035901063,
                             0.034198746,
                             0.002283812,
                             0.005449962,
                             0.002364756],
                     'rmse': [0.044787385,
                              0.02514848,
                              0.07026916,
                              0.046671744,
                              0.03531688,
                              0.063508585,
                              0.059917495,
                              0.18492903,
                              0.047789246,
                              0.073823854,
                              0.04862876]},
 'spectra_realpca': {'cosine': [0.9986659,
                                0.9999998,
                                0.9994866,
                                0.99798936,
                                0.9999893,
                                0.99936277,
                                0.9991723,
                                0.99854934,
                                0.9985071,
                                0.99897516,
                                0.99793917],
                     'mae': [0.013562525,
                             0.00020996254,
                             0.015513202,
                             0.011829725,
                             0.0008207076,
                             0.015275073,
                             0.014977359,
                             0.013207196,
                             0.013487489,
                             0.0074121132,
                             0.010886119],
                     'max_mae': 0.015513202,
                     'max_mse': 0.0003879158,
                     'max_rmse': 0.019695578,
                     'median_mae': 0.013207196,
                     'min_cosine': 0.99793917,
                     'mse': [0.00029418038,
                             7.0102956e-08,
                             0.0003879158,
                             0.00022395262,
                             1.0803329e-06,
                             0.00037220205,
                             0.00036039334,
                             0.0003034708,
                             0.00029072753,
                             8.970343e-05,
                             0.00019232991],
                     'rmse': [0.017151687,
                              0.00026476962,
                              0.019695578,
                              0.014965047,
                              0.0010393907,
                              0.019292539,
                              0.01898403,
                              0.017420413,
                              0.017050734,
                              0.009471189,
                              0.013868306]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144929/comparison_90.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628
Directory path: experiments/inpainting/gann_4_night_20180708_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_90.0/images
Optimal number of principal components:  44
Reconstruction error:  5.172227
Energy conservation:  0.90603215
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_90.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.079875858281184, 2.68085795194715],
                   'kl_div': 0.8596942,
                   'ks_tests': {10000: KstestResult(statistic=0.2757, pvalue=1e-323, statistic_location=-0.0051533524, statistic_sign=-1),
                                20000: KstestResult(statistic=0.27865, pvalue=0.0, statistic_location=-0.004645869, statistic_sign=-1),
                                30000: KstestResult(statistic=0.27613333333333334, pvalue=0.0, statistic_location=-0.004646668, statistic_sign=-1),
                                40000: KstestResult(statistic=0.27725, pvalue=0.0, statistic_location=-0.0047244485, statistic_sign=-1),
                                50000: KstestResult(statistic=0.27506, pvalue=0.0, statistic_location=-0.0051200464, statistic_sign=-1),
                                60000: KstestResult(statistic=0.27590000000000003, pvalue=0.0, statistic_location=-0.005153686, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2771, pvalue=0.0, statistic_location=-0.0054393765, statistic_sign=-1),
                                80000: KstestResult(statistic=0.2772875, pvalue=0.0, statistic_location=-0.004595736, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2817, pvalue=0.0, statistic_location=-0.005135417, statistic_sign=-1),
                                100000: KstestResult(statistic=0.27898, pvalue=0.0, statistic_location=-0.005066965, statistic_sign=-1),
                                110000: KstestResult(statistic=0.27720909090909096, pvalue=0.0, statistic_location=-0.0049428195, statistic_sign=-1),
                                120000: KstestResult(statistic=0.27902499999999997, pvalue=0.0, statistic_location=-0.005156891, statistic_sign=-1),
                                130000: KstestResult(statistic=0.27733076923076927, pvalue=0.0, statistic_location=-0.0051565534, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2779142857142857, pvalue=0.0, statistic_location=-0.00515812, statistic_sign=-1),
                                150000: KstestResult(statistic=0.27815333333333336, pvalue=0.0, statistic_location=-0.0050974637, statistic_sign=-1),
                                160000: KstestResult(statistic=0.27776875, pvalue=0.0, statistic_location=-0.0051516294, statistic_sign=-1),
                                170000: KstestResult(statistic=0.27684705882352945, pvalue=0.0, statistic_location=-0.0051535657, statistic_sign=-1),
                                180000: KstestResult(statistic=0.27711111111111114, pvalue=0.0, statistic_location=-0.0051516294, statistic_sign=-1),
                                190000: KstestResult(statistic=0.2765578947368421, pvalue=0.0, statistic_location=-0.0051438557, statistic_sign=-1),
                                200000: KstestResult(statistic=0.27994, pvalue=0.0, statistic_location=-0.0051539275, statistic_sign=-1),
                                210000: KstestResult(statistic=0.27635238095238096, pvalue=0.0, statistic_location=-0.005305469, statistic_sign=-1),
                                220000: KstestResult(statistic=0.27693181818181817, pvalue=0.0, statistic_location=-0.0051542763, statistic_sign=-1)},
                   'moments': {'mean_error': -0.25078812,
                               'means': [-0.0014181881, -4.497025e-05],
                               'stds': [0.01881039, 0.004267757],
                               'variance_ratio': 17.19868}},
 'originals': {'gan': {'mae': 0.041415736079216,
                       'mse': 0.003690463025122881,
                       'psnr': 29.55628204345703,
                       'rmse': 0.06074918061494827,
                       'ssim': 0.9063164591789246},
               'pca': {'mae': 0.008162827230989933,
                       'mse': 0.00016959679487627,
                       'psnr': 43.113346099853516,
                       'rmse': 0.013022933155298233,
                       'ssim': 0.9958631992340088}},
 'reconstructions': {'mae': 0.04035324975848198,
                     'mse': 0.003541208803653717,
                     'psnr': 29.9160099029541,
                     'rmse': 0.059508055448532104,
                     'ssim': 0.9085070490837097},
 'residual_spectra_pcagan': {'cosine': [0.023192722,
                                        -0.01320334,
                                        0.06598995,
                                        0.27018553,
                                        0.29217446,
                                        0.38058004,
                                        0.015627293,
                                        0.30106053,
                                        0.31882668,
                                        0.011191122,
                                        0.3574771,
                                        0.3267963,
                                        0.35470742,
                                        0.3044758,
                                        0.19859324,
                                        0.29527354,
                                        0.29510975,
                                        0.26247203,
                                        0.07582119,
                                        0.01986431,
                                        0.16305836,
                                        0.00081626006],
                             'mae': [0.014162365,
                                     0.015152688,
                                     0.013766182,
                                     0.013942695,
                                     0.012030657,
                                     0.010027321,
                                     0.01451405,
                                     0.011299659,
                                     0.012205662,
                                     0.013691465,
                                     0.009929752,
                                     0.011215988,
                                     0.010257233,
                                     0.011278983,
                                     0.012686791,
                                     0.01216355,
                                     0.010319458,
                                     0.012005489,
                                     0.011957398,
                                     0.012824161,
                                     0.011299927,
                                     0.011937853],
                             'max_mae': 0.015152688,
                             'max_mse': 0.0004915641,
                             'max_rmse': 0.022171246,
                             'median_distance': 1.7972801,
                             'median_mae': 0.012018073,
                             'min_cosine': -0.01320334,
                             'mse': [0.00039671874,
                                     0.0004915641,
                                     0.0004388546,
                                     0.0003718562,
                                     0.0003186205,
                                     0.00020522693,
                                     0.00043690804,
                                     0.00031485085,
                                     0.00030823858,
                                     0.00048888475,
                                     0.00022140465,
                                     0.00026834832,
                                     0.0002543695,
                                     0.0004133205,
                                     0.00034467064,
                                     0.0003461617,
                                     0.0002639384,
                                     0.00030587855,
                                     0.0002612494,
                                     0.00033047356,
                                     0.00032745287,
                                     0.00030963443],
                             'rmse': [0.0199178,
                                      0.022171246,
                                      0.020948857,
                                      0.019283574,
                                      0.017849945,
                                      0.014325744,
                                      0.020902345,
                                      0.017744036,
                                      0.017556725,
                                      0.022110738,
                                      0.014879673,
                                      0.01638134,
                                      0.015948964,
                                      0.020330286,
                                      0.018565308,
                                      0.01860542,
                                      0.016246181,
                                      0.017489385,
                                      0.016163211,
                                      0.018178932,
                                      0.01809566,
                                      0.017596433]},
 'residuals': {'mae': 0.012212243862450123,
               'mse': 0.00033721025101840496,
               'psnr': 19.180395126342773,
               'rmse': 0.018363285809755325,
               'ssds': [78.28488, 4.0074506],
               'ssim': 0.3121904134750366},
 'spectra_pcagan': {'cosine': [0.9989442,
                               0.99940205,
                               0.9816239,
                               0.9946773,
                               0.99687123,
                               0.9929889,
                               0.99916655,
                               0.9968026,
                               0.98429483,
                               0.988521,
                               0.9966711,
                               0.99481374,
                               0.9779824,
                               0.991737,
                               0.9578344,
                               0.979128,
                               0.9882964,
                               0.97973543,
                               0.9883651,
                               0.999316,
                               0.98157877,
                               0.9974129],
                    'mae': [0.01713927,
                            0.020177305,
                            0.02857713,
                            0.048537098,
                            0.05742765,
                            0.030527893,
                            0.01998182,
                            0.054311357,
                            0.03307733,
                            0.0261799,
                            0.047024526,
                            0.042988516,
                            0.17980644,
                            0.031001441,
                            0.05817458,
                            0.033694603,
                            0.026907813,
                            0.041136194,
                            0.027402204,
                            0.017706553,
                            0.025803478,
                            0.020188406],
                    'max_mae': 0.17980644,
                    'max_mse': 0.035052065,
                    'max_rmse': 0.18722196,
                    'median_mae': 0.030764667,
                    'min_cosine': 0.9578344,
                    'mse': [0.0004722945,
                            0.00059312896,
                            0.0013534868,
                            0.0036730953,
                            0.0054758172,
                            0.0015743357,
                            0.0006231253,
                            0.0043167444,
                            0.0017920192,
                            0.0011697836,
                            0.003278524,
                            0.002918476,
                            0.035052065,
                            0.0018270416,
                            0.004441328,
                            0.001952466,
                            0.0012340086,
                            0.002609318,
                            0.001214373,
                            0.00047678538,
                            0.0011818735,
                            0.00067650294],
                    'rmse': [0.021732338,
                             0.02435424,
                             0.036789764,
                             0.060606066,
                             0.073998764,
                             0.0396779,
                             0.024962477,
                             0.06570194,
                             0.042332247,
                             0.0342021,
                             0.057258397,
                             0.05402292,
                             0.18722196,
                             0.042743906,
                             0.06664329,
                             0.04418672,
                             0.03512846,
                             0.051081482,
                             0.034847856,
                             0.021835417,
                             0.034378387,
                             0.02600967]},
 'spectra_realgan': {'cosine': [0.99894327,
                                0.99940234,
                                0.98145306,
                                0.99415404,
                                0.9965239,
                                0.991695,
                                0.99916625,
                                0.99628097,
                                0.9822146,
                                0.9884819,
                                0.9960184,
                                0.994058,
                                0.97664857,
                                0.99022675,
                                0.95710987,
                                0.97679853,
                                0.98647827,
                                0.9784223,
                                0.9882579,
                                0.99931574,
                                0.98092294,
                                0.997411],
                     'mae': [0.017146079,
                             0.020168345,
                             0.028706223,
                             0.050800398,
                             0.059404463,
                             0.033509545,
                             0.019985925,
                             0.055692036,
                             0.03531207,
                             0.02621587,
                             0.048675243,
                             0.044680182,
                             0.17965956,
                             0.03404801,
                             0.05834632,
                             0.035970166,
                             0.028960349,
                             0.04211721,
                             0.02753194,
                             0.017711489,
                             0.026319312,
                             0.020185553],
                     'max_mae': 0.17965956,
                     'max_mse': 0.035222843,
                     'max_rmse': 0.1876775,
                     'median_mae': 0.03377878,
                     'min_cosine': 0.95710987,
                     'mse': [0.00047266626,
                             0.00059270527,
                             0.0013652463,
                             0.00403947,
                             0.005812725,
                             0.0018575729,
                             0.0006232374,
                             0.004649755,
                             0.0020181779,
                             0.0011730588,
                             0.0036266067,
                             0.0031747771,
                             0.035222843,
                             0.0021111243,
                             0.004506634,
                             0.0021810574,
                             0.0014073155,
                             0.0027539334,
                             0.0012253452,
                             0.00047697028,
                             0.0012224708,
                             0.0006764928],
                     'rmse': [0.02174089,
                              0.02434554,
                              0.03694924,
                              0.06355683,
                              0.07624123,
                              0.04309957,
                              0.024964724,
                              0.068189114,
                              0.044924136,
                              0.034249946,
                              0.060221314,
                              0.05634516,
                              0.1876775,
                              0.045946974,
                              0.06713147,
                              0.046701793,
                              0.037514202,
                              0.052477933,
                              0.035004932,
                              0.021839648,
                              0.03496385,
                              0.026009476]},
 'spectra_realpca': {'cosine': [0.99999917,
                                1.0,
                                0.9998748,
                                0.9994344,
                                0.9996437,
                                0.9986659,
                                0.9999998,
                                0.9994866,
                                0.99798936,
                                0.9999893,
                                0.99936277,
                                0.9991723,
                                0.99854934,
                                0.9985071,
                                0.99897516,
                                0.99793917,
                                0.99813783,
                                0.9985657,
                                0.99995846,
                                0.99999994,
                                0.9994442,
                                0.9999965],
                     'mae': [0.00042513714,
                             0.00013267116,
                             0.0023799965,
                             0.015630957,
                             0.016662214,
                             0.013562525,
                             0.00020996254,
                             0.015513202,
                             0.011829725,
                             0.0008207076,
                             0.015275073,
                             0.014977359,
                             0.013207196,
                             0.013487489,
                             0.0074121132,
                             0.010886119,
                             0.010570929,
                             0.009685269,
                             0.0015304482,
                             0.00018514339,
                             0.004497952,
                             0.0007000246],
                     'max_mae': 0.016662214,
                     'max_mse': 0.0004462989,
                     'max_rmse': 0.021125788,
                     'median_mae': 0.0101280995,
                     'min_cosine': 0.99793917,
                     'mse': [2.9037116e-07,
                             2.8210172e-08,
                             9.101195e-06,
                             0.0003914494,
                             0.0004462989,
                             0.00029418038,
                             7.0102956e-08,
                             0.0003879158,
                             0.00022395262,
                             1.0803329e-06,
                             0.00037220205,
                             0.00036039334,
                             0.0003034708,
                             0.00029072753,
                             8.970343e-05,
                             0.00019232991,
                             0.00017806335,
                             0.00015195375,
                             3.853383e-06,
                             5.5508337e-08,
                             3.3220105e-05,
                             7.891484e-07],
                     'rmse': [0.000538861,
                              0.00016795885,
                              0.0030168188,
                              0.01978508,
                              0.021125788,
                              0.017151687,
                              0.00026476962,
                              0.019695578,
                              0.014965047,
                              0.0010393907,
                              0.019292539,
                              0.01898403,
                              0.017420413,
                              0.017050734,
                              0.009471189,
                              0.013868306,
                              0.013344038,
                              0.012326952,
                              0.0019630035,
                              0.00023560207,
                              0.0057636886,
                              0.00088834023]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_90.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354
Directory path: experiments/inpainting/gann_4_night_20180708_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_90.0/images
Optimal number of principal components:  44
Reconstruction error:  5.172227
Energy conservation:  0.90603215
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_90.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.061857105227111, 2.3154868778089366],
                   'kl_div': 1.1804296,
                   'ks_tests': {10000: KstestResult(statistic=0.3053, pvalue=1e-323, statistic_location=-0.0029183133, statistic_sign=-1),
                                20000: KstestResult(statistic=0.3037, pvalue=0.0, statistic_location=-0.0029913587, statistic_sign=-1),
                                30000: KstestResult(statistic=0.3029333333333334, pvalue=0.0, statistic_location=-0.0034259427, statistic_sign=-1),
                                40000: KstestResult(statistic=0.3054, pvalue=0.0, statistic_location=-0.0029892349, statistic_sign=-1),
                                50000: KstestResult(statistic=0.30394, pvalue=0.0, statistic_location=-0.0033208132, statistic_sign=-1),
                                60000: KstestResult(statistic=0.3070666666666667, pvalue=0.0, statistic_location=-0.0029075807, statistic_sign=-1),
                                70000: KstestResult(statistic=0.3057714285714286, pvalue=0.0, statistic_location=-0.002572056, statistic_sign=-1),
                                80000: KstestResult(statistic=0.304025, pvalue=0.0, statistic_location=-0.0026089656, statistic_sign=-1),
                                90000: KstestResult(statistic=0.3063444444444444, pvalue=0.0, statistic_location=-0.0029667616, statistic_sign=-1),
                                100000: KstestResult(statistic=0.30505, pvalue=0.0, statistic_location=-0.0030620256, statistic_sign=-1),
                                110000: KstestResult(statistic=0.3023818181818182, pvalue=0.0, statistic_location=-0.0028950386, statistic_sign=-1),
                                120000: KstestResult(statistic=0.305825, pvalue=0.0, statistic_location=-0.003097374, statistic_sign=-1),
                                130000: KstestResult(statistic=0.3083846153846154, pvalue=0.0, statistic_location=-0.0029152092, statistic_sign=-1),
                                140000: KstestResult(statistic=0.30405, pvalue=0.0, statistic_location=-0.0029672198, statistic_sign=-1),
                                150000: KstestResult(statistic=0.3073066666666666, pvalue=0.0, statistic_location=-0.0028878776, statistic_sign=-1),
                                160000: KstestResult(statistic=0.30221875000000004, pvalue=0.0, statistic_location=-0.0029152092, statistic_sign=-1),
                                170000: KstestResult(statistic=0.3049588235294118, pvalue=0.0, statistic_location=-0.003061602, statistic_sign=-1),
                                180000: KstestResult(statistic=0.3055611111111111, pvalue=0.0, statistic_location=-0.0029673288, statistic_sign=-1),
                                190000: KstestResult(statistic=0.30216315789473686, pvalue=0.0, statistic_location=-0.0033061346, statistic_sign=-1),
                                200000: KstestResult(statistic=0.30404, pvalue=0.0, statistic_location=-0.0031132041, statistic_sign=-1),
                                210000: KstestResult(statistic=0.30452380952380953, pvalue=0.0, statistic_location=-0.0028160522, statistic_sign=-1),
                                220000: KstestResult(statistic=0.3048454545454546, pvalue=0.0, statistic_location=-0.002960287, statistic_sign=-1),
                                230000: KstestResult(statistic=0.30514347826086957, pvalue=0.0, statistic_location=-0.002960287, statistic_sign=-1),
                                240000: KstestResult(statistic=0.3031625, pvalue=0.0, statistic_location=-0.0031875782, statistic_sign=-1),
                                250000: KstestResult(statistic=0.30660400000000004, pvalue=0.0, statistic_location=-0.0029635616, statistic_sign=-1),
                                260000: KstestResult(statistic=0.3060807692307692, pvalue=0.0, statistic_location=-0.0029272456, statistic_sign=-1),
                                270000: KstestResult(statistic=0.3036111111111111, pvalue=0.0, statistic_location=-0.0030187902, statistic_sign=-1),
                                280000: KstestResult(statistic=0.30404642857142855, pvalue=0.0, statistic_location=-0.003113233, statistic_sign=-1),
                                290000: KstestResult(statistic=0.3058862068965517, pvalue=0.0, statistic_location=-0.002937152, statistic_sign=-1),
                                300000: KstestResult(statistic=0.30599333333333334, pvalue=0.0, statistic_location=-0.0030521275, statistic_sign=-1),
                                310000: KstestResult(statistic=0.3054322580645161, pvalue=0.0, statistic_location=-0.0029816497, statistic_sign=-1),
                                320000: KstestResult(statistic=0.30339375, pvalue=0.0, statistic_location=-0.0029337527, statistic_sign=-1),
                                330000: KstestResult(statistic=0.30307272727272727, pvalue=0.0, statistic_location=-0.0028417192, statistic_sign=-1)},
                   'moments': {'mean_error': -0.081254356,
                               'means': [-0.0005078844, -2.8149374e-05],
                               'stds': [0.017889043, 0.0035125143],
                               'variance_ratio': 25.297153}},
 'originals': {'gan': {'mae': 0.03434796258807182,
                       'mse': 0.0026877636555582285,
                       'psnr': 30.955209732055664,
                       'rmse': 0.05184364691376686,
                       'ssim': 0.9331125020980835},
               'pca': {'mae': 0.005775872617959976,
                       'mse': 0.00011390278086764738,
                       'psnr': 44.92540740966797,
                       'rmse': 0.010672524571418762,
                       'ssim': 0.9974133372306824}},
 'reconstructions': {'mae': 0.033621061593294144,
                     'mse': 0.0025873796548694372,
                     'psnr': 31.36214828491211,
                     'rmse': 0.05086629092693329,
                     'ssim': 0.9345135688781738},
 'residual_spectra_pcagan': {'cosine': [0.049343307,
                                        0.03761909,
                                        0.094377905,
                                        0.028366389,
                                        0.057775956,
                                        0.008353131,
                                        0.022307973,
                                        -0.015299437,
                                        0.066843525,
                                        0.26633132,
                                        0.303425,
                                        0.39232355,
                                        0.017298676,
                                        0.30621907,
                                        0.34272346,
                                        0.015277326,
                                        0.37254295,
                                        0.3283464,
                                        0.35816336,
                                        0.31447724,
                                        0.20775613,
                                        0.30466866,
                                        0.30715248,
                                        0.27254012,
                                        0.07439766,
                                        0.015888046,
                                        0.16064923,
                                        0.002015161,
                                        0.056533094,
                                        0.053694207,
                                        0.066535465,
                                        0.029757207,
                                        0.01385379],
                             'mae': [0.010842311,
                                     0.011662101,
                                     0.010377481,
                                     0.012115625,
                                     0.011079052,
                                     0.014473398,
                                     0.014298337,
                                     0.015054132,
                                     0.01363652,
                                     0.013954992,
                                     0.011646226,
                                     0.009723802,
                                     0.014334634,
                                     0.011152083,
                                     0.011641252,
                                     0.013174631,
                                     0.009535931,
                                     0.011091914,
                                     0.010007923,
                                     0.010982406,
                                     0.012402291,
                                     0.011921214,
                                     0.010103933,
                                     0.011727225,
                                     0.0118678585,
                                     0.012620456,
                                     0.011184762,
                                     0.012000631,
                                     0.011389117,
                                     0.010912977,
                                     0.010439106,
                                     0.011595447,
                                     0.01345557],
                             'max_mae': 0.015054132,
                             'max_mse': 0.000472917,
                             'max_rmse': 0.021746654,
                             'median_distance': 1.7280217,
                             'median_mae': 0.011646226,
                             'min_cosine': -0.015299437,
                             'mse': [0.00021920523,
                                     0.00025598487,
                                     0.00021940157,
                                     0.00035870753,
                                     0.00022818227,
                                     0.0004324874,
                                     0.0004072545,
                                     0.000472917,
                                     0.00042500295,
                                     0.00037882212,
                                     0.00029860588,
                                     0.00019509555,
                                     0.000420639,
                                     0.00030296962,
                                     0.0002644259,
                                     0.00041690844,
                                     0.00019734417,
                                     0.00026838382,
                                     0.00024066768,
                                     0.0003801034,
                                     0.00032007555,
                                     0.0003342018,
                                     0.000241946,
                                     0.0002824686,
                                     0.0002536012,
                                     0.00032358608,
                                     0.00031879445,
                                     0.00032204622,
                                     0.00027726003,
                                     0.00021764262,
                                     0.00023238716,
                                     0.00028017032,
                                     0.0003652072],
                             'rmse': [0.014805581,
                                      0.015999528,
                                      0.014812211,
                                      0.018939575,
                                      0.015105703,
                                      0.02079633,
                                      0.020180548,
                                      0.021746654,
                                      0.0206156,
                                      0.019463353,
                                      0.017280217,
                                      0.013967661,
                                      0.020509485,
                                      0.017406022,
                                      0.016261177,
                                      0.020418337,
                                      0.014047924,
                                      0.016382424,
                                      0.015513468,
                                      0.01949624,
                                      0.017890655,
                                      0.018281186,
                                      0.015554613,
                                      0.016806802,
                                      0.015924862,
                                      0.0179885,
                                      0.017854815,
                                      0.017945647,
                                      0.016651127,
                                      0.014752716,
                                      0.01524425,
                                      0.01673829,
                                      0.019110395]},
 'residuals': {'mae': 0.011891072615981102,
               'mse': 0.0003076513239648193,
               'psnr': 19.578813552856445,
               'rmse': 0.017539992928504944,
               'ssds': [105.69071, 4.0717096],
               'ssim': 0.30121833086013794},
 'spectra_pcagan': {'cosine': [0.99725765,
                               0.9992233,
                               0.9834372,
                               0.99425465,
                               0.9827624,
                               0.99848765,
                               0.9989248,
                               0.9994085,
                               0.981469,
                               0.99462676,
                               0.99689,
                               0.99302953,
                               0.9991747,
                               0.9968077,
                               0.98463,
                               0.9889997,
                               0.99673504,
                               0.9948081,
                               0.9779325,
                               0.9919805,
                               0.95832926,
                               0.97976166,
                               0.9885112,
                               0.97989935,
                               0.98832947,
                               0.99931204,
                               0.98141056,
                               0.99736786,
                               0.98418134,
                               0.9953736,
                               0.995197,
                               0.9983475,
                               0.9996883],
                    'mae': [0.018525504,
                            0.014972381,
                            0.023676462,
                            0.02104073,
                            0.024180004,
                            0.018307822,
                            0.0173349,
                            0.019914033,
                            0.028652215,
                            0.04866026,
                            0.05723419,
                            0.030391596,
                            0.019977484,
                            0.05359211,
                            0.03277437,
                            0.025732458,
                            0.0467463,
                            0.04340962,
                            0.1804025,
                            0.030219821,
                            0.05790215,
                            0.03319256,
                            0.026591174,
                            0.04119151,
                            0.027447106,
                            0.017820148,
                            0.025755536,
                            0.020178251,
                            0.025207091,
                            0.020628918,
                            0.022081137,
                            0.01893478,
                            0.016819995],
                    'max_mae': 0.1804025,
                    'max_mse': 0.035285085,
                    'max_rmse': 0.18784325,
                    'median_mae': 0.025732458,
                    'min_cosine': 0.95832926,
                    'mse': [0.00055675715,
                            0.0003579345,
                            0.00094222603,
                            0.0007552119,
                            0.00097279483,
                            0.0005736651,
                            0.00048468236,
                            0.0005793677,
                            0.0013611908,
                            0.0037065886,
                            0.0054327315,
                            0.0015620226,
                            0.0006220418,
                            0.004233416,
                            0.001753644,
                            0.0011153397,
                            0.0032382912,
                            0.0029479442,
                            0.035285085,
                            0.0017529837,
                            0.0043914295,
                            0.0018896542,
                            0.001201796,
                            0.0025891403,
                            0.0012202929,
                            0.00048150387,
                            0.0011885781,
                            0.0006820388,
                            0.0010312696,
                            0.00068657316,
                            0.0007982622,
                            0.00057677925,
                            0.0004122896],
                    'rmse': [0.023595702,
                             0.018919157,
                             0.030695701,
                             0.02748112,
                             0.03118966,
                             0.023951307,
                             0.022015503,
                             0.024070058,
                             0.036894318,
                             0.06088176,
                             0.07370707,
                             0.03952243,
                             0.024940766,
                             0.065064706,
                             0.041876532,
                             0.033396702,
                             0.056905985,
                             0.054294974,
                             0.18784325,
                             0.04186865,
                             0.06626786,
                             0.04347015,
                             0.03466693,
                             0.050883595,
                             0.03493269,
                             0.021943197,
                             0.034475762,
                             0.026115872,
                             0.032113384,
                             0.02620254,
                             0.028253535,
                             0.02401623,
                             0.020304916]},
 'spectra_realgan': {'cosine': [0.9972508,
                                0.9992217,
                                0.9832243,
                                0.9942407,
                                0.9827068,
                                0.99848765,
                                0.9989239,
                                0.99940866,
                                0.981297,
                                0.9941067,
                                0.9965379,
                                0.99172515,
                                0.99917454,
                                0.99628705,
                                0.98253846,
                                0.98896176,
                                0.9960904,
                                0.9940449,
                                0.9766165,
                                0.9904791,
                                0.95758724,
                                0.9774088,
                                0.98670197,
                                0.97857785,
                                0.9882232,
                                0.99931186,
                                0.9807606,
                                0.99736637,
                                0.9840904,
                                0.9953628,
                                0.9951784,
                                0.99834573,
                                0.9996884],
                     'mae': [0.01854198,
                             0.014985778,
                             0.023866238,
                             0.021071851,
                             0.024249308,
                             0.018311145,
                             0.017341811,
                             0.019904904,
                             0.028784158,
                             0.050913114,
                             0.059168078,
                             0.03345968,
                             0.019981595,
                             0.055011444,
                             0.03497756,
                             0.025771726,
                             0.048374493,
                             0.04506426,
                             0.18023531,
                             0.033359133,
                             0.05806259,
                             0.03555152,
                             0.02864439,
                             0.04216679,
                             0.02758377,
                             0.017824937,
                             0.026277814,
                             0.02017742,
                             0.02529138,
                             0.020647043,
                             0.022136098,
                             0.018928431,
                             0.016816907],
                     'max_mae': 0.18023531,
                     'max_mse': 0.035449803,
                     'max_rmse': 0.18828118,
                     'median_mae': 0.025771726,
                     'min_cosine': 0.95758724,
                     'mse': [0.00055797707,
                             0.00035868314,
                             0.00095437886,
                             0.0007570537,
                             0.0009759421,
                             0.0005737491,
                             0.00048503513,
                             0.0005789536,
                             0.0013730456,
                             0.004070556,
                             0.0057761464,
                             0.0018476741,
                             0.0006221682,
                             0.0045668185,
                             0.0019810996,
                             0.0011185808,
                             0.0035820708,
                             0.0032059634,
                             0.035449803,
                             0.0020360278,
                             0.004457984,
                             0.0021198776,
                             0.0013743723,
                             0.0027345,
                             0.0012311836,
                             0.00048168088,
                             0.0012288577,
                             0.0006819425,
                             0.0010366923,
                             0.0006882518,
                             0.0008001526,
                             0.0005767722,
                             0.0004122014],
                     'rmse': [0.023621539,
                              0.018938933,
                              0.030893022,
                              0.027514609,
                              0.031240072,
                              0.02395306,
                              0.022023514,
                              0.024061454,
                              0.03705463,
                              0.06380091,
                              0.076000966,
                              0.04298458,
                              0.0249433,
                              0.06757824,
                              0.044509545,
                              0.03344519,
                              0.059850402,
                              0.056621227,
                              0.18828118,
                              0.045122366,
                              0.06676814,
                              0.04604213,
                              0.03707253,
                              0.052292448,
                              0.035088226,
                              0.02194723,
                              0.035055067,
                              0.026114028,
                              0.032197706,
                              0.026234554,
                              0.02828697,
                              0.024016082,
                              0.020302743]},
 'spectra_realpca': {'cosine': [0.99999696,
                                0.99999934,
                                0.9997846,
                                0.9999912,
                                0.9999335,
                                0.99999946,
                                0.99999917,
                                1.0,
                                0.9998748,
                                0.9994344,
                                0.9996437,
                                0.9986659,
                                0.9999998,
                                0.9994866,
                                0.99798936,
                                0.9999893,
                                0.99936277,
                                0.9991723,
                                0.99854934,
                                0.9985071,
                                0.99897516,
                                0.99793917,
                                0.99813783,
                                0.9985657,
                                0.99995846,
                                0.99999994,
                                0.9994442,
                                0.9999965,
                                0.9999077,
                                0.9999903,
                                0.9999818,
                                0.99999905,
                                0.9999999],
                     'mae': [0.0006051452,
                             0.0004080574,
                             0.0027339973,
                             0.00084863644,
                             0.0015256662,
                             0.00034766312,
                             0.00042513714,
                             0.00013267116,
                             0.0023799965,
                             0.015630957,
                             0.016662214,
                             0.013562525,
                             0.00020996254,
                             0.015513202,
                             0.011829725,
                             0.0008207076,
                             0.015275073,
                             0.014977359,
                             0.013207196,
                             0.013487489,
                             0.0074121132,
                             0.010886119,
                             0.010570929,
                             0.009685269,
                             0.0015304482,
                             0.00018514339,
                             0.004497952,
                             0.0007000246,
                             0.0018514598,
                             0.0009373536,
                             0.0012061138,
                             0.00042791787,
                             0.00012955928],
                     'max_mae': 0.016662214,
                     'max_mse': 0.0004462989,
                     'max_rmse': 0.021125788,
                     'median_mae': 0.0018514598,
                     'min_cosine': 0.99793917,
                     'mse': [6.057438e-07,
                             2.67317e-07,
                             1.2065431e-05,
                             1.1665585e-06,
                             3.7220843e-06,
                             1.9461848e-07,
                             2.9037116e-07,
                             2.8210172e-08,
                             9.101195e-06,
                             0.0003914494,
                             0.0004462989,
                             0.00029418038,
                             7.0102956e-08,
                             0.0003879158,
                             0.00022395262,
                             1.0803329e-06,
                             0.00037220205,
                             0.00036039334,
                             0.0003034708,
                             0.00029072753,
                             8.970343e-05,
                             0.00019232991,
                             0.00017806335,
                             0.00015195375,
                             3.853383e-06,
                             5.5508337e-08,
                             3.3220105e-05,
                             7.891484e-07,
                             5.536997e-06,
                             1.435603e-06,
                             2.345312e-06,
                             2.960195e-07,
                             2.6589941e-08],
                     'rmse': [0.00077829545,
                              0.0005170271,
                              0.003473533,
                              0.0010800734,
                              0.0019292705,
                              0.00044115583,
                              0.000538861,
                              0.00016795885,
                              0.0030168188,
                              0.01978508,
                              0.021125788,
                              0.017151687,
                              0.00026476962,
                              0.019695578,
                              0.014965047,
                              0.0010393907,
                              0.019292539,
                              0.01898403,
                              0.017420413,
                              0.017050734,
                              0.009471189,
                              0.013868306,
                              0.013344038,
                              0.012326952,
                              0.0019630035,
                              0.00023560207,
                              0.0057636886,
                              0.00088834023,
                              0.0023530824,
                              0.0011981665,
                              0.0015314411,
                              0.0005440767,
                              0.00016306422]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_90.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516
Directory path: experiments/inpainting/gann_4_night_20180722_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_90.0/images
Optimal number of principal components:  20
Reconstruction error:  9.930856
Energy conservation:  0.9019629
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_90.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.35918432275619, 2.6615294098527165],
                   'kl_div': 1.2771329,
                   'ks_tests': {10000: KstestResult(statistic=0.3543, pvalue=0.0, statistic_location=0.0057278774, statistic_sign=1),
                                20000: KstestResult(statistic=0.35835000000000006, pvalue=0.0, statistic_location=0.005872218, statistic_sign=1),
                                30000: KstestResult(statistic=0.3579333333333333, pvalue=0.0, statistic_location=0.0056162756, statistic_sign=1),
                                40000: KstestResult(statistic=0.35897500000000004, pvalue=0.0, statistic_location=0.0062691383, statistic_sign=1),
                                50000: KstestResult(statistic=0.358, pvalue=0.0, statistic_location=0.0059798975, statistic_sign=1),
                                60000: KstestResult(statistic=0.35901666666666665, pvalue=0.0, statistic_location=0.0058462583, statistic_sign=1),
                                70000: KstestResult(statistic=0.36115714285714284, pvalue=0.0, statistic_location=0.0058461847, statistic_sign=1),
                                80000: KstestResult(statistic=0.35591249999999997, pvalue=0.0, statistic_location=0.005843185, statistic_sign=1),
                                90000: KstestResult(statistic=0.3581444444444444, pvalue=0.0, statistic_location=0.0057459846, statistic_sign=1),
                                100000: KstestResult(statistic=0.36087, pvalue=0.0, statistic_location=0.005847851, statistic_sign=1),
                                110000: KstestResult(statistic=0.3598636363636363, pvalue=0.0, statistic_location=0.0057994686, statistic_sign=1)},
                   'moments': {'mean_error': -0.040015627,
                               'means': [-0.00073593855, -2.9290446e-05],
                               'stds': [0.022726193, 0.0035580473],
                               'variance_ratio': 21.152498}},
 'originals': {'gan': {'mae': 0.05885758250951767,
                       'mse': 0.005448393989354372,
                       'psnr': 27.10418128967285,
                       'rmse': 0.07381323724985123,
                       'ssim': 0.603545069694519},
               'pca': {'mae': 0.008420856669545174,
                       'mse': 0.00014214959810487926,
                       'psnr': 43.48847579956055,
                       'rmse': 0.011922650970518589,
                       'ssim': 0.9960849285125732}},
 'reconstructions': {'mae': 0.05816012620925903,
                     'mse': 0.0053002918139100075,
                     'psnr': 27.772933959960938,
                     'rmse': 0.07280310243368149,
                     'ssim': 0.6021296977996826},
 'residual_spectra_pcagan': {'cosine': [0.24981573,
                                        0.19937791,
                                        0.21357803,
                                        0.23725793,
                                        0.08941353,
                                        0.094465934,
                                        0.05456174,
                                        0.11327079,
                                        0.10800146,
                                        0.087503485,
                                        0.15207553],
                             'mae': [0.01501684,
                                     0.017235236,
                                     0.017183686,
                                     0.016266743,
                                     0.015446146,
                                     0.01540184,
                                     0.014021335,
                                     0.018665286,
                                     0.020384403,
                                     0.01931123,
                                     0.0172415],
                             'max_mae': 0.020384403,
                             'max_mse': 0.0006531021,
                             'max_rmse': 0.025555862,
                             'median_distance': 2.2556758,
                             'median_mae': 0.017183686,
                             'min_cosine': 0.05456174,
                             'mse': [0.00039039986,
                                     0.0006205816,
                                     0.0005124239,
                                     0.00042212562,
                                     0.0005088073,
                                     0.00040572538,
                                     0.00038844315,
                                     0.00055886665,
                                     0.0006531021,
                                     0.00059142715,
                                     0.0004956022],
                             'rmse': [0.01975854,
                                      0.024911476,
                                      0.022636782,
                                      0.020545697,
                                      0.022556758,
                                      0.020142626,
                                      0.019708961,
                                      0.02364036,
                                      0.025555862,
                                      0.024319274,
                                      0.022262124]},
 'residuals': {'mae': 0.016924932599067688,
               'mse': 0.0005043186247348785,
               'psnr': 6.539820194244385,
               'rmse': 0.02245703898370266,
               'ssds': [56.87184, 1.3926488],
               'ssim': 0.11246709525585175},
 'spectra_pcagan': {'cosine': [0.9910371,
                               0.98400444,
                               0.96031266,
                               0.9504724,
                               0.9528177,
                               0.9701105,
                               0.9728121,
                               0.9370892,
                               0.9138459,
                               0.914885,
                               0.92368513],
                    'mae': [0.07156296,
                            0.07278915,
                            0.06264651,
                            0.06530079,
                            0.046365704,
                            0.044131886,
                            0.040961858,
                            0.055675812,
                            0.06334904,
                            0.060704503,
                            0.05627312],
                    'max_mae': 0.07278915,
                    'max_mse': 0.008047117,
                    'max_rmse': 0.08970572,
                    'median_mae': 0.060704503,
                    'min_cosine': 0.9138459,
                    'mse': [0.007594655,
                            0.008047117,
                            0.005732658,
                            0.006563067,
                            0.0033231105,
                            0.0029922803,
                            0.0027176829,
                            0.0046475385,
                            0.0061204266,
                            0.005537481,
                            0.005027191],
                    'rmse': [0.08714732,
                             0.08970572,
                             0.07571432,
                             0.081012756,
                             0.057646427,
                             0.054701738,
                             0.0521314,
                             0.06817286,
                             0.07823315,
                             0.07441425,
                             0.07090268]},
 'spectra_realgan': {'cosine': [0.99050224,
                                0.98320454,
                                0.958425,
                                0.9485156,
                                0.95228004,
                                0.96986884,
                                0.97265184,
                                0.9365318,
                                0.912984,
                                0.91408354,
                                0.92231876],
                     'mae': [0.073525995,
                             0.07423982,
                             0.06392931,
                             0.066407725,
                             0.046533234,
                             0.044256676,
                             0.041072655,
                             0.05594315,
                             0.06368616,
                             0.06099438,
                             0.056844275],
                     'max_mae': 0.07423982,
                     'max_mse': 0.00842498,
                     'max_rmse': 0.09178769,
                     'median_mae': 0.06099438,
                     'min_cosine': 0.912984,
                     'mse': [0.008046477,
                             0.00842498,
                             0.0059988564,
                             0.0067990287,
                             0.0033501007,
                             0.0030101966,
                             0.0027172633,
                             0.004679983,
                             0.006192801,
                             0.005587246,
                             0.0051254076],
                     'rmse': [0.08970216,
                              0.09178769,
                              0.07745229,
                              0.08245622,
                              0.057880055,
                              0.05486526,
                              0.052127376,
                              0.068410404,
                              0.07869435,
                              0.07474788,
                              0.07159195]},
 'spectra_realpca': {'cosine': [0.9995573,
                                0.99935913,
                                0.9982099,
                                0.9977519,
                                0.9992372,
                                0.9997916,
                                0.99979126,
                                0.9992288,
                                0.99939203,
                                0.9991067,
                                0.998748],
                     'mae': [0.015227784,
                             0.014211556,
                             0.012728964,
                             0.012758763,
                             0.0057640476,
                             0.0036172157,
                             0.0035028004,
                             0.006083902,
                             0.005301728,
                             0.006149457,
                             0.007283194],
                     'max_mae': 0.015227784,
                     'max_mse': 0.00037394825,
                     'max_rmse': 0.019337742,
                     'median_mae': 0.006149457,
                     'min_cosine': 0.9977519,
                     'mse': [0.00037394825,
                             0.0003239067,
                             0.00026210546,
                             0.00026054378,
                             5.2714164e-05,
                             2.1091626e-05,
                             1.9562438e-05,
                             5.8733887e-05,
                             4.512433e-05,
                             6.0498303e-05,
                             8.541654e-05],
                     'rmse': [0.019337742,
                              0.017997408,
                              0.016189672,
                              0.016141368,
                              0.007260452,
                              0.004592562,
                              0.0044229445,
                              0.0076638036,
                              0.0067174644,
                              0.0077780657,
                              0.009242107]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_90.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115
Directory path: experiments/inpainting/gann_4_night_20180722_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_90.0/images
Optimal number of principal components:  20
Reconstruction error:  9.930856
Energy conservation:  0.9019629
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_90.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.22363691969865, 2.7678880923002183],
                   'kl_div': 0.9355464,
                   'ks_tests': {10000: KstestResult(statistic=0.3121, pvalue=1e-323, statistic_location=0.0062789777, statistic_sign=1),
                                20000: KstestResult(statistic=0.3006, pvalue=0.0, statistic_location=0.0056819483, statistic_sign=1),
                                30000: KstestResult(statistic=0.3072666666666667, pvalue=0.0, statistic_location=0.005684643, statistic_sign=1),
                                40000: KstestResult(statistic=0.30990000000000006, pvalue=0.0, statistic_location=0.006302865, statistic_sign=1),
                                50000: KstestResult(statistic=0.30854000000000004, pvalue=0.0, statistic_location=0.0059257383, statistic_sign=1),
                                60000: KstestResult(statistic=0.3063166666666667, pvalue=0.0, statistic_location=0.0058455835, statistic_sign=1),
                                70000: KstestResult(statistic=0.3034428571428571, pvalue=0.0, statistic_location=0.0057669072, statistic_sign=1),
                                80000: KstestResult(statistic=0.304825, pvalue=0.0, statistic_location=0.0057639857, statistic_sign=1),
                                90000: KstestResult(statistic=0.30843333333333334, pvalue=0.0, statistic_location=0.0064001423, statistic_sign=1),
                                100000: KstestResult(statistic=0.3064800000000001, pvalue=0.0, statistic_location=0.0061988775, statistic_sign=1),
                                110000: KstestResult(statistic=0.30698181818181824, pvalue=0.0, statistic_location=0.0056992397, statistic_sign=1),
                                120000: KstestResult(statistic=0.30375833333333335, pvalue=0.0, statistic_location=0.0058739, statistic_sign=1),
                                130000: KstestResult(statistic=0.3051307692307693, pvalue=0.0, statistic_location=0.005817311, statistic_sign=1),
                                140000: KstestResult(statistic=0.3045214285714285, pvalue=0.0, statistic_location=0.0062393267, statistic_sign=1),
                                150000: KstestResult(statistic=0.30676666666666663, pvalue=0.0, statistic_location=0.005970442, statistic_sign=1),
                                160000: KstestResult(statistic=0.3061062499999999, pvalue=0.0, statistic_location=0.0059204465, statistic_sign=1),
                                170000: KstestResult(statistic=0.3058352941176471, pvalue=0.0, statistic_location=0.0059507224, statistic_sign=1),
                                180000: KstestResult(statistic=0.3038222222222222, pvalue=0.0, statistic_location=0.0062771533, statistic_sign=1),
                                190000: KstestResult(statistic=0.3044526315789474, pvalue=0.0, statistic_location=0.0062506837, statistic_sign=1),
                                200000: KstestResult(statistic=0.30540500000000004, pvalue=0.0, statistic_location=0.006195404, statistic_sign=1),
                                210000: KstestResult(statistic=0.30642380952380954, pvalue=0.0, statistic_location=0.006205566, statistic_sign=1),
                                220000: KstestResult(statistic=0.30366363636363636, pvalue=0.0, statistic_location=0.005945095, statistic_sign=1)},
                   'moments': {'mean_error': -0.030108154,
                               'means': [-0.00054423965, 2.4385776e-05],
                               'stds': [0.019667108, 0.0039322637],
                               'variance_ratio': 16.993137}},
 'originals': {'gan': {'mae': 0.05455929413437843,
                       'mse': 0.004739472642540932,
                       'psnr': 27.725784301757812,
                       'rmse': 0.06884382665157318,
                       'ssim': 0.6566916704177856},
               'pca': {'mae': 0.00940893217921257,
                       'mse': 0.00016802789468783885,
                       'psnr': 42.76211929321289,
                       'rmse': 0.01296255737543106,
                       'ssim': 0.9927327036857605}},
 'reconstructions': {'mae': 0.05359240993857384,
                     'mse': 0.00456907507032156,
                     'psnr': 28.417648315429688,
                     'rmse': 0.06759493052959442,
                     'ssim': 0.6574973464012146},
 'residual_spectra_pcagan': {'cosine': [0.27656484,
                                        0.25196144,
                                        0.26309448,
                                        0.29140064,
                                        0.2273664,
                                        0.27523187,
                                        0.21835276,
                                        0.24079123,
                                        0.2698506,
                                        0.10258269,
                                        0.10230314,
                                        0.06010842,
                                        0.1262466,
                                        0.121244624,
                                        0.09954887,
                                        0.16663842,
                                        0.22229941,
                                        0.10519008,
                                        0.26980466,
                                        0.118442215,
                                        0.09655596,
                                        0.24141513],
                             'mae': [0.010582987,
                                     0.010845817,
                                     0.01015214,
                                     0.010470364,
                                     0.01287174,
                                     0.012971588,
                                     0.015296069,
                                     0.014983673,
                                     0.013998761,
                                     0.01364184,
                                     0.013705133,
                                     0.012673079,
                                     0.01656001,
                                     0.01824531,
                                     0.017021148,
                                     0.015617495,
                                     0.016140057,
                                     0.014409764,
                                     0.014022244,
                                     0.01318411,
                                     0.016844928,
                                     0.013123725],
                             'max_mae': 0.01824531,
                             'max_mse': 0.0005285116,
                             'max_rmse': 0.02298938,
                             'median_distance': 1.8268571,
                             'median_mae': 0.013851947,
                             'min_cosine': 0.06010842,
                             'mse': [0.00026021682,
                                     0.00030579887,
                                     0.00030232608,
                                     0.00024439546,
                                     0.0003315367,
                                     0.00030680298,
                                     0.0005074859,
                                     0.00039958724,
                                     0.00032616683,
                                     0.00041773327,
                                     0.00032556514,
                                     0.0003263658,
                                     0.0004573427,
                                     0.0005285116,
                                     0.00047097701,
                                     0.00041964394,
                                     0.0004210101,
                                     0.00038129668,
                                     0.0003278676,
                                     0.00032189995,
                                     0.00047117262,
                                     0.000335952],
                             'rmse': [0.016131237,
                                      0.017487105,
                                      0.017387526,
                                      0.015633153,
                                      0.01820815,
                                      0.017515792,
                                      0.022527447,
                                      0.019989679,
                                      0.01806009,
                                      0.020438524,
                                      0.018043423,
                                      0.018065598,
                                      0.021385573,
                                      0.02298938,
                                      0.021702005,
                                      0.020485213,
                                      0.02051853,
                                      0.019526819,
                                      0.018107114,
                                      0.01794157,
                                      0.02170651,
                                      0.018328993]},
 'residuals': {'mae': 0.013970999047160149,
               'mse': 0.00037225705455057323,
               'psnr': 9.023463249206543,
               'rmse': 0.01929396390914917,
               'ssds': [85.1597, 3.4019094],
               'ssim': 0.15437428653240204},
 'spectra_pcagan': {'cosine': [0.99041253,
                               0.9905904,
                               0.9859928,
                               0.9812935,
                               0.9847747,
                               0.99121267,
                               0.98440176,
                               0.9612975,
                               0.95195645,
                               0.9536657,
                               0.9708795,
                               0.97348535,
                               0.93882525,
                               0.914917,
                               0.9161123,
                               0.92354184,
                               0.9031825,
                               0.95888686,
                               0.94575053,
                               0.9613709,
                               0.9257291,
                               0.9548242],
                    'mae': [0.04911027,
                            0.048549864,
                            0.04225131,
                            0.039026015,
                            0.05695127,
                            0.070719086,
                            0.07169239,
                            0.061891057,
                            0.06396928,
                            0.04586533,
                            0.04370682,
                            0.0405,
                            0.054816864,
                            0.062978916,
                            0.060124133,
                            0.056312036,
                            0.062558725,
                            0.046210933,
                            0.052498274,
                            0.043443095,
                            0.059331886,
                            0.046525385],
                    'max_mae': 0.07169239,
                    'max_mse': 0.007863977,
                    'max_rmse': 0.08867907,
                    'median_mae': 0.05365757,
                    'min_cosine': 0.9031825,
                    'mse': [0.0039278334,
                            0.0040523037,
                            0.0029530805,
                            0.0024239253,
                            0.004800481,
                            0.007433258,
                            0.007863977,
                            0.005606246,
                            0.006321871,
                            0.0032882462,
                            0.0029262016,
                            0.002685652,
                            0.0045200665,
                            0.006055668,
                            0.005463182,
                            0.0050402037,
                            0.0061950693,
                            0.0032923843,
                            0.0040150527,
                            0.0030468309,
                            0.0053800414,
                            0.00322808],
                    'rmse': [0.06267243,
                             0.06365771,
                             0.05434225,
                             0.049233377,
                             0.069285505,
                             0.086216345,
                             0.08867907,
                             0.07487487,
                             0.0795102,
                             0.057343233,
                             0.054094378,
                             0.051823277,
                             0.06723144,
                             0.07781817,
                             0.07391334,
                             0.07099439,
                             0.07870876,
                             0.0573793,
                             0.063364446,
                             0.055198107,
                             0.07334877,
                             0.056816194]},
 'spectra_realgan': {'cosine': [0.9896691,
                                0.9898579,
                                0.98456603,
                                0.9791487,
                                0.983875,
                                0.9906742,
                                0.9836056,
                                0.95940924,
                                0.950004,
                                0.9531188,
                                0.9706316,
                                0.9733282,
                                0.93827266,
                                0.91403544,
                                0.91530865,
                                0.92216086,
                                0.9011053,
                                0.9585088,
                                0.94279194,
                                0.9608301,
                                0.92520034,
                                0.95235986],
                     'mae': [0.05091956,
                             0.05065085,
                             0.044404034,
                             0.041118804,
                             0.058669947,
                             0.07273627,
                             0.07316233,
                             0.063168325,
                             0.06512662,
                             0.046040375,
                             0.04382759,
                             0.040590435,
                             0.05506352,
                             0.06331624,
                             0.060418434,
                             0.056880366,
                             0.06340985,
                             0.046374947,
                             0.05363102,
                             0.043673262,
                             0.059573457,
                             0.04754814],
                     'max_mae': 0.07316233,
                     'max_mse': 0.008238449,
                     'max_rmse': 0.0907659,
                     'median_mae': 0.05434727,
                     'min_cosine': 0.9011053,
                     'mse': [0.0042169,
                             0.00437998,
                             0.003240988,
                             0.0026799885,
                             0.0051155905,
                             0.007887149,
                             0.008238449,
                             0.005872001,
                             0.006557111,
                             0.0033155568,
                             0.0029443847,
                             0.0026845408,
                             0.004551976,
                             0.006129314,
                             0.005513082,
                             0.0051394324,
                             0.0063526644,
                             0.0033178928,
                             0.004240858,
                             0.0030703791,
                             0.005419961,
                             0.0034001968],
                     'rmse': [0.064937666,
                              0.066181414,
                              0.056929674,
                              0.051768605,
                              0.07152335,
                              0.088809624,
                              0.0907659,
                              0.07662898,
                              0.080975994,
                              0.057580873,
                              0.054262184,
                              0.051812556,
                              0.06746833,
                              0.07828993,
                              0.07425013,
                              0.07168984,
                              0.07970361,
                              0.057601154,
                              0.06512187,
                              0.055411004,
                              0.07362039,
                              0.058311205]},
 'spectra_realpca': {'cosine': [0.99919015,
                                0.99927974,
                                0.99849164,
                                0.9977191,
                                0.999035,
                                0.9995573,
                                0.99935913,
                                0.9982099,
                                0.9977519,
                                0.9992372,
                                0.9997916,
                                0.99979126,
                                0.9992288,
                                0.99939203,
                                0.9991067,
                                0.998748,
                                0.9973434,
                                0.9995581,
                                0.9975727,
                                0.99948865,
                                0.9995264,
                                0.99721843],
                     'mae': [0.014189024,
                             0.013958995,
                             0.013071115,
                             0.012636413,
                             0.013930626,
                             0.015227784,
                             0.014211556,
                             0.012728964,
                             0.012758763,
                             0.0057640476,
                             0.0036172157,
                             0.0035028004,
                             0.006083902,
                             0.005301728,
                             0.006149457,
                             0.007283194,
                             0.010575026,
                             0.004721566,
                             0.010749927,
                             0.004920615,
                             0.004676001,
                             0.010937772],
                     'max_mae': 0.015227784,
                     'max_mse': 0.00037394825,
                     'max_rmse': 0.019337742,
                     'median_mae': 0.0106624765,
                     'min_cosine': 0.99721843,
                     'mse': [0.0003221521,
                             0.0003122406,
                             0.00027347737,
                             0.0002525805,
                             0.00030932605,
                             0.00037394825,
                             0.0003239067,
                             0.00026210546,
                             0.00026054378,
                             5.2714164e-05,
                             2.1091626e-05,
                             1.9562438e-05,
                             5.8733887e-05,
                             4.512433e-05,
                             6.0498303e-05,
                             8.541654e-05,
                             0.00017901142,
                             3.5609813e-05,
                             0.00018368005,
                             3.8391925e-05,
                             3.5182125e-05,
                             0.00019131646],
                     'rmse': [0.017948596,
                              0.017670332,
                              0.016537152,
                              0.015892781,
                              0.017587667,
                              0.019337742,
                              0.017997408,
                              0.016189672,
                              0.016141368,
                              0.007260452,
                              0.004592562,
                              0.0044229445,
                              0.0076638036,
                              0.0067174644,
                              0.0077780657,
                              0.009242107,
                              0.013379515,
                              0.005967396,
                              0.013552861,
                              0.0061961217,
                              0.0059314524,
                              0.01383172]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_90.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453
Directory path: experiments/inpainting/gann_4_night_20180722_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_90.0/images
Optimal number of principal components:  20
Reconstruction error:  9.930856
Energy conservation:  0.9019629
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_90.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.111089078084709, 2.827902384512984],
                   'kl_div': 0.7270256,
                   'ks_tests': {10000: KstestResult(statistic=0.2567, pvalue=8.111959343525273e-290, statistic_location=0.0063603353, statistic_sign=1),
                                20000: KstestResult(statistic=0.26449999999999996, pvalue=0.0, statistic_location=0.0065039834, statistic_sign=1),
                                30000: KstestResult(statistic=0.2658666666666667, pvalue=0.0, statistic_location=0.006170338, statistic_sign=1),
                                40000: KstestResult(statistic=0.26707500000000006, pvalue=0.0, statistic_location=0.0057493215, statistic_sign=1),
                                50000: KstestResult(statistic=0.26426000000000005, pvalue=0.0, statistic_location=0.0062299417, statistic_sign=1),
                                60000: KstestResult(statistic=0.2670166666666667, pvalue=0.0, statistic_location=0.006053636, statistic_sign=1),
                                70000: KstestResult(statistic=0.2636857142857143, pvalue=0.0, statistic_location=0.006513774, statistic_sign=1),
                                80000: KstestResult(statistic=0.26193750000000005, pvalue=0.0, statistic_location=0.006026064, statistic_sign=1),
                                90000: KstestResult(statistic=0.2642555555555556, pvalue=0.0, statistic_location=0.0057550976, statistic_sign=1),
                                100000: KstestResult(statistic=0.26291, pvalue=0.0, statistic_location=0.005962454, statistic_sign=1),
                                110000: KstestResult(statistic=0.26420909090909095, pvalue=0.0, statistic_location=0.0059998245, statistic_sign=1),
                                120000: KstestResult(statistic=0.263575, pvalue=0.0, statistic_location=0.0060236445, statistic_sign=1),
                                130000: KstestResult(statistic=0.2651, pvalue=0.0, statistic_location=0.0059547136, statistic_sign=1),
                                140000: KstestResult(statistic=0.26272142857142855, pvalue=0.0, statistic_location=0.0060012112, statistic_sign=1),
                                150000: KstestResult(statistic=0.26426000000000005, pvalue=0.0, statistic_location=0.0060158344, statistic_sign=1),
                                160000: KstestResult(statistic=0.2623000000000001, pvalue=0.0, statistic_location=0.006026064, statistic_sign=1),
                                170000: KstestResult(statistic=0.26350588235294115, pvalue=0.0, statistic_location=0.006016645, statistic_sign=1),
                                180000: KstestResult(statistic=0.2624388888888889, pvalue=0.0, statistic_location=0.005954075, statistic_sign=1),
                                190000: KstestResult(statistic=0.26341052631578954, pvalue=0.0, statistic_location=0.005962035, statistic_sign=1),
                                200000: KstestResult(statistic=0.26458000000000004, pvalue=0.0, statistic_location=0.006053636, statistic_sign=1),
                                210000: KstestResult(statistic=0.26180000000000003, pvalue=0.0, statistic_location=0.005906161, statistic_sign=1),
                                220000: KstestResult(statistic=0.26353181818181826, pvalue=0.0, statistic_location=0.0059586507, statistic_sign=1),
                                230000: KstestResult(statistic=0.2627173913043478, pvalue=0.0, statistic_location=0.0061487844, statistic_sign=1),
                                240000: KstestResult(statistic=0.2620916666666666, pvalue=0.0, statistic_location=0.0060237516, statistic_sign=1),
                                250000: KstestResult(statistic=0.26339599999999996, pvalue=0.0, statistic_location=0.0060236445, statistic_sign=1),
                                260000: KstestResult(statistic=0.26343076923076925, pvalue=0.0, statistic_location=0.006026064, statistic_sign=1),
                                270000: KstestResult(statistic=0.2639962962962963, pvalue=0.0, statistic_location=0.005952205, statistic_sign=1),
                                280000: KstestResult(statistic=0.26553214285714277, pvalue=0.0, statistic_location=0.0060165627, statistic_sign=1),
                                290000: KstestResult(statistic=0.26332758620689656, pvalue=0.0, statistic_location=0.006048955, statistic_sign=1),
                                300000: KstestResult(statistic=0.2641800000000001, pvalue=0.0, statistic_location=0.0061487625, statistic_sign=1),
                                310000: KstestResult(statistic=0.26264193548387094, pvalue=0.0, statistic_location=0.006214937, statistic_sign=1),
                                320000: KstestResult(statistic=0.263096875, pvalue=0.0, statistic_location=0.0061531244, statistic_sign=1),
                                330000: KstestResult(statistic=0.2610060606060606, pvalue=0.0, statistic_location=0.006154172, statistic_sign=1)},
                   'moments': {'mean_error': -0.023850758,
                               'means': [-0.00039863147, 6.216846e-06],
                               'stds': [0.017679268, 0.0041603833],
                               'variance_ratio': 14.693737}},
 'originals': {'gan': {'mae': 0.05171003192663193,
                       'mse': 0.004362098407000303,
                       'psnr': 28.81952667236328,
                       'rmse': 0.06604618579149246,
                       'ssim': 0.7228677272796631},
               'pca': {'mae': 0.010501480661332607,
                       'mse': 0.0002055773657048121,
                       'psnr': 42.33768844604492,
                       'rmse': 0.01433796901255846,
                       'ssim': 0.9921489357948303}},
 'reconstructions': {'mae': 0.050358906388282776,
                     'mse': 0.004151889123022556,
                     'psnr': 29.284984588623047,
                     'rmse': 0.06443515419960022,
                     'ssim': 0.7257400155067444},
 'residual_spectra_pcagan': {'cosine': [0.04890263,
                                        0.24554005,
                                        0.33591232,
                                        0.2809708,
                                        0.3097882,
                                        0.2687382,
                                        0.2871518,
                                        0.26107624,
                                        0.29458904,
                                        0.3094141,
                                        0.23018384,
                                        0.28929707,
                                        0.23295434,
                                        0.26200625,
                                        0.289649,
                                        0.112814754,
                                        0.109777026,
                                        0.07061071,
                                        0.13779847,
                                        0.12723319,
                                        0.112857476,
                                        0.17369641,
                                        0.2347337,
                                        0.1166974,
                                        0.2891831,
                                        0.13235186,
                                        0.10379229,
                                        0.25525865,
                                        0.32667053,
                                        0.3204204,
                                        0.29870626,
                                        0.31736946,
                                        0.27660832],
                             'mae': [0.011712842,
                                     0.011480276,
                                     0.009097847,
                                     0.009463763,
                                     0.009218969,
                                     0.010487369,
                                     0.010003618,
                                     0.010451391,
                                     0.009500116,
                                     0.010210183,
                                     0.012334123,
                                     0.01205076,
                                     0.014295416,
                                     0.013956967,
                                     0.012826968,
                                     0.01272309,
                                     0.012671445,
                                     0.012039641,
                                     0.015470999,
                                     0.017016508,
                                     0.015690137,
                                     0.014677573,
                                     0.014827182,
                                     0.013447004,
                                     0.012976042,
                                     0.012134561,
                                     0.015567268,
                                     0.012371036,
                                     0.00939393,
                                     0.009722893,
                                     0.009315867,
                                     0.009504681,
                                     0.0111153135],
                             'max_mae': 0.017016508,
                             'max_mse': 0.00046273178,
                             'max_rmse': 0.0215112,
                             'median_distance': 1.6833725,
                             'median_mae': 0.01205076,
                             'min_cosine': 0.04890263,
                             'mse': [0.00024789886,
                                     0.00031395582,
                                     0.00018797148,
                                     0.00024140837,
                                     0.00018910062,
                                     0.00030089135,
                                     0.00024284089,
                                     0.00028572328,
                                     0.00024183698,
                                     0.0002180811,
                                     0.00032273054,
                                     0.00026620674,
                                     0.00044063243,
                                     0.00034564105,
                                     0.0002814743,
                                     0.000354667,
                                     0.000279095,
                                     0.00028337433,
                                     0.00041084498,
                                     0.00046273178,
                                     0.00039999333,
                                     0.00038547767,
                                     0.00036416593,
                                     0.0003333897,
                                     0.00028290512,
                                     0.00026972656,
                                     0.0004030892,
                                     0.0002963186,
                                     0.00019038653,
                                     0.00019041332,
                                     0.00021118377,
                                     0.00022440705,
                                     0.0002985708],
                             'rmse': [0.015744803,
                                      0.0177188,
                                      0.01371027,
                                      0.015537322,
                                      0.013751387,
                                      0.01734622,
                                      0.015583353,
                                      0.01690335,
                                      0.015551109,
                                      0.0147675695,
                                      0.017964702,
                                      0.016315844,
                                      0.020991247,
                                      0.018591424,
                                      0.016777195,
                                      0.018832605,
                                      0.016706137,
                                      0.016833726,
                                      0.020269312,
                                      0.0215112,
                                      0.019999834,
                                      0.019633586,
                                      0.019083131,
                                      0.018258963,
                                      0.016819784,
                                      0.016423354,
                                      0.020077081,
                                      0.017213907,
                                      0.013798063,
                                      0.013799033,
                                      0.014532163,
                                      0.014980222,
                                      0.017279202]},
 'residuals': {'mae': 0.01205320842564106,
               'mse': 0.0002959738194476813,
               'psnr': 10.01935863494873,
               'rmse': 0.017203889787197113,
               'ssds': [103.19576, 5.7118964],
               'ssim': 0.20344172418117523},
 'spectra_pcagan': {'cosine': [0.9959621,
                               0.9942651,
                               0.9956203,
                               0.9947026,
                               0.9958621,
                               0.9942082,
                               0.9904308,
                               0.9903279,
                               0.9854872,
                               0.9802056,
                               0.9842756,
                               0.9909305,
                               0.9840699,
                               0.9606678,
                               0.95262057,
                               0.95370746,
                               0.9712683,
                               0.973617,
                               0.9388463,
                               0.9163896,
                               0.9168068,
                               0.9244226,
                               0.9042608,
                               0.95963734,
                               0.94690365,
                               0.9621216,
                               0.92668974,
                               0.9546885,
                               0.97383946,
                               0.9763418,
                               0.987135,
                               0.9875779,
                               0.9894034],
                    'mae': [0.030121997,
                            0.041531708,
                            0.049207367,
                            0.04921864,
                            0.05626798,
                            0.061648723,
                            0.049147785,
                            0.049275994,
                            0.0431799,
                            0.04030705,
                            0.057755273,
                            0.07163169,
                            0.07233381,
                            0.062424254,
                            0.06322402,
                            0.04584976,
                            0.043341693,
                            0.040688515,
                            0.05471929,
                            0.062468965,
                            0.05996623,
                            0.055811796,
                            0.062111802,
                            0.04589357,
                            0.05209911,
                            0.043246996,
                            0.058965784,
                            0.046778645,
                            0.039223906,
                            0.035467226,
                            0.036958802,
                            0.039568093,
                            0.041407738],
                    'max_mae': 0.07233381,
                    'max_mse': 0.008034137,
                    'max_rmse': 0.089633346,
                    'median_mae': 0.049207367,
                    'min_cosine': 0.9042608,
                    'mse': [0.0013906704,
                            0.003100305,
                            0.0039068214,
                            0.0039782184,
                            0.004748925,
                            0.006182568,
                            0.0039059578,
                            0.0041632396,
                            0.0030306978,
                            0.0025527247,
                            0.004956544,
                            0.0076689376,
                            0.008034137,
                            0.0057044295,
                            0.0061869216,
                            0.0033004554,
                            0.0028917377,
                            0.0027035838,
                            0.004516921,
                            0.005964202,
                            0.0054353927,
                            0.004970267,
                            0.0061414824,
                            0.003267122,
                            0.0039514876,
                            0.0030270286,
                            0.00533478,
                            0.0032646698,
                            0.0025465866,
                            0.00208505,
                            0.0023391093,
                            0.0025809784,
                            0.0031803781],
                    'rmse': [0.037291694,
                             0.055680383,
                             0.06250457,
                             0.06307312,
                             0.06891245,
                             0.07862931,
                             0.06249766,
                             0.06452317,
                             0.055051774,
                             0.050524496,
                             0.07040273,
                             0.08757247,
                             0.089633346,
                             0.075527675,
                             0.07865699,
                             0.05744959,
                             0.05377488,
                             0.051995996,
                             0.067208044,
                             0.07722825,
                             0.07372512,
                             0.07050012,
                             0.07836761,
                             0.057158742,
                             0.06286086,
                             0.05501844,
                             0.07303958,
                             0.05713729,
                             0.050463714,
                             0.045662347,
                             0.048364338,
                             0.05080333,
                             0.05639484]},
 'spectra_realgan': {'cosine': [0.99594945,
                                0.993599,
                                0.9950832,
                                0.9941495,
                                0.9954565,
                                0.99380606,
                                0.9896941,
                                0.98959345,
                                0.9840586,
                                0.9780391,
                                0.98338234,
                                0.99038804,
                                0.983271,
                                0.9587497,
                                0.95064867,
                                0.95316404,
                                0.97102016,
                                0.97345513,
                                0.93828213,
                                0.9155233,
                                0.9159966,
                                0.92306614,
                                0.90216774,
                                0.95925295,
                                0.9439704,
                                0.96156967,
                                0.92616457,
                                0.95225024,
                                0.9714461,
                                0.9741205,
                                0.98563623,
                                0.98602635,
                                0.98827475],
                     'mae': [0.030195968,
                             0.04384645,
                             0.05171915,
                             0.051315956,
                             0.0585284,
                             0.064356156,
                             0.05100211,
                             0.051354375,
                             0.045245912,
                             0.04232188,
                             0.059441272,
                             0.07366079,
                             0.073836826,
                             0.063720815,
                             0.06439157,
                             0.04602444,
                             0.04345906,
                             0.040787138,
                             0.05499627,
                             0.062789485,
                             0.06026786,
                             0.056387287,
                             0.0629972,
                             0.04607277,
                             0.05318295,
                             0.04348565,
                             0.059214,
                             0.047780782,
                             0.041187927,
                             0.037686408,
                             0.039182164,
                             0.041614648,
                             0.04437734],
                     'max_mae': 0.073836826,
                     'max_mse': 0.008408905,
                     'max_rmse': 0.091700085,
                     'median_mae': 0.051315956,
                     'min_cosine': 0.90216774,
                     'mse': [0.0013965998,
                             0.0033654594,
                             0.0043091304,
                             0.0043066847,
                             0.0051687118,
                             0.00663488,
                             0.004193502,
                             0.0044916635,
                             0.0033190364,
                             0.002811561,
                             0.005270784,
                             0.008125987,
                             0.008408905,
                             0.005973664,
                             0.0064246827,
                             0.0033273175,
                             0.0029098277,
                             0.0027023253,
                             0.0045493,
                             0.0060367663,
                             0.005485335,
                             0.0050676977,
                             0.006299948,
                             0.0032926055,
                             0.0041749026,
                             0.0030507362,
                             0.0053743967,
                             0.0034350727,
                             0.0027860254,
                             0.0022955164,
                             0.0025833887,
                             0.0028579237,
                             0.0035189064],
                     'rmse': [0.03737111,
                              0.05801258,
                              0.065643966,
                              0.06562533,
                              0.07189375,
                              0.08145477,
                              0.06475726,
                              0.06701987,
                              0.057611078,
                              0.053024154,
                              0.07260016,
                              0.090144254,
                              0.091700085,
                              0.077289484,
                              0.08015412,
                              0.057682905,
                              0.05394282,
                              0.051983897,
                              0.0674485,
                              0.07769663,
                              0.07406305,
                              0.071187764,
                              0.07937221,
                              0.05738123,
                              0.064613484,
                              0.05523347,
                              0.07331028,
                              0.058609493,
                              0.052782815,
                              0.047911547,
                              0.05082705,
                              0.05345955,
                              0.05932037]},
 'spectra_realpca': {'cosine': [0.9999937,
                                0.9993013,
                                0.9994798,
                                0.9994376,
                                0.999559,
                                0.99957657,
                                0.99919015,
                                0.99927974,
                                0.99849164,
                                0.9977191,
                                0.999035,
                                0.9995573,
                                0.99935913,
                                0.9982099,
                                0.9977519,
                                0.9992372,
                                0.9997916,
                                0.99979126,
                                0.9992288,
                                0.99939203,
                                0.9991067,
                                0.998748,
                                0.9973434,
                                0.9995581,
                                0.9975727,
                                0.99948865,
                                0.9995264,
                                0.99721843,
                                0.9977442,
                                0.9974677,
                                0.9983343,
                                0.9984813,
                                0.998916],
                     'mae': [0.0011764647,
                             0.014062386,
                             0.015053653,
                             0.01467601,
                             0.01541104,
                             0.015452096,
                             0.014189024,
                             0.013958995,
                             0.013071115,
                             0.012636413,
                             0.013930626,
                             0.015227784,
                             0.014211556,
                             0.012728964,
                             0.012758763,
                             0.0057640476,
                             0.0036172157,
                             0.0035028004,
                             0.006083902,
                             0.005301728,
                             0.006149457,
                             0.007283194,
                             0.010575026,
                             0.004721566,
                             0.010749927,
                             0.004920615,
                             0.004676001,
                             0.010937772,
                             0.011793469,
                             0.011832417,
                             0.013098186,
                             0.013118717,
                             0.013877977],
                     'max_mae': 0.015452096,
                     'max_mse': 0.0003802852,
                     'max_rmse': 0.019500902,
                     'median_mae': 0.012636413,
                     'min_cosine': 0.99721843,
                     'mse': [2.2112956e-06,
                             0.00031953826,
                             0.00036343205,
                             0.0003405465,
                             0.0003778579,
                             0.0003802852,
                             0.0003221521,
                             0.0003122406,
                             0.00027347737,
                             0.0002525805,
                             0.00030932605,
                             0.00037394825,
                             0.0003239067,
                             0.00026210546,
                             0.00026054378,
                             5.2714164e-05,
                             2.1091626e-05,
                             1.9562438e-05,
                             5.8733887e-05,
                             4.512433e-05,
                             6.0498303e-05,
                             8.541654e-05,
                             0.00017901142,
                             3.5609813e-05,
                             0.00018368005,
                             3.8391925e-05,
                             3.5182125e-05,
                             0.00019131646,
                             0.00022001953,
                             0.00022399421,
                             0.00027657018,
                             0.00027536362,
                             0.00030762097],
                     'rmse': [0.0014870425,
                              0.017875632,
                              0.019063894,
                              0.018453902,
                              0.019438569,
                              0.019500902,
                              0.017948596,
                              0.017670332,
                              0.016537152,
                              0.015892781,
                              0.017587667,
                              0.019337742,
                              0.017997408,
                              0.016189672,
                              0.016141368,
                              0.007260452,
                              0.004592562,
                              0.0044229445,
                              0.0076638036,
                              0.0067174644,
                              0.0077780657,
                              0.009242107,
                              0.013379515,
                              0.005967396,
                              0.013552861,
                              0.0061961217,
                              0.0059314524,
                              0.01383172,
                              0.014833055,
                              0.014966436,
                              0.0166304,
                              0.016594084,
                              0.017539127]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_90.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957
Directory path: experiments/inpainting/gann_4_night_20180723_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_90.0/images
Optimal number of principal components:  40
Reconstruction error:  7.983065
Energy conservation:  0.9051497
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_90.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.075287224842861, 1.9238356577443816],
                   'kl_div': 1.5889548,
                   'ks_tests': {10000: KstestResult(statistic=0.4046, pvalue=0.0, statistic_location=0.0031797718, statistic_sign=1),
                                20000: KstestResult(statistic=0.41184999999999994, pvalue=0.0, statistic_location=0.0028346712, statistic_sign=1),
                                30000: KstestResult(statistic=0.40780000000000005, pvalue=0.0, statistic_location=0.0030722963, statistic_sign=1),
                                40000: KstestResult(statistic=0.40307499999999996, pvalue=0.0, statistic_location=0.0031723822, statistic_sign=1),
                                50000: KstestResult(statistic=0.40490000000000004, pvalue=0.0, statistic_location=0.0028884206, statistic_sign=1),
                                60000: KstestResult(statistic=0.40398333333333336, pvalue=0.0, statistic_location=0.0028351014, statistic_sign=1),
                                70000: KstestResult(statistic=0.40362857142857145, pvalue=0.0, statistic_location=0.0029056375, statistic_sign=1),
                                80000: KstestResult(statistic=0.40727500000000005, pvalue=0.0, statistic_location=0.0028314923, statistic_sign=1),
                                90000: KstestResult(statistic=0.40255555555555556, pvalue=0.0, statistic_location=0.0031849076, statistic_sign=1),
                                100000: KstestResult(statistic=0.40624000000000005, pvalue=0.0, statistic_location=0.0028336141, statistic_sign=1),
                                110000: KstestResult(statistic=0.40407272727272725, pvalue=0.0, statistic_location=0.002857644, statistic_sign=1)},
                   'moments': {'mean_error': 0.60734826,
                               'means': [0.00018858185, -8.718696e-05],
                               'stds': [0.018317485, 0.0016936617],
                               'variance_ratio': 151.9433}},
 'originals': {'gan': {'mae': 0.03907991945743561,
                       'mse': 0.0029826911631971598,
                       'psnr': 25.586721420288086,
                       'rmse': 0.05461401864886284,
                       'ssim': 0.6816277503967285},
               'pca': {'mae': 0.0030950529035180807,
                       'mse': 1.8244567399960943e-05,
                       'psnr': 48.39080810546875,
                       'rmse': 0.0042713661678135395,
                       'ssim': 0.9957583546638489}},
 'reconstructions': {'mae': 0.03895598649978638,
                     'mse': 0.002969540888443589,
                     'psnr': 26.275253295898438,
                     'rmse': 0.0544934943318367,
                     'ssim': 0.6818815469741821},
 'residual_spectra_pcagan': {'cosine': [0.07999728,
                                        0.110387884,
                                        0.0943001,
                                        0.09631382,
                                        0.05035724,
                                        0.0979046,
                                        0.044598136,
                                        0.050525095,
                                        0.032034542,
                                        0.06532528,
                                        0.051456064],
                             'mae': [0.011834683,
                                     0.012708734,
                                     0.012661212,
                                     0.011451331,
                                     0.012725902,
                                     0.012126948,
                                     0.012201264,
                                     0.0130655365,
                                     0.013309161,
                                     0.01222524,
                                     0.012985987],
                             'max_mae': 0.013309161,
                             'max_mse': 0.0004610177,
                             'max_rmse': 0.021471323,
                             'median_distance': 1.7760828,
                             'median_mae': 0.012661212,
                             'min_cosine': 0.032034542,
                             'mse': [0.00027266884,
                                     0.0004610177,
                                     0.000315447,
                                     0.00026816546,
                                     0.00040944957,
                                     0.0002792686,
                                     0.0003054094,
                                     0.00033463008,
                                     0.00036799855,
                                     0.00031527766,
                                     0.00034349412],
                             'rmse': [0.016512686,
                                      0.021471323,
                                      0.017760828,
                                      0.016375758,
                                      0.02023486,
                                      0.016711332,
                                      0.017475966,
                                      0.018292896,
                                      0.01918329,
                                      0.01775606,
                                      0.018533595]},
 'residuals': {'mae': 0.012481453828513622,
               'mse': 0.00033389340387657285,
               'psnr': 3.8836841583251953,
               'rmse': 0.018272750079631805,
               'ssds': [36.911907, 0.31636712],
               'ssim': 0.24195308983325958},
 'spectra_pcagan': {'cosine': [0.76223534,
                               0.97125,
                               0.97226447,
                               0.97820693,
                               0.97354764,
                               0.97162855,
                               0.976112,
                               0.97734845,
                               0.9845057,
                               0.9912768,
                               0.988415],
                    'mae': [0.12476509,
                            0.0371123,
                            0.032637633,
                            0.027951507,
                            0.030575,
                            0.031872023,
                            0.030454468,
                            0.031170264,
                            0.029310437,
                            0.025228783,
                            0.027438387],
                    'max_mae': 0.12476509,
                    'max_mse': 0.017288035,
                    'max_rmse': 0.13148397,
                    'median_mae': 0.030575,
                    'min_cosine': 0.76223534,
                    'mse': [0.017288035,
                            0.0023050709,
                            0.0016813804,
                            0.0012950458,
                            0.0016148445,
                            0.0016259712,
                            0.0015061366,
                            0.0016205792,
                            0.0014221726,
                            0.0010565195,
                            0.0012491945],
                    'rmse': [0.13148397,
                             0.048011154,
                             0.04100464,
                             0.035986744,
                             0.040185127,
                             0.040323332,
                             0.038808975,
                             0.04025642,
                             0.037711706,
                             0.032504145,
                             0.035343945]},
 'spectra_realgan': {'cosine': [0.7618153,
                                0.97064555,
                                0.97194326,
                                0.97798246,
                                0.97307485,
                                0.9714727,
                                0.9760787,
                                0.9772936,
                                0.984413,
                                0.9912304,
                                0.98837095],
                     'mae': [0.124833286,
                             0.037253167,
                             0.032851007,
                             0.028157094,
                             0.030859085,
                             0.031977635,
                             0.030478247,
                             0.031209195,
                             0.029416999,
                             0.02533918,
                             0.027504181],
                     'max_mae': 0.124833286,
                     'max_mse': 0.017317472,
                     'max_rmse': 0.13159586,
                     'median_mae': 0.030859085,
                     'min_cosine': 0.7618153,
                     'mse': [0.017317472,
                             0.0023278133,
                             0.0017012169,
                             0.0013084988,
                             0.0016384962,
                             0.0016354101,
                             0.0015088127,
                             0.0016243279,
                             0.0014303304,
                             0.001063224,
                             0.0012540021],
                     'rmse': [0.13159586,
                              0.04824742,
                              0.04124581,
                              0.036173176,
                              0.04047834,
                              0.040440205,
                              0.038843438,
                              0.04030295,
                              0.03781971,
                              0.032607116,
                              0.03541189]},
 'spectra_realpca': {'cosine': [0.9998691,
                                0.9989513,
                                0.9996273,
                                0.9997952,
                                0.99963874,
                                0.99961287,
                                0.999901,
                                0.9998622,
                                0.9998979,
                                0.99994004,
                                0.9999419],
                     'mae': [0.00231966,
                             0.0068045454,
                             0.0037928016,
                             0.0027794538,
                             0.003671367,
                             0.0037567203,
                             0.0019852542,
                             0.0024191062,
                             0.002426687,
                             0.0021290374,
                             0.001960948],
                     'max_mae': 0.0068045454,
                     'max_mse': 7.440903e-05,
                     'max_rmse': 0.008626067,
                     'median_mae': 0.002426687,
                     'min_cosine': 0.9989513,
                     'mse': [8.625504e-06,
                             7.440903e-05,
                             2.2840899e-05,
                             1.2306927e-05,
                             2.1499081e-05,
                             2.2509324e-05,
                             6.3119487e-06,
                             9.350844e-06,
                             9.316879e-06,
                             7.323512e-06,
                             6.196306e-06],
                     'rmse': [0.0029369208,
                              0.008626067,
                              0.0047792154,
                              0.0035081229,
                              0.00463671,
                              0.0047443993,
                              0.0025123593,
                              0.003057915,
                              0.0030523564,
                              0.0027061987,
                              0.002489238]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_90.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431
Directory path: experiments/inpainting/gann_4_night_20180723_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_90.0/images
Optimal number of principal components:  40
Reconstruction error:  7.983065
Energy conservation:  0.9051497
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_90.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.070708789508587, 2.1100629910249995],
                   'kl_div': 1.4021322,
                   'ks_tests': {10000: KstestResult(statistic=0.3883, pvalue=0.0, statistic_location=0.0026369174, statistic_sign=1),
                                20000: KstestResult(statistic=0.37134999999999996, pvalue=0.0, statistic_location=0.0028870096, statistic_sign=1),
                                30000: KstestResult(statistic=0.3798, pvalue=0.0, statistic_location=0.0028991015, statistic_sign=1),
                                40000: KstestResult(statistic=0.38002500000000006, pvalue=0.0, statistic_location=0.0030011106, statistic_sign=1),
                                50000: KstestResult(statistic=0.37754, pvalue=0.0, statistic_location=0.0030077412, statistic_sign=1),
                                60000: KstestResult(statistic=0.37675000000000003, pvalue=0.0, statistic_location=0.002890713, statistic_sign=1),
                                70000: KstestResult(statistic=0.37977142857142854, pvalue=0.0, statistic_location=0.0028201076, statistic_sign=1),
                                80000: KstestResult(statistic=0.38046250000000004, pvalue=0.0, statistic_location=0.002857233, statistic_sign=1),
                                90000: KstestResult(statistic=0.37955555555555553, pvalue=0.0, statistic_location=0.0029188879, statistic_sign=1),
                                100000: KstestResult(statistic=0.37573, pvalue=0.0, statistic_location=0.0028945906, statistic_sign=1),
                                110000: KstestResult(statistic=0.37732727272727273, pvalue=0.0, statistic_location=0.0027858587, statistic_sign=1),
                                120000: KstestResult(statistic=0.37720833333333326, pvalue=0.0, statistic_location=0.0027468652, statistic_sign=1),
                                130000: KstestResult(statistic=0.3781230769230769, pvalue=0.0, statistic_location=0.002896687, statistic_sign=1),
                                140000: KstestResult(statistic=0.37908571428571436, pvalue=0.0, statistic_location=0.0028949701, statistic_sign=1),
                                150000: KstestResult(statistic=0.37536, pvalue=0.0, statistic_location=0.0028042286, statistic_sign=1),
                                160000: KstestResult(statistic=0.3776125, pvalue=0.0, statistic_location=0.0027467394, statistic_sign=1),
                                170000: KstestResult(statistic=0.3785705882352941, pvalue=0.0, statistic_location=0.0028665443, statistic_sign=1),
                                180000: KstestResult(statistic=0.37950555555555554, pvalue=0.0, statistic_location=0.0028186748, statistic_sign=1),
                                190000: KstestResult(statistic=0.37695789473684205, pvalue=0.0, statistic_location=0.0030024915, statistic_sign=1),
                                200000: KstestResult(statistic=0.37703, pvalue=0.0, statistic_location=0.0028243097, statistic_sign=1),
                                210000: KstestResult(statistic=0.3783619047619048, pvalue=0.0, statistic_location=0.002757472, statistic_sign=1),
                                220000: KstestResult(statistic=0.3771318181818183, pvalue=0.0, statistic_location=0.0029670773, statistic_sign=1)},
                   'moments': {'mean_error': 0.67405593,
                               'means': [0.0011001013, -3.1829364e-05],
                               'stds': [0.017806092, 0.0025422708],
                               'variance_ratio': 64.20978}},
 'originals': {'gan': {'mae': 0.03808658942580223,
                       'mse': 0.002810173900797963,
                       'psnr': 27.170913696289062,
                       'rmse': 0.05301107466220856,
                       'ssim': 0.6383568048477173},
               'pca': {'mae': 0.004042163025587797,
                       'mse': 5.105283344164491e-05,
                       'psnr': 44.84426498413086,
                       'rmse': 0.007145126350224018,
                       'ssim': 0.9958851933479309}},
 'reconstructions': {'mae': 0.03752455487847328,
                     'mse': 0.002760432893410325,
                     'psnr': 27.514692306518555,
                     'rmse': 0.05253982171416283,
                     'ssim': 0.636223316192627},
 'residual_spectra_pcagan': {'cosine': [0.26867184,
                                        0.31707415,
                                        0.06075166,
                                        0.38076413,
                                        0.18253449,
                                        0.06022122,
                                        0.15772496,
                                        0.11227158,
                                        0.09408435,
                                        0.08088422,
                                        0.11169721,
                                        0.061961353,
                                        0.07139591,
                                        0.046891663,
                                        0.02747235,
                                        0.06299283,
                                        0.014135809,
                                        0.01841689,
                                        0.043006737,
                                        0.042236004,
                                        0.029830504,
                                        0.030101724],
                             'mae': [0.009969346,
                                     0.009988624,
                                     0.012519989,
                                     0.01006852,
                                     0.012141682,
                                     0.013221327,
                                     0.011311702,
                                     0.010666179,
                                     0.011168239,
                                     0.0119353505,
                                     0.012977727,
                                     0.0125425,
                                     0.012155171,
                                     0.012418994,
                                     0.012649584,
                                     0.013039078,
                                     0.012884771,
                                     0.014458891,
                                     0.013669528,
                                     0.012752541,
                                     0.013437046,
                                     0.011898462],
                             'max_mae': 0.014458891,
                             'max_mse': 0.00048807508,
                             'max_rmse': 0.02209242,
                             'median_distance': 1.7290363,
                             'median_mae': 0.012469491,
                             'min_cosine': 0.014135809,
                             'mse': [0.000203739,
                                     0.00027886886,
                                     0.0004296824,
                                     0.00021502518,
                                     0.00031912417,
                                     0.00039602726,
                                     0.00028393444,
                                     0.00022915898,
                                     0.00022849426,
                                     0.0002699579,
                                     0.00032589774,
                                     0.00029532987,
                                     0.00027172398,
                                     0.00029723617,
                                     0.000336367,
                                     0.00037171587,
                                     0.0003107833,
                                     0.00038494985,
                                     0.00037122006,
                                     0.00030068215,
                                     0.00048807508,
                                     0.00027362103],
                             'rmse': [0.014273717,
                                      0.016699366,
                                      0.020728782,
                                      0.014663737,
                                      0.017864047,
                                      0.019900434,
                                      0.016850354,
                                      0.015137997,
                                      0.015116027,
                                      0.016430397,
                                      0.018052638,
                                      0.017185165,
                                      0.016484052,
                                      0.01724054,
                                      0.01834031,
                                      0.019279934,
                                      0.017629048,
                                      0.01962014,
                                      0.019267071,
                                      0.017340189,
                                      0.02209242,
                                      0.016541494]},
 'residuals': {'mae': 0.01217614859342575,
               'mse': 0.0003128006646875292,
               'psnr': 10.457454681396484,
               'rmse': 0.01768617145717144,
               'ssds': [70.01845, 1.4221075],
               'ssim': 0.28645867109298706},
 'spectra_pcagan': {'cosine': [0.985545,
                               0.98927957,
                               0.97207505,
                               0.98859066,
                               0.9762829,
                               0.7808707,
                               0.9763994,
                               0.9796736,
                               0.97730815,
                               0.97561455,
                               0.96716523,
                               0.9776412,
                               0.97872096,
                               0.9864699,
                               0.98990357,
                               0.98827016,
                               0.99054897,
                               0.99140626,
                               0.99333286,
                               0.94548637,
                               0.99239033,
                               0.9950641],
                    'mae': [0.030093845,
                            0.029153354,
                            0.03205486,
                            0.02892175,
                            0.03334497,
                            0.12313718,
                            0.03173873,
                            0.02710504,
                            0.028714301,
                            0.02976158,
                            0.035838477,
                            0.031544853,
                            0.031042797,
                            0.027385047,
                            0.026554145,
                            0.03185826,
                            0.027138587,
                            0.028453162,
                            0.028466433,
                            0.11334714,
                            0.025819516,
                            0.024066193],
                    'max_mae': 0.12313718,
                    'max_mse': 0.01722094,
                    'max_rmse': 0.13122858,
                    'median_mae': 0.029457469,
                    'min_cosine': 0.7808707,
                    'mse': [0.0014832249,
                            0.0016224224,
                            0.0017968178,
                            0.001426649,
                            0.0017977726,
                            0.01722094,
                            0.001706856,
                            0.0012334092,
                            0.001373197,
                            0.0014346761,
                            0.0020850839,
                            0.0015811275,
                            0.0015653919,
                            0.0012395928,
                            0.0012345078,
                            0.0016591343,
                            0.0011869853,
                            0.0013196846,
                            0.0013803184,
                            0.014201191,
                            0.0012372974,
                            0.00094323617],
                    'rmse': [0.03851266,
                             0.040279303,
                             0.042388886,
                             0.03777101,
                             0.042400148,
                             0.13122858,
                             0.041314114,
                             0.035119925,
                             0.037056673,
                             0.03787712,
                             0.04566272,
                             0.039763395,
                             0.039565034,
                             0.035207853,
                             0.035135563,
                             0.040732473,
                             0.034452654,
                             0.036327463,
                             0.037152637,
                             0.11916875,
                             0.035175238,
                             0.03071215]},
 'spectra_realgan': {'cosine': [0.9842093,
                                0.987201,
                                0.97187227,
                                0.98596835,
                                0.9751972,
                                0.78047305,
                                0.97550696,
                                0.9793311,
                                0.97711444,
                                0.97518677,
                                0.96695334,
                                0.9775663,
                                0.97863406,
                                0.98639566,
                                0.9898639,
                                0.9882093,
                                0.9905471,
                                0.9914021,
                                0.9933291,
                                0.945465,
                                0.992354,
                                0.99506056],
                     'mae': [0.03144928,
                             0.033357445,
                             0.032230277,
                             0.03283307,
                             0.034184236,
                             0.12320384,
                             0.032411516,
                             0.02735267,
                             0.028834106,
                             0.030075666,
                             0.03589722,
                             0.031591155,
                             0.031080691,
                             0.027470553,
                             0.026677158,
                             0.031916853,
                             0.02713877,
                             0.02845996,
                             0.028434137,
                             0.11333098,
                             0.025898444,
                             0.024076888],
                     'max_mae': 0.12320384,
                     'max_mse': 0.017250523,
                     'max_rmse': 0.13134125,
                     'median_mae': 0.031264987,
                     'min_cosine': 0.78047305,
                     'mse': [0.0016166643,
                             0.0019663032,
                             0.0018089205,
                             0.0017658218,
                             0.001879229,
                             0.017250523,
                             0.0017576164,
                             0.0012545725,
                             0.0013850055,
                             0.0014584337,
                             0.0020978446,
                             0.0015857262,
                             0.0015713117,
                             0.001246404,
                             0.001241265,
                             0.0016649254,
                             0.0011874081,
                             0.0013207207,
                             0.0013794836,
                             0.014200278,
                             0.0012411728,
                             0.00094419],
                     'rmse': [0.040207766,
                              0.044343017,
                              0.042531405,
                              0.042021684,
                              0.043350074,
                              0.13134125,
                              0.041923936,
                              0.035419945,
                              0.03721566,
                              0.038189445,
                              0.045802232,
                              0.039821178,
                              0.039639775,
                              0.035304446,
                              0.03523159,
                              0.040803496,
                              0.03445879,
                              0.03634172,
                              0.0371414,
                              0.11916492,
                              0.035230283,
                              0.030727675]},
 'spectra_realpca': {'cosine': [0.9987921,
                                0.9977492,
                                0.9997608,
                                0.99720466,
                                0.9988087,
                                0.9998691,
                                0.9989513,
                                0.9996273,
                                0.9997952,
                                0.99963874,
                                0.99961287,
                                0.999901,
                                0.9998622,
                                0.9998979,
                                0.99994004,
                                0.9999419,
                                0.99998635,
                                0.9999829,
                                0.99998623,
                                0.99999297,
                                0.99998295,
                                0.9999956],
                     'mae': [0.008667559,
                             0.014475313,
                             0.0030943064,
                             0.014771223,
                             0.0074082906,
                             0.00231966,
                             0.0068045454,
                             0.0037928016,
                             0.0027794538,
                             0.003671367,
                             0.0037567203,
                             0.0019852542,
                             0.0024191062,
                             0.002426687,
                             0.0021290374,
                             0.001960948,
                             0.0010336846,
                             0.0012831506,
                             0.0012742764,
                             0.0008873018,
                             0.0012935124,
                             0.00069338444],
                     'max_mae': 0.014771223,
                     'max_mse': 0.00034801464,
                     'max_rmse': 0.018655151,
                     'median_mae': 0.0024228967,
                     'min_cosine': 0.99720466,
                     'mse': [0.00012110902,
                             0.0003379762,
                             1.5329746e-05,
                             0.00034801464,
                             8.839375e-05,
                             8.625504e-06,
                             7.440903e-05,
                             2.2840899e-05,
                             1.2306927e-05,
                             2.1499081e-05,
                             2.2509324e-05,
                             6.3119487e-06,
                             9.350844e-06,
                             9.316879e-06,
                             7.323512e-06,
                             6.196306e-06,
                             1.7081682e-06,
                             2.6403834e-06,
                             2.5888871e-06,
                             1.2561247e-06,
                             2.6818648e-06,
                             7.731901e-07],
                     'rmse': [0.011004955,
                              0.018384129,
                              0.003915322,
                              0.018655151,
                              0.0094017945,
                              0.0029369208,
                              0.008626067,
                              0.0047792154,
                              0.0035081229,
                              0.00463671,
                              0.0047443993,
                              0.0025123593,
                              0.003057915,
                              0.0030523564,
                              0.0027061987,
                              0.002489238,
                              0.0013069691,
                              0.0016249256,
                              0.0016090019,
                              0.0011207697,
                              0.00163764,
                              0.0008793123]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_90.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707
Directory path: experiments/inpainting/gann_4_night_20180723_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_90.0/images
Optimal number of principal components:  40
Reconstruction error:  7.983065
Energy conservation:  0.9051497
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_90.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.060522481510419, 2.2482659701732377],
                   'kl_div': 1.2456299,
                   'ks_tests': {10000: KstestResult(statistic=0.3235, pvalue=1e-323, statistic_location=0.0034893032, statistic_sign=1),
                                20000: KstestResult(statistic=0.3276, pvalue=0.0, statistic_location=0.0034352813, statistic_sign=1),
                                30000: KstestResult(statistic=0.3252, pvalue=0.0, statistic_location=-0.003145473, statistic_sign=-1),
                                40000: KstestResult(statistic=0.32184999999999997, pvalue=0.0, statistic_location=0.0029062335, statistic_sign=1),
                                50000: KstestResult(statistic=0.32597999999999994, pvalue=0.0, statistic_location=0.0034356448, statistic_sign=1),
                                60000: KstestResult(statistic=0.3196333333333333, pvalue=0.0, statistic_location=0.0034167941, statistic_sign=1),
                                70000: KstestResult(statistic=0.3208714285714286, pvalue=0.0, statistic_location=0.003224846, statistic_sign=1),
                                80000: KstestResult(statistic=0.3232625, pvalue=0.0, statistic_location=0.0030833855, statistic_sign=1),
                                90000: KstestResult(statistic=0.32257777777777774, pvalue=0.0, statistic_location=0.0031535728, statistic_sign=1),
                                100000: KstestResult(statistic=0.31973, pvalue=0.0, statistic_location=-0.0033942834, statistic_sign=-1),
                                110000: KstestResult(statistic=0.3229363636363637, pvalue=0.0, statistic_location=0.003353985, statistic_sign=1),
                                120000: KstestResult(statistic=0.32347499999999996, pvalue=0.0, statistic_location=0.0030502286, statistic_sign=1),
                                130000: KstestResult(statistic=0.32268461538461546, pvalue=0.0, statistic_location=0.0032209232, statistic_sign=1),
                                140000: KstestResult(statistic=0.3209928571428572, pvalue=0.0, statistic_location=0.0032448648, statistic_sign=1),
                                150000: KstestResult(statistic=0.3222866666666667, pvalue=0.0, statistic_location=0.0034009665, statistic_sign=1),
                                160000: KstestResult(statistic=0.32129375000000004, pvalue=0.0, statistic_location=0.0031498582, statistic_sign=1),
                                170000: KstestResult(statistic=0.3209882352941177, pvalue=0.0, statistic_location=0.0030933372, statistic_sign=1),
                                180000: KstestResult(statistic=0.32039999999999996, pvalue=0.0, statistic_location=-0.0032686528, statistic_sign=-1),
                                190000: KstestResult(statistic=0.3216894736842105, pvalue=0.0, statistic_location=0.003186143, statistic_sign=1),
                                200000: KstestResult(statistic=0.322325, pvalue=0.0, statistic_location=0.0031724644, statistic_sign=1),
                                210000: KstestResult(statistic=0.321752380952381, pvalue=0.0, statistic_location=0.002908811, statistic_sign=1),
                                220000: KstestResult(statistic=0.3234681818181818, pvalue=0.0, statistic_location=0.00290476, statistic_sign=1),
                                230000: KstestResult(statistic=0.3197, pvalue=0.0, statistic_location=-0.0032619317, statistic_sign=-1),
                                240000: KstestResult(statistic=0.3217791666666667, pvalue=0.0, statistic_location=0.0031521302, statistic_sign=1),
                                250000: KstestResult(statistic=0.323284, pvalue=0.0, statistic_location=0.0030837022, statistic_sign=1),
                                260000: KstestResult(statistic=0.32199999999999995, pvalue=0.0, statistic_location=0.0031498582, statistic_sign=1),
                                270000: KstestResult(statistic=0.32148888888888894, pvalue=0.0, statistic_location=0.0033965448, statistic_sign=1),
                                280000: KstestResult(statistic=0.3228857142857142, pvalue=0.0, statistic_location=0.0033535082, statistic_sign=1),
                                290000: KstestResult(statistic=0.322344827586207, pvalue=0.0, statistic_location=0.0032287135, statistic_sign=1),
                                300000: KstestResult(statistic=0.3222666666666667, pvalue=0.0, statistic_location=0.0031508303, statistic_sign=1),
                                310000: KstestResult(statistic=0.3215967741935484, pvalue=0.0, statistic_location=0.0031489935, statistic_sign=1),
                                320000: KstestResult(statistic=0.32210312499999993, pvalue=0.0, statistic_location=0.0031894147, statistic_sign=1),
                                330000: KstestResult(statistic=0.32090606060606064, pvalue=0.0, statistic_location=0.0033628705, statistic_sign=1)},
                   'moments': {'mean_error': 0.11177656,
                               'means': [4.6829733e-05, 5.321716e-06],
                               'stds': [0.017160652, 0.0029159642],
                               'variance_ratio': 39.64782}},
 'originals': {'gan': {'mae': 0.03634319081902504,
                       'mse': 0.002503356896340847,
                       'psnr': 28.30494499206543,
                       'rmse': 0.050033558160066605,
                       'ssim': 0.6518735289573669},
               'pca': {'mae': 0.004837940912693739,
                       'mse': 7.034377631498501e-05,
                       'psnr': 44.24570846557617,
                       'rmse': 0.008387119509279728,
                       'ssim': 0.9946244359016418}},
 'reconstructions': {'mae': 0.03563316911458969,
                     'mse': 0.0024350034072995186,
                     'psnr': 28.85296630859375,
                     'rmse': 0.04934575408697128,
                     'ssim': 0.6506173014640808},
 'residual_spectra_pcagan': {'cosine': [0.24268772,
                                        0.259597,
                                        0.24192956,
                                        0.20319335,
                                        0.32263187,
                                        0.3339759,
                                        0.19655393,
                                        0.29312724,
                                        0.09842954,
                                        0.37595993,
                                        0.18121743,
                                        0.0837157,
                                        0.12951978,
                                        0.113169,
                                        0.09876113,
                                        0.0681576,
                                        0.1125522,
                                        0.048349068,
                                        0.061060578,
                                        0.037314236,
                                        0.07978037,
                                        0.05333218,
                                        0.047082067,
                                        0.040581707,
                                        0.03982709,
                                        0.054700013,
                                        0.04788714,
                                        0.0077069267,
                                        0.012727788,
                                        0.04010412,
                                        0.06862926,
                                        0.04091369,
                                        0.05159402],
                             'mae': [0.010538264,
                                     0.010895785,
                                     0.010331793,
                                     0.011263579,
                                     0.009966,
                                     0.010426576,
                                     0.011068341,
                                     0.0108734,
                                     0.0114380745,
                                     0.010283478,
                                     0.012045066,
                                     0.01173634,
                                     0.012325296,
                                     0.0121591175,
                                     0.010975385,
                                     0.012177016,
                                     0.011587128,
                                     0.011743785,
                                     0.012528489,
                                     0.012903647,
                                     0.0117380405,
                                     0.012746565,
                                     0.012175996,
                                     0.0136866,
                                     0.013089627,
                                     0.012138192,
                                     0.013615051,
                                     0.013463223,
                                     0.011578547,
                                     0.0116855195,
                                     0.011156488,
                                     0.011573447,
                                     0.012755861],
                             'max_mae': 0.0136866,
                             'max_mse': 0.00038749079,
                             'max_rmse': 0.019684786,
                             'median_distance': 1.6877296,
                             'median_mae': 0.01173634,
                             'min_cosine': 0.0077069267,
                             'mse': [0.00022355354,
                                     0.00025916062,
                                     0.00022558143,
                                     0.00034170176,
                                     0.00020302701,
                                     0.00030680574,
                                     0.00028484315,
                                     0.00031070862,
                                     0.00028692768,
                                     0.00022559459,
                                     0.00033703982,
                                     0.00027307068,
                                     0.00038749079,
                                     0.00027459004,
                                     0.00023136468,
                                     0.0003284081,
                                     0.00024184868,
                                     0.00026143488,
                                     0.00030818253,
                                     0.00031863013,
                                     0.0002676829,
                                     0.00032693203,
                                     0.0003170178,
                                     0.00034525528,
                                     0.00031270253,
                                     0.0002665769,
                                     0.00033530613,
                                     0.00034873202,
                                     0.00025213824,
                                     0.00025090948,
                                     0.00023975247,
                                     0.0002523601,
                                     0.00033059574],
                             'rmse': [0.014951707,
                                      0.016098466,
                                      0.015019368,
                                      0.018485177,
                                      0.014248755,
                                      0.017515872,
                                      0.016877297,
                                      0.017626928,
                                      0.01693894,
                                      0.015019806,
                                      0.018358644,
                                      0.01652485,
                                      0.019684786,
                                      0.016570758,
                                      0.015210677,
                                      0.018122034,
                                      0.015551485,
                                      0.016168948,
                                      0.017555129,
                                      0.017850215,
                                      0.016361017,
                                      0.018081263,
                                      0.017804993,
                                      0.018581046,
                                      0.017683396,
                                      0.016327184,
                                      0.018311366,
                                      0.018674368,
                                      0.015878862,
                                      0.015840122,
                                      0.015483942,
                                      0.015885847,
                                      0.018182293]},
 'residuals': {'mae': 0.011777869425714016,
               'mse': 0.00028714933432638645,
               'psnr': 10.829052925109863,
               'rmse': 0.016945481300354004,
               'ssds': [97.18146, 2.8059409],
               'ssim': 0.27716583013534546},
 'spectra_pcagan': {'cosine': [0.9863923,
                               0.9841264,
                               0.98679435,
                               0.9863076,
                               0.9860115,
                               0.9917913,
                               0.9829346,
                               0.98723257,
                               0.9707275,
                               0.98671067,
                               0.9712496,
                               0.76239663,
                               0.97145414,
                               0.9720631,
                               0.97819495,
                               0.97331315,
                               0.97139513,
                               0.97647315,
                               0.9775048,
                               0.98432034,
                               0.9909375,
                               0.98856544,
                               0.9914001,
                               0.99139035,
                               0.9938307,
                               0.9381155,
                               0.99181634,
                               0.99266815,
                               0.9952179,
                               0.99353456,
                               0.99140203,
                               0.9931015,
                               0.9936039],
                    'mae': [0.029059436,
                            0.02890156,
                            0.02849497,
                            0.029687619,
                            0.03559041,
                            0.036103047,
                            0.031983383,
                            0.032246653,
                            0.03417029,
                            0.033778302,
                            0.036068395,
                            0.124948196,
                            0.037036724,
                            0.03280141,
                            0.027981183,
                            0.030759808,
                            0.03196344,
                            0.030229999,
                            0.031081785,
                            0.029535504,
                            0.025644409,
                            0.027396392,
                            0.028548151,
                            0.029336233,
                            0.027948562,
                            0.1189218,
                            0.028328482,
                            0.030410862,
                            0.02312757,
                            0.025682664,
                            0.02837976,
                            0.024689171,
                            0.02505841],
                    'max_mae': 0.124948196,
                    'max_mse': 0.017347509,
                    'max_rmse': 0.13170995,
                    'median_mae': 0.029687619,
                    'min_cosine': 0.76239663,
                    'mse': [0.0014566979,
                            0.0014668704,
                            0.0014011095,
                            0.0016381845,
                            0.0019850596,
                            0.0024114086,
                            0.0017401563,
                            0.0019626888,
                            0.0018723736,
                            0.0018894016,
                            0.0021277599,
                            0.017347509,
                            0.002285899,
                            0.0016935918,
                            0.0012957652,
                            0.0016253819,
                            0.0016391185,
                            0.0014830631,
                            0.0016086122,
                            0.0014400881,
                            0.0010973484,
                            0.0012336643,
                            0.001407759,
                            0.0013863832,
                            0.0013216168,
                            0.01547003,
                            0.001289144,
                            0.0014852707,
                            0.00087701215,
                            0.0010611096,
                            0.0012947092,
                            0.0009891314,
                            0.0010712036],
                    'rmse': [0.038166713,
                             0.038299743,
                             0.037431397,
                             0.040474493,
                             0.044554006,
                             0.049106095,
                             0.041715182,
                             0.044302244,
                             0.043270934,
                             0.043467246,
                             0.046127647,
                             0.13170995,
                             0.047811076,
                             0.04115327,
                             0.03599674,
                             0.040316027,
                             0.04048603,
                             0.038510557,
                             0.040107507,
                             0.037948493,
                             0.03312625,
                             0.035123557,
                             0.037520114,
                             0.03723417,
                             0.036354046,
                             0.12437858,
                             0.035904653,
                             0.03853921,
                             0.02961439,
                             0.032574676,
                             0.03598207,
                             0.031450458,
                             0.032729246]},
 'spectra_realgan': {'cosine': [0.9853457,
                                0.98256886,
                                0.9856319,
                                0.9851173,
                                0.9843042,
                                0.9902997,
                                0.98178726,
                                0.98526365,
                                0.97053444,
                                0.9841003,
                                0.97034186,
                                0.76197577,
                                0.9708361,
                                0.9717476,
                                0.97797334,
                                0.9728323,
                                0.9712382,
                                0.97643906,
                                0.977448,
                                0.98422986,
                                0.99089116,
                                0.98852354,
                                0.9913817,
                                0.99137765,
                                0.99382603,
                                0.93810064,
                                0.9917726,
                                0.99265844,
                                0.9952108,
                                0.9935199,
                                0.99135834,
                                0.99310005,
                                0.993581],
                     'mae': [0.030539075,
                             0.030799365,
                             0.030067429,
                             0.03136362,
                             0.0377433,
                             0.04010604,
                             0.033148628,
                             0.035903037,
                             0.034256503,
                             0.037191223,
                             0.036725365,
                             0.12501793,
                             0.037209153,
                             0.032998245,
                             0.028175568,
                             0.031052625,
                             0.03206021,
                             0.030248767,
                             0.031114526,
                             0.029632458,
                             0.025752451,
                             0.027462307,
                             0.02860343,
                             0.029369095,
                             0.027923413,
                             0.11890807,
                             0.028410632,
                             0.030444764,
                             0.023159487,
                             0.025690375,
                             0.02844682,
                             0.024696108,
                             0.025105491],
                     'max_mae': 0.12501793,
                     'max_mse': 0.017377118,
                     'max_rmse': 0.1318223,
                     'median_mae': 0.030539075,
                     'min_cosine': 0.76197577,
                     'mse': [0.001580907,
                             0.00161871,
                             0.001527526,
                             0.0017778206,
                             0.0022215222,
                             0.0028403695,
                             0.0018557486,
                             0.002299846,
                             0.0018839289,
                             0.0022376964,
                             0.002193485,
                             0.017377118,
                             0.0023096504,
                             0.0017131058,
                             0.0013090419,
                             0.0016495228,
                             0.0016486194,
                             0.0014857881,
                             0.0016124826,
                             0.001448054,
                             0.0011039735,
                             0.0012382346,
                             0.0014120119,
                             0.0013880684,
                             0.0013205496,
                             0.015468119,
                             0.0012956159,
                             0.0014876608,
                             0.0008783165,
                             0.0010618339,
                             0.0013007688,
                             0.0009894547,
                             0.0010752388],
                     'rmse': [0.039760623,
                              0.040233195,
                              0.039083578,
                              0.04216421,
                              0.047133025,
                              0.053295117,
                              0.0430784,
                              0.04795671,
                              0.04340425,
                              0.047304295,
                              0.046834655,
                              0.1318223,
                              0.048058823,
                              0.04138968,
                              0.036180682,
                              0.040614318,
                              0.040603194,
                              0.03854592,
                              0.040155727,
                              0.038053304,
                              0.033226095,
                              0.035188556,
                              0.037576746,
                              0.037256792,
                              0.03633937,
                              0.124370895,
                              0.035994664,
                              0.038570207,
                              0.029636405,
                              0.032585792,
                              0.036066175,
                              0.0314556,
                              0.032790836]},
 'spectra_realpca': {'cosine': [0.9989881,
                                0.9982918,
                                0.99876994,
                                0.9986389,
                                0.9982794,
                                0.99833846,
                                0.9987921,
                                0.9977492,
                                0.9997608,
                                0.99720466,
                                0.9988087,
                                0.9998691,
                                0.9989513,
                                0.9996273,
                                0.9997952,
                                0.99963874,
                                0.99961287,
                                0.999901,
                                0.9998622,
                                0.9998979,
                                0.99994004,
                                0.9999419,
                                0.99998635,
                                0.9999829,
                                0.99998623,
                                0.99999297,
                                0.99998295,
                                0.9999956,
                                0.9999911,
                                0.9999864,
                                0.9999678,
                                0.99998605,
                                0.9999886],
                     'mae': [0.008165313,
                             0.009961964,
                             0.009069435,
                             0.009939963,
                             0.011283948,
                             0.016396116,
                             0.008667559,
                             0.014475313,
                             0.0030943064,
                             0.014771223,
                             0.0074082906,
                             0.00231966,
                             0.0068045454,
                             0.0037928016,
                             0.0027794538,
                             0.003671367,
                             0.0037567203,
                             0.0019852542,
                             0.0024191062,
                             0.002426687,
                             0.0021290374,
                             0.001960948,
                             0.0010336846,
                             0.0012831506,
                             0.0012742764,
                             0.0008873018,
                             0.0012935124,
                             0.00069338444,
                             0.0010015691,
                             0.0011207365,
                             0.0015716803,
                             0.0011202247,
                             0.0010934704],
                     'max_mae': 0.016396116,
                     'max_mse': 0.00042848644,
                     'max_rmse': 0.020699915,
                     'median_mae': 0.002426687,
                     'min_cosine': 0.99720466,
                     'mse': [0.000106252504,
                             0.00015864252,
                             0.00013133076,
                             0.00015846545,
                             0.00020355053,
                             0.00042848644,
                             0.00012110902,
                             0.0003379762,
                             1.5329746e-05,
                             0.00034801464,
                             8.839375e-05,
                             8.625504e-06,
                             7.440903e-05,
                             2.2840899e-05,
                             1.2306927e-05,
                             2.1499081e-05,
                             2.2509324e-05,
                             6.3119487e-06,
                             9.350844e-06,
                             9.316879e-06,
                             7.323512e-06,
                             6.196306e-06,
                             1.7081682e-06,
                             2.6403834e-06,
                             2.5888871e-06,
                             1.2561247e-06,
                             2.6818648e-06,
                             7.731901e-07,
                             1.6139995e-06,
                             2.0059686e-06,
                             3.9369797e-06,
                             1.9982815e-06,
                             1.8983325e-06],
                     'rmse': [0.010307886,
                              0.012595337,
                              0.011459963,
                              0.012588306,
                              0.014267114,
                              0.020699915,
                              0.011004955,
                              0.018384129,
                              0.003915322,
                              0.018655151,
                              0.0094017945,
                              0.0029369208,
                              0.008626067,
                              0.0047792154,
                              0.0035081229,
                              0.00463671,
                              0.0047443993,
                              0.0025123593,
                              0.003057915,
                              0.0030523564,
                              0.0027061987,
                              0.002489238,
                              0.0013069691,
                              0.0016249256,
                              0.0016090019,
                              0.0011207697,
                              0.00163764,
                              0.0008793123,
                              0.0012704328,
                              0.0014163222,
                              0.0019841823,
                              0.0014136059,
                              0.0013777999]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_90.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529
Directory path: experiments/inpainting/gann_4_night_20180901_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_90.0/images
Optimal number of principal components:  45
Reconstruction error:  3.2215178
Energy conservation:  0.90300375
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_90.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.932551248322828, 0.8481263276817256],
                   'kl_div': 2.4548366,
                   'ks_tests': {10000: KstestResult(statistic=0.4489, pvalue=0.0, statistic_location=0.0012322706, statistic_sign=1),
                                20000: KstestResult(statistic=0.45645, pvalue=0.0, statistic_location=-0.0011329316, statistic_sign=-1),
                                30000: KstestResult(statistic=0.4520666666666666, pvalue=0.0, statistic_location=0.0012735194, statistic_sign=1),
                                40000: KstestResult(statistic=0.45145, pvalue=0.0, statistic_location=-0.0011161445, statistic_sign=-1),
                                50000: KstestResult(statistic=0.45476000000000005, pvalue=0.0, statistic_location=-0.0011803778, statistic_sign=-1),
                                60000: KstestResult(statistic=0.45108333333333334, pvalue=0.0, statistic_location=-0.0012513725, statistic_sign=-1),
                                70000: KstestResult(statistic=0.4519714285714286, pvalue=0.0, statistic_location=-0.0011527389, statistic_sign=-1),
                                80000: KstestResult(statistic=0.4517875, pvalue=0.0, statistic_location=-0.0011798022, statistic_sign=-1),
                                90000: KstestResult(statistic=0.4528, pvalue=0.0, statistic_location=-0.0011797193, statistic_sign=-1),
                                100000: KstestResult(statistic=0.45092, pvalue=0.0, statistic_location=-0.0011159675, statistic_sign=-1),
                                110000: KstestResult(statistic=0.45092727272727273, pvalue=0.0, statistic_location=-0.0011766243, statistic_sign=-1)},
                   'moments': {'mean_error': 1.9998657,
                               'means': [0.0006159432, 8.630353e-06],
                               'stds': [0.023046242, 0.00044324173],
                               'variance_ratio': 3057.2605}},
 'originals': {'gan': {'mae': 0.10246770083904266,
                       'mse': 0.08953756093978882,
                       'psnr': 15.509014129638672,
                       'rmse': 0.2992282807826996,
                       'ssim': 0.8870315551757812},
               'pca': {'mae': 0.0005504278815351427,
                       'mse': 5.535228524422564e-07,
                       'psnr': 67.90528869628906,
                       'rmse': 0.0007439911714754999,
                       'ssim': 0.9999490976333618}},
 'reconstructions': {'mae': 0.10244803130626678,
                     'mse': 0.0895356684923172,
                     'psnr': 15.816688537597656,
                     'rmse': 0.2992251217365265,
                     'ssim': 0.8870032429695129},
 'residual_spectra_pcagan': {'cosine': [0.007607838,
                                        0.042925008,
                                        0.033228565,
                                        0.03103353,
                                        0.057407588,
                                        0.030776031,
                                        0.037609797,
                                        0.012147156,
                                        0.014333582,
                                        0.007428774,
                                        0.015739806],
                             'mae': [0.011424292,
                                     0.012160504,
                                     0.010266789,
                                     0.011231395,
                                     0.011178378,
                                     0.009498582,
                                     0.010249811,
                                     0.010807524,
                                     0.010316725,
                                     0.010103833,
                                     0.025215305],
                             'max_mae': 0.025215305,
                             'max_mse': 0.0031046707,
                             'max_rmse': 0.055719573,
                             'median_distance': 1.598204,
                             'median_mae': 0.010807524,
                             'min_cosine': 0.007428774,
                             'mse': [0.00028328062,
                                     0.00045602993,
                                     0.0002514355,
                                     0.00027882578,
                                     0.0003391119,
                                     0.00020853787,
                                     0.00020490332,
                                     0.00024720872,
                                     0.0002554256,
                                     0.00021432186,
                                     0.0031046707],
                             'rmse': [0.016830942,
                                      0.021354858,
                                      0.015856719,
                                      0.016698077,
                                      0.018414991,
                                      0.01444084,
                                      0.014314445,
                                      0.015722873,
                                      0.01598204,
                                      0.014639735,
                                      0.055719573]},
 'residuals': {'mae': 0.01204119436442852,
               'mse': 0.0005312501452863216,
               'psnr': -6.826257705688477,
               'rmse': 0.02304886467754841,
               'ssds': [58.465424, 0.021618953],
               'ssim': 0.586152195930481},
 'spectra_pcagan': {'cosine': [0.99906933,
                               0.99342376,
                               0.9957901,
                               0.9978222,
                               0.99875706,
                               0.9965685,
                               0.99719644,
                               0.99853486,
                               0.9972591,
                               0.9988357,
                               -0.6451584],
                    'mae': [0.015085768,
                            0.021782272,
                            0.018874375,
                            0.018763876,
                            0.014663577,
                            0.016081717,
                            0.017072493,
                            0.01551914,
                            0.016467419,
                            0.014205395,
                            0.9584123],
                    'max_mae': 0.9584123,
                    'max_mse': 0.980104,
                    'max_rmse': 0.99000204,
                    'median_mae': 0.016467419,
                    'min_cosine': -0.6451584,
                    'mse': [0.00038156132,
                            0.0007827734,
                            0.00059654453,
                            0.0005732683,
                            0.00037335415,
                            0.00044599146,
                            0.0004587783,
                            0.00038921737,
                            0.00045456958,
                            0.00033236388,
                            0.980104],
                    'rmse': [0.019533595,
                             0.027978089,
                             0.02442426,
                             0.023943022,
                             0.019322375,
                             0.02111851,
                             0.02141911,
                             0.019728594,
                             0.021320637,
                             0.01823085,
                             0.99000204]},
 'spectra_realgan': {'cosine': [0.9990692,
                                0.99339557,
                                0.9957802,
                                0.9978164,
                                0.9987539,
                                0.9965648,
                                0.9971878,
                                0.99853414,
                                0.9972531,
                                0.9988346,
                                -0.6451678],
                     'mae': [0.015093381,
                             0.021833964,
                             0.018908963,
                             0.018786782,
                             0.014685884,
                             0.016091805,
                             0.017106531,
                             0.0155229,
                             0.01648725,
                             0.014210399,
                             0.9584168],
                     'max_mae': 0.9584168,
                     'max_mse': 0.9801146,
                     'max_rmse': 0.99000734,
                     'median_mae': 0.01648725,
                     'min_cosine': -0.6451678,
                     'mse': [0.0003818063,
                             0.00078606466,
                             0.0005979706,
                             0.00057443226,
                             0.00037425582,
                             0.00044651356,
                             0.00046026282,
                             0.0003893895,
                             0.00045535964,
                             0.00033263088,
                             0.9801146],
                     'rmse': [0.019539865,
                              0.028036844,
                              0.024453437,
                              0.023967316,
                              0.019345693,
                              0.021130867,
                              0.021453736,
                              0.019732954,
                              0.021339158,
                              0.01823817,
                              0.99000734]},
 'spectra_realpca': {'cosine': [0.9999997,
                                0.9999903,
                                0.9999947,
                                0.99999607,
                                0.99999857,
                                0.99999666,
                                0.99999416,
                                0.99999946,
                                0.9999945,
                                0.9999992,
                                0.9999996],
                     'mae': [0.00029069724,
                             0.00084962195,
                             0.00066800986,
                             0.0007179821,
                             0.00052037445,
                             0.0005135345,
                             0.0007655578,
                             0.00035018375,
                             0.00074447814,
                             0.0003698437,
                             0.00026442367],
                     'max_mae': 0.00084962195,
                     'max_mse': 1.167058e-06,
                     'max_rmse': 0.0010803046,
                     'median_mae': 0.00052037445,
                     'min_cosine': 0.9999903,
                     'mse': [1.3651335e-07,
                             1.167058e-06,
                             7.16428e-07,
                             8.29822e-07,
                             4.3848203e-07,
                             4.2581652e-07,
                             9.483211e-07,
                             1.9987446e-07,
                             8.91552e-07,
                             2.2149999e-07,
                             1.133841e-07],
                     'rmse': [0.00036947714,
                              0.0010803046,
                              0.0008464207,
                              0.00091094564,
                              0.0006621798,
                              0.0006525462,
                              0.0009738178,
                              0.00044707322,
                              0.00094422034,
                              0.00047063784,
                              0.00033672556]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_90.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319
Directory path: experiments/inpainting/gann_4_night_20180901_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_90.0/images
Optimal number of principal components:  45
Reconstruction error:  3.2215178
Energy conservation:  0.90300375
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_90.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.940780002103074, 1.6314158619678043],
                   'kl_div': 1.6864916,
                   'ks_tests': {10000: KstestResult(statistic=0.373, pvalue=0.0, statistic_location=-0.0013371948, statistic_sign=-1),
                                20000: KstestResult(statistic=0.37689999999999996, pvalue=0.0, statistic_location=-0.0013736486, statistic_sign=-1),
                                30000: KstestResult(statistic=0.3748333333333333, pvalue=0.0, statistic_location=-0.0013209088, statistic_sign=-1),
                                40000: KstestResult(statistic=0.37475, pvalue=0.0, statistic_location=-0.00131822, statistic_sign=-1),
                                50000: KstestResult(statistic=0.37566, pvalue=0.0, statistic_location=-0.0011520386, statistic_sign=-1),
                                60000: KstestResult(statistic=0.37483333333333335, pvalue=0.0, statistic_location=-0.001273537, statistic_sign=-1),
                                70000: KstestResult(statistic=0.37422857142857147, pvalue=0.0, statistic_location=-0.0012810063, statistic_sign=-1),
                                80000: KstestResult(statistic=0.3742875, pvalue=0.0, statistic_location=-0.0012778705, statistic_sign=-1),
                                90000: KstestResult(statistic=0.37296666666666667, pvalue=0.0, statistic_location=-0.0011941157, statistic_sign=-1),
                                100000: KstestResult(statistic=0.37429, pvalue=0.0, statistic_location=-0.0013008942, statistic_sign=-1),
                                110000: KstestResult(statistic=0.3734272727272727, pvalue=0.0, statistic_location=-0.0012019258, statistic_sign=-1),
                                120000: KstestResult(statistic=0.3727833333333333, pvalue=0.0, statistic_location=-0.0012480225, statistic_sign=-1),
                                130000: KstestResult(statistic=0.3727692307692308, pvalue=0.0, statistic_location=-0.0012616413, statistic_sign=-1),
                                140000: KstestResult(statistic=0.3737714285714286, pvalue=0.0, statistic_location=-0.0012770724, statistic_sign=-1),
                                150000: KstestResult(statistic=0.3768066666666666, pvalue=0.0, statistic_location=-0.0013204399, statistic_sign=-1),
                                160000: KstestResult(statistic=0.37444374999999996, pvalue=0.0, statistic_location=-0.0013969354, statistic_sign=-1),
                                170000: KstestResult(statistic=0.37330588235294115, pvalue=0.0, statistic_location=-0.0012706518, statistic_sign=-1),
                                180000: KstestResult(statistic=0.37301666666666666, pvalue=0.0, statistic_location=-0.0013397932, statistic_sign=-1),
                                190000: KstestResult(statistic=0.3735157894736842, pvalue=0.0, statistic_location=-0.0012756176, statistic_sign=-1),
                                200000: KstestResult(statistic=0.37595, pvalue=0.0, statistic_location=-0.0013234862, statistic_sign=-1),
                                210000: KstestResult(statistic=0.37351428571428574, pvalue=0.0, statistic_location=-0.0013104482, statistic_sign=-1),
                                220000: KstestResult(statistic=0.37512272727272733, pvalue=0.0, statistic_location=-0.0013544234, statistic_sign=-1)},
                   'moments': {'mean_error': -0.010960376,
                               'means': [-0.00023313925, -6.789889e-06],
                               'stds': [0.0203259, 0.0021631124],
                               'variance_ratio': 99.93712}},
 'originals': {'gan': {'mae': 0.07914672046899796,
                       'mse': 0.05103886127471924,
                       'psnr': 18.142791748046875,
                       'rmse': 0.22591781616210938,
                       'ssim': 0.5751686096191406},
               'pca': {'mae': 0.0023917306680232286,
                       'mse': 2.901408697653096e-05,
                       'psnr': 50.86075210571289,
                       'rmse': 0.005386472679674625,
                       'ssim': 0.9999064207077026}},
 'reconstructions': {'mae': 0.07893633097410202,
                     'mse': 0.05101025477051735,
                     'psnr': 18.410266876220703,
                     'rmse': 0.22585450112819672,
                     'ssim': 0.5751811265945435},
 'residual_spectra_pcagan': {'cosine': [0.20819937,
                                        0.27155623,
                                        0.20324425,
                                        0.24290608,
                                        0.023250675,
                                        0.012687837,
                                        0.05040124,
                                        0.041255083,
                                        0.035111655,
                                        0.06527397,
                                        0.035352703,
                                        0.03962257,
                                        0.009013083,
                                        0.020135896,
                                        0.013784655,
                                        0.014700532,
                                        0.022045303,
                                        0.017741095,
                                        0.013801943,
                                        0.02135398,
                                        0.005198798,
                                        0.31442344],
                             'mae': [0.010284968,
                                     0.011029137,
                                     0.011547906,
                                     0.011115391,
                                     0.011175519,
                                     0.0112130875,
                                     0.011780129,
                                     0.009925911,
                                     0.010786321,
                                     0.010543587,
                                     0.009208352,
                                     0.010187082,
                                     0.010262258,
                                     0.009881823,
                                     0.009537376,
                                     0.025695805,
                                     0.010567337,
                                     0.012868927,
                                     0.011438144,
                                     0.0110006,
                                     0.011426003,
                                     0.008717993],
                             'max_mae': 0.025695805,
                             'max_mse': 0.003234736,
                             'max_rmse': 0.056874737,
                             'median_distance': 1.5830258,
                             'median_mae': 0.01089346,
                             'min_cosine': 0.005198798,
                             'mse': [0.00022799501,
                                     0.00034910723,
                                     0.0005471701,
                                     0.000339749,
                                     0.00031856252,
                                     0.00027167262,
                                     0.00041146332,
                                     0.000221669,
                                     0.00024744985,
                                     0.00027610484,
                                     0.0001860189,
                                     0.00020181289,
                                     0.00021247308,
                                     0.0002128259,
                                     0.00017655818,
                                     0.003234736,
                                     0.00021470692,
                                     0.00033345562,
                                     0.00025376418,
                                     0.00024437724,
                                     0.00031420813,
                                     0.0001879066],
                             'rmse': [0.015099504,
                                      0.018684411,
                                      0.023391668,
                                      0.018432282,
                                      0.01784832,
                                      0.016482495,
                                      0.020284558,
                                      0.014888553,
                                      0.01573054,
                                      0.016616402,
                                      0.0136388745,
                                      0.014206086,
                                      0.0145764565,
                                      0.014588553,
                                      0.01328752,
                                      0.056874737,
                                      0.014652881,
                                      0.018260768,
                                      0.015929978,
                                      0.01563257,
                                      0.017725917,
                                      0.013707902]},
 'residuals': {'mae': 0.011372438631951809,
               'mse': 0.00040835389518179,
               'psnr': 15.644698143005371,
               'rmse': 0.02020776830613613,
               'ssds': [90.90281, 1.0293976],
               'ssim': 0.6076171398162842},
 'spectra_pcagan': {'cosine': [0.96878713,
                               0.9873082,
                               0.97953176,
                               0.9872278,
                               0.9951403,
                               0.99905,
                               0.99336135,
                               0.99581856,
                               0.99782825,
                               0.9987881,
                               0.99669087,
                               0.9971275,
                               0.99852294,
                               0.99726266,
                               0.9988728,
                               -0.6445048,
                               0.99869096,
                               0.999483,
                               0.99916106,
                               0.9951105,
                               0.006222018,
                               0.9892529],
                    'mae': [0.035636045,
                            0.046108965,
                            0.033256546,
                            0.034500647,
                            0.01978285,
                            0.015093799,
                            0.02186616,
                            0.01879613,
                            0.018680839,
                            0.014525485,
                            0.015906014,
                            0.017337779,
                            0.0155513445,
                            0.01651276,
                            0.014026088,
                            0.95867634,
                            0.015735157,
                            0.014389229,
                            0.014919583,
                            0.022131952,
                            0.34483472,
                            0.028330656],
                    'max_mae': 0.95867634,
                    'max_mse': 0.98100656,
                    'max_rmse': 0.9904578,
                    'median_mae': 0.018738484,
                    'min_cosine': -0.6445048,
                    'mse': [0.0017785488,
                            0.0030002242,
                            0.0019570724,
                            0.001779654,
                            0.0006691836,
                            0.0003817599,
                            0.00078957056,
                            0.00058861444,
                            0.0005656239,
                            0.00036500345,
                            0.00043012906,
                            0.00047243215,
                            0.00039209248,
                            0.0004551115,
                            0.00032175155,
                            0.98100656,
                            0.00039538485,
                            0.00033319072,
                            0.0003597371,
                            0.00074455683,
                            0.12421692,
                            0.0012223659],
                    'rmse': [0.042172845,
                             0.054774303,
                             0.04423881,
                             0.042185944,
                             0.025868583,
                             0.019538676,
                             0.028099298,
                             0.024261378,
                             0.02378285,
                             0.019105064,
                             0.020739553,
                             0.021735504,
                             0.019801326,
                             0.021333342,
                             0.017937435,
                             0.9904578,
                             0.019884286,
                             0.018253513,
                             0.018966736,
                             0.027286569,
                             0.3524442,
                             0.03496235]},
 'spectra_realgan': {'cosine': [0.96707773,
                                0.98607415,
                                0.97805583,
                                0.98576266,
                                0.99513245,
                                0.99904984,
                                0.9933339,
                                0.9958082,
                                0.9978229,
                                0.99878514,
                                0.9966867,
                                0.99711907,
                                0.9985223,
                                0.9972568,
                                0.99887174,
                                -0.6445143,
                                0.9986886,
                                0.999483,
                                0.9991609,
                                0.9950984,
                                0.0062071052,
                                0.98793995],
                     'mae': [0.036378093,
                             0.0465897,
                             0.03425796,
                             0.035526946,
                             0.019814078,
                             0.015101416,
                             0.021917768,
                             0.018824093,
                             0.018703582,
                             0.014546561,
                             0.015915798,
                             0.01737127,
                             0.015557684,
                             0.016533103,
                             0.01403134,
                             0.95868087,
                             0.015744949,
                             0.01439047,
                             0.014926622,
                             0.022162836,
                             0.3448362,
                             0.02941636],
                     'max_mae': 0.95868087,
                     'max_mse': 0.9810172,
                     'max_rmse': 0.99046314,
                     'median_mae': 0.018763836,
                     'min_cosine': -0.6445143,
                     'mse': [0.0018786228,
                             0.0031433392,
                             0.0020680919,
                             0.0019107151,
                             0.00067014835,
                             0.00038198847,
                             0.0007927804,
                             0.0005900724,
                             0.0005667445,
                             0.00036588663,
                             0.00043069228,
                             0.00047388757,
                             0.00039225363,
                             0.00045585455,
                             0.00032200073,
                             0.9810172,
                             0.000395906,
                             0.0003332654,
                             0.0003599177,
                             0.0007465498,
                             0.12421838,
                             0.0013407585],
                     'rmse': [0.043343082,
                              0.05606549,
                              0.045476276,
                              0.04371173,
                              0.025887223,
                              0.019544525,
                              0.028156357,
                              0.024291405,
                              0.023806395,
                              0.019128164,
                              0.020753127,
                              0.02176896,
                              0.019805394,
                              0.02135075,
                              0.017944379,
                              0.99046314,
                              0.019897386,
                              0.018255558,
                              0.018971497,
                              0.027323063,
                              0.3524463,
                              0.03661637]},
 'spectra_realpca': {'cosine': [0.99879366,
                                0.99890316,
                                0.9985134,
                                0.99843466,
                                0.99999,
                                0.9999997,
                                0.9999903,
                                0.9999947,
                                0.99999607,
                                0.99999857,
                                0.99999666,
                                0.99999416,
                                0.99999946,
                                0.9999945,
                                0.9999992,
                                0.9999996,
                                0.9999989,
                                0.9999998,
                                0.9999994,
                                0.9999945,
                                0.9999963,
                                0.9986523],
                     'mae': [0.006605005,
                             0.010041829,
                             0.008484332,
                             0.009586884,
                             0.00084417255,
                             0.00029069724,
                             0.00084962195,
                             0.00066800986,
                             0.0007179821,
                             0.00052037445,
                             0.0005135345,
                             0.0007655578,
                             0.00035018375,
                             0.00074447814,
                             0.0003698437,
                             0.00026442367,
                             0.0004132921,
                             0.0002360445,
                             0.000302466,
                             0.00069559907,
                             0.00049030135,
                             0.008863435],
                     'max_mae': 0.010041829,
                     'max_mse': 0.00016901008,
                     'max_rmse': 0.013000388,
                     'median_mae': 0.0006818045,
                     'min_cosine': 0.99843466,
                     'mse': [6.980917e-05,
                             0.00016901008,
                             0.00011628542,
                             0.00014723183,
                             1.1436915e-06,
                             1.3651335e-07,
                             1.167058e-06,
                             7.16428e-07,
                             8.29822e-07,
                             4.3848203e-07,
                             4.2581652e-07,
                             9.483211e-07,
                             1.9987446e-07,
                             8.91552e-07,
                             2.2149999e-07,
                             1.133841e-07,
                             2.729707e-07,
                             9.0619814e-08,
                             1.4611372e-07,
                             7.8185155e-07,
                             3.8777296e-07,
                             0.00012706152],
                     'rmse': [0.008355188,
                              0.013000388,
                              0.010783572,
                              0.012133912,
                              0.0010694352,
                              0.00036947714,
                              0.0010803046,
                              0.0008464207,
                              0.00091094564,
                              0.0006621798,
                              0.0006525462,
                              0.0009738178,
                              0.00044707322,
                              0.00094422034,
                              0.00047063784,
                              0.00033672556,
                              0.00052246597,
                              0.00030103125,
                              0.00038224825,
                              0.00088422373,
                              0.0006227142,
                              0.011272157]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_90.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809
Directory path: experiments/inpainting/gann_4_night_20180901_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_90.0/images
Optimal number of principal components:  45
Reconstruction error:  3.2215178
Energy conservation:  0.90300375
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_90.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9130967822707543, 1.7874344490991825],
                   'kl_div': 1.5015501,
                   'ks_tests': {10000: KstestResult(statistic=0.3534, pvalue=0.0, statistic_location=-0.0021820273, statistic_sign=-1),
                                20000: KstestResult(statistic=0.36205000000000004, pvalue=0.0, statistic_location=-0.0019092234, statistic_sign=-1),
                                30000: KstestResult(statistic=0.3484, pvalue=0.0, statistic_location=-0.0019557192, statistic_sign=-1),
                                40000: KstestResult(statistic=0.35175, pvalue=0.0, statistic_location=-0.0019576382, statistic_sign=-1),
                                50000: KstestResult(statistic=0.35376, pvalue=0.0, statistic_location=-0.0019700853, statistic_sign=-1),
                                60000: KstestResult(statistic=0.35559999999999997, pvalue=0.0, statistic_location=-0.0020005456, statistic_sign=-1),
                                70000: KstestResult(statistic=0.35627142857142857, pvalue=0.0, statistic_location=-0.0020852387, statistic_sign=-1),
                                80000: KstestResult(statistic=0.35872499999999996, pvalue=0.0, statistic_location=-0.001738972, statistic_sign=-1),
                                90000: KstestResult(statistic=0.3592777777777778, pvalue=0.0, statistic_location=-0.0018708743, statistic_sign=-1),
                                100000: KstestResult(statistic=0.35385, pvalue=0.0, statistic_location=-0.0018401388, statistic_sign=-1),
                                110000: KstestResult(statistic=0.35675454545454544, pvalue=0.0, statistic_location=-0.0018606642, statistic_sign=-1),
                                120000: KstestResult(statistic=0.35660000000000003, pvalue=0.0, statistic_location=-0.001958944, statistic_sign=-1),
                                130000: KstestResult(statistic=0.35605384615384617, pvalue=0.0, statistic_location=-0.00195745, statistic_sign=-1),
                                140000: KstestResult(statistic=0.3525214285714286, pvalue=0.0, statistic_location=-0.0019390788, statistic_sign=-1),
                                150000: KstestResult(statistic=0.3549933333333333, pvalue=0.0, statistic_location=-0.00199854, statistic_sign=-1),
                                160000: KstestResult(statistic=0.35509999999999997, pvalue=0.0, statistic_location=-0.00198266, statistic_sign=-1),
                                170000: KstestResult(statistic=0.3567588235294118, pvalue=0.0, statistic_location=-0.0019569518, statistic_sign=-1),
                                180000: KstestResult(statistic=0.3542722222222222, pvalue=0.0, statistic_location=-0.0020014197, statistic_sign=-1),
                                190000: KstestResult(statistic=0.3569157894736842, pvalue=0.0, statistic_location=-0.0019570338, statistic_sign=-1),
                                200000: KstestResult(statistic=0.35762000000000005, pvalue=0.0, statistic_location=-0.0019530961, statistic_sign=-1),
                                210000: KstestResult(statistic=0.3541047619047619, pvalue=0.0, statistic_location=-0.0019798647, statistic_sign=-1),
                                220000: KstestResult(statistic=0.35824545454545453, pvalue=0.0, statistic_location=-0.0018493384, statistic_sign=-1),
                                230000: KstestResult(statistic=0.3560608695652174, pvalue=0.0, statistic_location=-0.0019785822, statistic_sign=-1),
                                240000: KstestResult(statistic=0.35639583333333336, pvalue=0.0, statistic_location=-0.001982689, statistic_sign=-1),
                                250000: KstestResult(statistic=0.35612, pvalue=0.0, statistic_location=-0.0018520681, statistic_sign=-1),
                                260000: KstestResult(statistic=0.35493846153846154, pvalue=0.0, statistic_location=-0.0018832558, statistic_sign=-1),
                                270000: KstestResult(statistic=0.35533703703703706, pvalue=0.0, statistic_location=-0.0018602116, statistic_sign=-1),
                                280000: KstestResult(statistic=0.3557392857142857, pvalue=0.0, statistic_location=-0.0019785822, statistic_sign=-1),
                                290000: KstestResult(statistic=0.35678275862068964, pvalue=0.0, statistic_location=-0.0017659254, statistic_sign=-1),
                                300000: KstestResult(statistic=0.3570066666666667, pvalue=0.0, statistic_location=-0.0019800412, statistic_sign=-1),
                                310000: KstestResult(statistic=0.35520322580645164, pvalue=0.0, statistic_location=-0.0019787364, statistic_sign=-1),
                                320000: KstestResult(statistic=0.35525937500000004, pvalue=0.0, statistic_location=-0.0020086481, statistic_sign=-1),
                                330000: KstestResult(statistic=0.3549969696969697, pvalue=0.0, statistic_location=-0.001976788, statistic_sign=-1)},
                   'moments': {'mean_error': -0.10584617,
                               'means': [-0.00039741758, -4.1672288e-07],
                               'stds': [0.018622587, 0.0021530616],
                               'variance_ratio': 75.4579}},
 'originals': {'gan': {'mae': 0.061107736080884933,
                       'mse': 0.034383442252874374,
                       'psnr': 19.85433006286621,
                       'rmse': 0.185427725315094,
                       'ssim': 0.6147012710571289},
               'pca': {'mae': 0.002599953208118677,
                       'mse': 2.7863568902830593e-05,
                       'psnr': 51.036476135253906,
                       'rmse': 0.005278595257550478,
                       'ssim': 0.9988943934440613}},
 'reconstructions': {'mae': 0.060876425355672836,
                     'mse': 0.03435593843460083,
                     'psnr': 20.12682342529297,
                     'rmse': 0.18535354733467102,
                     'ssim': 0.6153132319450378},
 'residual_spectra_pcagan': {'cosine': [0.07258415,
                                        0.12888211,
                                        0.16481857,
                                        0.07379759,
                                        0.14560032,
                                        0.15332949,
                                        0.23652841,
                                        0.30065724,
                                        0.22125715,
                                        0.24500139,
                                        0.023261301,
                                        0.015011086,
                                        0.05252925,
                                        0.03810694,
                                        0.039887175,
                                        0.058234867,
                                        0.03839103,
                                        0.050060283,
                                        0.009521454,
                                        0.026101857,
                                        0.015554435,
                                        0.01409891,
                                        0.02214201,
                                        0.017925441,
                                        0.019216962,
                                        0.021198105,
                                        0.014661055,
                                        0.34187254,
                                        0.26669294,
                                        0.018687181,
                                        0.01986516,
                                        0.025970848,
                                        0.006047795],
                             'mae': [0.009817632,
                                     0.008910762,
                                     0.00926056,
                                     0.009296204,
                                     0.008932627,
                                     0.010847497,
                                     0.009838883,
                                     0.01034647,
                                     0.010869666,
                                     0.011055463,
                                     0.010855617,
                                     0.010790034,
                                     0.01155756,
                                     0.009595464,
                                     0.010401854,
                                     0.0101981,
                                     0.009124342,
                                     0.009986584,
                                     0.009822709,
                                     0.009669401,
                                     0.009312686,
                                     0.025856927,
                                     0.01032919,
                                     0.012581248,
                                     0.010982822,
                                     0.01077334,
                                     0.011167443,
                                     0.008210724,
                                     0.00966073,
                                     0.011970673,
                                     0.011193299,
                                     0.011571174,
                                     0.010041321],
                             'max_mae': 0.025856927,
                             'max_mse': 0.0033107533,
                             'max_rmse': 0.057539146,
                             'median_distance': 1.5279495,
                             'median_mae': 0.01032919,
                             'min_cosine': 0.006047795,
                             'mse': [0.00023346291,
                                     0.00017259033,
                                     0.00022788496,
                                     0.00018582954,
                                     0.00016537227,
                                     0.00034352555,
                                     0.00019455481,
                                     0.00028561757,
                                     0.0004558278,
                                     0.0003360311,
                                     0.00028816718,
                                     0.00024523117,
                                     0.0003589438,
                                     0.0001968211,
                                     0.00022727509,
                                     0.00024124027,
                                     0.00018438627,
                                     0.00019360831,
                                     0.00018362133,
                                     0.00019265669,
                                     0.00016864328,
                                     0.0033107533,
                                     0.00020230842,
                                     0.00031594557,
                                     0.00022870832,
                                     0.00023389808,
                                     0.00030287786,
                                     0.000154654,
                                     0.00024006868,
                                     0.0004640276,
                                     0.00027959305,
                                     0.00027300342,
                                     0.00021267557],
                             'rmse': [0.015279493,
                                      0.013137364,
                                      0.015095859,
                                      0.013631931,
                                      0.012859715,
                                      0.018534442,
                                      0.013948291,
                                      0.016900225,
                                      0.021350125,
                                      0.018331151,
                                      0.016975489,
                                      0.01565986,
                                      0.018945811,
                                      0.014029294,
                                      0.015075645,
                                      0.0155319115,
                                      0.013578891,
                                      0.013914321,
                                      0.013550695,
                                      0.013880082,
                                      0.012986273,
                                      0.057539146,
                                      0.014223517,
                                      0.017774858,
                                      0.015123106,
                                      0.015293727,
                                      0.017403387,
                                      0.012435996,
                                      0.01549415,
                                      0.0215413,
                                      0.016721036,
                                      0.016522815,
                                      0.0145834]},
 'residuals': {'mae': 0.010752393864095211,
               'mse': 0.00034241832327097654,
               'psnr': 16.409496307373047,
               'rmse': 0.018504548817873,
               'ssds': [114.495995, 1.5297679],
               'ssim': 0.6073493957519531},
 'spectra_pcagan': {'cosine': [0.98136544,
                               0.97959274,
                               0.9839475,
                               0.9858758,
                               0.98187035,
                               0.9823365,
                               0.9685568,
                               0.9876515,
                               0.9803239,
                               0.98745936,
                               0.99519956,
                               0.9990498,
                               0.9932828,
                               0.99577373,
                               0.9978535,
                               0.99877405,
                               0.99656916,
                               0.99712276,
                               0.9985001,
                               0.997211,
                               0.9988248,
                               -0.6458947,
                               0.9986561,
                               0.99946666,
                               0.9991672,
                               0.99486685,
                               0.007402606,
                               0.9891763,
                               0.9795213,
                               0.97279656,
                               0.99950594,
                               0.9982007,
                               0.9990265],
                    'mae': [0.025342258,
                            0.027974734,
                            0.023455707,
                            0.024324555,
                            0.026220514,
                            0.02705738,
                            0.035857636,
                            0.04593403,
                            0.032943144,
                            0.034538057,
                            0.019374194,
                            0.015152728,
                            0.02195878,
                            0.018828517,
                            0.018525777,
                            0.014649417,
                            0.016045997,
                            0.017280884,
                            0.015696492,
                            0.0166135,
                            0.014269731,
                            0.9591965,
                            0.015906584,
                            0.014693115,
                            0.014891778,
                            0.022562152,
                            0.3443522,
                            0.028630765,
                            0.036784876,
                            0.03248206,
                            0.014725692,
                            0.01794232,
                            0.014709877],
                    'max_mae': 0.9591965,
                    'max_mse': 0.9814788,
                    'max_rmse': 0.99069613,
                    'median_mae': 0.02195878,
                    'min_cosine': -0.6458947,
                    'mse': [0.0010657909,
                            0.00117477,
                            0.00094525795,
                            0.0009317836,
                            0.0010409,
                            0.0012321756,
                            0.0017935119,
                            0.0029777482,
                            0.0019176742,
                            0.0018050392,
                            0.0006375617,
                            0.00038133722,
                            0.0007972965,
                            0.00058923615,
                            0.0005555715,
                            0.00037048315,
                            0.00044252953,
                            0.0004693017,
                            0.00039803708,
                            0.00046364413,
                            0.00033550683,
                            0.9814788,
                            0.0004069779,
                            0.00034574614,
                            0.00035909106,
                            0.0007744485,
                            0.12383513,
                            0.0012404913,
                            0.0020561886,
                            0.001688023,
                            0.00036080688,
                            0.0005117318,
                            0.0003633542],
                    'rmse': [0.03264645,
                             0.034274917,
                             0.030745048,
                             0.030525131,
                             0.03226298,
                             0.03510236,
                             0.042349875,
                             0.05456875,
                             0.043791257,
                             0.042485755,
                             0.025249984,
                             0.019527858,
                             0.02823644,
                             0.024274187,
                             0.023570566,
                             0.019247938,
                             0.021036386,
                             0.021663373,
                             0.019950867,
                             0.021532398,
                             0.018316846,
                             0.99069613,
                             0.020173693,
                             0.01859425,
                             0.018949699,
                             0.027828915,
                             0.35190216,
                             0.035220608,
                             0.045345217,
                             0.041085556,
                             0.018994918,
                             0.02262149,
                             0.019061852]},
 'spectra_realgan': {'cosine': [0.98116386,
                                0.97929037,
                                0.9832459,
                                0.9857795,
                                0.98146755,
                                0.9815614,
                                0.96684116,
                                0.98640144,
                                0.97883934,
                                0.9860043,
                                0.99519145,
                                0.99904966,
                                0.99325377,
                                0.9957636,
                                0.99784756,
                                0.9987712,
                                0.99656504,
                                0.9971139,
                                0.9984995,
                                0.99720556,
                                0.9988238,
                                -0.64590394,
                                0.9986539,
                                0.99946684,
                                0.99916697,
                                0.9948543,
                                0.007387795,
                                0.9878667,
                                0.97839355,
                                0.9726017,
                                0.9995058,
                                0.99819803,
                                0.9990261],
                     'mae': [0.025522912,
                             0.028190412,
                             0.024054034,
                             0.024406036,
                             0.026515173,
                             0.027656525,
                             0.036609527,
                             0.046447765,
                             0.03395886,
                             0.035577223,
                             0.019405749,
                             0.015161326,
                             0.022015965,
                             0.01885729,
                             0.01854867,
                             0.01466662,
                             0.016057812,
                             0.017318537,
                             0.015700994,
                             0.016630538,
                             0.014273221,
                             0.959201,
                             0.015915649,
                             0.014694309,
                             0.014899017,
                             0.022593575,
                             0.34435368,
                             0.029696845,
                             0.0376104,
                             0.032620087,
                             0.014727992,
                             0.01795008,
                             0.014717307],
                     'max_mae': 0.959201,
                     'max_mse': 0.98148924,
                     'max_rmse': 0.9907014,
                     'median_mae': 0.022015965,
                     'min_cosine': -0.64590394,
                     'mse': [0.0010776059,
                             0.0011927172,
                             0.0009870948,
                             0.00093792536,
                             0.0010650415,
                             0.001281717,
                             0.001894068,
                             0.003122616,
                             0.0020291505,
                             0.0019350144,
                             0.00063854625,
                             0.0003815742,
                             0.0008006507,
                             0.00059065723,
                             0.0005567575,
                             0.00037130885,
                             0.00044307805,
                             0.00047080012,
                             0.00039820714,
                             0.00046431675,
                             0.00033573533,
                             0.98148924,
                             0.00040745505,
                             0.00034583913,
                             0.00035928728,
                             0.0007764904,
                             0.12383656,
                             0.0013584461,
                             0.0021697655,
                             0.0016991043,
                             0.0003608162,
                             0.00051253336,
                             0.00036351415],
                     'rmse': [0.032826908,
                              0.03453574,
                              0.031418066,
                              0.030625567,
                              0.032634974,
                              0.035801075,
                              0.04352089,
                              0.05588037,
                              0.045046095,
                              0.043988798,
                              0.025269473,
                              0.019533925,
                              0.028295772,
                              0.02430344,
                              0.02359571,
                              0.019269375,
                              0.02104942,
                              0.02169793,
                              0.019955128,
                              0.02154801,
                              0.018323082,
                              0.9907014,
                              0.020185515,
                              0.01859675,
                              0.018954875,
                              0.027865577,
                              0.35190418,
                              0.036857102,
                              0.046580743,
                              0.041220192,
                              0.018995162,
                              0.0226392,
                              0.019066047]},
 'spectra_realpca': {'cosine': [0.99982387,
                                0.99974495,
                                0.99931747,
                                0.99994874,
                                0.9996314,
                                0.99919176,
                                0.99879366,
                                0.99890316,
                                0.9985134,
                                0.99843466,
                                0.99999,
                                0.9999997,
                                0.9999903,
                                0.9999947,
                                0.99999607,
                                0.99999857,
                                0.99999666,
                                0.99999416,
                                0.99999946,
                                0.9999945,
                                0.9999992,
                                0.9999996,
                                0.9999989,
                                0.9999998,
                                0.9999994,
                                0.9999945,
                                0.9999963,
                                0.9986523,
                                0.9985822,
                                0.99990964,
                                0.9999998,
                                0.9999986,
                                0.9999992],
                     'mae': [0.0024788124,
                             0.003022507,
                             0.0049250205,
                             0.0014067163,
                             0.0036307934,
                             0.005531617,
                             0.006605005,
                             0.010041829,
                             0.008484332,
                             0.009586884,
                             0.00084417255,
                             0.00029069724,
                             0.00084962195,
                             0.00066800986,
                             0.0007179821,
                             0.00052037445,
                             0.0005135345,
                             0.0007655578,
                             0.00035018375,
                             0.00074447814,
                             0.0003698437,
                             0.00026442367,
                             0.0004132921,
                             0.0002360445,
                             0.000302466,
                             0.00069559907,
                             0.00049030135,
                             0.008863435,
                             0.009222512,
                             0.0018330672,
                             0.00022637306,
                             0.0004949275,
                             0.00040803777],
                     'max_mae': 0.010041829,
                     'max_mse': 0.00016901008,
                     'max_rmse': 0.013000388,
                     'median_mae': 0.00074447814,
                     'min_cosine': 0.99843466,
                     'mse': [9.993707e-06,
                             1.4678806e-05,
                             3.8860737e-05,
                             3.1632878e-06,
                             2.1233445e-05,
                             4.9168535e-05,
                             6.980917e-05,
                             0.00016901008,
                             0.00011628542,
                             0.00014723183,
                             1.1436915e-06,
                             1.3651335e-07,
                             1.167058e-06,
                             7.16428e-07,
                             8.29822e-07,
                             4.3848203e-07,
                             4.2581652e-07,
                             9.483211e-07,
                             1.9987446e-07,
                             8.91552e-07,
                             2.2149999e-07,
                             1.133841e-07,
                             2.729707e-07,
                             9.0619814e-08,
                             1.4611372e-07,
                             7.8185155e-07,
                             3.8777296e-07,
                             0.00012706152,
                             0.00013798095,
                             5.362305e-06,
                             8.251675e-08,
                             3.9690045e-07,
                             2.6683003e-07],
                     'rmse': [0.0031612825,
                              0.003831293,
                              0.006233838,
                              0.0017785634,
                              0.0046079764,
                              0.007012028,
                              0.008355188,
                              0.013000388,
                              0.010783572,
                              0.012133912,
                              0.0010694352,
                              0.00036947714,
                              0.0010803046,
                              0.0008464207,
                              0.00091094564,
                              0.0006621798,
                              0.0006525462,
                              0.0009738178,
                              0.00044707322,
                              0.00094422034,
                              0.00047063784,
                              0.00033672556,
                              0.00052246597,
                              0.00030103125,
                              0.00038224825,
                              0.00088422373,
                              0.0006227142,
                              0.011272157,
                              0.0117465295,
                              0.0023156651,
                              0.00028725728,
                              0.0006300004,
                              0.0005165559]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_90.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521
Directory path: experiments/inpainting/gann_4_night_20180904_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_90.0/images
Optimal number of principal components:  47
Reconstruction error:  2.2549512
Energy conservation:  0.90778536
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_90.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9519870688369956, 0.6991866940650064],
                   'kl_div': 2.6491575,
                   'ks_tests': {10000: KstestResult(statistic=0.5287, pvalue=0.0, statistic_location=0.0006788322, statistic_sign=1),
                                20000: KstestResult(statistic=0.525, pvalue=0.0, statistic_location=0.00070488104, statistic_sign=1),
                                30000: KstestResult(statistic=0.5216000000000001, pvalue=0.0, statistic_location=0.00072193716, statistic_sign=1),
                                40000: KstestResult(statistic=0.52295, pvalue=0.0, statistic_location=0.00072149653, statistic_sign=1),
                                50000: KstestResult(statistic=0.52108, pvalue=0.0, statistic_location=0.00071354886, statistic_sign=1),
                                60000: KstestResult(statistic=0.5241499999999999, pvalue=0.0, statistic_location=0.00072149653, statistic_sign=1),
                                70000: KstestResult(statistic=0.5222714285714286, pvalue=0.0, statistic_location=0.00071411394, statistic_sign=1),
                                80000: KstestResult(statistic=0.5236500000000001, pvalue=0.0, statistic_location=0.00072421087, statistic_sign=1),
                                90000: KstestResult(statistic=0.5205, pvalue=0.0, statistic_location=0.0007143654, statistic_sign=1),
                                100000: KstestResult(statistic=0.5225900000000001, pvalue=0.0, statistic_location=0.00072588027, statistic_sign=1),
                                110000: KstestResult(statistic=0.5210818181818182, pvalue=0.0, statistic_location=0.00072193716, statistic_sign=1)},
                   'moments': {'mean_error': 5.582871,
                               'means': [0.00041185232, -2.5196292e-07],
                               'stds': [0.018056862, 0.00022867702],
                               'variance_ratio': 5702.681}},
 'originals': {'gan': {'mae': 0.015457754954695702,
                       'mse': 0.00040660073864273727,
                       'psnr': 33.48316192626953,
                       'rmse': 0.02016434259712696,
                       'ssim': 0.9744047522544861},
               'pca': {'mae': 0.00025080505292862654,
                       'mse': 1.1968192836775415e-07,
                       'psnr': 69.21971130371094,
                       'rmse': 0.00034595077158883214,
                       'ssim': 0.999994695186615}},
 'reconstructions': {'mae': 0.0154547905549407,
                     'mse': 0.0004064462555106729,
                     'psnr': 33.90996551513672,
                     'rmse': 0.020160512998700142,
                     'ssim': 0.9744091033935547},
 'residual_spectra_pcagan': {'cosine': [0.01931781,
                                        0.024363803,
                                        0.02496021,
                                        0.02751141,
                                        -0.013719996,
                                        -0.0044994503,
                                        0.016700957,
                                        0.030723788,
                                        -0.00031887201,
                                        0.030081842,
                                        0.0043973047],
                             'mae': [0.0112614995,
                                     0.013142102,
                                     0.012191328,
                                     0.011826037,
                                     0.013410748,
                                     0.011489108,
                                     0.011103603,
                                     0.010493618,
                                     0.010647989,
                                     0.010407223,
                                     0.0108172875],
                             'max_mae': 0.013410748,
                             'max_mse': 0.0005393818,
                             'max_rmse': 0.023224596,
                             'median_distance': 1.7366831,
                             'median_mae': 0.0112614995,
                             'min_cosine': -0.013719996,
                             'mse': [0.00026690992,
                                     0.00048510276,
                                     0.00031826817,
                                     0.00029327086,
                                     0.0005393818,
                                     0.00030199203,
                                     0.0002855388,
                                     0.00025466463,
                                     0.00030160684,
                                     0.00023572076,
                                     0.00030516152],
                             'rmse': [0.016337378,
                                      0.022025049,
                                      0.017840073,
                                      0.017125152,
                                      0.023224596,
                                      0.017377919,
                                      0.016897893,
                                      0.015958214,
                                      0.017366832,
                                      0.0153532,
                                      0.017468873]},
 'residuals': {'mae': 0.011526414193212986,
               'mse': 0.0003261471283622086,
               'psnr': -14.946855545043945,
               'rmse': 0.018059544265270233,
               'ssds': [35.88386, 0.005752206],
               'ssim': 0.2911563515663147},
 'spectra_pcagan': {'cosine': [0.999213,
                               0.9991766,
                               0.999169,
                               0.99960136,
                               0.9997203,
                               0.99956834,
                               0.99955654,
                               0.9992274,
                               0.9983768,
                               0.99857605,
                               0.99812627],
                    'mae': [0.016232671,
                            0.016155323,
                            0.016557833,
                            0.014099537,
                            0.0133701535,
                            0.013903105,
                            0.01364825,
                            0.014644766,
                            0.01714414,
                            0.016996203,
                            0.017250711],
                    'max_mae': 0.017250711,
                    'max_mse': 0.00051640323,
                    'max_rmse': 0.022724507,
                    'median_mae': 0.016155323,
                    'min_cosine': 0.99812627,
                    'mse': [0.00043037394,
                            0.00046921463,
                            0.00044506683,
                            0.00031667185,
                            0.00032562576,
                            0.00031651635,
                            0.0003063672,
                            0.0003579588,
                            0.00051640323,
                            0.00047699097,
                            0.00050971913],
                    'rmse': [0.020745456,
                             0.021661364,
                             0.021096608,
                             0.017795276,
                             0.018045103,
                             0.017790906,
                             0.01750335,
                             0.0189198,
                             0.022724507,
                             0.021840123,
                             0.02257696]},
 'spectra_realgan': {'cosine': [0.9992129,
                                0.9991766,
                                0.99916834,
                                0.9996012,
                                0.9997202,
                                0.99956834,
                                0.9995566,
                                0.9992268,
                                0.99837583,
                                0.9985749,
                                0.9981261],
                     'mae': [0.016235517,
                             0.016155306,
                             0.016565733,
                             0.014100333,
                             0.013370853,
                             0.01390226,
                             0.013647394,
                             0.014649869,
                             0.01715369,
                             0.01700465,
                             0.017249702],
                     'max_mae': 0.017249702,
                     'max_mse': 0.0005167167,
                     'max_rmse': 0.022731403,
                     'median_mae': 0.016155306,
                     'min_cosine': 0.9981261,
                     'mse': [0.00043045913,
                             0.00046927432,
                             0.00044543663,
                             0.00031674924,
                             0.00032558426,
                             0.00031651903,
                             0.00030636988,
                             0.00035822386,
                             0.0005167167,
                             0.0004775138,
                             0.00050976145],
                     'rmse': [0.020747509,
                              0.02166274,
                              0.02110537,
                              0.01779745,
                              0.018043954,
                              0.017790982,
                              0.017503425,
                              0.018926803,
                              0.022731403,
                              0.02185209,
                              0.022577897]},
 'spectra_realpca': {'cosine': [0.9999998,
                                0.99999976,
                                0.9999999,
                                1.0,
                                1.0,
                                0.99999994,
                                0.99999994,
                                0.99999946,
                                0.9999995,
                                0.9999991,
                                0.99999934],
                     'mae': [0.00029873475,
                             0.00023191416,
                             0.00025125043,
                             0.00011709385,
                             8.298529e-05,
                             0.0001778177,
                             0.00013216968,
                             0.00037335404,
                             0.00033493093,
                             0.00041530508,
                             0.00034329938],
                     'max_mae': 0.00041530508,
                     'max_mse': 2.7680176e-07,
                     'max_rmse': 0.00052611955,
                     'median_mae': 0.00025125043,
                     'min_cosine': 0.9999991,
                     'mse': [1.4352861e-07,
                             8.54854e-08,
                             1.01461374e-07,
                             2.2148727e-08,
                             1.1049369e-08,
                             5.1303306e-08,
                             2.8009971e-08,
                             2.2659965e-07,
                             1.8177852e-07,
                             2.7680176e-07,
                             1.8833443e-07],
                     'rmse': [0.0003788517,
                              0.00029237886,
                              0.00031853002,
                              0.00014882449,
                              0.00010511598,
                              0.00022650234,
                              0.0001673618,
                              0.00047602484,
                              0.0004263549,
                              0.00052611955,
                              0.00043397513]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_90.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743
Directory path: experiments/inpainting/gann_4_night_20180904_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_90.0/images
Optimal number of principal components:  47
Reconstruction error:  2.2549512
Energy conservation:  0.90778536
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_90.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9538435048012626, 0.7478142099574434],
                   'kl_div': 2.571007,
                   'ks_tests': {10000: KstestResult(statistic=0.4752, pvalue=0.0, statistic_location=0.0008688214, statistic_sign=1),
                                20000: KstestResult(statistic=0.46765, pvalue=0.0, statistic_location=0.00090136135, statistic_sign=1),
                                30000: KstestResult(statistic=0.46676666666666666, pvalue=0.0, statistic_location=0.0009105534, statistic_sign=1),
                                40000: KstestResult(statistic=0.46877500000000005, pvalue=0.0, statistic_location=0.0009002038, statistic_sign=1),
                                50000: KstestResult(statistic=0.4696, pvalue=0.0, statistic_location=0.0008543227, statistic_sign=1),
                                60000: KstestResult(statistic=0.46773333333333333, pvalue=0.0, statistic_location=0.00090230815, statistic_sign=1),
                                70000: KstestResult(statistic=0.4704142857142858, pvalue=0.0, statistic_location=0.00085991446, statistic_sign=1),
                                80000: KstestResult(statistic=0.46938750000000007, pvalue=0.0, statistic_location=0.0008758593, statistic_sign=1),
                                90000: KstestResult(statistic=0.4693555555555555, pvalue=0.0, statistic_location=0.0008972399, statistic_sign=1),
                                100000: KstestResult(statistic=0.46965, pvalue=0.0, statistic_location=0.00089287106, statistic_sign=1),
                                110000: KstestResult(statistic=0.4674636363636363, pvalue=0.0, statistic_location=0.00090230815, statistic_sign=1),
                                120000: KstestResult(statistic=0.4667083333333334, pvalue=0.0, statistic_location=0.0008966143, statistic_sign=1),
                                130000: KstestResult(statistic=0.4719923076923077, pvalue=0.0, statistic_location=0.00089731487, statistic_sign=1),
                                140000: KstestResult(statistic=0.46817142857142857, pvalue=0.0, statistic_location=0.00089937774, statistic_sign=1),
                                150000: KstestResult(statistic=0.4684933333333333, pvalue=0.0, statistic_location=0.0008972089, statistic_sign=1),
                                160000: KstestResult(statistic=0.4673125, pvalue=0.0, statistic_location=0.00090136135, statistic_sign=1),
                                170000: KstestResult(statistic=0.46978823529411773, pvalue=0.0, statistic_location=0.0009103493, statistic_sign=1),
                                180000: KstestResult(statistic=0.4692333333333334, pvalue=0.0, statistic_location=0.0008972399, statistic_sign=1),
                                190000: KstestResult(statistic=0.4675263157894737, pvalue=0.0, statistic_location=0.00089814677, statistic_sign=1),
                                200000: KstestResult(statistic=0.46765500000000004, pvalue=0.0, statistic_location=0.0008972399, statistic_sign=1),
                                210000: KstestResult(statistic=0.4680047619047619, pvalue=0.0, statistic_location=0.00089268107, statistic_sign=1),
                                220000: KstestResult(statistic=0.46557272727272725, pvalue=0.0, statistic_location=0.00090230815, statistic_sign=1)},
                   'moments': {'mean_error': 0.6994641,
                               'means': [-0.00020164356, 1.1923601e-06],
                               'stds': [0.016210506, 0.00031295832],
                               'variance_ratio': 3109.471}},
 'originals': {'gan': {'mae': 0.02280450612306595,
                       'mse': 0.001268043415620923,
                       'psnr': 29.031415939331055,
                       'rmse': 0.035609595477581024,
                       'ssim': 0.9156926274299622},
               'pca': {'mae': 0.00039929954800754786,
                       'mse': 3.5529225783648144e-07,
                       'psnr': 64.9487533569336,
                       'rmse': 0.0005960639682598412,
                       'ssim': 0.9999856352806091}},
 'reconstructions': {'mae': 0.022796468809247017,
                     'mse': 0.0012675777543336153,
                     'psnr': 29.424861907958984,
                     'rmse': 0.035603057593107224,
                     'ssim': 0.9156827926635742},
 'residual_spectra_pcagan': {'cosine': [0.028598884,
                                        0.03509273,
                                        0.0056349416,
                                        0.018198745,
                                        0.00641166,
                                        0.016235393,
                                        0.038042,
                                        0.023256551,
                                        0.023590364,
                                        0.000386836,
                                        0.0047482015,
                                        0.0016166023,
                                        0.04956046,
                                        -0.0068182084,
                                        0.00741054,
                                        0.0075183907,
                                        0.0033524265,
                                        0.017552508,
                                        0.04830746,
                                        0.02523869,
                                        0.04266059,
                                        0.005294662],
                             'mae': [0.009662183,
                                     0.0102090305,
                                     0.011321372,
                                     0.011758934,
                                     0.011312993,
                                     0.010617245,
                                     0.012188056,
                                     0.010806921,
                                     0.011549728,
                                     0.012161557,
                                     0.010563057,
                                     0.011269154,
                                     0.009849917,
                                     0.011247078,
                                     0.012051862,
                                     0.010769418,
                                     0.010353745,
                                     0.010934254,
                                     0.009405007,
                                     0.0094807055,
                                     0.01105424,
                                     0.010234116],
                             'max_mae': 0.012188056,
                             'max_mse': 0.0003658733,
                             'max_rmse': 0.019127814,
                             'median_distance': 1.5915723,
                             'median_mae': 0.010870587,
                             'min_cosine': -0.0068182084,
                             'mse': [0.00019325952,
                                     0.00024661867,
                                     0.0003368998,
                                     0.00027195862,
                                     0.00029871467,
                                     0.00022126969,
                                     0.00035629765,
                                     0.0002333281,
                                     0.0002622013,
                                     0.0003457498,
                                     0.00023087845,
                                     0.00025207113,
                                     0.00019049918,
                                     0.0003658733,
                                     0.0002934629,
                                     0.00025578457,
                                     0.00022162957,
                                     0.0002516491,
                                     0.0001698672,
                                     0.00018681049,
                                     0.00034064555,
                                     0.0002545524],
                             'rmse': [0.013901781,
                                      0.015704097,
                                      0.018354831,
                                      0.016491167,
                                      0.017283363,
                                      0.014875136,
                                      0.018875849,
                                      0.015275081,
                                      0.016192632,
                                      0.018594349,
                                      0.015194685,
                                      0.015876748,
                                      0.013802144,
                                      0.019127814,
                                      0.017130759,
                                      0.015993267,
                                      0.014887229,
                                      0.015863452,
                                      0.013033311,
                                      0.013667864,
                                      0.018456586,
                                      0.0159547]},
 'residuals': {'mae': 0.010854572057723999,
               'mse': 0.00026272828108631074,
               'psnr': -10.362529754638672,
               'rmse': 0.016208894550800323,
               'ssds': [57.820404, 0.021547657],
               'ssim': 0.33453330397605896},
 'spectra_pcagan': {'cosine': [0.9987414,
                               0.998926,
                               0.99886334,
                               0.9995552,
                               0.9990181,
                               0.9992799,
                               0.9992365,
                               0.9992918,
                               0.9996025,
                               0.9997595,
                               0.99960387,
                               0.99952203,
                               0.99922246,
                               0.998059,
                               0.9976147,
                               0.99797726,
                               0.96667665,
                               0.9949635,
                               0.984379,
                               0.98796207,
                               0.9952643,
                               0.98988235],
                    'mae': [0.016757302,
                            0.017766673,
                            0.017111896,
                            0.013836476,
                            0.01675294,
                            0.015722558,
                            0.015651574,
                            0.015726034,
                            0.013697,
                            0.011840435,
                            0.012670166,
                            0.013939286,
                            0.015922561,
                            0.018292576,
                            0.025294451,
                            0.018777179,
                            0.121664286,
                            0.023033572,
                            0.029698182,
                            0.023323223,
                            0.020466214,
                            0.02357772],
                    'max_mae': 0.121664286,
                    'max_mse': 0.015766919,
                    'max_rmse': 0.1255664,
                    'median_mae': 0.0169346,
                    'min_cosine': 0.96667665,
                    'mse': [0.00045400872,
                            0.0005151244,
                            0.0005157133,
                            0.0003145352,
                            0.00046724177,
                            0.00039316664,
                            0.00042588654,
                            0.00039480056,
                            0.00030297742,
                            0.00023688887,
                            0.0002730752,
                            0.00031474337,
                            0.00041330367,
                            0.00060935307,
                            0.0010033039,
                            0.0005875287,
                            0.015766919,
                            0.0008927572,
                            0.0013447265,
                            0.0009191898,
                            0.00079348334,
                            0.0009479814],
                    'rmse': [0.02130748,
                             0.022696352,
                             0.022709321,
                             0.01773514,
                             0.021615775,
                             0.01982843,
                             0.020637019,
                             0.019869588,
                             0.017406248,
                             0.015391194,
                             0.016524987,
                             0.017741008,
                             0.020329872,
                             0.024685077,
                             0.031674974,
                             0.02423899,
                             0.1255664,
                             0.029879043,
                             0.036670513,
                             0.030318143,
                             0.028168837,
                             0.030789306]},
 'spectra_realgan': {'cosine': [0.99874014,
                                0.9989249,
                                0.99886316,
                                0.99955505,
                                0.9990176,
                                0.9992796,
                                0.99923617,
                                0.99929094,
                                0.9996023,
                                0.9997594,
                                0.9996037,
                                0.9995222,
                                0.9992212,
                                0.99805844,
                                0.9976145,
                                0.99797654,
                                0.9666871,
                                0.9949573,
                                0.9843108,
                                0.9879544,
                                0.99525577,
                                0.98986775],
                     'mae': [0.016759017,
                             0.017771505,
                             0.017113505,
                             0.013836488,
                             0.016759358,
                             0.015728053,
                             0.015652496,
                             0.015734294,
                             0.013699452,
                             0.011842346,
                             0.012672424,
                             0.013936429,
                             0.015934607,
                             0.018293655,
                             0.02528627,
                             0.018784426,
                             0.12165437,
                             0.023067331,
                             0.02975947,
                             0.023323884,
                             0.020488348,
                             0.023601346],
                     'max_mae': 0.12165437,
                     'max_mse': 0.015764257,
                     'max_rmse': 0.1255558,
                     'median_mae': 0.016936433,
                     'min_cosine': 0.9666871,
                     'mse': [0.0004542621,
                             0.000515407,
                             0.00051570643,
                             0.00031454326,
                             0.00046757006,
                             0.00039334907,
                             0.00042613794,
                             0.00039526785,
                             0.0003030589,
                             0.00023688741,
                             0.00027313823,
                             0.00031461855,
                             0.0004139958,
                             0.0006095399,
                             0.0010028456,
                             0.0005876969,
                             0.015764257,
                             0.00089405477,
                             0.0013502986,
                             0.00091979664,
                             0.00079529296,
                             0.0009492294],
                     'rmse': [0.021313425,
                              0.022702577,
                              0.02270917,
                              0.017735368,
                              0.02162337,
                              0.01983303,
                              0.02064311,
                              0.019881343,
                              0.017408587,
                              0.015391147,
                              0.016526895,
                              0.01773749,
                              0.020346886,
                              0.024688862,
                              0.03166774,
                              0.02424246,
                              0.1255558,
                              0.029900748,
                              0.03674641,
                              0.030328149,
                              0.02820094,
                              0.030809566]},
 'spectra_realpca': {'cosine': [0.99999887,
                                0.99999946,
                                0.99999964,
                                0.99999994,
                                0.99999964,
                                0.9999998,
                                0.99999976,
                                0.9999999,
                                1.0,
                                1.0,
                                0.99999994,
                                0.99999994,
                                0.99999946,
                                0.9999995,
                                0.9999991,
                                0.99999934,
                                0.9999983,
                                0.9999964,
                                0.9999785,
                                0.99998283,
                                0.99999434,
                                0.99999213],
                     'mae': [0.00048469027,
                             0.00036546122,
                             0.00029550228,
                             0.0001514318,
                             0.000250794,
                             0.00029873475,
                             0.00023191416,
                             0.00025125043,
                             0.00011709385,
                             8.298529e-05,
                             0.0001778177,
                             0.00013216968,
                             0.00037335404,
                             0.00033493093,
                             0.00041530508,
                             0.00034329938,
                             0.0005237983,
                             0.00061086536,
                             0.0010188274,
                             0.0009028653,
                             0.00074314023,
                             0.0006783582],
                     'max_mae': 0.0010188274,
                     'max_mse': 1.6681425e-06,
                     'max_rmse': 0.001291566,
                     'median_mae': 0.00033911515,
                     'min_cosine': 0.9999785,
                     'mse': [3.751836e-07,
                             2.1424009e-07,
                             1.4101879e-07,
                             3.6523865e-08,
                             1.01393965e-07,
                             1.4352861e-07,
                             8.54854e-08,
                             1.01461374e-07,
                             2.2148727e-08,
                             1.1049369e-08,
                             5.1303306e-08,
                             2.8009971e-08,
                             2.2659965e-07,
                             1.8177852e-07,
                             2.7680176e-07,
                             1.8833443e-07,
                             4.373001e-07,
                             5.9731263e-07,
                             1.6681425e-06,
                             1.3015687e-06,
                             8.874594e-07,
                             7.397849e-07],
                     'rmse': [0.0006125223,
                              0.00046286077,
                              0.0003755247,
                              0.00019111218,
                              0.0003184242,
                              0.0003788517,
                              0.00029237886,
                              0.00031853002,
                              0.00014882449,
                              0.00010511598,
                              0.00022650234,
                              0.0001673618,
                              0.00047602484,
                              0.0004263549,
                              0.00052611955,
                              0.00043397513,
                              0.0006612867,
                              0.00077286,
                              0.001291566,
                              0.0011408632,
                              0.00094205065,
                              0.0008601075]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_90.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658
Directory path: experiments/inpainting/gann_4_night_20180904_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_90.0/images
Optimal number of principal components:  47
Reconstruction error:  2.2549512
Energy conservation:  0.90778536
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_90.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9187742426194503, 0.9324259313672917],
                   'kl_div': 2.3463972,
                   'ks_tests': {10000: KstestResult(statistic=0.461, pvalue=0.0, statistic_location=0.0010384978, statistic_sign=1),
                                20000: KstestResult(statistic=0.45519999999999994, pvalue=0.0, statistic_location=0.0010196543, statistic_sign=1),
                                30000: KstestResult(statistic=0.4580000000000001, pvalue=0.0, statistic_location=0.001025303, statistic_sign=1),
                                40000: KstestResult(statistic=0.462125, pvalue=0.0, statistic_location=0.0010309536, statistic_sign=1),
                                50000: KstestResult(statistic=0.45982, pvalue=0.0, statistic_location=0.001036766, statistic_sign=1),
                                60000: KstestResult(statistic=0.4589333333333333, pvalue=0.0, statistic_location=0.0011145663, statistic_sign=1),
                                70000: KstestResult(statistic=0.4597, pvalue=0.0, statistic_location=0.0010235147, statistic_sign=1),
                                80000: KstestResult(statistic=0.4606125000000001, pvalue=0.0, statistic_location=0.0010821912, statistic_sign=1),
                                90000: KstestResult(statistic=0.46205555555555555, pvalue=0.0, statistic_location=0.0011335178, statistic_sign=1),
                                100000: KstestResult(statistic=0.46006, pvalue=0.0, statistic_location=0.0010825926, statistic_sign=1),
                                110000: KstestResult(statistic=0.45943636363636364, pvalue=0.0, statistic_location=0.0010324589, statistic_sign=1),
                                120000: KstestResult(statistic=0.45868333333333333, pvalue=0.0, statistic_location=0.0010334539, statistic_sign=1),
                                130000: KstestResult(statistic=0.4597692307692308, pvalue=0.0, statistic_location=0.0010520576, statistic_sign=1),
                                140000: KstestResult(statistic=0.45871428571428574, pvalue=0.0, statistic_location=0.0010801535, statistic_sign=1),
                                150000: KstestResult(statistic=0.46073333333333333, pvalue=0.0, statistic_location=0.0010831715, statistic_sign=1),
                                160000: KstestResult(statistic=0.4585625, pvalue=0.0, statistic_location=0.0010793246, statistic_sign=1),
                                170000: KstestResult(statistic=0.45796470588235294, pvalue=0.0, statistic_location=0.0010733828, statistic_sign=1),
                                180000: KstestResult(statistic=0.45811111111111114, pvalue=0.0, statistic_location=0.0010501203, statistic_sign=1),
                                190000: KstestResult(statistic=0.459857894736842, pvalue=0.0, statistic_location=0.00108267, statistic_sign=1),
                                200000: KstestResult(statistic=0.45930499999999996, pvalue=0.0, statistic_location=0.0010736259, statistic_sign=1),
                                210000: KstestResult(statistic=0.458852380952381, pvalue=0.0, statistic_location=0.0010824152, statistic_sign=1),
                                220000: KstestResult(statistic=0.45869545454545446, pvalue=0.0, statistic_location=0.0010820231, statistic_sign=1),
                                230000: KstestResult(statistic=0.4579913043478261, pvalue=0.0, statistic_location=0.0010964184, statistic_sign=1),
                                240000: KstestResult(statistic=0.458925, pvalue=0.0, statistic_location=0.0010408303, statistic_sign=1),
                                250000: KstestResult(statistic=0.45798000000000005, pvalue=0.0, statistic_location=0.0010825738, statistic_sign=1),
                                260000: KstestResult(statistic=0.45908076923076924, pvalue=0.0, statistic_location=0.0010559643, statistic_sign=1),
                                270000: KstestResult(statistic=0.4593111111111111, pvalue=0.0, statistic_location=0.0010944968, statistic_sign=1),
                                280000: KstestResult(statistic=0.4598, pvalue=0.0, statistic_location=0.0010235985, statistic_sign=1),
                                290000: KstestResult(statistic=0.460444827586207, pvalue=0.0, statistic_location=0.0010411423, statistic_sign=1),
                                300000: KstestResult(statistic=0.4592233333333333, pvalue=0.0, statistic_location=0.001022836, statistic_sign=1),
                                310000: KstestResult(statistic=0.4595451612903225, pvalue=0.0, statistic_location=0.0010190941, statistic_sign=1),
                                320000: KstestResult(statistic=0.458878125, pvalue=0.0, statistic_location=0.0010254765, statistic_sign=1),
                                330000: KstestResult(statistic=0.45890303030303037, pvalue=0.0, statistic_location=0.001079591, statistic_sign=1)},
                   'moments': {'mean_error': 1.4167672,
                               'means': [0.00036934364, 1.8149606e-06],
                               'stds': [0.015899327, 0.00060719345],
                               'variance_ratio': 1278.523}},
 'originals': {'gan': {'mae': 0.024684593081474304,
                       'mse': 0.001282534678466618,
                       'psnr': 30.239980697631836,
                       'rmse': 0.03581249341368675,
                       'ssim': 0.9119935035705566},
               'pca': {'mae': 0.0006781758856959641,
                       'mse': 2.258673475807882e-06,
                       'psnr': 58.35405731201172,
                       'rmse': 0.0015028883935883641,
                       'ssim': 0.9999463558197021}},
 'reconstructions': {'mae': 0.02465895004570484,
                     'mse': 0.0012798600364476442,
                     'psnr': 30.820966720581055,
                     'rmse': 0.03577513247728348,
                     'ssim': 0.9120302796363831},
 'residual_spectra_pcagan': {'cosine': [0.034849007,
                                        0.061515197,
                                        0.029267604,
                                        0.009310404,
                                        0.0033603928,
                                        0.023335906,
                                        0.022693748,
                                        0.02393866,
                                        0.012828569,
                                        0.016785424,
                                        0.026707297,
                                        0.010038473,
                                        0.025376208,
                                        0.023199307,
                                        0.034435224,
                                        -0.018904246,
                                        -0.008609083,
                                        0.019933471,
                                        0.036056217,
                                        0.026827954,
                                        0.025713049,
                                        -0.004126088,
                                        0.025658865,
                                        0.01864336,
                                        0.048899703,
                                        0.041478544,
                                        0.036654312,
                                        0.033345986,
                                        0.06695099,
                                        0.12171173,
                                        0.051081646,
                                        0.030126857,
                                        0.03739964],
                             'mae': [0.010005078,
                                     0.009199447,
                                     0.009582515,
                                     0.0098104235,
                                     0.0093922,
                                     0.01116629,
                                     0.010588754,
                                     0.011452739,
                                     0.012345376,
                                     0.012608028,
                                     0.011022475,
                                     0.011004176,
                                     0.0115013905,
                                     0.010235253,
                                     0.011369113,
                                     0.011477654,
                                     0.011447403,
                                     0.010752808,
                                     0.009352779,
                                     0.00979452,
                                     0.008860382,
                                     0.012408603,
                                     0.00995968,
                                     0.01031757,
                                     0.009630321,
                                     0.009756433,
                                     0.011052937,
                                     0.009248919,
                                     0.010397228,
                                     0.011078618,
                                     0.010307498,
                                     0.010757812,
                                     0.009288109],
                             'max_mae': 0.012608028,
                             'max_mse': 0.00047233707,
                             'max_rmse': 0.021733318,
                             'median_distance': 1.5478746,
                             'median_mae': 0.010397228,
                             'min_cosine': -0.018904246,
                             'mse': [0.00024153423,
                                     0.00017745994,
                                     0.00021558451,
                                     0.00019947102,
                                     0.00016991045,
                                     0.000309307,
                                     0.00021787261,
                                     0.00029727563,
                                     0.00047233707,
                                     0.00034900807,
                                     0.00028530153,
                                     0.0002578455,
                                     0.0002989864,
                                     0.00020264687,
                                     0.00026335169,
                                     0.00027627771,
                                     0.00029070696,
                                     0.00023335367,
                                     0.00016686096,
                                     0.00018618649,
                                     0.00014637197,
                                     0.0003796338,
                                     0.00019980373,
                                     0.00023959158,
                                     0.00018823454,
                                     0.00020384594,
                                     0.0003427328,
                                     0.00017862844,
                                     0.00025347402,
                                     0.00041160206,
                                     0.00026706987,
                                     0.00023632133,
                                     0.00017565388],
                             'rmse': [0.015541372,
                                      0.013321409,
                                      0.014682797,
                                      0.014123421,
                                      0.0130349705,
                                      0.017587127,
                                      0.014760508,
                                      0.017241683,
                                      0.021733318,
                                      0.018681757,
                                      0.01689087,
                                      0.016057568,
                                      0.017291224,
                                      0.014235409,
                                      0.016228113,
                                      0.016621605,
                                      0.01705013,
                                      0.015275918,
                                      0.012917467,
                                      0.013645017,
                                      0.012098428,
                                      0.019484194,
                                      0.014135195,
                                      0.015478746,
                                      0.0137198595,
                                      0.014277463,
                                      0.018513044,
                                      0.013365195,
                                      0.015920868,
                                      0.020287978,
                                      0.016342273,
                                      0.015372747,
                                      0.013253448]},
 'residuals': {'mae': 0.010520380921661854,
               'mse': 0.0002525527961552143,
               'psnr': 3.6577720642089844,
               'rmse': 0.0158919095993042,
               'ssds': [83.46498, 0.12166638],
               'ssim': 0.3662499487400055},
 'spectra_pcagan': {'cosine': [0.98145133,
                               0.9844241,
                               0.98139185,
                               0.9986953,
                               0.99876535,
                               0.99869645,
                               0.9982779,
                               0.9986752,
                               0.99838364,
                               0.9994711,
                               0.9990585,
                               0.999158,
                               0.99931747,
                               0.9992581,
                               0.99959487,
                               0.99976325,
                               0.99955946,
                               0.999577,
                               0.999223,
                               0.99847925,
                               0.9986758,
                               0.99772716,
                               0.96701014,
                               0.9954944,
                               0.98406184,
                               0.98092616,
                               0.9940763,
                               0.98903316,
                               0.974983,
                               0.97763854,
                               0.98669267,
                               0.98371214,
                               0.9821328],
                    'mae': [0.029598212,
                            0.026990661,
                            0.02774184,
                            0.016721914,
                            0.01736036,
                            0.017955834,
                            0.023204306,
                            0.017634641,
                            0.020327652,
                            0.014712651,
                            0.016870799,
                            0.016446011,
                            0.015147182,
                            0.015423963,
                            0.013867276,
                            0.012076318,
                            0.01357003,
                            0.013181711,
                            0.01575938,
                            0.01729717,
                            0.016127069,
                            0.021172088,
                            0.11902772,
                            0.020559516,
                            0.028988864,
                            0.031266138,
                            0.022645708,
                            0.02735868,
                            0.04172768,
                            0.038773254,
                            0.025078949,
                            0.029090177,
                            0.03004162],
                    'max_mae': 0.11902772,
                    'max_mse': 0.015222169,
                    'max_rmse': 0.12337816,
                    'median_mae': 0.020327652,
                    'min_cosine': 0.96701014,
                    'mse': [0.0014225336,
                            0.0011901413,
                            0.0012809755,
                            0.00046997977,
                            0.0004826078,
                            0.00055796024,
                            0.0008048049,
                            0.00054235966,
                            0.0007698802,
                            0.00038412362,
                            0.00047605103,
                            0.00043851195,
                            0.00039241186,
                            0.00039738245,
                            0.00030874994,
                            0.00024370919,
                            0.000307623,
                            0.0002780987,
                            0.00040858134,
                            0.00048780921,
                            0.00042227787,
                            0.0007711437,
                            0.015222169,
                            0.0007326214,
                            0.0012740104,
                            0.0014519283,
                            0.00091488496,
                            0.0011476433,
                            0.0024335538,
                            0.0024802238,
                            0.0010702654,
                            0.0012948544,
                            0.0013755109],
                    'rmse': [0.03771649,
                             0.034498423,
                             0.03579072,
                             0.021679018,
                             0.021968337,
                             0.023621183,
                             0.028369084,
                             0.023288617,
                             0.027746715,
                             0.019599073,
                             0.021818593,
                             0.020940676,
                             0.019809388,
                             0.019934453,
                             0.017571282,
                             0.015611188,
                             0.017539185,
                             0.016676292,
                             0.020213395,
                             0.022086404,
                             0.0205494,
                             0.027769474,
                             0.12337816,
                             0.02706698,
                             0.035693284,
                             0.038104177,
                             0.030247066,
                             0.033876885,
                             0.04933106,
                             0.049801845,
                             0.03271491,
                             0.035984088,
                             0.03708788]},
 'spectra_realgan': {'cosine': [0.9814223,
                                0.98440135,
                                0.9813847,
                                0.99869484,
                                0.99876535,
                                0.9986955,
                                0.99827725,
                                0.99867463,
                                0.99838346,
                                0.9994711,
                                0.9990578,
                                0.99915785,
                                0.99931747,
                                0.99925756,
                                0.99959475,
                                0.99976325,
                                0.99955946,
                                0.99957687,
                                0.9992219,
                                0.9984783,
                                0.99867445,
                                0.99772704,
                                0.9670179,
                                0.995486,
                                0.9839954,
                                0.980907,
                                0.994071,
                                0.98901385,
                                0.9749294,
                                0.9770383,
                                0.98665446,
                                0.9837191,
                                0.9820898],
                     'mae': [0.029629828,
                             0.027003488,
                             0.027751287,
                             0.016725704,
                             0.01736174,
                             0.017964743,
                             0.02319956,
                             0.017639603,
                             0.0203304,
                             0.014716562,
                             0.016876644,
                             0.016449999,
                             0.01514736,
                             0.015430276,
                             0.013868599,
                             0.012076671,
                             0.013571496,
                             0.013182669,
                             0.015767615,
                             0.017303862,
                             0.016133226,
                             0.021173295,
                             0.11901968,
                             0.020585306,
                             0.029044675,
                             0.03127651,
                             0.022662655,
                             0.027386533,
                             0.041745342,
                             0.039287057,
                             0.025129145,
                             0.029082641,
                             0.030067459],
                     'max_mae': 0.11901968,
                     'max_mse': 0.015220004,
                     'max_rmse': 0.12336938,
                     'median_mae': 0.0203304,
                     'min_cosine': 0.9670179,
                     'mse': [0.0014245644,
                             0.0011917881,
                             0.0012815474,
                             0.000470051,
                             0.00048256293,
                             0.00055840175,
                             0.0008046048,
                             0.0005425732,
                             0.00076986663,
                             0.00038421393,
                             0.00047647604,
                             0.0004386175,
                             0.0003924637,
                             0.00039769348,
                             0.00030884924,
                             0.00024365987,
                             0.00030760973,
                             0.0002781541,
                             0.0004091551,
                             0.00048812246,
                             0.00042273325,
                             0.0007710567,
                             0.015220004,
                             0.00073381216,
                             0.0012792774,
                             0.001453402,
                             0.0009158119,
                             0.0011496709,
                             0.0024379038,
                             0.0025424801,
                             0.0010733899,
                             0.0012944443,
                             0.001378683],
                     'rmse': [0.0377434,
                              0.034522284,
                              0.035798706,
                              0.021680659,
                              0.021967314,
                              0.023630526,
                              0.028365556,
                              0.0232932,
                              0.02774647,
                              0.019601375,
                              0.021828331,
                              0.020943196,
                              0.019810697,
                              0.019942254,
                              0.017574107,
                              0.015609608,
                              0.017538806,
                              0.016677953,
                              0.020227583,
                              0.022093493,
                              0.020560479,
                              0.027767908,
                              0.12336938,
                              0.027088968,
                              0.03576699,
                              0.03812351,
                              0.030262385,
                              0.0339068,
                              0.04937513,
                              0.05042301,
                              0.032762628,
                              0.035978388,
                              0.03713062]},
 'spectra_realpca': {'cosine': [0.99998236,
                                0.99996203,
                                0.9999957,
                                0.99999934,
                                0.99999976,
                                0.99999964,
                                0.99999887,
                                0.99999946,
                                0.99999964,
                                0.99999994,
                                0.99999964,
                                0.9999998,
                                0.99999976,
                                0.9999999,
                                1.0,
                                1.0,
                                0.99999994,
                                0.99999994,
                                0.99999946,
                                0.9999995,
                                0.9999991,
                                0.99999934,
                                0.9999983,
                                0.9999964,
                                0.9999785,
                                0.99998283,
                                0.99999434,
                                0.99999213,
                                0.99994934,
                                0.9993753,
                                0.99997157,
                                0.9999949,
                                0.9999768],
                     'mae': [0.0008858816,
                             0.0013214072,
                             0.0004395233,
                             0.00037191962,
                             0.0002530243,
                             0.00026694222,
                             0.00048469027,
                             0.00036546122,
                             0.00029550228,
                             0.0001514318,
                             0.000250794,
                             0.00029873475,
                             0.00023191416,
                             0.00025125043,
                             0.00011709385,
                             8.298529e-05,
                             0.0001778177,
                             0.00013216968,
                             0.00037335404,
                             0.00033493093,
                             0.00041530508,
                             0.00034329938,
                             0.0005237983,
                             0.00061086536,
                             0.0010188274,
                             0.0009028653,
                             0.00074314023,
                             0.0006783582,
                             0.0015494756,
                             0.0057987394,
                             0.0011762129,
                             0.0005046404,
                             0.0010274472],
                     'max_mae': 0.0057987394,
                     'max_mse': 5.3741227e-05,
                     'max_rmse': 0.007330841,
                     'median_mae': 0.00037335404,
                     'min_cosine': 0.9993753,
                     'mse': [1.2617274e-06,
                             2.8102252e-06,
                             3.093719e-07,
                             2.2537645e-07,
                             1.0321874e-07,
                             1.1283581e-07,
                             3.751836e-07,
                             2.1424009e-07,
                             1.4101879e-07,
                             3.6523865e-08,
                             1.01393965e-07,
                             1.4352861e-07,
                             8.54854e-08,
                             1.01461374e-07,
                             2.2148727e-08,
                             1.1049369e-08,
                             5.1303306e-08,
                             2.8009971e-08,
                             2.2659965e-07,
                             1.8177852e-07,
                             2.7680176e-07,
                             1.8833443e-07,
                             4.373001e-07,
                             5.9731263e-07,
                             1.6681425e-06,
                             1.3015687e-06,
                             8.874594e-07,
                             7.397849e-07,
                             3.8235717e-06,
                             5.3741227e-05,
                             2.220654e-06,
                             4.0728762e-07,
                             1.7043039e-06],
                     'rmse': [0.0011232664,
                              0.0016763726,
                              0.0005562121,
                              0.0004747383,
                              0.00032127672,
                              0.00033591042,
                              0.0006125223,
                              0.00046286077,
                              0.0003755247,
                              0.00019111218,
                              0.0003184242,
                              0.0003788517,
                              0.00029237886,
                              0.00031853002,
                              0.00014882449,
                              0.00010511598,
                              0.00022650234,
                              0.0001673618,
                              0.00047602484,
                              0.0004263549,
                              0.00052611955,
                              0.00043397513,
                              0.0006612867,
                              0.00077286,
                              0.001291566,
                              0.0011408632,
                              0.00094205065,
                              0.0008601075,
                              0.0019553956,
                              0.007330841,
                              0.001490186,
                              0.0006381909,
                              0.0013054899]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_90.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734
Directory path: experiments/inpainting/gann_4_night_20210905_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_90.0/images
Optimal number of principal components:  49
Reconstruction error:  1.6175603
Energy conservation:  0.9078902
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_90.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.8998554886731998, 1.3826082375291513],
                   'kl_div': 1.8854467,
                   'ks_tests': {10000: KstestResult(statistic=0.4182, pvalue=0.0, statistic_location=-0.0017752359, statistic_sign=-1),
                                20000: KstestResult(statistic=0.41925, pvalue=0.0, statistic_location=-0.0020279437, statistic_sign=-1),
                                30000: KstestResult(statistic=0.4216, pvalue=0.0, statistic_location=-0.0018775216, statistic_sign=-1),
                                40000: KstestResult(statistic=0.4186, pvalue=0.0, statistic_location=-0.0019310797, statistic_sign=-1),
                                50000: KstestResult(statistic=0.41786, pvalue=0.0, statistic_location=-0.0019511026, statistic_sign=-1),
                                60000: KstestResult(statistic=0.4203, pvalue=0.0, statistic_location=-0.0019290633, statistic_sign=-1),
                                70000: KstestResult(statistic=0.4173428571428572, pvalue=0.0, statistic_location=-0.0017743558, statistic_sign=-1),
                                80000: KstestResult(statistic=0.42178750000000004, pvalue=0.0, statistic_location=-0.0019627316, statistic_sign=-1),
                                90000: KstestResult(statistic=0.41961111111111116, pvalue=0.0, statistic_location=-0.0017695015, statistic_sign=-1),
                                100000: KstestResult(statistic=0.42036, pvalue=0.0, statistic_location=-0.0018983465, statistic_sign=-1),
                                110000: KstestResult(statistic=0.4199, pvalue=0.0, statistic_location=-0.0017704703, statistic_sign=-1)},
                   'moments': {'mean_error': -1.2607074,
                               'means': [-0.0013864677, -2.3382686e-06],
                               'stds': [0.016771028, 0.001029232],
                               'variance_ratio': 295.90604}},
 'originals': {'gan': {'mae': 0.02304854989051819,
                       'mse': 0.0009045949555002153,
                       'psnr': 30.321165084838867,
                       'rmse': 0.030076485127210617,
                       'ssim': 0.9525920748710632},
               'pca': {'mae': 0.0014882865361869335,
                       'mse': 6.0957481764489785e-06,
                       'psnr': 52.698184967041016,
                       'rmse': 0.0024689568672329187,
                       'ssim': 0.9997632503509521}},
 'reconstructions': {'mae': 0.02295214869081974,
                     'mse': 0.0008977633551694453,
                     'psnr': 31.01683235168457,
                     'rmse': 0.029962699860334396,
                     'ssim': 0.9528239965438843},
 'residual_spectra_pcagan': {'cosine': [0.028484141,
                                        0.007960859,
                                        0.02118708,
                                        -0.007699397,
                                        0.038485374,
                                        0.036325872,
                                        0.060586337,
                                        0.10959898,
                                        0.12066216,
                                        0.061513904,
                                        0.056284986],
                             'mae': [0.010596911,
                                     0.011938797,
                                     0.010162529,
                                     0.011247633,
                                     0.011170866,
                                     0.010138488,
                                     0.01054554,
                                     0.009072492,
                                     0.009991954,
                                     0.01091447,
                                     0.011037214],
                             'max_mae': 0.011938797,
                             'max_mse': 0.00040683165,
                             'max_rmse': 0.020170068,
                             'median_distance': 1.6654266,
                             'median_mae': 0.010596911,
                             'min_cosine': -0.007699397,
                             'mse': [0.00023391466,
                                     0.0003794109,
                                     0.00023653271,
                                     0.00028132292,
                                     0.00040683165,
                                     0.0002773645,
                                     0.00024695913,
                                     0.00017275057,
                                     0.00030653653,
                                     0.00026229737,
                                     0.0003011049],
                             'rmse': [0.015294269,
                                      0.019478472,
                                      0.01537962,
                                      0.016772684,
                                      0.020170068,
                                      0.016654264,
                                      0.015714934,
                                      0.013143461,
                                      0.017508185,
                                      0.016195597,
                                      0.017352374]},
 'residuals': {'mae': 0.01061971765011549,
               'mse': 0.0002822750830091536,
               'psnr': 2.124981164932251,
               'rmse': 0.01680104434490204,
               'ssds': [31.150585, 0.11652459],
               'ssim': 0.3088994324207306},
 'spectra_pcagan': {'cosine': [0.9984587,
                               0.9986562,
                               0.99807614,
                               0.9953907,
                               0.9942908,
                               0.99584186,
                               0.9835722,
                               0.98395866,
                               0.98592144,
                               0.9871306,
                               0.98854536],
                    'mae': [0.017757935,
                            0.017574655,
                            0.01766807,
                            0.024942953,
                            0.02357556,
                            0.020195499,
                            0.027632397,
                            0.027376715,
                            0.024668414,
                            0.02480059,
                            0.026280846],
                    'max_mae': 0.027632397,
                    'max_mse': 0.0012376311,
                    'max_rmse': 0.03517998,
                    'median_mae': 0.024668414,
                    'min_cosine': 0.9835722,
                    'mse': [0.0005263748,
                            0.0005389433,
                            0.0005180235,
                            0.0010085976,
                            0.00092041644,
                            0.0007257618,
                            0.0012376311,
                            0.0011679997,
                            0.0010466301,
                            0.0010398689,
                            0.0011451498],
                    'rmse': [0.02294286,
                             0.023215152,
                             0.02276013,
                             0.031758424,
                             0.030338366,
                             0.026939968,
                             0.03517998,
                             0.03417601,
                             0.03235166,
                             0.032247,
                             0.033840064]},
 'spectra_realgan': {'cosine': [0.9984581,
                                0.9986555,
                                0.9980744,
                                0.99538606,
                                0.9942765,
                                0.9958383,
                                0.98346764,
                                0.98381656,
                                0.9854401,
                                0.9870311,
                                0.98846394],
                     'mae': [0.017761096,
                             0.017581902,
                             0.017673172,
                             0.02494455,
                             0.023610307,
                             0.020209787,
                             0.027729932,
                             0.027509851,
                             0.025184255,
                             0.024926161,
                             0.026403049],
                     'max_mae': 0.027729932,
                     'max_mse': 0.0012457964,
                     'max_rmse': 0.03529584,
                     'median_mae': 0.024926161,
                     'min_cosine': 0.98346764,
                     'mse': [0.0005266399,
                             0.0005392041,
                             0.0005184902,
                             0.0010091542,
                             0.00092274835,
                             0.0007264311,
                             0.0012457964,
                             0.0011789127,
                             0.0010824198,
                             0.0010480904,
                             0.0011526571],
                     'rmse': [0.022948636,
                              0.023220768,
                              0.02277038,
                              0.03176719,
                              0.030376773,
                              0.026952386,
                              0.03529584,
                              0.034335297,
                              0.032900147,
                              0.032374226,
                              0.033950806]},
 'spectra_realpca': {'cosine': [0.9999994,
                                0.9999999,
                                0.99999714,
                                0.9999933,
                                0.9999929,
                                0.99999785,
                                0.9999116,
                                0.99980843,
                                0.9995397,
                                0.9999444,
                                0.9999541],
                     'mae': [0.0003636269,
                             0.00025833122,
                             0.00069036434,
                             0.0008520363,
                             0.0008451438,
                             0.0004610098,
                             0.0020542683,
                             0.0029726604,
                             0.0046003973,
                             0.0016602424,
                             0.0016130707],
                     'max_mae': 0.0046003973,
                     'max_mse': 3.3959837e-05,
                     'max_rmse': 0.005827507,
                     'median_mae': 0.0008520363,
                     'min_cosine': 0.9995397,
                     'mse': [2.130017e-07,
                             1.06522606e-07,
                             7.5835e-07,
                             1.1712241e-06,
                             1.1363693e-06,
                             3.4130946e-07,
                             6.70799e-06,
                             1.40599395e-05,
                             3.3959837e-05,
                             4.444509e-06,
                             4.1541757e-06],
                     'rmse': [0.00046152106,
                              0.000326378,
                              0.00087083294,
                              0.001082231,
                              0.0010660063,
                              0.00058421696,
                              0.0025899787,
                              0.0037496586,
                              0.005827507,
                              0.0021082005,
                              0.0020381794]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_90.0

Running comparison for experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726
Directory path: experiments/inpainting/gann_4_night_20210905_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_90.0/images
Optimal number of principal components:  49
Reconstruction error:  1.6175603
Energy conservation:  0.9078902
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_90.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9022391383209563, 1.8577725075304177],
                   'kl_div': 1.4107656,
                   'ks_tests': {10000: KstestResult(statistic=0.3711, pvalue=0.0, statistic_location=-0.0025994368, statistic_sign=-1),
                                20000: KstestResult(statistic=0.36760000000000004, pvalue=0.0, statistic_location=-0.0017800163, statistic_sign=-1),
                                30000: KstestResult(statistic=0.36773333333333336, pvalue=0.0, statistic_location=-0.0022545848, statistic_sign=-1),
                                40000: KstestResult(statistic=0.3699, pvalue=0.0, statistic_location=-0.002379808, statistic_sign=-1),
                                50000: KstestResult(statistic=0.36604, pvalue=0.0, statistic_location=-0.0023211353, statistic_sign=-1),
                                60000: KstestResult(statistic=0.37015000000000003, pvalue=0.0, statistic_location=-0.0022536516, statistic_sign=-1),
                                70000: KstestResult(statistic=0.3684571428571428, pvalue=0.0, statistic_location=-0.002353171, statistic_sign=-1),
                                80000: KstestResult(statistic=0.37083750000000004, pvalue=0.0, statistic_location=-0.0023187064, statistic_sign=-1),
                                90000: KstestResult(statistic=0.36922222222222223, pvalue=0.0, statistic_location=-0.0023204703, statistic_sign=-1),
                                100000: KstestResult(statistic=0.36941, pvalue=0.0, statistic_location=-0.0021963078, statistic_sign=-1),
                                110000: KstestResult(statistic=0.3705636363636363, pvalue=0.0, statistic_location=-0.0023186496, statistic_sign=-1),
                                120000: KstestResult(statistic=0.3705333333333334, pvalue=0.0, statistic_location=-0.0023403093, statistic_sign=-1),
                                130000: KstestResult(statistic=0.36985384615384614, pvalue=0.0, statistic_location=-0.002115894, statistic_sign=-1),
                                140000: KstestResult(statistic=0.3687642857142857, pvalue=0.0, statistic_location=-0.0021760715, statistic_sign=-1),
                                150000: KstestResult(statistic=0.3692266666666667, pvalue=0.0, statistic_location=-0.0023375498, statistic_sign=-1),
                                160000: KstestResult(statistic=0.36705625, pvalue=0.0, statistic_location=-0.0022176746, statistic_sign=-1),
                                170000: KstestResult(statistic=0.36626470588235294, pvalue=0.0, statistic_location=-0.0023398234, statistic_sign=-1),
                                180000: KstestResult(statistic=0.36725, pvalue=0.0, statistic_location=-0.0021770373, statistic_sign=-1),
                                190000: KstestResult(statistic=0.3677263157894737, pvalue=0.0, statistic_location=-0.001962997, statistic_sign=-1),
                                200000: KstestResult(statistic=0.367545, pvalue=0.0, statistic_location=-0.0023188088, statistic_sign=-1),
                                210000: KstestResult(statistic=0.3684857142857143, pvalue=0.0, statistic_location=-0.002218863, statistic_sign=-1),
                                220000: KstestResult(statistic=0.36656818181818185, pvalue=0.0, statistic_location=-0.0021963567, statistic_sign=-1)},
                   'moments': {'mean_error': -0.6335581,
                               'means': [-0.0014589109, 1.189152e-06],
                               'stds': [0.01597184, 0.0020354092],
                               'variance_ratio': 61.1224}},
 'originals': {'gan': {'mae': 0.02928796224296093,
                       'mse': 0.0015978722367435694,
                       'psnr': 30.15612030029297,
                       'rmse': 0.03997339308261871,
                       'ssim': 0.8410376310348511},
               'pca': {'mae': 0.003036923473700881,
                       'mse': 3.11786679958459e-05,
                       'psnr': 47.30069351196289,
                       'rmse': 0.005583785939961672,
                       'ssim': 0.9985256791114807}},
 'reconstructions': {'mae': 0.028915615752339363,
                     'mse': 0.0015671920264139771,
                     'psnr': 30.288049697875977,
                     'rmse': 0.039587777107954025,
                     'ssim': 0.8400726318359375},
 'residual_spectra_pcagan': {'cosine': [0.028706472,
                                        0.02426607,
                                        -0.0013228706,
                                        0.019846959,
                                        0.0286257,
                                        0.026087346,
                                        0.0037502584,
                                        0.026724627,
                                        0.000462352,
                                        0.04609813,
                                        0.03091746,
                                        0.07318841,
                                        0.12139461,
                                        0.13408318,
                                        0.061956983,
                                        0.057510354,
                                        0.21605076,
                                        0.18377012,
                                        0.2460199,
                                        0.30956537,
                                        0.21424268,
                                        0.2113897],
                             'mae': [0.01023679,
                                     0.0100419605,
                                     0.011761658,
                                     0.012693588,
                                     0.011143809,
                                     0.009958681,
                                     0.011338344,
                                     0.009654123,
                                     0.010815857,
                                     0.011024672,
                                     0.009470171,
                                     0.009866122,
                                     0.008564139,
                                     0.009808415,
                                     0.010921265,
                                     0.010600308,
                                     0.008698427,
                                     0.010755888,
                                     0.00879591,
                                     0.0087927915,
                                     0.010471176,
                                     0.011084909],
                             'max_mae': 0.012693588,
                             'max_mse': 0.00040907564,
                             'max_rmse': 0.020225618,
                             'median_distance': 1.6104577,
                             'median_mae': 0.010353983,
                             'min_cosine': -0.0013228706,
                             'mse': [0.0002184262,
                                     0.00026162292,
                                     0.00040907564,
                                     0.0003153755,
                                     0.0002924314,
                                     0.00019941539,
                                     0.00032273302,
                                     0.0001957244,
                                     0.00024963226,
                                     0.00034954716,
                                     0.00021707678,
                                     0.00018992393,
                                     0.00013922961,
                                     0.0002764467,
                                     0.00026540598,
                                     0.0002669623,
                                     0.0002180246,
                                     0.00025710178,
                                     0.00015769419,
                                     0.00017847234,
                                     0.00031421057,
                                     0.0002769505],
                             'rmse': [0.014779249,
                                      0.016174762,
                                      0.020225618,
                                      0.017758815,
                                      0.017100625,
                                      0.014121451,
                                      0.017964771,
                                      0.013990154,
                                      0.015799755,
                                      0.01869618,
                                      0.014733526,
                                      0.013781289,
                                      0.01179956,
                                      0.016626686,
                                      0.016291285,
                                      0.016338982,
                                      0.014765656,
                                      0.016034395,
                                      0.012557634,
                                      0.013359354,
                                      0.017725985,
                                      0.01664183]},
 'residuals': {'mae': 0.010295409709215164,
               'mse': 0.00025324919261038303,
               'psnr': 10.795220375061035,
               'rmse': 0.01591380499303341,
               'ssds': [56.58993, 0.911432],
               'ssim': 0.3556561768054962},
 'spectra_pcagan': {'cosine': [0.9912494,
                               0.99028397,
                               0.98719335,
                               0.99796253,
                               0.9989016,
                               0.9984649,
                               0.99860466,
                               0.99804264,
                               0.99521065,
                               0.9936718,
                               0.99581265,
                               0.98341185,
                               0.98373526,
                               0.9852027,
                               0.9860474,
                               0.987468,
                               0.98926175,
                               0.9810451,
                               0.9901085,
                               0.9920838,
                               0.9871731,
                               0.9862515],
                    'mae': [0.03329774,
                            0.025772262,
                            0.10232241,
                            0.0230837,
                            0.018348133,
                            0.017655157,
                            0.017885488,
                            0.017940646,
                            0.025352364,
                            0.02526562,
                            0.021145834,
                            0.027898947,
                            0.02776132,
                            0.025699185,
                            0.026210174,
                            0.026805783,
                            0.025048742,
                            0.032560576,
                            0.028793769,
                            0.02721527,
                            0.028763052,
                            0.031317383],
                    'max_mae': 0.10232241,
                    'max_mse': 0.011329887,
                    'max_rmse': 0.106441945,
                    'median_mae': 0.025991218,
                    'min_cosine': 0.9810451,
                    'mse': [0.0015870843,
                            0.0011100603,
                            0.011329887,
                            0.00086220924,
                            0.0005667504,
                            0.000519634,
                            0.0005565377,
                            0.00053221936,
                            0.001031123,
                            0.0010262873,
                            0.0007723839,
                            0.0012480352,
                            0.0011889766,
                            0.0011233527,
                            0.0011439793,
                            0.0011852568,
                            0.0010788527,
                            0.0017542456,
                            0.0014227112,
                            0.0013233331,
                            0.0014656421,
                            0.0016496666],
                    'rmse': [0.039838225,
                             0.033317566,
                             0.106441945,
                             0.0293634,
                             0.02380652,
                             0.022795482,
                             0.02359105,
                             0.023069879,
                             0.032111105,
                             0.03203572,
                             0.027791794,
                             0.035327543,
                             0.03448154,
                             0.033516455,
                             0.033822764,
                             0.034427557,
                             0.032845892,
                             0.041883714,
                             0.037718844,
                             0.036377646,
                             0.038283706,
                             0.040616088]},
 'spectra_realgan': {'cosine': [0.9912342,
                                0.99026257,
                                0.98719555,
                                0.9979616,
                                0.9989007,
                                0.99846435,
                                0.99860394,
                                0.99804103,
                                0.99520457,
                                0.99365646,
                                0.99580944,
                                0.9832972,
                                0.9835998,
                                0.984698,
                                0.98593915,
                                0.9873886,
                                0.9882226,
                                0.98030204,
                                0.98952395,
                                0.99125,
                                0.9861597,
                                0.9852589],
                     'mae': [0.033293977,
                             0.025828578,
                             0.10232044,
                             0.0230865,
                             0.018353838,
                             0.017655758,
                             0.017890453,
                             0.017944016,
                             0.025359306,
                             0.025302835,
                             0.021159135,
                             0.028000327,
                             0.027902607,
                             0.026169334,
                             0.026349256,
                             0.026940009,
                             0.026175302,
                             0.03333429,
                             0.029743519,
                             0.029068299,
                             0.029867498,
                             0.032589857],
                     'max_mae': 0.10232044,
                     'max_mse': 0.011329195,
                     'max_rmse': 0.1064387,
                     'median_mae': 0.02626228,
                     'min_cosine': 0.98030204,
                     'mse': [0.001588724,
                             0.0011122521,
                             0.011329195,
                             0.0008625966,
                             0.000567177,
                             0.0005198593,
                             0.0005567797,
                             0.00053265877,
                             0.0010319306,
                             0.0010287696,
                             0.000773056,
                             0.0012569897,
                             0.0011995737,
                             0.0011607396,
                             0.0011529215,
                             0.0011925437,
                             0.0011627708,
                             0.0018270345,
                             0.001506317,
                             0.0014590706,
                             0.0015643468,
                             0.00176788],
                     'rmse': [0.0398588,
                              0.033350445,
                              0.1064387,
                              0.029369995,
                              0.02381548,
                              0.022800423,
                              0.023596179,
                              0.0230794,
                              0.032123677,
                              0.03207444,
                              0.027803885,
                              0.03545405,
                              0.034634862,
                              0.034069628,
                              0.0339547,
                              0.034533225,
                              0.034099426,
                              0.042743824,
                              0.0388113,
                              0.038197782,
                              0.039551824,
                              0.042046167]},
 'spectra_realpca': {'cosine': [0.99998325,
                                0.9999833,
                                0.9999996,
                                0.99999946,
                                0.99999976,
                                0.9999994,
                                0.9999999,
                                0.99999714,
                                0.9999933,
                                0.9999929,
                                0.99999785,
                                0.9999116,
                                0.99980843,
                                0.9995397,
                                0.9999444,
                                0.9999541,
                                0.9989145,
                                0.9993033,
                                0.9992783,
                                0.99908197,
                                0.99903893,
                                0.9989245],
                     'mae': [0.0011540038,
                             0.0010400282,
                             0.0003040199,
                             0.000345133,
                             0.00025632273,
                             0.0003636269,
                             0.00025833122,
                             0.00069036434,
                             0.0008520363,
                             0.0008451438,
                             0.0004610098,
                             0.0020542683,
                             0.0029726604,
                             0.0046003973,
                             0.0016602424,
                             0.0016130707,
                             0.007405549,
                             0.006181294,
                             0.007900908,
                             0.009720833,
                             0.007411548,
                             0.008721519],
                     'max_mae': 0.009720833,
                     'max_mse': 0.00015188524,
                     'max_rmse': 0.012324173,
                     'median_mae': 0.0013835372,
                     'min_cosine': 0.9989145,
                     'mse': [2.1408848e-06,
                             1.7307499e-06,
                             1.4731842e-07,
                             1.9186051e-07,
                             1.0555191e-07,
                             2.130017e-07,
                             1.06522606e-07,
                             7.5835e-07,
                             1.1712241e-06,
                             1.1363693e-06,
                             3.4130946e-07,
                             6.70799e-06,
                             1.40599395e-05,
                             3.3959837e-05,
                             4.444509e-06,
                             4.1541757e-06,
                             8.864632e-05,
                             6.174021e-05,
                             0.00010202797,
                             0.00015188524,
                             8.801014e-05,
                             0.00012225116],
                     'rmse': [0.0014631763,
                              0.0013155796,
                              0.00038382082,
                              0.00043801885,
                              0.00032488754,
                              0.00046152106,
                              0.000326378,
                              0.00087083294,
                              0.001082231,
                              0.0010660063,
                              0.00058421696,
                              0.0025899787,
                              0.0037496586,
                              0.005827507,
                              0.0021082005,
                              0.0020381794,
                              0.009415218,
                              0.007857494,
                              0.010100889,
                              0.012324173,
                              0.0093813725,
                              0.011056725]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_90.0

Running comparison for experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226
Directory path: experiments/inpainting/gann_4_night_20210905_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 90.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_90.0/images
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_90.0/images
Optimal number of principal components:  49
Reconstruction error:  1.6175603
Energy conservation:  0.9078902
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_90.0
saved spectra in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_90.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_90.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_90.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.867696224533345, 1.777250701488787],
                   'kl_div': 1.4478037,
                   'ks_tests': {10000: KstestResult(statistic=0.3714, pvalue=0.0, statistic_location=-0.0019637235, statistic_sign=-1),
                                20000: KstestResult(statistic=0.36505000000000004, pvalue=0.0, statistic_location=-0.0019188663, statistic_sign=-1),
                                30000: KstestResult(statistic=0.3601, pvalue=0.0, statistic_location=-0.0021188306, statistic_sign=-1),
                                40000: KstestResult(statistic=0.35987499999999994, pvalue=0.0, statistic_location=-0.0020839628, statistic_sign=-1),
                                50000: KstestResult(statistic=0.36096, pvalue=0.0, statistic_location=-0.0021909722, statistic_sign=-1),
                                60000: KstestResult(statistic=0.35988333333333333, pvalue=0.0, statistic_location=-0.002041299, statistic_sign=-1),
                                70000: KstestResult(statistic=0.35998571428571424, pvalue=0.0, statistic_location=-0.001962748, statistic_sign=-1),
                                80000: KstestResult(statistic=0.36085, pvalue=0.0, statistic_location=-0.002122786, statistic_sign=-1),
                                90000: KstestResult(statistic=0.3621444444444445, pvalue=0.0, statistic_location=-0.0021199957, statistic_sign=-1),
                                100000: KstestResult(statistic=0.36123000000000005, pvalue=0.0, statistic_location=-0.0021211617, statistic_sign=-1),
                                110000: KstestResult(statistic=0.36155454545454546, pvalue=0.0, statistic_location=-0.001899464, statistic_sign=-1),
                                120000: KstestResult(statistic=0.3612666666666667, pvalue=0.0, statistic_location=-0.0020951778, statistic_sign=-1),
                                130000: KstestResult(statistic=0.3593384615384615, pvalue=0.0, statistic_location=-0.0020419278, statistic_sign=-1),
                                140000: KstestResult(statistic=0.36040714285714287, pvalue=0.0, statistic_location=-0.0021154918, statistic_sign=-1),
                                150000: KstestResult(statistic=0.35764666666666667, pvalue=0.0, statistic_location=-0.0022157803, statistic_sign=-1),
                                160000: KstestResult(statistic=0.35895, pvalue=0.0, statistic_location=-0.002026435, statistic_sign=-1),
                                170000: KstestResult(statistic=0.3614705882352941, pvalue=0.0, statistic_location=-0.001963254, statistic_sign=-1),
                                180000: KstestResult(statistic=0.36035555555555554, pvalue=0.0, statistic_location=-0.0021060994, statistic_sign=-1),
                                190000: KstestResult(statistic=0.35956842105263154, pvalue=0.0, statistic_location=-0.001977723, statistic_sign=-1),
                                200000: KstestResult(statistic=0.35992999999999997, pvalue=0.0, statistic_location=-0.0021098894, statistic_sign=-1),
                                210000: KstestResult(statistic=0.35923333333333335, pvalue=0.0, statistic_location=-0.0021231584, statistic_sign=-1),
                                220000: KstestResult(statistic=0.3599045454545455, pvalue=0.0, statistic_location=-0.0019660243, statistic_sign=-1),
                                230000: KstestResult(statistic=0.35888260869565214, pvalue=0.0, statistic_location=-0.0020379322, statistic_sign=-1),
                                240000: KstestResult(statistic=0.3614041666666667, pvalue=0.0, statistic_location=-0.0021099222, statistic_sign=-1),
                                250000: KstestResult(statistic=0.358456, pvalue=0.0, statistic_location=-0.002117292, statistic_sign=-1),
                                260000: KstestResult(statistic=0.3601307692307692, pvalue=0.0, statistic_location=-0.0021285806, statistic_sign=-1),
                                270000: KstestResult(statistic=0.35805185185185184, pvalue=0.0, statistic_location=-0.001958148, statistic_sign=-1),
                                280000: KstestResult(statistic=0.35914999999999997, pvalue=0.0, statistic_location=-0.0021227188, statistic_sign=-1),
                                290000: KstestResult(statistic=0.3592586206896552, pvalue=0.0, statistic_location=-0.00211816, statistic_sign=-1),
                                300000: KstestResult(statistic=0.3617166666666667, pvalue=0.0, statistic_location=-0.0021171346, statistic_sign=-1),
                                310000: KstestResult(statistic=0.35832903225806456, pvalue=0.0, statistic_location=-0.001963566, statistic_sign=-1),
                                320000: KstestResult(statistic=0.36055312500000003, pvalue=0.0, statistic_location=-0.0021163914, statistic_sign=-1),
                                330000: KstestResult(statistic=0.3591727272727273, pvalue=0.0, statistic_location=-0.0019640848, statistic_sign=-1)},
                   'moments': {'mean_error': -0.27343372,
                               'means': [-0.00065364566, -1.9133283e-06],
                               'stds': [0.015172766, 0.0019002086],
                               'variance_ratio': 66.13538}},
 'originals': {'gan': {'mae': 0.04760196805000305,
                       'mse': 0.015235002152621746,
                       'psnr': 23.570749282836914,
                       'rmse': 0.12343014776706696,
                       'ssim': 0.8455864787101746},
               'pca': {'mae': 0.0027370548341423273,
                       'mse': 2.682262856978923e-05,
                       'psnr': 51.48965835571289,
                       'rmse': 0.0051790568977594376,
                       'ssim': 0.9976080060005188}},
 'reconstructions': {'mae': 0.04730531573295593,
                     'mse': 0.015209387987852097,
                     'psnr': 23.953554153442383,
                     'rmse': 0.12332634627819061,
                     'ssim': 0.8470065593719482},
 'residual_spectra_pcagan': {'cosine': [0.030528266,
                                        0.0057773404,
                                        0.011093989,
                                        0.030124195,
                                        0.02658618,
                                        0.0014143449,
                                        0.03367675,
                                        0.026973708,
                                        0.001279527,
                                        0.027414804,
                                        0.028402517,
                                        0.030137748,
                                        0.009790974,
                                        0.033568542,
                                        0.00059071835,
                                        0.04880951,
                                        0.032612823,
                                        0.07060614,
                                        0.12749225,
                                        0.14211717,
                                        0.06415947,
                                        0.06088511,
                                        0.23549339,
                                        0.20053235,
                                        0.2664997,
                                        0.3239138,
                                        0.21508409,
                                        0.2181334,
                                        0.22918533,
                                        0.07141967,
                                        0.010685928,
                                        0.19333537,
                                        0.16254896],
                             'mae': [0.0089646075,
                                     0.009129011,
                                     0.00827634,
                                     0.010238923,
                                     0.009091652,
                                     0.0102426745,
                                     0.009093886,
                                     0.00940804,
                                     0.011258282,
                                     0.012268503,
                                     0.010846137,
                                     0.009649212,
                                     0.010710422,
                                     0.009155634,
                                     0.0101615805,
                                     0.010327591,
                                     0.009250849,
                                     0.009207529,
                                     0.0080598965,
                                     0.009156165,
                                     0.010220827,
                                     0.010127309,
                                     0.008321614,
                                     0.010027844,
                                     0.008362161,
                                     0.008299249,
                                     0.0101957945,
                                     0.010485582,
                                     0.009408394,
                                     0.011055223,
                                     0.013191971,
                                     0.010944978,
                                     0.008624516],
                             'max_mae': 0.013191971,
                             'max_mse': 0.0004604305,
                             'max_rmse': 0.021457644,
                             'median_distance': 1.4825474,
                             'median_mae': 0.009649212,
                             'min_cosine': 0.00059071835,
                             'mse': [0.00018635743,
                                     0.00017915973,
                                     0.0001400618,
                                     0.00026669272,
                                     0.00016548013,
                                     0.00031261382,
                                     0.00017229885,
                                     0.0002230092,
                                     0.0003419804,
                                     0.0002911619,
                                     0.00027394443,
                                     0.0001930831,
                                     0.00027423067,
                                     0.00016998808,
                                     0.00021354738,
                                     0.00030737705,
                                     0.00020792695,
                                     0.00016654072,
                                     0.0001230837,
                                     0.00023044927,
                                     0.00021988797,
                                     0.0002485221,
                                     0.0001862846,
                                     0.00021979466,
                                     0.00013930179,
                                     0.00015328417,
                                     0.00029832197,
                                     0.0002520705,
                                     0.00020613894,
                                     0.00027671846,
                                     0.0004604305,
                                     0.0002297036,
                                     0.00016896581],
                             'rmse': [0.01365128,
                                      0.0133850565,
                                      0.011834771,
                                      0.01633073,
                                      0.012863908,
                                      0.017680889,
                                      0.013126266,
                                      0.014933493,
                                      0.018492712,
                                      0.017063467,
                                      0.016551267,
                                      0.013895434,
                                      0.016559912,
                                      0.013037948,
                                      0.0146132605,
                                      0.017532172,
                                      0.014419672,
                                      0.012905066,
                                      0.011094309,
                                      0.015180555,
                                      0.01482862,
                                      0.015764583,
                                      0.0136486115,
                                      0.014825474,
                                      0.011802617,
                                      0.012380798,
                                      0.017272,
                                      0.015876727,
                                      0.01435754,
                                      0.016634857,
                                      0.021457644,
                                      0.015155976,
                                      0.012998685]},
 'residuals': {'mae': 0.009810982272028923,
               'mse': 0.0002272246201755479,
               'psnr': 11.266146659851074,
               'rmse': 0.015073971822857857,
               'ssds': [76.11101, 1.1915593],
               'ssim': 0.4626324474811554},
 'spectra_pcagan': {'cosine': [0.99552584,
                               0.99876565,
                               0.99883455,
                               0.9975673,
                               0.9983803,
                               0.9977373,
                               0.9921214,
                               0.99018145,
                               0.9875044,
                               0.99804604,
                               0.99888486,
                               0.9984339,
                               0.99866617,
                               0.99810493,
                               0.9954043,
                               0.9941132,
                               0.99583274,
                               0.9839842,
                               0.9833562,
                               0.98601377,
                               0.9866294,
                               0.98822945,
                               0.989001,
                               0.98258245,
                               0.9903753,
                               0.9921758,
                               0.9868442,
                               0.9865008,
                               0.98744243,
                               0.94854796,
                               0.22062019,
                               0.9525635,
                               0.9872591],
                    'mae': [0.020008875,
                            0.015901716,
                            0.014390094,
                            0.023828259,
                            0.016487842,
                            0.020234555,
                            0.0313943,
                            0.025832644,
                            0.10156307,
                            0.02279169,
                            0.01837829,
                            0.017776072,
                            0.017526919,
                            0.017568864,
                            0.024619896,
                            0.024156513,
                            0.02080798,
                            0.027427536,
                            0.027760709,
                            0.024675746,
                            0.025352295,
                            0.02648529,
                            0.024452953,
                            0.030889945,
                            0.028643763,
                            0.026977899,
                            0.028480148,
                            0.030855428,
                            0.027125983,
                            0.052737225,
                            0.6607466,
                            0.0610953,
                            0.024101034],
                    'max_mae': 0.6607466,
                    'max_mse': 0.45393297,
                    'max_rmse': 0.67374545,
                    'median_mae': 0.024675746,
                    'min_cosine': 0.22062019,
                    'mse': [0.00068322045,
                            0.00042030343,
                            0.00035505267,
                            0.00083484955,
                            0.0004452689,
                            0.0007176611,
                            0.0014059719,
                            0.0011192141,
                            0.011160734,
                            0.0008362871,
                            0.0005701941,
                            0.0005311063,
                            0.00053432945,
                            0.0005108618,
                            0.0009837002,
                            0.00095370744,
                            0.00075380795,
                            0.001208613,
                            0.00121172,
                            0.0010400612,
                            0.0010760542,
                            0.001154687,
                            0.0010413209,
                            0.0016033709,
                            0.0013934012,
                            0.001298892,
                            0.0014437141,
                            0.0015976181,
                            0.0012907602,
                            0.0037347202,
                            0.45393297,
                            0.0050887465,
                            0.0009768982],
                    'rmse': [0.026138486,
                             0.020501303,
                             0.01884284,
                             0.028893763,
                             0.021101397,
                             0.026789198,
                             0.03749629,
                             0.033454657,
                             0.105644375,
                             0.02891863,
                             0.023878736,
                             0.023045745,
                             0.023115568,
                             0.022602253,
                             0.031363994,
                             0.030882154,
                             0.027455563,
                             0.034765113,
                             0.03480977,
                             0.03224998,
                             0.032803264,
                             0.033980686,
                             0.032269504,
                             0.040042114,
                             0.037328288,
                             0.036040142,
                             0.03799624,
                             0.039970215,
                             0.03592715,
                             0.061112355,
                             0.67374545,
                             0.07133545,
                             0.031255372]},
 'spectra_realgan': {'cosine': [0.9955162,
                                0.99876493,
                                0.9988342,
                                0.99756604,
                                0.9983779,
                                0.9977362,
                                0.99210507,
                                0.99015915,
                                0.9875066,
                                0.9980449,
                                0.99888396,
                                0.99843335,
                                0.99866533,
                                0.99810344,
                                0.9953989,
                                0.994098,
                                0.9958299,
                                0.98387754,
                                0.9832139,
                                0.98550993,
                                0.9865277,
                                0.9881481,
                                0.98796475,
                                0.98184454,
                                0.9897901,
                                0.9913577,
                                0.98584014,
                                0.9855275,
                                0.98651737,
                                0.94852954,
                                0.2205701,
                                0.95217645,
                                0.98690104],
                     'mae': [0.020037213,
                             0.01591234,
                             0.014391345,
                             0.02383721,
                             0.01650729,
                             0.02024563,
                             0.031399626,
                             0.025884844,
                             0.1015605,
                             0.022796296,
                             0.018384418,
                             0.01777975,
                             0.017534133,
                             0.017570836,
                             0.024620043,
                             0.024194906,
                             0.02081864,
                             0.027516559,
                             0.027908025,
                             0.02519905,
                             0.02549674,
                             0.02661204,
                             0.025614612,
                             0.031711616,
                             0.02957214,
                             0.028770987,
                             0.029580468,
                             0.032048244,
                             0.02830721,
                             0.0527275,
                             0.66075575,
                             0.06108773,
                             0.024481108],
                     'max_mae': 0.66075575,
                     'max_mse': 0.4539462,
                     'max_rmse': 0.6737553,
                     'median_mae': 0.02549674,
                     'min_cosine': 0.2205701,
                     'mse': [0.0006847296,
                             0.00042061356,
                             0.0003551965,
                             0.0008353218,
                             0.00044600607,
                             0.0007178419,
                             0.0014078177,
                             0.0011215123,
                             0.011160038,
                             0.0008367485,
                             0.0005706517,
                             0.00053136004,
                             0.00053462584,
                             0.00051128655,
                             0.0009844071,
                             0.00095617725,
                             0.0007544056,
                             0.0012169192,
                             0.0012226553,
                             0.0010774554,
                             0.0010844525,
                             0.0011621679,
                             0.0011252374,
                             0.0016751394,
                             0.0014774811,
                             0.0014325789,
                             0.0015413613,
                             0.0017133816,
                             0.0013875505,
                             0.0037367356,
                             0.4539462,
                             0.0051226215,
                             0.0010044271],
                     'rmse': [0.026167339,
                              0.020508865,
                              0.018846657,
                              0.028901935,
                              0.021118855,
                              0.026792571,
                              0.037520897,
                              0.03348899,
                              0.10564108,
                              0.028926605,
                              0.023888318,
                              0.023051249,
                              0.023121977,
                              0.022611646,
                              0.031375263,
                              0.030922117,
                              0.027466446,
                              0.034884367,
                              0.034966487,
                              0.032824617,
                              0.032931026,
                              0.034090582,
                              0.03354456,
                              0.040928468,
                              0.038438015,
                              0.037849423,
                              0.039260175,
                              0.041393016,
                              0.037249837,
                              0.061128844,
                              0.6737553,
                              0.07157249,
                              0.0316927]},
 'spectra_realpca': {'cosine': [0.99999595,
                                0.99999917,
                                0.9999993,
                                0.99999934,
                                0.9999989,
                                0.9999977,
                                0.99998325,
                                0.9999833,
                                0.9999996,
                                0.99999946,
                                0.99999976,
                                0.9999994,
                                0.9999999,
                                0.99999714,
                                0.9999933,
                                0.9999929,
                                0.99999785,
                                0.9999116,
                                0.99980843,
                                0.9995397,
                                0.9999444,
                                0.9999541,
                                0.9989145,
                                0.9993033,
                                0.9992783,
                                0.99908197,
                                0.99903893,
                                0.9989245,
                                0.99899805,
                                0.999871,
                                0.9999984,
                                0.9993621,
                                0.9997164],
                     'mae': [0.00061818346,
                             0.00040943627,
                             0.00037322298,
                             0.00034916817,
                             0.00044131622,
                             0.0006293321,
                             0.0011540038,
                             0.0010400282,
                             0.0003040199,
                             0.000345133,
                             0.00025632273,
                             0.0003636269,
                             0.00025833122,
                             0.00069036434,
                             0.0008520363,
                             0.0008451438,
                             0.0004610098,
                             0.0020542683,
                             0.0029726604,
                             0.0046003973,
                             0.0016602424,
                             0.0016130707,
                             0.007405549,
                             0.006181294,
                             0.007900908,
                             0.009720833,
                             0.007411548,
                             0.008721519,
                             0.008022155,
                             0.0024445832,
                             0.0002814493,
                             0.006272015,
                             0.0036696359],
                     'max_mae': 0.009720833,
                     'max_mse': 0.00015188524,
                     'max_rmse': 0.012324173,
                     'median_mae': 0.0010400282,
                     'min_cosine': 0.9989145,
                     'mse': [6.0858014e-07,
                             2.6795755e-07,
                             2.2188583e-07,
                             1.9519052e-07,
                             3.121526e-07,
                             6.3858954e-07,
                             2.1408848e-06,
                             1.7307499e-06,
                             1.4731842e-07,
                             1.9186051e-07,
                             1.0555191e-07,
                             2.130017e-07,
                             1.06522606e-07,
                             7.5835e-07,
                             1.1712241e-06,
                             1.1363693e-06,
                             3.4130946e-07,
                             6.70799e-06,
                             1.40599395e-05,
                             3.3959837e-05,
                             4.444509e-06,
                             4.1541757e-06,
                             8.864632e-05,
                             6.174021e-05,
                             0.00010202797,
                             0.00015188524,
                             8.801014e-05,
                             0.00012225116,
                             0.000103061175,
                             9.600602e-06,
                             1.262902e-07,
                             6.255502e-05,
                             2.1628686e-05],
                     'rmse': [0.0007801155,
                              0.00051764614,
                              0.0004710476,
                              0.0004418037,
                              0.0005587062,
                              0.00079911796,
                              0.0014631763,
                              0.0013155796,
                              0.00038382082,
                              0.00043801885,
                              0.00032488754,
                              0.00046152106,
                              0.000326378,
                              0.00087083294,
                              0.001082231,
                              0.0010660063,
                              0.00058421696,
                              0.0025899787,
                              0.0037496586,
                              0.005827507,
                              0.0021082005,
                              0.0020381794,
                              0.009415218,
                              0.007857494,
                              0.010100889,
                              0.012324173,
                              0.0093813725,
                              0.011056725,
                              0.010151905,
                              0.003098484,
                              0.00035537334,
                              0.007909173,
                              0.004650665]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_90.0
