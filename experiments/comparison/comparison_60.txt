
Running comparison for experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805
Directory path: experiments/inpainting/gann_4_night_20180708_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_60.0/images
Optimal number of principal components:  17
Reconstruction error:  21.302534
Energy conservation:  0.6129808
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_60.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [3.933204310299706, 3.224481103817072],
                   'kl_div': 0.26716432,
                   'ks_tests': {10000: KstestResult(statistic=0.1642, pvalue=4.809751531491025e-118, statistic_location=0.008106119, statistic_sign=1),
                                20000: KstestResult(statistic=0.16095000000000004, pvalue=8.679336538516469e-227, statistic_location=0.008065045, statistic_sign=1),
                                30000: KstestResult(statistic=0.16433333333333333, pvalue=0.0, statistic_location=0.007250988, statistic_sign=1),
                                40000: KstestResult(statistic=0.1595000000000001, pvalue=0.0, statistic_location=0.008117671, statistic_sign=1),
                                50000: KstestResult(statistic=0.15903999999999996, pvalue=0.0, statistic_location=0.006925421, statistic_sign=1),
                                60000: KstestResult(statistic=0.15695000000000003, pvalue=0.0, statistic_location=0.007239712, statistic_sign=1),
                                70000: KstestResult(statistic=0.15965714285714294, pvalue=0.0, statistic_location=0.007743068, statistic_sign=1),
                                80000: KstestResult(statistic=0.15895000000000004, pvalue=0.0, statistic_location=0.007983928, statistic_sign=1),
                                90000: KstestResult(statistic=0.15770000000000006, pvalue=0.0, statistic_location=0.0067051603, statistic_sign=1),
                                100000: KstestResult(statistic=0.16098, pvalue=0.0, statistic_location=0.006895816, statistic_sign=1),
                                110000: KstestResult(statistic=0.1574181818181818, pvalue=0.0, statistic_location=0.0076015387, statistic_sign=1)},
                   'moments': {'mean_error': 0.08087623,
                               'means': [-1.1889718e-05, -0.00014796782],
                               'stds': [0.017084507, 0.0062060673],
                               'variance_ratio': 6.447887}},
 'originals': {'gan': {'mae': 0.044734351336956024,
                       'mse': 0.00500925537198782,
                       'psnr': 27.338207244873047,
                       'rmse': 0.0707760900259018,
                       'ssim': 0.9471726417541504},
               'pca': {'mae': 0.013046815060079098,
                       'mse': 0.00030126646743156016,
                       'psnr': 39.51200866699219,
                       'rmse': 0.017357029020786285,
                       'ssim': 0.9968128204345703}},
 'reconstructions': {'mae': 0.04184393957257271,
                     'mse': 0.004743074532598257,
                     'psnr': 27.540916442871094,
                     'rmse': 0.06886998564004898,
                     'ssim': 0.9495517015457153},
 'residual_spectra_pcagan': {'cosine': [0.34506625,
                                        0.05530745,
                                        0.36096343,
                                        0.38411716,
                                        0.3944867,
                                        0.38068616,
                                        0.39263502,
                                        0.43386054,
                                        0.4198368,
                                        0.44131708,
                                        0.2954745],
                             'mae': [0.0107420655,
                                     0.013412271,
                                     0.009006387,
                                     0.009920926,
                                     0.009985702,
                                     0.008425113,
                                     0.008697802,
                                     0.008567672,
                                     0.008743229,
                                     0.008554742,
                                     0.01126073],
                             'max_mae': 0.013412271,
                             'max_mse': 0.0004185944,
                             'max_rmse': 0.02045958,
                             'median_distance': 1.4552786,
                             'median_mae': 0.009006387,
                             'min_cosine': 0.05530745,
                             'mse': [0.00029201055,
                                     0.0004185944,
                                     0.00021178358,
                                     0.00023925652,
                                     0.000331435,
                                     0.00018716975,
                                     0.00016369001,
                                     0.00018048374,
                                     0.00019932013,
                                     0.00017264677,
                                     0.00041302716],
                             'rmse': [0.017088316,
                                      0.02045958,
                                      0.014552786,
                                      0.015467919,
                                      0.018205356,
                                      0.013680999,
                                      0.01279414,
                                      0.013434424,
                                      0.014118078,
                                      0.013139512,
                                      0.02032307]},
 'residuals': {'mae': 0.009756059385836124,
               'mse': 0.00025540159549564123,
               'psnr': 21.3546142578125,
               'rmse': 0.015981288626790047,
               'ssds': [32.106564, 4.23905],
               'ssim': 0.466410368680954},
 'spectra_pcagan': {'cosine': [0.99314195,
                               0.99939036,
                               0.99795836,
                               0.9909587,
                               0.994769,
                               0.9975605,
                               0.9971069,
                               0.9748212,
                               0.99527156,
                               0.9918994,
                               0.98543835],
                    'mae': [0.02870031,
                            0.021985305,
                            0.036945056,
                            0.023881365,
                            0.016975284,
                            0.038567904,
                            0.030058218,
                            0.19333927,
                            0.02267009,
                            0.020363413,
                            0.026797097],
                    'max_mae': 0.19333927,
                    'max_mse': 0.039444633,
                    'max_rmse': 0.19860673,
                    'median_mae': 0.026797097,
                    'min_cosine': 0.9748212,
                    'mse': [0.0015096277,
                            0.00069291703,
                            0.0021798208,
                            0.0010117132,
                            0.0005810109,
                            0.0022645225,
                            0.0014769108,
                            0.039444633,
                            0.00093015155,
                            0.0007272277,
                            0.0013552925],
                    'rmse': [0.03885393,
                             0.026323317,
                             0.04668855,
                             0.031807438,
                             0.024104167,
                             0.047587,
                             0.038430598,
                             0.19860673,
                             0.030498385,
                             0.02696716,
                             0.0368143]},
 'spectra_realgan': {'cosine': [0.99175346,
                                0.9993864,
                                0.9974738,
                                0.9885626,
                                0.992407,
                                0.99695754,
                                0.996352,
                                0.97315854,
                                0.99355114,
                                0.98881245,
                                0.9826634],
                     'mae': [0.032277416,
                             0.021971023,
                             0.039228965,
                             0.027653707,
                             0.021448666,
                             0.04044802,
                             0.03310232,
                             0.19353077,
                             0.027468923,
                             0.024600843,
                             0.030347247],
                     'max_mae': 0.19353077,
                     'max_mse': 0.039805513,
                     'max_rmse': 0.1995132,
                     'median_mae': 0.030347247,
                     'min_cosine': 0.97315854,
                     'mse': [0.001811758,
                             0.00069365103,
                             0.0024994803,
                             0.0012799344,
                             0.00081188173,
                             0.002571155,
                             0.0017536087,
                             0.039805513,
                             0.0012606264,
                             0.0009979114,
                             0.0016162823],
                     'rmse': [0.04256475,
                              0.026337255,
                              0.049994804,
                              0.03577617,
                              0.028493538,
                              0.050706558,
                              0.04187611,
                              0.1995132,
                              0.035505302,
                              0.031589735,
                              0.040203013]},
 'spectra_realpca': {'cosine': [0.9985115,
                                0.99999744,
                                0.9994749,
                                0.99729794,
                                0.9977117,
                                0.9993283,
                                0.9991167,
                                0.99827486,
                                0.99833393,
                                0.9965766,
                                0.99685663],
                     'mae': [0.014379874,
                             0.0009067858,
                             0.015704041,
                             0.013697853,
                             0.0119370045,
                             0.0156876,
                             0.015492274,
                             0.014336306,
                             0.014243255,
                             0.013688411,
                             0.013441564],
                     'max_mae': 0.015704041,
                     'max_mse': 0.00039716362,
                     'max_rmse': 0.019928964,
                     'median_mae': 0.014243255,
                     'min_cosine': 0.9965766,
                     'mse': [0.00032856513,
                             1.3229294e-06,
                             0.00039716362,
                             0.00030104985,
                             0.00022997241,
                             0.00039267004,
                             0.0003854919,
                             0.00036067513,
                             0.0003245447,
                             0.0002992957,
                             0.00029318],
                     'rmse': [0.018126365,
                              0.0011501866,
                              0.019928964,
                              0.017350787,
                              0.015164841,
                              0.019815903,
                              0.019633947,
                              0.018991448,
                              0.018015124,
                              0.017300164,
                              0.0171225]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_60.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628
Directory path: experiments/inpainting/gann_4_night_20180708_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_60.0/images
Optimal number of principal components:  17
Reconstruction error:  21.302534
Energy conservation:  0.6129808
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_60.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.079875858281184, 3.1834878383871446],
                   'kl_div': 0.4219745,
                   'ks_tests': {10000: KstestResult(statistic=0.21, pvalue=2.25850682550439e-193, statistic_location=-0.0078440495, statistic_sign=-1),
                                20000: KstestResult(statistic=0.21255, pvalue=0.0, statistic_location=-0.007347568, statistic_sign=-1),
                                30000: KstestResult(statistic=0.20839999999999997, pvalue=0.0, statistic_location=-0.0076806583, statistic_sign=-1),
                                40000: KstestResult(statistic=0.21480000000000002, pvalue=0.0, statistic_location=-0.007359759, statistic_sign=-1),
                                50000: KstestResult(statistic=0.21546, pvalue=0.0, statistic_location=-0.007339297, statistic_sign=-1),
                                60000: KstestResult(statistic=0.2063666666666667, pvalue=0.0, statistic_location=-0.007485673, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2106, pvalue=0.0, statistic_location=-0.007348234, statistic_sign=-1),
                                80000: KstestResult(statistic=0.20902500000000002, pvalue=0.0, statistic_location=-0.0075690006, statistic_sign=-1),
                                90000: KstestResult(statistic=0.20775555555555558, pvalue=0.0, statistic_location=-0.0073842797, statistic_sign=-1),
                                100000: KstestResult(statistic=0.21205, pvalue=0.0, statistic_location=-0.0073849615, statistic_sign=-1),
                                110000: KstestResult(statistic=0.20937272727272727, pvalue=0.0, statistic_location=-0.0073203463, statistic_sign=-1),
                                120000: KstestResult(statistic=0.208875, pvalue=0.0, statistic_location=-0.007370661, statistic_sign=-1),
                                130000: KstestResult(statistic=0.2085153846153846, pvalue=0.0, statistic_location=-0.007359406, statistic_sign=-1),
                                140000: KstestResult(statistic=0.20897857142857146, pvalue=0.0, statistic_location=-0.007313827, statistic_sign=-1),
                                150000: KstestResult(statistic=0.20858666666666667, pvalue=0.0, statistic_location=-0.0073479787, statistic_sign=-1),
                                160000: KstestResult(statistic=0.21142500000000003, pvalue=0.0, statistic_location=-0.007385509, statistic_sign=-1),
                                170000: KstestResult(statistic=0.21171764705882354, pvalue=0.0, statistic_location=-0.007380506, statistic_sign=-1),
                                180000: KstestResult(statistic=0.20928333333333332, pvalue=0.0, statistic_location=-0.007315344, statistic_sign=-1),
                                190000: KstestResult(statistic=0.20680000000000004, pvalue=0.0, statistic_location=-0.0073456885, statistic_sign=-1),
                                200000: KstestResult(statistic=0.2107, pvalue=0.0, statistic_location=-0.007325271, statistic_sign=-1),
                                210000: KstestResult(statistic=0.20898095238095238, pvalue=0.0, statistic_location=-0.0075166924, statistic_sign=-1),
                                220000: KstestResult(statistic=0.20838636363636365, pvalue=0.0, statistic_location=-0.007469571, statistic_sign=-1)},
                   'moments': {'mean_error': -0.16204925,
                               'means': [-0.0014181881, -8.475901e-05],
                               'stds': [0.01881039, 0.0060964767],
                               'variance_ratio': 7.87015}},
 'originals': {'gan': {'mae': 0.041415736079216,
                       'mse': 0.003690463025122881,
                       'psnr': 29.55628204345703,
                       'rmse': 0.06074918061494827,
                       'ssim': 0.9063164591789246},
               'pca': {'mae': 0.011626631952822208,
                       'mse': 0.0002600780862849206,
                       'psnr': 41.23084259033203,
                       'rmse': 0.016126936301589012,
                       'ssim': 0.9938545227050781}},
 'reconstructions': {'mae': 0.03936806693673134,
                     'mse': 0.0034549038391560316,
                     'psnr': 29.997516632080078,
                     'rmse': 0.05877843126654625,
                     'ssim': 0.9098019599914551},
 'residual_spectra_pcagan': {'cosine': [0.1419073,
                                        0.084972456,
                                        0.3564299,
                                        0.2856064,
                                        0.3024923,
                                        0.40615663,
                                        0.033567406,
                                        0.30912584,
                                        0.37081933,
                                        0.35937366,
                                        0.3695221,
                                        0.33274153,
                                        0.3856628,
                                        0.32205513,
                                        0.33918256,
                                        0.36316344,
                                        0.3843866,
                                        0.36728212,
                                        0.48757955,
                                        0.029007426,
                                        0.39417532,
                                        0.4519762],
                             'mae': [0.013925129,
                                     0.015120193,
                                     0.012333889,
                                     0.013876128,
                                     0.011987417,
                                     0.00990782,
                                     0.014498407,
                                     0.011272884,
                                     0.011879458,
                                     0.011767652,
                                     0.009858239,
                                     0.011178171,
                                     0.010043129,
                                     0.011131736,
                                     0.011837892,
                                     0.011678266,
                                     0.0096841175,
                                     0.011335402,
                                     0.00998932,
                                     0.012800778,
                                     0.009735095,
                                     0.009803053],
                             'max_mae': 0.015120193,
                             'max_mse': 0.00048870046,
                             'max_rmse': 0.022106571,
                             'median_distance': 1.7743502,
                             'median_mae': 0.011506834,
                             'min_cosine': 0.029007426,
                             'mse': [0.00038897456,
                                     0.00048870046,
                                     0.00038479132,
                                     0.00036837382,
                                     0.00031650072,
                                     0.00020039373,
                                     0.00043658985,
                                     0.00031316737,
                                     0.00029595473,
                                     0.00042574745,
                                     0.00021918373,
                                     0.00026722997,
                                     0.0002476981,
                                     0.000408306,
                                     0.00031772847,
                                     0.0003292385,
                                     0.00024640045,
                                     0.00028419384,
                                     0.00020028911,
                                     0.00033031922,
                                     0.00028394812,
                                     0.00024621782],
                             'rmse': [0.019722437,
                                      0.022106571,
                                      0.0196161,
                                      0.019193066,
                                      0.017790467,
                                      0.014156049,
                                      0.020894732,
                                      0.017696535,
                                      0.017203335,
                                      0.02063365,
                                      0.014804855,
                                      0.01634717,
                                      0.015738428,
                                      0.020206584,
                                      0.01782494,
                                      0.01814493,
                                      0.015697148,
                                      0.01685805,
                                      0.014152354,
                                      0.018174686,
                                      0.01685076,
                                      0.015691329]},
 'residuals': {'mae': 0.011620189994573593,
               'mse': 0.0003181794018018991,
               'psnr': 20.42739486694336,
               'rmse': 0.017837584018707275,
               'ssds': [78.28488, 8.178288],
               'ssim': 0.34049558639526367},
 'spectra_pcagan': {'cosine': [0.9989884,
                               0.99940586,
                               0.9850341,
                               0.99470776,
                               0.9968815,
                               0.9931304,
                               0.9991696,
                               0.9968092,
                               0.98481727,
                               0.9911123,
                               0.9966917,
                               0.9948528,
                               0.9783272,
                               0.9919294,
                               0.959718,
                               0.98007405,
                               0.98946875,
                               0.98112047,
                               0.9910583,
                               0.9993175,
                               0.98541516,
                               0.9981758],
                    'mae': [0.016779184,
                            0.020136183,
                            0.025426408,
                            0.048479974,
                            0.057542995,
                            0.030339077,
                            0.019966956,
                            0.054441664,
                            0.03238127,
                            0.02247014,
                            0.047227733,
                            0.043031026,
                            0.17941746,
                            0.030679736,
                            0.05773023,
                            0.03294711,
                            0.025489105,
                            0.04044428,
                            0.023871817,
                            0.017690029,
                            0.022359852,
                            0.017245255],
                    'max_mae': 0.17941746,
                    'max_mse': 0.034859005,
                    'max_rmse': 0.18670566,
                    'median_mae': 0.030509407,
                    'min_cosine': 0.959718,
                    'mse': [0.00045567146,
                            0.0005899891,
                            0.0011069976,
                            0.003659558,
                            0.005496224,
                            0.001552165,
                            0.0006223988,
                            0.0043336553,
                            0.0017395661,
                            0.0009145545,
                            0.003294622,
                            0.002922719,
                            0.034859005,
                            0.0017965481,
                            0.00426926,
                            0.0018807205,
                            0.0011326891,
                            0.0024828517,
                            0.000956339,
                            0.00047594542,
                            0.00095457456,
                            0.0005118352],
                    'rmse': [0.021346463,
                             0.024289692,
                             0.033271573,
                             0.06049428,
                             0.074136525,
                             0.039397527,
                             0.024947923,
                             0.06583051,
                             0.041708104,
                             0.030241603,
                             0.0573988,
                             0.054062176,
                             0.18670566,
                             0.04238571,
                             0.06533957,
                             0.043367274,
                             0.033655446,
                             0.049828224,
                             0.030924732,
                             0.021816174,
                             0.03089619,
                             0.022623776]},
 'spectra_realgan': {'cosine': [0.99894327,
                                0.99940234,
                                0.98145306,
                                0.99415404,
                                0.9965239,
                                0.991695,
                                0.99916625,
                                0.99628097,
                                0.9822146,
                                0.9884819,
                                0.9960184,
                                0.994058,
                                0.97664857,
                                0.99022675,
                                0.95710987,
                                0.97679853,
                                0.98647827,
                                0.9784223,
                                0.9882579,
                                0.99931574,
                                0.98092294,
                                0.997411],
                     'mae': [0.017146079,
                             0.020168345,
                             0.028706223,
                             0.050800398,
                             0.059404463,
                             0.033509545,
                             0.019985925,
                             0.055692036,
                             0.03531207,
                             0.02621587,
                             0.048675243,
                             0.044680182,
                             0.17965956,
                             0.03404801,
                             0.05834632,
                             0.035970166,
                             0.028960349,
                             0.04211721,
                             0.02753194,
                             0.017711489,
                             0.026319312,
                             0.020185553],
                     'max_mae': 0.17965956,
                     'max_mse': 0.035222843,
                     'max_rmse': 0.1876775,
                     'median_mae': 0.03377878,
                     'min_cosine': 0.95710987,
                     'mse': [0.00047266626,
                             0.00059270527,
                             0.0013652463,
                             0.00403947,
                             0.005812725,
                             0.0018575729,
                             0.0006232374,
                             0.004649755,
                             0.0020181779,
                             0.0011730588,
                             0.0036266067,
                             0.0031747771,
                             0.035222843,
                             0.0021111243,
                             0.004506634,
                             0.0021810574,
                             0.0014073155,
                             0.0027539334,
                             0.0012253452,
                             0.00047697028,
                             0.0012224708,
                             0.0006764928],
                     'rmse': [0.02174089,
                              0.02434554,
                              0.03694924,
                              0.06355683,
                              0.07624123,
                              0.04309957,
                              0.024964724,
                              0.068189114,
                              0.044924136,
                              0.034249946,
                              0.060221314,
                              0.05634516,
                              0.1876775,
                              0.045946974,
                              0.06713147,
                              0.046701793,
                              0.037514202,
                              0.052477933,
                              0.035004932,
                              0.021839648,
                              0.03496385,
                              0.026009476]},
 'spectra_realpca': {'cosine': [0.9999711,
                                0.99999845,
                                0.9967321,
                                0.9993996,
                                0.9996252,
                                0.9985115,
                                0.99999744,
                                0.9994749,
                                0.99729794,
                                0.9977117,
                                0.9993283,
                                0.9991167,
                                0.99827486,
                                0.99833393,
                                0.9965766,
                                0.99685663,
                                0.99687886,
                                0.9971412,
                                0.9975033,
                                0.99999905,
                                0.99558854,
                                0.9992346],
                     'mae': [0.0027438942,
                             0.000802816,
                             0.012151252,
                             0.016053246,
                             0.017096736,
                             0.014379874,
                             0.0009067858,
                             0.015704041,
                             0.013697853,
                             0.0119370045,
                             0.0156876,
                             0.015492274,
                             0.014336306,
                             0.014243255,
                             0.013688411,
                             0.013441564,
                             0.013651628,
                             0.013830364,
                             0.012061321,
                             0.0006018746,
                             0.012803823,
                             0.010474011],
                     'max_mae': 0.017096736,
                     'max_mse': 0.00047026607,
                     'max_rmse': 0.021685619,
                     'median_mae': 0.01367002,
                     'min_cosine': 0.99558854,
                     'mse': [1.2074439e-05,
                             1.0204965e-06,
                             0.00023723635,
                             0.0004155872,
                             0.00047026607,
                             0.00032856513,
                             1.3229294e-06,
                             0.00039716362,
                             0.00030104985,
                             0.00022997241,
                             0.00039267004,
                             0.0003854919,
                             0.00036067513,
                             0.0003245447,
                             0.0002992957,
                             0.00029318,
                             0.00029847038,
                             0.0003027877,
                             0.00023131902,
                             5.8709907e-07,
                             0.00026317392,
                             0.0001752643],
                     'rmse': [0.0034748293,
                              0.0010101963,
                              0.015402479,
                              0.020385956,
                              0.021685619,
                              0.018126365,
                              0.0011501866,
                              0.019928964,
                              0.017350787,
                              0.015164841,
                              0.019815903,
                              0.019633947,
                              0.018991448,
                              0.018015124,
                              0.017300164,
                              0.0171225,
                              0.017276295,
                              0.017400796,
                              0.015209176,
                              0.0007662239,
                              0.016222635,
                              0.013238742]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_60.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354
Directory path: experiments/inpainting/gann_4_night_20180708_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_60.0/images
Optimal number of principal components:  17
Reconstruction error:  21.302534
Energy conservation:  0.6129808
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_60.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.061857105227111, 3.1828584663011203],
                   'kl_div': 0.40615508,
                   'ks_tests': {10000: KstestResult(statistic=0.1993, pvalue=4.419820942408936e-174, statistic_location=-0.0064490307, statistic_sign=-1),
                                20000: KstestResult(statistic=0.19110000000000002, pvalue=2.653e-320, statistic_location=-0.0062962035, statistic_sign=-1),
                                30000: KstestResult(statistic=0.19413333333333332, pvalue=0.0, statistic_location=-0.006756725, statistic_sign=-1),
                                40000: KstestResult(statistic=0.19325000000000003, pvalue=0.0, statistic_location=-0.0072697396, statistic_sign=-1),
                                50000: KstestResult(statistic=0.19744, pvalue=0.0, statistic_location=-0.007172847, statistic_sign=-1),
                                60000: KstestResult(statistic=0.19205000000000003, pvalue=0.0, statistic_location=-0.0072685154, statistic_sign=-1),
                                70000: KstestResult(statistic=0.19528571428571428, pvalue=0.0, statistic_location=-0.007349544, statistic_sign=-1),
                                80000: KstestResult(statistic=0.197175, pvalue=0.0, statistic_location=-0.0073233433, statistic_sign=-1),
                                90000: KstestResult(statistic=0.19125555555555557, pvalue=0.0, statistic_location=-0.0071848547, statistic_sign=-1),
                                100000: KstestResult(statistic=0.19655, pvalue=0.0, statistic_location=-0.007284267, statistic_sign=-1),
                                110000: KstestResult(statistic=0.1935818181818182, pvalue=0.0, statistic_location=-0.0075393254, statistic_sign=-1),
                                120000: KstestResult(statistic=0.19380000000000003, pvalue=0.0, statistic_location=-0.006977815, statistic_sign=-1),
                                130000: KstestResult(statistic=0.1939384615384615, pvalue=0.0, statistic_location=-0.0067644734, statistic_sign=-1),
                                140000: KstestResult(statistic=0.19125000000000003, pvalue=0.0, statistic_location=-0.0073736003, statistic_sign=-1),
                                150000: KstestResult(statistic=0.19054000000000001, pvalue=0.0, statistic_location=-0.0064398833, statistic_sign=-1),
                                160000: KstestResult(statistic=0.19440625, pvalue=0.0, statistic_location=-0.0072138878, statistic_sign=-1),
                                170000: KstestResult(statistic=0.1936705882352941, pvalue=0.0, statistic_location=-0.007373847, statistic_sign=-1),
                                180000: KstestResult(statistic=0.1938722222222222, pvalue=0.0, statistic_location=-0.0070440527, statistic_sign=-1),
                                190000: KstestResult(statistic=0.19297894736842106, pvalue=0.0, statistic_location=-0.0073808795, statistic_sign=-1),
                                200000: KstestResult(statistic=0.19371500000000003, pvalue=0.0, statistic_location=-0.0071125315, statistic_sign=-1),
                                210000: KstestResult(statistic=0.1942904761904762, pvalue=0.0, statistic_location=-0.0072851228, statistic_sign=-1),
                                220000: KstestResult(statistic=0.19442727272727273, pvalue=0.0, statistic_location=-0.00751139, statistic_sign=-1),
                                230000: KstestResult(statistic=0.19286086956521742, pvalue=0.0, statistic_location=-0.007021147, statistic_sign=-1),
                                240000: KstestResult(statistic=0.19406666666666667, pvalue=0.0, statistic_location=-0.007022344, statistic_sign=-1),
                                250000: KstestResult(statistic=0.194012, pvalue=0.0, statistic_location=-0.007285118, statistic_sign=-1),
                                260000: KstestResult(statistic=0.19515, pvalue=0.0, statistic_location=-0.0068786805, statistic_sign=-1),
                                270000: KstestResult(statistic=0.19384074074074076, pvalue=0.0, statistic_location=-0.006768342, statistic_sign=-1),
                                280000: KstestResult(statistic=0.19460714285714284, pvalue=0.0, statistic_location=-0.007220166, statistic_sign=-1),
                                290000: KstestResult(statistic=0.1937344827586207, pvalue=0.0, statistic_location=-0.0067660883, statistic_sign=-1),
                                300000: KstestResult(statistic=0.1932766666666667, pvalue=0.0, statistic_location=-0.0068052355, statistic_sign=-1),
                                310000: KstestResult(statistic=0.19402580645161288, pvalue=0.0, statistic_location=-0.007580732, statistic_sign=-1),
                                320000: KstestResult(statistic=0.19319375, pvalue=0.0, statistic_location=-0.007286936, statistic_sign=-1),
                                330000: KstestResult(statistic=0.19403333333333334, pvalue=0.0, statistic_location=-0.0073127295, statistic_sign=-1)},
                   'moments': {'mean_error': -0.043152697,
                               'means': [-0.0005078844, -3.7479593e-05],
                               'stds': [0.017889043, 0.0061161597],
                               'variance_ratio': 7.4271197}},
 'originals': {'gan': {'mae': 0.03434796258807182,
                       'mse': 0.0026877636555582285,
                       'psnr': 30.955209732055664,
                       'rmse': 0.05184364691376686,
                       'ssim': 0.9331125020980835},
               'pca': {'mae': 0.010521150194108486,
                       'mse': 0.00022072254796512425,
                       'psnr': 42.023658752441406,
                       'rmse': 0.014856734313070774,
                       'ssim': 0.9954962730407715}},
 'reconstructions': {'mae': 0.032204072922468185,
                     'mse': 0.002483474090695381,
                     'psnr': 31.511531829833984,
                     'rmse': 0.049834467470645905,
                     'ssim': 0.9358317852020264},
 'residual_spectra_pcagan': {'cosine': [0.51058024,
                                        0.14816122,
                                        0.4698234,
                                        0.37650272,
                                        0.45020035,
                                        0.1959429,
                                        0.13315852,
                                        0.07800692,
                                        0.36261952,
                                        0.28257263,
                                        0.3136264,
                                        0.4182007,
                                        0.03479097,
                                        0.3144858,
                                        0.39485663,
                                        0.38875383,
                                        0.38606542,
                                        0.3360296,
                                        0.39153114,
                                        0.33309624,
                                        0.35331437,
                                        0.37535715,
                                        0.39999658,
                                        0.38391688,
                                        0.4948491,
                                        0.024268255,
                                        0.3993423,
                                        0.4467244,
                                        0.4635055,
                                        0.52900845,
                                        0.5304396,
                                        0.21544394,
                                        0.030570382],
                             'mae': [0.008929196,
                                     0.011516521,
                                     0.008699571,
                                     0.010441396,
                                     0.009524643,
                                     0.014042496,
                                     0.014089161,
                                     0.015023592,
                                     0.012185248,
                                     0.01387959,
                                     0.011595947,
                                     0.009585616,
                                     0.014315675,
                                     0.011120581,
                                     0.011314639,
                                     0.011229478,
                                     0.009449111,
                                     0.011041453,
                                     0.009777666,
                                     0.010830291,
                                     0.011567972,
                                     0.011399723,
                                     0.009448941,
                                     0.011063346,
                                     0.009871131,
                                     0.01259766,
                                     0.00955319,
                                     0.009813882,
                                     0.009497662,
                                     0.00879052,
                                     0.007947685,
                                     0.0111660175,
                                     0.013446655],
                             'max_mae': 0.015023592,
                             'max_mse': 0.00047040996,
                             'max_rmse': 0.021688936,
                             'median_distance': 1.6353875,
                             'median_mae': 0.011063346,
                             'min_cosine': 0.024268255,
                             'mse': [0.00016266158,
                                     0.00025081975,
                                     0.00017250313,
                                     0.00030816538,
                                     0.00018260081,
                                     0.00041612884,
                                     0.00040023413,
                                     0.00047040996,
                                     0.00037079107,
                                     0.00037512917,
                                     0.00029655374,
                                     0.0001902612,
                                     0.00042031016,
                                     0.0003012745,
                                     0.0002528981,
                                     0.00035396003,
                                     0.00019499284,
                                     0.00026688384,
                                     0.00023376117,
                                     0.00037502652,
                                     0.00029290983,
                                     0.00031656455,
                                     0.00022440776,
                                     0.00026015582,
                                     0.00019257561,
                                     0.00032352135,
                                     0.00027493428,
                                     0.00025760362,
                                     0.00021853861,
                                     0.00015723979,
                                     0.00016780183,
                                     0.00026744924,
                                     0.00036493398],
                             'rmse': [0.012753885,
                                      0.01583729,
                                      0.013134045,
                                      0.01755464,
                                      0.013512987,
                                      0.020399237,
                                      0.020005852,
                                      0.021688936,
                                      0.019255936,
                                      0.019368252,
                                      0.017220736,
                                      0.01379352,
                                      0.020501466,
                                      0.01735726,
                                      0.01590277,
                                      0.018813826,
                                      0.013963983,
                                      0.01633658,
                                      0.01528925,
                                      0.019365601,
                                      0.01711461,
                                      0.01779226,
                                      0.014980245,
                                      0.016129347,
                                      0.013877162,
                                      0.0179867,
                                      0.016581142,
                                      0.016050035,
                                      0.014783052,
                                      0.012539529,
                                      0.012953835,
                                      0.016353875,
                                      0.019103246]},
 'residuals': {'mae': 0.011053222231566906,
               'mse': 0.00028224248671904206,
               'psnr': 21.19445037841797,
               'rmse': 0.01680007390677929,
               'ssds': [105.69071, 12.34487],
               'ssim': 0.3496050536632538},
 'spectra_pcagan': {'cosine': [0.99802256,
                               0.9992445,
                               0.98744833,
                               0.9955382,
                               0.98679435,
                               0.99858254,
                               0.99896896,
                               0.9994121,
                               0.98488885,
                               0.99465907,
                               0.99690086,
                               0.99317276,
                               0.9991779,
                               0.9968138,
                               0.9851438,
                               0.9915675,
                               0.9967554,
                               0.9948479,
                               0.9782755,
                               0.99216884,
                               0.96020186,
                               0.9807154,
                               0.9896668,
                               0.98128664,
                               0.9910252,
                               0.9993135,
                               0.98524463,
                               0.99813336,
                               0.98871183,
                               0.9967646,
                               0.99681705,
                               0.99845225,
                               0.99968874],
                    'mae': [0.015490522,
                            0.0147519605,
                            0.020394776,
                            0.018274065,
                            0.020652765,
                            0.017624315,
                            0.016987741,
                            0.019870441,
                            0.025538266,
                            0.048581786,
                            0.057340983,
                            0.030175894,
                            0.019965496,
                            0.053729407,
                            0.032062873,
                            0.022029513,
                            0.046940096,
                            0.043481342,
                            0.18001783,
                            0.029890051,
                            0.057420533,
                            0.032415736,
                            0.025171624,
                            0.040560048,
                            0.02394133,
                            0.017804282,
                            0.022288308,
                            0.017227737,
                            0.021210749,
                            0.016812889,
                            0.018933993,
                            0.018330611,
                            0.016816143],
                    'max_mae': 0.18001783,
                    'max_mse': 0.03509217,
                    'max_rmse': 0.18732904,
                    'median_mae': 0.022029513,
                    'min_cosine': 0.96020186,
                    'mse': [0.0004029581,
                            0.00034782034,
                            0.0007151939,
                            0.0005864807,
                            0.00074481394,
                            0.00054081023,
                            0.00046818866,
                            0.0005762722,
                            0.0011138781,
                            0.003691446,
                            0.005452478,
                            0.0015392065,
                            0.0006213623,
                            0.004249991,
                            0.0017020161,
                            0.0008616848,
                            0.003254504,
                            0.002952186,
                            0.03509217,
                            0.001722862,
                            0.0042202263,
                            0.0018164478,
                            0.0011015185,
                            0.0024623775,
                            0.0009619254,
                            0.00048069234,
                            0.0009613363,
                            0.0005165472,
                            0.0007550878,
                            0.0004835542,
                            0.0006018905,
                            0.0005446163,
                            0.0004121046],
                    'rmse': [0.020073816,
                             0.018649941,
                             0.02674311,
                             0.024217363,
                             0.02729128,
                             0.023255328,
                             0.021637667,
                             0.02400567,
                             0.033374812,
                             0.060757272,
                             0.073840894,
                             0.039232723,
                             0.02492714,
                             0.065191954,
                             0.041255496,
                             0.029354468,
                             0.05704826,
                             0.054334022,
                             0.18732904,
                             0.041507374,
                             0.064963266,
                             0.042619806,
                             0.033189133,
                             0.04962235,
                             0.031014923,
                             0.021924697,
                             0.031005424,
                             0.022727674,
                             0.02747886,
                             0.021989865,
                             0.024533456,
                             0.023337016,
                             0.020300359]},
 'spectra_realgan': {'cosine': [0.9972508,
                                0.9992217,
                                0.9832243,
                                0.9942407,
                                0.9827068,
                                0.99848765,
                                0.9989239,
                                0.99940866,
                                0.981297,
                                0.9941067,
                                0.9965379,
                                0.99172515,
                                0.99917454,
                                0.99628705,
                                0.98253846,
                                0.98896176,
                                0.9960904,
                                0.9940449,
                                0.9766165,
                                0.9904791,
                                0.95758724,
                                0.9774088,
                                0.98670197,
                                0.97857785,
                                0.9882232,
                                0.99931186,
                                0.9807606,
                                0.99736637,
                                0.9840904,
                                0.9953628,
                                0.9951784,
                                0.99834573,
                                0.9996884],
                     'mae': [0.01854198,
                             0.014985778,
                             0.023866238,
                             0.021071851,
                             0.024249308,
                             0.018311145,
                             0.017341811,
                             0.019904904,
                             0.028784158,
                             0.050913114,
                             0.059168078,
                             0.03345968,
                             0.019981595,
                             0.055011444,
                             0.03497756,
                             0.025771726,
                             0.048374493,
                             0.04506426,
                             0.18023531,
                             0.033359133,
                             0.05806259,
                             0.03555152,
                             0.02864439,
                             0.04216679,
                             0.02758377,
                             0.017824937,
                             0.026277814,
                             0.02017742,
                             0.02529138,
                             0.020647043,
                             0.022136098,
                             0.018928431,
                             0.016816907],
                     'max_mae': 0.18023531,
                     'max_mse': 0.035449803,
                     'max_rmse': 0.18828118,
                     'median_mae': 0.025771726,
                     'min_cosine': 0.95758724,
                     'mse': [0.00055797707,
                             0.00035868314,
                             0.00095437886,
                             0.0007570537,
                             0.0009759421,
                             0.0005737491,
                             0.00048503513,
                             0.0005789536,
                             0.0013730456,
                             0.004070556,
                             0.0057761464,
                             0.0018476741,
                             0.0006221682,
                             0.0045668185,
                             0.0019810996,
                             0.0011185808,
                             0.0035820708,
                             0.0032059634,
                             0.035449803,
                             0.0020360278,
                             0.004457984,
                             0.0021198776,
                             0.0013743723,
                             0.0027345,
                             0.0012311836,
                             0.00048168088,
                             0.0012288577,
                             0.0006819425,
                             0.0010366923,
                             0.0006882518,
                             0.0008001526,
                             0.0005767722,
                             0.0004122014],
                     'rmse': [0.023621539,
                              0.018938933,
                              0.030893022,
                              0.027514609,
                              0.031240072,
                              0.02395306,
                              0.022023514,
                              0.024061454,
                              0.03705463,
                              0.06380091,
                              0.076000966,
                              0.04298458,
                              0.0249433,
                              0.06757824,
                              0.044509545,
                              0.03344519,
                              0.059850402,
                              0.056621227,
                              0.18828118,
                              0.045122366,
                              0.06676814,
                              0.04604213,
                              0.03707253,
                              0.052292448,
                              0.035088226,
                              0.02194723,
                              0.035055067,
                              0.026114028,
                              0.032197706,
                              0.026234554,
                              0.02828697,
                              0.024016082,
                              0.020302743]},
 'spectra_realpca': {'cosine': [0.99931157,
                                0.99998575,
                                0.9955695,
                                0.99860334,
                                0.99563825,
                                0.99993134,
                                0.9999711,
                                0.99999845,
                                0.9967321,
                                0.9993996,
                                0.9996252,
                                0.9985115,
                                0.99999744,
                                0.9994749,
                                0.99729794,
                                0.9977117,
                                0.9993283,
                                0.9991167,
                                0.99827486,
                                0.99833393,
                                0.9965766,
                                0.99685663,
                                0.99687886,
                                0.9971412,
                                0.9975033,
                                0.99999905,
                                0.99558854,
                                0.9992346,
                                0.99555993,
                                0.99859595,
                                0.9983745,
                                0.99988145,
                                0.9999995],
                     'mae': [0.0092856735,
                             0.0020087035,
                             0.012411506,
                             0.010701423,
                             0.01230454,
                             0.003955539,
                             0.0027438942,
                             0.000802816,
                             0.012151252,
                             0.016053246,
                             0.017096736,
                             0.014379874,
                             0.0009067858,
                             0.015704041,
                             0.013697853,
                             0.0119370045,
                             0.0156876,
                             0.015492274,
                             0.014336306,
                             0.014243255,
                             0.013688411,
                             0.013441564,
                             0.013651628,
                             0.013830364,
                             0.012061321,
                             0.0006018746,
                             0.012803823,
                             0.010474011,
                             0.01283557,
                             0.011382368,
                             0.011460573,
                             0.0046086847,
                             0.00045735703],
                     'max_mae': 0.017096736,
                     'max_mse': 0.00047026607,
                     'max_rmse': 0.021685619,
                     'median_mae': 0.01230454,
                     'min_cosine': 0.99555993,
                     'mse': [0.0001382324,
                             6.5208487e-06,
                             0.00024761053,
                             0.0001830763,
                             0.00024372895,
                             2.4882725e-05,
                             1.2074439e-05,
                             1.0204965e-06,
                             0.00023723635,
                             0.0004155872,
                             0.00047026607,
                             0.00032856513,
                             1.3229294e-06,
                             0.00039716362,
                             0.00030104985,
                             0.00022997241,
                             0.00039267004,
                             0.0003854919,
                             0.00036067513,
                             0.0003245447,
                             0.0002992957,
                             0.00029318,
                             0.00029847038,
                             0.0003027877,
                             0.00023131902,
                             5.8709907e-07,
                             0.00026317392,
                             0.0001752643,
                             0.00026592345,
                             0.00020810048,
                             0.00020961407,
                             3.4100667e-05,
                             3.3549964e-07],
                     'rmse': [0.011757228,
                              0.0025535952,
                              0.015735645,
                              0.013530569,
                              0.015611821,
                              0.0049882587,
                              0.0034748293,
                              0.0010101963,
                              0.015402479,
                              0.020385956,
                              0.021685619,
                              0.018126365,
                              0.0011501866,
                              0.019928964,
                              0.017350787,
                              0.015164841,
                              0.019815903,
                              0.019633947,
                              0.018991448,
                              0.018015124,
                              0.017300164,
                              0.0171225,
                              0.017276295,
                              0.017400796,
                              0.015209176,
                              0.0007662239,
                              0.016222635,
                              0.013238742,
                              0.016307158,
                              0.014425688,
                              0.014478055,
                              0.005839578,
                              0.0005792233]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_60.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516
Directory path: experiments/inpainting/gann_4_night_20180722_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_60.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_60.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.35918432275619, 3.1215890132546327],
                   'kl_div': 0.8423621,
                   'ks_tests': {10000: KstestResult(statistic=0.302, pvalue=1e-323, statistic_location=0.008289905, statistic_sign=1),
                                20000: KstestResult(statistic=0.3074, pvalue=0.0, statistic_location=0.008373642, statistic_sign=1),
                                30000: KstestResult(statistic=0.30413333333333337, pvalue=0.0, statistic_location=0.00857476, statistic_sign=1),
                                40000: KstestResult(statistic=0.30489999999999995, pvalue=0.0, statistic_location=0.008842245, statistic_sign=1),
                                50000: KstestResult(statistic=0.30610000000000004, pvalue=0.0, statistic_location=0.008683866, statistic_sign=1),
                                60000: KstestResult(statistic=0.30228333333333335, pvalue=0.0, statistic_location=0.0086937435, statistic_sign=1),
                                70000: KstestResult(statistic=0.3036142857142857, pvalue=0.0, statistic_location=0.00881762, statistic_sign=1),
                                80000: KstestResult(statistic=0.3037875, pvalue=0.0, statistic_location=0.008436973, statistic_sign=1),
                                90000: KstestResult(statistic=0.30438888888888893, pvalue=0.0, statistic_location=0.008152529, statistic_sign=1),
                                100000: KstestResult(statistic=0.30633999999999995, pvalue=0.0, statistic_location=0.0086729415, statistic_sign=1),
                                110000: KstestResult(statistic=0.30391818181818187, pvalue=0.0, statistic_location=0.008770883, statistic_sign=1)},
                   'moments': {'mean_error': 0.08277822,
                               'means': [-0.00073593855, -0.00044577167],
                               'stds': [0.022726193, 0.005489738],
                               'variance_ratio': 8.24979}},
 'originals': {'gan': {'mae': 0.05885758250951767,
                       'mse': 0.005448393989354372,
                       'psnr': 27.10418128967285,
                       'rmse': 0.07381323724985123,
                       'ssim': 0.603545069694519},
               'pca': {'mae': 0.012983637861907482,
                       'mse': 0.0002722899953369051,
                       'psnr': 40.598304748535156,
                       'rmse': 0.016501212492585182,
                       'ssim': 0.9844791293144226}},
 'reconstructions': {'mae': 0.057177815586328506,
                     'mse': 0.005125264637172222,
                     'psnr': 27.851459503173828,
                     'rmse': 0.07159095257520676,
                     'ssim': 0.6051655411720276},
 'residual_spectra_pcagan': {'cosine': [0.26564148,
                                        0.23854306,
                                        0.23416865,
                                        0.26053408,
                                        0.25381,
                                        0.33885944,
                                        0.29297134,
                                        0.24404314,
                                        0.2251663,
                                        0.22150944,
                                        0.2624583],
                             'mae': [0.014994153,
                                     0.017118374,
                                     0.017104134,
                                     0.016188318,
                                     0.014930034,
                                     0.014704486,
                                     0.013270199,
                                     0.018236991,
                                     0.020036701,
                                     0.018978633,
                                     0.016830673],
                             'max_mae': 0.020036701,
                             'max_mse': 0.0006272451,
                             'max_rmse': 0.025044862,
                             'median_distance': 2.189767,
                             'median_mae': 0.016830673,
                             'min_cosine': 0.22150944,
                             'mse': [0.0003872383,
                                     0.0006108163,
                                     0.0005075031,
                                     0.00041695996,
                                     0.00047950787,
                                     0.00036319596,
                                     0.0003557844,
                                     0.0005323883,
                                     0.0006272451,
                                     0.0005663711,
                                     0.0004724926],
                             'rmse': [0.019678371,
                                      0.024714697,
                                      0.022527829,
                                      0.020419598,
                                      0.021897668,
                                      0.0190577,
                                      0.018862247,
                                      0.023073541,
                                      0.025044862,
                                      0.023798551,
                                      0.021736896]},
 'residuals': {'mae': 0.016581155359745026,
               'mse': 0.0004835911968257278,
               'psnr': 8.197175025939941,
               'rmse': 0.021990707144141197,
               'ssds': [56.87184, 3.3369234],
               'ssim': 0.12163029611110687},
 'spectra_pcagan': {'cosine': [0.99116933,
                               0.9842978,
                               0.96088547,
                               0.95188564,
                               0.95586,
                               0.972211,
                               0.975154,
                               0.93962836,
                               0.9159561,
                               0.91690403,
                               0.9272211],
                    'mae': [0.071225174,
                            0.07258539,
                            0.06246844,
                            0.06437354,
                            0.045106705,
                            0.042673133,
                            0.03895635,
                            0.054263283,
                            0.06242841,
                            0.059908032,
                            0.05496742],
                    'max_mae': 0.07258539,
                    'max_mse': 0.007976555,
                    'max_rmse': 0.08931156,
                    'median_mae': 0.059908032,
                    'min_cosine': 0.9159561,
                    'mse': [0.0075000906,
                            0.007976555,
                            0.005692697,
                            0.006373456,
                            0.0031035342,
                            0.0027325316,
                            0.0024625135,
                            0.004419792,
                            0.0059709065,
                            0.005377533,
                            0.004768304],
                    'rmse': [0.08660306,
                             0.08931156,
                             0.075449966,
                             0.07983393,
                             0.055709373,
                             0.052273624,
                             0.04962372,
                             0.066481516,
                             0.07727164,
                             0.07333166,
                             0.069052905]},
 'spectra_realgan': {'cosine': [0.99050224,
                                0.98320454,
                                0.958425,
                                0.9485156,
                                0.95228004,
                                0.96986884,
                                0.97265184,
                                0.9365318,
                                0.912984,
                                0.91408354,
                                0.92231876],
                     'mae': [0.073525995,
                             0.07423982,
                             0.06392931,
                             0.066407725,
                             0.046533234,
                             0.044256676,
                             0.041072655,
                             0.05594315,
                             0.06368616,
                             0.06099438,
                             0.056844275],
                     'max_mae': 0.07423982,
                     'max_mse': 0.00842498,
                     'max_rmse': 0.09178769,
                     'median_mae': 0.06099438,
                     'min_cosine': 0.912984,
                     'mse': [0.008046477,
                             0.00842498,
                             0.0059988564,
                             0.0067990287,
                             0.0033501007,
                             0.0030101966,
                             0.0027172633,
                             0.004679983,
                             0.006192801,
                             0.005587246,
                             0.0051254076],
                     'rmse': [0.08970216,
                              0.09178769,
                              0.07745229,
                              0.08245622,
                              0.057880055,
                              0.05486526,
                              0.052127376,
                              0.068410404,
                              0.07869435,
                              0.07474788,
                              0.07159195]},
 'spectra_realpca': {'cosine': [0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349],
                     'mae': [0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197],
                     'max_mae': 0.015567541,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.012521197,
                     'min_cosine': 0.9963109,
                     'mse': [0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102],
                     'rmse': [0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_60.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115
Directory path: experiments/inpainting/gann_4_night_20180722_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_60.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_60.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.22363691969865, 3.112562869251242],
                   'kl_div': 0.6277143,
                   'ks_tests': {10000: KstestResult(statistic=0.2572, pvalue=5.857140714902907e-291, statistic_location=0.007516727, statistic_sign=1),
                                20000: KstestResult(statistic=0.25764999999999993, pvalue=0.0, statistic_location=0.008067217, statistic_sign=1),
                                30000: KstestResult(statistic=0.2529, pvalue=0.0, statistic_location=0.008372242, statistic_sign=1),
                                40000: KstestResult(statistic=0.25760000000000005, pvalue=0.0, statistic_location=0.00849014, statistic_sign=1),
                                50000: KstestResult(statistic=0.25458000000000003, pvalue=0.0, statistic_location=0.008611836, statistic_sign=1),
                                60000: KstestResult(statistic=0.2532500000000001, pvalue=0.0, statistic_location=0.0085772965, statistic_sign=1),
                                70000: KstestResult(statistic=0.2525857142857143, pvalue=0.0, statistic_location=0.00834867, statistic_sign=1),
                                80000: KstestResult(statistic=0.2521125000000001, pvalue=0.0, statistic_location=0.008001601, statistic_sign=1),
                                90000: KstestResult(statistic=0.25211111111111106, pvalue=0.0, statistic_location=0.008618427, statistic_sign=1),
                                100000: KstestResult(statistic=0.25412, pvalue=0.0, statistic_location=0.008454232, statistic_sign=1),
                                110000: KstestResult(statistic=0.25485454545454556, pvalue=0.0, statistic_location=0.008448332, statistic_sign=1),
                                120000: KstestResult(statistic=0.254775, pvalue=0.0, statistic_location=0.008064288, statistic_sign=1),
                                130000: KstestResult(statistic=0.2520923076923077, pvalue=0.0, statistic_location=0.0081021115, statistic_sign=1),
                                140000: KstestResult(statistic=0.2543928571428571, pvalue=0.0, statistic_location=0.008576353, statistic_sign=1),
                                150000: KstestResult(statistic=0.25229333333333337, pvalue=0.0, statistic_location=0.008109527, statistic_sign=1),
                                160000: KstestResult(statistic=0.25378125000000007, pvalue=0.0, statistic_location=0.008449911, statistic_sign=1),
                                170000: KstestResult(statistic=0.2527058823529412, pvalue=0.0, statistic_location=0.008306885, statistic_sign=1),
                                180000: KstestResult(statistic=0.2530833333333333, pvalue=0.0, statistic_location=0.008374175, statistic_sign=1),
                                190000: KstestResult(statistic=0.2539368421052631, pvalue=0.0, statistic_location=0.008631615, statistic_sign=1),
                                200000: KstestResult(statistic=0.25304000000000004, pvalue=0.0, statistic_location=0.007968385, statistic_sign=1),
                                210000: KstestResult(statistic=0.2535761904761905, pvalue=0.0, statistic_location=0.008471068, statistic_sign=1),
                                220000: KstestResult(statistic=0.2543090909090908, pvalue=0.0, statistic_location=0.0085856635, statistic_sign=1)},
                   'moments': {'mean_error': 0.0038906129,
                               'means': [-0.00054423965, -5.0476283e-05],
                               'stds': [0.019667108, 0.0054564234],
                               'variance_ratio': 8.458123}},
 'originals': {'gan': {'mae': 0.05455929413437843,
                       'mse': 0.004739472642540932,
                       'psnr': 27.725784301757812,
                       'rmse': 0.06884382665157318,
                       'ssim': 0.6566916704177856},
               'pca': {'mae': 0.013096767477691174,
                       'mse': 0.00027656604652293026,
                       'psnr': 40.53063201904297,
                       'rmse': 0.016630275174975395,
                       'ssim': 0.9780802726745605}},
 'reconstructions': {'mae': 0.05278368294239044,
                     'mse': 0.004443435464054346,
                     'psnr': 28.471435546875,
                     'rmse': 0.0666591003537178,
                     'ssim': 0.6628926396369934},
 'residual_spectra_pcagan': {'cosine': [0.28260374,
                                        0.25427267,
                                        0.268355,
                                        0.29584593,
                                        0.23188978,
                                        0.28962916,
                                        0.25852224,
                                        0.26286912,
                                        0.29332796,
                                        0.2820993,
                                        0.37338552,
                                        0.32056358,
                                        0.26874948,
                                        0.25312474,
                                        0.2513672,
                                        0.27952856,
                                        0.23953755,
                                        0.28502464,
                                        0.30253372,
                                        0.32720825,
                                        0.27045548,
                                        0.29371408],
                             'mae': [0.010502031,
                                     0.010798579,
                                     0.010070845,
                                     0.010413214,
                                     0.012834576,
                                     0.012951301,
                                     0.0151773235,
                                     0.014890109,
                                     0.013906689,
                                     0.012997799,
                                     0.012823609,
                                     0.011811436,
                                     0.016060349,
                                     0.017822467,
                                     0.016626589,
                                     0.01516656,
                                     0.016007427,
                                     0.013797997,
                                     0.013872792,
                                     0.012407163,
                                     0.016223252,
                                     0.01292536],
                             'max_mae': 0.017822467,
                             'max_mse': 0.0005019679,
                             'max_rmse': 0.02240464,
                             'median_distance': 1.8121607,
                             'median_mae': 0.013397898,
                             'min_cosine': 0.23188978,
                             'mse': [0.00025930666,
                                     0.00030546763,
                                     0.00030148434,
                                     0.00024392085,
                                     0.00033087173,
                                     0.0003042353,
                                     0.0004983933,
                                     0.0003948954,
                                     0.00032153615,
                                     0.00038831035,
                                     0.0002838249,
                                     0.00029352694,
                                     0.00043116504,
                                     0.0005019679,
                                     0.00044528552,
                                     0.0003979254,
                                     0.00041768374,
                                     0.00035424353,
                                     0.0003210409,
                                     0.00029152032,
                                     0.00044081043,
                                     0.0003259229],
                             'rmse': [0.016103001,
                                      0.017477632,
                                      0.017363304,
                                      0.015617966,
                                      0.01818988,
                                      0.017442342,
                                      0.022324724,
                                      0.019871976,
                                      0.01793143,
                                      0.019705592,
                                      0.016847104,
                                      0.017132629,
                                      0.020764515,
                                      0.02240464,
                                      0.02110179,
                                      0.019948067,
                                      0.020437313,
                                      0.018821359,
                                      0.017917614,
                                      0.017073967,
                                      0.020995487,
                                      0.018053336]},
 'residuals': {'mae': 0.013640339486300945,
               'mse': 0.0003569700347725302,
               'psnr': 20.099227905273438,
               'rmse': 0.0188936498016119,
               'ssds': [85.1597, 6.550493],
               'ssim': 0.16781511902809143},
 'spectra_pcagan': {'cosine': [0.9902773,
                               0.99058205,
                               0.98593557,
                               0.98166245,
                               0.98475355,
                               0.99134403,
                               0.98469067,
                               0.9618693,
                               0.9533671,
                               0.9566785,
                               0.97290313,
                               0.9757846,
                               0.94132704,
                               0.91703165,
                               0.91814286,
                               0.9270977,
                               0.9028449,
                               0.9609457,
                               0.9464992,
                               0.9642788,
                               0.9262062,
                               0.9555533],
                    'mae': [0.04954987,
                            0.04831482,
                            0.04154204,
                            0.037994385,
                            0.056879994,
                            0.070389315,
                            0.07150371,
                            0.061738495,
                            0.06303579,
                            0.044605147,
                            0.042243615,
                            0.038479164,
                            0.05336855,
                            0.06202688,
                            0.0593197,
                            0.054996807,
                            0.06251957,
                            0.0451165,
                            0.05207317,
                            0.041342534,
                            0.058123376,
                            0.046077438],
                    'max_mae': 0.07150371,
                    'max_mse': 0.007799086,
                    'max_rmse': 0.08831243,
                    'median_mae': 0.05272086,
                    'min_cosine': 0.9028449,
                    'mse': [0.0040059844,
                            0.0040321765,
                            0.0028679508,
                            0.0023258596,
                            0.0047913417,
                            0.0073422515,
                            0.007799086,
                            0.005567095,
                            0.0061341664,
                            0.0030706367,
                            0.0026718352,
                            0.002433345,
                            0.004295135,
                            0.0059063034,
                            0.0053027747,
                            0.0047799936,
                            0.006218094,
                            0.0031185155,
                            0.00393515,
                            0.00280235,
                            0.00520777,
                            0.003147773],
                    'rmse': [0.063292846,
                             0.06349942,
                             0.053553253,
                             0.04822717,
                             0.069219515,
                             0.08568694,
                             0.08831243,
                             0.07461297,
                             0.07832092,
                             0.055413324,
                             0.0516898,
                             0.049328946,
                             0.06553728,
                             0.07685248,
                             0.07282016,
                             0.0691375,
                             0.07885489,
                             0.05584367,
                             0.062730774,
                             0.05293723,
                             0.07216488,
                             0.056105018]},
 'spectra_realgan': {'cosine': [0.9896691,
                                0.9898579,
                                0.98456603,
                                0.9791487,
                                0.983875,
                                0.9906742,
                                0.9836056,
                                0.95940924,
                                0.950004,
                                0.9531188,
                                0.9706316,
                                0.9733282,
                                0.93827266,
                                0.91403544,
                                0.91530865,
                                0.92216086,
                                0.9011053,
                                0.9585088,
                                0.94279194,
                                0.9608301,
                                0.92520034,
                                0.95235986],
                     'mae': [0.05091956,
                             0.05065085,
                             0.044404034,
                             0.041118804,
                             0.058669947,
                             0.07273627,
                             0.07316233,
                             0.063168325,
                             0.06512662,
                             0.046040375,
                             0.04382759,
                             0.040590435,
                             0.05506352,
                             0.06331624,
                             0.060418434,
                             0.056880366,
                             0.06340985,
                             0.046374947,
                             0.05363102,
                             0.043673262,
                             0.059573457,
                             0.04754814],
                     'max_mae': 0.07316233,
                     'max_mse': 0.008238449,
                     'max_rmse': 0.0907659,
                     'median_mae': 0.05434727,
                     'min_cosine': 0.9011053,
                     'mse': [0.0042169,
                             0.00437998,
                             0.003240988,
                             0.0026799885,
                             0.0051155905,
                             0.007887149,
                             0.008238449,
                             0.005872001,
                             0.006557111,
                             0.0033155568,
                             0.0029443847,
                             0.0026845408,
                             0.004551976,
                             0.006129314,
                             0.005513082,
                             0.0051394324,
                             0.0063526644,
                             0.0033178928,
                             0.004240858,
                             0.0030703791,
                             0.005419961,
                             0.0034001968],
                     'rmse': [0.064937666,
                              0.066181414,
                              0.056929674,
                              0.051768605,
                              0.07152335,
                              0.088809624,
                              0.0907659,
                              0.07662898,
                              0.080975994,
                              0.057580873,
                              0.054262184,
                              0.051812556,
                              0.06746833,
                              0.07828993,
                              0.07425013,
                              0.07168984,
                              0.07970361,
                              0.057601154,
                              0.06512187,
                              0.055411004,
                              0.07362039,
                              0.058311205]},
 'spectra_realpca': {'cosine': [0.99914396,
                                0.9992311,
                                0.9983727,
                                0.9974544,
                                0.99898773,
                                0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349,
                                0.99650675,
                                0.9971242,
                                0.9965543,
                                0.9968424,
                                0.9962396,
                                0.99634945],
                     'mae': [0.014836307,
                             0.01447966,
                             0.013651306,
                             0.013377094,
                             0.014316244,
                             0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197,
                             0.012154227,
                             0.011967489,
                             0.012771271,
                             0.012152725,
                             0.013049042,
                             0.0125535],
                     'max_mae': 0.015567541,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.012704127,
                     'min_cosine': 0.9962396,
                     'mse': [0.00034976797,
                             0.00033549307,
                             0.00029904975,
                             0.00028346918,
                             0.00032609524,
                             0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102,
                             0.00023534271,
                             0.00023139741,
                             0.00026069232,
                             0.00023610053,
                             0.0002807898,
                             0.0002510656],
                     'rmse': [0.018702084,
                              0.01831647,
                              0.017293055,
                              0.016836543,
                              0.018058106,
                              0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779,
                              0.015340883,
                              0.015211753,
                              0.016145969,
                              0.015365563,
                              0.016756784,
                              0.01584505]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_60.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453
Directory path: experiments/inpainting/gann_4_night_20180722_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_60.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_60.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.111089078084709, 3.1001794530905693],
                   'kl_div': 0.49720812,
                   'ks_tests': {10000: KstestResult(statistic=0.2202, pvalue=9.891775891532483e-213, statistic_location=0.007843892, statistic_sign=1),
                                20000: KstestResult(statistic=0.2165999999999999, pvalue=0.0, statistic_location=0.007670423, statistic_sign=1),
                                30000: KstestResult(statistic=0.21833333333333327, pvalue=0.0, statistic_location=0.008136282, statistic_sign=1),
                                40000: KstestResult(statistic=0.2175499999999999, pvalue=0.0, statistic_location=0.007858247, statistic_sign=1),
                                50000: KstestResult(statistic=0.22055999999999998, pvalue=0.0, statistic_location=0.008031031, statistic_sign=1),
                                60000: KstestResult(statistic=0.22001666666666675, pvalue=0.0, statistic_location=0.007788889, statistic_sign=1),
                                70000: KstestResult(statistic=0.21999999999999997, pvalue=0.0, statistic_location=0.0074707866, statistic_sign=1),
                                80000: KstestResult(statistic=0.21662499999999996, pvalue=0.0, statistic_location=0.007521605, statistic_sign=1),
                                90000: KstestResult(statistic=0.21756666666666669, pvalue=0.0, statistic_location=0.007880277, statistic_sign=1),
                                100000: KstestResult(statistic=0.21718000000000004, pvalue=0.0, statistic_location=0.007494458, statistic_sign=1),
                                110000: KstestResult(statistic=0.21752727272727268, pvalue=0.0, statistic_location=0.007471749, statistic_sign=1),
                                120000: KstestResult(statistic=0.2167916666666666, pvalue=0.0, statistic_location=0.0074775796, statistic_sign=1),
                                130000: KstestResult(statistic=0.21834615384615386, pvalue=0.0, statistic_location=0.0074562966, statistic_sign=1),
                                140000: KstestResult(statistic=0.2183857142857143, pvalue=0.0, statistic_location=0.007462807, statistic_sign=1),
                                150000: KstestResult(statistic=0.21667333333333338, pvalue=0.0, statistic_location=0.008015434, statistic_sign=1),
                                160000: KstestResult(statistic=0.21721250000000003, pvalue=0.0, statistic_location=0.007864193, statistic_sign=1),
                                170000: KstestResult(statistic=0.21749411764705884, pvalue=0.0, statistic_location=0.0074236095, statistic_sign=1),
                                180000: KstestResult(statistic=0.21663333333333334, pvalue=0.0, statistic_location=0.008079743, statistic_sign=1),
                                190000: KstestResult(statistic=0.2180736842105263, pvalue=0.0, statistic_location=0.008111652, statistic_sign=1),
                                200000: KstestResult(statistic=0.21511500000000006, pvalue=0.0, statistic_location=0.0075504184, statistic_sign=1),
                                210000: KstestResult(statistic=0.21652857142857151, pvalue=0.0, statistic_location=0.007518876, statistic_sign=1),
                                220000: KstestResult(statistic=0.21692727272727275, pvalue=0.0, statistic_location=0.0074268905, statistic_sign=1),
                                230000: KstestResult(statistic=0.21778260869565225, pvalue=0.0, statistic_location=0.007527382, statistic_sign=1),
                                240000: KstestResult(statistic=0.2178041666666667, pvalue=0.0, statistic_location=0.007525685, statistic_sign=1),
                                250000: KstestResult(statistic=0.21794800000000003, pvalue=0.0, statistic_location=0.007429487, statistic_sign=1),
                                260000: KstestResult(statistic=0.21797692307692318, pvalue=0.0, statistic_location=0.0075296247, statistic_sign=1),
                                270000: KstestResult(statistic=0.21764814814814815, pvalue=0.0, statistic_location=0.0075301956, statistic_sign=1),
                                280000: KstestResult(statistic=0.21677142857142861, pvalue=0.0, statistic_location=0.007433064, statistic_sign=1),
                                290000: KstestResult(statistic=0.21796896551724132, pvalue=0.0, statistic_location=0.007525685, statistic_sign=1),
                                300000: KstestResult(statistic=0.21687, pvalue=0.0, statistic_location=0.0078633195, statistic_sign=1),
                                310000: KstestResult(statistic=0.21828709677419356, pvalue=0.0, statistic_location=0.007485771, statistic_sign=1),
                                320000: KstestResult(statistic=0.21706250000000005, pvalue=0.0, statistic_location=0.0078630345, statistic_sign=1),
                                330000: KstestResult(statistic=0.21763636363636363, pvalue=0.0, statistic_location=0.007892787, statistic_sign=1)},
                   'moments': {'mean_error': -0.0042404295,
                               'means': [-0.00039863147, -2.1693977e-05],
                               'stds': [0.017679268, 0.005385532],
                               'variance_ratio': 8.627582}},
 'originals': {'gan': {'mae': 0.05171003192663193,
                       'mse': 0.004362098407000303,
                       'psnr': 28.81952667236328,
                       'rmse': 0.06604618579149246,
                       'ssim': 0.7228677272796631},
               'pca': {'mae': 0.013429644517600536,
                       'mse': 0.00029108254238963127,
                       'psnr': 40.7747917175293,
                       'rmse': 0.01706114038825035,
                       'ssim': 0.9816524982452393}},
 'reconstructions': {'mae': 0.04971151053905487,
                     'mse': 0.004055059049278498,
                     'psnr': 29.33498191833496,
                     'rmse': 0.06367934495210648,
                     'ssim': 0.7297914624214172},
 'residual_spectra_pcagan': {'cosine': [0.43865642,
                                        0.24162422,
                                        0.33851382,
                                        0.2904345,
                                        0.31440586,
                                        0.27107003,
                                        0.29740414,
                                        0.26412457,
                                        0.30329663,
                                        0.31571752,
                                        0.2341939,
                                        0.30094036,
                                        0.27264938,
                                        0.28328276,
                                        0.31187657,
                                        0.30602232,
                                        0.39502403,
                                        0.35032323,
                                        0.28461316,
                                        0.2715893,
                                        0.27236634,
                                        0.28819954,
                                        0.25545248,
                                        0.30801818,
                                        0.32594854,
                                        0.35910082,
                                        0.2935288,
                                        0.30909878,
                                        0.3610874,
                                        0.37976265,
                                        0.32860368,
                                        0.33697698,
                                        0.28380537],
                             'mae': [0.010307829,
                                     0.011543067,
                                     0.009078416,
                                     0.009397869,
                                     0.009183342,
                                     0.010454051,
                                     0.0099123595,
                                     0.010413985,
                                     0.009421885,
                                     0.010166941,
                                     0.012307652,
                                     0.012033404,
                                     0.014177274,
                                     0.01385857,
                                     0.012729086,
                                     0.011991444,
                                     0.011697062,
                                     0.011068564,
                                     0.014922364,
                                     0.016551461,
                                     0.015271266,
                                     0.014176084,
                                     0.014681517,
                                     0.012756438,
                                     0.012809018,
                                     0.011260095,
                                     0.014887729,
                                     0.01216543,
                                     0.009162823,
                                     0.009436313,
                                     0.009196771,
                                     0.009405595,
                                     0.011066853],
                             'max_mae': 0.016551461,
                             'max_mse': 0.0004356272,
                             'max_rmse': 0.020871684,
                             'median_distance': 1.6654694,
                             'median_mae': 0.011543067,
                             'min_cosine': 0.2341939,
                             'mse': [0.00020070293,
                                     0.000314841,
                                     0.00018760165,
                                     0.00023998735,
                                     0.00018848691,
                                     0.00030048433,
                                     0.00024126201,
                                     0.0002852728,
                                     0.00024048776,
                                     0.00021730617,
                                     0.00032217198,
                                     0.00026426348,
                                     0.00043222724,
                                     0.0003413647,
                                     0.00027737874,
                                     0.00032536022,
                                     0.00023890019,
                                     0.0002495822,
                                     0.00038487438,
                                     0.0004356272,
                                     0.00037485873,
                                     0.00036444768,
                                     0.00036045545,
                                     0.00030593012,
                                     0.00027573522,
                                     0.00023915702,
                                     0.00037236547,
                                     0.00028663193,
                                     0.00018535437,
                                     0.00018155565,
                                     0.00020665588,
                                     0.00022121977,
                                     0.0002972659],
                             'rmse': [0.014166966,
                                      0.017743759,
                                      0.013696775,
                                      0.015491525,
                                      0.013729054,
                                      0.017334484,
                                      0.015532611,
                                      0.016890021,
                                      0.015507667,
                                      0.014741308,
                                      0.017949149,
                                      0.016256183,
                                      0.020790076,
                                      0.018476058,
                                      0.01665469,
                                      0.018037744,
                                      0.015456396,
                                      0.01579817,
                                      0.019618215,
                                      0.020871684,
                                      0.019361269,
                                      0.019090513,
                                      0.018985664,
                                      0.017490858,
                                      0.016605277,
                                      0.015464703,
                                      0.019296773,
                                      0.016930208,
                                      0.013614491,
                                      0.013474259,
                                      0.01437553,
                                      0.014873459,
                                      0.017241402]},
 'residuals': {'mae': 0.011742199771106243,
               'mse': 0.00028363082674331963,
               'psnr': 21.098011016845703,
               'rmse': 0.01684134267270565,
               'ssds': [103.19576, 9.571429],
               'ssim': 0.22103337943553925},
 'spectra_pcagan': {'cosine': [0.9963698,
                               0.99438685,
                               0.9956266,
                               0.9947156,
                               0.9958619,
                               0.9941898,
                               0.99029875,
                               0.99031955,
                               0.9854418,
                               0.9806126,
                               0.9842539,
                               0.99106264,
                               0.98436266,
                               0.9612392,
                               0.95402,
                               0.95667464,
                               0.9732843,
                               0.9759182,
                               0.9413496,
                               0.9185366,
                               0.9188191,
                               0.92797846,
                               0.90390915,
                               0.9617075,
                               0.94762224,
                               0.9649784,
                               0.9271132,
                               0.9554265,
                               0.9740822,
                               0.9776025,
                               0.98743755,
                               0.98771983,
                               0.9894869],
                    'mae': [0.02895067,
                            0.04266675,
                            0.049023084,
                            0.048572775,
                            0.056023497,
                            0.061252892,
                            0.0495633,
                            0.04903637,
                            0.042492125,
                            0.03926784,
                            0.057685602,
                            0.071342446,
                            0.07214283,
                            0.062262837,
                            0.062302727,
                            0.04457293,
                            0.04187726,
                            0.038644116,
                            0.053261742,
                            0.06150753,
                            0.059135124,
                            0.054507904,
                            0.062075067,
                            0.044807233,
                            0.0516789,
                            0.041154943,
                            0.057749476,
                            0.046301115,
                            0.03875649,
                            0.0349078,
                            0.036869936,
                            0.038954005,
                            0.04113254],
                    'max_mae': 0.07214283,
                    'max_mse': 0.0079698,
                    'max_rmse': 0.089273736,
                    'median_mae': 0.049023084,
                    'min_cosine': 0.90390915,
                    'mse': [0.0012863175,
                            0.003211473,
                            0.0038858878,
                            0.0039039506,
                            0.004709052,
                            0.006123947,
                            0.0039803,
                            0.0041435203,
                            0.0029436299,
                            0.0024493064,
                            0.004946753,
                            0.0075787306,
                            0.0079698,
                            0.0056669,
                            0.0060025654,
                            0.0030856284,
                            0.0026376077,
                            0.0024500329,
                            0.004291196,
                            0.005813097,
                            0.0052758013,
                            0.0047103073,
                            0.0061652604,
                            0.0030924445,
                            0.0038729415,
                            0.0027854885,
                            0.0051631485,
                            0.0031829113,
                            0.0024941468,
                            0.0020058854,
                            0.0023234044,
                            0.002516884,
                            0.0031486047],
                    'rmse': [0.03586527,
                             0.05666986,
                             0.06233689,
                             0.0624816,
                             0.06862253,
                             0.07825565,
                             0.06308962,
                             0.064370185,
                             0.05425523,
                             0.049490467,
                             0.07033315,
                             0.08705591,
                             0.089273736,
                             0.07527881,
                             0.077476226,
                             0.055548433,
                             0.051357646,
                             0.049497806,
                             0.06550722,
                             0.07624367,
                             0.07263471,
                             0.06863168,
                             0.07851917,
                             0.05560975,
                             0.06223296,
                             0.052777726,
                             0.07185505,
                             0.056417298,
                             0.049941435,
                             0.044787113,
                             0.048201706,
                             0.050168555,
                             0.056112427]},
 'spectra_realgan': {'cosine': [0.99594945,
                                0.993599,
                                0.9950832,
                                0.9941495,
                                0.9954565,
                                0.99380606,
                                0.9896941,
                                0.98959345,
                                0.9840586,
                                0.9780391,
                                0.98338234,
                                0.99038804,
                                0.983271,
                                0.9587497,
                                0.95064867,
                                0.95316404,
                                0.97102016,
                                0.97345513,
                                0.93828213,
                                0.9155233,
                                0.9159966,
                                0.92306614,
                                0.90216774,
                                0.95925295,
                                0.9439704,
                                0.96156967,
                                0.92616457,
                                0.95225024,
                                0.9714461,
                                0.9741205,
                                0.98563623,
                                0.98602635,
                                0.98827475],
                     'mae': [0.030195968,
                             0.04384645,
                             0.05171915,
                             0.051315956,
                             0.0585284,
                             0.064356156,
                             0.05100211,
                             0.051354375,
                             0.045245912,
                             0.04232188,
                             0.059441272,
                             0.07366079,
                             0.073836826,
                             0.063720815,
                             0.06439157,
                             0.04602444,
                             0.04345906,
                             0.040787138,
                             0.05499627,
                             0.062789485,
                             0.06026786,
                             0.056387287,
                             0.0629972,
                             0.04607277,
                             0.05318295,
                             0.04348565,
                             0.059214,
                             0.047780782,
                             0.041187927,
                             0.037686408,
                             0.039182164,
                             0.041614648,
                             0.04437734],
                     'max_mae': 0.073836826,
                     'max_mse': 0.008408905,
                     'max_rmse': 0.091700085,
                     'median_mae': 0.051315956,
                     'min_cosine': 0.90216774,
                     'mse': [0.0013965998,
                             0.0033654594,
                             0.0043091304,
                             0.0043066847,
                             0.0051687118,
                             0.00663488,
                             0.004193502,
                             0.0044916635,
                             0.0033190364,
                             0.002811561,
                             0.005270784,
                             0.008125987,
                             0.008408905,
                             0.005973664,
                             0.0064246827,
                             0.0033273175,
                             0.0029098277,
                             0.0027023253,
                             0.0045493,
                             0.0060367663,
                             0.005485335,
                             0.0050676977,
                             0.006299948,
                             0.0032926055,
                             0.0041749026,
                             0.0030507362,
                             0.0053743967,
                             0.0034350727,
                             0.0027860254,
                             0.0022955164,
                             0.0025833887,
                             0.0028579237,
                             0.0035189064],
                     'rmse': [0.03737111,
                              0.05801258,
                              0.065643966,
                              0.06562533,
                              0.07189375,
                              0.08145477,
                              0.06475726,
                              0.06701987,
                              0.057611078,
                              0.053024154,
                              0.07260016,
                              0.090144254,
                              0.091700085,
                              0.077289484,
                              0.08015412,
                              0.057682905,
                              0.05394282,
                              0.051983897,
                              0.0674485,
                              0.07769663,
                              0.07406305,
                              0.071187764,
                              0.07937221,
                              0.05738123,
                              0.064613484,
                              0.05523347,
                              0.07331028,
                              0.058609493,
                              0.052782815,
                              0.047911547,
                              0.05082705,
                              0.05345955,
                              0.05932037]},
 'spectra_realpca': {'cosine': [0.99945366,
                                0.99925643,
                                0.99947244,
                                0.99940675,
                                0.9995555,
                                0.99957067,
                                0.99914396,
                                0.9992311,
                                0.9983727,
                                0.9974544,
                                0.99898773,
                                0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349,
                                0.99650675,
                                0.9971242,
                                0.9965543,
                                0.9968424,
                                0.9962396,
                                0.99634945,
                                0.99715966,
                                0.99691385,
                                0.9982245,
                                0.99834263,
                                0.9988524],
                     'mae': [0.011083274,
                             0.014802759,
                             0.015157819,
                             0.015070052,
                             0.015472084,
                             0.015633475,
                             0.014836307,
                             0.01447966,
                             0.013651306,
                             0.013377094,
                             0.014316244,
                             0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197,
                             0.012154227,
                             0.011967489,
                             0.012771271,
                             0.012152725,
                             0.013049042,
                             0.0125535,
                             0.013193458,
                             0.0130807385,
                             0.013555716,
                             0.013718692,
                             0.014281331],
                     'max_mae': 0.015633475,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.013377094,
                     'min_cosine': 0.9962396,
                     'mse': [0.00019629093,
                             0.00035259564,
                             0.00036871652,
                             0.00035998295,
                             0.00038198216,
                             0.00038844542,
                             0.00034976797,
                             0.00033549307,
                             0.00029904975,
                             0.00028346918,
                             0.00032609524,
                             0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102,
                             0.00023534271,
                             0.00023139741,
                             0.00026069232,
                             0.00023610053,
                             0.0002807898,
                             0.0002510656,
                             0.00027758113,
                             0.00027334486,
                             0.00029565947,
                             0.00030083008,
                             0.0003258427],
                     'rmse': [0.014010387,
                              0.01877753,
                              0.019201992,
                              0.018973216,
                              0.019544363,
                              0.019709019,
                              0.018702084,
                              0.01831647,
                              0.017293055,
                              0.016836543,
                              0.018058106,
                              0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779,
                              0.015340883,
                              0.015211753,
                              0.016145969,
                              0.015365563,
                              0.016756784,
                              0.01584505,
                              0.016660767,
                              0.016533144,
                              0.017194752,
                              0.017344454,
                              0.018051114]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_60.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957
Directory path: experiments/inpainting/gann_4_night_20180723_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_60.0/images
Optimal number of principal components:  5
Reconstruction error:  32.77355
Energy conservation:  0.6106028
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_60.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.075287224842861, 3.494295350259554],
                   'kl_div': 0.20725965,
                   'ks_tests': {10000: KstestResult(statistic=0.1445, pvalue=2.0211401583743056e-91, statistic_location=0.011371842, statistic_sign=1),
                                20000: KstestResult(statistic=0.15510000000000002, pvalue=1.5173167877642902e-210, statistic_location=0.009756961, statistic_sign=1),
                                30000: KstestResult(statistic=0.15149999999999997, pvalue=4.742805914335679e-301, statistic_location=0.010629093, statistic_sign=1),
                                40000: KstestResult(statistic=0.14855000000000007, pvalue=0.0, statistic_location=0.01031798, statistic_sign=1),
                                50000: KstestResult(statistic=0.14966000000000002, pvalue=0.0, statistic_location=0.009433782, statistic_sign=1),
                                60000: KstestResult(statistic=0.14968333333333328, pvalue=0.0, statistic_location=0.009832467, statistic_sign=1),
                                70000: KstestResult(statistic=0.14850000000000008, pvalue=0.0, statistic_location=0.010009756, statistic_sign=1),
                                80000: KstestResult(statistic=0.14987499999999998, pvalue=0.0, statistic_location=0.01057013, statistic_sign=1),
                                90000: KstestResult(statistic=0.15051111111111104, pvalue=0.0, statistic_location=0.0097037535, statistic_sign=1),
                                100000: KstestResult(statistic=0.14837, pvalue=0.0, statistic_location=0.010034034, statistic_sign=1),
                                110000: KstestResult(statistic=0.1486727272727273, pvalue=0.0, statistic_location=0.010059813, statistic_sign=1)},
                   'moments': {'mean_error': 0.07679209,
                               'means': [0.00018858185, 7.728705e-05],
                               'stds': [0.018317485, 0.007978809],
                               'variance_ratio': 4.498165}},
 'originals': {'gan': {'mae': 0.03905734047293663,
                       'mse': 0.0029792464338243008,
                       'psnr': 25.586721420288086,
                       'rmse': 0.05458247289061546,
                       'ssim': 0.6827481985092163},
               'pca': {'mae': 0.01519908756017685,
                       'mse': 0.0003712985198944807,
                       'psnr': 34.673606872558594,
                       'rmse': 0.019269108772277832,
                       'ssim': 0.9058235883712769}},
 'reconstructions': {'mae': 0.03518490493297577,
                     'mse': 0.002643438521772623,
                     'psnr': 26.149147033691406,
                     'rmse': 0.051414381712675095,
                     'ssim': 0.7243396043777466},
 'residual_spectra_pcagan': {'cosine': [0.49368286,
                                        0.3236542,
                                        0.43658173,
                                        0.440995,
                                        0.37675878,
                                        0.44688964,
                                        0.45133126,
                                        0.43498713,
                                        0.41383153,
                                        0.4308964,
                                        0.41722018],
                             'mae': [0.009990926,
                                     0.011266594,
                                     0.010982788,
                                     0.009655018,
                                     0.010873054,
                                     0.010450936,
                                     0.010329908,
                                     0.0114169605,
                                     0.011445685,
                                     0.010226988,
                                     0.011072751],
                             'max_mae': 0.011445685,
                             'max_mse': 0.00041748735,
                             'max_rmse': 0.020432508,
                             'median_distance': 1.6076115,
                             'median_mae': 0.010873054,
                             'min_cosine': 0.3236542,
                             'mse': [0.00020755167,
                                     0.00041748735,
                                     0.00025757946,
                                     0.000218238,
                                     0.0003517288,
                                     0.00022575016,
                                     0.00024363447,
                                     0.0002719,
                                     0.0003049143,
                                     0.00025844146,
                                     0.0002846954],
                             'rmse': [0.014406654,
                                      0.020432508,
                                      0.016049283,
                                      0.014772881,
                                      0.018754434,
                                      0.015024984,
                                      0.015608794,
                                      0.01648939,
                                      0.017461795,
                                      0.016076114,
                                      0.016872918]},
 'residuals': {'mae': 0.010701056569814682,
               'mse': 0.0002765382523648441,
               'psnr': 17.58490562438965,
               'rmse': 0.01662943884730339,
               'ssds': [36.911907, 7.003346],
               'ssim': 0.3621736168861389},
 'spectra_pcagan': {'cosine': [0.76267606,
                               0.97638285,
                               0.97864926,
                               0.9837884,
                               0.97934526,
                               0.97733015,
                               0.98172045,
                               0.9822078,
                               0.98804337,
                               0.9937786,
                               0.99106735],
                    'mae': [0.12570854,
                            0.032955464,
                            0.028297797,
                            0.023369227,
                            0.026067156,
                            0.027983611,
                            0.026377069,
                            0.027413025,
                            0.025046919,
                            0.020584395,
                            0.023230782],
                    'max_mae': 0.12570854,
                    'max_mse': 0.017202737,
                    'max_rmse': 0.1311592,
                    'median_mae': 0.026377069,
                    'min_cosine': 0.76267606,
                    'mse': [0.017202737,
                            0.0018881336,
                            0.001281133,
                            0.0009494257,
                            0.0012546261,
                            0.0012847646,
                            0.0011397948,
                            0.0012803064,
                            0.0010837463,
                            0.00075381756,
                            0.0009593379],
                    'rmse': [0.1311592,
                             0.043452658,
                             0.035792917,
                             0.030812752,
                             0.0354207,
                             0.035843614,
                             0.03376085,
                             0.03578137,
                             0.0329203,
                             0.027455738,
                             0.030973181]},
 'spectra_realgan': {'cosine': [0.76188564,
                                0.97071826,
                                0.971902,
                                0.97795904,
                                0.9730551,
                                0.97143304,
                                0.97600776,
                                0.97721267,
                                0.9843514,
                                0.9911968,
                                0.98832476],
                     'mae': [0.12476117,
                             0.037231646,
                             0.032832026,
                             0.028140826,
                             0.03084126,
                             0.03195916,
                             0.03046064,
                             0.031191163,
                             0.029400006,
                             0.025324542,
                             0.027488293],
                     'max_mae': 0.12476117,
                     'max_mse': 0.017297471,
                     'max_rmse': 0.13151985,
                     'median_mae': 0.03084126,
                     'min_cosine': 0.76188564,
                     'mse': [0.017297471,
                             0.0023251248,
                             0.0016992519,
                             0.0013069871,
                             0.0016366037,
                             0.001633521,
                             0.0015070699,
                             0.0016224518,
                             0.0014286785,
                             0.001061996,
                             0.0012525538],
                     'rmse': [0.13151985,
                              0.048219547,
                              0.041221984,
                              0.036152277,
                              0.040454958,
                              0.04041684,
                              0.038820997,
                              0.04027967,
                              0.037797865,
                              0.03258828,
                              0.035391435]},
 'spectra_realpca': {'cosine': [0.9941643,
                                0.9941867,
                                0.9936245,
                                0.9935855,
                                0.9932237,
                                0.9932238,
                                0.99417686,
                                0.99472755,
                                0.99618304,
                                0.99730253,
                                0.99689317],
                     'mae': [0.015280661,
                             0.016014019,
                             0.015565975,
                             0.015470868,
                             0.015882194,
                             0.015648434,
                             0.015161934,
                             0.0148358885,
                             0.01468641,
                             0.014292272,
                             0.014351315],
                     'max_mae': 0.016014019,
                     'max_mse': 0.00041075278,
                     'max_rmse': 0.020267038,
                     'median_mae': 0.015280661,
                     'min_cosine': 0.9932237,
                     'mse': [0.00038239628,
                             0.00041075278,
                             0.00038849874,
                             0.0003834206,
                             0.0004011716,
                             0.00039177405,
                             0.00036869236,
                             0.0003549778,
                             0.00034618776,
                             0.00032701122,
                             0.0003294009],
                     'rmse': [0.019554956,
                              0.020267038,
                              0.019710371,
                              0.01958113,
                              0.02002927,
                              0.019793283,
                              0.019201364,
                              0.018840855,
                              0.018606123,
                              0.018083451,
                              0.018149406]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_60.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431
Directory path: experiments/inpainting/gann_4_night_20180723_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_60.0/images
Optimal number of principal components:  5
Reconstruction error:  32.77355
Energy conservation:  0.6106028
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_60.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.070708789508587, 3.5032410455016163],
                   'kl_div': 0.19369331,
                   'ks_tests': {10000: KstestResult(statistic=0.1589, pvalue=1.5292497441698822e-110, statistic_location=0.008906631, statistic_sign=1),
                                20000: KstestResult(statistic=0.15595000000000003, pvalue=7.231297306856542e-213, statistic_location=0.008829004, statistic_sign=1),
                                30000: KstestResult(statistic=0.15289999999999992, pvalue=1.1616868544052576e-306, statistic_location=0.009720999, statistic_sign=1),
                                40000: KstestResult(statistic=0.15175000000000005, pvalue=0.0, statistic_location=0.009638455, statistic_sign=1),
                                50000: KstestResult(statistic=0.15234000000000003, pvalue=0.0, statistic_location=0.009761726, statistic_sign=1),
                                60000: KstestResult(statistic=0.1519666666666667, pvalue=0.0, statistic_location=0.009765211, statistic_sign=1),
                                70000: KstestResult(statistic=0.1544428571428571, pvalue=0.0, statistic_location=0.010553407, statistic_sign=1),
                                80000: KstestResult(statistic=0.1510125, pvalue=0.0, statistic_location=0.010111328, statistic_sign=1),
                                90000: KstestResult(statistic=0.15332222222222225, pvalue=0.0, statistic_location=0.009855641, statistic_sign=1),
                                100000: KstestResult(statistic=0.15073000000000003, pvalue=0.0, statistic_location=0.0100839175, statistic_sign=1),
                                110000: KstestResult(statistic=0.1521, pvalue=0.0, statistic_location=0.009730211, statistic_sign=1),
                                120000: KstestResult(statistic=0.15079166666666666, pvalue=0.0, statistic_location=0.009729188, statistic_sign=1),
                                130000: KstestResult(statistic=0.15106923076923084, pvalue=0.0, statistic_location=0.009671911, statistic_sign=1),
                                140000: KstestResult(statistic=0.15216428571428575, pvalue=0.0, statistic_location=0.009088332, statistic_sign=1),
                                150000: KstestResult(statistic=0.1508733333333333, pvalue=0.0, statistic_location=0.009722185, statistic_sign=1),
                                160000: KstestResult(statistic=0.152625, pvalue=0.0, statistic_location=0.009692723, statistic_sign=1),
                                170000: KstestResult(statistic=0.15132941176470593, pvalue=0.0, statistic_location=0.009619122, statistic_sign=1),
                                180000: KstestResult(statistic=0.15227777777777785, pvalue=0.0, statistic_location=0.009290956, statistic_sign=1),
                                190000: KstestResult(statistic=0.15113684210526324, pvalue=0.0, statistic_location=0.009645028, statistic_sign=1),
                                200000: KstestResult(statistic=0.15163000000000004, pvalue=0.0, statistic_location=0.009101083, statistic_sign=1),
                                210000: KstestResult(statistic=0.1508857142857143, pvalue=0.0, statistic_location=0.010646374, statistic_sign=1),
                                220000: KstestResult(statistic=0.1501818181818182, pvalue=0.0, statistic_location=0.01063478, statistic_sign=1)},
                   'moments': {'mean_error': 0.16408679,
                               'means': [0.0011001013, 9.3498595e-05],
                               'stds': [0.017806092, 0.008057476],
                               'variance_ratio': 4.2196736}},
 'originals': {'gan': {'mae': 0.03806459158658981,
                       'mse': 0.0028069273103028536,
                       'psnr': 27.170915603637695,
                       'rmse': 0.052980441600084305,
                       'ssim': 0.6385642886161804},
               'pca': {'mae': 0.015096808783710003,
                       'mse': 0.00036788545548915863,
                       'psnr': 36.054752349853516,
                       'rmse': 0.019180340692400932,
                       'ssim': 0.9283577799797058}},
 'reconstructions': {'mae': 0.033920787274837494,
                     'mse': 0.0024532342795282602,
                     'psnr': 27.814491271972656,
                     'rmse': 0.04953013360500336,
                     'ssim': 0.6693164706230164},
 'residual_spectra_pcagan': {'cosine': [0.5082187,
                                        0.3945353,
                                        0.3375061,
                                        0.43298924,
                                        0.40535676,
                                        0.40825805,
                                        0.42272332,
                                        0.50358194,
                                        0.491126,
                                        0.45875114,
                                        0.4377151,
                                        0.47200334,
                                        0.4762704,
                                        0.49328515,
                                        0.4628521,
                                        0.42275208,
                                        0.4488505,
                                        0.44421452,
                                        0.46429756,
                                        0.50660104,
                                        0.35696286,
                                        0.51786757],
                             'mae': [0.008517216,
                                     0.009437251,
                                     0.010673241,
                                     0.009665242,
                                     0.010633653,
                                     0.011282485,
                                     0.009794875,
                                     0.008697197,
                                     0.00930523,
                                     0.010072266,
                                     0.011187172,
                                     0.010670446,
                                     0.010496457,
                                     0.010301751,
                                     0.010343028,
                                     0.010976063,
                                     0.010992447,
                                     0.012443728,
                                     0.011379566,
                                     0.010514165,
                                     0.011294403,
                                     0.0094902795],
                             'max_mae': 0.012443728,
                             'max_mse': 0.00042683334,
                             'max_rmse': 0.020659946,
                             'median_distance': 1.5611564,
                             'median_mae': 0.010505311,
                             'min_cosine': 0.3375061,
                             'mse': [0.00016289155,
                                     0.00026160394,
                                     0.0003826615,
                                     0.00020432341,
                                     0.0002758917,
                                     0.00033123125,
                                     0.00023901835,
                                     0.00017324733,
                                     0.00017500597,
                                     0.0002144314,
                                     0.00026677304,
                                     0.00023044007,
                                     0.00021115947,
                                     0.00022524323,
                                     0.000264055,
                                     0.00030650428,
                                     0.00024846935,
                                     0.00030896458,
                                     0.000291738,
                                     0.0002238929,
                                     0.00042683334,
                                     0.00020042296],
                             'rmse': [0.012762898,
                                      0.016174175,
                                      0.019561736,
                                      0.0142941745,
                                      0.01660999,
                                      0.01819976,
                                      0.015460218,
                                      0.013162346,
                                      0.013228983,
                                      0.014643476,
                                      0.016333189,
                                      0.0151802525,
                                      0.014531327,
                                      0.015008106,
                                      0.01624977,
                                      0.017507264,
                                      0.01576291,
                                      0.017577387,
                                      0.017080339,
                                      0.014963051,
                                      0.020659946,
                                      0.014157082]},
 'residuals': {'mae': 0.010371279902756214,
               'mse': 0.00025567287229932845,
               'psnr': 19.049884796142578,
               'rmse': 0.015989774838089943,
               'ssds': [70.01845, 14.2849],
               'ssim': 0.4113892614841461},
 'spectra_pcagan': {'cosine': [0.9887745,
                               0.9901674,
                               0.97788745,
                               0.9893108,
                               0.9810103,
                               0.78150284,
                               0.9810772,
                               0.9854287,
                               0.9832125,
                               0.98150665,
                               0.9734335,
                               0.9832914,
                               0.98330796,
                               0.9903545,
                               0.9926823,
                               0.9912434,
                               0.9929388,
                               0.99352777,
                               0.9949848,
                               0.94701666,
                               0.99394745,
                               0.99656016],
                    'mae': [0.026073629,
                            0.027372034,
                            0.027230222,
                            0.027688885,
                            0.029257147,
                            0.12403766,
                            0.027355835,
                            0.022199964,
                            0.024046017,
                            0.025129553,
                            0.032147113,
                            0.027343903,
                            0.027692838,
                            0.022510778,
                            0.021921802,
                            0.028431103,
                            0.022888707,
                            0.023927,
                            0.023807192,
                            0.11333913,
                            0.021408033,
                            0.0204488],
                    'max_mae': 0.12403766,
                    'max_mse': 0.01713986,
                    'max_rmse': 0.1309193,
                    'median_mae': 0.026651926,
                    'min_cosine': 0.78150284,
                    'mse': [0.0011368485,
                            0.0014802424,
                            0.0014060258,
                            0.0013255413,
                            0.0014418646,
                            0.01713986,
                            0.001342347,
                            0.000873805,
                            0.0010109016,
                            0.0010742242,
                            0.001704873,
                            0.0012087075,
                            0.0012449356,
                            0.00087750703,
                            0.00090473297,
                            0.0013377506,
                            0.00088259584,
                            0.0009895734,
                            0.0010505642,
                            0.013893797,
                            0.0009588853,
                            0.0006855716],
                    'rmse': [0.033717185,
                             0.03847392,
                             0.03749701,
                             0.036407985,
                             0.03797189,
                             0.1309193,
                             0.036638055,
                             0.029560193,
                             0.03179468,
                             0.03277536,
                             0.041290108,
                             0.03476647,
                             0.035283644,
                             0.029622745,
                             0.03007878,
                             0.036575273,
                             0.029708514,
                             0.031457487,
                             0.03241241,
                             0.117871955,
                             0.030965874,
                             0.026183423]},
 'spectra_realgan': {'cosine': [0.98425245,
                                0.9872377,
                                0.97187257,
                                0.9860072,
                                0.97522396,
                                0.78060704,
                                0.9755515,
                                0.9792978,
                                0.9770905,
                                0.9751758,
                                0.9668799,
                                0.9774912,
                                0.97855467,
                                0.9863428,
                                0.9898247,
                                0.98815864,
                                0.99051064,
                                0.99137056,
                                0.9933055,
                                0.94512886,
                                0.9923266,
                                0.99504304],
                     'mae': [0.031431112,
                             0.033338178,
                             0.032211658,
                             0.032814104,
                             0.03416449,
                             0.12313267,
                             0.032392796,
                             0.027336868,
                             0.02881745,
                             0.030058295,
                             0.03587649,
                             0.031572904,
                             0.031062737,
                             0.027454684,
                             0.02666175,
                             0.031898417,
                             0.027123092,
                             0.02844352,
                             0.028417712,
                             0.113265514,
                             0.025883485,
                             0.02406298],
                     'max_mae': 0.12313267,
                     'max_mse': 0.017230596,
                     'max_rmse': 0.13126537,
                     'median_mae': 0.031246925,
                     'min_cosine': 0.78060704,
                     'mse': [0.001614797,
                             0.001964032,
                             0.001806831,
                             0.0017637821,
                             0.0018770584,
                             0.017230596,
                             0.0017555865,
                             0.0012531235,
                             0.0013834058,
                             0.0014567492,
                             0.0020954213,
                             0.0015838945,
                             0.0015694972,
                             0.0012449645,
                             0.0012398313,
                             0.0016630024,
                             0.0011860367,
                             0.001319195,
                             0.0013778902,
                             0.014183878,
                             0.0012397391,
                             0.0009430994],
                     'rmse': [0.04018454,
                              0.044317402,
                              0.042506836,
                              0.041997407,
                              0.043325033,
                              0.13126537,
                              0.04189972,
                              0.035399485,
                              0.037194163,
                              0.038167384,
                              0.04577577,
                              0.03979817,
                              0.03961688,
                              0.035284054,
                              0.03521124,
                              0.040779926,
                              0.034438886,
                              0.036320724,
                              0.037119944,
                              0.119096085,
                              0.035209928,
                              0.030709922]},
 'spectra_realpca': {'cosine': [0.9957083,
                                0.9968597,
                                0.99377286,
                                0.99648964,
                                0.9943605,
                                0.9941643,
                                0.9941867,
                                0.9936245,
                                0.9935855,
                                0.9932237,
                                0.9932238,
                                0.99417686,
                                0.99472755,
                                0.99618304,
                                0.99730253,
                                0.99689317,
                                0.99738353,
                                0.9979902,
                                0.9983783,
                                0.9982491,
                                0.99803716,
                                0.998379],
                     'mae': [0.016433794,
                             0.017166572,
                             0.015815191,
                             0.016594898,
                             0.016093496,
                             0.015280661,
                             0.016014019,
                             0.015565975,
                             0.015470868,
                             0.015882194,
                             0.015648434,
                             0.015161934,
                             0.0148358885,
                             0.01468641,
                             0.014292272,
                             0.014351315,
                             0.014201348,
                             0.01379758,
                             0.013815325,
                             0.013635745,
                             0.013886007,
                             0.013499838],
                     'max_mae': 0.017166572,
                     'max_mse': 0.00047297002,
                     'max_rmse': 0.021747874,
                     'median_mae': 0.015221298,
                     'min_cosine': 0.9932237,
                     'mse': [0.00043103725,
                             0.00047297002,
                             0.00039731164,
                             0.00043845334,
                             0.00041755877,
                             0.00038239628,
                             0.00041075278,
                             0.00038849874,
                             0.0003834206,
                             0.0004011716,
                             0.00039177405,
                             0.00036869236,
                             0.0003549778,
                             0.00034618776,
                             0.00032701122,
                             0.0003294009,
                             0.00032657973,
                             0.00030830447,
                             0.00030426402,
                             0.0003102971,
                             0.00030928926,
                             0.00029312982],
                     'rmse': [0.020761436,
                              0.021747874,
                              0.019932678,
                              0.020939277,
                              0.020434255,
                              0.019554956,
                              0.020267038,
                              0.019710371,
                              0.01958113,
                              0.02002927,
                              0.019793283,
                              0.019201364,
                              0.018840855,
                              0.018606123,
                              0.018083451,
                              0.018149406,
                              0.018071517,
                              0.0175586,
                              0.017443165,
                              0.017615251,
                              0.017586622,
                              0.017121034]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_60.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707
Directory path: experiments/inpainting/gann_4_night_20180723_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_60.0/images
Optimal number of principal components:  5
Reconstruction error:  32.77355
Energy conservation:  0.6106028
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_60.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.060522481510419, 3.496568139198882],
                   'kl_div': 0.18739189,
                   'ks_tests': {10000: KstestResult(statistic=0.1389, pvalue=1.7554371023281302e-84, statistic_location=0.009269632, statistic_sign=1),
                                20000: KstestResult(statistic=0.1301, pvalue=4.908745921077266e-148, statistic_location=0.010319108, statistic_sign=1),
                                30000: KstestResult(statistic=0.12786666666666668, pvalue=2.9259742126782795e-214, statistic_location=0.010432418, statistic_sign=1),
                                40000: KstestResult(statistic=0.1291500000000001, pvalue=2.6702513654423657e-291, statistic_location=0.010694457, statistic_sign=1),
                                50000: KstestResult(statistic=0.12854, pvalue=0.0, statistic_location=0.010034034, statistic_sign=1),
                                60000: KstestResult(statistic=0.127, pvalue=0.0, statistic_location=0.010017716, statistic_sign=1),
                                70000: KstestResult(statistic=0.1306857142857143, pvalue=0.0, statistic_location=0.010459387, statistic_sign=1),
                                80000: KstestResult(statistic=0.1307625, pvalue=0.0, statistic_location=0.010696184, statistic_sign=1),
                                90000: KstestResult(statistic=0.12980000000000003, pvalue=0.0, statistic_location=0.010694786, statistic_sign=1),
                                100000: KstestResult(statistic=0.12861, pvalue=0.0, statistic_location=0.010526632, statistic_sign=1),
                                110000: KstestResult(statistic=0.13041818181818188, pvalue=0.0, statistic_location=0.009212288, statistic_sign=1),
                                120000: KstestResult(statistic=0.1303416666666667, pvalue=0.0, statistic_location=0.010424839, statistic_sign=1),
                                130000: KstestResult(statistic=0.12708461538461546, pvalue=0.0, statistic_location=0.01067962, statistic_sign=1),
                                140000: KstestResult(statistic=0.12811428571428574, pvalue=0.0, statistic_location=0.010386255, statistic_sign=1),
                                150000: KstestResult(statistic=0.1294266666666667, pvalue=0.0, statistic_location=0.0101103885, statistic_sign=1),
                                160000: KstestResult(statistic=0.12927500000000003, pvalue=0.0, statistic_location=0.010329936, statistic_sign=1),
                                170000: KstestResult(statistic=0.13037647058823532, pvalue=0.0, statistic_location=0.00967395, statistic_sign=1),
                                180000: KstestResult(statistic=0.12880555555555562, pvalue=0.0, statistic_location=0.010604131, statistic_sign=1),
                                190000: KstestResult(statistic=0.13055263157894748, pvalue=0.0, statistic_location=0.009673231, statistic_sign=1),
                                200000: KstestResult(statistic=0.128915, pvalue=0.0, statistic_location=0.010149075, statistic_sign=1),
                                210000: KstestResult(statistic=0.12903333333333333, pvalue=0.0, statistic_location=0.010015721, statistic_sign=1),
                                220000: KstestResult(statistic=0.1283727272727273, pvalue=0.0, statistic_location=0.010419317, statistic_sign=1),
                                230000: KstestResult(statistic=0.12721739130434784, pvalue=0.0, statistic_location=0.010650493, statistic_sign=1),
                                240000: KstestResult(statistic=0.12890000000000001, pvalue=0.0, statistic_location=0.010525863, statistic_sign=1),
                                250000: KstestResult(statistic=0.12885200000000008, pvalue=0.0, statistic_location=0.010478854, statistic_sign=1),
                                260000: KstestResult(statistic=0.12947307692307686, pvalue=0.0, statistic_location=0.010635635, statistic_sign=1),
                                270000: KstestResult(statistic=0.12834444444444437, pvalue=0.0, statistic_location=0.010637719, statistic_sign=1),
                                280000: KstestResult(statistic=0.12860000000000005, pvalue=0.0, statistic_location=0.010647763, statistic_sign=1),
                                290000: KstestResult(statistic=0.12972758620689662, pvalue=0.0, statistic_location=0.010325257, statistic_sign=1),
                                300000: KstestResult(statistic=0.12767666666666677, pvalue=0.0, statistic_location=0.010621016, statistic_sign=1),
                                310000: KstestResult(statistic=0.1274354838709677, pvalue=0.0, statistic_location=0.010609573, statistic_sign=1),
                                320000: KstestResult(statistic=0.1291343749999999, pvalue=0.0, statistic_location=0.009793985, statistic_sign=1),
                                330000: KstestResult(statistic=0.1273545454545455, pvalue=0.0, statistic_location=0.010699684, statistic_sign=1)},
                   'moments': {'mean_error': 0.030994305,
                               'means': [4.6829733e-05, 3.45599e-05],
                               'stds': [0.017160652, 0.008002682],
                               'variance_ratio': 4.078099}},
 'originals': {'gan': {'mae': 0.036322202533483505,
                       'mse': 0.002500465838238597,
                       'psnr': 28.304943084716797,
                       'rmse': 0.05000465735793114,
                       'ssim': 0.6518945097923279},
               'pca': {'mae': 0.015189113095402718,
                       'mse': 0.0003724981506820768,
                       'psnr': 36.79143524169922,
                       'rmse': 0.01930021122097969,
                       'ssim': 0.9375227093696594}},
 'reconstructions': {'mae': 0.032175708562135696,
                     'mse': 0.002143618417903781,
                     'psnr': 29.191204071044922,
                     'rmse': 0.046299226582050323,
                     'ssim': 0.6719516515731812},
 'residual_spectra_pcagan': {'cosine': [0.46187362,
                                        0.42902613,
                                        0.4500865,
                                        0.37309593,
                                        0.4783972,
                                        0.35890397,
                                        0.39706066,
                                        0.36169705,
                                        0.4212186,
                                        0.42005292,
                                        0.38215256,
                                        0.5047562,
                                        0.35280305,
                                        0.46751982,
                                        0.47981745,
                                        0.4237302,
                                        0.48385468,
                                        0.49300212,
                                        0.45676577,
                                        0.45122313,
                                        0.4759545,
                                        0.43443888,
                                        0.45202672,
                                        0.45036986,
                                        0.47259834,
                                        0.5235424,
                                        0.46975005,
                                        0.45724717,
                                        0.5125814,
                                        0.5234447,
                                        0.5363252,
                                        0.5262549,
                                        0.43669263],
                             'mae': [0.009209139,
                                     0.009793863,
                                     0.009016242,
                                     0.010061003,
                                     0.008963674,
                                     0.010201598,
                                     0.009775223,
                                     0.010339572,
                                     0.009622915,
                                     0.010014173,
                                     0.010680726,
                                     0.009784311,
                                     0.010914517,
                                     0.010416023,
                                     0.0091494005,
                                     0.01024684,
                                     0.009828273,
                                     0.009769292,
                                     0.01073239,
                                     0.010939206,
                                     0.009718068,
                                     0.010750952,
                                     0.010093644,
                                     0.011800966,
                                     0.010985362,
                                     0.00990503,
                                     0.011558212,
                                     0.011428591,
                                     0.009400256,
                                     0.009522761,
                                     0.008780803,
                                     0.009175074,
                                     0.010721322],
                             'max_mae': 0.011800966,
                             'max_mse': 0.00034495944,
                             'max_rmse': 0.018573083,
                             'median_distance': 1.5448742,
                             'median_mae': 0.010014173,
                             'min_cosine': 0.35280305,
                             'mse': [0.00018691341,
                                     0.00022672453,
                                     0.00019119904,
                                     0.00030662233,
                                     0.00017475772,
                                     0.0003008377,
                                     0.00024964398,
                                     0.00029530504,
                                     0.00023866362,
                                     0.00021643209,
                                     0.0002977585,
                                     0.0002050222,
                                     0.00034495944,
                                     0.00021736426,
                                     0.00018000434,
                                     0.00027045194,
                                     0.0001876833,
                                     0.00019830522,
                                     0.00024476898,
                                     0.0002537551,
                                     0.00020877318,
                                     0.00026611573,
                                     0.00025296854,
                                     0.00027571496,
                                     0.00024352194,
                                     0.00019408001,
                                     0.0002619141,
                                     0.000275775,
                                     0.00018592215,
                                     0.00018250756,
                                     0.00017159714,
                                     0.00018286616,
                                     0.00026877088],
                             'rmse': [0.013671628,
                                      0.015057375,
                                      0.013827474,
                                      0.017510634,
                                      0.013219596,
                                      0.017344674,
                                      0.015800126,
                                      0.017184442,
                                      0.015448742,
                                      0.014711631,
                                      0.01725568,
                                      0.014318597,
                                      0.018573083,
                                      0.014743279,
                                      0.01341657,
                                      0.016445423,
                                      0.013699755,
                                      0.014082089,
                                      0.015645094,
                                      0.015929693,
                                      0.014448985,
                                      0.016313054,
                                      0.015904985,
                                      0.016604668,
                                      0.01560519,
                                      0.01393126,
                                      0.01618376,
                                      0.016606474,
                                      0.013635327,
                                      0.013509536,
                                      0.013099509,
                                      0.013522802,
                                      0.016394233]},
 'residuals': {'mae': 0.010099982842803001,
               'mse': 0.00023508181038778275,
               'psnr': 19.775279998779297,
               'rmse': 0.015332377515733242,
               'ssds': [97.18146, 21.134491],
               'ssim': 0.4102412462234497},
 'spectra_pcagan': {'cosine': [0.98913074,
                               0.98671764,
                               0.98952097,
                               0.988836,
                               0.988187,
                               0.99206036,
                               0.98589516,
                               0.98816586,
                               0.9773332,
                               0.9874256,
                               0.9758994,
                               0.76285064,
                               0.9765784,
                               0.9784161,
                               0.9837208,
                               0.97911304,
                               0.9770739,
                               0.9821525,
                               0.9824114,
                               0.9879061,
                               0.9934184,
                               0.9912069,
                               0.9938243,
                               0.99335676,
                               0.995305,
                               0.93927884,
                               0.9935226,
                               0.99384165,
                               0.9966682,
                               0.9953796,
                               0.9939341,
                               0.99532086,
                               0.9951444],
                    'mae': [0.025340479,
                            0.02556629,
                            0.024600137,
                            0.026016021,
                            0.03305639,
                            0.035028942,
                            0.028338434,
                            0.030492993,
                            0.02927772,
                            0.03253996,
                            0.032273345,
                            0.12589484,
                            0.032880135,
                            0.028487632,
                            0.023408571,
                            0.026286496,
                            0.028113037,
                            0.0260409,
                            0.027312903,
                            0.025230967,
                            0.021147659,
                            0.023213848,
                            0.025132224,
                            0.025623556,
                            0.023616467,
                            0.11894501,
                            0.024750067,
                            0.028818905,
                            0.018523743,
                            0.021022057,
                            0.024126234,
                            0.019830411,
                            0.02086189],
                    'max_mae': 0.12589484,
                    'max_mse': 0.017262127,
                    'max_rmse': 0.13138542,
                    'median_mae': 0.026016021,
                    'min_cosine': 0.76285064,
                    'mse': [0.001177796,
                            0.0012198099,
                            0.0011094077,
                            0.0013459972,
                            0.0017011653,
                            0.002312916,
                            0.0014165784,
                            0.0018107302,
                            0.0014339157,
                            0.00177374,
                            0.0017674199,
                            0.017262127,
                            0.0018699372,
                            0.0012951291,
                            0.00095327816,
                            0.0012649791,
                            0.0012990492,
                            0.0011125829,
                            0.001265166,
                            0.001097185,
                            0.00079630053,
                            0.00094514684,
                            0.0011267342,
                            0.0010719788,
                            0.0010240687,
                            0.015201868,
                            0.0010108162,
                            0.0012955656,
                            0.00059653237,
                            0.00074706605,
                            0.0009573021,
                            0.0006681311,
                            0.0008089786],
                    'rmse': [0.034319032,
                             0.034925777,
                             0.033307772,
                             0.036687836,
                             0.041245185,
                             0.048092786,
                             0.03763746,
                             0.042552676,
                             0.03786708,
                             0.042115793,
                             0.042040695,
                             0.13138542,
                             0.04324277,
                             0.035987902,
                             0.030875202,
                             0.035566546,
                             0.036042325,
                             0.033355404,
                             0.035569172,
                             0.033123784,
                             0.028218798,
                             0.030743241,
                             0.033566862,
                             0.03274109,
                             0.032001074,
                             0.12329585,
                             0.031793337,
                             0.035993967,
                             0.024424013,
                             0.027332509,
                             0.0309403,
                             0.025848232,
                             0.02844255]},
 'spectra_realgan': {'cosine': [0.9853801,
                                0.98260486,
                                0.9856658,
                                0.9851534,
                                0.98435795,
                                0.9903257,
                                0.98183566,
                                0.9853072,
                                0.9705378,
                                0.98415285,
                                0.9703768,
                                0.7620515,
                                0.97090787,
                                0.97170603,
                                0.9779498,
                                0.97281235,
                                0.9711981,
                                0.97636926,
                                0.9773677,
                                0.98416746,
                                0.990856,
                                0.9884782,
                                0.99134684,
                                0.99134517,
                                0.99380434,
                                0.9377188,
                                0.9917423,
                                0.9926314,
                                0.99519426,
                                0.9934952,
                                0.99132127,
                                0.99307394,
                                0.99355835],
                     'mae': [0.030521436,
                             0.030781573,
                             0.030050058,
                             0.0313455,
                             0.037721496,
                             0.040082872,
                             0.033129472,
                             0.035882294,
                             0.034236714,
                             0.037169736,
                             0.03670415,
                             0.1249457,
                             0.037187655,
                             0.03297918,
                             0.028159292,
                             0.031034686,
                             0.032041695,
                             0.030231293,
                             0.031096552,
                             0.02961534,
                             0.025737572,
                             0.027446441,
                             0.028586907,
                             0.029352127,
                             0.027907282,
                             0.11883938,
                             0.02839422,
                             0.030427177,
                             0.02314611,
                             0.025675533,
                             0.028430386,
                             0.02468184,
                             0.025090989],
                     'max_mae': 0.1249457,
                     'max_mse': 0.017357046,
                     'max_rmse': 0.13174614,
                     'median_mae': 0.030521436,
                     'min_cosine': 0.7620515,
                     'mse': [0.0015790809,
                             0.00161684,
                             0.0015257616,
                             0.0017757673,
                             0.0022189564,
                             0.0028370884,
                             0.0018536053,
                             0.0022971893,
                             0.0018817527,
                             0.0022351115,
                             0.0021909515,
                             0.017357046,
                             0.0023069824,
                             0.0017111269,
                             0.0013075299,
                             0.0016476177,
                             0.0016467152,
                             0.0014840721,
                             0.0016106201,
                             0.0014463816,
                             0.0011026983,
                             0.0012368043,
                             0.0014103809,
                             0.0013864652,
                             0.0013190244,
                             0.015450252,
                             0.0012941194,
                             0.0014859425,
                             0.0008773021,
                             0.0010606074,
                             0.0012992666,
                             0.0009883118,
                             0.0010739969],
                     'rmse': [0.039737653,
                              0.04020995,
                              0.039061,
                              0.042139854,
                              0.0471058,
                              0.053264327,
                              0.043053515,
                              0.047929004,
                              0.043379173,
                              0.047276966,
                              0.046807602,
                              0.13174614,
                              0.04803106,
                              0.04136577,
                              0.036159784,
                              0.040590856,
                              0.04057974,
                              0.038523655,
                              0.04013253,
                              0.038031325,
                              0.033206902,
                              0.035168227,
                              0.03755504,
                              0.037235267,
                              0.036318377,
                              0.12429904,
                              0.03597387,
                              0.038547926,
                              0.029619286,
                              0.03256697,
                              0.03604534,
                              0.031437427,
                              0.032771893]},
 'spectra_realpca': {'cosine': [0.99594957,
                                0.99557203,
                                0.9958976,
                                0.9961867,
                                0.9962845,
                                0.9981062,
                                0.9957083,
                                0.9968597,
                                0.99377286,
                                0.99648964,
                                0.9943605,
                                0.9941643,
                                0.9941867,
                                0.9936245,
                                0.9935855,
                                0.9932237,
                                0.9932238,
                                0.99417686,
                                0.99472755,
                                0.99618304,
                                0.99730253,
                                0.99689317,
                                0.99738353,
                                0.9979902,
                                0.9983783,
                                0.9982491,
                                0.99803716,
                                0.998379,
                                0.9984553,
                                0.99789995,
                                0.99732834,
                                0.99771655,
                                0.998154],
                     'mae': [0.016254047,
                             0.016030794,
                             0.016614487,
                             0.016657773,
                             0.016537739,
                             0.017533872,
                             0.016433794,
                             0.017166572,
                             0.015815191,
                             0.016594898,
                             0.016093496,
                             0.015280661,
                             0.016014019,
                             0.015565975,
                             0.015470868,
                             0.015882194,
                             0.015648434,
                             0.015161934,
                             0.0148358885,
                             0.01468641,
                             0.014292272,
                             0.014351315,
                             0.014201348,
                             0.01379758,
                             0.013815325,
                             0.013635745,
                             0.013886007,
                             0.013499838,
                             0.013283969,
                             0.0138453245,
                             0.014268411,
                             0.014181171,
                             0.0139032975],
                     'max_mae': 0.017533872,
                     'max_mse': 0.00049052585,
                     'max_rmse': 0.022147818,
                     'median_mae': 0.015280661,
                     'min_cosine': 0.9932237,
                     'mse': [0.00042414074,
                             0.00041115924,
                             0.00043787985,
                             0.00044426435,
                             0.00044050813,
                             0.00049052585,
                             0.00043103725,
                             0.00047297002,
                             0.00039731164,
                             0.00043845334,
                             0.00041755877,
                             0.00038239628,
                             0.00041075278,
                             0.00038849874,
                             0.0003834206,
                             0.0004011716,
                             0.00039177405,
                             0.00036869236,
                             0.0003549778,
                             0.00034618776,
                             0.00032701122,
                             0.0003294009,
                             0.00032657973,
                             0.00030830447,
                             0.00030426402,
                             0.0003102971,
                             0.00030928926,
                             0.00029312982,
                             0.00028481538,
                             0.0003077319,
                             0.00032555198,
                             0.00032386056,
                             0.00030852194],
                     'rmse': [0.020594677,
                              0.020277062,
                              0.02092558,
                              0.021077579,
                              0.020988286,
                              0.022147818,
                              0.020761436,
                              0.021747874,
                              0.019932678,
                              0.020939277,
                              0.020434255,
                              0.019554956,
                              0.020267038,
                              0.019710371,
                              0.01958113,
                              0.02002927,
                              0.019793283,
                              0.019201364,
                              0.018840855,
                              0.018606123,
                              0.018083451,
                              0.018149406,
                              0.018071517,
                              0.0175586,
                              0.017443165,
                              0.017615251,
                              0.017586622,
                              0.017121034,
                              0.016876474,
                              0.01754229,
                              0.01804306,
                              0.017996127,
                              0.017564792]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_60.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529
Directory path: experiments/inpainting/gann_4_night_20180901_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_60.0/images
Optimal number of principal components:  18
Reconstruction error:  13.167044
Energy conservation:  0.60355496
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_60.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.932551248322828, 2.970215241356205],
                   'kl_div': 0.4502928,
                   'ks_tests': {10000: KstestResult(statistic=0.199, pvalue=1.4836950838358545e-173, statistic_location=0.0060204295, statistic_sign=1),
                                20000: KstestResult(statistic=0.19274999999999998, pvalue=0.0, statistic_location=0.0064702444, statistic_sign=1),
                                30000: KstestResult(statistic=0.1948, pvalue=0.0, statistic_location=-0.0050986875, statistic_sign=-1),
                                40000: KstestResult(statistic=0.196475, pvalue=0.0, statistic_location=-0.0053806156, statistic_sign=-1),
                                50000: KstestResult(statistic=0.19821999999999998, pvalue=0.0, statistic_location=-0.0053155217, statistic_sign=-1),
                                60000: KstestResult(statistic=0.1935, pvalue=0.0, statistic_location=-0.0058238395, statistic_sign=-1),
                                70000: KstestResult(statistic=0.1974285714285714, pvalue=0.0, statistic_location=-0.0062501635, statistic_sign=-1),
                                80000: KstestResult(statistic=0.19599999999999995, pvalue=0.0, statistic_location=-0.0060939253, statistic_sign=-1),
                                90000: KstestResult(statistic=0.19658888888888887, pvalue=0.0, statistic_location=-0.0059845857, statistic_sign=-1),
                                100000: KstestResult(statistic=0.19441, pvalue=0.0, statistic_location=-0.0062244516, statistic_sign=-1),
                                110000: KstestResult(statistic=0.19285454545454545, pvalue=0.0, statistic_location=-0.005458762, statistic_sign=-1)},
                   'moments': {'mean_error': 0.1724117,
                               'means': [0.0006159432, -8.381427e-06],
                               'stds': [0.023046242, 0.0049874317],
                               'variance_ratio': 18.331818}},
 'originals': {'gan': {'mae': 0.10246788710355759,
                       'mse': 0.08953791111707687,
                       'psnr': 15.509013175964355,
                       'rmse': 0.29922884702682495,
                       'ssim': 0.8870316743850708},
               'pca': {'mae': 0.006017132196575403,
                       'mse': 7.174047641456127e-05,
                       'psnr': 46.746421813964844,
                       'rmse': 0.008469974622130394,
                       'ssim': 0.9926333427429199}},
 'reconstructions': {'mae': 0.1010473370552063,
                     'mse': 0.089475117623806,
                     'psnr': 15.787041664123535,
                     'rmse': 0.2991239130496979,
                     'ssim': 0.8927311897277832},
 'residual_spectra_pcagan': {'cosine': [0.08774344,
                                        0.29442242,
                                        0.3728048,
                                        0.3764904,
                                        0.18639159,
                                        0.36575615,
                                        0.3894592,
                                        0.31192693,
                                        0.3704135,
                                        0.26723933,
                                        0.028287698],
                             'mae': [0.011372336,
                                     0.010908289,
                                     0.008839937,
                                     0.009912704,
                                     0.010866037,
                                     0.008239637,
                                     0.009036738,
                                     0.00994487,
                                     0.00881632,
                                     0.0095738,
                                     0.025214812],
                             'max_mae': 0.025214812,
                             'max_mse': 0.0031035638,
                             'max_rmse': 0.055709638,
                             'median_distance': 1.493926,
                             'median_mae': 0.009912704,
                             'min_cosine': 0.028287698,
                             'mse': [0.00028110953,
                                     0.00041726252,
                                     0.00021673265,
                                     0.00023954207,
                                     0.00032818655,
                                     0.00018131295,
                                     0.00017427785,
                                     0.00022318149,
                                     0.0002204005,
                                     0.00019901959,
                                     0.0031035638],
                             'rmse': [0.01676632,
                                      0.020427005,
                                      0.0147218425,
                                      0.015477147,
                                      0.01811592,
                                      0.01346525,
                                      0.013201434,
                                      0.01493926,
                                      0.014845892,
                                      0.01410743,
                                      0.055709638]},
 'residuals': {'mae': 0.01115686260163784,
               'mse': 0.0005076899542473257,
               'psnr': 12.22968864440918,
               'rmse': 0.02253197692334652,
               'ssds': [58.465424, 2.7361746],
               'ssim': 0.6360700130462646},
 'spectra_pcagan': {'cosine': [0.9990787,
                               0.9942759,
                               0.99658924,
                               0.9983135,
                               0.99882543,
                               0.99739206,
                               0.9978156,
                               0.9987718,
                               0.99795866,
                               0.99895906,
                               -0.6452218],
                    'mae': [0.015005814,
                            0.020397713,
                            0.017116025,
                            0.016799543,
                            0.014198115,
                            0.013541891,
                            0.014853568,
                            0.014054977,
                            0.013728418,
                            0.01337207,
                            0.9584525],
                    'max_mae': 0.9584525,
                    'max_mse': 0.98018855,
                    'max_rmse': 0.9900447,
                    'median_mae': 0.014853568,
                    'min_cosine': -0.6452218,
                    'mse': [0.00037776376,
                            0.00068012543,
                            0.0004883957,
                            0.00047187653,
                            0.0003537527,
                            0.00034114823,
                            0.00035920052,
                            0.00032684856,
                            0.00034110426,
                            0.000297394,
                            0.98018855],
                    'rmse': [0.019436145,
                             0.026079215,
                             0.022099676,
                             0.02172272,
                             0.018808315,
                             0.018470198,
                             0.018952586,
                             0.018078953,
                             0.018469008,
                             0.017245116,
                             0.9900447]},
 'spectra_realgan': {'cosine': [0.99906915,
                                0.9933958,
                                0.99578017,
                                0.9978164,
                                0.9987539,
                                0.99656457,
                                0.9971878,
                                0.99853414,
                                0.99725324,
                                0.9988347,
                                -0.6451682],
                     'mae': [0.015093413,
                             0.021834007,
                             0.018909004,
                             0.01878682,
                             0.014685913,
                             0.016091838,
                             0.017106565,
                             0.015522933,
                             0.016487284,
                             0.014210428,
                             0.95841867],
                     'max_mae': 0.95841867,
                     'max_mse': 0.98011833,
                     'max_rmse': 0.99000925,
                     'median_mae': 0.016487284,
                     'min_cosine': -0.6451682,
                     'mse': [0.00038180794,
                             0.0007860678,
                             0.00059797306,
                             0.00057443464,
                             0.00037425736,
                             0.00044651533,
                             0.00046026468,
                             0.00038939103,
                             0.0004553615,
                             0.00033263222,
                             0.98011833],
                     'rmse': [0.019539906,
                              0.0280369,
                              0.024453487,
                              0.023967367,
                              0.019345732,
                              0.02113091,
                              0.02145378,
                              0.019732993,
                              0.0213392,
                              0.018238207,
                              0.99000925]},
 'spectra_realpca': {'cosine': [0.99999106,
                                0.9989834,
                                0.99916244,
                                0.99951464,
                                0.9999324,
                                0.99907744,
                                0.99933684,
                                0.9997884,
                                0.9993059,
                                0.99987274,
                                0.9999971],
                     'mae': [0.0014293696,
                             0.008677493,
                             0.008404221,
                             0.007880507,
                             0.003541574,
                             0.008527098,
                             0.008124627,
                             0.005872096,
                             0.0083244415,
                             0.004733289,
                             0.0006737348],
                     'max_mae': 0.008677493,
                     'max_mse': 0.00012101244,
                     'max_rmse': 0.011000565,
                     'median_mae': 0.007880507,
                     'min_cosine': 0.9989834,
                     'mse': [3.3164777e-06,
                             0.00012101244,
                             0.000114064016,
                             9.985087e-05,
                             2.000764e-05,
                             0.00011797217,
                             0.00010669973,
                             5.6555145e-05,
                             0.00011257885,
                             3.6349684e-05,
                             7.381404e-07],
                     'rmse': [0.0018211199,
                              0.011000565,
                              0.010680076,
                              0.009992541,
                              0.00447299,
                              0.010861499,
                              0.010329556,
                              0.0075203157,
                              0.010610318,
                              0.00602907,
                              0.00085915095]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_60.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319
Directory path: experiments/inpainting/gann_4_night_20180901_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_60.0/images
Optimal number of principal components:  18
Reconstruction error:  13.167044
Energy conservation:  0.60355496
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_60.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.940780002103074, 2.948708008325316],
                   'kl_div': 0.46789575,
                   'ks_tests': {10000: KstestResult(statistic=0.2089, pvalue=2.4263939580157533e-191, statistic_location=-0.00638406, statistic_sign=-1),
                                20000: KstestResult(statistic=0.2089, pvalue=0.0, statistic_location=-0.005898336, statistic_sign=-1),
                                30000: KstestResult(statistic=0.20740000000000003, pvalue=0.0, statistic_location=-0.004963859, statistic_sign=-1),
                                40000: KstestResult(statistic=0.20692499999999997, pvalue=0.0, statistic_location=-0.005652178, statistic_sign=-1),
                                50000: KstestResult(statistic=0.20905999999999997, pvalue=0.0, statistic_location=-0.005593978, statistic_sign=-1),
                                60000: KstestResult(statistic=0.20663333333333334, pvalue=0.0, statistic_location=-0.0055482304, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2071714285714286, pvalue=0.0, statistic_location=-0.005549431, statistic_sign=-1),
                                80000: KstestResult(statistic=0.20811250000000003, pvalue=0.0, statistic_location=-0.0059027714, statistic_sign=-1),
                                90000: KstestResult(statistic=0.20570000000000002, pvalue=0.0, statistic_location=-0.0058184694, statistic_sign=-1),
                                100000: KstestResult(statistic=0.20487000000000002, pvalue=0.0, statistic_location=-0.005573104, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2052, pvalue=0.0, statistic_location=-0.0058158226, statistic_sign=-1),
                                120000: KstestResult(statistic=0.20660833333333334, pvalue=0.0, statistic_location=-0.0055744527, statistic_sign=-1),
                                130000: KstestResult(statistic=0.2071769230769231, pvalue=0.0, statistic_location=-0.0058491267, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2051, pvalue=0.0, statistic_location=-0.0055749007, statistic_sign=-1),
                                150000: KstestResult(statistic=0.20828666666666665, pvalue=0.0, statistic_location=-0.0055392077, statistic_sign=-1),
                                160000: KstestResult(statistic=0.20620000000000002, pvalue=0.0, statistic_location=-0.0057013156, statistic_sign=-1),
                                170000: KstestResult(statistic=0.20671764705882353, pvalue=0.0, statistic_location=-0.005819205, statistic_sign=-1),
                                180000: KstestResult(statistic=0.20446111111111115, pvalue=0.0, statistic_location=-0.005573104, statistic_sign=-1),
                                190000: KstestResult(statistic=0.2075157894736842, pvalue=0.0, statistic_location=-0.0055773137, statistic_sign=-1),
                                200000: KstestResult(statistic=0.20407999999999998, pvalue=0.0, statistic_location=-0.0058248127, statistic_sign=-1),
                                210000: KstestResult(statistic=0.2087142857142857, pvalue=0.0, statistic_location=-0.005574979, statistic_sign=-1),
                                220000: KstestResult(statistic=0.20801818181818182, pvalue=0.0, statistic_location=-0.00597577, statistic_sign=-1)},
                   'moments': {'mean_error': 0.006179169,
                               'means': [-0.00023313925, -2.98745e-05],
                               'stds': [0.0203259, 0.004871974],
                               'variance_ratio': 13.589408}},
 'originals': {'gan': {'mae': 0.0791468694806099,
                       'mse': 0.051039062440395355,
                       'psnr': 18.142791748046875,
                       'rmse': 0.2259182631969452,
                       'ssim': 0.575168788433075},
               'pca': {'mae': 0.006678097415715456,
                       'mse': 9.052817767951638e-05,
                       'psnr': 45.88956832885742,
                       'rmse': 0.00951462984085083,
                       'ssim': 0.994966983795166}},
 'reconstructions': {'mae': 0.0779908150434494,
                     'mse': 0.050954464823007584,
                     'psnr': 18.385587692260742,
                     'rmse': 0.22573095560073853,
                     'ssim': 0.5777089595794678},
 'residual_spectra_pcagan': {'cosine': [0.34112173,
                                        0.29695386,
                                        0.2280039,
                                        0.25298953,
                                        0.32247955,
                                        0.090258986,
                                        0.30836323,
                                        0.39635295,
                                        0.39955962,
                                        0.20530799,
                                        0.39314833,
                                        0.39277196,
                                        0.34050447,
                                        0.40980384,
                                        0.29252294,
                                        0.026250176,
                                        0.22148551,
                                        0.040325563,
                                        0.079574846,
                                        0.3914751,
                                        0.31315422,
                                        0.3621531],
                             'mae': [0.009645426,
                                     0.010879177,
                                     0.011279582,
                                     0.011048407,
                                     0.00984317,
                                     0.011162055,
                                     0.01047584,
                                     0.008496579,
                                     0.009453604,
                                     0.010215963,
                                     0.007918896,
                                     0.008946719,
                                     0.009367688,
                                     0.008340021,
                                     0.008985947,
                                     0.025696585,
                                     0.010187599,
                                     0.012843544,
                                     0.011393713,
                                     0.009736839,
                                     0.010573573,
                                     0.008369082],
                             'max_mae': 0.025696585,
                             'max_mse': 0.0032337036,
                             'max_rmse': 0.056865662,
                             'median_distance': 1.5192208,
                             'median_mae': 0.010015384,
                             'min_cosine': 0.026250176,
                             'mse': [0.00021034793,
                                     0.00034383158,
                                     0.00054091285,
                                     0.00033795423,
                                     0.000285587,
                                     0.00026951628,
                                     0.00037319137,
                                     0.00018715452,
                                     0.00020821078,
                                     0.0002653277,
                                     0.00015784988,
                                     0.0001711512,
                                     0.00018782934,
                                     0.00017713911,
                                     0.00016150756,
                                     0.0032337036,
                                     0.00020428128,
                                     0.00033303548,
                                     0.0002522074,
                                     0.00020700989,
                                     0.00028335451,
                                     0.00018116937],
                             'rmse': [0.014503377,
                                      0.018542696,
                                      0.023257533,
                                      0.01838353,
                                      0.01689932,
                                      0.016416952,
                                      0.019318162,
                                      0.013680443,
                                      0.014429511,
                                      0.016288882,
                                      0.012563832,
                                      0.013082477,
                                      0.013705084,
                                      0.013309361,
                                      0.012708562,
                                      0.056865662,
                                      0.0142927,
                                      0.01824926,
                                      0.01588104,
                                      0.014387839,
                                      0.016833138,
                                      0.013459917]},
 'residuals': {'mae': 0.010675455443561077,
               'mse': 0.00038964877603575587,
               'psnr': 19.229000091552734,
               'rmse': 0.01973952353000641,
               'ssds': [90.90281, 5.222121],
               'ssim': 0.6463257074356079},
 'spectra_pcagan': {'cosine': [0.96937144,
                               0.9875007,
                               0.98004526,
                               0.9872897,
                               0.9962396,
                               0.99905926,
                               0.9942149,
                               0.9966132,
                               0.99832225,
                               0.99885666,
                               0.9975169,
                               0.99774724,
                               0.99875826,
                               0.9979648,
                               0.998996,
                               -0.64456826,
                               0.99878013,
                               0.99948484,
                               0.9991691,
                               0.99591076,
                               0.0068280883,
                               0.9896061],
                    'mae': [0.035703354,
                            0.04609609,
                            0.032947987,
                            0.03451149,
                            0.017281149,
                            0.0150287235,
                            0.020480622,
                            0.017015547,
                            0.016736532,
                            0.014046077,
                            0.013347961,
                            0.015138578,
                            0.01411634,
                            0.013800958,
                            0.013186516,
                            0.95871663,
                            0.015176565,
                            0.014378445,
                            0.01487421,
                            0.02024262,
                            0.34474534,
                            0.028226053],
                    'max_mae': 0.95871663,
                    'max_mse': 0.9810912,
                    'max_rmse': 0.9905005,
                    'median_mae': 0.016876038,
                    'min_cosine': -0.64456826,
                    'mse': [0.0017435844,
                            0.0029834385,
                            0.0019222677,
                            0.00177626,
                            0.0005404568,
                            0.0003780382,
                            0.00068662135,
                            0.00048093463,
                            0.00046367612,
                            0.000345362,
                            0.00032498979,
                            0.00037280234,
                            0.00033045665,
                            0.00034124914,
                            0.00028680442,
                            0.9810912,
                            0.0003717377,
                            0.00033274313,
                            0.00035710307,
                            0.00063002243,
                            0.12403998,
                            0.0011985134],
                    'rmse': [0.04175625,
                             0.054620862,
                             0.043843675,
                             0.0421457,
                             0.023247726,
                             0.019443205,
                             0.026203461,
                             0.021930221,
                             0.021533139,
                             0.018583918,
                             0.018027473,
                             0.01930809,
                             0.018178467,
                             0.01847293,
                             0.016935302,
                             0.9905005,
                             0.0192805,
                             0.018241249,
                             0.01889717,
                             0.025100248,
                             0.3521931,
                             0.03461955]},
 'spectra_realgan': {'cosine': [0.9670778,
                                0.9860739,
                                0.9780557,
                                0.98576266,
                                0.9951324,
                                0.99904984,
                                0.993334,
                                0.9958081,
                                0.9978229,
                                0.99878496,
                                0.99668676,
                                0.99711907,
                                0.9985224,
                                0.9972569,
                                0.99887186,
                                -0.6445148,
                                0.9986888,
                                0.9994831,
                                0.9991609,
                                0.9950985,
                                0.00620771,
                                0.98793983],
                     'mae': [0.03637817,
                             0.046589788,
                             0.034258008,
                             0.035527002,
                             0.019814119,
                             0.015101448,
                             0.02191781,
                             0.018824134,
                             0.018703619,
                             0.014546591,
                             0.015915832,
                             0.017371306,
                             0.015557715,
                             0.016533135,
                             0.014031367,
                             0.95868284,
                             0.01574498,
                             0.0143905,
                             0.014926655,
                             0.02216288,
                             0.34483683,
                             0.029416408],
                     'max_mae': 0.95868284,
                     'max_mse': 0.9810211,
                     'max_rmse': 0.9904651,
                     'median_mae': 0.018763877,
                     'min_cosine': -0.6445148,
                     'mse': [0.0018786305,
                             0.0031433513,
                             0.0020680984,
                             0.0019107212,
                             0.00067015114,
                             0.00038199013,
                             0.00079278374,
                             0.0005900748,
                             0.0005667468,
                             0.00036588818,
                             0.000430694,
                             0.00047388955,
                             0.0003922552,
                             0.0004558564,
                             0.00032200202,
                             0.9810211,
                             0.0003959076,
                             0.0003332668,
                             0.00035991942,
                             0.0007465529,
                             0.12421885,
                             0.001340763],
                     'rmse': [0.04334317,
                              0.056065597,
                              0.04547635,
                              0.043711796,
                              0.025887277,
                              0.019544568,
                              0.028156416,
                              0.024291456,
                              0.023806445,
                              0.019128203,
                              0.020753168,
                              0.021769004,
                              0.019805433,
                              0.021350794,
                              0.017944414,
                              0.9904651,
                              0.019897427,
                              0.018255597,
                              0.018971542,
                              0.02732312,
                              0.35244694,
                              0.03661643]},
 'spectra_realpca': {'cosine': [0.9974836,
                                0.9987623,
                                0.99793965,
                                0.99830383,
                                0.9989524,
                                0.99999106,
                                0.9989834,
                                0.99916244,
                                0.99951464,
                                0.9999324,
                                0.99907744,
                                0.99933684,
                                0.9997884,
                                0.9993059,
                                0.99987274,
                                0.9999971,
                                0.9999255,
                                0.9999985,
                                0.99999464,
                                0.99921805,
                                0.99888164,
                                0.99818885],
                     'mae': [0.00954093,
                             0.010634719,
                             0.010027181,
                             0.010001975,
                             0.008595908,
                             0.0014293696,
                             0.008677493,
                             0.008404221,
                             0.007880507,
                             0.003541574,
                             0.008527098,
                             0.008124627,
                             0.005872096,
                             0.0083244415,
                             0.004733289,
                             0.0006737348,
                             0.0036501698,
                             0.00074914965,
                             0.0011794079,
                             0.008326558,
                             0.0077476944,
                             0.010275997],
                     'max_mae': 0.010634719,
                     'max_mse': 0.00019085962,
                     'max_rmse': 0.013815195,
                     'median_mae': 0.008224534,
                     'min_cosine': 0.9974836,
                     'mse': [0.0001455587,
                             0.00019085962,
                             0.00016115436,
                             0.00015956633,
                             0.00011880853,
                             3.3164777e-06,
                             0.00012101244,
                             0.000114064016,
                             9.985087e-05,
                             2.000764e-05,
                             0.00011797217,
                             0.00010669973,
                             5.6555145e-05,
                             0.00011257885,
                             3.6349684e-05,
                             7.381404e-07,
                             2.162191e-05,
                             9.128808e-07,
                             2.260558e-06,
                             0.000111774614,
                             0.000119069,
                             0.00017088835],
                     'rmse': [0.012064771,
                              0.013815195,
                              0.012694659,
                              0.0126319565,
                              0.010899932,
                              0.0018211199,
                              0.011000565,
                              0.010680076,
                              0.009992541,
                              0.00447299,
                              0.010861499,
                              0.010329556,
                              0.0075203157,
                              0.010610318,
                              0.00602907,
                              0.00085915095,
                              0.0046499367,
                              0.00095544796,
                              0.0015035152,
                              0.0105723515,
                              0.0109118745,
                              0.013072427]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_60.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809
Directory path: experiments/inpainting/gann_4_night_20180901_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_60.0/images
Optimal number of principal components:  18
Reconstruction error:  13.167044
Energy conservation:  0.60355496
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_60.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9130967822707543, 2.9545949398586226],
                   'kl_div': 0.43799037,
                   'ks_tests': {10000: KstestResult(statistic=0.206, pvalue=4.8654653137977486e-186, statistic_location=-0.006153164, statistic_sign=-1),
                                20000: KstestResult(statistic=0.20295000000000002, pvalue=0.0, statistic_location=-0.005774338, statistic_sign=-1),
                                30000: KstestResult(statistic=0.20293333333333335, pvalue=0.0, statistic_location=-0.0057520745, statistic_sign=-1),
                                40000: KstestResult(statistic=0.19872499999999998, pvalue=0.0, statistic_location=-0.0057687107, statistic_sign=-1),
                                50000: KstestResult(statistic=0.20222, pvalue=0.0, statistic_location=-0.005582966, statistic_sign=-1),
                                60000: KstestResult(statistic=0.2025, pvalue=0.0, statistic_location=-0.00571741, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2011, pvalue=0.0, statistic_location=-0.0056978995, statistic_sign=-1),
                                80000: KstestResult(statistic=0.2017375, pvalue=0.0, statistic_location=-0.0059702024, statistic_sign=-1),
                                90000: KstestResult(statistic=0.1990222222222222, pvalue=0.0, statistic_location=-0.0058233365, statistic_sign=-1),
                                100000: KstestResult(statistic=0.19817999999999997, pvalue=0.0, statistic_location=-0.0056894403, statistic_sign=-1),
                                110000: KstestResult(statistic=0.20139090909090906, pvalue=0.0, statistic_location=-0.0053810133, statistic_sign=-1),
                                120000: KstestResult(statistic=0.20289999999999997, pvalue=0.0, statistic_location=-0.005636409, statistic_sign=-1),
                                130000: KstestResult(statistic=0.2024846153846154, pvalue=0.0, statistic_location=-0.0056891935, statistic_sign=-1),
                                140000: KstestResult(statistic=0.20252857142857142, pvalue=0.0, statistic_location=-0.005929565, statistic_sign=-1),
                                150000: KstestResult(statistic=0.20276666666666665, pvalue=0.0, statistic_location=-0.0056967037, statistic_sign=-1),
                                160000: KstestResult(statistic=0.20291874999999998, pvalue=0.0, statistic_location=-0.006022207, statistic_sign=-1),
                                170000: KstestResult(statistic=0.20194705882352942, pvalue=0.0, statistic_location=-0.0056891525, statistic_sign=-1),
                                180000: KstestResult(statistic=0.20232222222222218, pvalue=0.0, statistic_location=-0.005696133, statistic_sign=-1),
                                190000: KstestResult(statistic=0.1999421052631579, pvalue=0.0, statistic_location=-0.005674284, statistic_sign=-1),
                                200000: KstestResult(statistic=0.20218999999999998, pvalue=0.0, statistic_location=-0.00581579, statistic_sign=-1),
                                210000: KstestResult(statistic=0.20141904761904764, pvalue=0.0, statistic_location=-0.005676253, statistic_sign=-1),
                                220000: KstestResult(statistic=0.20203636363636363, pvalue=0.0, statistic_location=-0.005867349, statistic_sign=-1),
                                230000: KstestResult(statistic=0.20106521739130434, pvalue=0.0, statistic_location=-0.00567656, statistic_sign=-1),
                                240000: KstestResult(statistic=0.20170416666666663, pvalue=0.0, statistic_location=-0.005647881, statistic_sign=-1),
                                250000: KstestResult(statistic=0.20222, pvalue=0.0, statistic_location=-0.0056976452, statistic_sign=-1),
                                260000: KstestResult(statistic=0.20118076923076927, pvalue=0.0, statistic_location=-0.005750537, statistic_sign=-1),
                                270000: KstestResult(statistic=0.20194814814814813, pvalue=0.0, statistic_location=-0.0058202418, statistic_sign=-1),
                                280000: KstestResult(statistic=0.2015892857142857, pvalue=0.0, statistic_location=-0.005779583, statistic_sign=-1),
                                290000: KstestResult(statistic=0.2013206896551724, pvalue=0.0, statistic_location=-0.0056754723, statistic_sign=-1),
                                300000: KstestResult(statistic=0.20130333333333333, pvalue=0.0, statistic_location=-0.005689477, statistic_sign=-1),
                                310000: KstestResult(statistic=0.2023032258064516, pvalue=0.0, statistic_location=-0.0056754723, statistic_sign=-1),
                                320000: KstestResult(statistic=0.20083125, pvalue=0.0, statistic_location=-0.0056509767, statistic_sign=-1),
                                330000: KstestResult(statistic=0.2015545454545455, pvalue=0.0, statistic_location=-0.0056480747, statistic_sign=-1)},
                   'moments': {'mean_error': -0.028260693,
                               'means': [-0.00039741758, -5.1211147e-05],
                               'stds': [0.018622587, 0.0048585404],
                               'variance_ratio': 11.404828}},
 'originals': {'gan': {'mae': 0.061107855290174484,
                       'mse': 0.03438358008861542,
                       'psnr': 19.85433006286621,
                       'rmse': 0.18542809784412384,
                       'ssim': 0.6147010922431946},
               'pca': {'mae': 0.007011836394667625,
                       'mse': 9.772112389327958e-05,
                       'psnr': 45.55752182006836,
                       'rmse': 0.009885399602353573,
                       'ssim': 0.9952139854431152}},
 'reconstructions': {'mae': 0.05996938422322273,
                     'mse': 0.034294698387384415,
                     'psnr': 20.105140686035156,
                     'rmse': 0.18518827855587006,
                     'ssim': 0.6169984340667725},
 'residual_spectra_pcagan': {'cosine': [0.34643623,
                                        0.3824585,
                                        0.33684868,
                                        0.4060662,
                                        0.39866593,
                                        0.2674158,
                                        0.37324482,
                                        0.32518303,
                                        0.24808641,
                                        0.25400582,
                                        0.3415358,
                                        0.0932456,
                                        0.32820132,
                                        0.4229995,
                                        0.41322643,
                                        0.21489045,
                                        0.39527622,
                                        0.40291288,
                                        0.3661006,
                                        0.43375883,
                                        0.3035794,
                                        0.0241947,
                                        0.23502265,
                                        0.045581296,
                                        0.08835576,
                                        0.3988111,
                                        0.32268927,
                                        0.39383662,
                                        0.2908031,
                                        0.2534915,
                                        0.0717157,
                                        0.27940446,
                                        0.08528721],
                             'mae': [0.008623623,
                                     0.007880041,
                                     0.008394996,
                                     0.0079833325,
                                     0.007974482,
                                     0.010082991,
                                     0.009185845,
                                     0.010196988,
                                     0.010587943,
                                     0.010991689,
                                     0.009476316,
                                     0.010731976,
                                     0.01024864,
                                     0.008128722,
                                     0.009035594,
                                     0.009889828,
                                     0.007816152,
                                     0.008710471,
                                     0.008928758,
                                     0.008125776,
                                     0.008715327,
                                     0.025856012,
                                     0.009925035,
                                     0.01255432,
                                     0.010928553,
                                     0.009520194,
                                     0.010283647,
                                     0.007868707,
                                     0.009497528,
                                     0.010849442,
                                     0.011153228,
                                     0.010881369,
                                     0.009983006],
                             'max_mae': 0.025856012,
                             'max_mse': 0.0033098222,
                             'max_rmse': 0.057531055,
                             'median_distance': 1.4528035,
                             'median_mae': 0.009520194,
                             'min_cosine': 0.0241947,
                             'mse': [0.00020645342,
                                     0.00014996418,
                                     0.00020768607,
                                     0.00015601517,
                                     0.00014212467,
                                     0.00032674466,
                                     0.00017726247,
                                     0.0002809105,
                                     0.00044963325,
                                     0.00033444376,
                                     0.00025467316,
                                     0.00024316338,
                                     0.00032107517,
                                     0.00016183872,
                                     0.00018876708,
                                     0.00023075707,
                                     0.0001561766,
                                     0.00016274943,
                                     0.00015900066,
                                     0.0001565098,
                                     0.00015314916,
                                     0.0033098222,
                                     0.00019126233,
                                     0.0003153931,
                                     0.00022703181,
                                     0.00019676807,
                                     0.00027140827,
                                     0.00014795651,
                                     0.00023671305,
                                     0.0004339691,
                                     0.00027828207,
                                     0.0002518909,
                                     0.00021106377],
                             'rmse': [0.014368487,
                                      0.012245987,
                                      0.014411317,
                                      0.012490603,
                                      0.011921605,
                                      0.018076079,
                                      0.013313995,
                                      0.016760385,
                                      0.021204557,
                                      0.018287804,
                                      0.015958482,
                                      0.015593696,
                                      0.01791857,
                                      0.012721585,
                                      0.013739253,
                                      0.01519069,
                                      0.012497064,
                                      0.012757328,
                                      0.012609546,
                                      0.012510388,
                                      0.0123753445,
                                      0.057531055,
                                      0.013829762,
                                      0.01775931,
                                      0.015067575,
                                      0.014027405,
                                      0.016474472,
                                      0.012163738,
                                      0.0153854815,
                                      0.020831926,
                                      0.016681788,
                                      0.01587107,
                                      0.014528034]},
 'residuals': {'mae': 0.010030623525381088,
               'mse': 0.0003239593643229455,
               'psnr': 20.030826568603516,
               'rmse': 0.017998870462179184,
               'ssds': [114.495995, 7.790628],
               'ssim': 0.6411980986595154},
 'spectra_pcagan': {'cosine': [0.9836302,
                               0.98138875,
                               0.98556757,
                               0.98800606,
                               0.9835673,
                               0.9838904,
                               0.9691267,
                               0.98783976,
                               0.98083806,
                               0.9875249,
                               0.99630076,
                               0.99905884,
                               0.9941397,
                               0.9965706,
                               0.99833715,
                               0.9988419,
                               0.9973857,
                               0.99774486,
                               0.9987366,
                               0.9979146,
                               0.99895,
                               -0.6459581,
                               0.9987451,
                               0.9994687,
                               0.9991755,
                               0.9956615,
                               0.008012767,
                               0.98952395,
                               0.97945905,
                               0.9747991,
                               0.9995111,
                               0.99837387,
                               0.99903697],
                    'mae': [0.023483053,
                            0.026988482,
                            0.022297407,
                            0.022519654,
                            0.02524874,
                            0.026083881,
                            0.035956856,
                            0.04593762,
                            0.03263496,
                            0.034552764,
                            0.016832711,
                            0.015083096,
                            0.020561308,
                            0.017028134,
                            0.01658027,
                            0.014191484,
                            0.013511471,
                            0.015078095,
                            0.014274442,
                            0.0139086945,
                            0.013423326,
                            0.9592368,
                            0.015352403,
                            0.0146849835,
                            0.014846274,
                            0.02071904,
                            0.34426472,
                            0.028552692,
                            0.037108354,
                            0.031659074,
                            0.014707797,
                            0.017063601,
                            0.014617392],
                    'max_mae': 0.9592368,
                    'max_mse': 0.98156345,
                    'max_rmse': 0.99073887,
                    'median_mae': 0.020561308,
                    'min_cosine': -0.6459581,
                    'mse': [0.00093534315,
                            0.0010690702,
                            0.00085685484,
                            0.0007990201,
                            0.00094243744,
                            0.0011480578,
                            0.0017593695,
                            0.0029616344,
                            0.0018829111,
                            0.0018014215,
                            0.0005091043,
                            0.0003776592,
                            0.00069343316,
                            0.00048104883,
                            0.00045581794,
                            0.00035108704,
                            0.0003382898,
                            0.00036920243,
                            0.00033627826,
                            0.000349533,
                            0.00029999518,
                            0.98156345,
                            0.0003834953,
                            0.0003452995,
                            0.00035643447,
                            0.000660635,
                            0.12365795,
                            0.0012172926,
                            0.0020764675,
                            0.0015635133,
                            0.00036007643,
                            0.00046325583,
                            0.00035955562],
                    'rmse': [0.03058338,
                             0.03269664,
                             0.029272083,
                             0.028266944,
                             0.030699143,
                             0.033883,
                             0.04194484,
                             0.0544209,
                             0.043392524,
                             0.042443156,
                             0.02256334,
                             0.019433456,
                             0.02633312,
                             0.021932825,
                             0.021349894,
                             0.018737316,
                             0.018392656,
                             0.019214641,
                             0.01833789,
                             0.018695801,
                             0.017320368,
                             0.99073887,
                             0.019583035,
                             0.018582236,
                             0.018879471,
                             0.025702821,
                             0.35165033,
                             0.03488972,
                             0.045568272,
                             0.039541285,
                             0.01897568,
                             0.021523379,
                             0.018961951]},
 'spectra_realgan': {'cosine': [0.98116416,
                                0.9792906,
                                0.9832459,
                                0.98577976,
                                0.9814677,
                                0.98156124,
                                0.9668413,
                                0.9864012,
                                0.97883904,
                                0.9860042,
                                0.99519145,
                                0.9990496,
                                0.9932539,
                                0.9957636,
                                0.99784756,
                                0.9987711,
                                0.996565,
                                0.9971138,
                                0.9984994,
                                0.9972058,
                                0.9988238,
                                -0.64590436,
                                0.998654,
                                0.99946684,
                                0.999167,
                                0.9948542,
                                0.0073883943,
                                0.9878665,
                                0.97839326,
                                0.97260165,
                                0.99950576,
                                0.9981981,
                                0.99902624],
                     'mae': [0.025522962,
                             0.02819047,
                             0.024054082,
                             0.024406085,
                             0.026515229,
                             0.02765658,
                             0.0366096,
                             0.04644786,
                             0.033958904,
                             0.03557728,
                             0.01940579,
                             0.015161359,
                             0.022016011,
                             0.018857328,
                             0.018548708,
                             0.01466665,
                             0.016057845,
                             0.017318573,
                             0.015701028,
                             0.016630571,
                             0.01427325,
                             0.95920295,
                             0.01591568,
                             0.014694339,
                             0.014899051,
                             0.02259362,
                             0.3443543,
                             0.029696891,
                             0.03761046,
                             0.032620154,
                             0.014728023,
                             0.01795012,
                             0.014717337],
                     'max_mae': 0.95920295,
                     'max_mse': 0.9814932,
                     'max_rmse': 0.99070334,
                     'median_mae': 0.022016011,
                     'min_cosine': -0.64590436,
                     'mse': [0.0010776102,
                             0.0011927221,
                             0.0009870987,
                             0.00093792914,
                             0.0010650458,
                             0.0012817222,
                             0.0018940758,
                             0.0031226284,
                             0.0020291568,
                             0.0019350204,
                             0.0006385489,
                             0.00038157578,
                             0.000800654,
                             0.0005906596,
                             0.00055675977,
                             0.00037131037,
                             0.00044307986,
                             0.00047080207,
                             0.0003982088,
                             0.00046431867,
                             0.00033573667,
                             0.9814932,
                             0.00040745668,
                             0.00034584056,
                             0.00035928897,
                             0.00077649346,
                             0.123837024,
                             0.0013584506,
                             0.0021697725,
                             0.0016991112,
                             0.0003608177,
                             0.00051253545,
                             0.00036351563],
                     'rmse': [0.032826975,
                              0.03453581,
                              0.031418126,
                              0.030625628,
                              0.03263504,
                              0.03580115,
                              0.04352098,
                              0.055880483,
                              0.04504616,
                              0.04398887,
                              0.025269525,
                              0.019533964,
                              0.02829583,
                              0.02430349,
                              0.023595758,
                              0.019269416,
                              0.021049462,
                              0.021697974,
                              0.01995517,
                              0.021548055,
                              0.018323118,
                              0.99070334,
                              0.020185556,
                              0.018596789,
                              0.01895492,
                              0.027865632,
                              0.35190484,
                              0.036857165,
                              0.046580818,
                              0.041220278,
                              0.018995203,
                              0.022639247,
                              0.019066086]},
 'spectra_realpca': {'cosine': [0.99750215,
                                0.99753547,
                                0.9973913,
                                0.9977724,
                                0.9975049,
                                0.99747324,
                                0.9974836,
                                0.9987623,
                                0.99793965,
                                0.99830383,
                                0.9989524,
                                0.99999106,
                                0.9989834,
                                0.99916244,
                                0.99951464,
                                0.9999324,
                                0.99907744,
                                0.99933684,
                                0.9997884,
                                0.9993059,
                                0.99987274,
                                0.9999971,
                                0.9999255,
                                0.9999985,
                                0.99999464,
                                0.99921805,
                                0.99888164,
                                0.99818885,
                                0.99825376,
                                0.9975071,
                                0.999997,
                                0.99984485,
                                0.9999898],
                     'mae': [0.009409708,
                             0.009431473,
                             0.009700395,
                             0.009261146,
                             0.00947203,
                             0.009751142,
                             0.00954093,
                             0.010634719,
                             0.010027181,
                             0.010001975,
                             0.008595908,
                             0.0014293696,
                             0.008677493,
                             0.008404221,
                             0.007880507,
                             0.003541574,
                             0.008527098,
                             0.008124627,
                             0.005872096,
                             0.0083244415,
                             0.004733289,
                             0.0006737348,
                             0.0036501698,
                             0.00074914965,
                             0.0011794079,
                             0.008326558,
                             0.0077476944,
                             0.010275997,
                             0.010216177,
                             0.009608059,
                             0.00095801963,
                             0.005198422,
                             0.0014658573],
                     'max_mae': 0.010634719,
                     'max_mse': 0.00019085962,
                     'max_rmse': 0.013815195,
                     'median_mae': 0.008404221,
                     'min_cosine': 0.9973913,
                     'mse': [0.00014164964,
                             0.00014179456,
                             0.00014844992,
                             0.00013758142,
                             0.0001435953,
                             0.00015367437,
                             0.0001455587,
                             0.00019085962,
                             0.00016115436,
                             0.00015956633,
                             0.00011880853,
                             3.3164777e-06,
                             0.00012101244,
                             0.000114064016,
                             9.985087e-05,
                             2.000764e-05,
                             0.00011797217,
                             0.00010669973,
                             5.6555145e-05,
                             0.00011257885,
                             3.6349684e-05,
                             7.381404e-07,
                             2.162191e-05,
                             9.128808e-07,
                             2.260558e-06,
                             0.000111774614,
                             0.000119069,
                             0.00017088835,
                             0.0001701461,
                             0.00014786908,
                             1.4902016e-06,
                             4.34742e-05,
                             3.4522548e-06],
                     'rmse': [0.0119016655,
                              0.011907752,
                              0.012184002,
                              0.0117295105,
                              0.0119831255,
                              0.012396546,
                              0.012064771,
                              0.013815195,
                              0.012694659,
                              0.0126319565,
                              0.010899932,
                              0.0018211199,
                              0.011000565,
                              0.010680076,
                              0.009992541,
                              0.00447299,
                              0.010861499,
                              0.010329556,
                              0.0075203157,
                              0.010610318,
                              0.00602907,
                              0.00085915095,
                              0.0046499367,
                              0.00095544796,
                              0.0015035152,
                              0.0105723515,
                              0.0109118745,
                              0.013072427,
                              0.013044006,
                              0.012160143,
                              0.0012207382,
                              0.0065934965,
                              0.0018580244]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_60.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521
Directory path: experiments/inpainting/gann_4_night_20180904_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_60.0/images
Optimal number of principal components:  25
Reconstruction error:  9.756767
Energy conservation:  0.601004
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_60.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9519870688369956, 1.3889698302383557],
                   'kl_div': 1.9643173,
                   'ks_tests': {10000: KstestResult(statistic=0.46, pvalue=0.0, statistic_location=0.0020193406, statistic_sign=1),
                                20000: KstestResult(statistic=0.4536, pvalue=0.0, statistic_location=0.0022044217, statistic_sign=1),
                                30000: KstestResult(statistic=0.45400000000000007, pvalue=0.0, statistic_location=0.0020669107, statistic_sign=1),
                                40000: KstestResult(statistic=0.4593750000000001, pvalue=0.0, statistic_location=0.0018826104, statistic_sign=1),
                                50000: KstestResult(statistic=0.45266000000000006, pvalue=0.0, statistic_location=0.0022173892, statistic_sign=1),
                                60000: KstestResult(statistic=0.4560833333333333, pvalue=0.0, statistic_location=0.0020088626, statistic_sign=1),
                                70000: KstestResult(statistic=0.4551142857142857, pvalue=0.0, statistic_location=0.0021998712, statistic_sign=1),
                                80000: KstestResult(statistic=0.4557375, pvalue=0.0, statistic_location=0.0021069564, statistic_sign=1),
                                90000: KstestResult(statistic=0.45182222222222224, pvalue=0.0, statistic_location=0.0020428032, statistic_sign=1),
                                100000: KstestResult(statistic=0.45596000000000003, pvalue=0.0, statistic_location=0.002025425, statistic_sign=1),
                                110000: KstestResult(statistic=0.4535363636363636, pvalue=0.0, statistic_location=0.0020278357, statistic_sign=1)},
                   'moments': {'mean_error': 1.3876495,
                               'means': [0.00041185232, -9.538072e-06],
                               'stds': [0.018056862, 0.0009724547],
                               'variance_ratio': 330.3676}},
 'originals': {'gan': {'mae': 0.015457052737474442,
                       'mse': 0.0004065638058818877,
                       'psnr': 33.48274612426758,
                       'rmse': 0.02016342803835869,
                       'ssim': 0.9744046926498413},
               'pca': {'mae': 0.0010361395543441176,
                       'mse': 2.4519074486306636e-06,
                       'psnr': 56.10495376586914,
                       'rmse': 0.0015658567426726222,
                       'ssim': 0.999931275844574}},
 'reconstructions': {'mae': 0.015408682636916637,
                     'mse': 0.0004040654166601598,
                     'psnr': 33.935482025146484,
                     'rmse': 0.020101377740502357,
                     'ssim': 0.9744651913642883},
 'residual_spectra_pcagan': {'cosine': [0.029371273,
                                        0.06484326,
                                        0.035370566,
                                        0.025759151,
                                        0.03074131,
                                        0.046607878,
                                        0.06451135,
                                        0.04317018,
                                        0.08415831,
                                        0.09938265,
                                        0.074813865],
                             'mae': [0.011261025,
                                     0.01310719,
                                     0.01218125,
                                     0.01182417,
                                     0.013403839,
                                     0.011482899,
                                     0.01108842,
                                     0.010482408,
                                     0.010582915,
                                     0.010346246,
                                     0.010744983],
                             'max_mae': 0.013403839,
                             'max_mse': 0.0005389347,
                             'max_rmse': 0.023214968,
                             'median_distance': 1.7303326,
                             'median_mae': 0.011261025,
                             'min_cosine': 0.025759151,
                             'mse': [0.0002668011,
                                     0.0004836601,
                                     0.00031803307,
                                     0.00029318043,
                                     0.0005389347,
                                     0.0003014085,
                                     0.00028456937,
                                     0.00025445872,
                                     0.00029940504,
                                     0.00023359571,
                                     0.00030357967],
                             'rmse': [0.016334048,
                                      0.021992274,
                                      0.017833482,
                                      0.017122513,
                                      0.023214968,
                                      0.01736112,
                                      0.016869184,
                                      0.015951762,
                                      0.017303325,
                                      0.015283838,
                                      0.017423538]},
 'residuals': {'mae': 0.011500485241413116,
               'mse': 0.0003252387687098235,
               'psnr': -2.0020413398742676,
               'rmse': 0.018034378066658974,
               'ssds': [35.88386, 0.104032554],
               'ssim': 0.2920210063457489},
 'spectra_pcagan': {'cosine': [0.99921393,
                               0.99917984,
                               0.99916995,
                               0.99960166,
                               0.9997207,
                               0.999569,
                               0.99955803,
                               0.9992296,
                               0.99839336,
                               0.9985949,
                               0.99815506],
                    'mae': [0.016213408,
                            0.016113864,
                            0.01653713,
                            0.014090877,
                            0.013362695,
                            0.013890391,
                            0.01362843,
                            0.0146300215,
                            0.017043239,
                            0.016897228,
                            0.017088227],
                    'max_mae': 0.017088227,
                    'max_mse': 0.00051080453,
                    'max_rmse': 0.022600986,
                    'median_mae': 0.016113864,
                    'min_cosine': 0.99815506,
                    'mse': [0.00042953395,
                            0.00046726814,
                            0.0004443583,
                            0.0003162648,
                            0.00032531744,
                            0.00031588963,
                            0.0003051901,
                            0.0003567683,
                            0.00051080453,
                            0.00047126695,
                            0.0005020575],
                    'rmse': [0.0207252,
                             0.021616386,
                             0.021079808,
                             0.017783836,
                             0.01803656,
                             0.017773284,
                             0.017469691,
                             0.018888311,
                             0.022600986,
                             0.021708684,
                             0.02240664]},
 'spectra_realgan': {'cosine': [0.9992127,
                                0.9991764,
                                0.99916804,
                                0.9996012,
                                0.99972034,
                                0.99956834,
                                0.9995564,
                                0.9992266,
                                0.9983754,
                                0.9985748,
                                0.9981255],
                     'mae': [0.016234778,
                             0.016154572,
                             0.01656498,
                             0.014099692,
                             0.013370244,
                             0.013901627,
                             0.013646774,
                             0.014649203,
                             0.01715291,
                             0.017003875,
                             0.017248917],
                     'max_mae': 0.017248917,
                     'max_mse': 0.00051666965,
                     'max_rmse': 0.02273037,
                     'median_mae': 0.016154572,
                     'min_cosine': 0.9981255,
                     'mse': [0.00043041992,
                             0.00046923166,
                             0.00044539614,
                             0.00031672043,
                             0.00032555466,
                             0.00031649024,
                             0.00030634206,
                             0.0003581913,
                             0.00051666965,
                             0.00047747034,
                             0.00050971506],
                     'rmse': [0.020746564,
                              0.021661757,
                              0.02110441,
                              0.017796641,
                              0.018043132,
                              0.017790172,
                              0.01750263,
                              0.018925942,
                              0.02273037,
                              0.021851094,
                              0.02257687]},
 'spectra_realpca': {'cosine': [0.9999984,
                                0.999998,
                                0.999998,
                                0.9999998,
                                0.99999976,
                                0.9999996,
                                0.99999887,
                                0.9999959,
                                0.99998003,
                                0.99998254,
                                0.9999668],
                     'mae': [0.000708161,
                             0.000847175,
                             0.0008210433,
                             0.00037984093,
                             0.00027192393,
                             0.0004261042,
                             0.00068271597,
                             0.0010819895,
                             0.0019556736,
                             0.0018587187,
                             0.0023641894],
                     'max_mae': 0.0023641894,
                     'max_mse': 8.927089e-06,
                     'max_rmse': 0.0029878234,
                     'median_mae': 0.0008210433,
                     'min_cosine': 0.9999668,
                     'mse': [8.1227256e-07,
                             1.1529735e-06,
                             1.0807383e-06,
                             2.3085056e-07,
                             1.1916284e-07,
                             2.9361973e-07,
                             7.486411e-07,
                             1.8715957e-06,
                             6.166895e-06,
                             5.5671458e-06,
                             8.927089e-06],
                     'rmse': [0.00090126164,
                              0.001073766,
                              0.0010395857,
                              0.0004804691,
                              0.00034519972,
                              0.0005418669,
                              0.0008652405,
                              0.0013680628,
                              0.0024833234,
                              0.00235948,
                              0.0029878234]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_60.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743
Directory path: experiments/inpainting/gann_4_night_20180904_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_60.0/images
Optimal number of principal components:  25
Reconstruction error:  9.756767
Energy conservation:  0.601004
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_60.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9538435048012626, 2.0135048570021548],
                   'kl_div': 1.3376243,
                   'ks_tests': {10000: KstestResult(statistic=0.3486, pvalue=0.0, statistic_location=0.0022262994, statistic_sign=1),
                                20000: KstestResult(statistic=0.34265, pvalue=0.0, statistic_location=0.0024233055, statistic_sign=1),
                                30000: KstestResult(statistic=0.34109999999999996, pvalue=0.0, statistic_location=0.0024253344, statistic_sign=1),
                                40000: KstestResult(statistic=0.34065, pvalue=0.0, statistic_location=0.0023471322, statistic_sign=1),
                                50000: KstestResult(statistic=0.34384000000000003, pvalue=0.0, statistic_location=0.0023860815, statistic_sign=1),
                                60000: KstestResult(statistic=0.3434666666666667, pvalue=0.0, statistic_location=0.0023612664, statistic_sign=1),
                                70000: KstestResult(statistic=0.3430428571428571, pvalue=0.0, statistic_location=0.0022565937, statistic_sign=1),
                                80000: KstestResult(statistic=0.34455, pvalue=0.0, statistic_location=0.0023748619, statistic_sign=1),
                                90000: KstestResult(statistic=0.34116666666666673, pvalue=0.0, statistic_location=0.0024250727, statistic_sign=1),
                                100000: KstestResult(statistic=0.34247000000000005, pvalue=0.0, statistic_location=0.0023929374, statistic_sign=1),
                                110000: KstestResult(statistic=0.3392090909090909, pvalue=0.0, statistic_location=0.0023932287, statistic_sign=1),
                                120000: KstestResult(statistic=0.3439000000000001, pvalue=0.0, statistic_location=0.0022851797, statistic_sign=1),
                                130000: KstestResult(statistic=0.34103076923076925, pvalue=0.0, statistic_location=0.0024063925, statistic_sign=1),
                                140000: KstestResult(statistic=0.3401214285714286, pvalue=0.0, statistic_location=0.0024187881, statistic_sign=1),
                                150000: KstestResult(statistic=0.34173333333333333, pvalue=0.0, statistic_location=0.002385066, statistic_sign=1),
                                160000: KstestResult(statistic=0.34313125, pvalue=0.0, statistic_location=0.0023929263, statistic_sign=1),
                                170000: KstestResult(statistic=0.341564705882353, pvalue=0.0, statistic_location=0.002410323, statistic_sign=1),
                                180000: KstestResult(statistic=0.3408, pvalue=0.0, statistic_location=0.0024099573, statistic_sign=1),
                                190000: KstestResult(statistic=0.3436526315789473, pvalue=0.0, statistic_location=0.0023543634, statistic_sign=1),
                                200000: KstestResult(statistic=0.342815, pvalue=0.0, statistic_location=0.0023543863, statistic_sign=1),
                                210000: KstestResult(statistic=0.34097619047619043, pvalue=0.0, statistic_location=0.0023586624, statistic_sign=1),
                                220000: KstestResult(statistic=0.3425136363636363, pvalue=0.0, statistic_location=0.0024094535, statistic_sign=1)},
                   'moments': {'mean_error': 0.07778645,
                               'means': [-0.00020164356, -5.164021e-06],
                               'stds': [0.016210506, 0.0025870102],
                               'variance_ratio': 45.4502}},
 'originals': {'gan': {'mae': 0.022803466767072678,
                       'mse': 0.0012679280480369925,
                       'psnr': 29.031415939331055,
                       'rmse': 0.03560797870159149,
                       'ssim': 0.9156923890113831},
               'pca': {'mae': 0.0028178133070468903,
                       'mse': 3.0474519007839262e-05,
                       'psnr': 45.468929290771484,
                       'rmse': 0.0055203731171786785,
                       'ssim': 0.9994354844093323}},
 'reconstructions': {'mae': 0.022375645115971565,
                     'mse': 0.0012386948801577091,
                     'psnr': 29.3786563873291,
                     'rmse': 0.03519509732723236,
                     'ssim': 0.9157631397247314},
 'residual_spectra_pcagan': {'cosine': [0.06329388,
                                        0.08899708,
                                        0.040887456,
                                        0.028471515,
                                        0.03918952,
                                        0.029622769,
                                        0.06817976,
                                        0.03480777,
                                        0.026380574,
                                        0.038530603,
                                        0.03954613,
                                        0.054447975,
                                        0.07787236,
                                        0.065476626,
                                        0.103504665,
                                        0.075304784,
                                        0.08823921,
                                        0.29504865,
                                        0.4080604,
                                        0.37773463,
                                        0.22118957,
                                        0.33148772],
                             'mae': [0.009633285,
                                     0.010173914,
                                     0.011301112,
                                     0.011753209,
                                     0.01128962,
                                     0.0106149595,
                                     0.012166006,
                                     0.010802879,
                                     0.011550682,
                                     0.0121537065,
                                     0.010560009,
                                     0.011249004,
                                     0.00981832,
                                     0.011205411,
                                     0.011978166,
                                     0.010693416,
                                     0.010279655,
                                     0.010197642,
                                     0.008318641,
                                     0.0083446745,
                                     0.01048857,
                                     0.009080832],
                             'max_mae': 0.012166006,
                             'max_mse': 0.00036422396,
                             'max_rmse': 0.019084653,
                             'median_distance': 1.575526,
                             'median_mae': 0.010654188,
                             'min_cosine': 0.026380574,
                             'mse': [0.00019267228,
                                     0.0002451319,
                                     0.00033634933,
                                     0.00027181394,
                                     0.0002983117,
                                     0.0002211711,
                                     0.00035515463,
                                     0.00023319936,
                                     0.00026209975,
                                     0.00034536835,
                                     0.00023053517,
                                     0.0002513439,
                                     0.00018970057,
                                     0.00036422396,
                                     0.00029043175,
                                     0.00025457135,
                                     0.00021981554,
                                     0.00022980824,
                                     0.00014193953,
                                     0.00016038881,
                                     0.00032447744,
                                     0.00022659071],
                             'rmse': [0.013880644,
                                      0.01565669,
                                      0.01833983,
                                      0.01648678,
                                      0.017271703,
                                      0.014871823,
                                      0.018845547,
                                      0.015270866,
                                      0.016189495,
                                      0.01858409,
                                      0.0151833845,
                                      0.01585383,
                                      0.013773183,
                                      0.019084653,
                                      0.017042058,
                                      0.015955292,
                                      0.014826178,
                                      0.015159427,
                                      0.011913838,
                                      0.01266447,
                                      0.018013258,
                                      0.01505293]},
 'residuals': {'mae': 0.010620622895658016,
               'mse': 0.0002565954637248069,
               'psnr': 11.100028991699219,
               'rmse': 0.016018597409129143,
               'ssds': [57.820404, 1.4723759],
               'ssim': 0.34135061502456665},
 'spectra_pcagan': {'cosine': [0.99874973,
                               0.99893296,
                               0.99886703,
                               0.9995557,
                               0.9990216,
                               0.99928087,
                               0.999239,
                               0.9992933,
                               0.99960274,
                               0.99975973,
                               0.9996045,
                               0.9995238,
                               0.99922603,
                               0.9980762,
                               0.99764603,
                               0.9980071,
                               0.9666791,
                               0.9955027,
                               0.9861865,
                               0.9899756,
                               0.9957115,
                               0.991366],
                    'mae': [0.01667667,
                            0.017727602,
                            0.017072424,
                            0.013824494,
                            0.016715912,
                            0.015699403,
                            0.015612746,
                            0.015706657,
                            0.013692693,
                            0.011833749,
                            0.012658731,
                            0.013911522,
                            0.01590606,
                            0.018192034,
                            0.025161522,
                            0.01862948,
                            0.12166519,
                            0.02179986,
                            0.028269755,
                            0.02083112,
                            0.019157369,
                            0.0215192],
                    'max_mae': 0.12166519,
                    'max_mse': 0.015759649,
                    'max_rmse': 0.12553744,
                    'median_mae': 0.01689417,
                    'min_cosine': 0.9666791,
                    'mse': [0.0004505616,
                            0.0005122479,
                            0.0005140636,
                            0.00031404532,
                            0.00046575497,
                            0.00039237604,
                            0.00042434965,
                            0.00039376857,
                            0.00030270554,
                            0.00023651021,
                            0.00027253834,
                            0.00031349488,
                            0.0004118845,
                            0.00060390355,
                            0.0009919702,
                            0.00058027724,
                            0.015759649,
                            0.0008067707,
                            0.0012028707,
                            0.00076584605,
                            0.000728643,
                            0.00080705574],
                    'rmse': [0.021226436,
                             0.022632895,
                             0.02267297,
                             0.017721323,
                             0.021581357,
                             0.019808484,
                             0.020599749,
                             0.019843603,
                             0.017398436,
                             0.015378889,
                             0.016508736,
                             0.017705787,
                             0.020294938,
                             0.02457445,
                             0.03149556,
                             0.024088943,
                             0.12553744,
                             0.028403709,
                             0.034682427,
                             0.027673924,
                             0.026993388,
                             0.028408727]},
 'spectra_realgan': {'cosine': [0.99874,
                                0.99892455,
                                0.9988629,
                                0.99955505,
                                0.9990176,
                                0.99927944,
                                0.99923605,
                                0.9992909,
                                0.9996024,
                                0.9997593,
                                0.99960375,
                                0.99952215,
                                0.99922097,
                                0.9980579,
                                0.99761397,
                                0.9979758,
                                0.96667266,
                                0.99495566,
                                0.9843059,
                                0.9879513,
                                0.9952545,
                                0.9898648],
                     'mae': [0.016758256,
                             0.017770698,
                             0.017112728,
                             0.0138358595,
                             0.016758597,
                             0.015727337,
                             0.015651785,
                             0.01573358,
                             0.013698829,
                             0.0118418075,
                             0.012671848,
                             0.013935796,
                             0.015933884,
                             0.018292822,
                             0.02528512,
                             0.01878357,
                             0.12164884,
                             0.023066282,
                             0.029758118,
                             0.023322826,
                             0.020487417,
                             0.023600273],
                     'max_mae': 0.12164884,
                     'max_mse': 0.015762823,
                     'max_rmse': 0.12555008,
                     'median_mae': 0.016935661,
                     'min_cosine': 0.96667266,
                     'mse': [0.00045422083,
                             0.00051536015,
                             0.00051565946,
                             0.00031451468,
                             0.00046752757,
                             0.00039331327,
                             0.00042609917,
                             0.00039523188,
                             0.00030303132,
                             0.0002368659,
                             0.0002731134,
                             0.00031458997,
                             0.00041395816,
                             0.0006094845,
                             0.0010027544,
                             0.00058764353,
                             0.015762823,
                             0.00089397345,
                             0.0013501759,
                             0.000919713,
                             0.0007952207,
                             0.0009491432],
                     'rmse': [0.021312457,
                              0.022701545,
                              0.022708137,
                              0.017734561,
                              0.021622386,
                              0.019832127,
                              0.020642169,
                              0.01988044,
                              0.017407795,
                              0.015390448,
                              0.016526142,
                              0.017736685,
                              0.020345962,
                              0.02468774,
                              0.031666297,
                              0.02424136,
                              0.12555008,
                              0.029899389,
                              0.03674474,
                              0.03032677,
                              0.028199658,
                              0.030808168]},
 'spectra_realpca': {'cosine': [0.9999905,
                                0.99999493,
                                0.9999957,
                                0.99999964,
                                0.9999955,
                                0.9999984,
                                0.999998,
                                0.999998,
                                0.9999998,
                                0.99999976,
                                0.9999996,
                                0.99999887,
                                0.9999959,
                                0.99998003,
                                0.99998254,
                                0.9999668,
                                0.99997497,
                                0.99945354,
                                0.99794143,
                                0.9978243,
                                0.9995819,
                                0.9983957],
                     'mae': [0.0013918608,
                             0.0011314808,
                             0.0010755461,
                             0.00037516898,
                             0.001093624,
                             0.000708161,
                             0.000847175,
                             0.0008210433,
                             0.00037984093,
                             0.00027192393,
                             0.0004261042,
                             0.00068271597,
                             0.0010819895,
                             0.0019556736,
                             0.0018587187,
                             0.0023641894,
                             0.001998979,
                             0.0074547026,
                             0.009930983,
                             0.010122644,
                             0.006360699,
                             0.009658667],
                     'max_mae': 0.010122644,
                     'max_mse': 0.00016370346,
                     'max_rmse': 0.012794665,
                     'median_mae': 0.0011125524,
                     'min_cosine': 0.9978243,
                     'mse': [3.090866e-06,
                             2.0303992e-06,
                             1.8544894e-06,
                             2.251933e-07,
                             1.912855e-06,
                             8.1227256e-07,
                             1.1529735e-06,
                             1.0807383e-06,
                             2.3085056e-07,
                             1.1916284e-07,
                             2.9361973e-07,
                             7.486411e-07,
                             1.8715957e-06,
                             6.166895e-06,
                             5.5671458e-06,
                             8.927089e-06,
                             6.3771145e-06,
                             8.890028e-05,
                             0.00015982738,
                             0.00016370346,
                             6.468661e-05,
                             0.00015085991],
                     'rmse': [0.0017580859,
                              0.0014249207,
                              0.0013617964,
                              0.00047454538,
                              0.00138306,
                              0.00090126164,
                              0.001073766,
                              0.0010395857,
                              0.0004804691,
                              0.00034519972,
                              0.0005418669,
                              0.0008652405,
                              0.0013680628,
                              0.0024833234,
                              0.00235948,
                              0.0029878234,
                              0.002525295,
                              0.009428694,
                              0.012642286,
                              0.012794665,
                              0.008042798,
                              0.012282504]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_60.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658
Directory path: experiments/inpainting/gann_4_night_20180904_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_60.0/images
Optimal number of principal components:  25
Reconstruction error:  9.756767
Energy conservation:  0.601004
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_60.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9187742426194503, 2.3723854715811536],
                   'kl_div': 0.9703047,
                   'ks_tests': {10000: KstestResult(statistic=0.2984, pvalue=1e-323, statistic_location=0.0023863334, statistic_sign=1),
                                20000: KstestResult(statistic=0.2986, pvalue=0.0, statistic_location=0.002659797, statistic_sign=1),
                                30000: KstestResult(statistic=0.2966, pvalue=0.0, statistic_location=0.0026661085, statistic_sign=1),
                                40000: KstestResult(statistic=0.29817499999999997, pvalue=0.0, statistic_location=0.002672826, statistic_sign=1),
                                50000: KstestResult(statistic=0.29811999999999994, pvalue=0.0, statistic_location=0.0026961246, statistic_sign=1),
                                60000: KstestResult(statistic=0.29884999999999995, pvalue=0.0, statistic_location=0.0026313683, statistic_sign=1),
                                70000: KstestResult(statistic=0.29655714285714285, pvalue=0.0, statistic_location=0.002706281, statistic_sign=1),
                                80000: KstestResult(statistic=0.29737500000000006, pvalue=0.0, statistic_location=0.002584929, statistic_sign=1),
                                90000: KstestResult(statistic=0.2992444444444444, pvalue=0.0, statistic_location=0.002561305, statistic_sign=1),
                                100000: KstestResult(statistic=0.29542, pvalue=0.0, statistic_location=0.0027161222, statistic_sign=1),
                                110000: KstestResult(statistic=0.29805454545454546, pvalue=0.0, statistic_location=0.0028681878, statistic_sign=1),
                                120000: KstestResult(statistic=0.29989999999999994, pvalue=0.0, statistic_location=0.002661152, statistic_sign=1),
                                130000: KstestResult(statistic=0.2977461538461539, pvalue=0.0, statistic_location=0.0024793777, statistic_sign=1),
                                140000: KstestResult(statistic=0.2983285714285714, pvalue=0.0, statistic_location=0.0024737385, statistic_sign=1),
                                150000: KstestResult(statistic=0.29842666666666673, pvalue=0.0, statistic_location=0.0027454956, statistic_sign=1),
                                160000: KstestResult(statistic=0.2998375, pvalue=0.0, statistic_location=0.0027130833, statistic_sign=1),
                                170000: KstestResult(statistic=0.2958647058823529, pvalue=0.0, statistic_location=0.0026923637, statistic_sign=1),
                                180000: KstestResult(statistic=0.29613888888888895, pvalue=0.0, statistic_location=0.0026713707, statistic_sign=1),
                                190000: KstestResult(statistic=0.29722105263157894, pvalue=0.0, statistic_location=0.0026708362, statistic_sign=1),
                                200000: KstestResult(statistic=0.295015, pvalue=0.0, statistic_location=0.0025909105, statistic_sign=1),
                                210000: KstestResult(statistic=0.2983809523809524, pvalue=0.0, statistic_location=0.0025860744, statistic_sign=1),
                                220000: KstestResult(statistic=0.29760909090909093, pvalue=0.0, statistic_location=0.002479752, statistic_sign=1),
                                230000: KstestResult(statistic=0.29756521739130437, pvalue=0.0, statistic_location=0.0026940443, statistic_sign=1),
                                240000: KstestResult(statistic=0.30055, pvalue=0.0, statistic_location=0.0026812656, statistic_sign=1),
                                250000: KstestResult(statistic=0.29733200000000004, pvalue=0.0, statistic_location=0.0024730314, statistic_sign=1),
                                260000: KstestResult(statistic=0.2965, pvalue=0.0, statistic_location=0.0024797595, statistic_sign=1),
                                270000: KstestResult(statistic=0.29979629629629634, pvalue=0.0, statistic_location=0.0027158791, statistic_sign=1),
                                280000: KstestResult(statistic=0.2980964285714286, pvalue=0.0, statistic_location=0.002480932, statistic_sign=1),
                                290000: KstestResult(statistic=0.29664137931034484, pvalue=0.0, statistic_location=0.0027017037, statistic_sign=1),
                                300000: KstestResult(statistic=0.2989200000000001, pvalue=0.0, statistic_location=0.002441475, statistic_sign=1),
                                310000: KstestResult(statistic=0.297241935483871, pvalue=0.0, statistic_location=0.0026712222, statistic_sign=1),
                                320000: KstestResult(statistic=0.29771875000000003, pvalue=0.0, statistic_location=0.0026984368, statistic_sign=1),
                                330000: KstestResult(statistic=0.2981060606060607, pvalue=0.0, statistic_location=0.0026708525, statistic_sign=1)},
                   'moments': {'mean_error': 0.19105278,
                               'means': [0.00036934364, -8.329336e-06],
                               'stds': [0.015899327, 0.0034673205],
                               'variance_ratio': 18.36739}},
 'originals': {'gan': {'mae': 0.024683471769094467,
                       'mse': 0.0012824181467294693,
                       'psnr': 30.239980697631836,
                       'rmse': 0.035810865461826324,
                       'ssim': 0.9119837880134583},
               'pca': {'mae': 0.004511421546339989,
                       'mse': 6.277386273723096e-05,
                       'psnr': 43.7479362487793,
                       'rmse': 0.007922995835542679,
                       'ssim': 0.9978827834129333}},
 'reconstructions': {'mae': 0.023988530039787292,
                     'mse': 0.0012190748238936067,
                     'psnr': 30.86541748046875,
                     'rmse': 0.0349152535200119,
                     'ssim': 0.9135103225708008},
 'residual_spectra_pcagan': {'cosine': [0.36591887,
                                        0.41669467,
                                        0.37670833,
                                        0.081162594,
                                        0.07568913,
                                        0.04268386,
                                        0.08121109,
                                        0.08690189,
                                        0.046491284,
                                        0.02614287,
                                        0.041574094,
                                        0.03020438,
                                        0.06974978,
                                        0.05539083,
                                        0.023574192,
                                        0.021912558,
                                        0.031097865,
                                        0.03867068,
                                        0.062546365,
                                        0.10545353,
                                        0.10615965,
                                        0.055069994,
                                        0.102892816,
                                        0.33944216,
                                        0.39727187,
                                        0.36916012,
                                        0.22673622,
                                        0.4264117,
                                        0.34267575,
                                        0.26062724,
                                        0.34110108,
                                        0.34725893,
                                        0.41105726],
                             'mae': [0.008686667,
                                     0.007984715,
                                     0.008219185,
                                     0.009768398,
                                     0.009359628,
                                     0.011141846,
                                     0.01054888,
                                     0.01141534,
                                     0.01231694,
                                     0.012601291,
                                     0.01100196,
                                     0.011000483,
                                     0.01147078,
                                     0.010213616,
                                     0.011372383,
                                     0.011471422,
                                     0.011443486,
                                     0.010741251,
                                     0.009335608,
                                     0.009737095,
                                     0.008813725,
                                     0.012330821,
                                     0.0098840725,
                                     0.009377622,
                                     0.008493939,
                                     0.008579321,
                                     0.010501915,
                                     0.007897864,
                                     0.0092604095,
                                     0.010262464,
                                     0.009096442,
                                     0.009681843,
                                     0.008023045],
                             'max_mae': 0.012601291,
                             'max_mse': 0.00047140455,
                             'max_rmse': 0.021711852,
                             'median_distance': 1.4716218,
                             'median_mae': 0.0098840725,
                             'min_cosine': 0.021912558,
                             'mse': [0.00020944423,
                                     0.00014719527,
                                     0.00018513452,
                                     0.00019819952,
                                     0.00016891657,
                                     0.00030888163,
                                     0.00021656704,
                                     0.00029552134,
                                     0.00047140455,
                                     0.00034885277,
                                     0.00028499545,
                                     0.0002576476,
                                     0.00029785067,
                                     0.0002021256,
                                     0.00026333137,
                                     0.00027606988,
                                     0.00029034493,
                                     0.00023307765,
                                     0.00016641803,
                                     0.0001842366,
                                     0.0001448339,
                                     0.0003787666,
                                     0.00019781974,
                                     0.00021229338,
                                     0.00015889826,
                                     0.0001764374,
                                     0.0003255397,
                                     0.00014632377,
                                     0.00022467355,
                                     0.00038935064,
                                     0.00023658173,
                                     0.00020804946,
                                     0.00014617977],
                             'rmse': [0.014472188,
                                      0.012132406,
                                      0.013606414,
                                      0.014078335,
                                      0.012996791,
                                      0.01757503,
                                      0.014716217,
                                      0.017190734,
                                      0.021711852,
                                      0.018677602,
                                      0.016881809,
                                      0.016051404,
                                      0.01725835,
                                      0.014217088,
                                      0.016227487,
                                      0.016615352,
                                      0.017039511,
                                      0.01526688,
                                      0.0129003115,
                                      0.013573378,
                                      0.012034696,
                                      0.019461926,
                                      0.014064841,
                                      0.014570291,
                                      0.0126054855,
                                      0.013282974,
                                      0.018042719,
                                      0.012096437,
                                      0.014989114,
                                      0.01973197,
                                      0.015381213,
                                      0.01442392,
                                      0.012090483]},
 'residuals': {'mae': 0.010061652399599552,
               'mse': 0.0002409685548627749,
               'psnr': 12.317355155944824,
               'rmse': 0.015523161739110947,
               'ssds': [83.46498, 3.9673738],
               'ssim': 0.386732816696167},
 'spectra_pcagan': {'cosine': [0.98403966,
                               0.98671925,
                               0.9838547,
                               0.99870384,
                               0.9987744,
                               0.9987011,
                               0.99829036,
                               0.99868166,
                               0.9983882,
                               0.99947155,
                               0.9990612,
                               0.999159,
                               0.99932086,
                               0.99925977,
                               0.9995951,
                               0.99976337,
                               0.9995601,
                               0.9995783,
                               0.9992253,
                               0.9984966,
                               0.99869126,
                               0.99775654,
                               0.96700686,
                               0.9960901,
                               0.98600227,
                               0.98295087,
                               0.9945448,
                               0.9906901,
                               0.9770212,
                               0.97941256,
                               0.98882675,
                               0.98552847,
                               0.9842698],
                    'mae': [0.027519455,
                            0.024817064,
                            0.02573598,
                            0.016633857,
                            0.017298011,
                            0.017909542,
                            0.02311042,
                            0.017587725,
                            0.020276742,
                            0.01470193,
                            0.016851114,
                            0.016433774,
                            0.015101304,
                            0.015395504,
                            0.013862227,
                            0.012073958,
                            0.013562989,
                            0.013157866,
                            0.015749926,
                            0.01720486,
                            0.016038332,
                            0.021050297,
                            0.11902165,
                            0.018848142,
                            0.027402814,
                            0.02969674,
                            0.02151153,
                            0.025649924,
                            0.040987756,
                            0.03763783,
                            0.02276857,
                            0.027574873,
                            0.02844876],
                    'max_mae': 0.11902165,
                    'max_mse': 0.015216115,
                    'max_rmse': 0.123353615,
                    'median_mae': 0.018848142,
                    'min_cosine': 0.96700686,
                    'mse': [0.0012348256,
                            0.0010177147,
                            0.001107616,
                            0.00046620492,
                            0.0004784459,
                            0.00055586494,
                            0.00079882593,
                            0.0005396603,
                            0.00076782814,
                            0.00038371922,
                            0.0004748766,
                            0.00043783092,
                            0.00039037556,
                            0.00039627394,
                            0.00030845052,
                            0.00024347081,
                            0.0003070681,
                            0.00027719652,
                            0.0004077458,
                            0.0004824265,
                            0.0004173131,
                            0.000765028,
                            0.015216115,
                            0.000633948,
                            0.001120864,
                            0.00129642,
                            0.00084263954,
                            0.0009890536,
                            0.0022727647,
                            0.0023323756,
                            0.0009049902,
                            0.0011465066,
                            0.0012150325],
                    'rmse': [0.035140086,
                             0.031901643,
                             0.033280864,
                             0.021591779,
                             0.021873407,
                             0.023576789,
                             0.02826351,
                             0.02323059,
                             0.027709711,
                             0.019588752,
                             0.021791663,
                             0.02092441,
                             0.019757925,
                             0.01990663,
                             0.01756276,
                             0.015603552,
                             0.01752336,
                             0.01664922,
                             0.020192716,
                             0.02196421,
                             0.020428242,
                             0.027659139,
                             0.123353615,
                             0.025178324,
                             0.033479307,
                             0.036005832,
                             0.029028254,
                             0.031449225,
                             0.047673523,
                             0.048294675,
                             0.030083055,
                             0.033860102,
                             0.034857318]},
 'spectra_realgan': {'cosine': [0.9814176,
                                0.98439723,
                                0.98138136,
                                0.9986946,
                                0.9987651,
                                0.99869525,
                                0.9982768,
                                0.9986743,
                                0.998383,
                                0.99947095,
                                0.99905765,
                                0.99915785,
                                0.9993173,
                                0.9992574,
                                0.99959475,
                                0.9997632,
                                0.99955946,
                                0.9995768,
                                0.99922174,
                                0.9984778,
                                0.9986743,
                                0.9977264,
                                0.96700376,
                                0.99548477,
                                0.98399085,
                                0.9809019,
                                0.99406934,
                                0.9890101,
                                0.97492045,
                                0.9770445,
                                0.9866514,
                                0.9837147,
                                0.9820852],
                     'mae': [0.029628485,
                             0.027002262,
                             0.027750028,
                             0.016724942,
                             0.01736095,
                             0.017963925,
                             0.023198504,
                             0.0176388,
                             0.020329475,
                             0.014715893,
                             0.016875878,
                             0.016449248,
                             0.015146671,
                             0.015429575,
                             0.013867969,
                             0.012076122,
                             0.0135708805,
                             0.013182069,
                             0.0157669,
                             0.017303076,
                             0.016132493,
                             0.02117233,
                             0.11901427,
                             0.02058437,
                             0.029043354,
                             0.031275086,
                             0.022661624,
                             0.027385285,
                             0.041743442,
                             0.039285272,
                             0.025128003,
                             0.02908132,
                             0.030066092],
                     'max_mae': 0.11901427,
                     'max_mse': 0.01521862,
                     'max_rmse': 0.12336377,
                     'median_mae': 0.020329475,
                     'min_cosine': 0.96700376,
                     'mse': [0.0014244348,
                             0.0011916796,
                             0.0012814311,
                             0.00047000826,
                             0.00048251904,
                             0.00055835105,
                             0.00080453156,
                             0.000542524,
                             0.00076979655,
                             0.00038417903,
                             0.00047643276,
                             0.00043857764,
                             0.00039242802,
                             0.00039765734,
                             0.00030882115,
                             0.00024363771,
                             0.00030758177,
                             0.00027812886,
                             0.0004091179,
                             0.00048807808,
                             0.00042269478,
                             0.0007709866,
                             0.01521862,
                             0.0007337454,
                             0.0012791611,
                             0.0014532699,
                             0.0009157287,
                             0.0011495663,
                             0.002437682,
                             0.002542249,
                             0.0010732923,
                             0.0012943266,
                             0.0013785576],
                     'rmse': [0.037741687,
                              0.03452071,
                              0.035797082,
                              0.021679673,
                              0.021966316,
                              0.023629453,
                              0.028364265,
                              0.023292145,
                              0.027745208,
                              0.019600486,
                              0.02182734,
                              0.020942245,
                              0.019809796,
                              0.019941347,
                              0.017573308,
                              0.015608898,
                              0.01753801,
                              0.016677195,
                              0.020226663,
                              0.02209249,
                              0.020559542,
                              0.027766645,
                              0.12336377,
                              0.027087735,
                              0.03576536,
                              0.038121775,
                              0.03026101,
                              0.033905253,
                              0.049372885,
                              0.05042072,
                              0.03276114,
                              0.035976753,
                              0.037128933]},
 'spectra_realpca': {'cosine': [0.9974765,
                                0.9977139,
                                0.99735165,
                                0.99999285,
                                0.9999931,
                                0.9999959,
                                0.9999905,
                                0.99999493,
                                0.9999957,
                                0.99999964,
                                0.9999955,
                                0.9999984,
                                0.999998,
                                0.999998,
                                0.9999998,
                                0.99999976,
                                0.9999996,
                                0.99999887,
                                0.9999959,
                                0.99998003,
                                0.99998254,
                                0.9999668,
                                0.99997497,
                                0.99945354,
                                0.99794143,
                                0.9978243,
                                0.9995819,
                                0.9983957,
                                0.9978401,
                                0.99765503,
                                0.9978583,
                                0.9979469,
                                0.9977403],
                     'mae': [0.010619623,
                             0.010192803,
                             0.010760511,
                             0.0012117109,
                             0.0012294778,
                             0.0010208152,
                             0.0013918608,
                             0.0011314808,
                             0.0010755461,
                             0.00037516898,
                             0.001093624,
                             0.000708161,
                             0.000847175,
                             0.0008210433,
                             0.00037984093,
                             0.00027192393,
                             0.0004261042,
                             0.00068271597,
                             0.0010819895,
                             0.0019556736,
                             0.0018587187,
                             0.0023641894,
                             0.001998979,
                             0.0074547026,
                             0.009930983,
                             0.010122644,
                             0.006360699,
                             0.009658667,
                             0.010085696,
                             0.011205592,
                             0.01020257,
                             0.010164411,
                             0.010191803],
                     'max_mae': 0.011205592,
                     'max_mse': 0.00020151524,
                     'max_rmse': 0.014195606,
                     'median_mae': 0.0018587187,
                     'min_cosine': 0.99735165,
                     'mse': [0.00018019922,
                             0.0001687812,
                             0.00018374663,
                             2.3483942e-06,
                             2.426089e-06,
                             1.6629427e-06,
                             3.090866e-06,
                             2.0303992e-06,
                             1.8544894e-06,
                             2.251933e-07,
                             1.912855e-06,
                             8.1227256e-07,
                             1.1529735e-06,
                             1.0807383e-06,
                             2.3085056e-07,
                             1.1916284e-07,
                             2.9361973e-07,
                             7.486411e-07,
                             1.8715957e-06,
                             6.166895e-06,
                             5.5671458e-06,
                             8.927089e-06,
                             6.3771145e-06,
                             8.890028e-05,
                             0.00015982738,
                             0.00016370346,
                             6.468661e-05,
                             0.00015085991,
                             0.00016300303,
                             0.00020151524,
                             0.00016708198,
                             0.00016409552,
                             0.00016623765],
                     'rmse': [0.01342383,
                              0.012991582,
                              0.013555317,
                              0.0015324472,
                              0.0015575908,
                              0.0012895514,
                              0.0017580859,
                              0.0014249207,
                              0.0013617964,
                              0.00047454538,
                              0.00138306,
                              0.00090126164,
                              0.001073766,
                              0.0010395857,
                              0.0004804691,
                              0.00034519972,
                              0.0005418669,
                              0.0008652405,
                              0.0013680628,
                              0.0024833234,
                              0.00235948,
                              0.0029878234,
                              0.002525295,
                              0.009428694,
                              0.012642286,
                              0.012794665,
                              0.008042798,
                              0.012282504,
                              0.012767264,
                              0.014195606,
                              0.01292602,
                              0.012809977,
                              0.012893318]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_60.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734
Directory path: experiments/inpainting/gann_4_night_20210905_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_60.0/images
Optimal number of principal components:  28
Reconstruction error:  6.7930813
Energy conservation:  0.6131775
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_60.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.8998554886731998, 2.6425672930801873],
                   'kl_div': 0.6867315,
                   'ks_tests': {10000: KstestResult(statistic=0.2618, pvalue=1.4363406723943175e-301, statistic_location=-0.004269872, statistic_sign=-1),
                                20000: KstestResult(statistic=0.25895, pvalue=0.0, statistic_location=-0.004142128, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2623666666666667, pvalue=0.0, statistic_location=-0.0046205893, statistic_sign=-1),
                                40000: KstestResult(statistic=0.2662, pvalue=0.0, statistic_location=-0.0042335205, statistic_sign=-1),
                                50000: KstestResult(statistic=0.26486, pvalue=0.0, statistic_location=-0.0043824054, statistic_sign=-1),
                                60000: KstestResult(statistic=0.26311666666666667, pvalue=0.0, statistic_location=-0.0050241444, statistic_sign=-1),
                                70000: KstestResult(statistic=0.26232857142857147, pvalue=0.0, statistic_location=-0.0041256193, statistic_sign=-1),
                                80000: KstestResult(statistic=0.26205, pvalue=0.0, statistic_location=-0.004233919, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2655222222222222, pvalue=0.0, statistic_location=-0.0042335205, statistic_sign=-1),
                                100000: KstestResult(statistic=0.26341, pvalue=0.0, statistic_location=-0.0042874534, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2629909090909091, pvalue=0.0, statistic_location=-0.0043902355, statistic_sign=-1)},
                   'moments': {'mean_error': -0.32418114,
                               'means': [-0.0013864677, 6.961706e-06],
                               'stds': [0.016771028, 0.0036045236],
                               'variance_ratio': 15.5195}},
 'originals': {'gan': {'mae': 0.023048721253871918,
                       'mse': 0.0009046081686392426,
                       'psnr': 30.321165084838867,
                       'rmse': 0.030076704919338226,
                       'ssim': 0.9525943994522095},
               'pca': {'mae': 0.005761108361184597,
                       'mse': 6.838887929916382e-05,
                       'psnr': 42.014610290527344,
                       'rmse': 0.00826975703239441,
                       'ssim': 0.9962387084960938}},
 'reconstructions': {'mae': 0.022083519026637077,
                     'mse': 0.0008356329053640366,
                     'psnr': 31.144309997558594,
                     'rmse': 0.02890731580555439,
                     'ssim': 0.956195056438446},
 'residual_spectra_pcagan': {'cosine': [0.0662772,
                                        0.058656793,
                                        0.06920461,
                                        0.1953486,
                                        0.17704903,
                                        0.20999576,
                                        0.26439,
                                        0.32250065,
                                        0.25442615,
                                        0.2965474,
                                        0.2614998],
                             'mae': [0.0105721215,
                                     0.011905815,
                                     0.0101262005,
                                     0.010894784,
                                     0.010751303,
                                     0.0096106,
                                     0.009940818,
                                     0.00837287,
                                     0.009392776,
                                     0.010269071,
                                     0.01034126],
                             'max_mae': 0.011905815,
                             'max_mse': 0.0003946946,
                             'max_rmse': 0.019866923,
                             'median_distance': 1.6290784,
                             'median_mae': 0.010269071,
                             'min_cosine': 0.058656793,
                             'mse': [0.00023305099,
                                     0.00037817942,
                                     0.00023548829,
                                     0.00027016687,
                                     0.0003946946,
                                     0.00026538968,
                                     0.00023081117,
                                     0.00015678868,
                                     0.00029087948,
                                     0.0002401705,
                                     0.0002814039],
                             'rmse': [0.015266008,
                                      0.019446835,
                                      0.015345627,
                                      0.016436754,
                                      0.019866923,
                                      0.016290786,
                                      0.0151924705,
                                      0.012521529,
                                      0.01705519,
                                      0.015497435,
                                      0.016775098]},
 'residuals': {'mae': 0.010197965428233147,
               'mse': 0.0002706384693738073,
               'psnr': 8.653989791870117,
               'rmse': 0.016451092436909676,
               'ssds': [31.150585, 1.4291774],
               'ssim': 0.3481750190258026},
 'spectra_pcagan': {'cosine': [0.99846405,
                               0.9986621,
                               0.99808913,
                               0.9956512,
                               0.9946229,
                               0.9961378,
                               0.98504674,
                               0.9856633,
                               0.98721814,
                               0.98828906,
                               0.9896073],
                    'mae': [0.017726012,
                            0.01753389,
                            0.01760382,
                            0.024307374,
                            0.02279856,
                            0.019206317,
                            0.026257923,
                            0.025698345,
                            0.023268705,
                            0.02332468,
                            0.025193097],
                    'max_mae': 0.026257923,
                    'max_mse': 0.0011254288,
                    'max_rmse': 0.033547413,
                    'median_mae': 0.023268705,
                    'min_cosine': 0.98504674,
                    'mse': [0.00052490586,
                            0.0005364529,
                            0.0005145521,
                            0.0009622818,
                            0.00086705334,
                            0.00067611923,
                            0.0011254288,
                            0.0010415596,
                            0.0009508432,
                            0.0009435993,
                            0.001049166],
                    'rmse': [0.022910824,
                             0.023161454,
                             0.022683742,
                             0.031020667,
                             0.02944577,
                             0.026002293,
                             0.033547413,
                             0.032273203,
                             0.030835746,
                             0.030718062,
                             0.032390833]},
 'spectra_realgan': {'cosine': [0.99845815,
                                0.99865544,
                                0.9980743,
                                0.99538624,
                                0.9942768,
                                0.9958385,
                                0.9834681,
                                0.9838169,
                                0.9854402,
                                0.98703146,
                                0.9884645],
                     'mae': [0.017761227,
                             0.017582031,
                             0.0176733,
                             0.024944736,
                             0.023610482,
                             0.020209933,
                             0.027730133,
                             0.027510053,
                             0.02518444,
                             0.024926346,
                             0.02640324],
                     'max_mae': 0.027730133,
                     'max_mse': 0.0012458147,
                     'max_rmse': 0.0352961,
                     'median_mae': 0.024926346,
                     'min_cosine': 0.9834681,
                     'mse': [0.00052664767,
                             0.000539212,
                             0.00051849784,
                             0.001009169,
                             0.0009227619,
                             0.00072644174,
                             0.0012458147,
                             0.0011789299,
                             0.0010824356,
                             0.0010481058,
                             0.0011526741],
                     'rmse': [0.022948805,
                              0.02322094,
                              0.022770548,
                              0.03176742,
                              0.030376997,
                              0.026952583,
                              0.0352961,
                              0.03433555,
                              0.03290039,
                              0.03237446,
                              0.033951055]},
 'spectra_realpca': {'cosine': [0.9999918,
                                0.99999464,
                                0.9999887,
                                0.9997638,
                                0.999728,
                                0.99969655,
                                0.9983082,
                                0.99823964,
                                0.9983034,
                                0.99853027,
                                0.9987859],
                     'mae': [0.0013046577,
                             0.0011456523,
                             0.0013737977,
                             0.0050445437,
                             0.0052169915,
                             0.0055773826,
                             0.00896542,
                             0.008970706,
                             0.008848505,
                             0.008616626,
                             0.008307909],
                     'max_mae': 0.008970706,
                     'max_mse': 0.00012915759,
                     'max_rmse': 0.011364752,
                     'median_mae': 0.0055773826,
                     'min_cosine': 0.99823964,
                     'mse': [2.7094015e-06,
                             2.1067385e-06,
                             3.0346202e-06,
                             4.10429e-05,
                             4.3652315e-05,
                             5.01522e-05,
                             0.00012830622,
                             0.00012915759,
                             0.00012507183,
                             0.00011748688,
                             0.00010955694],
                     'rmse': [0.001646026,
                              0.0014514609,
                              0.0017420162,
                              0.006406473,
                              0.00660699,
                              0.007081822,
                              0.011327233,
                              0.011364752,
                              0.0111835515,
                              0.010839136,
                              0.010466945]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_60.0

Running comparison for experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726
Directory path: experiments/inpainting/gann_4_night_20210905_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_60.0/images
Optimal number of principal components:  28
Reconstruction error:  6.7930813
Energy conservation:  0.6131775
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_60.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9022391383209563, 2.6649190142651946],
                   'kl_div': 0.6597501,
                   'ks_tests': {10000: KstestResult(statistic=0.2616, pvalue=4.194493523049377e-301, statistic_location=-0.0045574615, statistic_sign=-1),
                                20000: KstestResult(statistic=0.2707, pvalue=0.0, statistic_location=-0.004310336, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2644666666666667, pvalue=0.0, statistic_location=-0.004760882, statistic_sign=-1),
                                40000: KstestResult(statistic=0.267525, pvalue=0.0, statistic_location=-0.004251229, statistic_sign=-1),
                                50000: KstestResult(statistic=0.26646000000000003, pvalue=0.0, statistic_location=-0.004744321, statistic_sign=-1),
                                60000: KstestResult(statistic=0.26846666666666663, pvalue=0.0, statistic_location=-0.0045465715, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2669, pvalue=0.0, statistic_location=-0.0046997685, statistic_sign=-1),
                                80000: KstestResult(statistic=0.2653125, pvalue=0.0, statistic_location=-0.0047293697, statistic_sign=-1),
                                90000: KstestResult(statistic=0.26416666666666666, pvalue=0.0, statistic_location=-0.0047988435, statistic_sign=-1),
                                100000: KstestResult(statistic=0.26413, pvalue=0.0, statistic_location=-0.0045659672, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2631727272727273, pvalue=0.0, statistic_location=-0.0042523686, statistic_sign=-1),
                                120000: KstestResult(statistic=0.26387499999999997, pvalue=0.0, statistic_location=-0.004519377, statistic_sign=-1),
                                130000: KstestResult(statistic=0.26576923076923076, pvalue=0.0, statistic_location=-0.004747536, statistic_sign=-1),
                                140000: KstestResult(statistic=0.26594285714285715, pvalue=0.0, statistic_location=-0.0045235734, statistic_sign=-1),
                                150000: KstestResult(statistic=0.2633933333333333, pvalue=0.0, statistic_location=-0.004518953, statistic_sign=-1),
                                160000: KstestResult(statistic=0.26616874999999995, pvalue=0.0, statistic_location=-0.004660787, statistic_sign=-1),
                                170000: KstestResult(statistic=0.2644941176470589, pvalue=0.0, statistic_location=-0.004472609, statistic_sign=-1),
                                180000: KstestResult(statistic=0.26500555555555555, pvalue=0.0, statistic_location=-0.0045238445, statistic_sign=-1),
                                190000: KstestResult(statistic=0.2664263157894737, pvalue=0.0, statistic_location=-0.0044715153, statistic_sign=-1),
                                200000: KstestResult(statistic=0.26598, pvalue=0.0, statistic_location=-0.004518953, statistic_sign=-1),
                                210000: KstestResult(statistic=0.26725714285714286, pvalue=0.0, statistic_location=-0.0045111263, statistic_sign=-1),
                                220000: KstestResult(statistic=0.2666045454545455, pvalue=0.0, statistic_location=-0.004518953, statistic_sign=-1)},
                   'moments': {'mean_error': -0.31330088,
                               'means': [-0.0014589109, 1.1685978e-05],
                               'stds': [0.01597184, 0.0037167042],
                               'variance_ratio': 13.745506}},
 'originals': {'gan': {'mae': 0.029288172721862793,
                       'mse': 0.001597895403392613,
                       'psnr': 30.15612030029297,
                       'rmse': 0.03997368365526199,
                       'ssim': 0.8410302996635437},
               'pca': {'mae': 0.00634814752265811,
                       'mse': 8.409188740188256e-05,
                       'psnr': 42.99001693725586,
                       'rmse': 0.009170162491500378,
                       'ssim': 0.9922840595245361}},
 'reconstructions': {'mae': 0.028259921818971634,
                     'mse': 0.0015143818454816937,
                     'psnr': 30.435205459594727,
                     'rmse': 0.038915060460567474,
                     'ssim': 0.8442025184631348},
 'residual_spectra_pcagan': {'cosine': [0.320315,
                                        0.22796918,
                                        0.034581844,
                                        0.03852909,
                                        0.065233104,
                                        0.06324811,
                                        0.064163804,
                                        0.07905466,
                                        0.20870447,
                                        0.19255996,
                                        0.24837713,
                                        0.3014532,
                                        0.36426035,
                                        0.2647807,
                                        0.29826698,
                                        0.27893806,
                                        0.2777678,
                                        0.2688474,
                                        0.32406974,
                                        0.32035393,
                                        0.25495112,
                                        0.23736845],
                             'mae': [0.009465658,
                                     0.009389786,
                                     0.01174751,
                                     0.01268894,
                                     0.0111230565,
                                     0.009938023,
                                     0.011297296,
                                     0.009609731,
                                     0.010470169,
                                     0.010612662,
                                     0.0089400895,
                                     0.009262896,
                                     0.007813184,
                                     0.0092311865,
                                     0.010265981,
                                     0.00988066,
                                     0.008422273,
                                     0.01039581,
                                     0.008513148,
                                     0.008722492,
                                     0.010166195,
                                     0.0109393755],
                             'max_mae': 0.01268894,
                             'max_mse': 0.00040853157,
                             'max_rmse': 0.020212164,
                             'median_distance': 1.5646597,
                             'median_mae': 0.009909341,
                             'min_cosine': 0.034581844,
                             'mse': [0.00019613316,
                                     0.00024882943,
                                     0.00040853157,
                                     0.00031502722,
                                     0.00029139343,
                                     0.00019875112,
                                     0.00032144733,
                                     0.00019464499,
                                     0.00023848553,
                                     0.00033730487,
                                     0.00020386875,
                                     0.00017387018,
                                     0.00012264226,
                                     0.00026176896,
                                     0.0002427808,
                                     0.00024700785,
                                     0.00021101789,
                                     0.00024685968,
                                     0.00015020947,
                                     0.00017713284,
                                     0.00030778442,
                                     0.00027359795],
                             'rmse': [0.014004755,
                                      0.015774328,
                                      0.020212164,
                                      0.017749006,
                                      0.01707025,
                                      0.014097912,
                                      0.017928952,
                                      0.013951523,
                                      0.015442977,
                                      0.018365862,
                                      0.014278262,
                                      0.013185984,
                                      0.011074397,
                                      0.016179275,
                                      0.015581425,
                                      0.015716484,
                                      0.014526455,
                                      0.01571177,
                                      0.012255997,
                                      0.013309126,
                                      0.017543785,
                                      0.016540797]},
 'residuals': {'mae': 0.009949823841452599,
               'mse': 0.00024404954456258565,
               'psnr': 15.06283950805664,
               'rmse': 0.015622084960341454,
               'ssds': [56.58993, 3.0390723],
               'ssim': 0.3882843554019928},
 'spectra_pcagan': {'cosine': [0.99211884,
                               0.991179,
                               0.9871878,
                               0.99796945,
                               0.99890643,
                               0.9984696,
                               0.9986108,
                               0.99805635,
                               0.995471,
                               0.99401206,
                               0.99611735,
                               0.98485446,
                               0.98547417,
                               0.9864508,
                               0.9871745,
                               0.98850965,
                               0.9898651,
                               0.9819531,
                               0.99057907,
                               0.9921622,
                               0.98763174,
                               0.98655206],
                    'mae': [0.0322963,
                            0.024462197,
                            0.10236344,
                            0.023026928,
                            0.018337034,
                            0.017630206,
                            0.017837835,
                            0.017877962,
                            0.02474161,
                            0.024546348,
                            0.02023602,
                            0.02660238,
                            0.026136896,
                            0.024382126,
                            0.02489181,
                            0.025787534,
                            0.02437441,
                            0.03180961,
                            0.02805062,
                            0.027035065,
                            0.02834923,
                            0.030942826],
                    'max_mae': 0.10236344,
                    'max_mse': 0.011338155,
                    'max_rmse': 0.10648077,
                    'median_mae': 0.02481671,
                    'min_cosine': 0.9819531,
                    'mse': [0.0014669909,
                            0.0010136582,
                            0.011338155,
                            0.00085867365,
                            0.00056526356,
                            0.0005183145,
                            0.0005539607,
                            0.00052857545,
                            0.0009848493,
                            0.00097136403,
                            0.0007208773,
                            0.0011385474,
                            0.0010602402,
                            0.0010311819,
                            0.0010493416,
                            0.0010906273,
                            0.0010293883,
                            0.0016786876,
                            0.0013552922,
                            0.0013110216,
                            0.0014319583,
                            0.0016194336],
                    'rmse': [0.03830132,
                             0.031838,
                             0.10648077,
                             0.029303133,
                             0.023775272,
                             0.022766521,
                             0.02353637,
                             0.022990769,
                             0.031382307,
                             0.031166714,
                             0.026849158,
                             0.03374237,
                             0.03256133,
                             0.03211202,
                             0.032393545,
                             0.033024646,
                             0.03208408,
                             0.04097179,
                             0.03681429,
                             0.036208034,
                             0.037841223,
                             0.040242188]},
 'spectra_realgan': {'cosine': [0.9912347,
                                0.99026316,
                                0.9871963,
                                0.99796176,
                                0.99890083,
                                0.99846447,
                                0.99860394,
                                0.99804103,
                                0.99520475,
                                0.9936569,
                                0.9958095,
                                0.98329765,
                                0.9835999,
                                0.984698,
                                0.9859396,
                                0.9873891,
                                0.98822236,
                                0.98030156,
                                0.98952353,
                                0.99124986,
                                0.9861594,
                                0.98525864],
                     'mae': [0.033294223,
                             0.025828766,
                             0.10232119,
                             0.023086667,
                             0.018353976,
                             0.017655889,
                             0.017890586,
                             0.017944146,
                             0.025359493,
                             0.025303021,
                             0.02115929,
                             0.028000534,
                             0.02790281,
                             0.026169525,
                             0.026349448,
                             0.026940206,
                             0.026175488,
                             0.033334527,
                             0.029743722,
                             0.0290685,
                             0.029867712,
                             0.032590088],
                     'max_mae': 0.10232119,
                     'max_mse': 0.011329362,
                     'max_rmse': 0.10643948,
                     'median_mae': 0.026262468,
                     'min_cosine': 0.98030156,
                     'mse': [0.0015887473,
                             0.0011122684,
                             0.011329362,
                             0.0008626093,
                             0.00056718534,
                             0.000519867,
                             0.0005567879,
                             0.0005326666,
                             0.0010319458,
                             0.0010287849,
                             0.0007730675,
                             0.0012570083,
                             0.0011995912,
                             0.0011607567,
                             0.0011529385,
                             0.0011925612,
                             0.0011627872,
                             0.0018270607,
                             0.0015063379,
                             0.001459091,
                             0.0015643693,
                             0.0017679054],
                     'rmse': [0.039859094,
                              0.033350687,
                              0.10643948,
                              0.029370211,
                              0.023815654,
                              0.022800593,
                              0.023596354,
                              0.023079572,
                              0.032123912,
                              0.03207468,
                              0.027804092,
                              0.035454314,
                              0.034635115,
                              0.03406988,
                              0.03395495,
                              0.03453348,
                              0.034099665,
                              0.04274413,
                              0.03881157,
                              0.03819805,
                              0.039552107,
                              0.04204647]},
 'spectra_realpca': {'cosine': [0.999258,
                                0.99906,
                                0.99999464,
                                0.9999972,
                                0.99999535,
                                0.9999918,
                                0.99999464,
                                0.9999887,
                                0.9997638,
                                0.999728,
                                0.99969655,
                                0.9983082,
                                0.99823964,
                                0.9983034,
                                0.99853027,
                                0.9987859,
                                0.99834114,
                                0.9983919,
                                0.99883205,
                                0.9990178,
                                0.998443,
                                0.9986611],
                     'mae': [0.007684581,
                             0.007808519,
                             0.001063194,
                             0.00081662444,
                             0.0011040997,
                             0.0013046577,
                             0.0011456523,
                             0.0013737977,
                             0.0050445437,
                             0.0052169915,
                             0.0055773826,
                             0.00896542,
                             0.008970706,
                             0.008848505,
                             0.008616626,
                             0.008307909,
                             0.009180669,
                             0.0093936175,
                             0.010009118,
                             0.010039052,
                             0.009444207,
                             0.009743359],
                     'max_mae': 0.010039052,
                     'max_mse': 0.00016530833,
                     'max_rmse': 0.0128572285,
                     'median_mae': 0.008058214,
                     'min_cosine': 0.99823964,
                     'mse': [9.453417e-05,
                             9.815651e-05,
                             1.7978948e-06,
                             1.063919e-06,
                             1.9370843e-06,
                             2.7094015e-06,
                             2.1067385e-06,
                             3.0346202e-06,
                             4.10429e-05,
                             4.3652315e-05,
                             5.01522e-05,
                             0.00012830622,
                             0.00012915759,
                             0.00012507183,
                             0.00011748688,
                             0.00010955694,
                             0.00013540775,
                             0.00014234506,
                             0.00016530833,
                             0.00016251595,
                             0.00014252077,
                             0.00015215666],
                     'rmse': [0.009722868,
                              0.0099073965,
                              0.001340856,
                              0.0010314644,
                              0.0013917917,
                              0.001646026,
                              0.0014514609,
                              0.0017420162,
                              0.006406473,
                              0.00660699,
                              0.007081822,
                              0.011327233,
                              0.011364752,
                              0.0111835515,
                              0.010839136,
                              0.010466945,
                              0.0116364835,
                              0.011930845,
                              0.0128572285,
                              0.012748174,
                              0.011938207,
                              0.012335179]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_60.0

Running comparison for experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226
Directory path: experiments/inpainting/gann_4_night_20210905_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 60.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_60.0/images
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_60.0/images
Optimal number of principal components:  28
Reconstruction error:  6.7930813
Energy conservation:  0.6131775
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_60.0
saved spectra in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_60.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_60.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_60.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.867696224533345, 2.5780190324027368],
                   'kl_div': 0.7021561,
                   'ks_tests': {10000: KstestResult(statistic=0.2527, pvalue=9.057684509553072e-281, statistic_location=-0.004773925, statistic_sign=-1),
                                20000: KstestResult(statistic=0.25875000000000004, pvalue=0.0, statistic_location=-0.0038446272, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2578666666666667, pvalue=0.0, statistic_location=-0.0040832423, statistic_sign=-1),
                                40000: KstestResult(statistic=0.257375, pvalue=0.0, statistic_location=-0.003743106, statistic_sign=-1),
                                50000: KstestResult(statistic=0.25596, pvalue=0.0, statistic_location=-0.0042185127, statistic_sign=-1),
                                60000: KstestResult(statistic=0.26266666666666666, pvalue=0.0, statistic_location=-0.004100664, statistic_sign=-1),
                                70000: KstestResult(statistic=0.25645714285714283, pvalue=0.0, statistic_location=-0.0038414332, statistic_sign=-1),
                                80000: KstestResult(statistic=0.25835, pvalue=0.0, statistic_location=-0.0035994668, statistic_sign=-1),
                                90000: KstestResult(statistic=0.25980000000000003, pvalue=0.0, statistic_location=-0.0040130327, statistic_sign=-1),
                                100000: KstestResult(statistic=0.25668, pvalue=0.0, statistic_location=-0.0042976676, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2574272727272727, pvalue=0.0, statistic_location=-0.0039853454, statistic_sign=-1),
                                120000: KstestResult(statistic=0.2578583333333333, pvalue=0.0, statistic_location=-0.0038427939, statistic_sign=-1),
                                130000: KstestResult(statistic=0.2575615384615385, pvalue=0.0, statistic_location=-0.004046646, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2568142857142857, pvalue=0.0, statistic_location=-0.004247858, statistic_sign=-1),
                                150000: KstestResult(statistic=0.2577533333333334, pvalue=0.0, statistic_location=-0.004144229, statistic_sign=-1),
                                160000: KstestResult(statistic=0.25846875, pvalue=0.0, statistic_location=-0.004022549, statistic_sign=-1),
                                170000: KstestResult(statistic=0.25831176470588235, pvalue=0.0, statistic_location=-0.0038386583, statistic_sign=-1),
                                180000: KstestResult(statistic=0.2582611111111111, pvalue=0.0, statistic_location=-0.0040138178, statistic_sign=-1),
                                190000: KstestResult(statistic=0.2586421052631579, pvalue=0.0, statistic_location=-0.0040505826, statistic_sign=-1),
                                200000: KstestResult(statistic=0.257545, pvalue=0.0, statistic_location=-0.0039127693, statistic_sign=-1),
                                210000: KstestResult(statistic=0.2571190476190476, pvalue=0.0, statistic_location=-0.0037658587, statistic_sign=-1),
                                220000: KstestResult(statistic=0.2581590909090909, pvalue=0.0, statistic_location=-0.004046646, statistic_sign=-1),
                                230000: KstestResult(statistic=0.25808695652173913, pvalue=0.0, statistic_location=-0.0040229764, statistic_sign=-1),
                                240000: KstestResult(statistic=0.25923333333333337, pvalue=0.0, statistic_location=-0.003943459, statistic_sign=-1),
                                250000: KstestResult(statistic=0.25898, pvalue=0.0, statistic_location=-0.0040025758, statistic_sign=-1),
                                260000: KstestResult(statistic=0.25911153846153845, pvalue=0.0, statistic_location=-0.0040466823, statistic_sign=-1),
                                270000: KstestResult(statistic=0.25623703703703704, pvalue=0.0, statistic_location=-0.004036177, statistic_sign=-1),
                                280000: KstestResult(statistic=0.25796428571428576, pvalue=0.0, statistic_location=-0.0040466525, statistic_sign=-1),
                                290000: KstestResult(statistic=0.2585310344827586, pvalue=0.0, statistic_location=-0.0040460005, statistic_sign=-1),
                                300000: KstestResult(statistic=0.25698, pvalue=0.0, statistic_location=-0.0040130327, statistic_sign=-1),
                                310000: KstestResult(statistic=0.2565516129032258, pvalue=0.0, statistic_location=-0.0040999036, statistic_sign=-1),
                                320000: KstestResult(statistic=0.25913125000000004, pvalue=0.0, statistic_location=-0.0040467605, statistic_sign=-1),
                                330000: KstestResult(statistic=0.2567121212121212, pvalue=0.0, statistic_location=-0.0040454697, statistic_sign=-1)},
                   'moments': {'mean_error': -0.13140124,
                               'means': [-0.00065364566, -5.5195974e-06],
                               'stds': [0.015172766, 0.003506582],
                               'variance_ratio': 15.177069}},
 'originals': {'gan': {'mae': 0.04760230705142021,
                       'mse': 0.01523522287607193,
                       'psnr': 23.570749282836914,
                       'rmse': 0.12343104183673859,
                       'ssim': 0.8455835580825806},
               'pca': {'mae': 0.005800307262688875,
                       'mse': 7.515466859331354e-05,
                       'psnr': 46.9003791809082,
                       'rmse': 0.008669178932905197,
                       'ssim': 0.993747889995575}},
 'reconstructions': {'mae': 0.04676077142357826,
                     'mse': 0.01516706869006157,
                     'psnr': 23.850923538208008,
                     'rmse': 0.1231546550989151,
                     'ssim': 0.8488420248031616},
 'residual_spectra_pcagan': {'cosine': [0.24282773,
                                        0.054967277,
                                        0.10948592,
                                        0.038156506,
                                        0.070423454,
                                        0.07128466,
                                        0.3592156,
                                        0.2544247,
                                        0.03919631,
                                        0.042499498,
                                        0.064483844,
                                        0.06161568,
                                        0.06830069,
                                        0.08642891,
                                        0.22112437,
                                        0.20334631,
                                        0.2564592,
                                        0.32808253,
                                        0.38723463,
                                        0.2952955,
                                        0.3194603,
                                        0.29062393,
                                        0.30017185,
                                        0.2946809,
                                        0.3480512,
                                        0.33402872,
                                        0.25588068,
                                        0.24523875,
                                        0.28953975,
                                        0.2829906,
                                        0.041045565,
                                        0.2955043,
                                        0.33152395],
                             'mae': [0.008502956,
                                     0.009106924,
                                     0.008225134,
                                     0.010223697,
                                     0.009052991,
                                     0.010154465,
                                     0.008209726,
                                     0.008698255,
                                     0.01124651,
                                     0.01226743,
                                     0.010824031,
                                     0.0096263,
                                     0.010670295,
                                     0.009121127,
                                     0.00980439,
                                     0.00989021,
                                     0.008710721,
                                     0.008507219,
                                     0.007257589,
                                     0.00853047,
                                     0.009516679,
                                     0.009357207,
                                     0.008044333,
                                     0.009628012,
                                     0.008062367,
                                     0.008229519,
                                     0.0098862555,
                                     0.010339299,
                                     0.0091020325,
                                     0.010398329,
                                     0.0131866,
                                     0.01060394,
                                     0.00782287],
                             'max_mae': 0.0131866,
                             'max_mse': 0.00045970574,
                             'max_rmse': 0.02144075,
                             'median_distance': 1.4241881,
                             'median_mae': 0.009357207,
                             'min_cosine': 0.038156506,
                             'mse': [0.0001755405,
                                     0.0001785761,
                                     0.0001383827,
                                     0.00026655465,
                                     0.00016479111,
                                     0.0003108701,
                                     0.00015019778,
                                     0.0002092117,
                                     0.00034141887,
                                     0.00029082372,
                                     0.00027298537,
                                     0.00019251864,
                                     0.00027302306,
                                     0.00016892941,
                                     0.00020283117,
                                     0.00029535507,
                                     0.00019445318,
                                     0.00014953787,
                                     0.00010643319,
                                     0.00021465885,
                                     0.00019827919,
                                     0.00022837424,
                                     0.00017943076,
                                     0.00020910811,
                                     0.00013177929,
                                     0.00015214254,
                                     0.00029221326,
                                     0.00024877896,
                                     0.00019926886,
                                     0.00025586158,
                                     0.00045970574,
                                     0.00021778162,
                                     0.00015447476],
                             'rmse': [0.01324917,
                                      0.013363237,
                                      0.011763617,
                                      0.016326502,
                                      0.012837099,
                                      0.017631508,
                                      0.012255521,
                                      0.014464152,
                                      0.018477524,
                                      0.017053554,
                                      0.01652227,
                                      0.013875108,
                                      0.01652341,
                                      0.0129972845,
                                      0.014241881,
                                      0.017185897,
                                      0.013944647,
                                      0.012228568,
                                      0.010316646,
                                      0.014651241,
                                      0.014081164,
                                      0.015112056,
                                      0.013395177,
                                      0.014460571,
                                      0.0114795165,
                                      0.012334608,
                                      0.017094247,
                                      0.015772728,
                                      0.014116262,
                                      0.015995674,
                                      0.02144075,
                                      0.0147574255,
                                      0.012428788]},
 'residuals': {'mae': 0.009479026310145855,
               'mse': 0.00021891793585382402,
               'psnr': 15.534809112548828,
               'rmse': 0.014795875176787376,
               'ssds': [76.11101, 4.057717],
               'ssim': 0.48890846967697144},
 'spectra_pcagan': {'cosine': [0.9958485,
                               0.9987728,
                               0.998846,
                               0.9975696,
                               0.9983896,
                               0.99776125,
                               0.99297774,
                               0.99110293,
                               0.98749894,
                               0.99805236,
                               0.9988899,
                               0.9984386,
                               0.99867237,
                               0.9981184,
                               0.9956664,
                               0.9944493,
                               0.9961376,
                               0.98545223,
                               0.98508155,
                               0.9872955,
                               0.9877505,
                               0.9892716,
                               0.9895998,
                               0.9835248,
                               0.9908512,
                               0.992248,
                               0.9872946,
                               0.98680115,
                               0.9878852,
                               0.9507341,
                               0.2201734,
                               0.95252895,
                               0.98838156],
                    'mae': [0.019153189,
                            0.015836729,
                            0.014323297,
                            0.02382695,
                            0.016436078,
                            0.020139182,
                            0.03037118,
                            0.024489153,
                            0.10160543,
                            0.022735229,
                            0.018365966,
                            0.01775099,
                            0.017473334,
                            0.017507236,
                            0.023975026,
                            0.023398021,
                            0.019836843,
                            0.02603418,
                            0.02613918,
                            0.023303656,
                            0.0239948,
                            0.025470322,
                            0.023792962,
                            0.030033316,
                            0.027903527,
                            0.02680495,
                            0.028082209,
                            0.030487,
                            0.026506467,
                            0.052109063,
                            0.66082764,
                            0.061484996,
                            0.022907283],
                    'max_mae': 0.66082764,
                    'max_mse': 0.4540474,
                    'max_rmse': 0.6738304,
                    'median_mae': 0.023975026,
                    'min_cosine': 0.2201734,
                    'mse': [0.0006338833,
                            0.00041758732,
                            0.00035164715,
                            0.00083446904,
                            0.00044277907,
                            0.0007108182,
                            0.001288356,
                            0.0010199776,
                            0.011168946,
                            0.00083292875,
                            0.00056866487,
                            0.000529803,
                            0.0005317377,
                            0.00050729455,
                            0.00093715877,
                            0.0008994819,
                            0.0007023778,
                            0.0010967494,
                            0.001083707,
                            0.000945362,
                            0.0009827013,
                            0.0010603878,
                            0.000992149,
                            0.0015245286,
                            0.0013246933,
                            0.00128748,
                            0.0014101475,
                            0.0015670446,
                            0.0012487498,
                            0.0035688197,
                            0.4540474,
                            0.0051051998,
                            0.00089021976],
                    'rmse': [0.02517704,
                             0.020434953,
                             0.018752256,
                             0.028887179,
                             0.021042315,
                             0.026661174,
                             0.035893675,
                             0.03193709,
                             0.10568323,
                             0.028860506,
                             0.023846695,
                             0.02301745,
                             0.023059439,
                             0.0225232,
                             0.03061305,
                             0.029991364,
                             0.026502412,
                             0.03311721,
                             0.032919705,
                             0.03074674,
                             0.03134807,
                             0.032563597,
                             0.031498395,
                             0.03904521,
                             0.036396336,
                             0.03588147,
                             0.037551932,
                             0.039585914,
                             0.035337653,
                             0.0597396,
                             0.6738304,
                             0.07145068,
                             0.02983655]},
 'spectra_realgan': {'cosine': [0.9955164,
                                0.9987649,
                                0.99883413,
                                0.99756616,
                                0.9983779,
                                0.9977365,
                                0.9921055,
                                0.9901596,
                                0.98750746,
                                0.998045,
                                0.998884,
                                0.99843335,
                                0.99866533,
                                0.99810344,
                                0.9953992,
                                0.99409825,
                                0.99583006,
                                0.9838781,
                                0.9832142,
                                0.9855101,
                                0.9865281,
                                0.9881487,
                                0.9879645,
                                0.981844,
                                0.98978984,
                                0.99135745,
                                0.98583984,
                                0.9855272,
                                0.986517,
                                0.9485304,
                                0.22053947,
                                0.9521743,
                                0.98690134],
                     'mae': [0.02003736,
                             0.015912456,
                             0.01439145,
                             0.023837384,
                             0.016507413,
                             0.02024578,
                             0.03139986,
                             0.025885034,
                             0.101561256,
                             0.022796463,
                             0.018384555,
                             0.017779883,
                             0.017534263,
                             0.017570963,
                             0.024620226,
                             0.024195084,
                             0.020818792,
                             0.02751676,
                             0.027908234,
                             0.025199236,
                             0.025496928,
                             0.026612235,
                             0.025614794,
                             0.03171184,
                             0.029572342,
                             0.028771188,
                             0.029580686,
                             0.032048475,
                             0.028307416,
                             0.052727886,
                             0.6607605,
                             0.061088167,
                             0.024481287],
                     'max_mae': 0.6607605,
                     'max_mse': 0.45395273,
                     'max_rmse': 0.6737601,
                     'median_mae': 0.025496928,
                     'min_cosine': 0.22053947,
                     'mse': [0.00068473973,
                             0.00042061973,
                             0.00035520172,
                             0.000835334,
                             0.00044601268,
                             0.0007178525,
                             0.0014078384,
                             0.0011215287,
                             0.011160203,
                             0.0008367609,
                             0.0005706602,
                             0.0005313679,
                             0.00053463364,
                             0.00051129406,
                             0.0009844217,
                             0.00095619133,
                             0.0007544167,
                             0.0012169371,
                             0.0012226732,
                             0.0010774712,
                             0.0010844683,
                             0.0011621849,
                             0.0011252535,
                             0.0016751633,
                             0.0014775015,
                             0.0014325989,
                             0.0015413836,
                             0.0017134062,
                             0.0013875705,
                             0.0037367907,
                             0.45395273,
                             0.005122695,
                             0.0010044419],
                     'rmse': [0.026167532,
                              0.020509016,
                              0.018846795,
                              0.028902145,
                              0.021119012,
                              0.02679277,
                              0.037521172,
                              0.03348923,
                              0.105641864,
                              0.02892682,
                              0.023888495,
                              0.023051418,
                              0.023122147,
                              0.022611812,
                              0.031375494,
                              0.030922344,
                              0.027466647,
                              0.034884624,
                              0.034966744,
                              0.032824855,
                              0.03293127,
                              0.034090832,
                              0.033544797,
                              0.04092876,
                              0.038438283,
                              0.037849687,
                              0.03926046,
                              0.04139331,
                              0.03725011,
                              0.061129294,
                              0.6737601,
                              0.071573004,
                              0.03169293]},
 'spectra_realpca': {'cosine': [0.9996835,
                                0.9999946,
                                0.99998504,
                                0.9999922,
                                0.9999878,
                                0.99997795,
                                0.999258,
                                0.99906,
                                0.99999464,
                                0.9999972,
                                0.99999535,
                                0.9999918,
                                0.99999464,
                                0.9999887,
                                0.9997638,
                                0.999728,
                                0.99969655,
                                0.9983082,
                                0.99823964,
                                0.9983034,
                                0.99853027,
                                0.9987859,
                                0.99834114,
                                0.9983919,
                                0.99883205,
                                0.9990178,
                                0.998443,
                                0.9986611,
                                0.99854404,
                                0.9981686,
                                0.9999476,
                                0.9984778,
                                0.99837077],
                     'mae': [0.005495009,
                             0.0010571065,
                             0.0016874425,
                             0.0012083054,
                             0.0014423765,
                             0.0019788423,
                             0.007684581,
                             0.007808519,
                             0.001063194,
                             0.00081662444,
                             0.0011040997,
                             0.0013046577,
                             0.0011456523,
                             0.0013737977,
                             0.0050445437,
                             0.0052169915,
                             0.0055773826,
                             0.00896542,
                             0.008970706,
                             0.008848505,
                             0.008616626,
                             0.008307909,
                             0.009180669,
                             0.0093936175,
                             0.010009118,
                             0.010039052,
                             0.009444207,
                             0.009743359,
                             0.009692807,
                             0.009175936,
                             0.0015603547,
                             0.0096595595,
                             0.00879318],
                     'max_mae': 0.010039052,
                     'max_mse': 0.00016530833,
                     'max_rmse': 0.0128572285,
                     'median_mae': 0.007684581,
                     'min_cosine': 0.9981686,
                     'mse': [4.8331272e-05,
                             1.7960004e-06,
                             4.58268e-06,
                             2.332564e-06,
                             3.3295169e-06,
                             6.2616004e-06,
                             9.453417e-05,
                             9.815651e-05,
                             1.7978948e-06,
                             1.063919e-06,
                             1.9370843e-06,
                             2.7094015e-06,
                             2.1067385e-06,
                             3.0346202e-06,
                             4.10429e-05,
                             4.3652315e-05,
                             5.01522e-05,
                             0.00012830622,
                             0.00012915759,
                             0.00012507183,
                             0.00011748688,
                             0.00010955694,
                             0.00013540775,
                             0.00014234506,
                             0.00016530833,
                             0.00016251595,
                             0.00014252077,
                             0.00015215666,
                             0.00014977509,
                             0.00013618603,
                             3.958052e-06,
                             0.00014938814,
                             0.0001241412],
                     'rmse': [0.0069520697,
                              0.0013401494,
                              0.0021407194,
                              0.0015272734,
                              0.0018246964,
                              0.002502319,
                              0.009722868,
                              0.0099073965,
                              0.001340856,
                              0.0010314644,
                              0.0013917917,
                              0.001646026,
                              0.0014514609,
                              0.0017420162,
                              0.006406473,
                              0.00660699,
                              0.007081822,
                              0.011327233,
                              0.011364752,
                              0.0111835515,
                              0.010839136,
                              0.010466945,
                              0.0116364835,
                              0.011930845,
                              0.0128572285,
                              0.012748174,
                              0.011938207,
                              0.012335179,
                              0.012238263,
                              0.011669877,
                              0.0019894852,
                              0.012222445,
                              0.011141866]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_60.0
