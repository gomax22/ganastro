
Running comparison for experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805
Directory path: experiments/inpainting/gann_4_night_20180708_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_70.0/images
Optimal number of principal components:  24
Reconstruction error:  16.191565
Energy conservation:  0.7058356
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_70.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [3.933204310299706, 3.2103856381389337],
                   'kl_div': 0.27764168,
                   'ks_tests': {10000: KstestResult(statistic=0.1666, pvalue=1.5935985715067937e-121, statistic_location=0.00700383, statistic_sign=1),
                                20000: KstestResult(statistic=0.16674999999999995, pvalue=1.6858959529571048e-243, statistic_location=0.0069788275, statistic_sign=1),
                                30000: KstestResult(statistic=0.1582, pvalue=0.0, statistic_location=0.007086049, statistic_sign=1),
                                40000: KstestResult(statistic=0.15875000000000006, pvalue=0.0, statistic_location=0.006607669, statistic_sign=1),
                                50000: KstestResult(statistic=0.16544000000000003, pvalue=0.0, statistic_location=0.007056093, statistic_sign=1),
                                60000: KstestResult(statistic=0.16011666666666668, pvalue=0.0, statistic_location=0.0075662564, statistic_sign=1),
                                70000: KstestResult(statistic=0.15698571428571428, pvalue=0.0, statistic_location=0.008088674, statistic_sign=1),
                                80000: KstestResult(statistic=0.16041250000000007, pvalue=0.0, statistic_location=0.0070957365, statistic_sign=1),
                                90000: KstestResult(statistic=0.16088888888888897, pvalue=0.0, statistic_location=0.007105724, statistic_sign=1),
                                100000: KstestResult(statistic=0.15842999999999996, pvalue=0.0, statistic_location=0.007573448, statistic_sign=1),
                                110000: KstestResult(statistic=0.15854545454545454, pvalue=0.0, statistic_location=0.0064978236, statistic_sign=1)},
                   'moments': {'mean_error': 0.07679366,
                               'means': [-1.1889718e-05, -0.000120039775],
                               'stds': [0.017084507, 0.006141195],
                               'variance_ratio': 6.5559297}},
 'originals': {'gan': {'mae': 0.044734351336956024,
                       'mse': 0.00500925537198782,
                       'psnr': 27.338207244873047,
                       'rmse': 0.0707760900259018,
                       'ssim': 0.9471726417541504},
               'pca': {'mae': 0.01292618177831173,
                       'mse': 0.0002970478672068566,
                       'psnr': 39.564449310302734,
                       'rmse': 0.017235076054930687,
                       'ssim': 0.9968867301940918}},
 'reconstructions': {'mae': 0.04188918694853783,
                     'mse': 0.00474638631567359,
                     'psnr': 27.529081344604492,
                     'rmse': 0.06889402121305466,
                     'ssim': 0.9494990110397339},
 'residual_spectra_pcagan': {'cosine': [0.34209973,
                                        0.048424743,
                                        0.35841766,
                                        0.38140202,
                                        0.37717637,
                                        0.38043755,
                                        0.39014196,
                                        0.43283045,
                                        0.4159982,
                                        0.4372658,
                                        0.29332775],
                             'mae': [0.0107543245,
                                     0.013428375,
                                     0.009008032,
                                     0.009922512,
                                     0.0101921605,
                                     0.008429157,
                                     0.008703523,
                                     0.008578884,
                                     0.00876964,
                                     0.008578709,
                                     0.011265044],
                             'max_mae': 0.013428375,
                             'max_mse': 0.00041893302,
                             'max_rmse': 0.020467853,
                             'median_distance': 1.4568048,
                             'median_mae': 0.009008032,
                             'min_cosine': 0.048424743,
                             'mse': [0.00029268867,
                                     0.00041893302,
                                     0.00021222801,
                                     0.00023984654,
                                     0.00033667835,
                                     0.00018720023,
                                     0.0001640725,
                                     0.00018068257,
                                     0.00020008936,
                                     0.00017343061,
                                     0.00041360725],
                             'rmse': [0.017108146,
                                      0.020467853,
                                      0.014568048,
                                      0.01548698,
                                      0.018348796,
                                      0.013682114,
                                      0.012809078,
                                      0.013441822,
                                      0.014145294,
                                      0.013169305,
                                      0.020337336]},
 'residuals': {'mae': 0.009784579277038574,
               'mse': 0.0002563142916187644,
               'psnr': 21.392486572265625,
               'rmse': 0.016009818762540817,
               'ssds': [32.106564, 4.150118],
               'ssim': 0.46349573135375977},
 'spectra_pcagan': {'cosine': [0.9931293,
                               0.99938893,
                               0.99795693,
                               0.9909514,
                               0.99456996,
                               0.9975582,
                               0.9971051,
                               0.97479606,
                               0.99524903,
                               0.9918543,
                               0.9854515],
                    'mae': [0.028733624,
                            0.0219971,
                            0.03688342,
                            0.023873646,
                            0.017451309,
                            0.038502283,
                            0.030031294,
                            0.19339477,
                            0.02273601,
                            0.020416584,
                            0.026760967],
                    'max_mae': 0.19339477,
                    'max_mse': 0.039467324,
                    'max_rmse': 0.19866385,
                    'median_mae': 0.026760967,
                    'min_cosine': 0.97479606,
                    'mse': [0.0015118773,
                            0.00069378765,
                            0.0021753022,
                            0.0010123791,
                            0.00060075836,
                            0.0022575576,
                            0.0014737977,
                            0.039467324,
                            0.00093345984,
                            0.00073028984,
                            0.0013537145],
                    'rmse': [0.038882867,
                             0.02633985,
                             0.046640135,
                             0.031817906,
                             0.024510372,
                             0.04751376,
                             0.038390074,
                             0.19866385,
                             0.030552575,
                             0.027023876,
                             0.03679286]},
 'spectra_realgan': {'cosine': [0.99175346,
                                0.9993864,
                                0.9974738,
                                0.9885626,
                                0.992407,
                                0.99695754,
                                0.996352,
                                0.97315854,
                                0.99355114,
                                0.98881245,
                                0.9826634],
                     'mae': [0.032277416,
                             0.021971023,
                             0.039228965,
                             0.027653707,
                             0.021448666,
                             0.04044802,
                             0.03310232,
                             0.19353077,
                             0.027468923,
                             0.024600843,
                             0.030347247],
                     'max_mae': 0.19353077,
                     'max_mse': 0.039805513,
                     'max_rmse': 0.1995132,
                     'median_mae': 0.030347247,
                     'min_cosine': 0.97315854,
                     'mse': [0.001811758,
                             0.00069365103,
                             0.0024994803,
                             0.0012799344,
                             0.00081188173,
                             0.002571155,
                             0.0017536087,
                             0.039805513,
                             0.0012606264,
                             0.0009979114,
                             0.0016162823],
                     'rmse': [0.04256475,
                              0.026337255,
                              0.049994804,
                              0.03577617,
                              0.028493538,
                              0.050706558,
                              0.04187611,
                              0.1995132,
                              0.035505302,
                              0.031589735,
                              0.040203013]},
 'spectra_realpca': {'cosine': [0.9985219,
                                0.9999985,
                                0.9994784,
                                0.9973214,
                                0.9979127,
                                0.99933434,
                                0.99912405,
                                0.99828184,
                                0.9983507,
                                0.99660397,
                                0.996892],
                     'mae': [0.014300961,
                             0.0006831703,
                             0.0156516,
                             0.013643477,
                             0.011424707,
                             0.01559469,
                             0.015419511,
                             0.014309653,
                             0.014162137,
                             0.013642543,
                             0.013355545],
                     'max_mae': 0.0156516,
                     'max_mse': 0.00039438237,
                     'max_rmse': 0.019859063,
                     'median_mae': 0.014162137,
                     'min_cosine': 0.99660397,
                     'mse': [0.00032619145,
                             7.5093743e-07,
                             0.00039438237,
                             0.00029835786,
                             0.00020978475,
                             0.0003889251,
                             0.00038193044,
                             0.0003592343,
                             0.00032121997,
                             0.00029688948,
                             0.00028985992],
                     'rmse': [0.018060772,
                              0.00086656644,
                              0.019859063,
                              0.017273039,
                              0.014483948,
                              0.019721184,
                              0.01954304,
                              0.018953478,
                              0.01792261,
                              0.01723048,
                              0.017025273]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_70.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628
Directory path: experiments/inpainting/gann_4_night_20180708_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_70.0/images
Optimal number of principal components:  24
Reconstruction error:  16.191565
Energy conservation:  0.7058356
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_70.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.079875858281184, 3.1006322674316564],
                   'kl_div': 0.4918301,
                   'ks_tests': {10000: KstestResult(statistic=0.2165, pvalue=1.339753460536632e-205, statistic_location=-0.0061268685, statistic_sign=-1),
                                20000: KstestResult(statistic=0.22385, pvalue=0.0, statistic_location=-0.006024983, statistic_sign=-1),
                                30000: KstestResult(statistic=0.22266666666666668, pvalue=0.0, statistic_location=-0.00697935, statistic_sign=-1),
                                40000: KstestResult(statistic=0.2178, pvalue=0.0, statistic_location=-0.0068004252, statistic_sign=-1),
                                50000: KstestResult(statistic=0.21958, pvalue=0.0, statistic_location=-0.0072398684, statistic_sign=-1),
                                60000: KstestResult(statistic=0.22238333333333332, pvalue=0.0, statistic_location=-0.006963156, statistic_sign=-1),
                                70000: KstestResult(statistic=0.22275714285714285, pvalue=0.0, statistic_location=-0.006563766, statistic_sign=-1),
                                80000: KstestResult(statistic=0.221375, pvalue=0.0, statistic_location=-0.0069585545, statistic_sign=-1),
                                90000: KstestResult(statistic=0.22043333333333337, pvalue=0.0, statistic_location=-0.0069206087, statistic_sign=-1),
                                100000: KstestResult(statistic=0.22110999999999997, pvalue=0.0, statistic_location=-0.006526647, statistic_sign=-1),
                                110000: KstestResult(statistic=0.22210909090909092, pvalue=0.0, statistic_location=-0.0066005616, statistic_sign=-1),
                                120000: KstestResult(statistic=0.22258333333333336, pvalue=0.0, statistic_location=-0.0066436324, statistic_sign=-1),
                                130000: KstestResult(statistic=0.2223615384615385, pvalue=0.0, statistic_location=-0.006798584, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2224357142857143, pvalue=0.0, statistic_location=-0.0070182327, statistic_sign=-1),
                                150000: KstestResult(statistic=0.2188, pvalue=0.0, statistic_location=-0.0066877147, statistic_sign=-1),
                                160000: KstestResult(statistic=0.22153750000000003, pvalue=0.0, statistic_location=-0.0065658707, statistic_sign=-1),
                                170000: KstestResult(statistic=0.2200176470588235, pvalue=0.0, statistic_location=-0.006842667, statistic_sign=-1),
                                180000: KstestResult(statistic=0.21949444444444446, pvalue=0.0, statistic_location=-0.0068064844, statistic_sign=-1),
                                190000: KstestResult(statistic=0.21926842105263158, pvalue=0.0, statistic_location=-0.006809259, statistic_sign=-1),
                                200000: KstestResult(statistic=0.219165, pvalue=0.0, statistic_location=-0.006811654, statistic_sign=-1),
                                210000: KstestResult(statistic=0.2210619047619048, pvalue=0.0, statistic_location=-0.0072047077, statistic_sign=-1),
                                220000: KstestResult(statistic=0.2202, pvalue=0.0, statistic_location=-0.0068506496, statistic_sign=-1)},
                   'moments': {'mean_error': -0.17705114,
                               'means': [-0.0014181881, -5.9756727e-05],
                               'stds': [0.01881039, 0.0057740468],
                               'variance_ratio': 8.830299}},
 'originals': {'gan': {'mae': 0.041415736079216,
                       'mse': 0.003690463025122881,
                       'psnr': 29.55628204345703,
                       'rmse': 0.06074918061494827,
                       'ssim': 0.9063164591789246},
               'pca': {'mae': 0.011079667136073112,
                       'mse': 0.0002484795404598117,
                       'psnr': 41.4486198425293,
                       'rmse': 0.015763234347105026,
                       'ssim': 0.9939355254173279}},
 'reconstructions': {'mae': 0.039513297379016876,
                     'mse': 0.003462763037532568,
                     'psnr': 30.007299423217773,
                     'rmse': 0.05884524807333946,
                     'ssim': 0.9098191261291504},
 'residual_spectra_pcagan': {'cosine': [0.08782936,
                                        0.06834345,
                                        0.34749788,
                                        0.28344217,
                                        0.29798174,
                                        0.40555736,
                                        0.020751726,
                                        0.3069701,
                                        0.36753288,
                                        0.35061687,
                                        0.36675555,
                                        0.32901645,
                                        0.38507468,
                                        0.31819865,
                                        0.33661926,
                                        0.36011165,
                                        0.38442668,
                                        0.3653454,
                                        0.47911915,
                                        0.020087928,
                                        0.3898769,
                                        0.054409463],
                             'mae': [0.014097768,
                                     0.015130725,
                                     0.012389062,
                                     0.01388188,
                                     0.012005391,
                                     0.0099066235,
                                     0.014505432,
                                     0.011286019,
                                     0.011887816,
                                     0.01190343,
                                     0.009873814,
                                     0.011186805,
                                     0.01004718,
                                     0.011151693,
                                     0.011854057,
                                     0.011693096,
                                     0.009686963,
                                     0.011342612,
                                     0.010056392,
                                     0.01281044,
                                     0.009764686,
                                     0.011881366],
                             'max_mae': 0.015130725,
                             'max_mse': 0.00048965524,
                             'max_rmse': 0.022128155,
                             'median_distance': 1.7762973,
                             'median_mae': 0.011773577,
                             'min_cosine': 0.020087928,
                             'mse': [0.00039393854,
                                     0.00048965524,
                                     0.00038754643,
                                     0.0003688706,
                                     0.00031743155,
                                     0.00020051026,
                                     0.00043691188,
                                     0.00031362067,
                                     0.00029677292,
                                     0.0004288558,
                                     0.00021969972,
                                     0.00026799503,
                                     0.00024783023,
                                     0.00040938405,
                                     0.00031836348,
                                     0.0003300598,
                                     0.00024638153,
                                     0.00028466157,
                                     0.00020243053,
                                     0.00033047496,
                                     0.00028507467,
                                     0.00030868355],
                             'rmse': [0.019847885,
                                      0.022128155,
                                      0.0196862,
                                      0.019206004,
                                      0.017816609,
                                      0.014160165,
                                      0.020902438,
                                      0.017709339,
                                      0.017227098,
                                      0.020708833,
                                      0.014822271,
                                      0.016370554,
                                      0.015742624,
                                      0.020233242,
                                      0.017842744,
                                      0.018167548,
                                      0.015696546,
                                      0.016871916,
                                      0.014227808,
                                      0.01817897,
                                      0.016884154,
                                      0.017569393]},
 'residuals': {'mae': 0.011742875911295414,
               'mse': 0.0003220523940399289,
               'psnr': 20.400949478149414,
               'rmse': 0.017945818603038788,
               'ssds': [78.28488, 7.3354683],
               'ssim': 0.33947643637657166},
 'spectra_pcagan': {'cosine': [0.9989585,
                               0.9994043,
                               0.9850266,
                               0.9947063,
                               0.99687886,
                               0.993132,
                               0.9991687,
                               0.99680567,
                               0.9848111,
                               0.9909467,
                               0.99668795,
                               0.99485195,
                               0.9783015,
                               0.9919011,
                               0.9597691,
                               0.9800831,
                               0.9894638,
                               0.98113793,
                               0.9910017,
                               0.9993166,
                               0.98532665,
                               0.9974399],
                    'mae': [0.017034708,
                            0.020169852,
                            0.025461327,
                            0.0484776,
                            0.05747541,
                            0.030323584,
                            0.019980438,
                            0.054381043,
                            0.03237106,
                            0.022687599,
                            0.04715014,
                            0.042971574,
                            0.17947304,
                            0.030696368,
                            0.057649925,
                            0.0329237,
                            0.025495779,
                            0.040391613,
                            0.02393392,
                            0.017710004,
                            0.022441061,
                            0.02009291],
                    'max_mae': 0.17947304,
                    'max_mse': 0.03488102,
                    'max_rmse': 0.18676461,
                    'median_mae': 0.030509975,
                    'min_cosine': 0.9597691,
                    'mse': [0.00046680414,
                            0.00059195946,
                            0.0011093642,
                            0.003658585,
                            0.0054831817,
                            0.0015508588,
                            0.0006229646,
                            0.0043265196,
                            0.0017383087,
                            0.00093114784,
                            0.00328621,
                            0.0029162122,
                            0.03488102,
                            0.0017984965,
                            0.004261689,
                            0.0018782099,
                            0.0011319394,
                            0.0024780766,
                            0.00096092775,
                            0.0004766922,
                            0.0009596557,
                            0.0006719602],
                    'rmse': [0.02160565,
                             0.024330217,
                             0.03330712,
                             0.06048624,
                             0.07404851,
                             0.039380945,
                             0.024959259,
                             0.06577628,
                             0.041693028,
                             0.030514715,
                             0.057325475,
                             0.054001965,
                             0.18676461,
                             0.042408682,
                             0.065281615,
                             0.043338317,
                             0.033644307,
                             0.049780283,
                             0.030998835,
                             0.021833282,
                             0.030978309,
                             0.025922194]},
 'spectra_realgan': {'cosine': [0.99894327,
                                0.99940234,
                                0.98145306,
                                0.99415404,
                                0.9965239,
                                0.991695,
                                0.99916625,
                                0.99628097,
                                0.9822146,
                                0.9884819,
                                0.9960184,
                                0.994058,
                                0.97664857,
                                0.99022675,
                                0.95710987,
                                0.97679853,
                                0.98647827,
                                0.9784223,
                                0.9882579,
                                0.99931574,
                                0.98092294,
                                0.997411],
                     'mae': [0.017146079,
                             0.020168345,
                             0.028706223,
                             0.050800398,
                             0.059404463,
                             0.033509545,
                             0.019985925,
                             0.055692036,
                             0.03531207,
                             0.02621587,
                             0.048675243,
                             0.044680182,
                             0.17965956,
                             0.03404801,
                             0.05834632,
                             0.035970166,
                             0.028960349,
                             0.04211721,
                             0.02753194,
                             0.017711489,
                             0.026319312,
                             0.020185553],
                     'max_mae': 0.17965956,
                     'max_mse': 0.035222843,
                     'max_rmse': 0.1876775,
                     'median_mae': 0.03377878,
                     'min_cosine': 0.95710987,
                     'mse': [0.00047266626,
                             0.00059270527,
                             0.0013652463,
                             0.00403947,
                             0.005812725,
                             0.0018575729,
                             0.0006232374,
                             0.004649755,
                             0.0020181779,
                             0.0011730588,
                             0.0036266067,
                             0.0031747771,
                             0.035222843,
                             0.0021111243,
                             0.004506634,
                             0.0021810574,
                             0.0014073155,
                             0.0027539334,
                             0.0012253452,
                             0.00047697028,
                             0.0012224708,
                             0.0006764928],
                     'rmse': [0.02174089,
                              0.02434554,
                              0.03694924,
                              0.06355683,
                              0.07624123,
                              0.04309957,
                              0.024964724,
                              0.068189114,
                              0.044924136,
                              0.034249946,
                              0.060221314,
                              0.05634516,
                              0.1876775,
                              0.045946974,
                              0.06713147,
                              0.046701793,
                              0.037514202,
                              0.052477933,
                              0.035004932,
                              0.021839648,
                              0.03496385,
                              0.026009476]},
 'spectra_realpca': {'cosine': [0.9999907,
                                0.99999905,
                                0.9967911,
                                0.9994059,
                                0.9996317,
                                0.9985219,
                                0.9999985,
                                0.9994784,
                                0.9973214,
                                0.9979127,
                                0.99933434,
                                0.99912405,
                                0.99828184,
                                0.9983507,
                                0.99660397,
                                0.996892,
                                0.996899,
                                0.99715567,
                                0.9975796,
                                0.9999993,
                                0.9956345,
                                0.9999758],
                     'mae': [0.0015465069,
                             0.0006520631,
                             0.012034534,
                             0.015981494,
                             0.016948488,
                             0.014300961,
                             0.0006831703,
                             0.0156516,
                             0.013643477,
                             0.011424707,
                             0.01559469,
                             0.015419511,
                             0.014309653,
                             0.014162137,
                             0.013642543,
                             0.013355545,
                             0.013607077,
                             0.0137978485,
                             0.011903753,
                             0.00048606953,
                             0.012750917,
                             0.0018558932],
                     'max_mae': 0.016948488,
                     'max_mse': 0.00046189842,
                     'max_rmse': 0.021491822,
                     'median_mae': 0.01362481,
                     'min_cosine': 0.9956345,
                     'mse': [3.8502494e-06,
                             6.724091e-07,
                             0.00023299236,
                             0.0004112194,
                             0.00046189842,
                             0.00032619145,
                             7.5093743e-07,
                             0.00039438237,
                             0.00029835786,
                             0.00020978475,
                             0.0003889251,
                             0.00038193044,
                             0.0003592343,
                             0.00032121997,
                             0.00029688948,
                             0.00028985992,
                             0.0002965107,
                             0.00030120902,
                             0.00022430751,
                             3.8484504e-07,
                             0.00026043082,
                             5.546392e-06],
                     'rmse': [0.0019622052,
                              0.00082000555,
                              0.015264087,
                              0.020278545,
                              0.021491822,
                              0.018060772,
                              0.00086656644,
                              0.019859063,
                              0.017273039,
                              0.014483948,
                              0.019721184,
                              0.01954304,
                              0.018953478,
                              0.01792261,
                              0.01723048,
                              0.017025273,
                              0.017219486,
                              0.017355375,
                              0.014976899,
                              0.0006203588,
                              0.01613787,
                              0.002355078]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_70.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354
Directory path: experiments/inpainting/gann_4_night_20180708_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_70.0/images
Optimal number of principal components:  24
Reconstruction error:  16.191565
Energy conservation:  0.7058356
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_70.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.061857105227111, 3.0299045757141205],
                   'kl_div': 0.5343982,
                   'ks_tests': {10000: KstestResult(statistic=0.2155, pvalue=1.0791996279833284e-203, statistic_location=-0.0058917343, statistic_sign=-1),
                                20000: KstestResult(statistic=0.21195000000000003, pvalue=0.0, statistic_location=-0.0058024423, statistic_sign=-1),
                                30000: KstestResult(statistic=0.21473333333333333, pvalue=0.0, statistic_location=-0.00545484, statistic_sign=-1),
                                40000: KstestResult(statistic=0.213675, pvalue=0.0, statistic_location=-0.005866129, statistic_sign=-1),
                                50000: KstestResult(statistic=0.21482, pvalue=0.0, statistic_location=-0.00608281, statistic_sign=-1),
                                60000: KstestResult(statistic=0.2119666666666667, pvalue=0.0, statistic_location=-0.005670502, statistic_sign=-1),
                                70000: KstestResult(statistic=0.21431428571428573, pvalue=0.0, statistic_location=-0.006047558, statistic_sign=-1),
                                80000: KstestResult(statistic=0.21266250000000003, pvalue=0.0, statistic_location=-0.0061461637, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2137222222222222, pvalue=0.0, statistic_location=-0.006046163, statistic_sign=-1),
                                100000: KstestResult(statistic=0.2163, pvalue=0.0, statistic_location=-0.006128977, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2143272727272727, pvalue=0.0, statistic_location=-0.0065582744, statistic_sign=-1),
                                120000: KstestResult(statistic=0.21403333333333335, pvalue=0.0, statistic_location=-0.006205892, statistic_sign=-1),
                                130000: KstestResult(statistic=0.21593076923076926, pvalue=0.0, statistic_location=-0.0060373587, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2160642857142857, pvalue=0.0, statistic_location=-0.0061543193, statistic_sign=-1),
                                150000: KstestResult(statistic=0.21560666666666667, pvalue=0.0, statistic_location=-0.0061575053, statistic_sign=-1),
                                160000: KstestResult(statistic=0.21555625, pvalue=0.0, statistic_location=-0.0061748177, statistic_sign=-1),
                                170000: KstestResult(statistic=0.2136294117647059, pvalue=0.0, statistic_location=-0.006086262, statistic_sign=-1),
                                180000: KstestResult(statistic=0.21611666666666665, pvalue=0.0, statistic_location=-0.005574094, statistic_sign=-1),
                                190000: KstestResult(statistic=0.2136105263157895, pvalue=0.0, statistic_location=-0.0055774534, statistic_sign=-1),
                                200000: KstestResult(statistic=0.21383, pvalue=0.0, statistic_location=-0.0061363843, statistic_sign=-1),
                                210000: KstestResult(statistic=0.2148714285714286, pvalue=0.0, statistic_location=-0.006165463, statistic_sign=-1),
                                220000: KstestResult(statistic=0.21523636363636361, pvalue=0.0, statistic_location=-0.0060802656, statistic_sign=-1),
                                230000: KstestResult(statistic=0.21642608695652177, pvalue=0.0, statistic_location=-0.0061491095, statistic_sign=-1),
                                240000: KstestResult(statistic=0.21518749999999998, pvalue=0.0, statistic_location=-0.00567393, statistic_sign=-1),
                                250000: KstestResult(statistic=0.217148, pvalue=0.0, statistic_location=-0.0060857385, statistic_sign=-1),
                                260000: KstestResult(statistic=0.21358461538461537, pvalue=0.0, statistic_location=-0.006100148, statistic_sign=-1),
                                270000: KstestResult(statistic=0.21499259259259257, pvalue=0.0, statistic_location=-0.005566531, statistic_sign=-1),
                                280000: KstestResult(statistic=0.21604285714285715, pvalue=0.0, statistic_location=-0.005996775, statistic_sign=-1),
                                290000: KstestResult(statistic=0.21486896551724136, pvalue=0.0, statistic_location=-0.005600082, statistic_sign=-1),
                                300000: KstestResult(statistic=0.2135166666666667, pvalue=0.0, statistic_location=-0.006135715, statistic_sign=-1),
                                310000: KstestResult(statistic=0.21629032258064512, pvalue=0.0, statistic_location=-0.006130309, statistic_sign=-1),
                                320000: KstestResult(statistic=0.214075, pvalue=0.0, statistic_location=-0.0060822223, statistic_sign=-1),
                                330000: KstestResult(statistic=0.21534545454545456, pvalue=0.0, statistic_location=-0.0060696155, statistic_sign=-1)},
                   'moments': {'mean_error': -0.050107542,
                               'means': [-0.0005078844, -2.879598e-05],
                               'stds': [0.017889043, 0.0055320747],
                               'variance_ratio': 9.177948}},
 'originals': {'gan': {'mae': 0.03434796258807182,
                       'mse': 0.0026877636555582285,
                       'psnr': 30.955209732055664,
                       'rmse': 0.05184364691376686,
                       'ssim': 0.9331125020980835},
               'pca': {'mae': 0.009535613469779491,
                       'mse': 0.0002005162532441318,
                       'psnr': 42.459651947021484,
                       'rmse': 0.01416037604212761,
                       'ssim': 0.9956730604171753}},
 'reconstructions': {'mae': 0.032542336732149124,
                     'mse': 0.002501447917893529,
                     'psnr': 31.49923324584961,
                     'rmse': 0.05001447722315788,
                     'ssim': 0.935771107673645},
 'residual_spectra_pcagan': {'cosine': [0.25601518,
                                        0.09799959,
                                        0.46170563,
                                        0.36038527,
                                        0.44375795,
                                        0.08896017,
                                        0.08564149,
                                        0.064640194,
                                        0.3537523,
                                        0.28031468,
                                        0.3097296,
                                        0.41825512,
                                        0.019689372,
                                        0.31243417,
                                        0.39142013,
                                        0.37787142,
                                        0.38289618,
                                        0.33192086,
                                        0.39080513,
                                        0.32876524,
                                        0.35078475,
                                        0.3724112,
                                        0.3993784,
                                        0.38165995,
                                        0.48650342,
                                        0.018460589,
                                        0.3942448,
                                        0.055762645,
                                        0.45789793,
                                        0.1979496,
                                        0.49641767,
                                        0.08985558,
                                        0.020504339],
                             'mae': [0.010433496,
                                     0.011612218,
                                     0.008772718,
                                     0.0105944155,
                                     0.009575113,
                                     0.01438334,
                                     0.014239022,
                                     0.015032111,
                                     0.012244526,
                                     0.01388712,
                                     0.011611691,
                                     0.009579106,
                                     0.014323495,
                                     0.0111357365,
                                     0.011324964,
                                     0.011376895,
                                     0.009463745,
                                     0.011053311,
                                     0.009782695,
                                     0.010856609,
                                     0.011587152,
                                     0.011414749,
                                     0.009459484,
                                     0.01107467,
                                     0.009943251,
                                     0.012608543,
                                     0.0095892595,
                                     0.011940426,
                                     0.0095383,
                                     0.010628839,
                                     0.008352011,
                                     0.011527975,
                                     0.013449814],
                             'max_mae': 0.015032111,
                             'max_mse': 0.00047117082,
                             'max_rmse': 0.02170647,
                             'median_distance': 1.6678655,
                             'median_mae': 0.0111357365,
                             'min_cosine': 0.018460589,
                             'mse': [0.00020551085,
                                     0.00025401215,
                                     0.00017417056,
                                     0.0003124277,
                                     0.00018390443,
                                     0.00042931188,
                                     0.0004045273,
                                     0.00047117082,
                                     0.00037348497,
                                     0.0003756511,
                                     0.00029734368,
                                     0.0001902534,
                                     0.00042069997,
                                     0.00030169878,
                                     0.000253696,
                                     0.00035748933,
                                     0.00019555123,
                                     0.000267734,
                                     0.00023391795,
                                     0.000376187,
                                     0.00029351606,
                                     0.00031735672,
                                     0.00022453406,
                                     0.000260683,
                                     0.00019465815,
                                     0.00032359228,
                                     0.0002762502,
                                     0.00032099296,
                                     0.00021994252,
                                     0.0002097044,
                                     0.00017599404,
                                     0.00027817758,
                                     0.00036512478],
                             'rmse': [0.01433565,
                                      0.015937759,
                                      0.01319737,
                                      0.017675625,
                                      0.013561137,
                                      0.020719843,
                                      0.020112865,
                                      0.02170647,
                                      0.01932576,
                                      0.01938172,
                                      0.017243655,
                                      0.0137932375,
                                      0.020510972,
                                      0.017369479,
                                      0.015927836,
                                      0.018907389,
                                      0.013983963,
                                      0.01636258,
                                      0.015294377,
                                      0.019395541,
                                      0.01713231,
                                      0.01781451,
                                      0.014984461,
                                      0.01614568,
                                      0.0139519945,
                                      0.01798867,
                                      0.016620776,
                                      0.017916277,
                                      0.014830459,
                                      0.014481174,
                                      0.013266275,
                                      0.016678657,
                                      0.019108238]},
 'residuals': {'mae': 0.011284750886261463,
               'mse': 0.00028906879015266895,
               'psnr': 21.053363800048828,
               'rmse': 0.01700202375650406,
               'ssds': [105.69071, 10.099513],
               'ssim': 0.3419122099876404},
 'spectra_pcagan': {'cosine': [0.9974377,
                               0.9992307,
                               0.9872616,
                               0.99544704,
                               0.98663914,
                               0.99850583,
                               0.99893886,
                               0.9994106,
                               0.98488593,
                               0.9946567,
                               0.9968978,
                               0.9931735,
                               0.999177,
                               0.9968104,
                               0.9851378,
                               0.99139786,
                               0.9967515,
                               0.9948467,
                               0.9782502,
                               0.99214095,
                               0.9602569,
                               0.98072463,
                               0.9896625,
                               0.98130375,
                               0.9909701,
                               0.9993126,
                               0.98515296,
                               0.99739426,
                               0.98862267,
                               0.99554676,
                               0.99660116,
                               0.9983631,
                               0.99968857],
                    'mae': [0.017887207,
                            0.014902024,
                            0.02056782,
                            0.01847908,
                            0.020801656,
                            0.018177185,
                            0.017236473,
                            0.019903839,
                            0.02555747,
                            0.048590533,
                            0.057266627,
                            0.030166235,
                            0.019978335,
                            0.053666975,
                            0.03205888,
                            0.022245115,
                            0.046862327,
                            0.043420106,
                            0.18007456,
                            0.029913435,
                            0.057340015,
                            0.032399476,
                            0.025173161,
                            0.040507644,
                            0.024001502,
                            0.01782366,
                            0.022371553,
                            0.020085558,
                            0.021288496,
                            0.020119071,
                            0.019369239,
                            0.018847106,
                            0.016814705],
                    'max_mae': 0.18007456,
                    'max_mse': 0.035114117,
                    'max_rmse': 0.18738762,
                    'median_mae': 0.022245115,
                    'min_cosine': 0.9602569,
                    'mse': [0.0005201475,
                            0.0003546827,
                            0.00072576787,
                            0.0005983554,
                            0.0007534922,
                            0.00056690275,
                            0.00047928686,
                            0.00057820627,
                            0.0011158888,
                            0.0036912353,
                            0.005439863,
                            0.0015380969,
                            0.00062189455,
                            0.0042431024,
                            0.0017007706,
                            0.00087869796,
                            0.0032461593,
                            0.0029457172,
                            0.035114117,
                            0.0017249283,
                            0.0042123985,
                            0.001813995,
                            0.0011007601,
                            0.0024576448,
                            0.0009663655,
                            0.00048142424,
                            0.000966596,
                            0.00067755545,
                            0.0007605154,
                            0.00066048244,
                            0.00062763435,
                            0.00057300786,
                            0.00041208448],
                    'rmse': [0.022806743,
                             0.018833023,
                             0.02694008,
                             0.024461303,
                             0.027449813,
                             0.02380972,
                             0.02189262,
                             0.02404592,
                             0.033404924,
                             0.060755536,
                             0.07375543,
                             0.03921858,
                             0.024937814,
                             0.0651391,
                             0.0412404,
                             0.02964284,
                             0.056975078,
                             0.054274462,
                             0.18738762,
                             0.041532256,
                             0.06490299,
                             0.04259102,
                             0.033177704,
                             0.04957464,
                             0.03108642,
                             0.021941382,
                             0.031090127,
                             0.026029896,
                             0.027577443,
                             0.025699854,
                             0.025052631,
                             0.023937583,
                             0.020299865]},
 'spectra_realgan': {'cosine': [0.9972508,
                                0.9992217,
                                0.9832243,
                                0.9942407,
                                0.9827068,
                                0.99848765,
                                0.9989239,
                                0.99940866,
                                0.981297,
                                0.9941067,
                                0.9965379,
                                0.99172515,
                                0.99917454,
                                0.99628705,
                                0.98253846,
                                0.98896176,
                                0.9960904,
                                0.9940449,
                                0.9766165,
                                0.9904791,
                                0.95758724,
                                0.9774088,
                                0.98670197,
                                0.97857785,
                                0.9882232,
                                0.99931186,
                                0.9807606,
                                0.99736637,
                                0.9840904,
                                0.9953628,
                                0.9951784,
                                0.99834573,
                                0.9996884],
                     'mae': [0.01854198,
                             0.014985778,
                             0.023866238,
                             0.021071851,
                             0.024249308,
                             0.018311145,
                             0.017341811,
                             0.019904904,
                             0.028784158,
                             0.050913114,
                             0.059168078,
                             0.03345968,
                             0.019981595,
                             0.055011444,
                             0.03497756,
                             0.025771726,
                             0.048374493,
                             0.04506426,
                             0.18023531,
                             0.033359133,
                             0.05806259,
                             0.03555152,
                             0.02864439,
                             0.04216679,
                             0.02758377,
                             0.017824937,
                             0.026277814,
                             0.02017742,
                             0.02529138,
                             0.020647043,
                             0.022136098,
                             0.018928431,
                             0.016816907],
                     'max_mae': 0.18023531,
                     'max_mse': 0.035449803,
                     'max_rmse': 0.18828118,
                     'median_mae': 0.025771726,
                     'min_cosine': 0.95758724,
                     'mse': [0.00055797707,
                             0.00035868314,
                             0.00095437886,
                             0.0007570537,
                             0.0009759421,
                             0.0005737491,
                             0.00048503513,
                             0.0005789536,
                             0.0013730456,
                             0.004070556,
                             0.0057761464,
                             0.0018476741,
                             0.0006221682,
                             0.0045668185,
                             0.0019810996,
                             0.0011185808,
                             0.0035820708,
                             0.0032059634,
                             0.035449803,
                             0.0020360278,
                             0.004457984,
                             0.0021198776,
                             0.0013743723,
                             0.0027345,
                             0.0012311836,
                             0.00048168088,
                             0.0012288577,
                             0.0006819425,
                             0.0010366923,
                             0.0006882518,
                             0.0008001526,
                             0.0005767722,
                             0.0004122014],
                     'rmse': [0.023621539,
                              0.018938933,
                              0.030893022,
                              0.027514609,
                              0.031240072,
                              0.02395306,
                              0.022023514,
                              0.024061454,
                              0.03705463,
                              0.06380091,
                              0.076000966,
                              0.04298458,
                              0.0249433,
                              0.06757824,
                              0.044509545,
                              0.03344519,
                              0.059850402,
                              0.056621227,
                              0.18828118,
                              0.045122366,
                              0.06676814,
                              0.04604213,
                              0.03707253,
                              0.052292448,
                              0.035088226,
                              0.02194723,
                              0.035055067,
                              0.026114028,
                              0.032197706,
                              0.026234554,
                              0.02828697,
                              0.024016082,
                              0.020302743]},
 'spectra_realpca': {'cosine': [0.99984956,
                                0.9999952,
                                0.9957507,
                                0.9987226,
                                0.9958078,
                                0.99999005,
                                0.9999907,
                                0.99999905,
                                0.9967911,
                                0.9994059,
                                0.9996317,
                                0.9985219,
                                0.9999985,
                                0.9994784,
                                0.9973214,
                                0.9979127,
                                0.99933434,
                                0.99912405,
                                0.99828184,
                                0.9983507,
                                0.99660397,
                                0.996892,
                                0.996899,
                                0.99715567,
                                0.9975796,
                                0.9999993,
                                0.9956345,
                                0.9999758,
                                0.9956202,
                                0.9998103,
                                0.99859715,
                                0.99998677,
                                0.99999964],
                     'mae': [0.004337252,
                             0.001165491,
                             0.012173366,
                             0.01022183,
                             0.0120769655,
                             0.0014931768,
                             0.0015465069,
                             0.0006520631,
                             0.012034534,
                             0.015981494,
                             0.016948488,
                             0.014300961,
                             0.0006831703,
                             0.0156516,
                             0.013643477,
                             0.011424707,
                             0.01559469,
                             0.015419511,
                             0.014309653,
                             0.014162137,
                             0.013642543,
                             0.013355545,
                             0.013607077,
                             0.0137978485,
                             0.011903753,
                             0.00048606953,
                             0.012750917,
                             0.0018558932,
                             0.012750404,
                             0.0041815825,
                             0.010636281,
                             0.0015500409,
                             0.00033620783],
                     'max_mae': 0.016948488,
                     'max_mse': 0.00046189842,
                     'max_rmse': 0.021491822,
                     'median_mae': 0.0120769655,
                     'min_cosine': 0.9956202,
                     'mse': [3.0214766e-05,
                             2.1765109e-06,
                             0.00023749202,
                             0.00016741696,
                             0.00023423183,
                             3.5923083e-06,
                             3.8502494e-06,
                             6.724091e-07,
                             0.00023299236,
                             0.0004112194,
                             0.00046189842,
                             0.00032619145,
                             7.5093743e-07,
                             0.00039438237,
                             0.00029835786,
                             0.00020978475,
                             0.0003889251,
                             0.00038193044,
                             0.0003592343,
                             0.00032121997,
                             0.00029688948,
                             0.00028985992,
                             0.0002965107,
                             0.00030120902,
                             0.00022430751,
                             3.8484504e-07,
                             0.00026043082,
                             5.546392e-06,
                             0.00026231946,
                             2.811078e-05,
                             0.0001809067,
                             3.8444737e-06,
                             1.8215331e-07],
                     'rmse': [0.0054967958,
                              0.0014753003,
                              0.015410776,
                              0.012938971,
                              0.015304634,
                              0.0018953385,
                              0.0019622052,
                              0.00082000555,
                              0.015264087,
                              0.020278545,
                              0.021491822,
                              0.018060772,
                              0.00086656644,
                              0.019859063,
                              0.017273039,
                              0.014483948,
                              0.019721184,
                              0.01954304,
                              0.018953478,
                              0.01792261,
                              0.01723048,
                              0.017025273,
                              0.017219486,
                              0.017355375,
                              0.014976899,
                              0.0006203588,
                              0.01613787,
                              0.002355078,
                              0.016196279,
                              0.0053019603,
                              0.013450156,
                              0.001960733,
                              0.00042679423]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_70.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516
Directory path: experiments/inpainting/gann_4_night_20180722_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_70.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_70.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.35918432275619, 3.1215890132546327],
                   'kl_div': 0.8423621,
                   'ks_tests': {10000: KstestResult(statistic=0.3058, pvalue=1e-323, statistic_location=0.008870777, statistic_sign=1),
                                20000: KstestResult(statistic=0.29710000000000003, pvalue=0.0, statistic_location=0.008816262, statistic_sign=1),
                                30000: KstestResult(statistic=0.30446666666666666, pvalue=0.0, statistic_location=0.008400353, statistic_sign=1),
                                40000: KstestResult(statistic=0.30242500000000005, pvalue=0.0, statistic_location=0.008217694, statistic_sign=1),
                                50000: KstestResult(statistic=0.30096, pvalue=0.0, statistic_location=0.008429557, statistic_sign=1),
                                60000: KstestResult(statistic=0.3024, pvalue=0.0, statistic_location=0.008847598, statistic_sign=1),
                                70000: KstestResult(statistic=0.3023, pvalue=0.0, statistic_location=0.00844541, statistic_sign=1),
                                80000: KstestResult(statistic=0.3017375, pvalue=0.0, statistic_location=0.008195929, statistic_sign=1),
                                90000: KstestResult(statistic=0.30028888888888894, pvalue=0.0, statistic_location=0.008791238, statistic_sign=1),
                                100000: KstestResult(statistic=0.30196, pvalue=0.0, statistic_location=0.008710478, statistic_sign=1),
                                110000: KstestResult(statistic=0.3027545454545454, pvalue=0.0, statistic_location=0.008680857, statistic_sign=1)},
                   'moments': {'mean_error': 0.08277822,
                               'means': [-0.00073593855, -0.00044577167],
                               'stds': [0.022726193, 0.005489738],
                               'variance_ratio': 8.24979}},
 'originals': {'gan': {'mae': 0.05885758250951767,
                       'mse': 0.005448393989354372,
                       'psnr': 27.10418128967285,
                       'rmse': 0.07381323724985123,
                       'ssim': 0.603545069694519},
               'pca': {'mae': 0.012983637861907482,
                       'mse': 0.0002722899953369051,
                       'psnr': 40.598304748535156,
                       'rmse': 0.016501212492585182,
                       'ssim': 0.9844791293144226}},
 'reconstructions': {'mae': 0.057177815586328506,
                     'mse': 0.005125264637172222,
                     'psnr': 27.851459503173828,
                     'rmse': 0.07159095257520676,
                     'ssim': 0.6051655411720276},
 'residual_spectra_pcagan': {'cosine': [0.26564148,
                                        0.23854306,
                                        0.23416865,
                                        0.26053408,
                                        0.25381,
                                        0.33885944,
                                        0.29297134,
                                        0.24404314,
                                        0.2251663,
                                        0.22150944,
                                        0.2624583],
                             'mae': [0.014994153,
                                     0.017118374,
                                     0.017104134,
                                     0.016188318,
                                     0.014930034,
                                     0.014704486,
                                     0.013270199,
                                     0.018236991,
                                     0.020036701,
                                     0.018978633,
                                     0.016830673],
                             'max_mae': 0.020036701,
                             'max_mse': 0.0006272451,
                             'max_rmse': 0.025044862,
                             'median_distance': 2.189767,
                             'median_mae': 0.016830673,
                             'min_cosine': 0.22150944,
                             'mse': [0.0003872383,
                                     0.0006108163,
                                     0.0005075031,
                                     0.00041695996,
                                     0.00047950787,
                                     0.00036319596,
                                     0.0003557844,
                                     0.0005323883,
                                     0.0006272451,
                                     0.0005663711,
                                     0.0004724926],
                             'rmse': [0.019678371,
                                      0.024714697,
                                      0.022527829,
                                      0.020419598,
                                      0.021897668,
                                      0.0190577,
                                      0.018862247,
                                      0.023073541,
                                      0.025044862,
                                      0.023798551,
                                      0.021736896]},
 'residuals': {'mae': 0.016581155359745026,
               'mse': 0.0004835911968257278,
               'psnr': 8.197175025939941,
               'rmse': 0.021990707144141197,
               'ssds': [56.87184, 3.3369234],
               'ssim': 0.12163029611110687},
 'spectra_pcagan': {'cosine': [0.99116933,
                               0.9842978,
                               0.96088547,
                               0.95188564,
                               0.95586,
                               0.972211,
                               0.975154,
                               0.93962836,
                               0.9159561,
                               0.91690403,
                               0.9272211],
                    'mae': [0.071225174,
                            0.07258539,
                            0.06246844,
                            0.06437354,
                            0.045106705,
                            0.042673133,
                            0.03895635,
                            0.054263283,
                            0.06242841,
                            0.059908032,
                            0.05496742],
                    'max_mae': 0.07258539,
                    'max_mse': 0.007976555,
                    'max_rmse': 0.08931156,
                    'median_mae': 0.059908032,
                    'min_cosine': 0.9159561,
                    'mse': [0.0075000906,
                            0.007976555,
                            0.005692697,
                            0.006373456,
                            0.0031035342,
                            0.0027325316,
                            0.0024625135,
                            0.004419792,
                            0.0059709065,
                            0.005377533,
                            0.004768304],
                    'rmse': [0.08660306,
                             0.08931156,
                             0.075449966,
                             0.07983393,
                             0.055709373,
                             0.052273624,
                             0.04962372,
                             0.066481516,
                             0.07727164,
                             0.07333166,
                             0.069052905]},
 'spectra_realgan': {'cosine': [0.99050224,
                                0.98320454,
                                0.958425,
                                0.9485156,
                                0.95228004,
                                0.96986884,
                                0.97265184,
                                0.9365318,
                                0.912984,
                                0.91408354,
                                0.92231876],
                     'mae': [0.073525995,
                             0.07423982,
                             0.06392931,
                             0.066407725,
                             0.046533234,
                             0.044256676,
                             0.041072655,
                             0.05594315,
                             0.06368616,
                             0.06099438,
                             0.056844275],
                     'max_mae': 0.07423982,
                     'max_mse': 0.00842498,
                     'max_rmse': 0.09178769,
                     'median_mae': 0.06099438,
                     'min_cosine': 0.912984,
                     'mse': [0.008046477,
                             0.00842498,
                             0.0059988564,
                             0.0067990287,
                             0.0033501007,
                             0.0030101966,
                             0.0027172633,
                             0.004679983,
                             0.006192801,
                             0.005587246,
                             0.0051254076],
                     'rmse': [0.08970216,
                              0.09178769,
                              0.07745229,
                              0.08245622,
                              0.057880055,
                              0.05486526,
                              0.052127376,
                              0.068410404,
                              0.07869435,
                              0.07474788,
                              0.07159195]},
 'spectra_realpca': {'cosine': [0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349],
                     'mae': [0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197],
                     'max_mae': 0.015567541,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.012521197,
                     'min_cosine': 0.9963109,
                     'mse': [0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102],
                     'rmse': [0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_70.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115
Directory path: experiments/inpainting/gann_4_night_20180722_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_70.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_70.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.22363691969865, 3.112562869251242],
                   'kl_div': 0.6277143,
                   'ks_tests': {10000: KstestResult(statistic=0.2622, pvalue=1.6799421971907378e-302, statistic_location=0.007867394, statistic_sign=1),
                                20000: KstestResult(statistic=0.25925, pvalue=0.0, statistic_location=0.008505292, statistic_sign=1),
                                30000: KstestResult(statistic=0.2525666666666666, pvalue=0.0, statistic_location=0.0081003755, statistic_sign=1),
                                40000: KstestResult(statistic=0.25285, pvalue=0.0, statistic_location=0.007690263, statistic_sign=1),
                                50000: KstestResult(statistic=0.2525400000000001, pvalue=0.0, statistic_location=0.008118335, statistic_sign=1),
                                60000: KstestResult(statistic=0.25454999999999994, pvalue=0.0, statistic_location=0.008111283, statistic_sign=1),
                                70000: KstestResult(statistic=0.2524857142857143, pvalue=0.0, statistic_location=0.008348685, statistic_sign=1),
                                80000: KstestResult(statistic=0.25315, pvalue=0.0, statistic_location=0.008113654, statistic_sign=1),
                                90000: KstestResult(statistic=0.2529, pvalue=0.0, statistic_location=0.008434859, statistic_sign=1),
                                100000: KstestResult(statistic=0.25378, pvalue=0.0, statistic_location=0.00825505, statistic_sign=1),
                                110000: KstestResult(statistic=0.25340000000000007, pvalue=0.0, statistic_location=0.008409129, statistic_sign=1),
                                120000: KstestResult(statistic=0.2538583333333333, pvalue=0.0, statistic_location=0.008340621, statistic_sign=1),
                                130000: KstestResult(statistic=0.2542692307692308, pvalue=0.0, statistic_location=0.008338121, statistic_sign=1),
                                140000: KstestResult(statistic=0.25216428571428573, pvalue=0.0, statistic_location=0.008629588, statistic_sign=1),
                                150000: KstestResult(statistic=0.25295333333333336, pvalue=0.0, statistic_location=0.008399316, statistic_sign=1),
                                160000: KstestResult(statistic=0.25392499999999996, pvalue=0.0, statistic_location=0.008358063, statistic_sign=1),
                                170000: KstestResult(statistic=0.25492352941176477, pvalue=0.0, statistic_location=0.008585583, statistic_sign=1),
                                180000: KstestResult(statistic=0.25307222222222225, pvalue=0.0, statistic_location=0.008050848, statistic_sign=1),
                                190000: KstestResult(statistic=0.25426315789473686, pvalue=0.0, statistic_location=0.00845392, statistic_sign=1),
                                200000: KstestResult(statistic=0.25085500000000005, pvalue=0.0, statistic_location=0.00837463, statistic_sign=1),
                                210000: KstestResult(statistic=0.25401428571428575, pvalue=0.0, statistic_location=0.0085856635, statistic_sign=1),
                                220000: KstestResult(statistic=0.2518954545454546, pvalue=0.0, statistic_location=0.007993653, statistic_sign=1)},
                   'moments': {'mean_error': 0.0038906129,
                               'means': [-0.00054423965, -5.0476283e-05],
                               'stds': [0.019667108, 0.0054564234],
                               'variance_ratio': 8.458123}},
 'originals': {'gan': {'mae': 0.05455929413437843,
                       'mse': 0.004739472642540932,
                       'psnr': 27.725784301757812,
                       'rmse': 0.06884382665157318,
                       'ssim': 0.6566916704177856},
               'pca': {'mae': 0.013096767477691174,
                       'mse': 0.00027656604652293026,
                       'psnr': 40.53063201904297,
                       'rmse': 0.016630275174975395,
                       'ssim': 0.9780802726745605}},
 'reconstructions': {'mae': 0.05278368294239044,
                     'mse': 0.004443435464054346,
                     'psnr': 28.471435546875,
                     'rmse': 0.0666591003537178,
                     'ssim': 0.6628926396369934},
 'residual_spectra_pcagan': {'cosine': [0.28260374,
                                        0.25427267,
                                        0.268355,
                                        0.29584593,
                                        0.23188978,
                                        0.28962916,
                                        0.25852224,
                                        0.26286912,
                                        0.29332796,
                                        0.2820993,
                                        0.37338552,
                                        0.32056358,
                                        0.26874948,
                                        0.25312474,
                                        0.2513672,
                                        0.27952856,
                                        0.23953755,
                                        0.28502464,
                                        0.30253372,
                                        0.32720825,
                                        0.27045548,
                                        0.29371408],
                             'mae': [0.010502031,
                                     0.010798579,
                                     0.010070845,
                                     0.010413214,
                                     0.012834576,
                                     0.012951301,
                                     0.0151773235,
                                     0.014890109,
                                     0.013906689,
                                     0.012997799,
                                     0.012823609,
                                     0.011811436,
                                     0.016060349,
                                     0.017822467,
                                     0.016626589,
                                     0.01516656,
                                     0.016007427,
                                     0.013797997,
                                     0.013872792,
                                     0.012407163,
                                     0.016223252,
                                     0.01292536],
                             'max_mae': 0.017822467,
                             'max_mse': 0.0005019679,
                             'max_rmse': 0.02240464,
                             'median_distance': 1.8121607,
                             'median_mae': 0.013397898,
                             'min_cosine': 0.23188978,
                             'mse': [0.00025930666,
                                     0.00030546763,
                                     0.00030148434,
                                     0.00024392085,
                                     0.00033087173,
                                     0.0003042353,
                                     0.0004983933,
                                     0.0003948954,
                                     0.00032153615,
                                     0.00038831035,
                                     0.0002838249,
                                     0.00029352694,
                                     0.00043116504,
                                     0.0005019679,
                                     0.00044528552,
                                     0.0003979254,
                                     0.00041768374,
                                     0.00035424353,
                                     0.0003210409,
                                     0.00029152032,
                                     0.00044081043,
                                     0.0003259229],
                             'rmse': [0.016103001,
                                      0.017477632,
                                      0.017363304,
                                      0.015617966,
                                      0.01818988,
                                      0.017442342,
                                      0.022324724,
                                      0.019871976,
                                      0.01793143,
                                      0.019705592,
                                      0.016847104,
                                      0.017132629,
                                      0.020764515,
                                      0.02240464,
                                      0.02110179,
                                      0.019948067,
                                      0.020437313,
                                      0.018821359,
                                      0.017917614,
                                      0.017073967,
                                      0.020995487,
                                      0.018053336]},
 'residuals': {'mae': 0.013640339486300945,
               'mse': 0.0003569700347725302,
               'psnr': 20.099227905273438,
               'rmse': 0.0188936498016119,
               'ssds': [85.1597, 6.550493],
               'ssim': 0.16781511902809143},
 'spectra_pcagan': {'cosine': [0.9902773,
                               0.99058205,
                               0.98593557,
                               0.98166245,
                               0.98475355,
                               0.99134403,
                               0.98469067,
                               0.9618693,
                               0.9533671,
                               0.9566785,
                               0.97290313,
                               0.9757846,
                               0.94132704,
                               0.91703165,
                               0.91814286,
                               0.9270977,
                               0.9028449,
                               0.9609457,
                               0.9464992,
                               0.9642788,
                               0.9262062,
                               0.9555533],
                    'mae': [0.04954987,
                            0.04831482,
                            0.04154204,
                            0.037994385,
                            0.056879994,
                            0.070389315,
                            0.07150371,
                            0.061738495,
                            0.06303579,
                            0.044605147,
                            0.042243615,
                            0.038479164,
                            0.05336855,
                            0.06202688,
                            0.0593197,
                            0.054996807,
                            0.06251957,
                            0.0451165,
                            0.05207317,
                            0.041342534,
                            0.058123376,
                            0.046077438],
                    'max_mae': 0.07150371,
                    'max_mse': 0.007799086,
                    'max_rmse': 0.08831243,
                    'median_mae': 0.05272086,
                    'min_cosine': 0.9028449,
                    'mse': [0.0040059844,
                            0.0040321765,
                            0.0028679508,
                            0.0023258596,
                            0.0047913417,
                            0.0073422515,
                            0.007799086,
                            0.005567095,
                            0.0061341664,
                            0.0030706367,
                            0.0026718352,
                            0.002433345,
                            0.004295135,
                            0.0059063034,
                            0.0053027747,
                            0.0047799936,
                            0.006218094,
                            0.0031185155,
                            0.00393515,
                            0.00280235,
                            0.00520777,
                            0.003147773],
                    'rmse': [0.063292846,
                             0.06349942,
                             0.053553253,
                             0.04822717,
                             0.069219515,
                             0.08568694,
                             0.08831243,
                             0.07461297,
                             0.07832092,
                             0.055413324,
                             0.0516898,
                             0.049328946,
                             0.06553728,
                             0.07685248,
                             0.07282016,
                             0.0691375,
                             0.07885489,
                             0.05584367,
                             0.062730774,
                             0.05293723,
                             0.07216488,
                             0.056105018]},
 'spectra_realgan': {'cosine': [0.9896691,
                                0.9898579,
                                0.98456603,
                                0.9791487,
                                0.983875,
                                0.9906742,
                                0.9836056,
                                0.95940924,
                                0.950004,
                                0.9531188,
                                0.9706316,
                                0.9733282,
                                0.93827266,
                                0.91403544,
                                0.91530865,
                                0.92216086,
                                0.9011053,
                                0.9585088,
                                0.94279194,
                                0.9608301,
                                0.92520034,
                                0.95235986],
                     'mae': [0.05091956,
                             0.05065085,
                             0.044404034,
                             0.041118804,
                             0.058669947,
                             0.07273627,
                             0.07316233,
                             0.063168325,
                             0.06512662,
                             0.046040375,
                             0.04382759,
                             0.040590435,
                             0.05506352,
                             0.06331624,
                             0.060418434,
                             0.056880366,
                             0.06340985,
                             0.046374947,
                             0.05363102,
                             0.043673262,
                             0.059573457,
                             0.04754814],
                     'max_mae': 0.07316233,
                     'max_mse': 0.008238449,
                     'max_rmse': 0.0907659,
                     'median_mae': 0.05434727,
                     'min_cosine': 0.9011053,
                     'mse': [0.0042169,
                             0.00437998,
                             0.003240988,
                             0.0026799885,
                             0.0051155905,
                             0.007887149,
                             0.008238449,
                             0.005872001,
                             0.006557111,
                             0.0033155568,
                             0.0029443847,
                             0.0026845408,
                             0.004551976,
                             0.006129314,
                             0.005513082,
                             0.0051394324,
                             0.0063526644,
                             0.0033178928,
                             0.004240858,
                             0.0030703791,
                             0.005419961,
                             0.0034001968],
                     'rmse': [0.064937666,
                              0.066181414,
                              0.056929674,
                              0.051768605,
                              0.07152335,
                              0.088809624,
                              0.0907659,
                              0.07662898,
                              0.080975994,
                              0.057580873,
                              0.054262184,
                              0.051812556,
                              0.06746833,
                              0.07828993,
                              0.07425013,
                              0.07168984,
                              0.07970361,
                              0.057601154,
                              0.06512187,
                              0.055411004,
                              0.07362039,
                              0.058311205]},
 'spectra_realpca': {'cosine': [0.99914396,
                                0.9992311,
                                0.9983727,
                                0.9974544,
                                0.99898773,
                                0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349,
                                0.99650675,
                                0.9971242,
                                0.9965543,
                                0.9968424,
                                0.9962396,
                                0.99634945],
                     'mae': [0.014836307,
                             0.01447966,
                             0.013651306,
                             0.013377094,
                             0.014316244,
                             0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197,
                             0.012154227,
                             0.011967489,
                             0.012771271,
                             0.012152725,
                             0.013049042,
                             0.0125535],
                     'max_mae': 0.015567541,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.012704127,
                     'min_cosine': 0.9962396,
                     'mse': [0.00034976797,
                             0.00033549307,
                             0.00029904975,
                             0.00028346918,
                             0.00032609524,
                             0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102,
                             0.00023534271,
                             0.00023139741,
                             0.00026069232,
                             0.00023610053,
                             0.0002807898,
                             0.0002510656],
                     'rmse': [0.018702084,
                              0.01831647,
                              0.017293055,
                              0.016836543,
                              0.018058106,
                              0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779,
                              0.015340883,
                              0.015211753,
                              0.016145969,
                              0.015365563,
                              0.016756784,
                              0.01584505]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_70.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453
Directory path: experiments/inpainting/gann_4_night_20180722_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_70.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_70.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.111089078084709, 3.1001794530905693],
                   'kl_div': 0.49720812,
                   'ks_tests': {10000: KstestResult(statistic=0.2219, pvalue=4.749405512054818e-216, statistic_location=-0.007649064, statistic_sign=-1),
                                20000: KstestResult(statistic=0.22430000000000005, pvalue=0.0, statistic_location=0.0073653944, statistic_sign=1),
                                30000: KstestResult(statistic=0.21716666666666673, pvalue=0.0, statistic_location=0.0077155717, statistic_sign=1),
                                40000: KstestResult(statistic=0.21872500000000006, pvalue=0.0, statistic_location=0.0074500977, statistic_sign=1),
                                50000: KstestResult(statistic=0.21738000000000002, pvalue=0.0, statistic_location=0.008049129, statistic_sign=1),
                                60000: KstestResult(statistic=0.21851666666666658, pvalue=0.0, statistic_location=0.007879959, statistic_sign=1),
                                70000: KstestResult(statistic=0.21801428571428572, pvalue=0.0, statistic_location=0.007863278, statistic_sign=1),
                                80000: KstestResult(statistic=0.22110000000000007, pvalue=0.0, statistic_location=0.007912432, statistic_sign=1),
                                90000: KstestResult(statistic=0.21720000000000006, pvalue=0.0, statistic_location=0.008069996, statistic_sign=1),
                                100000: KstestResult(statistic=0.21998000000000006, pvalue=0.0, statistic_location=0.0078074075, statistic_sign=1),
                                110000: KstestResult(statistic=0.2188000000000001, pvalue=0.0, statistic_location=0.0074348394, statistic_sign=1),
                                120000: KstestResult(statistic=0.21893333333333342, pvalue=0.0, statistic_location=0.0075223027, statistic_sign=1),
                                130000: KstestResult(statistic=0.21600769230769234, pvalue=0.0, statistic_location=0.0074295015, statistic_sign=1),
                                140000: KstestResult(statistic=0.21693571428571423, pvalue=0.0, statistic_location=0.007864193, statistic_sign=1),
                                150000: KstestResult(statistic=0.21721333333333326, pvalue=0.0, statistic_location=0.0075113997, statistic_sign=1),
                                160000: KstestResult(statistic=0.21824999999999994, pvalue=0.0, statistic_location=0.0074340454, statistic_sign=1),
                                170000: KstestResult(statistic=0.21802941176470592, pvalue=0.0, statistic_location=0.007519443, statistic_sign=1),
                                180000: KstestResult(statistic=0.21758333333333335, pvalue=0.0, statistic_location=0.0078630345, statistic_sign=1),
                                190000: KstestResult(statistic=0.21737368421052639, pvalue=0.0, statistic_location=0.007809474, statistic_sign=1),
                                200000: KstestResult(statistic=0.21811499999999995, pvalue=0.0, statistic_location=0.007433064, statistic_sign=1),
                                210000: KstestResult(statistic=0.21869523809523805, pvalue=0.0, statistic_location=0.007863029, statistic_sign=1),
                                220000: KstestResult(statistic=0.21755454545454544, pvalue=0.0, statistic_location=0.007480843, statistic_sign=1),
                                230000: KstestResult(statistic=0.21898695652173916, pvalue=0.0, statistic_location=0.0074969716, statistic_sign=1),
                                240000: KstestResult(statistic=0.2179416666666667, pvalue=0.0, statistic_location=0.0074388147, statistic_sign=1),
                                250000: KstestResult(statistic=0.21850000000000003, pvalue=0.0, statistic_location=0.007494385, statistic_sign=1),
                                260000: KstestResult(statistic=0.21859615384615394, pvalue=0.0, statistic_location=0.0074237827, statistic_sign=1),
                                270000: KstestResult(statistic=0.21808518518518516, pvalue=0.0, statistic_location=0.0078030694, statistic_sign=1),
                                280000: KstestResult(statistic=0.2184357142857143, pvalue=0.0, statistic_location=0.007880481, statistic_sign=1),
                                290000: KstestResult(statistic=0.21785172413793108, pvalue=0.0, statistic_location=0.007523282, statistic_sign=1),
                                300000: KstestResult(statistic=0.21748333333333336, pvalue=0.0, statistic_location=0.0075503876, statistic_sign=1),
                                310000: KstestResult(statistic=0.21789677419354836, pvalue=0.0, statistic_location=0.0074319197, statistic_sign=1),
                                320000: KstestResult(statistic=0.22073437500000004, pvalue=0.0, statistic_location=0.0075016664, statistic_sign=1),
                                330000: KstestResult(statistic=0.21733636363636366, pvalue=0.0, statistic_location=0.007519443, statistic_sign=1)},
                   'moments': {'mean_error': -0.0042404295,
                               'means': [-0.00039863147, -2.1693977e-05],
                               'stds': [0.017679268, 0.005385532],
                               'variance_ratio': 8.627582}},
 'originals': {'gan': {'mae': 0.05171003192663193,
                       'mse': 0.004362098407000303,
                       'psnr': 28.81952667236328,
                       'rmse': 0.06604618579149246,
                       'ssim': 0.7228677272796631},
               'pca': {'mae': 0.013429644517600536,
                       'mse': 0.00029108254238963127,
                       'psnr': 40.7747917175293,
                       'rmse': 0.01706114038825035,
                       'ssim': 0.9816524982452393}},
 'reconstructions': {'mae': 0.04971151053905487,
                     'mse': 0.004055059049278498,
                     'psnr': 29.33498191833496,
                     'rmse': 0.06367934495210648,
                     'ssim': 0.7297914624214172},
 'residual_spectra_pcagan': {'cosine': [0.43865642,
                                        0.24162422,
                                        0.33851382,
                                        0.2904345,
                                        0.31440586,
                                        0.27107003,
                                        0.29740414,
                                        0.26412457,
                                        0.30329663,
                                        0.31571752,
                                        0.2341939,
                                        0.30094036,
                                        0.27264938,
                                        0.28328276,
                                        0.31187657,
                                        0.30602232,
                                        0.39502403,
                                        0.35032323,
                                        0.28461316,
                                        0.2715893,
                                        0.27236634,
                                        0.28819954,
                                        0.25545248,
                                        0.30801818,
                                        0.32594854,
                                        0.35910082,
                                        0.2935288,
                                        0.30909878,
                                        0.3610874,
                                        0.37976265,
                                        0.32860368,
                                        0.33697698,
                                        0.28380537],
                             'mae': [0.010307829,
                                     0.011543067,
                                     0.009078416,
                                     0.009397869,
                                     0.009183342,
                                     0.010454051,
                                     0.0099123595,
                                     0.010413985,
                                     0.009421885,
                                     0.010166941,
                                     0.012307652,
                                     0.012033404,
                                     0.014177274,
                                     0.01385857,
                                     0.012729086,
                                     0.011991444,
                                     0.011697062,
                                     0.011068564,
                                     0.014922364,
                                     0.016551461,
                                     0.015271266,
                                     0.014176084,
                                     0.014681517,
                                     0.012756438,
                                     0.012809018,
                                     0.011260095,
                                     0.014887729,
                                     0.01216543,
                                     0.009162823,
                                     0.009436313,
                                     0.009196771,
                                     0.009405595,
                                     0.011066853],
                             'max_mae': 0.016551461,
                             'max_mse': 0.0004356272,
                             'max_rmse': 0.020871684,
                             'median_distance': 1.6654694,
                             'median_mae': 0.011543067,
                             'min_cosine': 0.2341939,
                             'mse': [0.00020070293,
                                     0.000314841,
                                     0.00018760165,
                                     0.00023998735,
                                     0.00018848691,
                                     0.00030048433,
                                     0.00024126201,
                                     0.0002852728,
                                     0.00024048776,
                                     0.00021730617,
                                     0.00032217198,
                                     0.00026426348,
                                     0.00043222724,
                                     0.0003413647,
                                     0.00027737874,
                                     0.00032536022,
                                     0.00023890019,
                                     0.0002495822,
                                     0.00038487438,
                                     0.0004356272,
                                     0.00037485873,
                                     0.00036444768,
                                     0.00036045545,
                                     0.00030593012,
                                     0.00027573522,
                                     0.00023915702,
                                     0.00037236547,
                                     0.00028663193,
                                     0.00018535437,
                                     0.00018155565,
                                     0.00020665588,
                                     0.00022121977,
                                     0.0002972659],
                             'rmse': [0.014166966,
                                      0.017743759,
                                      0.013696775,
                                      0.015491525,
                                      0.013729054,
                                      0.017334484,
                                      0.015532611,
                                      0.016890021,
                                      0.015507667,
                                      0.014741308,
                                      0.017949149,
                                      0.016256183,
                                      0.020790076,
                                      0.018476058,
                                      0.01665469,
                                      0.018037744,
                                      0.015456396,
                                      0.01579817,
                                      0.019618215,
                                      0.020871684,
                                      0.019361269,
                                      0.019090513,
                                      0.018985664,
                                      0.017490858,
                                      0.016605277,
                                      0.015464703,
                                      0.019296773,
                                      0.016930208,
                                      0.013614491,
                                      0.013474259,
                                      0.01437553,
                                      0.014873459,
                                      0.017241402]},
 'residuals': {'mae': 0.011742199771106243,
               'mse': 0.00028363082674331963,
               'psnr': 21.098011016845703,
               'rmse': 0.01684134267270565,
               'ssds': [103.19576, 9.571429],
               'ssim': 0.22103337943553925},
 'spectra_pcagan': {'cosine': [0.9963698,
                               0.99438685,
                               0.9956266,
                               0.9947156,
                               0.9958619,
                               0.9941898,
                               0.99029875,
                               0.99031955,
                               0.9854418,
                               0.9806126,
                               0.9842539,
                               0.99106264,
                               0.98436266,
                               0.9612392,
                               0.95402,
                               0.95667464,
                               0.9732843,
                               0.9759182,
                               0.9413496,
                               0.9185366,
                               0.9188191,
                               0.92797846,
                               0.90390915,
                               0.9617075,
                               0.94762224,
                               0.9649784,
                               0.9271132,
                               0.9554265,
                               0.9740822,
                               0.9776025,
                               0.98743755,
                               0.98771983,
                               0.9894869],
                    'mae': [0.02895067,
                            0.04266675,
                            0.049023084,
                            0.048572775,
                            0.056023497,
                            0.061252892,
                            0.0495633,
                            0.04903637,
                            0.042492125,
                            0.03926784,
                            0.057685602,
                            0.071342446,
                            0.07214283,
                            0.062262837,
                            0.062302727,
                            0.04457293,
                            0.04187726,
                            0.038644116,
                            0.053261742,
                            0.06150753,
                            0.059135124,
                            0.054507904,
                            0.062075067,
                            0.044807233,
                            0.0516789,
                            0.041154943,
                            0.057749476,
                            0.046301115,
                            0.03875649,
                            0.0349078,
                            0.036869936,
                            0.038954005,
                            0.04113254],
                    'max_mae': 0.07214283,
                    'max_mse': 0.0079698,
                    'max_rmse': 0.089273736,
                    'median_mae': 0.049023084,
                    'min_cosine': 0.90390915,
                    'mse': [0.0012863175,
                            0.003211473,
                            0.0038858878,
                            0.0039039506,
                            0.004709052,
                            0.006123947,
                            0.0039803,
                            0.0041435203,
                            0.0029436299,
                            0.0024493064,
                            0.004946753,
                            0.0075787306,
                            0.0079698,
                            0.0056669,
                            0.0060025654,
                            0.0030856284,
                            0.0026376077,
                            0.0024500329,
                            0.004291196,
                            0.005813097,
                            0.0052758013,
                            0.0047103073,
                            0.0061652604,
                            0.0030924445,
                            0.0038729415,
                            0.0027854885,
                            0.0051631485,
                            0.0031829113,
                            0.0024941468,
                            0.0020058854,
                            0.0023234044,
                            0.002516884,
                            0.0031486047],
                    'rmse': [0.03586527,
                             0.05666986,
                             0.06233689,
                             0.0624816,
                             0.06862253,
                             0.07825565,
                             0.06308962,
                             0.064370185,
                             0.05425523,
                             0.049490467,
                             0.07033315,
                             0.08705591,
                             0.089273736,
                             0.07527881,
                             0.077476226,
                             0.055548433,
                             0.051357646,
                             0.049497806,
                             0.06550722,
                             0.07624367,
                             0.07263471,
                             0.06863168,
                             0.07851917,
                             0.05560975,
                             0.06223296,
                             0.052777726,
                             0.07185505,
                             0.056417298,
                             0.049941435,
                             0.044787113,
                             0.048201706,
                             0.050168555,
                             0.056112427]},
 'spectra_realgan': {'cosine': [0.99594945,
                                0.993599,
                                0.9950832,
                                0.9941495,
                                0.9954565,
                                0.99380606,
                                0.9896941,
                                0.98959345,
                                0.9840586,
                                0.9780391,
                                0.98338234,
                                0.99038804,
                                0.983271,
                                0.9587497,
                                0.95064867,
                                0.95316404,
                                0.97102016,
                                0.97345513,
                                0.93828213,
                                0.9155233,
                                0.9159966,
                                0.92306614,
                                0.90216774,
                                0.95925295,
                                0.9439704,
                                0.96156967,
                                0.92616457,
                                0.95225024,
                                0.9714461,
                                0.9741205,
                                0.98563623,
                                0.98602635,
                                0.98827475],
                     'mae': [0.030195968,
                             0.04384645,
                             0.05171915,
                             0.051315956,
                             0.0585284,
                             0.064356156,
                             0.05100211,
                             0.051354375,
                             0.045245912,
                             0.04232188,
                             0.059441272,
                             0.07366079,
                             0.073836826,
                             0.063720815,
                             0.06439157,
                             0.04602444,
                             0.04345906,
                             0.040787138,
                             0.05499627,
                             0.062789485,
                             0.06026786,
                             0.056387287,
                             0.0629972,
                             0.04607277,
                             0.05318295,
                             0.04348565,
                             0.059214,
                             0.047780782,
                             0.041187927,
                             0.037686408,
                             0.039182164,
                             0.041614648,
                             0.04437734],
                     'max_mae': 0.073836826,
                     'max_mse': 0.008408905,
                     'max_rmse': 0.091700085,
                     'median_mae': 0.051315956,
                     'min_cosine': 0.90216774,
                     'mse': [0.0013965998,
                             0.0033654594,
                             0.0043091304,
                             0.0043066847,
                             0.0051687118,
                             0.00663488,
                             0.004193502,
                             0.0044916635,
                             0.0033190364,
                             0.002811561,
                             0.005270784,
                             0.008125987,
                             0.008408905,
                             0.005973664,
                             0.0064246827,
                             0.0033273175,
                             0.0029098277,
                             0.0027023253,
                             0.0045493,
                             0.0060367663,
                             0.005485335,
                             0.0050676977,
                             0.006299948,
                             0.0032926055,
                             0.0041749026,
                             0.0030507362,
                             0.0053743967,
                             0.0034350727,
                             0.0027860254,
                             0.0022955164,
                             0.0025833887,
                             0.0028579237,
                             0.0035189064],
                     'rmse': [0.03737111,
                              0.05801258,
                              0.065643966,
                              0.06562533,
                              0.07189375,
                              0.08145477,
                              0.06475726,
                              0.06701987,
                              0.057611078,
                              0.053024154,
                              0.07260016,
                              0.090144254,
                              0.091700085,
                              0.077289484,
                              0.08015412,
                              0.057682905,
                              0.05394282,
                              0.051983897,
                              0.0674485,
                              0.07769663,
                              0.07406305,
                              0.071187764,
                              0.07937221,
                              0.05738123,
                              0.064613484,
                              0.05523347,
                              0.07331028,
                              0.058609493,
                              0.052782815,
                              0.047911547,
                              0.05082705,
                              0.05345955,
                              0.05932037]},
 'spectra_realpca': {'cosine': [0.99945366,
                                0.99925643,
                                0.99947244,
                                0.99940675,
                                0.9995555,
                                0.99957067,
                                0.99914396,
                                0.9992311,
                                0.9983727,
                                0.9974544,
                                0.99898773,
                                0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349,
                                0.99650675,
                                0.9971242,
                                0.9965543,
                                0.9968424,
                                0.9962396,
                                0.99634945,
                                0.99715966,
                                0.99691385,
                                0.9982245,
                                0.99834263,
                                0.9988524],
                     'mae': [0.011083274,
                             0.014802759,
                             0.015157819,
                             0.015070052,
                             0.015472084,
                             0.015633475,
                             0.014836307,
                             0.01447966,
                             0.013651306,
                             0.013377094,
                             0.014316244,
                             0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197,
                             0.012154227,
                             0.011967489,
                             0.012771271,
                             0.012152725,
                             0.013049042,
                             0.0125535,
                             0.013193458,
                             0.0130807385,
                             0.013555716,
                             0.013718692,
                             0.014281331],
                     'max_mae': 0.015633475,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.013377094,
                     'min_cosine': 0.9962396,
                     'mse': [0.00019629093,
                             0.00035259564,
                             0.00036871652,
                             0.00035998295,
                             0.00038198216,
                             0.00038844542,
                             0.00034976797,
                             0.00033549307,
                             0.00029904975,
                             0.00028346918,
                             0.00032609524,
                             0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102,
                             0.00023534271,
                             0.00023139741,
                             0.00026069232,
                             0.00023610053,
                             0.0002807898,
                             0.0002510656,
                             0.00027758113,
                             0.00027334486,
                             0.00029565947,
                             0.00030083008,
                             0.0003258427],
                     'rmse': [0.014010387,
                              0.01877753,
                              0.019201992,
                              0.018973216,
                              0.019544363,
                              0.019709019,
                              0.018702084,
                              0.01831647,
                              0.017293055,
                              0.016836543,
                              0.018058106,
                              0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779,
                              0.015340883,
                              0.015211753,
                              0.016145969,
                              0.015365563,
                              0.016756784,
                              0.01584505,
                              0.016660767,
                              0.016533144,
                              0.017194752,
                              0.017344454,
                              0.018051114]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_70.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957
Directory path: experiments/inpainting/gann_4_night_20180723_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_70.0/images
Optimal number of principal components:  14
Reconstruction error:  25.005306
Energy conservation:  0.70290095
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_70.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.075287224842861, 3.469523146248676],
                   'kl_div': 0.2232852,
                   'ks_tests': {10000: KstestResult(statistic=0.1539, pvalue=1.0782532058244489e-103, statistic_location=0.01071671, statistic_sign=1),
                                20000: KstestResult(statistic=0.1552, pvalue=8.101946381699558e-211, statistic_location=0.009024577, statistic_sign=1),
                                30000: KstestResult(statistic=0.1615333333333333, pvalue=0.0, statistic_location=0.010335046, statistic_sign=1),
                                40000: KstestResult(statistic=0.1583, pvalue=0.0, statistic_location=0.010184122, statistic_sign=1),
                                50000: KstestResult(statistic=0.15680000000000005, pvalue=0.0, statistic_location=0.010345082, statistic_sign=1),
                                60000: KstestResult(statistic=0.15525, pvalue=0.0, statistic_location=0.009995898, statistic_sign=1),
                                70000: KstestResult(statistic=0.15434285714285711, pvalue=0.0, statistic_location=0.009489421, statistic_sign=1),
                                80000: KstestResult(statistic=0.15818750000000004, pvalue=0.0, statistic_location=0.0101277055, statistic_sign=1),
                                90000: KstestResult(statistic=0.15832222222222225, pvalue=0.0, statistic_location=0.0096272705, statistic_sign=1),
                                100000: KstestResult(statistic=0.15594999999999992, pvalue=0.0, statistic_location=0.009495444, statistic_sign=1),
                                110000: KstestResult(statistic=0.15560909090909092, pvalue=0.0, statistic_location=0.0095206285, statistic_sign=1)},
                   'moments': {'mean_error': 0.09351489,
                               'means': [0.00018858185, -2.021389e-05],
                               'stds': [0.018317485, 0.007781473],
                               'variance_ratio': 4.7091484}},
 'originals': {'gan': {'mae': 0.03906954824924469,
                       'mse': 0.0029811086133122444,
                       'psnr': 25.58672332763672,
                       'rmse': 0.05459953099489212,
                       'ssim': 0.6821485757827759},
               'pca': {'mae': 0.014858456328511238,
                       'mse': 0.0003551077388692647,
                       'psnr': 34.918277740478516,
                       'rmse': 0.018844302743673325,
                       'ssim': 0.9083287119865417}},
 'reconstructions': {'mae': 0.03535599634051323,
                     'mse': 0.0026444995310157537,
                     'psnr': 26.198442459106445,
                     'rmse': 0.051424697041511536,
                     'ssim': 0.7232703566551208},
 'residual_spectra_pcagan': {'cosine': [0.47426286,
                                        0.32350937,
                                        0.4323783,
                                        0.43295473,
                                        0.3731577,
                                        0.44410345,
                                        0.4474545,
                                        0.42687815,
                                        0.39405593,
                                        0.41092837,
                                        0.40250328],
                             'mae': [0.010149346,
                                     0.0112724835,
                                     0.011022898,
                                     0.009737741,
                                     0.010910677,
                                     0.01046691,
                                     0.010352732,
                                     0.011493463,
                                     0.011629967,
                                     0.010437219,
                                     0.0112644],
                             'max_mae': 0.011629967,
                             'max_mse': 0.00041749334,
                             'max_rmse': 0.020432653,
                             'median_distance': 1.6235322,
                             'median_mae': 0.010910677,
                             'min_cosine': 0.32350937,
                             'mse': [0.00021269202,
                                     0.00041749334,
                                     0.00025873224,
                                     0.00022013369,
                                     0.00035283994,
                                     0.00022644825,
                                     0.00024469628,
                                     0.00027425255,
                                     0.00031080036,
                                     0.00026358565,
                                     0.00028879291],
                             'rmse': [0.014583964,
                                      0.020432653,
                                      0.016085155,
                                      0.014836903,
                                      0.018784035,
                                      0.0150481975,
                                      0.015642771,
                                      0.016560573,
                                      0.01762953,
                                      0.016235322,
                                      0.016993908]},
 'residuals': {'mae': 0.010794347152113914,
               'mse': 0.0002791333827190101,
               'psnr': 17.410459518432617,
               'rmse': 0.01670728623867035,
               'ssds': [36.911907, 6.6606297],
               'ssim': 0.3593708276748657},
 'spectra_pcagan': {'cosine': [0.76505,
                               0.9761336,
                               0.9784021,
                               0.9836027,
                               0.9792712,
                               0.9773867,
                               0.981732,
                               0.98205477,
                               0.9877533,
                               0.9934075,
                               0.9908725],
                    'mae': [0.1250404,
                            0.033305082,
                            0.02853208,
                            0.0235511,
                            0.026167594,
                            0.027931595,
                            0.026410943,
                            0.027596423,
                            0.025433129,
                            0.021288458,
                            0.023659162],
                    'max_mae': 0.1250404,
                    'max_mse': 0.017041836,
                    'max_rmse': 0.13054438,
                    'median_mae': 0.026410943,
                    'min_cosine': 0.76505,
                    'mse': [0.017041836,
                            0.0019162056,
                            0.0012987937,
                            0.0009620556,
                            0.0012611889,
                            0.0012827916,
                            0.0011421767,
                            0.0012940138,
                            0.0011134425,
                            0.0007942397,
                            0.0009827495],
                    'rmse': [0.13054438,
                             0.043774486,
                             0.036038782,
                             0.03101702,
                             0.035513222,
                             0.03581608,
                             0.033796106,
                             0.035972405,
                             0.033368286,
                             0.028182259,
                             0.031348836]},
 'spectra_realgan': {'cosine': [0.76184684,
                                0.97067904,
                                0.971924,
                                0.9779715,
                                0.9730658,
                                0.9714546,
                                0.9760461,
                                0.9772564,
                                0.98438466,
                                0.991215,
                                0.9883499],
                     'mae': [0.12480017,
                             0.037243284,
                             0.03284229,
                             0.028149622,
                             0.030850897,
                             0.03196915,
                             0.03047016,
                             0.031200912,
                             0.029409193,
                             0.025332464,
                             0.027496887],
                     'max_mae': 0.12480017,
                     'max_mse': 0.017308284,
                     'max_rmse': 0.13156095,
                     'median_mae': 0.030850897,
                     'min_cosine': 0.76184684,
                     'mse': [0.017308284,
                             0.0023265781,
                             0.0017003143,
                             0.0013078044,
                             0.0016376267,
                             0.0016345422,
                             0.0015080121,
                             0.0016234661,
                             0.0014295718,
                             0.0010626604,
                             0.001253337],
                     'rmse': [0.13156095,
                              0.048234615,
                              0.04123487,
                              0.03616358,
                              0.0404676,
                              0.040429473,
                              0.03883313,
                              0.04029226,
                              0.037809677,
                              0.032598473,
                              0.0354025]},
 'spectra_realpca': {'cosine': [0.9944764,
                                0.99425286,
                                0.9938278,
                                0.9937943,
                                0.99332976,
                                0.9933152,
                                0.9943187,
                                0.99502295,
                                0.9965092,
                                0.99761105,
                                0.99714595],
                     'mae': [0.014894226,
                             0.015912617,
                             0.015331456,
                             0.015237259,
                             0.015751788,
                             0.015582587,
                             0.014978647,
                             0.014435187,
                             0.014058084,
                             0.013511142,
                             0.013750007],
                     'max_mae': 0.015912617,
                     'max_mse': 0.00040579162,
                     'max_rmse': 0.02014427,
                     'median_mae': 0.014978647,
                     'min_cosine': 0.9933152,
                     'mse': [0.0003626909,
                             0.00040579162,
                             0.0003767033,
                             0.00037141764,
                             0.00039525397,
                             0.00038702926,
                             0.00036052,
                             0.00033595102,
                             0.0003175301,
                             0.00028985197,
                             0.00030344544],
                     'rmse': [0.019044446,
                              0.02014427,
                              0.019408846,
                              0.019272199,
                              0.019880995,
                              0.019673059,
                              0.018987365,
                              0.018328967,
                              0.017819375,
                              0.01702504,
                              0.017419685]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_70.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431
Directory path: experiments/inpainting/gann_4_night_20180723_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_70.0/images
Optimal number of principal components:  14
Reconstruction error:  25.005306
Energy conservation:  0.70290095
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_70.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.070708789508587, 3.3699995724839744],
                   'kl_div': 0.28020146,
                   'ks_tests': {10000: KstestResult(statistic=0.187, pvalue=3.4881040410967845e-153, statistic_location=0.008104764, statistic_sign=1),
                                20000: KstestResult(statistic=0.1764, pvalue=1.1924399817232873e-272, statistic_location=0.007944494, statistic_sign=1),
                                30000: KstestResult(statistic=0.18280000000000007, pvalue=0.0, statistic_location=0.008631376, statistic_sign=1),
                                40000: KstestResult(statistic=0.18215000000000003, pvalue=0.0, statistic_location=0.008618493, statistic_sign=1),
                                50000: KstestResult(statistic=0.18046000000000006, pvalue=0.0, statistic_location=0.008434923, statistic_sign=1),
                                60000: KstestResult(statistic=0.1824, pvalue=0.0, statistic_location=0.008818235, statistic_sign=1),
                                70000: KstestResult(statistic=0.1865285714285715, pvalue=0.0, statistic_location=0.008355789, statistic_sign=1),
                                80000: KstestResult(statistic=0.18062500000000004, pvalue=0.0, statistic_location=0.008824481, statistic_sign=1),
                                90000: KstestResult(statistic=0.1819222222222222, pvalue=0.0, statistic_location=0.00868197, statistic_sign=1),
                                100000: KstestResult(statistic=0.18227000000000004, pvalue=0.0, statistic_location=0.008537859, statistic_sign=1),
                                110000: KstestResult(statistic=0.18106363636363643, pvalue=0.0, statistic_location=0.008825486, statistic_sign=1),
                                120000: KstestResult(statistic=0.17998333333333327, pvalue=0.0, statistic_location=0.008815829, statistic_sign=1),
                                130000: KstestResult(statistic=0.1819846153846154, pvalue=0.0, statistic_location=0.008685648, statistic_sign=1),
                                140000: KstestResult(statistic=0.18357857142857148, pvalue=0.0, statistic_location=0.008653039, statistic_sign=1),
                                150000: KstestResult(statistic=0.18375333333333332, pvalue=0.0, statistic_location=0.008532513, statistic_sign=1),
                                160000: KstestResult(statistic=0.18300000000000005, pvalue=0.0, statistic_location=0.008884466, statistic_sign=1),
                                170000: KstestResult(statistic=0.18064705882352938, pvalue=0.0, statistic_location=0.0083454605, statistic_sign=1),
                                180000: KstestResult(statistic=0.18096666666666672, pvalue=0.0, statistic_location=0.008892294, statistic_sign=1),
                                190000: KstestResult(statistic=0.1815684210526316, pvalue=0.0, statistic_location=0.008533166, statistic_sign=1),
                                200000: KstestResult(statistic=0.18179999999999996, pvalue=0.0, statistic_location=0.008699607, statistic_sign=1),
                                210000: KstestResult(statistic=0.18151428571428574, pvalue=0.0, statistic_location=0.008649775, statistic_sign=1),
                                220000: KstestResult(statistic=0.1822818181818182, pvalue=0.0, statistic_location=0.0085410895, statistic_sign=1)},
                   'moments': {'mean_error': 0.19115709,
                               'means': [0.0011001013, 6.082704e-05],
                               'stds': [0.017806092, 0.0070842835],
                               'variance_ratio': 5.553443}},
 'originals': {'gan': {'mae': 0.0380764864385128,
                       'mse': 0.002808683319017291,
                       'psnr': 27.170913696289062,
                       'rmse': 0.05299701169133186,
                       'ssim': 0.6384521722793579},
               'pca': {'mae': 0.013318223878741264,
                       'mse': 0.00030600099125877023,
                       'psnr': 36.95209884643555,
                       'rmse': 0.017492884770035744,
                       'ssim': 0.9337785840034485}},
 'reconstructions': {'mae': 0.034576378762722015,
                     'mse': 0.002499900059774518,
                     'psnr': 27.830101013183594,
                     'rmse': 0.04999900236725807,
                     'ssim': 0.6685301065444946},
 'residual_spectra_pcagan': {'cosine': [0.507385,
                                        0.38936636,
                                        0.33017308,
                                        0.43177426,
                                        0.40205273,
                                        0.39541927,
                                        0.42181885,
                                        0.49101987,
                                        0.48281613,
                                        0.45497623,
                                        0.43638852,
                                        0.46759522,
                                        0.46482718,
                                        0.4733808,
                                        0.42759165,
                                        0.40701592,
                                        0.36436886,
                                        0.39055225,
                                        0.16900733,
                                        0.2208992,
                                        0.14418964,
                                        0.2866558],
                             'mae': [0.008534258,
                                     0.009452877,
                                     0.010798192,
                                     0.009670076,
                                     0.010669019,
                                     0.011371928,
                                     0.009797333,
                                     0.008804601,
                                     0.009385381,
                                     0.010119639,
                                     0.011200012,
                                     0.010706218,
                                     0.010579499,
                                     0.01047519,
                                     0.010666925,
                                     0.011147205,
                                     0.011694395,
                                     0.012893602,
                                     0.013422882,
                                     0.012395461,
                                     0.0130573055,
                                     0.011201816],
                             'max_mae': 0.013422882,
                             'max_mse': 0.00047842364,
                             'max_rmse': 0.021872897,
                             'median_distance': 1.6279411,
                             'median_mae': 0.0106876185,
                             'min_cosine': 0.14418964,
                             'mse': [0.00016308101,
                                     0.00026288672,
                                     0.00038473096,
                                     0.00020455955,
                                     0.00027678057,
                                     0.00033532735,
                                     0.00023922605,
                                     0.00017617304,
                                     0.00017686497,
                                     0.00021536868,
                                     0.00026716036,
                                     0.00023167496,
                                     0.00021409731,
                                     0.00023098028,
                                     0.00027462168,
                                     0.00031137274,
                                     0.0002698781,
                                     0.000326188,
                                     0.00036128497,
                                     0.00028650882,
                                     0.00047842364,
                                     0.0002513761],
                             'rmse': [0.0127703175,
                                      0.016213782,
                                      0.01961456,
                                      0.014302432,
                                      0.016636724,
                                      0.018311946,
                                      0.015466934,
                                      0.013273019,
                                      0.013299059,
                                      0.014675445,
                                      0.01634504,
                                      0.015220872,
                                      0.014632065,
                                      0.015198035,
                                      0.016571714,
                                      0.017645758,
                                      0.016427968,
                                      0.018060675,
                                      0.019007498,
                                      0.016926572,
                                      0.021872897,
                                      0.015854845]},
 'residuals': {'mae': 0.010820172727108002,
               'mse': 0.00026993482606485486,
               'psnr': 17.555988311767578,
               'rmse': 0.01642969250679016,
               'ssds': [70.01845, 11.041921],
               'ssim': 0.398060142993927},
 'spectra_pcagan': {'cosine': [0.98868686,
                               0.9901151,
                               0.97748345,
                               0.9893057,
                               0.98079205,
                               0.78375286,
                               0.9809329,
                               0.9851496,
                               0.98299485,
                               0.9814113,
                               0.9735501,
                               0.9832224,
                               0.98305935,
                               0.9901042,
                               0.9923352,
                               0.991061,
                               0.99216866,
                               0.99303746,
                               0.9934807,
                               0.9460728,
                               0.99268293,
                               0.99560434],
                    'mae': [0.026250565,
                            0.027503079,
                            0.027643835,
                            0.027743122,
                            0.029468365,
                            0.12338264,
                            0.027563497,
                            0.022475125,
                            0.024272991,
                            0.02522842,
                            0.032118756,
                            0.027429285,
                            0.027895544,
                            0.02290123,
                            0.022341331,
                            0.02861577,
                            0.024422085,
                            0.025036208,
                            0.028111469,
                            0.11266943,
                            0.025073059,
                            0.022534417],
                    'max_mae': 0.12338264,
                    'max_mse': 0.016976235,
                    'max_rmse': 0.13029288,
                    'median_mae': 0.027466182,
                    'min_cosine': 0.78375286,
                    'mse': [0.0011498089,
                            0.0014929074,
                            0.0014346571,
                            0.0013321571,
                            0.0014576862,
                            0.016976235,
                            0.0013586744,
                            0.00089246314,
                            0.0010252213,
                            0.0010811324,
                            0.0017013332,
                            0.0012154478,
                            0.0012653425,
                            0.0009027155,
                            0.00093609584,
                            0.0013586362,
                            0.000981142,
                            0.0010660418,
                            0.0013542139,
                            0.013989172,
                            0.0011892306,
                            0.0008374926],
                    'rmse': [0.033908833,
                             0.03863816,
                             0.037876867,
                             0.036498725,
                             0.03817966,
                             0.13029288,
                             0.0368602,
                             0.029874122,
                             0.03201908,
                             0.03288058,
                             0.04124722,
                             0.034863275,
                             0.035571653,
                             0.030045224,
                             0.030595683,
                             0.036859684,
                             0.031323187,
                             0.032650296,
                             0.036799647,
                             0.11827583,
                             0.034485225,
                             0.028939463]},
 'spectra_realgan': {'cosine': [0.9842291,
                                0.98721796,
                                0.9718723,
                                0.98598623,
                                0.97520953,
                                0.780534,
                                0.9755275,
                                0.9793157,
                                0.97710335,
                                0.97518146,
                                0.9669196,
                                0.97753185,
                                0.97859746,
                                0.98637134,
                                0.9898458,
                                0.9881862,
                                0.9905305,
                                0.99138755,
                                0.99331814,
                                0.9453109,
                                0.99234146,
                                0.9950525],
                     'mae': [0.031440936,
                             0.033348598,
                             0.032221723,
                             0.032824356,
                             0.034175165,
                             0.12317114,
                             0.032402918,
                             0.02734541,
                             0.028826457,
                             0.030067688,
                             0.0358877,
                             0.03158277,
                             0.031072445,
                             0.027463263,
                             0.026670083,
                             0.031908385,
                             0.027131576,
                             0.02845242,
                             0.028426602,
                             0.11330093,
                             0.02589158,
                             0.024070507],
                     'max_mae': 0.12317114,
                     'max_mse': 0.01724137,
                     'max_rmse': 0.1313064,
                     'median_mae': 0.03125669,
                     'min_cosine': 0.780534,
                     'mse': [0.0016158066,
                             0.0019652597,
                             0.0018079606,
                             0.0017648848,
                             0.0018782318,
                             0.01724137,
                             0.0017566839,
                             0.0012539066,
                             0.0013842706,
                             0.0014576598,
                             0.0020967317,
                             0.0015848848,
                             0.0015704782,
                             0.001245743,
                             0.0012406067,
                             0.0016640422,
                             0.0011867785,
                             0.0013200205,
                             0.0013787522,
                             0.014192749,
                             0.0012405147,
                             0.00094368943],
                     'rmse': [0.040197097,
                              0.04433125,
                              0.04252012,
                              0.04201053,
                              0.04333857,
                              0.1313064,
                              0.041912813,
                              0.035410546,
                              0.037205786,
                              0.038179312,
                              0.045790084,
                              0.039810613,
                              0.03962926,
                              0.035295084,
                              0.035222247,
                              0.040792674,
                              0.03444965,
                              0.036332086,
                              0.03713155,
                              0.11913332,
                              0.03522094,
                              0.030719528]},
 'spectra_realpca': {'cosine': [0.9957284,
                                0.9968967,
                                0.9940408,
                                0.99654305,
                                0.9944226,
                                0.9944764,
                                0.99425286,
                                0.9938278,
                                0.9937943,
                                0.99332976,
                                0.9933152,
                                0.9943187,
                                0.99502295,
                                0.9965092,
                                0.99761105,
                                0.99714595,
                                0.9981925,
                                0.99841917,
                                0.9997794,
                                0.9996515,
                                0.9996796,
                                0.9995365],
                     'mae': [0.016403027,
                             0.01703584,
                             0.015473636,
                             0.0164302,
                             0.0160013,
                             0.014894226,
                             0.015912617,
                             0.015331456,
                             0.015237259,
                             0.015751788,
                             0.015582587,
                             0.014978647,
                             0.014435187,
                             0.014058084,
                             0.013511142,
                             0.013750007,
                             0.0118399635,
                             0.01225786,
                             0.00506951,
                             0.006223878,
                             0.00562142,
                             0.00720131],
                     'max_mae': 0.01703584,
                     'max_mse': 0.00046626726,
                     'max_rmse': 0.021593222,
                     'median_mae': 0.014936436,
                     'min_cosine': 0.9933152,
                     'mse': [0.00042833117,
                             0.00046626726,
                             0.0003805129,
                             0.00043085832,
                             0.0004125548,
                             0.0003626909,
                             0.00040579162,
                             0.0003767033,
                             0.00037141764,
                             0.00039525397,
                             0.00038702926,
                             0.00036052,
                             0.00033595102,
                             0.0003175301,
                             0.00028985197,
                             0.00030344544,
                             0.00022611489,
                             0.00024300246,
                             4.1610198e-05,
                             6.214276e-05,
                             5.0401926e-05,
                             8.404078e-05],
                     'rmse': [0.020696163,
                              0.021593222,
                              0.01950674,
                              0.020757128,
                              0.020311445,
                              0.019044446,
                              0.02014427,
                              0.019408846,
                              0.019272199,
                              0.019880995,
                              0.019673059,
                              0.018987365,
                              0.018328967,
                              0.017819375,
                              0.01702504,
                              0.017419685,
                              0.0150371175,
                              0.015588536,
                              0.0064505967,
                              0.007883068,
                              0.0070994315,
                              0.009167376]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_70.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707
Directory path: experiments/inpainting/gann_4_night_20180723_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_70.0/images
Optimal number of principal components:  14
Reconstruction error:  25.005306
Energy conservation:  0.70290095
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_70.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.060522481510419, 3.3378250845445168],
                   'kl_div': 0.28957045,
                   'ks_tests': {10000: KstestResult(statistic=0.1667, pvalue=1.1383432326165781e-121, statistic_location=0.008097959, statistic_sign=1),
                                20000: KstestResult(statistic=0.16905000000000003, pvalue=2.702957167978701e-250, statistic_location=0.008278513, statistic_sign=1),
                                30000: KstestResult(statistic=0.16349999999999998, pvalue=0.0, statistic_location=0.008489558, statistic_sign=1),
                                40000: KstestResult(statistic=0.16259999999999997, pvalue=0.0, statistic_location=0.008611723, statistic_sign=1),
                                50000: KstestResult(statistic=0.16462, pvalue=0.0, statistic_location=0.008947099, statistic_sign=1),
                                60000: KstestResult(statistic=0.16111666666666657, pvalue=0.0, statistic_location=0.008850608, statistic_sign=1),
                                70000: KstestResult(statistic=0.15987142857142866, pvalue=0.0, statistic_location=0.008412453, statistic_sign=1),
                                80000: KstestResult(statistic=0.1603874999999999, pvalue=0.0, statistic_location=0.008338816, statistic_sign=1),
                                90000: KstestResult(statistic=0.16200000000000003, pvalue=0.0, statistic_location=0.008668912, statistic_sign=1),
                                100000: KstestResult(statistic=0.16191, pvalue=0.0, statistic_location=0.008606636, statistic_sign=1),
                                110000: KstestResult(statistic=0.16144545454545456, pvalue=0.0, statistic_location=0.008811679, statistic_sign=1),
                                120000: KstestResult(statistic=0.1611583333333334, pvalue=0.0, statistic_location=0.00854184, statistic_sign=1),
                                130000: KstestResult(statistic=0.16306153846153848, pvalue=0.0, statistic_location=0.009111771, statistic_sign=1),
                                140000: KstestResult(statistic=0.16203571428571428, pvalue=0.0, statistic_location=0.0080257375, statistic_sign=1),
                                150000: KstestResult(statistic=0.16282666666666668, pvalue=0.0, statistic_location=0.008810658, statistic_sign=1),
                                160000: KstestResult(statistic=0.16062500000000002, pvalue=0.0, statistic_location=0.008359057, statistic_sign=1),
                                170000: KstestResult(statistic=0.16121764705882358, pvalue=0.0, statistic_location=0.008406832, statistic_sign=1),
                                180000: KstestResult(statistic=0.16227777777777774, pvalue=0.0, statistic_location=0.008359057, statistic_sign=1),
                                190000: KstestResult(statistic=0.16256315789473685, pvalue=0.0, statistic_location=0.008965252, statistic_sign=1),
                                200000: KstestResult(statistic=0.16251500000000008, pvalue=0.0, statistic_location=0.008804735, statistic_sign=1),
                                210000: KstestResult(statistic=0.1618142857142857, pvalue=0.0, statistic_location=0.008395657, statistic_sign=1),
                                220000: KstestResult(statistic=0.16211818181818183, pvalue=0.0, statistic_location=0.009025235, statistic_sign=1),
                                230000: KstestResult(statistic=0.16122608695652174, pvalue=0.0, statistic_location=0.008841494, statistic_sign=1),
                                240000: KstestResult(statistic=0.16177916666666659, pvalue=0.0, statistic_location=0.008425146, statistic_sign=1),
                                250000: KstestResult(statistic=0.16093999999999997, pvalue=0.0, statistic_location=0.008802479, statistic_sign=1),
                                260000: KstestResult(statistic=0.1597653846153847, pvalue=0.0, statistic_location=0.0086041335, statistic_sign=1),
                                270000: KstestResult(statistic=0.16105925925925924, pvalue=0.0, statistic_location=0.0086013675, statistic_sign=1),
                                280000: KstestResult(statistic=0.16353571428571423, pvalue=0.0, statistic_location=0.00881431, statistic_sign=1),
                                290000: KstestResult(statistic=0.16259310344827593, pvalue=0.0, statistic_location=0.008359057, statistic_sign=1),
                                300000: KstestResult(statistic=0.16163000000000005, pvalue=0.0, statistic_location=0.00854184, statistic_sign=1),
                                310000: KstestResult(statistic=0.16180322580645157, pvalue=0.0, statistic_location=0.008534052, statistic_sign=1),
                                320000: KstestResult(statistic=0.16142812500000003, pvalue=0.0, statistic_location=0.008517668, statistic_sign=1),
                                330000: KstestResult(statistic=0.1625363636363637, pvalue=0.0, statistic_location=0.008513765, statistic_sign=1)},
                   'moments': {'mean_error': 0.03468057,
                               'means': [4.6829733e-05, 3.920289e-05],
                               'stds': [0.017160652, 0.0068636234],
                               'variance_ratio': 5.6437564}},
 'originals': {'gan': {'mae': 0.03633355721831322,
                       'mse': 0.0025020292960107327,
                       'psnr': 28.304941177368164,
                       'rmse': 0.05002028867602348,
                       'ssim': 0.6518835425376892},
               'pca': {'mae': 0.013142166659235954,
                       'mse': 0.00030133489053696394,
                       'psnr': 37.80168914794922,
                       'rmse': 0.017358999699354172,
                       'ssim': 0.9540695548057556}},
 'reconstructions': {'mae': 0.033022910356521606,
                     'mse': 0.0022023473866283894,
                     'psnr': 29.163320541381836,
                     'rmse': 0.04692917317152023,
                     'ssim': 0.6709173917770386},
 'residual_spectra_pcagan': {'cosine': [0.46029276,
                                        0.4269124,
                                        0.44582587,
                                        0.37048247,
                                        0.47614026,
                                        0.35613775,
                                        0.39490724,
                                        0.35868168,
                                        0.41731054,
                                        0.41708604,
                                        0.37882534,
                                        0.48585644,
                                        0.35291886,
                                        0.46410307,
                                        0.47047612,
                                        0.41947117,
                                        0.48049065,
                                        0.48796532,
                                        0.44784832,
                                        0.4292836,
                                        0.4566459,
                                        0.42020467,
                                        0.37931186,
                                        0.4017088,
                                        0.16128065,
                                        0.23386094,
                                        0.18548554,
                                        0.22177525,
                                        0.23564868,
                                        0.33489025,
                                        0.45319542,
                                        0.24020101,
                                        0.23526013],
                             'mae': [0.009227953,
                                     0.0098242145,
                                     0.009053658,
                                     0.010067137,
                                     0.00898726,
                                     0.010223965,
                                     0.009797458,
                                     0.01034517,
                                     0.009693579,
                                     0.010005623,
                                     0.010719651,
                                     0.009935909,
                                     0.010911178,
                                     0.0104546035,
                                     0.009219918,
                                     0.010288755,
                                     0.0098479735,
                                     0.009796757,
                                     0.0108249085,
                                     0.011128074,
                                     0.009903569,
                                     0.010934663,
                                     0.010805082,
                                     0.012212186,
                                     0.012873819,
                                     0.011778425,
                                     0.013347779,
                                     0.013008963,
                                     0.011166853,
                                     0.010885532,
                                     0.009577637,
                                     0.011135552,
                                     0.012171857],
                             'max_mae': 0.013347779,
                             'max_mse': 0.00034488534,
                             'max_rmse': 0.018571088,
                             'median_distance': 1.5725129,
                             'median_mae': 0.01034517,
                             'min_cosine': 0.16128065,
                             'mse': [0.00018725455,
                                     0.00022722845,
                                     0.00019211021,
                                     0.00030732946,
                                     0.00017524954,
                                     0.00030153064,
                                     0.0002501641,
                                     0.00029604998,
                                     0.00023949024,
                                     0.0002170707,
                                     0.00029866045,
                                     0.00021012001,
                                     0.00034488534,
                                     0.00021824031,
                                     0.00018208167,
                                     0.00027163938,
                                     0.00018847997,
                                     0.00019959993,
                                     0.0002472797,
                                     0.00025992066,
                                     0.00021344419,
                                     0.00027005115,
                                     0.0002720629,
                                     0.0002900335,
                                     0.0003052134,
                                     0.00025266825,
                                     0.0003245164,
                                     0.00033174918,
                                     0.00023801945,
                                     0.00022312923,
                                     0.00019140563,
                                     0.00023826986,
                                     0.00031366153],
                             'rmse': [0.013684099,
                                      0.0150740985,
                                      0.013860383,
                                      0.017530814,
                                      0.013238185,
                                      0.017364638,
                                      0.015816577,
                                      0.017206103,
                                      0.015475472,
                                      0.014733319,
                                      0.017281795,
                                      0.014495517,
                                      0.018571088,
                                      0.014772959,
                                      0.013493764,
                                      0.016481485,
                                      0.013728801,
                                      0.014127984,
                                      0.01572513,
                                      0.016122054,
                                      0.014609729,
                                      0.016433233,
                                      0.01649433,
                                      0.01703037,
                                      0.017470358,
                                      0.015895542,
                                      0.01801434,
                                      0.018213984,
                                      0.015427879,
                                      0.014937511,
                                      0.013834942,
                                      0.015435993,
                                      0.017710492]},
 'residuals': {'mae': 0.01061077881604433,
               'mse': 0.00025086698587983847,
               'psnr': 17.874141693115234,
               'rmse': 0.015838781371712685,
               'ssds': [97.18146, 15.546539],
               'ssim': 0.38015052676200867},
 'spectra_pcagan': {'cosine': [0.989082,
                               0.9866598,
                               0.98944664,
                               0.98877347,
                               0.98809165,
                               0.992038,
                               0.9858042,
                               0.98810667,
                               0.9768887,
                               0.9873277,
                               0.9755297,
                               0.7652261,
                               0.9763292,
                               0.97817093,
                               0.9835453,
                               0.9790399,
                               0.9771265,
                               0.9821529,
                               0.98225665,
                               0.98760206,
                               0.99305713,
                               0.99101704,
                               0.99310327,
                               0.9929157,
                               0.9939675,
                               0.93871206,
                               0.9920934,
                               0.9931887,
                               0.99553436,
                               0.9942709,
                               0.99316,
                               0.9934604,
                               0.99408865],
                    'mae': [0.025300054,
                            0.025704674,
                            0.024661416,
                            0.026054675,
                            0.033343747,
                            0.035338975,
                            0.028519757,
                            0.030671265,
                            0.029686935,
                            0.0328185,
                            0.03265288,
                            0.12521987,
                            0.033232894,
                            0.028722193,
                            0.023569537,
                            0.02637793,
                            0.028060254,
                            0.026091186,
                            0.027504971,
                            0.025618665,
                            0.021818174,
                            0.023631362,
                            0.026209185,
                            0.026499204,
                            0.027625976,
                            0.118251234,
                            0.027746247,
                            0.02930352,
                            0.022232754,
                            0.024051612,
                            0.025559843,
                            0.02391673,
                            0.023759872],
                    'max_mae': 0.12521987,
                    'max_mse': 0.01710041,
                    'max_rmse': 0.13076854,
                    'median_mae': 0.026499204,
                    'min_cosine': 0.7652261,
                    'mse': [0.0011733988,
                            0.0012275602,
                            0.0011144554,
                            0.0013506657,
                            0.001725329,
                            0.0023417019,
                            0.0014302805,
                            0.0018259828,
                            0.0014648377,
                            0.0017990328,
                            0.001797277,
                            0.01710041,
                            0.0018979119,
                            0.0013126847,
                            0.0009653323,
                            0.0012714997,
                            0.0012973539,
                            0.0011156059,
                            0.0012789648,
                            0.0011281405,
                            0.0008361744,
                            0.0009679714,
                            0.0012067095,
                            0.0011452984,
                            0.0012989083,
                            0.015250104,
                            0.0012425451,
                            0.0013762531,
                            0.0008157287,
                            0.00093953934,
                            0.0010579183,
                            0.0009354556,
                            0.000986445],
                    'rmse': [0.03425491,
                             0.035036556,
                             0.03338346,
                             0.036751404,
                             0.04153708,
                             0.048391134,
                             0.03781905,
                             0.04273152,
                             0.038273197,
                             0.042415008,
                             0.042394303,
                             0.13076854,
                             0.04356503,
                             0.036230993,
                             0.031069798,
                             0.035658095,
                             0.0360188,
                             0.03340069,
                             0.03576262,
                             0.033587802,
                             0.028916681,
                             0.031112239,
                             0.034737725,
                             0.03384226,
                             0.03604037,
                             0.12349131,
                             0.035249755,
                             0.037097886,
                             0.028560964,
                             0.030651907,
                             0.032525655,
                             0.030585218,
                             0.03140772]},
 'spectra_realgan': {'cosine': [0.9853615,
                                0.98258543,
                                0.9856474,
                                0.9851338,
                                0.984329,
                                0.99031156,
                                0.98180956,
                                0.98528373,
                                0.9705359,
                                0.9841244,
                                0.97035795,
                                0.7620096,
                                0.97086906,
                                0.97172827,
                                0.9779625,
                                0.972823,
                                0.97121984,
                                0.9764071,
                                0.9774111,
                                0.9842012,
                                0.9908751,
                                0.988503,
                                0.99136573,
                                0.99136275,
                                0.9938161,
                                0.93792564,
                                0.9917588,
                                0.9926461,
                                0.9952032,
                                0.99350864,
                                0.9913412,
                                0.9930881,
                                0.99357057],
                     'mae': [0.030530972,
                             0.030791193,
                             0.030059448,
                             0.0313553,
                             0.037733283,
                             0.040095396,
                             0.033139832,
                             0.035893507,
                             0.034247417,
                             0.037181355,
                             0.036715627,
                             0.12498476,
                             0.03719928,
                             0.032989483,
                             0.028168092,
                             0.031044383,
                             0.032051705,
                             0.03024074,
                             0.031106269,
                             0.029624596,
                             0.025745625,
                             0.027455023,
                             0.028595844,
                             0.02936131,
                             0.027916009,
                             0.11887655,
                             0.028403101,
                             0.030436695,
                             0.02315335,
                             0.025683567,
                             0.028439276,
                             0.02468956,
                             0.025098836],
                     'max_mae': 0.12498476,
                     'max_mse': 0.017367896,
                     'max_rmse': 0.13178732,
                     'median_mae': 0.030530972,
                     'min_cosine': 0.7620096,
                     'mse': [0.0015800683,
                             0.0016178509,
                             0.0015267154,
                             0.0017768774,
                             0.002220343,
                             0.0028388621,
                             0.0018547642,
                             0.0022986257,
                             0.0018829292,
                             0.002236509,
                             0.002192321,
                             0.017367896,
                             0.0023084248,
                             0.0017121965,
                             0.0013083473,
                             0.0016486477,
                             0.0016477448,
                             0.0014849999,
                             0.0016116272,
                             0.0014472858,
                             0.0011033883,
                             0.0012375779,
                             0.0014112631,
                             0.0013873327,
                             0.0013198494,
                             0.015459917,
                             0.0012949291,
                             0.0014868721,
                             0.0008778509,
                             0.0010612711,
                             0.0013000794,
                             0.0009889302,
                             0.0010746688],
                     'rmse': [0.039750073,
                              0.04022252,
                              0.039073206,
                              0.042153023,
                              0.047120515,
                              0.053280972,
                              0.043066975,
                              0.047943983,
                              0.043392733,
                              0.047291745,
                              0.046822228,
                              0.13178732,
                              0.04804607,
                              0.041378696,
                              0.036171082,
                              0.040603545,
                              0.040592425,
                              0.038535696,
                              0.040145077,
                              0.03804321,
                              0.03321729,
                              0.035179224,
                              0.03756678,
                              0.037246916,
                              0.03632973,
                              0.12433791,
                              0.035985123,
                              0.03855998,
                              0.029628549,
                              0.032577157,
                              0.036056615,
                              0.03144726,
                              0.03278214]},
 'spectra_realpca': {'cosine': [0.99597967,
                                0.99559885,
                                0.9959716,
                                0.9962042,
                                0.9962934,
                                0.99811447,
                                0.9957284,
                                0.9968967,
                                0.9940408,
                                0.99654305,
                                0.9944226,
                                0.9944764,
                                0.99425286,
                                0.9938278,
                                0.9937943,
                                0.99332976,
                                0.9933152,
                                0.9943187,
                                0.99502295,
                                0.9965092,
                                0.99761105,
                                0.99714595,
                                0.9981925,
                                0.99841917,
                                0.9997794,
                                0.9996515,
                                0.9996796,
                                0.9995365,
                                0.99967295,
                                0.99918664,
                                0.9980967,
                                0.9994989,
                                0.9993839],
                     'mae': [0.01619292,
                             0.015960563,
                             0.016460583,
                             0.01659565,
                             0.016499152,
                             0.017469807,
                             0.016403027,
                             0.01703584,
                             0.015473636,
                             0.0164302,
                             0.0160013,
                             0.014894226,
                             0.015912617,
                             0.015331456,
                             0.015237259,
                             0.015751788,
                             0.015582587,
                             0.014978647,
                             0.014435187,
                             0.014058084,
                             0.013511142,
                             0.013750007,
                             0.0118399635,
                             0.01225786,
                             0.00506951,
                             0.006223878,
                             0.00562142,
                             0.00720131,
                             0.0061032358,
                             0.008598907,
                             0.012072447,
                             0.0066941064,
                             0.008043259],
                     'max_mae': 0.017469807,
                     'max_mse': 0.00048671418,
                     'max_rmse': 0.0220616,
                     'median_mae': 0.014978647,
                     'min_cosine': 0.9933152,
                     'mse': [0.00042093097,
                             0.00040833282,
                             0.0004299082,
                             0.00044153942,
                             0.0004383818,
                             0.00048671418,
                             0.00042833117,
                             0.00046626726,
                             0.0003805129,
                             0.00043085832,
                             0.0004125548,
                             0.0003626909,
                             0.00040579162,
                             0.0003767033,
                             0.00037141764,
                             0.00039525397,
                             0.00038702926,
                             0.00036052,
                             0.00033595102,
                             0.0003175301,
                             0.00028985197,
                             0.00030344544,
                             0.00022611489,
                             0.00024300246,
                             4.1610198e-05,
                             6.214276e-05,
                             5.0401926e-05,
                             8.404078e-05,
                             5.9760026e-05,
                             0.00011886104,
                             0.00023261135,
                             7.173531e-05,
                             0.00010325319],
                     'rmse': [0.020516602,
                              0.020207247,
                              0.020734228,
                              0.021012839,
                              0.02093757,
                              0.0220616,
                              0.020696163,
                              0.021593222,
                              0.01950674,
                              0.020757128,
                              0.020311445,
                              0.019044446,
                              0.02014427,
                              0.019408846,
                              0.019272199,
                              0.019880995,
                              0.019673059,
                              0.018987365,
                              0.018328967,
                              0.017819375,
                              0.01702504,
                              0.017419685,
                              0.0150371175,
                              0.015588536,
                              0.0064505967,
                              0.007883068,
                              0.0070994315,
                              0.009167376,
                              0.0077304607,
                              0.010902341,
                              0.015251601,
                              0.00846967,
                              0.010161358]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_70.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529
Directory path: experiments/inpainting/gann_4_night_20180901_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_70.0/images
Optimal number of principal components:  26
Reconstruction error:  9.677378
Energy conservation:  0.70862496
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_70.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.932551248322828, 2.507928584785546],
                   'kl_div': 0.8549107,
                   'ks_tests': {10000: KstestResult(statistic=0.2719, pvalue=1e-323, statistic_location=-0.0036641173, statistic_sign=-1),
                                20000: KstestResult(statistic=0.27340000000000003, pvalue=0.0, statistic_location=-0.0031758216, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2700666666666667, pvalue=0.0, statistic_location=0.0032980782, statistic_sign=1),
                                40000: KstestResult(statistic=0.2735, pvalue=0.0, statistic_location=-0.003390966, statistic_sign=-1),
                                50000: KstestResult(statistic=0.26880000000000004, pvalue=0.0, statistic_location=0.00334787, statistic_sign=1),
                                60000: KstestResult(statistic=0.26644999999999996, pvalue=0.0, statistic_location=0.0033489042, statistic_sign=1),
                                70000: KstestResult(statistic=0.26845714285714295, pvalue=0.0, statistic_location=0.003348189, statistic_sign=1),
                                80000: KstestResult(statistic=0.26935, pvalue=0.0, statistic_location=-0.003210336, statistic_sign=-1),
                                90000: KstestResult(statistic=0.269, pvalue=0.0, statistic_location=-0.0032119378, statistic_sign=-1),
                                100000: KstestResult(statistic=0.26912, pvalue=0.0, statistic_location=-0.0030740872, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2669454545454545, pvalue=0.0, statistic_location=0.0033326722, statistic_sign=1)},
                   'moments': {'mean_error': 0.25456026,
                               'means': [0.0006159432, 1.5157378e-06],
                               'stds': [0.023046242, 0.0035773274],
                               'variance_ratio': 46.638073}},
 'originals': {'gan': {'mae': 0.10246788710355759,
                       'mse': 0.08953791111707687,
                       'psnr': 15.509013175964355,
                       'rmse': 0.29922884702682495,
                       'ssim': 0.8870316743850708},
               'pca': {'mae': 0.003969588782638311,
                       'mse': 4.0141683712136e-05,
                       'psnr': 49.28081130981445,
                       'rmse': 0.006335746496915817,
                       'ssim': 0.9958575963973999}},
 'reconstructions': {'mae': 0.10173091292381287,
                     'mse': 0.08950123935937881,
                     'psnr': 15.798474311828613,
                     'rmse': 0.29916757345199585,
                     'ssim': 0.8900654315948486},
 'residual_spectra_pcagan': {'cosine': [0.04898133,
                                        0.28591478,
                                        0.35861912,
                                        0.10017503,
                                        0.1001701,
                                        0.33969048,
                                        0.29522187,
                                        0.09743013,
                                        0.22221725,
                                        0.064096585,
                                        0.009676992],
                             'mae': [0.011406344,
                                     0.0109864995,
                                     0.0089774225,
                                     0.011132939,
                                     0.011112259,
                                     0.008434337,
                                     0.009577074,
                                     0.010731279,
                                     0.00979482,
                                     0.010071489,
                                     0.025216209],
                             'max_mae': 0.025216209,
                             'max_mse': 0.0031047212,
                             'max_rmse': 0.055720024,
                             'median_distance': 1.564904,
                             'median_mae': 0.010731279,
                             'min_cosine': 0.009676992,
                             'mse': [0.00028260585,
                                     0.00041951498,
                                     0.00021933946,
                                     0.00027629253,
                                     0.0003369235,
                                     0.00018502711,
                                     0.00018739841,
                                     0.00024489246,
                                     0.00024282286,
                                     0.00021345088,
                                     0.0031047212],
                             'rmse': [0.016810885,
                                      0.020482065,
                                      0.014810113,
                                      0.01662205,
                                      0.018355476,
                                      0.013602467,
                                      0.013689354,
                                      0.015649041,
                                      0.015582775,
                                      0.014609958,
                                      0.055720024]},
 'residuals': {'mae': 0.011585515923798084,
               'mse': 0.0005193626275286078,
               'psnr': 7.625208854675293,
               'rmse': 0.022789528593420982,
               'ssds': [58.465424, 1.4076872],
               'ssim': 0.6134417653083801},
 'spectra_pcagan': {'cosine': [0.99907255,
                               0.9942656,
                               0.9965317,
                               0.9978649,
                               0.9987705,
                               0.99726826,
                               0.9975589,
                               0.99855834,
                               0.9975253,
                               0.99884415,
                               -0.64519274],
                    'mae': [0.0150596555,
                            0.020376084,
                            0.017230583,
                            0.018580774,
                            0.014564969,
                            0.013955578,
                            0.015809119,
                            0.015390905,
                            0.015496906,
                            0.014145871,
                            0.9584296],
                    'max_mae': 0.9584296,
                    'max_mse': 0.9801426,
                    'max_rmse': 0.9900215,
                    'median_mae': 0.015496906,
                    'min_cosine': -0.64519274,
                    'mse': [0.00038026145,
                            0.00068158004,
                            0.0004959321,
                            0.00056324335,
                            0.00036959007,
                            0.00035652646,
                            0.00039958803,
                            0.0003830555,
                            0.0004112994,
                            0.0003300463,
                            0.9801426],
                    'rmse': [0.019500293,
                             0.026107088,
                             0.022269534,
                             0.023732748,
                             0.019224726,
                             0.018881908,
                             0.019989697,
                             0.019571804,
                             0.020280518,
                             0.018167177,
                             0.9900215]},
 'spectra_realgan': {'cosine': [0.99906915,
                                0.9933958,
                                0.99578017,
                                0.9978164,
                                0.9987539,
                                0.99656457,
                                0.9971878,
                                0.99853414,
                                0.99725324,
                                0.9988347,
                                -0.6451682],
                     'mae': [0.015093413,
                             0.021834007,
                             0.018909004,
                             0.01878682,
                             0.014685913,
                             0.016091838,
                             0.017106565,
                             0.015522933,
                             0.016487284,
                             0.014210428,
                             0.95841867],
                     'max_mae': 0.95841867,
                     'max_mse': 0.98011833,
                     'max_rmse': 0.99000925,
                     'median_mae': 0.016487284,
                     'min_cosine': -0.6451682,
                     'mse': [0.00038180794,
                             0.0007860678,
                             0.00059797306,
                             0.00057443464,
                             0.00037425736,
                             0.00044651533,
                             0.00046026468,
                             0.00038939103,
                             0.0004553615,
                             0.00033263222,
                             0.98011833],
                     'rmse': [0.019539906,
                              0.0280369,
                              0.024453487,
                              0.023967367,
                              0.019345732,
                              0.02113091,
                              0.02145378,
                              0.019732993,
                              0.0213392,
                              0.018238207,
                              0.99000925]},
 'spectra_realpca': {'cosine': [0.99999744,
                                0.99904144,
                                0.99923843,
                                0.9999636,
                                0.99999017,
                                0.9992171,
                                0.9996236,
                                0.99997795,
                                0.99973816,
                                0.99999,
                                0.9999979],
                     'mae': [0.00076738006,
                             0.008408425,
                             0.008023893,
                             0.0021704328,
                             0.0013434107,
                             0.007872723,
                             0.0061206953,
                             0.0019104822,
                             0.0051592235,
                             0.0013248421,
                             0.00056396925],
                     'max_mae': 0.008408425,
                     'max_mse': 0.00011407194,
                     'max_rmse': 0.010680446,
                     'median_mae': 0.0021704328,
                     'min_cosine': 0.99904144,
                     'mse': [9.4421597e-07,
                             0.00011407194,
                             0.0001037012,
                             7.4912728e-06,
                             2.8822963e-06,
                             0.00010008027,
                             6.0665356e-05,
                             5.87709e-06,
                             4.248637e-05,
                             2.8424445e-06,
                             5.160445e-07],
                     'rmse': [0.00097170775,
                              0.010680446,
                              0.010183378,
                              0.002737019,
                              0.0016977327,
                              0.010004013,
                              0.007788797,
                              0.002424271,
                              0.0065181567,
                              0.0016859551,
                              0.0007183624]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_70.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319
Directory path: experiments/inpainting/gann_4_night_20180901_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_70.0/images
Optimal number of principal components:  26
Reconstruction error:  9.677378
Energy conservation:  0.70862496
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_70.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.940780002103074, 2.621942367717084],
                   'kl_div': 0.7523233,
                   'ks_tests': {10000: KstestResult(statistic=0.2554, pvalue=7.34501808882071e-287, statistic_location=-0.0040744543, statistic_sign=-1),
                                20000: KstestResult(statistic=0.25144999999999995, pvalue=0.0, statistic_location=-0.0035662903, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2567666666666667, pvalue=0.0, statistic_location=-0.0040331706, statistic_sign=-1),
                                40000: KstestResult(statistic=0.255275, pvalue=0.0, statistic_location=-0.0039032327, statistic_sign=-1),
                                50000: KstestResult(statistic=0.25592000000000004, pvalue=0.0, statistic_location=-0.0036867484, statistic_sign=-1),
                                60000: KstestResult(statistic=0.25803333333333334, pvalue=0.0, statistic_location=-0.0038899481, statistic_sign=-1),
                                70000: KstestResult(statistic=0.25567142857142855, pvalue=0.0, statistic_location=-0.0038325898, statistic_sign=-1),
                                80000: KstestResult(statistic=0.25606249999999997, pvalue=0.0, statistic_location=-0.0036771782, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2566111111111111, pvalue=0.0, statistic_location=-0.0038500074, statistic_sign=-1),
                                100000: KstestResult(statistic=0.25834, pvalue=0.0, statistic_location=-0.0038174144, statistic_sign=-1),
                                110000: KstestResult(statistic=0.25582727272727274, pvalue=0.0, statistic_location=-0.0039333105, statistic_sign=-1),
                                120000: KstestResult(statistic=0.25782499999999997, pvalue=0.0, statistic_location=-0.0038184077, statistic_sign=-1),
                                130000: KstestResult(statistic=0.25737692307692306, pvalue=0.0, statistic_location=-0.0036149025, statistic_sign=-1),
                                140000: KstestResult(statistic=0.25314285714285717, pvalue=0.0, statistic_location=-0.0039960393, statistic_sign=-1),
                                150000: KstestResult(statistic=0.25514, pvalue=0.0, statistic_location=-0.0038025132, statistic_sign=-1),
                                160000: KstestResult(statistic=0.25421875, pvalue=0.0, statistic_location=-0.0039459094, statistic_sign=-1),
                                170000: KstestResult(statistic=0.25213529411764707, pvalue=0.0, statistic_location=-0.0039952006, statistic_sign=-1),
                                180000: KstestResult(statistic=0.25413888888888886, pvalue=0.0, statistic_location=-0.0039276746, statistic_sign=-1),
                                190000: KstestResult(statistic=0.25357894736842107, pvalue=0.0, statistic_location=-0.0038025132, statistic_sign=-1),
                                200000: KstestResult(statistic=0.254875, pvalue=0.0, statistic_location=-0.003945441, statistic_sign=-1),
                                210000: KstestResult(statistic=0.25417619047619044, pvalue=0.0, statistic_location=-0.00394619, statistic_sign=-1),
                                220000: KstestResult(statistic=0.2536590909090909, pvalue=0.0, statistic_location=-0.0038911272, statistic_sign=-1)},
                   'moments': {'mean_error': 0.0023712402,
                               'means': [-0.00023313925, -1.3377157e-05],
                               'stds': [0.0203259, 0.003905028],
                               'variance_ratio': 22.580202}},
 'originals': {'gan': {'mae': 0.0791468694806099,
                       'mse': 0.051039062440395355,
                       'psnr': 18.142791748046875,
                       'rmse': 0.2259182631969452,
                       'ssim': 0.575168788433075},
               'pca': {'mae': 0.005155245307832956,
                       'mse': 6.636708712903783e-05,
                       'psnr': 47.246341705322266,
                       'rmse': 0.008146599866449833,
                       'ssim': 0.9973799586296082}},
 'reconstructions': {'mae': 0.07838747650384903,
                     'mse': 0.05097973719239235,
                     'psnr': 18.391897201538086,
                     'rmse': 0.22578692436218262,
                     'ssim': 0.5766149759292603},
 'residual_spectra_pcagan': {'cosine': [0.34059697,
                                        0.296372,
                                        0.2265262,
                                        0.24988405,
                                        0.31802732,
                                        0.05293219,
                                        0.29992354,
                                        0.37987387,
                                        0.10708454,
                                        0.10769904,
                                        0.36602485,
                                        0.29922724,
                                        0.10094441,
                                        0.24900123,
                                        0.07550804,
                                        0.0074080434,
                                        0.09095344,
                                        0.03267076,
                                        0.037157822,
                                        0.30915037,
                                        0.07983037,
                                        0.36209545],
                             'mae': [0.009652891,
                                     0.010880348,
                                     0.011284053,
                                     0.011067734,
                                     0.009896592,
                                     0.011196353,
                                     0.010559262,
                                     0.0086399205,
                                     0.010700629,
                                     0.010481129,
                                     0.00813008,
                                     0.0095237885,
                                     0.010187093,
                                     0.0093294345,
                                     0.009505008,
                                     0.025698578,
                                     0.010513859,
                                     0.01285987,
                                     0.01143203,
                                     0.010205852,
                                     0.01136879,
                                     0.008372747],
                             'max_mae': 0.025698578,
                             'max_mse': 0.0032348777,
                             'max_rmse': 0.056875985,
                             'median_distance': 1.5785184,
                             'median_mae': 0.010497494,
                             'min_cosine': 0.0074080434,
                             'mse': [0.00021043024,
                                     0.00034395937,
                                     0.0005412859,
                                     0.00033852953,
                                     0.00028649348,
                                     0.00027097273,
                                     0.00037531139,
                                     0.0001899909,
                                     0.00024491423,
                                     0.00027406908,
                                     0.00016156904,
                                     0.00018410702,
                                     0.00021031595,
                                     0.0001996754,
                                     0.00017558597,
                                     0.0032348777,
                                     0.00021312461,
                                     0.00033322035,
                                     0.00025346657,
                                     0.00022110168,
                                     0.0003121575,
                                     0.00018117971],
                             'rmse': [0.014506214,
                                      0.018546142,
                                      0.023265552,
                                      0.018399172,
                                      0.01692612,
                                      0.01646125,
                                      0.019372955,
                                      0.013783718,
                                      0.015649736,
                                      0.016555032,
                                      0.012710981,
                                      0.013568604,
                                      0.014502274,
                                      0.014130655,
                                      0.0132508855,
                                      0.056875985,
                                      0.014598788,
                                      0.018254325,
                                      0.015920633,
                                      0.014869489,
                                      0.017667979,
                                      0.013460302]},
 'residuals': {'mae': 0.0109766386449337,
               'mse': 0.0003980153996963054,
               'psnr': 16.91669464111328,
               'rmse': 0.019950322806835175,
               'ssds': [90.90281, 3.3548582],
               'ssim': 0.6283787488937378},
 'spectra_pcagan': {'cosine': [0.9693327,
                               0.98749053,
                               0.9800592,
                               0.98728937,
                               0.99620855,
                               0.99905336,
                               0.9942044,
                               0.99655396,
                               0.99787134,
                               0.9988013,
                               0.99739337,
                               0.99748814,
                               0.99854606,
                               0.99752665,
                               0.99888146,
                               -0.644539,
                               0.9987071,
                               0.9994835,
                               0.9991632,
                               0.9956808,
                               0.0060078856,
                               0.98961884],
                    'mae': [0.035722338,
                            0.046143144,
                            0.032908466,
                            0.034490667,
                            0.017347174,
                            0.015069921,
                            0.020465085,
                            0.017146872,
                            0.018495517,
                            0.014431315,
                            0.013788835,
                            0.01609406,
                            0.015432757,
                            0.015548357,
                            0.013966398,
                            0.95869374,
                            0.015661312,
                            0.014384128,
                            0.014909537,
                            0.020751495,
                            0.3448854,
                            0.02818794],
                    'max_mae': 0.95869374,
                    'max_mse': 0.9810451,
                    'max_rmse': 0.9904772,
                    'median_mae': 0.017247023,
                    'min_cosine': -0.644539,
                    'mse': [0.0017458323,
                            0.002988565,
                            0.0019197729,
                            0.0017756263,
                            0.00054334174,
                            0.00038043672,
                            0.00068811484,
                            0.000488745,
                            0.000555594,
                            0.00036130054,
                            0.00034033335,
                            0.00041329785,
                            0.00038615946,
                            0.00041218128,
                            0.00031932682,
                            0.9810451,
                            0.000392268,
                            0.00033293382,
                            0.0003589183,
                            0.0006600227,
                            0.12425017,
                            0.0011961174],
                    'rmse': [0.041783158,
                             0.05466777,
                             0.043815214,
                             0.04213818,
                             0.023309693,
                             0.019504787,
                             0.026231943,
                             0.022107577,
                             0.02357104,
                             0.019007908,
                             0.018448126,
                             0.020329729,
                             0.01965094,
                             0.02030225,
                             0.017869718,
                             0.9904772,
                             0.019805757,
                             0.018246474,
                             0.018945139,
                             0.025690908,
                             0.35249138,
                             0.03458493]},
 'spectra_realgan': {'cosine': [0.9670778,
                                0.9860739,
                                0.9780557,
                                0.98576266,
                                0.9951324,
                                0.99904984,
                                0.993334,
                                0.9958081,
                                0.9978229,
                                0.99878496,
                                0.99668676,
                                0.99711907,
                                0.9985224,
                                0.9972569,
                                0.99887186,
                                -0.6445148,
                                0.9986888,
                                0.9994831,
                                0.9991609,
                                0.9950985,
                                0.00620771,
                                0.98793983],
                     'mae': [0.03637817,
                             0.046589788,
                             0.034258008,
                             0.035527002,
                             0.019814119,
                             0.015101448,
                             0.02191781,
                             0.018824134,
                             0.018703619,
                             0.014546591,
                             0.015915832,
                             0.017371306,
                             0.015557715,
                             0.016533135,
                             0.014031367,
                             0.95868284,
                             0.01574498,
                             0.0143905,
                             0.014926655,
                             0.02216288,
                             0.34483683,
                             0.029416408],
                     'max_mae': 0.95868284,
                     'max_mse': 0.9810211,
                     'max_rmse': 0.9904651,
                     'median_mae': 0.018763877,
                     'min_cosine': -0.6445148,
                     'mse': [0.0018786305,
                             0.0031433513,
                             0.0020680984,
                             0.0019107212,
                             0.00067015114,
                             0.00038199013,
                             0.00079278374,
                             0.0005900748,
                             0.0005667468,
                             0.00036588818,
                             0.000430694,
                             0.00047388955,
                             0.0003922552,
                             0.0004558564,
                             0.00032200202,
                             0.9810211,
                             0.0003959076,
                             0.0003332668,
                             0.00035991942,
                             0.0007465529,
                             0.12421885,
                             0.001340763],
                     'rmse': [0.04334317,
                              0.056065597,
                              0.04547635,
                              0.043711796,
                              0.025887277,
                              0.019544568,
                              0.028156416,
                              0.024291456,
                              0.023806445,
                              0.019128203,
                              0.020753168,
                              0.021769004,
                              0.019805433,
                              0.021350794,
                              0.017944414,
                              0.9904651,
                              0.019897427,
                              0.018255597,
                              0.018971542,
                              0.02732312,
                              0.35244694,
                              0.03661643]},
 'spectra_realpca': {'cosine': [0.997499,
                                0.9987663,
                                0.9979486,
                                0.9983251,
                                0.99898195,
                                0.99999744,
                                0.99904144,
                                0.99923843,
                                0.9999636,
                                0.99999017,
                                0.9992171,
                                0.9996236,
                                0.99997795,
                                0.99973816,
                                0.99999,
                                0.9999979,
                                0.99999225,
                                0.9999996,
                                0.9999983,
                                0.999509,
                                0.9999339,
                                0.9982045],
                     'mae': [0.009511348,
                             0.010627886,
                             0.010007582,
                             0.009943031,
                             0.008479736,
                             0.00076738006,
                             0.008408425,
                             0.008023893,
                             0.0021704328,
                             0.0013434107,
                             0.007872723,
                             0.0061206953,
                             0.0019104822,
                             0.0051592235,
                             0.0013248421,
                             0.00056396925,
                             0.0011945649,
                             0.00039777166,
                             0.0006966713,
                             0.0065849824,
                             0.0020740354,
                             0.0102323],
                     'max_mae': 0.010627886,
                     'max_mse': 0.00019031925,
                     'max_rmse': 0.0137956245,
                     'median_mae': 0.005639959,
                     'min_cosine': 0.997499,
                     'mse': [0.0001446648,
                             0.00019031925,
                             0.0001604451,
                             0.00015755264,
                             0.00011548026,
                             9.4421597e-07,
                             0.00011407194,
                             0.0001037012,
                             7.4912728e-06,
                             2.8822963e-06,
                             0.00010008027,
                             6.0665356e-05,
                             5.87709e-06,
                             4.248637e-05,
                             2.8424445e-06,
                             5.160445e-07,
                             2.292821e-06,
                             2.5395758e-07,
                             7.8229374e-07,
                             7.030339e-05,
                             7.0427595e-06,
                             0.00016938041],
                     'rmse': [0.012027668,
                              0.0137956245,
                              0.012666692,
                              0.012551998,
                              0.0107461745,
                              0.00097170775,
                              0.010680446,
                              0.010183378,
                              0.002737019,
                              0.0016977327,
                              0.010004013,
                              0.007788797,
                              0.002424271,
                              0.0065181567,
                              0.0016859551,
                              0.0007183624,
                              0.0015142064,
                              0.000503942,
                              0.00088447373,
                              0.008384711,
                              0.0026538197,
                              0.013014623]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_70.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809
Directory path: experiments/inpainting/gann_4_night_20180901_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_70.0/images
Optimal number of principal components:  26
Reconstruction error:  9.677378
Energy conservation:  0.70862496
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_70.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9130967822707543, 2.7144376175697182],
                   'kl_div': 0.64429575,
                   'ks_tests': {10000: KstestResult(statistic=0.2347, pvalue=6.918797768890241e-242, statistic_location=-0.0037762374, statistic_sign=-1),
                                20000: KstestResult(statistic=0.2415, pvalue=0.0, statistic_location=-0.004377768, statistic_sign=-1),
                                30000: KstestResult(statistic=0.23709999999999998, pvalue=0.0, statistic_location=-0.0044169547, statistic_sign=-1),
                                40000: KstestResult(statistic=0.2354, pvalue=0.0, statistic_location=-0.004044023, statistic_sign=-1),
                                50000: KstestResult(statistic=0.2355, pvalue=0.0, statistic_location=-0.0043421574, statistic_sign=-1),
                                60000: KstestResult(statistic=0.23666666666666664, pvalue=0.0, statistic_location=-0.004246531, statistic_sign=-1),
                                70000: KstestResult(statistic=0.23581428571428573, pvalue=0.0, statistic_location=-0.004431851, statistic_sign=-1),
                                80000: KstestResult(statistic=0.23691249999999997, pvalue=0.0, statistic_location=-0.0044446327, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2332333333333333, pvalue=0.0, statistic_location=-0.004444735, statistic_sign=-1),
                                100000: KstestResult(statistic=0.23691, pvalue=0.0, statistic_location=-0.0044191303, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2351272727272727, pvalue=0.0, statistic_location=-0.0044381497, statistic_sign=-1),
                                120000: KstestResult(statistic=0.23574166666666668, pvalue=0.0, statistic_location=-0.004440912, statistic_sign=-1),
                                130000: KstestResult(statistic=0.23629230769230772, pvalue=0.0, statistic_location=-0.004183151, statistic_sign=-1),
                                140000: KstestResult(statistic=0.23420000000000002, pvalue=0.0, statistic_location=-0.0043411795, statistic_sign=-1),
                                150000: KstestResult(statistic=0.23199999999999998, pvalue=0.0, statistic_location=-0.0044320654, statistic_sign=-1),
                                160000: KstestResult(statistic=0.23376250000000004, pvalue=0.0, statistic_location=-0.004431851, statistic_sign=-1),
                                170000: KstestResult(statistic=0.2358470588235294, pvalue=0.0, statistic_location=-0.0044320654, statistic_sign=-1),
                                180000: KstestResult(statistic=0.23526111111111112, pvalue=0.0, statistic_location=-0.0044173864, statistic_sign=-1),
                                190000: KstestResult(statistic=0.2328842105263158, pvalue=0.0, statistic_location=-0.0044450103, statistic_sign=-1),
                                200000: KstestResult(statistic=0.23600999999999997, pvalue=0.0, statistic_location=-0.0044336114, statistic_sign=-1),
                                210000: KstestResult(statistic=0.23607619047619044, pvalue=0.0, statistic_location=-0.0044320785, statistic_sign=-1),
                                220000: KstestResult(statistic=0.23661363636363636, pvalue=0.0, statistic_location=-0.004440509, statistic_sign=-1),
                                230000: KstestResult(statistic=0.23426521739130435, pvalue=0.0, statistic_location=-0.0042460333, statistic_sign=-1),
                                240000: KstestResult(statistic=0.23370416666666669, pvalue=0.0, statistic_location=-0.004180378, statistic_sign=-1),
                                250000: KstestResult(statistic=0.23532799999999998, pvalue=0.0, statistic_location=-0.0042261183, statistic_sign=-1),
                                260000: KstestResult(statistic=0.23603846153846156, pvalue=0.0, statistic_location=-0.004437977, statistic_sign=-1),
                                270000: KstestResult(statistic=0.23512222222222223, pvalue=0.0, statistic_location=-0.0044663697, statistic_sign=-1),
                                280000: KstestResult(statistic=0.23606785714285713, pvalue=0.0, statistic_location=-0.0041751172, statistic_sign=-1),
                                290000: KstestResult(statistic=0.23440344827586207, pvalue=0.0, statistic_location=-0.004437484, statistic_sign=-1),
                                300000: KstestResult(statistic=0.23456333333333335, pvalue=0.0, statistic_location=-0.004432516, statistic_sign=-1),
                                310000: KstestResult(statistic=0.23416129032258065, pvalue=0.0, statistic_location=-0.004175104, statistic_sign=-1),
                                320000: KstestResult(statistic=0.23597500000000002, pvalue=0.0, statistic_location=-0.0044320785, statistic_sign=-1),
                                330000: KstestResult(statistic=0.2359515151515152, pvalue=0.0, statistic_location=-0.004262752, statistic_sign=-1)},
                   'moments': {'mean_error': -0.038140625,
                               'means': [-0.00039741758, -3.498246e-05],
                               'stds': [0.018622587, 0.0041571865],
                               'variance_ratio': 15.9136095}},
 'originals': {'gan': {'mae': 0.061107855290174484,
                       'mse': 0.03438358008861542,
                       'psnr': 19.85433006286621,
                       'rmse': 0.18542809784412384,
                       'ssim': 0.6147010922431946},
               'pca': {'mae': 0.0058506024070084095,
                       'mse': 7.995376654434949e-05,
                       'psnr': 46.43748092651367,
                       'rmse': 0.00894168671220541,
                       'ssim': 0.9966468214988708}},
 'reconstructions': {'mae': 0.06025223061442375,
                     'mse': 0.03431255742907524,
                     'psnr': 20.111339569091797,
                     'rmse': 0.18523648381233215,
                     'ssim': 0.6164061427116394},
 'residual_spectra_pcagan': {'cosine': [0.34683272,
                                        0.38134694,
                                        0.33419162,
                                        0.40649912,
                                        0.39886087,
                                        0.26621136,
                                        0.3723202,
                                        0.32483456,
                                        0.24646011,
                                        0.25141698,
                                        0.33667928,
                                        0.055205528,
                                        0.31849393,
                                        0.40549433,
                                        0.11585807,
                                        0.107984506,
                                        0.36842003,
                                        0.31002685,
                                        0.10868536,
                                        0.2675645,
                                        0.08026698,
                                        0.0057444666,
                                        0.099868126,
                                        0.035117056,
                                        0.047749393,
                                        0.3145588,
                                        0.08420217,
                                        0.39383888,
                                        0.2897744,
                                        0.25241956,
                                        0.05154276,
                                        0.08157111,
                                        0.059056576],
                             'mae': [0.00863883,
                                     0.007886203,
                                     0.0084191905,
                                     0.007993536,
                                     0.007973391,
                                     0.01009432,
                                     0.009198608,
                                     0.010198331,
                                     0.010591163,
                                     0.011008481,
                                     0.009525653,
                                     0.010771869,
                                     0.010333625,
                                     0.008282294,
                                     0.010313707,
                                     0.010138463,
                                     0.00801989,
                                     0.009293505,
                                     0.0097566815,
                                     0.0091101155,
                                     0.009272362,
                                     0.025858155,
                                     0.010268625,
                                     0.012574247,
                                     0.010971365,
                                     0.009981282,
                                     0.011108932,
                                     0.007869893,
                                     0.009515914,
                                     0.010861356,
                                     0.011183166,
                                     0.011504538,
                                     0.010014566],
                             'max_mae': 0.025858155,
                             'max_mse': 0.003310968,
                             'max_rmse': 0.05754101,
                             'median_distance': 1.4986091,
                             'median_mae': 0.010014566,
                             'min_cosine': 0.0057444666,
                             'mse': [0.00020638276,
                                     0.00015011881,
                                     0.00020809266,
                                     0.00015595194,
                                     0.00014208787,
                                     0.00032697534,
                                     0.00017740397,
                                     0.00028098532,
                                     0.0004500091,
                                     0.00033491824,
                                     0.00025562165,
                                     0.00024455698,
                                     0.0003233306,
                                     0.00016469533,
                                     0.00022458295,
                                     0.0002393026,
                                     0.00015984334,
                                     0.00017546696,
                                     0.00018145845,
                                     0.00017895977,
                                     0.00016759378,
                                     0.003310968,
                                     0.00020053935,
                                     0.00031568168,
                                     0.00022827189,
                                     0.00021082406,
                                     0.0003007941,
                                     0.00014795728,
                                     0.00023684754,
                                     0.0004342193,
                                     0.000279,
                                     0.00027137555,
                                     0.000211865],
                             'rmse': [0.014366028,
                                      0.012252298,
                                      0.014425417,
                                      0.012488072,
                                      0.011920062,
                                      0.018082459,
                                      0.013319308,
                                      0.016762616,
                                      0.021213418,
                                      0.018300772,
                                      0.015988173,
                                      0.015638318,
                                      0.017981397,
                                      0.012833368,
                                      0.014986092,
                                      0.015469409,
                                      0.012642917,
                                      0.013246395,
                                      0.013470652,
                                      0.0133775845,
                                      0.012945802,
                                      0.05754101,
                                      0.014161192,
                                      0.017767433,
                                      0.015108669,
                                      0.014519782,
                                      0.017343417,
                                      0.012163769,
                                      0.015389852,
                                      0.02083793,
                                      0.016703293,
                                      0.01647348,
                                      0.014555583]},
 'residuals': {'mae': 0.010258552618324757,
               'mse': 0.0003302025143057108,
               'psnr': 17.797780990600586,
               'rmse': 0.01817147620022297,
               'ssds': [114.495995, 5.703514],
               'ssim': 0.6285721659660339},
 'spectra_pcagan': {'cosine': [0.98361725,
                               0.9813674,
                               0.98559874,
                               0.98800606,
                               0.98354,
                               0.9838934,
                               0.9690861,
                               0.98783046,
                               0.98085165,
                               0.9875241,
                               0.99626863,
                               0.9990531,
                               0.99413043,
                               0.99651194,
                               0.9978956,
                               0.9987871,
                               0.9972632,
                               0.99748695,
                               0.99852395,
                               0.99747705,
                               0.99883354,
                               -0.645929,
                               0.99867266,
                               0.99946725,
                               0.9991697,
                               0.9954386,
                               0.0071873004,
                               0.9895374,
                               0.97950304,
                               0.9748562,
                               0.9995074,
                               0.99821335,
                               0.999032],
                    'mae': [0.02349547,
                            0.026998524,
                            0.022232698,
                            0.022526577,
                            0.02527282,
                            0.02605918,
                            0.03597485,
                            0.04598169,
                            0.03259381,
                            0.03452594,
                            0.016910577,
                            0.015127772,
                            0.020546155,
                            0.017169442,
                            0.018340265,
                            0.014566211,
                            0.013942033,
                            0.016031299,
                            0.015582196,
                            0.015649356,
                            0.014204126,
                            0.959214,
                            0.015828922,
                            0.014689636,
                            0.014880832,
                            0.021219788,
                            0.3444029,
                            0.028511161,
                            0.037012983,
                            0.031600457,
                            0.014718216,
                            0.01786662,
                            0.014647226],
                    'max_mae': 0.959214,
                    'max_mse': 0.9815174,
                    'max_rmse': 0.99071556,
                    'median_mae': 0.020546155,
                    'min_cosine': -0.645929,
                    'mse': [0.00093609,
                            0.0010703413,
                            0.00085447694,
                            0.00079904683,
                            0.00094405306,
                            0.0011470868,
                            0.0017617237,
                            0.002966674,
                            0.0018804274,
                            0.0018008153,
                            0.0005121989,
                            0.0003800215,
                            0.00069494115,
                            0.00048882654,
                            0.00054575293,
                            0.00036684875,
                            0.00035370406,
                            0.0004099588,
                            0.00039189236,
                            0.00042036697,
                            0.00033306814,
                            0.9815174,
                            0.00040376492,
                            0.0003454906,
                            0.00035823067,
                            0.0006899522,
                            0.12386847,
                            0.001214822,
                            0.0020686863,
                            0.0015600959,
                            0.00036049768,
                            0.00050826283,
                            0.00036072006],
                    'rmse': [0.030595588,
                             0.032716073,
                             0.029231437,
                             0.028267417,
                             0.030725446,
                             0.03386867,
                             0.04197289,
                             0.054467183,
                             0.043363895,
                             0.042436015,
                             0.022631811,
                             0.01949414,
                             0.026361736,
                             0.022109423,
                             0.023361355,
                             0.019153295,
                             0.018807022,
                             0.020247439,
                             0.01979627,
                             0.020502852,
                             0.018250154,
                             0.99071556,
                             0.020093903,
                             0.018587377,
                             0.018926982,
                             0.026266942,
                             0.35194954,
                             0.034854297,
                             0.045482814,
                             0.03949805,
                             0.018986776,
                             0.022544686,
                             0.018992633]},
 'spectra_realgan': {'cosine': [0.98116416,
                                0.9792906,
                                0.9832459,
                                0.98577976,
                                0.9814677,
                                0.98156124,
                                0.9668413,
                                0.9864012,
                                0.97883904,
                                0.9860042,
                                0.99519145,
                                0.9990496,
                                0.9932539,
                                0.9957636,
                                0.99784756,
                                0.9987711,
                                0.996565,
                                0.9971138,
                                0.9984994,
                                0.9972058,
                                0.9988238,
                                -0.64590436,
                                0.998654,
                                0.99946684,
                                0.999167,
                                0.9948542,
                                0.0073883943,
                                0.9878665,
                                0.97839326,
                                0.97260165,
                                0.99950576,
                                0.9981981,
                                0.99902624],
                     'mae': [0.025522962,
                             0.02819047,
                             0.024054082,
                             0.024406085,
                             0.026515229,
                             0.02765658,
                             0.0366096,
                             0.04644786,
                             0.033958904,
                             0.03557728,
                             0.01940579,
                             0.015161359,
                             0.022016011,
                             0.018857328,
                             0.018548708,
                             0.01466665,
                             0.016057845,
                             0.017318573,
                             0.015701028,
                             0.016630571,
                             0.01427325,
                             0.95920295,
                             0.01591568,
                             0.014694339,
                             0.014899051,
                             0.02259362,
                             0.3443543,
                             0.029696891,
                             0.03761046,
                             0.032620154,
                             0.014728023,
                             0.01795012,
                             0.014717337],
                     'max_mae': 0.95920295,
                     'max_mse': 0.9814932,
                     'max_rmse': 0.99070334,
                     'median_mae': 0.022016011,
                     'min_cosine': -0.64590436,
                     'mse': [0.0010776102,
                             0.0011927221,
                             0.0009870987,
                             0.00093792914,
                             0.0010650458,
                             0.0012817222,
                             0.0018940758,
                             0.0031226284,
                             0.0020291568,
                             0.0019350204,
                             0.0006385489,
                             0.00038157578,
                             0.000800654,
                             0.0005906596,
                             0.00055675977,
                             0.00037131037,
                             0.00044307986,
                             0.00047080207,
                             0.0003982088,
                             0.00046431867,
                             0.00033573667,
                             0.9814932,
                             0.00040745668,
                             0.00034584056,
                             0.00035928897,
                             0.00077649346,
                             0.123837024,
                             0.0013584506,
                             0.0021697725,
                             0.0016991112,
                             0.0003608177,
                             0.00051253545,
                             0.00036351563],
                     'rmse': [0.032826975,
                              0.03453581,
                              0.031418126,
                              0.030625628,
                              0.03263504,
                              0.03580115,
                              0.04352098,
                              0.055880483,
                              0.04504616,
                              0.04398887,
                              0.025269525,
                              0.019533964,
                              0.02829583,
                              0.02430349,
                              0.023595758,
                              0.019269416,
                              0.021049462,
                              0.021697974,
                              0.01995517,
                              0.021548055,
                              0.018323118,
                              0.99070334,
                              0.020185556,
                              0.018596789,
                              0.01895492,
                              0.027865632,
                              0.35190484,
                              0.036857165,
                              0.046580818,
                              0.041220278,
                              0.018995203,
                              0.022639247,
                              0.019066086]},
 'spectra_realpca': {'cosine': [0.9975287,
                                0.99754125,
                                0.9974481,
                                0.9978021,
                                0.99752724,
                                0.9974879,
                                0.997499,
                                0.9987663,
                                0.9979486,
                                0.9983251,
                                0.99898195,
                                0.99999744,
                                0.99904144,
                                0.99923843,
                                0.9999636,
                                0.99999017,
                                0.9992171,
                                0.9996236,
                                0.99997795,
                                0.99973816,
                                0.99999,
                                0.9999979,
                                0.99999225,
                                0.9999996,
                                0.9999983,
                                0.999509,
                                0.9999339,
                                0.9982045,
                                0.9982758,
                                0.99753594,
                                0.99999875,
                                0.99998397,
                                0.99999523],
                     'mae': [0.009348114,
                             0.0094198035,
                             0.009589724,
                             0.009196041,
                             0.009427271,
                             0.009711511,
                             0.009511348,
                             0.010627886,
                             0.010007582,
                             0.009943031,
                             0.008479736,
                             0.00076738006,
                             0.008408425,
                             0.008023893,
                             0.0021704328,
                             0.0013434107,
                             0.007872723,
                             0.0061206953,
                             0.0019104822,
                             0.0051592235,
                             0.0013248421,
                             0.00056396925,
                             0.0011945649,
                             0.00039777166,
                             0.0006966713,
                             0.0065849824,
                             0.0020740354,
                             0.0102323,
                             0.010141996,
                             0.009545468,
                             0.0005948283,
                             0.0016685058,
                             0.0010112411],
                     'max_mae': 0.010627886,
                     'max_mse': 0.00019031925,
                     'max_rmse': 0.0137956245,
                     'median_mae': 0.007872723,
                     'min_cosine': 0.9974481,
                     'mse': [0.00014015076,
                             0.0001414651,
                             0.00014519939,
                             0.00013574521,
                             0.00014231252,
                             0.00015277202,
                             0.0001446648,
                             0.00019031925,
                             0.0001604451,
                             0.00015755264,
                             0.00011548026,
                             9.4421597e-07,
                             0.00011407194,
                             0.0001037012,
                             7.4912728e-06,
                             2.8822963e-06,
                             0.00010008027,
                             6.0665356e-05,
                             5.87709e-06,
                             4.248637e-05,
                             2.8424445e-06,
                             5.160445e-07,
                             2.292821e-06,
                             2.5395758e-07,
                             7.8229374e-07,
                             7.030339e-05,
                             7.0427595e-06,
                             0.00016938041,
                             0.0001679267,
                             0.0001461571,
                             5.710146e-07,
                             4.4579187e-06,
                             1.6401531e-06],
                     'rmse': [0.011838528,
                              0.01189391,
                              0.012049871,
                              0.011650975,
                              0.011929481,
                              0.012360098,
                              0.012027668,
                              0.0137956245,
                              0.012666692,
                              0.012551998,
                              0.0107461745,
                              0.00097170775,
                              0.010680446,
                              0.010183378,
                              0.002737019,
                              0.0016977327,
                              0.010004013,
                              0.007788797,
                              0.002424271,
                              0.0065181567,
                              0.0016859551,
                              0.0007183624,
                              0.0015142064,
                              0.000503942,
                              0.00088447373,
                              0.008384711,
                              0.0026538197,
                              0.013014623,
                              0.012958653,
                              0.012089545,
                              0.00075565506,
                              0.0021113784,
                              0.0012806846]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_70.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521
Directory path: experiments/inpainting/gann_4_night_20180904_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_70.0/images
Optimal number of principal components:  32
Reconstruction error:  7.1195683
Energy conservation:  0.7088504
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_70.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9519870688369956, 1.1137597468744171],
                   'kl_div': 2.2370007,
                   'ks_tests': {10000: KstestResult(statistic=0.4761, pvalue=0.0, statistic_location=0.0015628589, statistic_sign=1),
                                20000: KstestResult(statistic=0.47140000000000004, pvalue=0.0, statistic_location=0.0016704048, statistic_sign=1),
                                30000: KstestResult(statistic=0.4749333333333333, pvalue=0.0, statistic_location=0.0015271818, statistic_sign=1),
                                40000: KstestResult(statistic=0.47902500000000003, pvalue=0.0, statistic_location=0.0016081177, statistic_sign=1),
                                50000: KstestResult(statistic=0.47629999999999995, pvalue=0.0, statistic_location=0.0015447108, statistic_sign=1),
                                60000: KstestResult(statistic=0.47745000000000004, pvalue=0.0, statistic_location=0.0015616678, statistic_sign=1),
                                70000: KstestResult(statistic=0.47539999999999993, pvalue=0.0, statistic_location=0.0015637667, statistic_sign=1),
                                80000: KstestResult(statistic=0.4739, pvalue=0.0, statistic_location=0.001718211, statistic_sign=1),
                                90000: KstestResult(statistic=0.47635555555555553, pvalue=0.0, statistic_location=0.0015436979, statistic_sign=1),
                                100000: KstestResult(statistic=0.47777000000000003, pvalue=0.0, statistic_location=0.0016383021, statistic_sign=1),
                                110000: KstestResult(statistic=0.47599090909090913, pvalue=0.0, statistic_location=0.0015484225, statistic_sign=1)},
                   'moments': {'mean_error': 1.9391316,
                               'means': [0.00041185232, -8.577556e-06],
                               'stds': [0.018056862, 0.0006777684],
                               'variance_ratio': 651.4299}},
 'originals': {'gan': {'mae': 0.01545672956854105,
                       'mse': 0.00040654675103724003,
                       'psnr': 33.4825553894043,
                       'rmse': 0.020163005217909813,
                       'ssim': 0.9744047522544861},
               'pca': {'mae': 0.0007241767598316073,
                       'mse': 1.1854006061184919e-06,
                       'psnr': 59.26134490966797,
                       'rmse': 0.0010887610260397196,
                       'ssim': 0.9999674558639526}},
 'reconstructions': {'mae': 0.01543432753533125,
                     'mse': 0.00040541868656873703,
                     'psnr': 33.92095947265625,
                     'rmse': 0.02013501152396202,
                     'ssim': 0.9744154214859009},
 'residual_spectra_pcagan': {'cosine': [0.0130795855,
                                        0.047298897,
                                        0.035723712,
                                        0.024464015,
                                        0.023729349,
                                        0.009500496,
                                        0.03065611,
                                        0.02279213,
                                        0.061936267,
                                        0.060334306,
                                        0.04697521],
                             'mae': [0.011261056,
                                     0.013126552,
                                     0.012185133,
                                     0.011823526,
                                     0.0134060215,
                                     0.0114906905,
                                     0.011100236,
                                     0.010494464,
                                     0.01061082,
                                     0.010382622,
                                     0.010794245],
                             'max_mae': 0.0134060215,
                             'max_mse': 0.0005390713,
                             'max_rmse': 0.023217909,
                             'median_distance': 1.7331668,
                             'median_mae': 0.011261056,
                             'min_cosine': 0.009500496,
                             'mse': [0.00026703384,
                                     0.00048449854,
                                     0.00031801357,
                                     0.0002932028,
                                     0.0005390713,
                                     0.00030192581,
                                     0.0002853574,
                                     0.00025479036,
                                     0.00030038672,
                                     0.00023506708,
                                     0.0003045115],
                             'rmse': [0.01634117,
                                      0.022011327,
                                      0.017832935,
                                      0.017123165,
                                      0.023217909,
                                      0.017376013,
                                      0.016892524,
                                      0.015962154,
                                      0.017331667,
                                      0.015331898,
                                      0.017450258]},
 'residuals': {'mae': 0.011515943333506584,
               'mse': 0.0003258053620811552,
               'psnr': -4.610518455505371,
               'rmse': 0.01805008016526699,
               'ssds': [35.88386, 0.050538328],
               'ssim': 0.2914953827857971},
 'spectra_pcagan': {'cosine': [0.99921304,
                               0.9991774,
                               0.9991696,
                               0.9996016,
                               0.99972045,
                               0.9995684,
                               0.99955684,
                               0.99922734,
                               0.99838585,
                               0.99858326,
                               0.99813646],
                    'mae': [0.016218567,
                            0.016138209,
                            0.016547458,
                            0.014094644,
                            0.013366006,
                            0.013898168,
                            0.013644089,
                            0.014645608,
                            0.017081352,
                            0.016948054,
                            0.017195461],
                    'max_mae': 0.017195461,
                    'max_mse': 0.00051291997,
                    'max_rmse': 0.022647737,
                    'median_mae': 0.016138209,
                    'min_cosine': 0.99813646,
                    'mse': [0.00042999245,
                            0.00046842982,
                            0.000444596,
                            0.000316405,
                            0.00032545393,
                            0.00031632328,
                            0.0003061925,
                            0.0003577986,
                            0.00051291997,
                            0.00047464424,
                            0.00050684955],
                    'rmse': [0.020736258,
                             0.02164324,
                             0.021085445,
                             0.017787777,
                             0.018040342,
                             0.01778548,
                             0.017498357,
                             0.018915566,
                             0.022647737,
                             0.021786332,
                             0.022513319]},
 'spectra_realgan': {'cosine': [0.99921256,
                                0.9991765,
                                0.99916816,
                                0.99960124,
                                0.9997202,
                                0.9995682,
                                0.9995564,
                                0.9992265,
                                0.9983751,
                                0.9985745,
                                0.9981255],
                     'mae': [0.016234435,
                             0.016154232,
                             0.01656463,
                             0.014099396,
                             0.013369966,
                             0.013901337,
                             0.013646489,
                             0.014648897,
                             0.017152552,
                             0.017003521,
                             0.017248556],
                     'max_mae': 0.017248556,
                     'max_mse': 0.0005166481,
                     'max_rmse': 0.022729894,
                     'median_mae': 0.016154232,
                     'min_cosine': 0.9981255,
                     'mse': [0.00043040176,
                             0.00046921193,
                             0.00044537726,
                             0.00031670724,
                             0.00032554113,
                             0.000316477,
                             0.0003063292,
                             0.00035817624,
                             0.0005166481,
                             0.00047745038,
                             0.0005096938],
                     'rmse': [0.020746127,
                              0.0216613,
                              0.021103963,
                              0.01779627,
                              0.018042758,
                              0.0177898,
                              0.017502263,
                              0.018925544,
                              0.022729894,
                              0.021850638,
                              0.0225764]},
 'spectra_realpca': {'cosine': [0.9999992,
                                0.9999991,
                                0.9999986,
                                0.9999998,
                                0.9999999,
                                0.9999997,
                                0.9999997,
                                0.9999985,
                                0.99998814,
                                0.99999034,
                                0.99998754],
                     'mae': [0.0005407253,
                             0.0005332674,
                             0.0006731087,
                             0.00032894785,
                             0.00022838326,
                             0.00031081252,
                             0.00034352337,
                             0.00067130086,
                             0.001504668,
                             0.0013781515,
                             0.0014530566],
                     'max_mae': 0.001504668,
                     'max_mse': 3.6387396e-06,
                     'max_rmse': 0.001907548,
                     'median_mae': 0.0005407253,
                     'min_cosine': 0.99998754,
                     'mse': [4.6824505e-07,
                             4.5392105e-07,
                             7.2593224e-07,
                             1.7396366e-07,
                             8.4570864e-08,
                             1.5580329e-07,
                             1.9099974e-07,
                             7.259897e-07,
                             3.6387396e-06,
                             3.0768867e-06,
                             3.3443555e-06],
                     'rmse': [0.0006842843,
                              0.0006737366,
                              0.00085201656,
                              0.0004170895,
                              0.0002908107,
                              0.00039471925,
                              0.00043703517,
                              0.0008520503,
                              0.001907548,
                              0.0017541057,
                              0.0018287579]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_70.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743
Directory path: experiments/inpainting/gann_4_night_20180904_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_70.0/images
Optimal number of principal components:  32
Reconstruction error:  7.1195683
Energy conservation:  0.7088504
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_70.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9538435048012626, 1.6745029323752467],
                   'kl_div': 1.6628314,
                   'ks_tests': {10000: KstestResult(statistic=0.3763, pvalue=0.0, statistic_location=0.001970796, statistic_sign=1),
                                20000: KstestResult(statistic=0.37525, pvalue=0.0, statistic_location=0.002003966, statistic_sign=1),
                                30000: KstestResult(statistic=0.3742333333333333, pvalue=0.0, statistic_location=0.0020708446, statistic_sign=1),
                                40000: KstestResult(statistic=0.38349999999999995, pvalue=0.0, statistic_location=0.001868792, statistic_sign=1),
                                50000: KstestResult(statistic=0.3780800000000001, pvalue=0.0, statistic_location=0.0019349325, statistic_sign=1),
                                60000: KstestResult(statistic=0.3779166666666667, pvalue=0.0, statistic_location=0.0019560363, statistic_sign=1),
                                70000: KstestResult(statistic=0.37467142857142866, pvalue=0.0, statistic_location=0.00193136, statistic_sign=1),
                                80000: KstestResult(statistic=0.37731250000000005, pvalue=0.0, statistic_location=0.0019745051, statistic_sign=1),
                                90000: KstestResult(statistic=0.3759444444444445, pvalue=0.0, statistic_location=0.00199567, statistic_sign=1),
                                100000: KstestResult(statistic=0.37572000000000005, pvalue=0.0, statistic_location=0.0020119534, statistic_sign=1),
                                110000: KstestResult(statistic=0.37790909090909097, pvalue=0.0, statistic_location=0.00199606, statistic_sign=1),
                                120000: KstestResult(statistic=0.37469166666666665, pvalue=0.0, statistic_location=0.0018875604, statistic_sign=1),
                                130000: KstestResult(statistic=0.37735384615384615, pvalue=0.0, statistic_location=0.0019745051, statistic_sign=1),
                                140000: KstestResult(statistic=0.37794285714285714, pvalue=0.0, statistic_location=0.0018954801, statistic_sign=1),
                                150000: KstestResult(statistic=0.37738666666666676, pvalue=0.0, statistic_location=0.0019968555, statistic_sign=1),
                                160000: KstestResult(statistic=0.37666875, pvalue=0.0, statistic_location=0.0019908221, statistic_sign=1),
                                170000: KstestResult(statistic=0.37741176470588234, pvalue=0.0, statistic_location=0.0019209124, statistic_sign=1),
                                180000: KstestResult(statistic=0.3751055555555556, pvalue=0.0, statistic_location=0.0018846719, statistic_sign=1),
                                190000: KstestResult(statistic=0.3772052631578948, pvalue=0.0, statistic_location=0.0020055207, statistic_sign=1),
                                200000: KstestResult(statistic=0.37738000000000005, pvalue=0.0, statistic_location=0.0018512998, statistic_sign=1),
                                210000: KstestResult(statistic=0.3773857142857143, pvalue=0.0, statistic_location=0.002094253, statistic_sign=1),
                                220000: KstestResult(statistic=0.37694090909090905, pvalue=0.0, statistic_location=0.0019960487, statistic_sign=1)},
                   'moments': {'mean_error': 0.100073755,
                               'means': [-0.00020164356, -1.35773325e-05],
                               'stds': [0.016210506, 0.001968534],
                               'variance_ratio': 95.57403}},
 'originals': {'gan': {'mae': 0.022802989929914474,
                       'mse': 0.0012678749626502395,
                       'psnr': 29.031415939331055,
                       'rmse': 0.0356072336435318,
                       'ssim': 0.9156926274299622},
               'pca': {'mae': 0.002011057687923312,
                       'mse': 1.8768609152175486e-05,
                       'psnr': 47.61758804321289,
                       'rmse': 0.004332275129854679,
                       'ssim': 0.9997316598892212}},
 'reconstructions': {'mae': 0.02256324328482151,
                     'mse': 0.0012505039339885116,
                     'psnr': 29.381059646606445,
                     'rmse': 0.03536246344447136,
                     'ssim': 0.9156416058540344},
 'residual_spectra_pcagan': {'cosine': [0.042736847,
                                        0.07990244,
                                        0.017492684,
                                        0.023228928,
                                        0.008100475,
                                        0.0042619775,
                                        0.053431273,
                                        0.033722624,
                                        0.02686982,
                                        0.033263166,
                                        0.0068104044,
                                        0.012093368,
                                        0.05553043,
                                        0.046822846,
                                        0.07058883,
                                        0.061335724,
                                        0.040077474,
                                        0.13346216,
                                        0.35756323,
                                        0.33196226,
                                        0.060786188,
                                        0.2964836],
                             'mae': [0.009647153,
                                     0.010190008,
                                     0.011319693,
                                     0.011754306,
                                     0.011312353,
                                     0.010616484,
                                     0.012177642,
                                     0.010804377,
                                     0.011550435,
                                     0.012157392,
                                     0.010567393,
                                     0.01126656,
                                     0.009841892,
                                     0.011224648,
                                     0.0120119145,
                                     0.0107287625,
                                     0.010336604,
                                     0.010798959,
                                     0.008599109,
                                     0.008644728,
                                     0.01100135,
                                     0.009362952],
                             'max_mae': 0.012177642,
                             'max_mse': 0.00036499667,
                             'max_rmse': 0.019104887,
                             'median_distance': 1.5799941,
                             'median_mae': 0.010801667,
                             'min_cosine': 0.0042619775,
                             'mse': [0.00019309735,
                                     0.00024561983,
                                     0.00033682186,
                                     0.00027188577,
                                     0.00029888854,
                                     0.00022149907,
                                     0.0003558044,
                                     0.00023318177,
                                     0.00026209923,
                                     0.00034546794,
                                     0.00023090758,
                                     0.00025204715,
                                     0.0001902831,
                                     0.00036499667,
                                     0.0002920094,
                                     0.0002548236,
                                     0.0002212338,
                                     0.00024724077,
                                     0.00014855793,
                                     0.00016641883,
                                     0.00033995262,
                                     0.00023212528],
                             'rmse': [0.0138959475,
                                      0.015672263,
                                      0.018352708,
                                      0.01648896,
                                      0.017288392,
                                      0.014882845,
                                      0.018862778,
                                      0.01527029,
                                      0.016189478,
                                      0.018586768,
                                      0.0151956435,
                                      0.015875993,
                                      0.013794314,
                                      0.019104887,
                                      0.017088283,
                                      0.015963195,
                                      0.01487393,
                                      0.015723892,
                                      0.012188435,
                                      0.012900342,
                                      0.018437805,
                                      0.015235659]},
 'residuals': {'mae': 0.010723396204411983,
               'mse': 0.0002593165263533592,
               'psnr': 10.00367546081543,
               'rmse': 0.016103308647871017,
               'ssds': [57.820404, 0.85256433],
               'ssim': 0.33736827969551086},
 'spectra_pcagan': {'cosine': [0.99874437,
                               0.9989305,
                               0.9988632,
                               0.9995555,
                               0.99901927,
                               0.9992799,
                               0.999237,
                               0.9992925,
                               0.99960274,
                               0.9997595,
                               0.9996038,
                               0.99952215,
                               0.9992233,
                               0.99806744,
                               0.997628,
                               0.9979898,
                               0.9666649,
                               0.9950672,
                               0.9857137,
                               0.98953897,
                               0.9953007,
                               0.9909892],
                    'mae': [0.016715223,
                            0.017753527,
                            0.017112922,
                            0.013827205,
                            0.016740272,
                            0.015707593,
                            0.015642624,
                            0.01571891,
                            0.013693367,
                            0.011836025,
                            0.012668265,
                            0.013931255,
                            0.015917191,
                            0.01824415,
                            0.02524371,
                            0.01871104,
                            0.12165034,
                            0.02278434,
                            0.028694015,
                            0.021440957,
                            0.02033879,
                            0.022019595],
                    'max_mae': 0.12165034,
                    'max_mse': 0.015761055,
                    'max_rmse': 0.12554304,
                    'median_mae': 0.016926598,
                    'min_cosine': 0.9666649,
                    'mse': [0.0004524986,
                            0.00051371823,
                            0.000515773,
                            0.000314178,
                            0.00046668368,
                            0.00039281507,
                            0.00042546124,
                            0.00039431,
                            0.000302724,
                            0.00023665756,
                            0.00027298828,
                            0.00031452137,
                            0.00041286167,
                            0.0006065878,
                            0.000998185,
                            0.00058442965,
                            0.015761055,
                            0.00087578985,
                            0.0012414608,
                            0.0007988438,
                            0.0007878975,
                            0.00084164983],
                    'rmse': [0.021272015,
                             0.022665353,
                             0.022710636,
                             0.017725067,
                             0.021602863,
                             0.019819563,
                             0.020626713,
                             0.01985724,
                             0.017398965,
                             0.0153836785,
                             0.016522357,
                             0.017734751,
                             0.020318998,
                             0.024629002,
                             0.031594068,
                             0.02417498,
                             0.12554304,
                             0.029593747,
                             0.03523437,
                             0.028263824,
                             0.028069511,
                             0.029011201]},
 'spectra_realgan': {'cosine': [0.99873984,
                                0.99892455,
                                0.9988628,
                                0.99955505,
                                0.99901736,
                                0.99927944,
                                0.999236,
                                0.9992907,
                                0.9996024,
                                0.9997593,
                                0.9996036,
                                0.9995221,
                                0.99922097,
                                0.9980578,
                                0.9976138,
                                0.9979757,
                                0.96666616,
                                0.9949552,
                                0.9843035,
                                0.9879499,
                                0.99525386,
                                0.9898637],
                     'mae': [0.016757904,
                             0.017770324,
                             0.017112369,
                             0.01383557,
                             0.016758244,
                             0.015727006,
                             0.015651455,
                             0.015733246,
                             0.013698544,
                             0.011841561,
                             0.012671583,
                             0.0139355045,
                             0.015933547,
                             0.01829244,
                             0.025284594,
                             0.018783178,
                             0.12164629,
                             0.0230658,
                             0.029757496,
                             0.023322336,
                             0.020486988,
                             0.023599781],
                     'max_mae': 0.12164629,
                     'max_mse': 0.015762165,
                     'max_rmse': 0.12554747,
                     'median_mae': 0.016935308,
                     'min_cosine': 0.96666616,
                     'mse': [0.0004542018,
                             0.0005153386,
                             0.0005156378,
                             0.0003145015,
                             0.00046750798,
                             0.00039329668,
                             0.00042608124,
                             0.00039521517,
                             0.00030301872,
                             0.00023685601,
                             0.00027310196,
                             0.00031457676,
                             0.00041394075,
                             0.00060945906,
                             0.0010027124,
                             0.000587619,
                             0.015762165,
                             0.00089393597,
                             0.0013501194,
                             0.0009196746,
                             0.00079518737,
                             0.00094910344],
                     'rmse': [0.021312011,
                              0.022701072,
                              0.02270766,
                              0.01773419,
                              0.021621933,
                              0.01983171,
                              0.020641735,
                              0.01988002,
                              0.017407432,
                              0.015390127,
                              0.016525798,
                              0.017736312,
                              0.020345533,
                              0.024687225,
                              0.031665634,
                              0.024240855,
                              0.12554747,
                              0.029898763,
                              0.03674397,
                              0.030326137,
                              0.028199067,
                              0.030807523]},
 'spectra_realpca': {'cosine': [0.99999475,
                                0.9999974,
                                0.9999985,
                                0.9999998,
                                0.99999815,
                                0.9999992,
                                0.9999991,
                                0.9999986,
                                0.9999998,
                                0.9999999,
                                0.9999997,
                                0.9999997,
                                0.9999985,
                                0.99998814,
                                0.99999034,
                                0.99998754,
                                0.9999911,
                                0.9999027,
                                0.9983503,
                                0.99832535,
                                0.9999534,
                                0.99876463],
                     'mae': [0.0010234572,
                             0.0008254812,
                             0.0006089716,
                             0.00030505052,
                             0.00069482555,
                             0.0005407253,
                             0.0005332674,
                             0.0006731087,
                             0.00032894785,
                             0.00022838326,
                             0.00031081252,
                             0.00034352337,
                             0.00067130086,
                             0.001504668,
                             0.0013781515,
                             0.0014530566,
                             0.0011805926,
                             0.0031568524,
                             0.0089343665,
                             0.008930194,
                             0.0021110913,
                             0.00850644],
                     'max_mae': 0.0089343665,
                     'max_mse': 0.00012810742,
                     'max_rmse': 0.0113184545,
                     'median_mae': 0.0007601534,
                     'min_cosine': 0.99832535,
                     'mse': [1.6875675e-06,
                             1.0961173e-06,
                             5.9526235e-07,
                             1.4991456e-07,
                             7.726487e-07,
                             4.6824505e-07,
                             4.5392105e-07,
                             7.2593224e-07,
                             1.7396366e-07,
                             8.4570864e-08,
                             1.5580329e-07,
                             1.9099974e-07,
                             7.259897e-07,
                             3.6387396e-06,
                             3.0768867e-06,
                             3.3443555e-06,
                             2.2649876e-06,
                             1.581064e-05,
                             0.00012810742,
                             0.00012601764,
                             7.206784e-06,
                             0.000116161034],
                     'rmse': [0.0012990641,
                              0.0010469562,
                              0.0007715325,
                              0.00038718802,
                              0.00087900436,
                              0.0006842843,
                              0.0006737366,
                              0.00085201656,
                              0.0004170895,
                              0.0002908107,
                              0.00039471925,
                              0.00043703517,
                              0.0008520503,
                              0.001907548,
                              0.0017541057,
                              0.0018287579,
                              0.0015049876,
                              0.0039762594,
                              0.0113184545,
                              0.011225758,
                              0.0026845455,
                              0.010777803]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_70.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658
Directory path: experiments/inpainting/gann_4_night_20180904_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_70.0/images
Optimal number of principal components:  32
Reconstruction error:  7.1195683
Energy conservation:  0.7088504
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_70.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9187742426194503, 2.1419428653655364],
                   'kl_div': 1.1847459,
                   'ks_tests': {10000: KstestResult(statistic=0.3297, pvalue=1e-323, statistic_location=0.0020642376, statistic_sign=1),
                                20000: KstestResult(statistic=0.32184999999999997, pvalue=0.0, statistic_location=0.00211071, statistic_sign=1),
                                30000: KstestResult(statistic=0.3223666666666667, pvalue=0.0, statistic_location=0.002145727, statistic_sign=1),
                                40000: KstestResult(statistic=0.32489999999999997, pvalue=0.0, statistic_location=0.0019907386, statistic_sign=1),
                                50000: KstestResult(statistic=0.3244600000000001, pvalue=0.0, statistic_location=0.0020436957, statistic_sign=1),
                                60000: KstestResult(statistic=0.3187, pvalue=0.0, statistic_location=0.0022404883, statistic_sign=1),
                                70000: KstestResult(statistic=0.3253571428571429, pvalue=0.0, statistic_location=0.0022269832, statistic_sign=1),
                                80000: KstestResult(statistic=0.3220375000000001, pvalue=0.0, statistic_location=0.0021781493, statistic_sign=1),
                                90000: KstestResult(statistic=0.3246555555555555, pvalue=0.0, statistic_location=0.0021570614, statistic_sign=1),
                                100000: KstestResult(statistic=0.32310000000000005, pvalue=0.0, statistic_location=0.00227354, statistic_sign=1),
                                110000: KstestResult(statistic=0.32413636363636367, pvalue=0.0, statistic_location=0.001979257, statistic_sign=1),
                                120000: KstestResult(statistic=0.32210833333333333, pvalue=0.0, statistic_location=0.0022407123, statistic_sign=1),
                                130000: KstestResult(statistic=0.32370769230769236, pvalue=0.0, statistic_location=0.0021629073, statistic_sign=1),
                                140000: KstestResult(statistic=0.3212357142857143, pvalue=0.0, statistic_location=0.0022407123, statistic_sign=1),
                                150000: KstestResult(statistic=0.32110000000000005, pvalue=0.0, statistic_location=0.0022463617, statistic_sign=1),
                                160000: KstestResult(statistic=0.3214, pvalue=0.0, statistic_location=0.0021062607, statistic_sign=1),
                                170000: KstestResult(statistic=0.32332941176470587, pvalue=0.0, statistic_location=0.0022432983, statistic_sign=1),
                                180000: KstestResult(statistic=0.32394444444444437, pvalue=0.0, statistic_location=0.002221151, statistic_sign=1),
                                190000: KstestResult(statistic=0.3235526315789474, pvalue=0.0, statistic_location=0.0022107621, statistic_sign=1),
                                200000: KstestResult(statistic=0.3235, pvalue=0.0, statistic_location=0.0020437746, statistic_sign=1),
                                210000: KstestResult(statistic=0.3233190476190476, pvalue=0.0, statistic_location=0.0020341834, statistic_sign=1),
                                220000: KstestResult(statistic=0.3219727272727272, pvalue=0.0, statistic_location=0.0021680298, statistic_sign=1),
                                230000: KstestResult(statistic=0.32140434782608696, pvalue=0.0, statistic_location=0.0021803933, statistic_sign=1),
                                240000: KstestResult(statistic=0.32535000000000003, pvalue=0.0, statistic_location=0.0020332085, statistic_sign=1),
                                250000: KstestResult(statistic=0.322936, pvalue=0.0, statistic_location=0.0021798764, statistic_sign=1),
                                260000: KstestResult(statistic=0.32329615384615384, pvalue=0.0, statistic_location=0.0020984234, statistic_sign=1),
                                270000: KstestResult(statistic=0.3207629629629629, pvalue=0.0, statistic_location=0.0021680298, statistic_sign=1),
                                280000: KstestResult(statistic=0.32354285714285713, pvalue=0.0, statistic_location=0.002098993, statistic_sign=1),
                                290000: KstestResult(statistic=0.3230793103448276, pvalue=0.0, statistic_location=0.0020534554, statistic_sign=1),
                                300000: KstestResult(statistic=0.3220133333333334, pvalue=0.0, statistic_location=0.00216786, statistic_sign=1),
                                310000: KstestResult(statistic=0.3233967741935484, pvalue=0.0, statistic_location=0.0021800306, statistic_sign=1),
                                320000: KstestResult(statistic=0.322540625, pvalue=0.0, statistic_location=0.0021636751, statistic_sign=1),
                                330000: KstestResult(statistic=0.32349090909090905, pvalue=0.0, statistic_location=0.002179904, statistic_sign=1)},
                   'moments': {'mean_error': 0.21925561,
                               'means': [0.00036934364, -6.9274656e-06],
                               'stds': [0.015899327, 0.0030100683],
                               'variance_ratio': 25.532734}},
 'originals': {'gan': {'mae': 0.02468295581638813,
                       'mse': 0.001282364595681429,
                       'psnr': 30.239980697631836,
                       'rmse': 0.03581012040376663,
                       'ssim': 0.9119793176651001},
               'pca': {'mae': 0.0037610968574881554,
                       'mse': 4.914573219139129e-05,
                       'psnr': 44.810302734375,
                       'rmse': 0.00701040169224143,
                       'ssim': 0.9985964894294739}},
 'reconstructions': {'mae': 0.024165885522961617,
                     'mse': 0.0012326025171205401,
                     'psnr': 30.81692886352539,
                     'rmse': 0.03510843962430954,
                     'ssim': 0.9127527475357056},
 'residual_spectra_pcagan': {'cosine': [0.3207197,
                                        0.38560262,
                                        0.35681546,
                                        0.059642106,
                                        0.05975569,
                                        0.029433629,
                                        0.054500185,
                                        0.07992411,
                                        0.0297881,
                                        0.007598428,
                                        0.019706612,
                                        0.0072653224,
                                        0.056547124,
                                        0.04384662,
                                        0.022292852,
                                        0.0159785,
                                        0.0044940608,
                                        0.024209017,
                                        0.0381238,
                                        0.080522805,
                                        0.07306856,
                                        0.037578642,
                                        0.04836622,
                                        0.15003952,
                                        0.35719997,
                                        0.32350832,
                                        0.072038956,
                                        0.36560723,
                                        0.33147305,
                                        0.2571262,
                                        0.32654038,
                                        0.3110512,
                                        0.35211864],
                             'mae': [0.008999098,
                                     0.008211694,
                                     0.008395036,
                                     0.009793137,
                                     0.009369264,
                                     0.0111551685,
                                     0.010569728,
                                     0.011430087,
                                     0.012341303,
                                     0.012605784,
                                     0.011018412,
                                     0.011001254,
                                     0.011484845,
                                     0.010223429,
                                     0.011371169,
                                     0.011472362,
                                     0.011449826,
                                     0.010749104,
                                     0.009355287,
                                     0.009761127,
                                     0.008842863,
                                     0.012370943,
                                     0.009947665,
                                     0.010162992,
                                     0.0087427525,
                                     0.008871507,
                                     0.010980553,
                                     0.008256209,
                                     0.009319724,
                                     0.010295536,
                                     0.009188899,
                                     0.009923562,
                                     0.008398493],
                             'max_mae': 0.012605784,
                             'max_mse': 0.0004720138,
                             'max_rmse': 0.021725878,
                             'median_distance': 1.5053179,
                             'median_mae': 0.010162992,
                             'min_cosine': 0.0044940608,
                             'mse': [0.00021695941,
                                     0.00015164142,
                                     0.00018827195,
                                     0.00019882566,
                                     0.00016928294,
                                     0.00030917634,
                                     0.00021733691,
                                     0.00029602813,
                                     0.0004720138,
                                     0.00034909463,
                                     0.00028539522,
                                     0.0002579805,
                                     0.00029840376,
                                     0.00020235583,
                                     0.00026334624,
                                     0.0002761319,
                                     0.00029067215,
                                     0.00023328094,
                                     0.00016682179,
                                     0.00018510032,
                                     0.000145712,
                                     0.0003790894,
                                     0.00019949298,
                                     0.00023436265,
                                     0.00016460104,
                                     0.00018287776,
                                     0.00034136928,
                                     0.0001549209,
                                     0.00022659822,
                                     0.00039010798,
                                     0.00023918635,
                                     0.0002136508,
                                     0.00015409543],
                             'rmse': [0.014729542,
                                      0.012314277,
                                      0.013721223,
                                      0.014100555,
                                      0.013010878,
                                      0.017583411,
                                      0.014742351,
                                      0.017205467,
                                      0.021725878,
                                      0.018684074,
                                      0.016893644,
                                      0.016061772,
                                      0.017274367,
                                      0.014225183,
                                      0.016227946,
                                      0.016617218,
                                      0.01704911,
                                      0.0152735375,
                                      0.012915951,
                                      0.013605158,
                                      0.012071122,
                                      0.019470219,
                                      0.014124198,
                                      0.015308907,
                                      0.012829693,
                                      0.01352323,
                                      0.01847618,
                                      0.012446722,
                                      0.01505318,
                                      0.019751152,
                                      0.015465651,
                                      0.014616799,
                                      0.012413518]},
 'residuals': {'mae': 0.010183597914874554,
               'mse': 0.00024406620650552213,
               'psnr': 11.02049446105957,
               'rmse': 0.015622618608176708,
               'ssds': [83.46498, 2.9899755],
               'ssim': 0.3785800039768219},
 'spectra_pcagan': {'cosine': [0.98363966,
                               0.9864696,
                               0.98366845,
                               0.99869967,
                               0.99876916,
                               0.99869865,
                               0.9982821,
                               0.9986798,
                               0.99838376,
                               0.99947125,
                               0.9990593,
                               0.9991582,
                               0.9993182,
                               0.9992591,
                               0.999595,
                               0.99976337,
                               0.9995595,
                               0.9995773,
                               0.9992233,
                               0.99848884,
                               0.99868095,
                               0.99773955,
                               0.96699405,
                               0.99560386,
                               0.9855227,
                               0.98242384,
                               0.9941235,
                               0.9902518,
                               0.97698265,
                               0.979344,
                               0.9886735,
                               0.98519856,
                               0.98362625],
                    'mae': [0.027782513,
                            0.025056781,
                            0.025816958,
                            0.016681237,
                            0.017341014,
                            0.01793721,
                            0.023173712,
                            0.017601797,
                            0.020328153,
                            0.014706409,
                            0.016864974,
                            0.01643591,
                            0.015126712,
                            0.015407134,
                            0.013862399,
                            0.012074477,
                            0.013569775,
                            0.013174176,
                            0.015759226,
                            0.017251315,
                            0.016095662,
                            0.021121383,
                            0.11901095,
                            0.02030039,
                            0.027802097,
                            0.030135682,
                            0.022516238,
                            0.026116764,
                            0.040988743,
                            0.037666123,
                            0.022953983,
                            0.027834922,
                            0.028979382],
                    'max_mae': 0.11901095,
                    'max_mse': 0.01521731,
                    'max_rmse': 0.12335846,
                    'median_mae': 0.02030039,
                    'min_cosine': 0.96699405,
                    'mse': [0.0012620315,
                            0.0010358478,
                            0.0011208329,
                            0.00046807295,
                            0.00048090486,
                            0.00055687845,
                            0.00080218574,
                            0.00054048107,
                            0.0007699795,
                            0.00038391838,
                            0.0004755839,
                            0.00043818005,
                            0.00039158715,
                            0.00039676353,
                            0.00030853285,
                            0.00024356086,
                            0.0003075324,
                            0.0002778459,
                            0.00040835343,
                            0.00048486196,
                            0.00042050122,
                            0.0007686727,
                            0.01521731,
                            0.000714088,
                            0.0011585973,
                            0.0013362567,
                            0.000907131,
                            0.0010321173,
                            0.0022761088,
                            0.0023373445,
                            0.0009172244,
                            0.0011729336,
                            0.001263661],
                    'rmse': [0.035525084,
                             0.03218459,
                             0.03347884,
                             0.021634994,
                             0.021929543,
                             0.023598272,
                             0.028322883,
                             0.023248248,
                             0.027748505,
                             0.019593835,
                             0.021807887,
                             0.02093275,
                             0.019788561,
                             0.019918924,
                             0.017565103,
                             0.015606437,
                             0.017536601,
                             0.016668709,
                             0.020207757,
                             0.022019582,
                             0.020506127,
                             0.027724946,
                             0.12335846,
                             0.026722424,
                             0.034038175,
                             0.036554847,
                             0.030118616,
                             0.032126583,
                             0.047708582,
                             0.04834609,
                             0.030285712,
                             0.034248117,
                             0.03554801]},
 'spectra_realgan': {'cosine': [0.98141545,
                                0.98439544,
                                0.9813797,
                                0.9986945,
                                0.9987649,
                                0.9986952,
                                0.9982767,
                                0.99867415,
                                0.998383,
                                0.999471,
                                0.99905765,
                                0.9991576,
                                0.9993173,
                                0.99925745,
                                0.9995946,
                                0.99976313,
                                0.99955946,
                                0.99957687,
                                0.99922174,
                                0.99847776,
                                0.99867415,
                                0.99772614,
                                0.96699744,
                                0.99548423,
                                0.98398864,
                                0.9808996,
                                0.99406856,
                                0.98900837,
                                0.9749164,
                                0.9770474,
                                0.9866503,
                                0.98371285,
                                0.98208284],
                     'mae': [0.029627863,
                             0.027001698,
                             0.027749447,
                             0.016724592,
                             0.017360587,
                             0.01796355,
                             0.023198022,
                             0.01763843,
                             0.02032905,
                             0.014715585,
                             0.016875524,
                             0.016448902,
                             0.0151463505,
                             0.015429246,
                             0.013867679,
                             0.01207587,
                             0.013570596,
                             0.0131817935,
                             0.015766568,
                             0.017302716,
                             0.016132155,
                             0.021171888,
                             0.11901177,
                             0.020583939,
                             0.029042747,
                             0.03127443,
                             0.02266115,
                             0.027384711,
                             0.04174257,
                             0.039284453,
                             0.025127478,
                             0.029080713,
                             0.030065464],
                     'max_mae': 0.11901177,
                     'max_mse': 0.015217986,
                     'max_rmse': 0.1233612,
                     'median_mae': 0.02032905,
                     'min_cosine': 0.96699744,
                     'mse': [0.0014243751,
                             0.0011916298,
                             0.0012813773,
                             0.0004699886,
                             0.00048249884,
                             0.00055832765,
                             0.0008044979,
                             0.00054250116,
                             0.0007697643,
                             0.00038416297,
                             0.00047641282,
                             0.00043855916,
                             0.00039241152,
                             0.0003976405,
                             0.00030880823,
                             0.00024362755,
                             0.00030756887,
                             0.0002781172,
                             0.00040910067,
                             0.00048805767,
                             0.00042267714,
                             0.0007709543,
                             0.015217986,
                             0.0007337147,
                             0.0012791075,
                             0.001453209,
                             0.0009156903,
                             0.0011495184,
                             0.0024375801,
                             0.0025421428,
                             0.0010732473,
                             0.0012942726,
                             0.0013784999],
                     'rmse': [0.037740894,
                              0.034519993,
                              0.03579633,
                              0.02167922,
                              0.021965856,
                              0.023628958,
                              0.028363673,
                              0.023291655,
                              0.027744627,
                              0.019600075,
                              0.021826884,
                              0.020941803,
                              0.01980938,
                              0.019940926,
                              0.01757294,
                              0.015608573,
                              0.017537642,
                              0.016676847,
                              0.020226236,
                              0.022092028,
                              0.020559113,
                              0.027766064,
                              0.1233612,
                              0.027087169,
                              0.035764612,
                              0.038120978,
                              0.030260375,
                              0.03390455,
                              0.049371857,
                              0.050419666,
                              0.032760452,
                              0.035976,
                              0.037128154]},
 'spectra_realpca': {'cosine': [0.99799204,
                                0.9980737,
                                0.9976556,
                                0.9999973,
                                0.9999956,
                                0.999998,
                                0.99999475,
                                0.9999974,
                                0.9999985,
                                0.9999998,
                                0.99999815,
                                0.9999992,
                                0.9999991,
                                0.9999986,
                                0.9999998,
                                0.9999999,
                                0.9999997,
                                0.9999997,
                                0.9999985,
                                0.99998814,
                                0.99999034,
                                0.99998754,
                                0.9999911,
                                0.9999027,
                                0.9983503,
                                0.99832535,
                                0.9999534,
                                0.99876463,
                                0.99796164,
                                0.9977203,
                                0.9980201,
                                0.9983813,
                                0.998318],
                     'mae': [0.009481992,
                             0.009402958,
                             0.010076729,
                             0.0007579672,
                             0.00097203243,
                             0.0007254759,
                             0.0010234572,
                             0.0008254812,
                             0.0006089716,
                             0.00030505052,
                             0.00069482555,
                             0.0005407253,
                             0.0005332674,
                             0.0006731087,
                             0.00032894785,
                             0.00022838326,
                             0.00031081252,
                             0.00034352337,
                             0.00067130086,
                             0.001504668,
                             0.0013781515,
                             0.0014530566,
                             0.0011805926,
                             0.0031568524,
                             0.0089343665,
                             0.008930194,
                             0.0021110913,
                             0.00850644,
                             0.009788244,
                             0.011067427,
                             0.00981979,
                             0.008984946,
                             0.008795362],
                     'max_mae': 0.011067427,
                     'max_mse': 0.00019590766,
                     'max_rmse': 0.013996702,
                     'median_mae': 0.0011805926,
                     'min_cosine': 0.9976556,
                     'mse': [0.0001433978,
                             0.00014223832,
                             0.00016265927,
                             9.128337e-07,
                             1.5217805e-06,
                             8.383736e-07,
                             1.6875675e-06,
                             1.0961173e-06,
                             5.9526235e-07,
                             1.4991456e-07,
                             7.726487e-07,
                             4.6824505e-07,
                             4.5392105e-07,
                             7.2593224e-07,
                             1.7396366e-07,
                             8.4570864e-08,
                             1.5580329e-07,
                             1.9099974e-07,
                             7.259897e-07,
                             3.6387396e-06,
                             3.0768867e-06,
                             3.3443555e-06,
                             2.2649876e-06,
                             1.581064e-05,
                             0.00012810742,
                             0.00012601764,
                             7.206784e-06,
                             0.000116161034,
                             0.00015381476,
                             0.00019590766,
                             0.00015445832,
                             0.00012938415,
                             0.00012376632],
                     'rmse': [0.011974882,
                              0.011926371,
                              0.012753794,
                              0.0009554233,
                              0.0012336047,
                              0.0009156274,
                              0.0012990641,
                              0.0010469562,
                              0.0007715325,
                              0.00038718802,
                              0.00087900436,
                              0.0006842843,
                              0.0006737366,
                              0.00085201656,
                              0.0004170895,
                              0.0002908107,
                              0.00039471925,
                              0.00043703517,
                              0.0008520503,
                              0.001907548,
                              0.0017541057,
                              0.0018287579,
                              0.0015049876,
                              0.0039762594,
                              0.0113184545,
                              0.011225758,
                              0.0026845455,
                              0.010777803,
                              0.012402208,
                              0.013996702,
                              0.012428126,
                              0.011374716,
                              0.011125032]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_70.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734
Directory path: experiments/inpainting/gann_4_night_20210905_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_70.0/images
Optimal number of principal components:  34
Reconstruction error:  5.149803
Energy conservation:  0.70675176
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_70.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.8998554886731998, 2.3844426057716714],
                   'kl_div': 0.92640233,
                   'ks_tests': {10000: KstestResult(statistic=0.3036, pvalue=1e-323, statistic_location=-0.0036659194, statistic_sign=-1),
                                20000: KstestResult(statistic=0.2994, pvalue=0.0, statistic_location=-0.0030355155, statistic_sign=-1),
                                30000: KstestResult(statistic=0.29866666666666664, pvalue=0.0, statistic_location=-0.003188748, statistic_sign=-1),
                                40000: KstestResult(statistic=0.30405, pvalue=0.0, statistic_location=-0.0028708102, statistic_sign=-1),
                                50000: KstestResult(statistic=0.29728, pvalue=0.0, statistic_location=-0.003034925, statistic_sign=-1),
                                60000: KstestResult(statistic=0.3007833333333333, pvalue=0.0, statistic_location=-0.003199581, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2987, pvalue=0.0, statistic_location=-0.0032599596, statistic_sign=-1),
                                80000: KstestResult(statistic=0.3026, pvalue=0.0, statistic_location=-0.0032070465, statistic_sign=-1),
                                90000: KstestResult(statistic=0.3025555555555555, pvalue=0.0, statistic_location=-0.0032040128, statistic_sign=-1),
                                100000: KstestResult(statistic=0.29940999999999995, pvalue=0.0, statistic_location=-0.0030323723, statistic_sign=-1),
                                110000: KstestResult(statistic=0.3019636363636364, pvalue=0.0, statistic_location=-0.0032023974, statistic_sign=-1)},
                   'moments': {'mean_error': -0.38380042,
                               'means': [-0.0013864677, 7.862203e-06],
                               'stds': [0.016771028, 0.0030725836],
                               'variance_ratio': 24.051632}},
 'originals': {'gan': {'mae': 0.02304842695593834,
                       'mse': 0.0009045852930285037,
                       'psnr': 30.321165084838867,
                       'rmse': 0.030076324939727783,
                       'ssim': 0.9525901675224304},
               'pca': {'mae': 0.004624534398317337,
                       'mse': 5.302940553519875e-05,
                       'psnr': 43.152183532714844,
                       'rmse': 0.007282129023224115,
                       'ssim': 0.9975597858428955}},
 'reconstructions': {'mae': 0.02233222872018814,
                     'mse': 0.0008514844812452793,
                     'psnr': 31.095584869384766,
                     'rmse': 0.02918020635843277,
                     'ssim': 0.9547605514526367},
 'residual_spectra_pcagan': {'cosine': [0.06580975,
                                        0.040620074,
                                        0.045855448,
                                        0.06167383,
                                        0.1003737,
                                        0.050858267,
                                        0.25596133,
                                        0.31055406,
                                        0.24888314,
                                        0.28192833,
                                        0.2283498],
                             'mae': [0.01057039,
                                     0.011931656,
                                     0.010141316,
                                     0.011200304,
                                     0.011085705,
                                     0.010124411,
                                     0.009986347,
                                     0.00842882,
                                     0.009426791,
                                     0.010338919,
                                     0.0104807895],
                             'max_mae': 0.011931656,
                             'max_mse': 0.00040357205,
                             'max_rmse': 0.020089103,
                             'median_distance': 1.6644154,
                             'median_mae': 0.010338919,
                             'min_cosine': 0.040620074,
                             'mse': [0.0002330961,
                                     0.00037881732,
                                     0.00023612802,
                                     0.0002798226,
                                     0.00040357205,
                                     0.00027702787,
                                     0.00023191328,
                                     0.00015809924,
                                     0.0002917485,
                                     0.00024241093,
                                     0.00028636755],
                             'rmse': [0.015267485,
                                      0.01946323,
                                      0.015366457,
                                      0.016727898,
                                      0.020089103,
                                      0.016644154,
                                      0.015228699,
                                      0.012573752,
                                      0.017080646,
                                      0.015569551,
                                      0.016922398]},
 'residuals': {'mae': 0.01033776719123125,
               'mse': 0.0002744548546615988,
               'psnr': 7.915472984313965,
               'rmse': 0.016566678881645203,
               'ssds': [31.150585, 1.0384821],
               'ssim': 0.32783299684524536},
 'spectra_pcagan': {'cosine': [0.9984644,
                               0.9986599,
                               0.9980857,
                               0.99541295,
                               0.99434096,
                               0.9958629,
                               0.9849199,
                               0.9856894,
                               0.98714054,
                               0.98819613,
                               0.9894049],
                    'mae': [0.017715994,
                            0.017560596,
                            0.017618194,
                            0.024904734,
                            0.023448821,
                            0.020153357,
                            0.026385581,
                            0.025685322,
                            0.023331366,
                            0.023469985,
                            0.025380585],
                    'max_mae': 0.026385581,
                    'max_mse': 0.0011346353,
                    'max_rmse': 0.033684347,
                    'median_mae': 0.023448821,
                    'min_cosine': 0.9849199,
                    'mse': [0.0005244083,
                            0.0005375968,
                            0.00051539135,
                            0.0010051222,
                            0.0009122761,
                            0.0007221159,
                            0.0011346353,
                            0.001039617,
                            0.0009557684,
                            0.000951643,
                            0.0010677553],
                    'rmse': [0.022899963,
                             0.023186134,
                             0.022702232,
                             0.031703662,
                             0.030203909,
                             0.026872214,
                             0.033684347,
                             0.03224309,
                             0.030915504,
                             0.030848712,
                             0.032676525]},
 'spectra_realgan': {'cosine': [0.998458,
                                0.9986553,
                                0.99807423,
                                0.9953859,
                                0.99427634,
                                0.9958382,
                                0.98346734,
                                0.98381656,
                                0.9854399,
                                0.9870309,
                                0.9884635],
                     'mae': [0.017761001,
                             0.01758181,
                             0.017673079,
                             0.024944419,
                             0.023610182,
                             0.02020968,
                             0.027729785,
                             0.027509704,
                             0.025184125,
                             0.024926031,
                             0.026402911],
                     'max_mae': 0.027729785,
                     'max_mse': 0.0012457832,
                     'max_rmse': 0.035295654,
                     'median_mae': 0.024926031,
                     'min_cosine': 0.98346734,
                     'mse': [0.0005266344,
                             0.0005391984,
                             0.0005184848,
                             0.0010091437,
                             0.00092273863,
                             0.00072642334,
                             0.0012457832,
                             0.0011789001,
                             0.0010824084,
                             0.0010480793,
                             0.0011526449],
                     'rmse': [0.022948517,
                              0.023220645,
                              0.022770261,
                              0.031767022,
                              0.030376613,
                              0.026952242,
                              0.035295654,
                              0.034335114,
                              0.032899976,
                              0.032374054,
                              0.033950623]},
 'spectra_realpca': {'cosine': [0.9999941,
                                0.99999696,
                                0.99999195,
                                0.99997187,
                                0.9999461,
                                0.9999654,
                                0.9983931,
                                0.99836904,
                                0.9983606,
                                0.99869525,
                                0.99897844],
                     'mae': [0.0011008234,
                             0.0008591478,
                             0.0011421905,
                             0.0017467798,
                             0.0023264424,
                             0.0018879073,
                             0.00872834,
                             0.008620247,
                             0.008698311,
                             0.008122903,
                             0.007636791],
                     'max_mae': 0.00872834,
                     'max_mse': 0.00012185675,
                     'max_rmse': 0.011038874,
                     'median_mae': 0.0023264424,
                     'min_cosine': 0.9983606,
                     'mse': [1.9381962e-06,
                             1.1816561e-06,
                             2.118694e-06,
                             4.882799e-06,
                             8.637777e-06,
                             5.7123298e-06,
                             0.00012185675,
                             0.000119673634,
                             0.00012085794,
                             0.00010429102,
                             9.2172646e-05],
                     'rmse': [0.0013921912,
                              0.0010870401,
                              0.0014555735,
                              0.0022097058,
                              0.0029390096,
                              0.002390048,
                              0.011038874,
                              0.010939544,
                              0.010993541,
                              0.010212298,
                              0.009600659]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_70.0

Running comparison for experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726
Directory path: experiments/inpainting/gann_4_night_20210905_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_70.0/images
Optimal number of principal components:  34
Reconstruction error:  5.149803
Energy conservation:  0.70675176
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_70.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9022391383209563, 2.4907236688205234],
                   'kl_div': 0.81688493,
                   'ks_tests': {10000: KstestResult(statistic=0.2848, pvalue=1e-323, statistic_location=-0.0037377253, statistic_sign=-1),
                                20000: KstestResult(statistic=0.2899, pvalue=0.0, statistic_location=-0.003937857, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2883, pvalue=0.0, statistic_location=-0.0041805618, statistic_sign=-1),
                                40000: KstestResult(statistic=0.28545, pvalue=0.0, statistic_location=-0.0037674531, statistic_sign=-1),
                                50000: KstestResult(statistic=0.29078000000000004, pvalue=0.0, statistic_location=-0.003927823, statistic_sign=-1),
                                60000: KstestResult(statistic=0.2904333333333333, pvalue=0.0, statistic_location=-0.003888783, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2888857142857143, pvalue=0.0, statistic_location=-0.0038245749, statistic_sign=-1),
                                80000: KstestResult(statistic=0.29107500000000003, pvalue=0.0, statistic_location=-0.004022494, statistic_sign=-1),
                                90000: KstestResult(statistic=0.28856666666666664, pvalue=0.0, statistic_location=-0.0038921507, statistic_sign=-1),
                                100000: KstestResult(statistic=0.28812000000000004, pvalue=0.0, statistic_location=-0.0041021323, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2897363636363637, pvalue=0.0, statistic_location=-0.0036856756, statistic_sign=-1),
                                120000: KstestResult(statistic=0.2877, pvalue=0.0, statistic_location=-0.0041483883, statistic_sign=-1),
                                130000: KstestResult(statistic=0.29009999999999997, pvalue=0.0, statistic_location=-0.0037503364, statistic_sign=-1),
                                140000: KstestResult(statistic=0.28752857142857147, pvalue=0.0, statistic_location=-0.0038897907, statistic_sign=-1),
                                150000: KstestResult(statistic=0.2873933333333333, pvalue=0.0, statistic_location=-0.003880937, statistic_sign=-1),
                                160000: KstestResult(statistic=0.29004375000000004, pvalue=0.0, statistic_location=-0.0036766897, statistic_sign=-1),
                                170000: KstestResult(statistic=0.28893529411764707, pvalue=0.0, statistic_location=-0.003920625, statistic_sign=-1),
                                180000: KstestResult(statistic=0.2895388888888889, pvalue=0.0, statistic_location=-0.003888756, statistic_sign=-1),
                                190000: KstestResult(statistic=0.28907894736842105, pvalue=0.0, statistic_location=-0.004021777, statistic_sign=-1),
                                200000: KstestResult(statistic=0.28822000000000003, pvalue=0.0, statistic_location=-0.0039168764, statistic_sign=-1),
                                210000: KstestResult(statistic=0.28874761904761903, pvalue=0.0, statistic_location=-0.0036770813, statistic_sign=-1),
                                220000: KstestResult(statistic=0.28957727272727274, pvalue=0.0, statistic_location=-0.0037520877, statistic_sign=-1)},
                   'moments': {'mean_error': -0.35358232,
                               'means': [-0.0014589109, 1.6279826e-06],
                               'stds': [0.01597184, 0.0033039153],
                               'variance_ratio': 18.132622}},
 'originals': {'gan': {'mae': 0.029287803918123245,
                       'mse': 0.0015978553565219045,
                       'psnr': 30.15612030029297,
                       'rmse': 0.039973184466362,
                       'ssim': 0.8410429954528809},
               'pca': {'mae': 0.005501050967723131,
                       'mse': 7.114972686395049e-05,
                       'psnr': 43.71955871582031,
                       'rmse': 0.008435029536485672,
                       'ssim': 0.9933850765228271}},
 'reconstructions': {'mae': 0.02843618579208851,
                     'mse': 0.0015278528444468975,
                     'psnr': 30.400476455688477,
                     'rmse': 0.03908775746822357,
                     'ssim': 0.8434553146362305},
 'residual_spectra_pcagan': {'cosine': [0.18406342,
                                        0.1771678,
                                        0.03884018,
                                        0.036753554,
                                        0.05437715,
                                        0.060939256,
                                        0.04111731,
                                        0.0585651,
                                        0.069343604,
                                        0.116188705,
                                        0.06049231,
                                        0.29198235,
                                        0.34862784,
                                        0.25863078,
                                        0.28205347,
                                        0.2476184,
                                        0.27673724,
                                        0.26617151,
                                        0.32325152,
                                        0.31901425,
                                        0.25685936,
                                        0.23475687],
                             'mae': [0.010000011,
                                     0.009662183,
                                     0.011750453,
                                     0.012688018,
                                     0.011126724,
                                     0.009937724,
                                     0.011325505,
                                     0.009623434,
                                     0.010766377,
                                     0.010933886,
                                     0.009445946,
                                     0.009302593,
                                     0.007879689,
                                     0.009269585,
                                     0.010336101,
                                     0.010027023,
                                     0.008430559,
                                     0.010406729,
                                     0.008516715,
                                     0.008732091,
                                     0.010162585,
                                     0.010946639],
                             'max_mae': 0.012688018,
                             'max_mse': 0.000408517,
                             'max_rmse': 0.020211803,
                             'median_distance': 1.5738137,
                             'median_mae': 0.010013517,
                             'min_cosine': 0.036753554,
                             'mse': [0.00021116078,
                                     0.00025401005,
                                     0.000408517,
                                     0.00031507024,
                                     0.0002917519,
                                     0.00019880205,
                                     0.00032217588,
                                     0.00019518023,
                                     0.00024814365,
                                     0.0003459404,
                                     0.00021654865,
                                     0.00017495631,
                                     0.00012422352,
                                     0.00026267866,
                                     0.0002452898,
                                     0.00025145095,
                                     0.00021114435,
                                     0.0002472347,
                                     0.00015029579,
                                     0.00017729959,
                                     0.00030748427,
                                     0.00027396926],
                             'rmse': [0.014531372,
                                      0.015937693,
                                      0.020211803,
                                      0.017750219,
                                      0.017080747,
                                      0.014099718,
                                      0.017949259,
                                      0.013970692,
                                      0.015752576,
                                      0.018599473,
                                      0.014715592,
                                      0.013227105,
                                      0.01114556,
                                      0.016207363,
                                      0.01566173,
                                      0.015857205,
                                      0.014530807,
                                      0.0157237,
                                      0.012259519,
                                      0.013315389,
                                      0.01753523,
                                      0.016552016]},
 'residuals': {'mae': 0.010057753883302212,
               'mse': 0.0002469694591127336,
               'psnr': 15.06167984008789,
               'rmse': 0.015715261921286583,
               'ssds': [56.58993, 2.4014783],
               'ssim': 0.3777783513069153},
 'spectra_pcagan': {'cosine': [0.9915466,
                               0.9907369,
                               0.9871948,
                               0.99796736,
                               0.9989058,
                               0.9984699,
                               0.9986084,
                               0.99805284,
                               0.9952307,
                               0.9937238,
                               0.99583393,
                               0.984724,
                               0.9855012,
                               0.9863716,
                               0.9870835,
                               0.988327,
                               0.9898441,
                               0.98192316,
                               0.9905809,
                               0.99215186,
                               0.9876376,
                               0.9865315],
                    'mae': [0.032943428,
                            0.025177572,
                            0.102310404,
                            0.02304186,
                            0.018324459,
                            0.017620038,
                            0.017868277,
                            0.017885912,
                            0.025329564,
                            0.025152102,
                            0.021091815,
                            0.026731942,
                            0.026113195,
                            0.02442547,
                            0.025033627,
                            0.025955139,
                            0.024402658,
                            0.031796902,
                            0.028048867,
                            0.027054345,
                            0.028334076,
                            0.03095441],
                    'max_mae': 0.102310404,
                    'max_mse': 0.01132726,
                    'max_rmse': 0.1064296,
                    'median_mae': 0.025253568,
                    'min_cosine': 0.98192316,
                    'mse': [0.0015453704,
                            0.0010623394,
                            0.01132726,
                            0.00085978117,
                            0.00056482916,
                            0.00051786035,
                            0.0005551506,
                            0.00052932685,
                            0.0010280173,
                            0.0010178589,
                            0.00076863,
                            0.001147904,
                            0.0010582522,
                            0.0010359928,
                            0.0010574025,
                            0.0011072428,
                            0.0010314686,
                            0.001679356,
                            0.0013550554,
                            0.0013122333,
                            0.0014311292,
                            0.0016203014],
                    'rmse': [0.0393112,
                             0.03259355,
                             0.1064296,
                             0.029322024,
                             0.023766134,
                             0.022756545,
                             0.023561634,
                             0.023007104,
                             0.03206271,
                             0.0319039,
                             0.027724177,
                             0.033880733,
                             0.03253079,
                             0.03218684,
                             0.032517724,
                             0.033275258,
                             0.032116484,
                             0.040979948,
                             0.036811076,
                             0.03622476,
                             0.037830267,
                             0.04025297]},
 'spectra_realgan': {'cosine': [0.99123394,
                                0.9902624,
                                0.9871952,
                                0.9979616,
                                0.9989008,
                                0.9984643,
                                0.9986038,
                                0.9980408,
                                0.9952043,
                                0.99365646,
                                0.9958094,
                                0.983297,
                                0.98359954,
                                0.9846978,
                                0.98593897,
                                0.9873881,
                                0.9882228,
                                0.98030245,
                                0.9895242,
                                0.9912504,
                                0.9861599,
                                0.9852592],
                     'mae': [0.033293802,
                             0.025828442,
                             0.1023199,
                             0.023086376,
                             0.018353743,
                             0.017655663,
                             0.017890358,
                             0.01794392,
                             0.025359174,
                             0.0253027,
                             0.021159025,
                             0.028000178,
                             0.027902456,
                             0.026169192,
                             0.026349114,
                             0.026939869,
                             0.026175153,
                             0.033334106,
                             0.029743358,
                             0.029068142,
                             0.029867334,
                             0.032589678],
                     'max_mae': 0.1023199,
                     'max_mse': 0.011329075,
                     'max_rmse': 0.10643813,
                     'median_mae': 0.026262134,
                     'min_cosine': 0.98030245,
                     'mse': [0.0015887072,
                             0.0011122404,
                             0.011329075,
                             0.00086258753,
                             0.00056717097,
                             0.00051985384,
                             0.00055677374,
                             0.0005326531,
                             0.0010319196,
                             0.0010287588,
                             0.0007730479,
                             0.0012569764,
                             0.0011995608,
                             0.0011607273,
                             0.0011529092,
                             0.001192531,
                             0.0011627579,
                             0.0018270147,
                             0.0015063011,
                             0.001459055,
                             0.00156433,
                             0.0017678612],
                     'rmse': [0.03985859,
                              0.033350267,
                              0.10643813,
                              0.02936984,
                              0.02381535,
                              0.022800304,
                              0.023596054,
                              0.02307928,
                              0.032123506,
                              0.03207427,
                              0.02780374,
                              0.035453863,
                              0.034634676,
                              0.03406945,
                              0.033954516,
                              0.034533042,
                              0.034099236,
                              0.042743593,
                              0.038811095,
                              0.038197577,
                              0.039551612,
                              0.04204594]},
 'spectra_realpca': {'cosine': [0.999771,
                                0.99941605,
                                0.9999984,
                                0.99999756,
                                0.9999967,
                                0.9999941,
                                0.99999696,
                                0.99999195,
                                0.99997187,
                                0.9999461,
                                0.9999654,
                                0.9983931,
                                0.99836904,
                                0.9983606,
                                0.99869525,
                                0.99897844,
                                0.9983582,
                                0.9984486,
                                0.99884087,
                                0.99902266,
                                0.9984555,
                                0.9986762],
                     'mae': [0.004248829,
                             0.0061585396,
                             0.00057613046,
                             0.00076506555,
                             0.00094270427,
                             0.0011008234,
                             0.0008591478,
                             0.0011421905,
                             0.0017467798,
                             0.0023264424,
                             0.0018879073,
                             0.00872834,
                             0.008620247,
                             0.008698311,
                             0.008122903,
                             0.007636791,
                             0.0091312695,
                             0.009242538,
                             0.009964783,
                             0.010020309,
                             0.009411591,
                             0.009691481],
                     'max_mae': 0.010020309,
                     'max_mse': 0.00016403582,
                     'max_rmse': 0.012807647,
                     'median_mae': 0.0068976656,
                     'min_cosine': 0.9983582,
                     'mse': [2.9171772e-05,
                             6.0982227e-05,
                             5.2973786e-07,
                             9.334554e-07,
                             1.4296747e-06,
                             1.9381962e-06,
                             1.1816561e-06,
                             2.118694e-06,
                             4.882799e-06,
                             8.637777e-06,
                             5.7123298e-06,
                             0.00012185675,
                             0.000119673634,
                             0.00012085794,
                             0.00010429102,
                             9.2172646e-05,
                             0.00013401345,
                             0.00013734639,
                             0.00016403582,
                             0.00016169691,
                             0.00014137557,
                             0.00015045551],
                     'rmse': [0.00540109,
                              0.007809112,
                              0.0007278309,
                              0.00096615497,
                              0.00119569,
                              0.0013921912,
                              0.0010870401,
                              0.0014555735,
                              0.0022097058,
                              0.0029390096,
                              0.002390048,
                              0.011038874,
                              0.010939544,
                              0.010993541,
                              0.010212298,
                              0.009600659,
                              0.011576418,
                              0.011719488,
                              0.012807647,
                              0.01271601,
                              0.011890146,
                              0.012266031]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_70.0

Running comparison for experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226
Directory path: experiments/inpainting/gann_4_night_20210905_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 70.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_70.0/images
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_70.0/images
Optimal number of principal components:  34
Reconstruction error:  5.149803
Energy conservation:  0.70675176
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_70.0
saved spectra in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_70.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_70.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_70.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.867696224533345, 2.422110268369719],
                   'kl_div': 0.84374803,
                   'ks_tests': {10000: KstestResult(statistic=0.2782, pvalue=1e-323, statistic_location=-0.0029166527, statistic_sign=-1),
                                20000: KstestResult(statistic=0.27965, pvalue=0.0, statistic_location=-0.0028901715, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2842, pvalue=0.0, statistic_location=-0.003965294, statistic_sign=-1),
                                40000: KstestResult(statistic=0.27954999999999997, pvalue=0.0, statistic_location=-0.0030389614, statistic_sign=-1),
                                50000: KstestResult(statistic=0.27986, pvalue=0.0, statistic_location=-0.0032602837, statistic_sign=-1),
                                60000: KstestResult(statistic=0.2769833333333333, pvalue=0.0, statistic_location=-0.0036242502, statistic_sign=-1),
                                70000: KstestResult(statistic=0.27664285714285713, pvalue=0.0, statistic_location=-0.0037359577, statistic_sign=-1),
                                80000: KstestResult(statistic=0.27756250000000005, pvalue=0.0, statistic_location=-0.003301181, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2776333333333333, pvalue=0.0, statistic_location=-0.0031913891, statistic_sign=-1),
                                100000: KstestResult(statistic=0.27586, pvalue=0.0, statistic_location=-0.0038296846, statistic_sign=-1),
                                110000: KstestResult(statistic=0.28054545454545454, pvalue=0.0, statistic_location=-0.0037372336, statistic_sign=-1),
                                120000: KstestResult(statistic=0.2816916666666667, pvalue=0.0, statistic_location=-0.003491274, statistic_sign=-1),
                                130000: KstestResult(statistic=0.27863076923076924, pvalue=0.0, statistic_location=-0.0034077372, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2806571428571429, pvalue=0.0, statistic_location=-0.0032219524, statistic_sign=-1),
                                150000: KstestResult(statistic=0.2785533333333333, pvalue=0.0, statistic_location=-0.0033904847, statistic_sign=-1),
                                160000: KstestResult(statistic=0.27861875, pvalue=0.0, statistic_location=-0.0032946374, statistic_sign=-1),
                                170000: KstestResult(statistic=0.27899411764705884, pvalue=0.0, statistic_location=-0.0033018664, statistic_sign=-1),
                                180000: KstestResult(statistic=0.2788611111111111, pvalue=0.0, statistic_location=-0.0034104749, statistic_sign=-1),
                                190000: KstestResult(statistic=0.2769, pvalue=0.0, statistic_location=-0.0034262314, statistic_sign=-1),
                                200000: KstestResult(statistic=0.28033, pvalue=0.0, statistic_location=-0.0032052863, statistic_sign=-1),
                                210000: KstestResult(statistic=0.2769095238095238, pvalue=0.0, statistic_location=-0.0032500774, statistic_sign=-1),
                                220000: KstestResult(statistic=0.27789545454545456, pvalue=0.0, statistic_location=-0.003278798, statistic_sign=-1),
                                230000: KstestResult(statistic=0.27925217391304347, pvalue=0.0, statistic_location=-0.0032566749, statistic_sign=-1),
                                240000: KstestResult(statistic=0.27948333333333336, pvalue=0.0, statistic_location=-0.0033834428, statistic_sign=-1),
                                250000: KstestResult(statistic=0.278824, pvalue=0.0, statistic_location=-0.0033834428, statistic_sign=-1),
                                260000: KstestResult(statistic=0.2781461538461539, pvalue=0.0, statistic_location=-0.0034138784, statistic_sign=-1),
                                270000: KstestResult(statistic=0.2795888888888889, pvalue=0.0, statistic_location=-0.003426265, statistic_sign=-1),
                                280000: KstestResult(statistic=0.2783464285714286, pvalue=0.0, statistic_location=-0.003355557, statistic_sign=-1),
                                290000: KstestResult(statistic=0.27877241379310347, pvalue=0.0, statistic_location=-0.0032896139, statistic_sign=-1),
                                300000: KstestResult(statistic=0.2794633333333333, pvalue=0.0, statistic_location=-0.0033903453, statistic_sign=-1),
                                310000: KstestResult(statistic=0.2777258064516129, pvalue=0.0, statistic_location=-0.0033073723, statistic_sign=-1),
                                320000: KstestResult(statistic=0.2796625, pvalue=0.0, statistic_location=-0.0033877455, statistic_sign=-1),
                                330000: KstestResult(statistic=0.2784484848484849, pvalue=0.0, statistic_location=-0.0033874675, statistic_sign=-1)},
                   'moments': {'mean_error': -0.14329761,
                               'means': [-0.00065364566, -1.2697252e-05],
                               'stds': [0.015172766, 0.0031718498],
                               'variance_ratio': 19.128069}},
 'originals': {'gan': {'mae': 0.04760170727968216,
                       'mse': 0.015234838239848614,
                       'psnr': 23.57074737548828,
                       'rmse': 0.12342948466539383,
                       'ssim': 0.8455886840820312},
               'pca': {'mae': 0.00512340385466814,
                       'mse': 6.514146662084386e-05,
                       'psnr': 47.56675338745117,
                       'rmse': 0.008071026764810085,
                       'ssim': 0.9944632053375244}},
 'reconstructions': {'mae': 0.04689476266503334,
                     'mse': 0.015174094587564468,
                     'psnr': 23.89430046081543,
                     'rmse': 0.12318317592144012,
                     'ssim': 0.8486637473106384},
 'residual_spectra_pcagan': {'cosine': [0.18392359,
                                        0.03508808,
                                        0.09731865,
                                        0.035326626,
                                        0.06563898,
                                        0.042680684,
                                        0.20307893,
                                        0.19571361,
                                        0.034037244,
                                        0.04064339,
                                        0.05348736,
                                        0.061180044,
                                        0.045900896,
                                        0.064277515,
                                        0.070307694,
                                        0.119023874,
                                        0.06908175,
                                        0.3181978,
                                        0.37103602,
                                        0.28867546,
                                        0.30254704,
                                        0.25402343,
                                        0.29827204,
                                        0.29010814,
                                        0.34668458,
                                        0.3325961,
                                        0.2573471,
                                        0.24220319,
                                        0.2836405,
                                        0.27831903,
                                        0.04200193,
                                        0.29318613,
                                        0.3292711],
                             'mae': [0.008708407,
                                     0.009112635,
                                     0.008231636,
                                     0.010230665,
                                     0.009064117,
                                     0.010193875,
                                     0.008826193,
                                     0.008990663,
                                     0.011252232,
                                     0.0122656375,
                                     0.0108274035,
                                     0.009625741,
                                     0.010698551,
                                     0.009135978,
                                     0.010113855,
                                     0.01023528,
                                     0.009221096,
                                     0.008558734,
                                     0.0073326034,
                                     0.008568755,
                                     0.00960368,
                                     0.009532805,
                                     0.008055386,
                                     0.009643361,
                                     0.008068465,
                                     0.008239405,
                                     0.009887525,
                                     0.01034801,
                                     0.009139903,
                                     0.010408167,
                                     0.013187407,
                                     0.010613397,
                                     0.007863716],
                             'max_mae': 0.013187407,
                             'max_mse': 0.00045974145,
                             'max_rmse': 0.021441583,
                             'median_distance': 1.4481717,
                             'median_mae': 0.009532805,
                             'min_cosine': 0.034037244,
                             'mse': [0.00018024667,
                                     0.0001789339,
                                     0.00013874494,
                                     0.00026655348,
                                     0.00016488362,
                                     0.00031194536,
                                     0.00016533495,
                                     0.00021500044,
                                     0.0003415807,
                                     0.00029087014,
                                     0.0002733259,
                                     0.00019251446,
                                     0.0002736827,
                                     0.0001694751,
                                     0.0002122128,
                                     0.0003040158,
                                     0.0002071583,
                                     0.00015061523,
                                     0.0001079736,
                                     0.0002155686,
                                     0.00020060716,
                                     0.00023338938,
                                     0.00017965575,
                                     0.00020972014,
                                     0.0001319221,
                                     0.0001523054,
                                     0.000291986,
                                     0.00024919072,
                                     0.00020000977,
                                     0.00025659185,
                                     0.00045974145,
                                     0.00021810965,
                                     0.0001547057],
                             'rmse': [0.013425598,
                                      0.013376618,
                                      0.011779005,
                                      0.016326467,
                                      0.012840701,
                                      0.017661976,
                                      0.012858264,
                                      0.0146628935,
                                      0.0184819,
                                      0.017054915,
                                      0.01653257,
                                      0.013874958,
                                      0.016543359,
                                      0.01301826,
                                      0.014567526,
                                      0.017436048,
                                      0.014392995,
                                      0.01227254,
                                      0.010391035,
                                      0.014682255,
                                      0.014163585,
                                      0.015277087,
                                      0.013403572,
                                      0.014481718,
                                      0.011485735,
                                      0.012341207,
                                      0.017087597,
                                      0.015785776,
                                      0.014142482,
                                      0.016018486,
                                      0.021441583,
                                      0.014768536,
                                      0.012438075]},
 'residuals': {'mae': 0.009569250978529453,
               'mse': 0.0002211688697570935,
               'psnr': 15.540872573852539,
               'rmse': 0.014871747232973576,
               'ssds': [76.11101, 3.320052],
               'ssim': 0.48061227798461914},
 'spectra_pcagan': {'cosine': [0.99571353,
                               0.9987698,
                               0.9988425,
                               0.99757105,
                               0.9983874,
                               0.9977505,
                               0.9924044,
                               0.9906407,
                               0.9875055,
                               0.9980502,
                               0.99888885,
                               0.9984391,
                               0.99867,
                               0.998115,
                               0.99542385,
                               0.9941637,
                               0.9958556,
                               0.9853293,
                               0.98510796,
                               0.98722494,
                               0.9876562,
                               0.9890692,
                               0.98957896,
                               0.9834858,
                               0.99085355,
                               0.99223715,
                               0.98729783,
                               0.98677915,
                               0.98785895,
                               0.9506573,
                               0.22048935,
                               0.9526608,
                               0.9883736],
                    'mae': [0.019548114,
                            0.015856937,
                            0.014332895,
                            0.023797723,
                            0.016455134,
                            0.020155089,
                            0.031046905,
                            0.025222624,
                            0.10155133,
                            0.02275108,
                            0.01835541,
                            0.01774055,
                            0.017500961,
                            0.017523693,
                            0.024574863,
                            0.024042618,
                            0.020763665,
                            0.0261678,
                            0.026105395,
                            0.023354838,
                            0.024151772,
                            0.025649557,
                            0.023820274,
                            0.030042578,
                            0.027910864,
                            0.026819699,
                            0.028069867,
                            0.030499948,
                            0.02653014,
                            0.052137427,
                            0.660768,
                            0.061358355,
                            0.022920894],
                    'max_mae': 0.660768,
                    'max_mse': 0.4539662,
                    'max_rmse': 0.6737701,
                    'median_mae': 0.024151772,
                    'min_cosine': 0.22048935,
                    'mse': [0.0006543317,
                            0.00041862365,
                            0.0003527394,
                            0.00083291123,
                            0.00044323187,
                            0.000713248,
                            0.0013664764,
                            0.0010708236,
                            0.01115823,
                            0.000834013,
                            0.00056830095,
                            0.0005293187,
                            0.0005329698,
                            0.0005080735,
                            0.0009806703,
                            0.00094554253,
                            0.0007497971,
                            0.0011057418,
                            0.001081742,
                            0.0009497797,
                            0.0009908347,
                            0.0010789385,
                            0.0009941756,
                            0.0015261344,
                            0.0013244438,
                            0.0012888552,
                            0.0014095635,
                            0.0015681976,
                            0.0012500283,
                            0.0035738337,
                            0.4539662,
                            0.0050865486,
                            0.0008908306],
                    'rmse': [0.025579909,
                             0.020460295,
                             0.018781357,
                             0.028860202,
                             0.021053072,
                             0.026706703,
                             0.03696588,
                             0.03272344,
                             0.10563252,
                             0.028879283,
                             0.023839064,
                             0.023006927,
                             0.023086138,
                             0.022540485,
                             0.031315655,
                             0.030749675,
                             0.027382422,
                             0.033252697,
                             0.032889847,
                             0.030818496,
                             0.031477526,
                             0.0328472,
                             0.031530548,
                             0.03906577,
                             0.03639291,
                             0.03590063,
                             0.037544154,
                             0.039600477,
                             0.03535574,
                             0.05978155,
                             0.6737701,
                             0.07132004,
                             0.029846786]},
 'spectra_realgan': {'cosine': [0.99551606,
                                0.99876493,
                                0.998834,
                                0.9975661,
                                0.99837786,
                                0.99773633,
                                0.99210477,
                                0.9901588,
                                0.9875063,
                                0.99804485,
                                0.998884,
                                0.99843335,
                                0.9986652,
                                0.99810314,
                                0.9953987,
                                0.99409795,
                                0.99582976,
                                0.9838773,
                                0.98321396,
                                0.9855097,
                                0.9865273,
                                0.98814774,
                                0.9879648,
                                0.9818447,
                                0.9897904,
                                0.99135786,
                                0.9858405,
                                0.98552793,
                                0.98651767,
                                0.94852924,
                                0.22059292,
                                0.95217806,
                                0.9869008],
                     'mae': [0.020037107,
                             0.015912255,
                             0.014391269,
                             0.023837084,
                             0.016507203,
                             0.020245522,
                             0.031399462,
                             0.025884708,
                             0.10155997,
                             0.022796175,
                             0.01838432,
                             0.017779658,
                             0.017534042,
                             0.017570745,
                             0.024619915,
                             0.024194777,
                             0.02081853,
                             0.027516412,
                             0.02790788,
                             0.02519892,
                             0.025496606,
                             0.026611898,
                             0.025614468,
                             0.031711437,
                             0.029571984,
                             0.028770838,
                             0.02958031,
                             0.032048073,
                             0.028307056,
                             0.052727222,
                             0.6607522,
                             0.061087396,
                             0.024480982],
                     'max_mae': 0.6607522,
                     'max_mse': 0.45394132,
                     'max_rmse': 0.67375165,
                     'median_mae': 0.025496606,
                     'min_cosine': 0.22059292,
                     'mse': [0.0006847224,
                             0.00042060914,
                             0.00035519275,
                             0.00083531276,
                             0.00044600133,
                             0.0007178343,
                             0.0014078029,
                             0.0011215004,
                             0.011159921,
                             0.0008367397,
                             0.00057064573,
                             0.00053135445,
                             0.0005346202,
                             0.00051128113,
                             0.0009843968,
                             0.000956167,
                             0.00075439765,
                             0.0012169064,
                             0.0012226423,
                             0.0010774441,
                             0.001084441,
                             0.0011621554,
                             0.0011252251,
                             0.0016751209,
                             0.0014774654,
                             0.0014325636,
                             0.0015413447,
                             0.0017133632,
                             0.0013875355,
                             0.003736696,
                             0.45394132,
                             0.005122565,
                             0.0010044165],
                     'rmse': [0.0261672,
                              0.020508757,
                              0.018846558,
                              0.028901778,
                              0.021118743,
                              0.02679243,
                              0.0375207,
                              0.03348881,
                              0.10564053,
                              0.028926454,
                              0.023888193,
                              0.023051128,
                              0.023121856,
                              0.022611527,
                              0.0313751,
                              0.030921951,
                              0.0274663,
                              0.034884185,
                              0.0349663,
                              0.03282444,
                              0.03293085,
                              0.0340904,
                              0.033544376,
                              0.04092824,
                              0.038437814,
                              0.03784922,
                              0.039259963,
                              0.041392792,
                              0.037249636,
                              0.06112852,
                              0.67375165,
                              0.071572095,
                              0.03169253]},
 'spectra_realpca': {'cosine': [0.99980634,
                                0.9999962,
                                0.9999895,
                                0.9999955,
                                0.9999925,
                                0.99998814,
                                0.999771,
                                0.99941605,
                                0.9999984,
                                0.99999756,
                                0.9999967,
                                0.9999941,
                                0.99999696,
                                0.99999195,
                                0.99997187,
                                0.9999461,
                                0.9999654,
                                0.9983931,
                                0.99836904,
                                0.9983606,
                                0.99869525,
                                0.99897844,
                                0.9983582,
                                0.9984486,
                                0.99884087,
                                0.99902266,
                                0.9984555,
                                0.9986762,
                                0.9985885,
                                0.99823856,
                                0.99996895,
                                0.99851316,
                                0.9984362],
                     'mae': [0.00431076,
                             0.00088838977,
                             0.0014122103,
                             0.0009211836,
                             0.0011384196,
                             0.0014490155,
                             0.004248829,
                             0.0061585396,
                             0.00057613046,
                             0.00076506555,
                             0.00094270427,
                             0.0011008234,
                             0.0008591478,
                             0.0011421905,
                             0.0017467798,
                             0.0023264424,
                             0.0018879073,
                             0.00872834,
                             0.008620247,
                             0.008698311,
                             0.008122903,
                             0.007636791,
                             0.0091312695,
                             0.009242538,
                             0.009964783,
                             0.010020309,
                             0.009411591,
                             0.009691481,
                             0.009534602,
                             0.009004905,
                             0.0012012443,
                             0.009541788,
                             0.008646675],
                     'max_mae': 0.010020309,
                     'max_mse': 0.00016403582,
                     'max_rmse': 0.012807647,
                     'median_mae': 0.00431076,
                     'min_cosine': 0.99823856,
                     'mse': [2.9586661e-05,
                             1.2747653e-06,
                             3.2168566e-06,
                             1.3534777e-06,
                             2.0776804e-06,
                             3.3753074e-06,
                             2.9171772e-05,
                             6.0982227e-05,
                             5.2973786e-07,
                             9.334554e-07,
                             1.4296747e-06,
                             1.9381962e-06,
                             1.1816561e-06,
                             2.118694e-06,
                             4.882799e-06,
                             8.637777e-06,
                             5.7123298e-06,
                             0.00012185675,
                             0.000119673634,
                             0.00012085794,
                             0.00010429102,
                             9.2172646e-05,
                             0.00013401345,
                             0.00013734639,
                             0.00016403582,
                             0.00016169691,
                             0.00014137557,
                             0.00015045551,
                             0.00014517433,
                             0.00013099036,
                             2.345113e-06,
                             0.00014584187,
                             0.000119137825],
                     'rmse': [0.005439362,
                              0.001129055,
                              0.0017935598,
                              0.0011633906,
                              0.0014414161,
                              0.001837201,
                              0.00540109,
                              0.007809112,
                              0.0007278309,
                              0.00096615497,
                              0.00119569,
                              0.0013921912,
                              0.0010870401,
                              0.0014555735,
                              0.0022097058,
                              0.0029390096,
                              0.002390048,
                              0.011038874,
                              0.010939544,
                              0.010993541,
                              0.010212298,
                              0.009600659,
                              0.011576418,
                              0.011719488,
                              0.012807647,
                              0.01271601,
                              0.011890146,
                              0.012266031,
                              0.012048831,
                              0.011445102,
                              0.0015313762,
                              0.012076501,
                              0.010915028]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_70.0
