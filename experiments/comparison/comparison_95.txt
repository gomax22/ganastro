
Running comparison for experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805
Directory path: experiments/inpainting/gann_4_night_20180708_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_95.0/images
Optimal number of principal components:  50
Reconstruction error:  2.4857676
Energy conservation:  0.95483905
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_95.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [3.933204310299706, 2.60921431598656],
                   'kl_div': 0.7772076,
                   'ks_tests': {10000: KstestResult(statistic=0.2582, pvalue=3.0048950945119737e-293, statistic_location=0.003770457, statistic_sign=1),
                                20000: KstestResult(statistic=0.25560000000000005, pvalue=0.0, statistic_location=0.0035448242, statistic_sign=1),
                                30000: KstestResult(statistic=0.254, pvalue=0.0, statistic_location=0.0042720614, statistic_sign=1),
                                40000: KstestResult(statistic=0.25665000000000004, pvalue=0.0, statistic_location=0.0038649822, statistic_sign=1),
                                50000: KstestResult(statistic=0.25522, pvalue=0.0, statistic_location=0.0035853249, statistic_sign=1),
                                60000: KstestResult(statistic=0.2567166666666667, pvalue=0.0, statistic_location=0.0034569204, statistic_sign=1),
                                70000: KstestResult(statistic=0.25405714285714287, pvalue=0.0, statistic_location=0.0037916754, statistic_sign=1),
                                80000: KstestResult(statistic=0.25160000000000005, pvalue=0.0, statistic_location=0.0039594267, statistic_sign=1),
                                90000: KstestResult(statistic=0.25392222222222227, pvalue=0.0, statistic_location=0.0035442393, statistic_sign=1),
                                100000: KstestResult(statistic=0.25601000000000007, pvalue=0.0, statistic_location=0.0035834587, statistic_sign=1),
                                110000: KstestResult(statistic=0.2551545454545454, pvalue=0.0, statistic_location=0.003817344, statistic_sign=1)},
                   'moments': {'mean_error': 0.08301779,
                               'means': [-1.1889718e-05, -3.3516608e-05],
                               'stds': [0.017084507, 0.0039586634],
                               'variance_ratio': 19.317822}},
 'originals': {'gan': {'mae': 0.044734351336956024,
                       'mse': 0.00500925537198782,
                       'psnr': 27.338207244873047,
                       'rmse': 0.0707760900259018,
                       'ssim': 0.9471726417541504},
               'pca': {'mae': 0.00781815592199564,
                       'mse': 0.00015583737695124,
                       'psnr': 42.38079071044922,
                       'rmse': 0.012483484111726284,
                       'ssim': 0.9980934262275696}},
 'reconstructions': {'mae': 0.043408431112766266,
                     'mse': 0.0048898085951805115,
                     'psnr': 27.414587020874023,
                     'rmse': 0.0699271634221077,
                     'ssim': 0.9483321309089661},
 'residual_spectra_pcagan': {'cosine': [0.30810043,
                                        0.038467925,
                                        0.35356236,
                                        0.1419355,
                                        0.024674747,
                                        0.37489212,
                                        0.37585622,
                                        0.15589118,
                                        0.3867748,
                                        0.053937715,
                                        0.058457732],
                             'mae': [0.010949723,
                                     0.013461828,
                                     0.009034332,
                                     0.011139865,
                                     0.012204669,
                                     0.008488124,
                                     0.0088075455,
                                     0.00980971,
                                     0.008978305,
                                     0.010175299,
                                     0.012642592],
                             'max_mae': 0.013461828,
                             'max_mse': 0.00045077785,
                             'max_rmse': 0.02123153,
                             'median_distance': 1.4728705,
                             'median_mae': 0.010175299,
                             'min_cosine': 0.024674747,
                             'mse': [0.00030001436,
                                     0.00041957345,
                                     0.00021307047,
                                     0.00027497593,
                                     0.00039228878,
                                     0.00018809119,
                                     0.00016590986,
                                     0.00021693477,
                                     0.0002057734,
                                     0.0002135901,
                                     0.00045077785],
                             'rmse': [0.017320924,
                                      0.020483492,
                                      0.0145969335,
                                      0.016582398,
                                      0.01980628,
                                      0.013714634,
                                      0.0128806,
                                      0.014728705,
                                      0.014344804,
                                      0.014614722,
                                      0.02123153]},
 'residuals': {'mae': 0.010517453774809837,
               'mse': 0.0002764545497484505,
               'psnr': 12.783865928649902,
               'rmse': 0.01662692241370678,
               'ssds': [32.106564, 1.7239196],
               'ssim': 0.3993820250034332},
 'spectra_pcagan': {'cosine': [0.99288577,
                               0.9993867,
                               0.9979495,
                               0.9889149,
                               0.99242496,
                               0.9975381,
                               0.9970355,
                               0.9732629,
                               0.9950007,
                               0.9888354,
                               0.98281705],
                    'mae': [0.029244015,
                            0.021968678,
                            0.036889583,
                            0.027141925,
                            0.021430466,
                            0.038406853,
                            0.03023791,
                            0.19409712,
                            0.023359722,
                            0.024580847,
                            0.030135589],
                    'max_mae': 0.19409712,
                    'max_mse': 0.03999258,
                    'max_rmse': 0.19998145,
                    'median_mae': 0.029244015,
                    'min_cosine': 0.9732629,
                    'mse': [0.0015593137,
                            0.00069347507,
                            0.0021750205,
                            0.0012394794,
                            0.00081051484,
                            0.0022527743,
                            0.0014875312,
                            0.03999258,
                            0.0009810799,
                            0.0009954959,
                            0.001600639],
                    'rmse': [0.039488148,
                             0.026333915,
                             0.046637114,
                             0.03520624,
                             0.028469542,
                             0.0474634,
                             0.038568527,
                             0.19998145,
                             0.031322196,
                             0.03155148,
                             0.040007986]},
 'spectra_realgan': {'cosine': [0.99175346,
                                0.9993864,
                                0.9974738,
                                0.9885626,
                                0.992407,
                                0.99695754,
                                0.996352,
                                0.97315854,
                                0.99355114,
                                0.98881245,
                                0.9826634],
                     'mae': [0.032277416,
                             0.021971023,
                             0.039228965,
                             0.027653707,
                             0.021448666,
                             0.04044802,
                             0.03310232,
                             0.19353077,
                             0.027468923,
                             0.024600843,
                             0.030347247],
                     'max_mae': 0.19353077,
                     'max_mse': 0.039805513,
                     'max_rmse': 0.1995132,
                     'median_mae': 0.030347247,
                     'min_cosine': 0.97315854,
                     'mse': [0.001811758,
                             0.00069365103,
                             0.0024994803,
                             0.0012799344,
                             0.00081188173,
                             0.002571155,
                             0.0017536087,
                             0.039805513,
                             0.0012606264,
                             0.0009979114,
                             0.0016162823],
                     'rmse': [0.04256475,
                              0.026337255,
                              0.049994804,
                              0.03577617,
                              0.028493538,
                              0.050706558,
                              0.04187611,
                              0.1995132,
                              0.035505302,
                              0.031589735,
                              0.040203013]},
 'spectra_realpca': {'cosine': [0.99883115,
                                0.9999997,
                                0.9994911,
                                0.99967736,
                                0.9999942,
                                0.9993735,
                                0.9992462,
                                0.9997684,
                                0.9985732,
                                0.99994504,
                                0.9998922],
                     'mae': [0.012722015,
                             0.00019061168,
                             0.015452519,
                             0.0047533596,
                             0.00060395064,
                             0.015141101,
                             0.014260718,
                             0.005450875,
                             0.013180933,
                             0.0017294439,
                             0.0025141847],
                     'max_mae': 0.015452519,
                     'max_mse': 0.00038461294,
                     'max_rmse': 0.01961155,
                     'median_mae': 0.005450875,
                     'min_cosine': 0.9985732,
                     'mse': [0.00025771876,
                             5.8041014e-08,
                             0.00038461294,
                             3.6003996e-05,
                             5.8543395e-07,
                             0.00036587077,
                             0.00032775613,
                             4.8817277e-05,
                             0.00027789405,
                             4.810402e-06,
                             1.0083003e-05],
                     'rmse': [0.01605362,
                              0.00024091703,
                              0.01961155,
                              0.006000333,
                              0.00076513656,
                              0.019127749,
                              0.018104037,
                              0.006986936,
                              0.016670154,
                              0.0021932628,
                              0.0031753744]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_95.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628
Directory path: experiments/inpainting/gann_4_night_20180708_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_95.0/images
Optimal number of principal components:  50
Reconstruction error:  2.4857676
Energy conservation:  0.95483905
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_95.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.079875858281184, 2.2417410957130257],
                   'kl_div': 1.2726457,
                   'ks_tests': {10000: KstestResult(statistic=0.337, pvalue=0.0, statistic_location=-0.0029174704, statistic_sign=-1),
                                20000: KstestResult(statistic=0.3336, pvalue=0.0, statistic_location=-0.0030959398, statistic_sign=-1),
                                30000: KstestResult(statistic=0.33133333333333337, pvalue=0.0, statistic_location=-0.0027839728, statistic_sign=-1),
                                40000: KstestResult(statistic=0.33662499999999995, pvalue=0.0, statistic_location=-0.0026933234, statistic_sign=-1),
                                50000: KstestResult(statistic=0.33864, pvalue=0.0, statistic_location=-0.0027485387, statistic_sign=-1),
                                60000: KstestResult(statistic=0.3421166666666666, pvalue=0.0, statistic_location=-0.00276598, statistic_sign=-1),
                                70000: KstestResult(statistic=0.33561428571428575, pvalue=0.0, statistic_location=-0.0029092655, statistic_sign=-1),
                                80000: KstestResult(statistic=0.3395625, pvalue=0.0, statistic_location=-0.0026937537, statistic_sign=-1),
                                90000: KstestResult(statistic=0.3379444444444445, pvalue=0.0, statistic_location=-0.0026744604, statistic_sign=-1),
                                100000: KstestResult(statistic=0.33704, pvalue=0.0, statistic_location=-0.0028284565, statistic_sign=-1),
                                110000: KstestResult(statistic=0.3366272727272727, pvalue=0.0, statistic_location=-0.0026758704, statistic_sign=-1),
                                120000: KstestResult(statistic=0.33974166666666666, pvalue=0.0, statistic_location=-0.0027724262, statistic_sign=-1),
                                130000: KstestResult(statistic=0.3398538461538462, pvalue=0.0, statistic_location=-0.0026547704, statistic_sign=-1),
                                140000: KstestResult(statistic=0.33645, pvalue=0.0, statistic_location=-0.002679015, statistic_sign=-1),
                                150000: KstestResult(statistic=0.3361733333333333, pvalue=0.0, statistic_location=-0.0027643894, statistic_sign=-1),
                                160000: KstestResult(statistic=0.33480624999999997, pvalue=0.0, statistic_location=-0.002783197, statistic_sign=-1),
                                170000: KstestResult(statistic=0.33606470588235293, pvalue=0.0, statistic_location=-0.0026766025, statistic_sign=-1),
                                180000: KstestResult(statistic=0.3379833333333333, pvalue=0.0, statistic_location=-0.0027578203, statistic_sign=-1),
                                190000: KstestResult(statistic=0.33812105263157893, pvalue=0.0, statistic_location=-0.0026934762, statistic_sign=-1),
                                200000: KstestResult(statistic=0.33547, pvalue=0.0, statistic_location=-0.002783239, statistic_sign=-1),
                                210000: KstestResult(statistic=0.3371142857142857, pvalue=0.0, statistic_location=-0.0028160885, statistic_sign=-1),
                                220000: KstestResult(statistic=0.3399, pvalue=0.0, statistic_location=-0.0026859287, statistic_sign=-1)},
                   'moments': {'mean_error': -0.35787034,
                               'means': [-0.0014181881, -1.5181382e-05],
                               'stds': [0.01881039, 0.003269516],
                               'variance_ratio': 33.15301}},
 'originals': {'gan': {'mae': 0.041415736079216,
                       'mse': 0.003690463025122881,
                       'psnr': 29.55628204345703,
                       'rmse': 0.06074918061494827,
                       'ssim': 0.9063164591789246},
               'pca': {'mae': 0.005768998060375452,
                       'mse': 0.00011619419819908217,
                       'psnr': 44.76762390136719,
                       'rmse': 0.01077934168279171,
                       'ssim': 0.9979035258293152}},
 'reconstructions': {'mae': 0.04073088988661766,
                     'mse': 0.0035946746356785297,
                     'psnr': 29.862871170043945,
                     'rmse': 0.05995560437440872,
                     'ssim': 0.9070869088172913},
 'residual_spectra_pcagan': {'cosine': [0.018518858,
                                        -0.012485181,
                                        0.015768668,
                                        0.26634055,
                                        0.29212955,
                                        0.35725608,
                                        0.0060013523,
                                        0.30203134,
                                        0.10978001,
                                        0.017101701,
                                        0.35540712,
                                        0.3173696,
                                        0.1444443,
                                        0.29700312,
                                        0.04352576,
                                        0.071407646,
                                        0.07986364,
                                        0.068301775,
                                        0.03581426,
                                        0.026005765,
                                        0.05964709,
                                        -0.013121994],
                             'mae': [0.01416106,
                                     0.015154227,
                                     0.013814108,
                                     0.013957824,
                                     0.012039044,
                                     0.010156388,
                                     0.014516449,
                                     0.011295511,
                                     0.013002341,
                                     0.013697493,
                                     0.009940711,
                                     0.011299364,
                                     0.011175907,
                                     0.011361944,
                                     0.013025174,
                                     0.013050351,
                                     0.011153764,
                                     0.0126118045,
                                     0.011988289,
                                     0.012825653,
                                     0.011531216,
                                     0.011942224],
                             'max_mae': 0.015154227,
                             'max_mse': 0.0004915145,
                             'max_rmse': 0.022170126,
                             'median_distance': 1.824194,
                             'median_mae': 0.012325425,
                             'min_cosine': -0.013121994,
                             'mse': [0.00039680628,
                                     0.0004915145,
                                     0.00044072047,
                                     0.00037270278,
                                     0.00031868095,
                                     0.00020935449,
                                     0.00043699532,
                                     0.00031466037,
                                     0.00033900965,
                                     0.0004887208,
                                     0.00022178059,
                                     0.00027012924,
                                     0.00028490595,
                                     0.0004153512,
                                     0.00035814408,
                                     0.0003772089,
                                     0.00028734576,
                                     0.00032702557,
                                     0.00026236844,
                                     0.00033046686,
                                     0.00033507776,
                                     0.00030948015],
                             'rmse': [0.019919997,
                                      0.022170126,
                                      0.020993343,
                                      0.019305512,
                                      0.017851638,
                                      0.014469087,
                                      0.020904433,
                                      0.017738668,
                                      0.018412216,
                                      0.02210703,
                                      0.0148923,
                                      0.016435608,
                                      0.016879158,
                                      0.020380167,
                                      0.018924695,
                                      0.019421866,
                                      0.016951276,
                                      0.018083848,
                                      0.016197791,
                                      0.018178748,
                                      0.018305128,
                                      0.017592048]},
 'residuals': {'mae': 0.012440947815775871,
               'mse': 0.0003449295472819358,
               'psnr': 12.505508422851562,
               'rmse': 0.018572278320789337,
               'ssds': [78.28488, 2.3517818],
               'ssim': 0.28708285093307495},
 'spectra_pcagan': {'cosine': [0.9989436,
                               0.9994021,
                               0.9815271,
                               0.9946708,
                               0.9968679,
                               0.99282706,
                               0.99916637,
                               0.9968031,
                               0.98252237,
                               0.9885074,
                               0.9966641,
                               0.99474937,
                               0.9767623,
                               0.9916372,
                               0.9571402,
                               0.9769457,
                               0.98657984,
                               0.978592,
                               0.98830277,
                               0.9993159,
                               0.9809762,
                               0.9974106],
                    'mae': [0.017139282,
                            0.020172134,
                            0.028650727,
                            0.04854551,
                            0.057326496,
                            0.030862091,
                            0.019983487,
                            0.05432025,
                            0.03489035,
                            0.026193121,
                            0.047015358,
                            0.04300967,
                            0.1802139,
                            0.031239554,
                            0.058321685,
                            0.03581446,
                            0.028848331,
                            0.04188395,
                            0.02747847,
                            0.017707568,
                            0.026272748,
                            0.020190515],
                    'max_mae': 0.1802139,
                    'max_mse': 0.035397276,
                    'max_rmse': 0.18814164,
                    'median_mae': 0.031050824,
                    'min_cosine': 0.9571402,
                    'mse': [0.0004724609,
                            0.00059287576,
                            0.0013605672,
                            0.0036759172,
                            0.0054587573,
                            0.0016039349,
                            0.0006231778,
                            0.0043183058,
                            0.0019756977,
                            0.0011709064,
                            0.003278878,
                            0.0029303704,
                            0.035397276,
                            0.0018470957,
                            0.004502192,
                            0.0021627739,
                            0.0013953804,
                            0.002723101,
                            0.0012205791,
                            0.00047678122,
                            0.0012191237,
                            0.0006766814],
                    'rmse': [0.021736166,
                             0.02434904,
                             0.036885865,
                             0.06062934,
                             0.07388341,
                             0.040049158,
                             0.02496353,
                             0.065713815,
                             0.044448823,
                             0.03421851,
                             0.05726149,
                             0.054132897,
                             0.18814164,
                             0.04297785,
                             0.06709838,
                             0.046505634,
                             0.03735479,
                             0.05218334,
                             0.03493679,
                             0.02183532,
                             0.034915954,
                             0.0260131]},
 'spectra_realgan': {'cosine': [0.99894327,
                                0.99940234,
                                0.98145306,
                                0.99415404,
                                0.9965239,
                                0.991695,
                                0.99916625,
                                0.99628097,
                                0.9822146,
                                0.9884819,
                                0.9960184,
                                0.994058,
                                0.97664857,
                                0.99022675,
                                0.95710987,
                                0.97679853,
                                0.98647827,
                                0.9784223,
                                0.9882579,
                                0.99931574,
                                0.98092294,
                                0.997411],
                     'mae': [0.017146079,
                             0.020168345,
                             0.028706223,
                             0.050800398,
                             0.059404463,
                             0.033509545,
                             0.019985925,
                             0.055692036,
                             0.03531207,
                             0.02621587,
                             0.048675243,
                             0.044680182,
                             0.17965956,
                             0.03404801,
                             0.05834632,
                             0.035970166,
                             0.028960349,
                             0.04211721,
                             0.02753194,
                             0.017711489,
                             0.026319312,
                             0.020185553],
                     'max_mae': 0.17965956,
                     'max_mse': 0.035222843,
                     'max_rmse': 0.1876775,
                     'median_mae': 0.03377878,
                     'min_cosine': 0.95710987,
                     'mse': [0.00047266626,
                             0.00059270527,
                             0.0013652463,
                             0.00403947,
                             0.005812725,
                             0.0018575729,
                             0.0006232374,
                             0.004649755,
                             0.0020181779,
                             0.0011730588,
                             0.0036266067,
                             0.0031747771,
                             0.035222843,
                             0.0021111243,
                             0.004506634,
                             0.0021810574,
                             0.0014073155,
                             0.0027539334,
                             0.0012253452,
                             0.00047697028,
                             0.0012224708,
                             0.0006764928],
                     'rmse': [0.02174089,
                              0.02434554,
                              0.03694924,
                              0.06355683,
                              0.07624123,
                              0.04309957,
                              0.024964724,
                              0.068189114,
                              0.044924136,
                              0.034249946,
                              0.060221314,
                              0.05634516,
                              0.1876775,
                              0.045946974,
                              0.06713147,
                              0.046701793,
                              0.037514202,
                              0.052477933,
                              0.035004932,
                              0.021839648,
                              0.03496385,
                              0.026009476]},
 'spectra_realpca': {'cosine': [0.99999976,
                                1.0,
                                0.9999799,
                                0.9994423,
                                0.9996571,
                                0.99883115,
                                0.9999997,
                                0.9994911,
                                0.99967736,
                                0.9999942,
                                0.9993735,
                                0.9992462,
                                0.9997684,
                                0.9985732,
                                0.99994504,
                                0.9998922,
                                0.9999318,
                                0.9998641,
                                0.9999849,
                                0.9999998,
                                0.9999474,
                                0.9999996],
                     'mae': [0.0002631881,
                             8.989925e-05,
                             0.00094471977,
                             0.015518005,
                             0.016359909,
                             0.012722015,
                             0.00019061168,
                             0.015452519,
                             0.0047533596,
                             0.00060395064,
                             0.015141101,
                             0.014260718,
                             0.005450875,
                             0.013180933,
                             0.0017294439,
                             0.0025141847,
                             0.0020254236,
                             0.0030052625,
                             0.00093163375,
                             0.00012715781,
                             0.0013997033,
                             0.00025334145],
                     'max_mae': 0.016359909,
                     'max_mse': 0.00042878123,
                     'max_rmse': 0.020707034,
                     'median_mae': 0.002269804,
                     'min_cosine': 0.9985732,
                     'mse': [1.1196593e-07,
                             1.2843708e-08,
                             1.4508116e-06,
                             0.00038604756,
                             0.00042878123,
                             0.00025771876,
                             5.8041014e-08,
                             0.00038461294,
                             3.6003996e-05,
                             5.8543395e-07,
                             0.00036587077,
                             0.00032775613,
                             4.8817277e-05,
                             0.00027789405,
                             4.810402e-06,
                             1.0083003e-05,
                             6.5408094e-06,
                             1.4453861e-05,
                             1.3924425e-06,
                             2.600932e-08,
                             3.1410518e-06,
                             1.0302092e-07],
                     'rmse': [0.0003346131,
                              0.00011333008,
                              0.0012044964,
                              0.019648094,
                              0.020707034,
                              0.01605362,
                              0.00024091703,
                              0.01961155,
                              0.006000333,
                              0.00076513656,
                              0.019127749,
                              0.018104037,
                              0.006986936,
                              0.016670154,
                              0.0021932628,
                              0.0031753744,
                              0.0025575007,
                              0.0038018234,
                              0.0011800181,
                              0.00016127405,
                              0.0017723013,
                              0.0003209687]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_95.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354
Directory path: experiments/inpainting/gann_4_night_20180708_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_95.0/images
Optimal number of principal components:  50
Reconstruction error:  2.4857676
Energy conservation:  0.95483905
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_95.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.061857105227111, 1.8803966972663115],
                   'kl_div': 1.5952917,
                   'ks_tests': {10000: KstestResult(statistic=0.3557, pvalue=0.0, statistic_location=-0.0019081207, statistic_sign=-1),
                                20000: KstestResult(statistic=0.35845000000000005, pvalue=0.0, statistic_location=-0.00242831, statistic_sign=-1),
                                30000: KstestResult(statistic=0.3589, pvalue=0.0, statistic_location=-0.0021665916, statistic_sign=-1),
                                40000: KstestResult(statistic=0.359925, pvalue=0.0, statistic_location=-0.0020103902, statistic_sign=-1),
                                50000: KstestResult(statistic=0.36112, pvalue=0.0, statistic_location=-0.0019512996, statistic_sign=-1),
                                60000: KstestResult(statistic=0.358, pvalue=0.0, statistic_location=-0.0019550472, statistic_sign=-1),
                                70000: KstestResult(statistic=0.35865714285714284, pvalue=0.0, statistic_location=-0.0019709198, statistic_sign=-1),
                                80000: KstestResult(statistic=0.3631875, pvalue=0.0, statistic_location=-0.002132116, statistic_sign=-1),
                                90000: KstestResult(statistic=0.3601444444444445, pvalue=0.0, statistic_location=-0.0019582845, statistic_sign=-1),
                                100000: KstestResult(statistic=0.36284, pvalue=0.0, statistic_location=-0.00193909, statistic_sign=-1),
                                110000: KstestResult(statistic=0.3569363636363636, pvalue=0.0, statistic_location=-0.0020097948, statistic_sign=-1),
                                120000: KstestResult(statistic=0.3606916666666667, pvalue=0.0, statistic_location=-0.0020115077, statistic_sign=-1),
                                130000: KstestResult(statistic=0.3572692307692308, pvalue=0.0, statistic_location=-0.002068445, statistic_sign=-1),
                                140000: KstestResult(statistic=0.3613142857142857, pvalue=0.0, statistic_location=-0.0019823192, statistic_sign=-1),
                                150000: KstestResult(statistic=0.3578466666666667, pvalue=0.0, statistic_location=-0.0018738993, statistic_sign=-1),
                                160000: KstestResult(statistic=0.36185625, pvalue=0.0, statistic_location=-0.0020051496, statistic_sign=-1),
                                170000: KstestResult(statistic=0.35915294117647056, pvalue=0.0, statistic_location=-0.001962781, statistic_sign=-1),
                                180000: KstestResult(statistic=0.36090555555555554, pvalue=0.0, statistic_location=-0.0020027822, statistic_sign=-1),
                                190000: KstestResult(statistic=0.36128947368421055, pvalue=0.0, statistic_location=-0.002131766, statistic_sign=-1),
                                200000: KstestResult(statistic=0.36048, pvalue=0.0, statistic_location=-0.0020680632, statistic_sign=-1),
                                210000: KstestResult(statistic=0.3592047619047619, pvalue=0.0, statistic_location=-0.002031548, statistic_sign=-1),
                                220000: KstestResult(statistic=0.3615818181818182, pvalue=0.0, statistic_location=-0.0020901784, statistic_sign=-1),
                                230000: KstestResult(statistic=0.36119565217391303, pvalue=0.0, statistic_location=-0.0020126104, statistic_sign=-1),
                                240000: KstestResult(statistic=0.35908333333333337, pvalue=0.0, statistic_location=-0.0020493679, statistic_sign=-1),
                                250000: KstestResult(statistic=0.357564, pvalue=0.0, statistic_location=-0.0020329459, statistic_sign=-1),
                                260000: KstestResult(statistic=0.3612730769230769, pvalue=0.0, statistic_location=-0.0019612557, statistic_sign=-1),
                                270000: KstestResult(statistic=0.3583925925925926, pvalue=0.0, statistic_location=-0.0020867418, statistic_sign=-1),
                                280000: KstestResult(statistic=0.35971071428571433, pvalue=0.0, statistic_location=-0.0020115077, statistic_sign=-1),
                                290000: KstestResult(statistic=0.3603413793103448, pvalue=0.0, statistic_location=-0.0020677508, statistic_sign=-1),
                                300000: KstestResult(statistic=0.35789, pvalue=0.0, statistic_location=-0.002048648, statistic_sign=-1),
                                310000: KstestResult(statistic=0.3612870967741935, pvalue=0.0, statistic_location=-0.0020556748, statistic_sign=-1),
                                320000: KstestResult(statistic=0.35879375, pvalue=0.0, statistic_location=-0.0020672046, statistic_sign=-1),
                                330000: KstestResult(statistic=0.35968787878787883, pvalue=0.0, statistic_location=-0.0020332993, statistic_sign=-1)},
                   'moments': {'mean_error': -0.12352873,
                               'means': [-0.0005078844, -1.101691e-05],
                               'stds': [0.017889043, 0.0026782162],
                               'variance_ratio': 49.830116}},
 'originals': {'gan': {'mae': 0.03434796258807182,
                       'mse': 0.0026877636555582285,
                       'psnr': 30.955209732055664,
                       'rmse': 0.05184364691376686,
                       'ssim': 0.9331125020980835},
               'pca': {'mae': 0.004009527154266834,
                       'mse': 7.765802001813427e-05,
                       'psnr': 46.60012435913086,
                       'rmse': 0.008812379091978073,
                       'ssim': 0.9986545443534851}},
 'reconstructions': {'mae': 0.033885493874549866,
                     'mse': 0.0026238528080284595,
                     'psnr': 31.312593460083008,
                     'rmse': 0.05122355744242668,
                     'ssim': 0.933671772480011},
 'residual_spectra_pcagan': {'cosine': [0.046114888,
                                        0.01024056,
                                        0.03924592,
                                        -0.0060932254,
                                        0.034828473,
                                        0.029691838,
                                        0.019852638,
                                        -0.01355155,
                                        0.014780102,
                                        0.26220322,
                                        0.3028935,
                                        0.36817127,
                                        0.008698612,
                                        0.30719113,
                                        0.11933395,
                                        0.021067185,
                                        0.3697024,
                                        0.3177671,
                                        0.14300868,
                                        0.30670854,
                                        0.047007762,
                                        0.06730617,
                                        0.084047675,
                                        0.0710261,
                                        0.0362823,
                                        0.026277538,
                                        0.05890954,
                                        -0.016712483,
                                        -0.0044144904,
                                        0.018482573,
                                        0.027809992,
                                        0.011848096,
                                        0.017451944],
                             'mae': [0.0108469045,
                                     0.011672056,
                                     0.010450002,
                                     0.012126634,
                                     0.011091931,
                                     0.01447108,
                                     0.01429688,
                                     0.015055045,
                                     0.013684357,
                                     0.013971341,
                                     0.011653995,
                                     0.0098629985,
                                     0.014336596,
                                     0.011149235,
                                     0.012447628,
                                     0.013181731,
                                     0.009552026,
                                     0.011193654,
                                     0.010925653,
                                     0.0110690715,
                                     0.012755138,
                                     0.012847915,
                                     0.010953386,
                                     0.012349913,
                                     0.011900161,
                                     0.012620993,
                                     0.011402339,
                                     0.012004845,
                                     0.0114256125,
                                     0.010925603,
                                     0.010461401,
                                     0.011601718,
                                     0.013457014],
                             'max_mae': 0.015055045,
                             'max_mse': 0.00047285834,
                             'max_rmse': 0.021745306,
                             'median_distance': 1.7400633,
                             'median_mae': 0.011672056,
                             'min_cosine': -0.016712483,
                             'mse': [0.00021936011,
                                     0.0002562833,
                                     0.00022102437,
                                     0.000359096,
                                     0.00022867972,
                                     0.0004322694,
                                     0.0004073162,
                                     0.00047285834,
                                     0.0004268859,
                                     0.0003797372,
                                     0.00029876834,
                                     0.00019933097,
                                     0.00042071723,
                                     0.0003027821,
                                     0.0002953511,
                                     0.00041677264,
                                     0.00019782691,
                                     0.000270408,
                                     0.00027043806,
                                     0.0003821235,
                                     0.00033377152,
                                     0.00036654915,
                                     0.00026534687,
                                     0.00030364032,
                                     0.00025464006,
                                     0.0003235487,
                                     0.0003260383,
                                     0.00032194343,
                                     0.0002783217,
                                     0.00021818157,
                                     0.00023320914,
                                     0.00028036488,
                                     0.00036520284],
                             'rmse': [0.014810811,
                                      0.01600885,
                                      0.0148668885,
                                      0.018949829,
                                      0.01512216,
                                      0.02079109,
                                      0.020182077,
                                      0.021745306,
                                      0.020661218,
                                      0.019486846,
                                      0.017284917,
                                      0.014118462,
                                      0.020511393,
                                      0.017400635,
                                      0.017185783,
                                      0.02041501,
                                      0.014065095,
                                      0.016444087,
                                      0.016445002,
                                      0.019547978,
                                      0.018269414,
                                      0.019145474,
                                      0.01628947,
                                      0.017425278,
                                      0.015957445,
                                      0.01798746,
                                      0.01805653,
                                      0.017942782,
                                      0.016682977,
                                      0.014770971,
                                      0.015271187,
                                      0.0167441,
                                      0.019110281]},
 'residuals': {'mae': 0.012052874080836773,
               'mse': 0.00031299356487579644,
               'psnr': 12.927460670471191,
               'rmse': 0.01769162341952324,
               'ssds': [105.69071, 2.3670702],
               'ssim': 0.2824035584926605},
 'spectra_pcagan': {'cosine': [0.99725384,
                               0.999222,
                               0.9832296,
                               0.9942427,
                               0.98273385,
                               0.9984884,
                               0.9989244,
                               0.99940854,
                               0.9813714,
                               0.99461985,
                               0.99688655,
                               0.99286294,
                               0.99917454,
                               0.99680805,
                               0.9828533,
                               0.9889871,
                               0.9967272,
                               0.9947417,
                               0.97672355,
                               0.99188054,
                               0.9576231,
                               0.97754705,
                               0.9868041,
                               0.97875077,
                               0.9882671,
                               0.9993119,
                               0.9808119,
                               0.9973657,
                               0.9840908,
                               0.99536574,
                               0.9951823,
                               0.99834573,
                               0.9996882],
                    'mae': [0.018538184,
                            0.014980058,
                            0.023851627,
                            0.021065438,
                            0.024201283,
                            0.01830628,
                            0.01733376,
                            0.019908775,
                            0.028720364,
                            0.048683655,
                            0.05712166,
                            0.030742291,
                            0.019979075,
                            0.05359641,
                            0.03455691,
                            0.02574675,
                            0.04674181,
                            0.043442324,
                            0.18079309,
                            0.030463226,
                            0.05803518,
                            0.035394944,
                            0.028528098,
                            0.041923255,
                            0.02752786,
                            0.017820295,
                            0.026235217,
                            0.02018302,
                            0.025284497,
                            0.020640807,
                            0.022121293,
                            0.018934874,
                            0.01681878],
                    'max_mae': 0.18079309,
                    'max_mse': 0.035627086,
                    'max_rmse': 0.18875138,
                    'median_mae': 0.02574675,
                    'min_cosine': 0.9576231,
                    'mse': [0.00055744534,
                            0.00035849746,
                            0.0009540637,
                            0.0007567548,
                            0.0009743952,
                            0.00057340815,
                            0.00048482727,
                            0.00057912274,
                            0.0013683148,
                            0.0037097721,
                            0.005416191,
                            0.0015928276,
                            0.0006220893,
                            0.004234846,
                            0.0019380036,
                            0.0011164034,
                            0.0032390454,
                            0.0029604004,
                            0.035627086,
                            0.0017730412,
                            0.0044531506,
                            0.00210258,
                            0.0013624651,
                            0.0027034131,
                            0.0012264977,
                            0.00048148909,
                            0.0012256176,
                            0.00068216183,
                            0.001036679,
                            0.0006878823,
                            0.00079948595,
                            0.0005769362,
                            0.0004122603],
                    'rmse': [0.02361028,
                             0.01893403,
                             0.030887922,
                             0.027509175,
                             0.031215305,
                             0.023945943,
                             0.022018794,
                             0.02406497,
                             0.03699074,
                             0.0609079,
                             0.07359478,
                             0.039910246,
                             0.024941718,
                             0.065075696,
                             0.04402276,
                             0.033412624,
                             0.056912612,
                             0.054409564,
                             0.18875138,
                             0.042107496,
                             0.06673193,
                             0.045853898,
                             0.036911584,
                             0.051994357,
                             0.03502139,
                             0.02194286,
                             0.03500882,
                             0.026118228,
                             0.0321975,
                             0.02622751,
                             0.028275182,
                             0.024019497,
                             0.020304194]},
 'spectra_realgan': {'cosine': [0.9972508,
                                0.9992217,
                                0.9832243,
                                0.9942407,
                                0.9827068,
                                0.99848765,
                                0.9989239,
                                0.99940866,
                                0.981297,
                                0.9941067,
                                0.9965379,
                                0.99172515,
                                0.99917454,
                                0.99628705,
                                0.98253846,
                                0.98896176,
                                0.9960904,
                                0.9940449,
                                0.9766165,
                                0.9904791,
                                0.95758724,
                                0.9774088,
                                0.98670197,
                                0.97857785,
                                0.9882232,
                                0.99931186,
                                0.9807606,
                                0.99736637,
                                0.9840904,
                                0.9953628,
                                0.9951784,
                                0.99834573,
                                0.9996884],
                     'mae': [0.01854198,
                             0.014985778,
                             0.023866238,
                             0.021071851,
                             0.024249308,
                             0.018311145,
                             0.017341811,
                             0.019904904,
                             0.028784158,
                             0.050913114,
                             0.059168078,
                             0.03345968,
                             0.019981595,
                             0.055011444,
                             0.03497756,
                             0.025771726,
                             0.048374493,
                             0.04506426,
                             0.18023531,
                             0.033359133,
                             0.05806259,
                             0.03555152,
                             0.02864439,
                             0.04216679,
                             0.02758377,
                             0.017824937,
                             0.026277814,
                             0.02017742,
                             0.02529138,
                             0.020647043,
                             0.022136098,
                             0.018928431,
                             0.016816907],
                     'max_mae': 0.18023531,
                     'max_mse': 0.035449803,
                     'max_rmse': 0.18828118,
                     'median_mae': 0.025771726,
                     'min_cosine': 0.95758724,
                     'mse': [0.00055797707,
                             0.00035868314,
                             0.00095437886,
                             0.0007570537,
                             0.0009759421,
                             0.0005737491,
                             0.00048503513,
                             0.0005789536,
                             0.0013730456,
                             0.004070556,
                             0.0057761464,
                             0.0018476741,
                             0.0006221682,
                             0.0045668185,
                             0.0019810996,
                             0.0011185808,
                             0.0035820708,
                             0.0032059634,
                             0.035449803,
                             0.0020360278,
                             0.004457984,
                             0.0021198776,
                             0.0013743723,
                             0.0027345,
                             0.0012311836,
                             0.00048168088,
                             0.0012288577,
                             0.0006819425,
                             0.0010366923,
                             0.0006882518,
                             0.0008001526,
                             0.0005767722,
                             0.0004122014],
                     'rmse': [0.023621539,
                              0.018938933,
                              0.030893022,
                              0.027514609,
                              0.031240072,
                              0.02395306,
                              0.022023514,
                              0.024061454,
                              0.03705463,
                              0.06380091,
                              0.076000966,
                              0.04298458,
                              0.0249433,
                              0.06757824,
                              0.044509545,
                              0.03344519,
                              0.059850402,
                              0.056621227,
                              0.18828118,
                              0.045122366,
                              0.06676814,
                              0.04604213,
                              0.03707253,
                              0.052292448,
                              0.035088226,
                              0.02194723,
                              0.035055067,
                              0.026114028,
                              0.032197706,
                              0.026234554,
                              0.02828697,
                              0.024016082,
                              0.020302743]},
 'spectra_realpca': {'cosine': [0.99999887,
                                0.9999999,
                                0.9999553,
                                0.9999987,
                                0.9999652,
                                0.9999997,
                                0.99999976,
                                1.0,
                                0.9999799,
                                0.9994423,
                                0.9996571,
                                0.99883115,
                                0.9999997,
                                0.9994911,
                                0.99967736,
                                0.9999942,
                                0.9993735,
                                0.9992462,
                                0.9997684,
                                0.9985732,
                                0.99994504,
                                0.9998922,
                                0.9999318,
                                0.9998641,
                                0.9999849,
                                0.9999998,
                                0.9999474,
                                0.9999996,
                                0.9999889,
                                0.9999985,
                                0.9999968,
                                0.9999994,
                                0.9999999],
                     'mae': [0.00037831237,
                             0.00018116426,
                             0.0012455331,
                             0.00032357126,
                             0.0011014702,
                             0.0002491568,
                             0.0002631881,
                             8.989925e-05,
                             0.00094471977,
                             0.015518005,
                             0.016359909,
                             0.012722015,
                             0.00019061168,
                             0.015452519,
                             0.0047533596,
                             0.00060395064,
                             0.015141101,
                             0.014260718,
                             0.005450875,
                             0.013180933,
                             0.0017294439,
                             0.0025141847,
                             0.0020254236,
                             0.0030052625,
                             0.00093163375,
                             0.00012715781,
                             0.0013997033,
                             0.00025334145,
                             0.0006425221,
                             0.00036646734,
                             0.0005023152,
                             0.0003179152,
                             8.80222e-05],
                     'max_mae': 0.016359909,
                     'max_mse': 0.00042878123,
                     'max_rmse': 0.020707034,
                     'median_mae': 0.00094471977,
                     'min_cosine': 0.9985732,
                     'mse': [2.3038126e-07,
                             5.2633418e-08,
                             2.5002319e-06,
                             1.6830626e-07,
                             1.9382476e-06,
                             9.907547e-08,
                             1.1196593e-07,
                             1.2843708e-08,
                             1.4508116e-06,
                             0.00038604756,
                             0.00042878123,
                             0.00025771876,
                             5.8041014e-08,
                             0.00038461294,
                             3.6003996e-05,
                             5.8543395e-07,
                             0.00036587077,
                             0.00032775613,
                             4.8817277e-05,
                             0.00027789405,
                             4.810402e-06,
                             1.0083003e-05,
                             6.5408094e-06,
                             1.4453861e-05,
                             1.3924425e-06,
                             2.600932e-08,
                             3.1410518e-06,
                             1.0302092e-07,
                             6.5947296e-07,
                             2.1449004e-07,
                             4.0324983e-07,
                             1.6350978e-07,
                             1.2446228e-08],
                     'rmse': [0.0004799805,
                              0.00022941975,
                              0.0015812122,
                              0.00041025146,
                              0.0013922096,
                              0.00031476255,
                              0.0003346131,
                              0.00011333008,
                              0.0012044964,
                              0.019648094,
                              0.020707034,
                              0.01605362,
                              0.00024091703,
                              0.01961155,
                              0.006000333,
                              0.00076513656,
                              0.019127749,
                              0.018104037,
                              0.006986936,
                              0.016670154,
                              0.0021932628,
                              0.0031753744,
                              0.0025575007,
                              0.0038018234,
                              0.0011800181,
                              0.00016127405,
                              0.0017723013,
                              0.0003209687,
                              0.0008120794,
                              0.0004631307,
                              0.00063501956,
                              0.00040436344,
                              0.000111562666]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_95.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516
Directory path: experiments/inpainting/gann_4_night_20180722_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_95.0/images
Optimal number of principal components:  37
Reconstruction error:  4.8338265
Energy conservation:  0.9522806
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_95.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.35918432275619, 2.053949934292132],
                   'kl_div': 1.874945,
                   'ks_tests': {10000: KstestResult(statistic=0.4027, pvalue=0.0, statistic_location=0.0041540116, statistic_sign=1),
                                20000: KstestResult(statistic=0.396, pvalue=0.0, statistic_location=0.0032587573, statistic_sign=1),
                                30000: KstestResult(statistic=0.40516666666666656, pvalue=0.0, statistic_location=0.0036059273, statistic_sign=1),
                                40000: KstestResult(statistic=0.40605, pvalue=0.0, statistic_location=0.003598244, statistic_sign=1),
                                50000: KstestResult(statistic=0.40528, pvalue=0.0, statistic_location=0.003593125, statistic_sign=1),
                                60000: KstestResult(statistic=0.4051, pvalue=0.0, statistic_location=0.0036275247, statistic_sign=1),
                                70000: KstestResult(statistic=0.40184285714285717, pvalue=0.0, statistic_location=0.0035882872, statistic_sign=1),
                                80000: KstestResult(statistic=0.40013750000000003, pvalue=0.0, statistic_location=0.0037508793, statistic_sign=1),
                                90000: KstestResult(statistic=0.4001888888888889, pvalue=0.0, statistic_location=0.0035640933, statistic_sign=1),
                                100000: KstestResult(statistic=0.39778, pvalue=0.0, statistic_location=0.0036035536, statistic_sign=1),
                                110000: KstestResult(statistic=0.40334545454545456, pvalue=0.0, statistic_location=0.0035958653, statistic_sign=1)},
                   'moments': {'mean_error': -0.09106636,
                               'means': [-0.00073593855, -2.2411059e-05],
                               'stds': [0.022726193, 0.0022897767],
                               'variance_ratio': 67.564316}},
 'originals': {'gan': {'mae': 0.05885758250951767,
                       'mse': 0.005448393989354372,
                       'psnr': 27.10418128967285,
                       'rmse': 0.07381323724985123,
                       'ssim': 0.603545069694519},
               'pca': {'mae': 0.004943228326737881,
                       'mse': 7.432144047925249e-05,
                       'psnr': 46.341026306152344,
                       'rmse': 0.008620988577604294,
                       'ssim': 0.999373197555542}},
 'reconstructions': {'mae': 0.058487165719270706,
                     'mse': 0.005368425976485014,
                     'psnr': 27.75369644165039,
                     'rmse': 0.0732695460319519,
                     'ssim': 0.6014336347579956},
 'residual_spectra_pcagan': {'cosine': [0.23694538,
                                        0.17725912,
                                        0.13213363,
                                        0.08188883,
                                        0.042872995,
                                        0.037528727,
                                        0.012296843,
                                        0.04232953,
                                        0.040027857,
                                        0.048154976,
                                        0.061807588],
                             'mae': [0.015073839,
                                     0.017324097,
                                     0.017428074,
                                     0.016657354,
                                     0.015517364,
                                     0.015470981,
                                     0.014057508,
                                     0.01875832,
                                     0.020491924,
                                     0.019352702,
                                     0.017421275],
                             'max_mae': 0.020491924,
                             'max_mse': 0.000659773,
                             'max_rmse': 0.025686046,
                             'median_distance': 2.2618206,
                             'median_mae': 0.017324097,
                             'min_cosine': 0.012296843,
                             'mse': [0.00039288434,
                                     0.000625824,
                                     0.00052755105,
                                     0.00044432725,
                                     0.0005115831,
                                     0.00040879747,
                                     0.00038946222,
                                     0.00056511426,
                                     0.000659773,
                                     0.00059418747,
                                     0.0005053742],
                             'rmse': [0.01982131,
                                      0.025016474,
                                      0.02296848,
                                      0.02107907,
                                      0.022618202,
                                      0.020218741,
                                      0.019734798,
                                      0.023772132,
                                      0.025686046,
                                      0.02437596,
                                      0.02248053]},
 'residuals': {'mae': 0.017050310969352722,
               'mse': 0.0005113526131026447,
               'psnr': 4.315229892730713,
               'rmse': 0.022613106295466423,
               'ssds': [56.87184, 0.57678854],
               'ssim': 0.10754862427711487},
 'spectra_pcagan': {'cosine': [0.99098146,
                               0.9838204,
                               0.9591711,
                               0.9486185,
                               0.9523799,
                               0.96988755,
                               0.97267836,
                               0.93662626,
                               0.91309404,
                               0.91421264,
                               0.92254394],
                    'mae': [0.07177667,
                            0.073067784,
                            0.06328266,
                            0.06627879,
                            0.04648378,
                            0.0442683,
                            0.041030418,
                            0.055889674,
                            0.063617945,
                            0.060919598,
                            0.05674325],
                    'max_mae': 0.073067784,
                    'max_mse': 0.008126839,
                    'max_rmse': 0.090148985,
                    'median_mae': 0.060919598,
                    'min_cosine': 0.91309404,
                    'mse': [0.0076401415,
                            0.008126839,
                            0.005888208,
                            0.0067872116,
                            0.0033418473,
                            0.0030088741,
                            0.0027169646,
                            0.004669584,
                            0.006182754,
                            0.0055778776,
                            0.005112385],
                    'rmse': [0.0874079,
                             0.090148985,
                             0.07673466,
                             0.082384534,
                             0.057808712,
                             0.054853205,
                             0.05212451,
                             0.068334356,
                             0.07863049,
                             0.07468519,
                             0.07150094]},
 'spectra_realgan': {'cosine': [0.99050224,
                                0.98320454,
                                0.958425,
                                0.9485156,
                                0.95228004,
                                0.96986884,
                                0.97265184,
                                0.9365318,
                                0.912984,
                                0.91408354,
                                0.92231876],
                     'mae': [0.073525995,
                             0.07423982,
                             0.06392931,
                             0.066407725,
                             0.046533234,
                             0.044256676,
                             0.041072655,
                             0.05594315,
                             0.06368616,
                             0.06099438,
                             0.056844275],
                     'max_mae': 0.07423982,
                     'max_mse': 0.00842498,
                     'max_rmse': 0.09178769,
                     'median_mae': 0.06099438,
                     'min_cosine': 0.912984,
                     'mse': [0.008046477,
                             0.00842498,
                             0.0059988564,
                             0.0067990287,
                             0.0033501007,
                             0.0030101966,
                             0.0027172633,
                             0.004679983,
                             0.006192801,
                             0.005587246,
                             0.0051254076],
                     'rmse': [0.08970216,
                              0.09178769,
                              0.07745229,
                              0.08245622,
                              0.057880055,
                              0.05486526,
                              0.052127376,
                              0.068410404,
                              0.07869435,
                              0.07474788,
                              0.07159195]},
 'spectra_realpca': {'cosine': [0.99957865,
                                0.99944264,
                                0.9992658,
                                0.9997907,
                                0.9999131,
                                0.9999576,
                                0.9999506,
                                0.999933,
                                0.9999495,
                                0.9998259,
                                0.9998095],
                     'mae': [0.014885835,
                             0.013203666,
                             0.008225326,
                             0.0039019245,
                             0.0019423611,
                             0.0016439819,
                             0.0016981097,
                             0.0017835,
                             0.0015279603,
                             0.0027078488,
                             0.0028549912],
                     'max_mae': 0.014885835,
                     'max_mse': 0.00035574764,
                     'max_rmse': 0.018861273,
                     'median_mae': 0.0027078488,
                     'min_cosine': 0.9992658,
                     'mse': [0.00035574764,
                             0.0002814916,
                             0.00010750563,
                             2.4264064e-05,
                             6.0005755e-06,
                             4.2728902e-06,
                             4.6084397e-06,
                             5.094173e-06,
                             3.7497778e-06,
                             1.1786008e-05,
                             1.3015025e-05],
                     'rmse': [0.018861273,
                              0.016777711,
                              0.010368492,
                              0.004925857,
                              0.0024496072,
                              0.002067097,
                              0.0021467276,
                              0.0022570274,
                              0.0019364343,
                              0.0034330755,
                              0.0036076342]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_95.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115
Directory path: experiments/inpainting/gann_4_night_20180722_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_95.0/images
Optimal number of principal components:  37
Reconstruction error:  4.8338265
Energy conservation:  0.9522806
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_95.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.22363691969865, 2.1958707515040135],
                   'kl_div': 1.4799511,
                   'ks_tests': {10000: KstestResult(statistic=0.3717, pvalue=0.0, statistic_location=0.0039916364, statistic_sign=1),
                                20000: KstestResult(statistic=0.3602000000000001, pvalue=0.0, statistic_location=0.0035201674, statistic_sign=1),
                                30000: KstestResult(statistic=0.36293333333333333, pvalue=0.0, statistic_location=0.0036370442, statistic_sign=1),
                                40000: KstestResult(statistic=0.36505, pvalue=0.0, statistic_location=0.0035269726, statistic_sign=1),
                                50000: KstestResult(statistic=0.36338000000000004, pvalue=0.0, statistic_location=0.0038452647, statistic_sign=1),
                                60000: KstestResult(statistic=0.36296666666666666, pvalue=0.0, statistic_location=0.0035965145, statistic_sign=1),
                                70000: KstestResult(statistic=0.36408571428571435, pvalue=0.0, statistic_location=0.0035888394, statistic_sign=1),
                                80000: KstestResult(statistic=0.3622375, pvalue=0.0, statistic_location=0.0034729564, statistic_sign=1),
                                90000: KstestResult(statistic=0.3616555555555555, pvalue=0.0, statistic_location=0.003646967, statistic_sign=1),
                                100000: KstestResult(statistic=0.36258, pvalue=0.0, statistic_location=0.0034131203, statistic_sign=1),
                                110000: KstestResult(statistic=0.3648, pvalue=0.0, statistic_location=0.0037256423, statistic_sign=1),
                                120000: KstestResult(statistic=0.3636250000000001, pvalue=0.0, statistic_location=0.0033671018, statistic_sign=1),
                                130000: KstestResult(statistic=0.36454615384615385, pvalue=0.0, statistic_location=0.0034493923, statistic_sign=1),
                                140000: KstestResult(statistic=0.36283571428571426, pvalue=0.0, statistic_location=0.0036436936, statistic_sign=1),
                                150000: KstestResult(statistic=0.36293333333333333, pvalue=0.0, statistic_location=0.0034139708, statistic_sign=1),
                                160000: KstestResult(statistic=0.36593125000000004, pvalue=0.0, statistic_location=0.0034146197, statistic_sign=1),
                                170000: KstestResult(statistic=0.3623705882352941, pvalue=0.0, statistic_location=0.0037447703, statistic_sign=1),
                                180000: KstestResult(statistic=0.36578888888888883, pvalue=0.0, statistic_location=0.0037255343, statistic_sign=1),
                                190000: KstestResult(statistic=0.3615631578947368, pvalue=0.0, statistic_location=0.003487119, statistic_sign=1),
                                200000: KstestResult(statistic=0.36424, pvalue=0.0, statistic_location=0.0034122756, statistic_sign=1),
                                210000: KstestResult(statistic=0.36333809523809524, pvalue=0.0, statistic_location=0.0034150712, statistic_sign=1),
                                220000: KstestResult(statistic=0.36257272727272727, pvalue=0.0, statistic_location=0.0035970467, statistic_sign=1)},
                   'moments': {'mean_error': -0.038265843,
                               'means': [-0.00054423965, -3.569841e-06],
                               'stds': [0.019667108, 0.0025683364],
                               'variance_ratio': 45.52709}},
 'originals': {'gan': {'mae': 0.05455929413437843,
                       'mse': 0.004739472642540932,
                       'psnr': 27.725784301757812,
                       'rmse': 0.06884382665157318,
                       'ssim': 0.6566916704177856},
               'pca': {'mae': 0.00563858961686492,
                       'mse': 8.680780592840165e-05,
                       'psnr': 45.66657638549805,
                       'rmse': 0.009317070245742798,
                       'ssim': 0.9984033703804016}},
 'reconstructions': {'mae': 0.05405720695853233,
                     'mse': 0.0046508111990988255,
                     'psnr': 28.37687873840332,
                     'rmse': 0.0681968554854393,
                     'ssim': 0.6556333303451538},
 'residual_spectra_pcagan': {'cosine': [0.24774106,
                                        0.24145189,
                                        0.22044173,
                                        0.11320481,
                                        0.21909486,
                                        0.25997594,
                                        0.19446532,
                                        0.15111388,
                                        0.09258862,
                                        0.046939306,
                                        0.04408435,
                                        0.012931086,
                                        0.046901554,
                                        0.04250779,
                                        0.053233877,
                                        0.07062725,
                                        0.028920677,
                                        0.05837612,
                                        0.09021428,
                                        0.0700478,
                                        0.050445706,
                                        0.067777716],
                             'mae': [0.010742029,
                                     0.01089389,
                                     0.010408298,
                                     0.011132672,
                                     0.012926979,
                                     0.013033826,
                                     0.015394034,
                                     0.015286493,
                                     0.014508406,
                                     0.013739187,
                                     0.013774303,
                                     0.012710572,
                                     0.016672894,
                                     0.018384863,
                                     0.01707398,
                                     0.015821317,
                                     0.01649562,
                                     0.014470129,
                                     0.014503598,
                                     0.01327908,
                                     0.016920947,
                                     0.013623862],
                             'max_mae': 0.018384863,
                             'max_mse': 0.00053540576,
                             'max_rmse': 0.023138836,
                             'median_distance': 1.8782227,
                             'median_mae': 0.014122216,
                             'min_cosine': 0.012931086,
                             'mse': [0.00026447396,
                                     0.00030749058,
                                     0.00030898314,
                                     0.00026352427,
                                     0.00033259325,
                                     0.00030940544,
                                     0.0005126157,
                                     0.00041449696,
                                     0.00034879777,
                                     0.0004209587,
                                     0.00032836833,
                                     0.0003274369,
                                     0.00046373557,
                                     0.00053540576,
                                     0.0004739675,
                                     0.0004294626,
                                     0.00044295684,
                                     0.00038421442,
                                     0.0003504982,
                                     0.000324958,
                                     0.00047446147,
                                     0.0003550533],
                             'rmse': [0.016262656,
                                      0.017535409,
                                      0.017577916,
                                      0.016233431,
                                      0.01823714,
                                      0.017589925,
                                      0.022641018,
                                      0.020359198,
                                      0.018676128,
                                      0.020517278,
                                      0.018120937,
                                      0.018095218,
                                      0.021534521,
                                      0.023138836,
                                      0.021770794,
                                      0.020723479,
                                      0.02104654,
                                      0.019601388,
                                      0.018721597,
                                      0.018026592,
                                      0.021782136,
                                      0.018842857]},
 'residuals': {'mae': 0.014172589406371117,
               'mse': 0.0003806299646385014,
               'psnr': 6.3217902183532715,
               'rmse': 0.01950974017381668,
               'ssds': [85.1597, 1.4511936],
               'ssim': 0.14658378064632416},
 'spectra_pcagan': {'cosine': [0.990275,
                               0.99053943,
                               0.98557,
                               0.9794122,
                               0.984686,
                               0.991155,
                               0.9842202,
                               0.9601531,
                               0.9501039,
                               0.9532234,
                               0.9706526,
                               0.9733535,
                               0.9383668,
                               0.91414773,
                               0.91543555,
                               0.9223858,
                               0.90108806,
                               0.9586466,
                               0.943132,
                               0.96096057,
                               0.92527276,
                               0.95253474],
                    'mae': [0.04933127,
                            0.04874347,
                            0.042983685,
                            0.04092498,
                            0.05718517,
                            0.07095522,
                            0.0719575,
                            0.062533855,
                            0.06498315,
                            0.04598501,
                            0.04383629,
                            0.040559087,
                            0.0550037,
                            0.06324789,
                            0.060342774,
                            0.056774817,
                            0.063412525,
                            0.046321906,
                            0.053537816,
                            0.043609742,
                            0.059561804,
                            0.047466986],
                    'max_mae': 0.0719575,
                    'max_mse': 0.007941706,
                    'max_rmse': 0.08911625,
                    'median_mae': 0.05427076,
                    'min_cosine': 0.90108806,
                    'mse': [0.003977017,
                            0.00407971,
                            0.0030597965,
                            0.0026602556,
                            0.0048380545,
                            0.00748002,
                            0.007941706,
                            0.0057618124,
                            0.0065456186,
                            0.0033069912,
                            0.002942871,
                            0.0026844027,
                            0.0045415945,
                            0.0061191088,
                            0.0055038515,
                            0.0051263627,
                            0.0063560447,
                            0.0033106008,
                            0.0042212256,
                            0.003062192,
                            0.005411502,
                            0.0033871015],
                    'rmse': [0.06306359,
                             0.06387261,
                             0.055315427,
                             0.051577665,
                             0.069556125,
                             0.08648711,
                             0.08911625,
                             0.075906605,
                             0.080905,
                             0.057506446,
                             0.054248236,
                             0.051811222,
                             0.06739135,
                             0.07822473,
                             0.07418795,
                             0.07159862,
                             0.0797248,
                             0.05753782,
                             0.06497096,
                             0.055337075,
                             0.07356291,
                             0.05819881]},
 'spectra_realgan': {'cosine': [0.9896691,
                                0.9898579,
                                0.98456603,
                                0.9791487,
                                0.983875,
                                0.9906742,
                                0.9836056,
                                0.95940924,
                                0.950004,
                                0.9531188,
                                0.9706316,
                                0.9733282,
                                0.93827266,
                                0.91403544,
                                0.91530865,
                                0.92216086,
                                0.9011053,
                                0.9585088,
                                0.94279194,
                                0.9608301,
                                0.92520034,
                                0.95235986],
                     'mae': [0.05091956,
                             0.05065085,
                             0.044404034,
                             0.041118804,
                             0.058669947,
                             0.07273627,
                             0.07316233,
                             0.063168325,
                             0.06512662,
                             0.046040375,
                             0.04382759,
                             0.040590435,
                             0.05506352,
                             0.06331624,
                             0.060418434,
                             0.056880366,
                             0.06340985,
                             0.046374947,
                             0.05363102,
                             0.043673262,
                             0.059573457,
                             0.04754814],
                     'max_mae': 0.07316233,
                     'max_mse': 0.008238449,
                     'max_rmse': 0.0907659,
                     'median_mae': 0.05434727,
                     'min_cosine': 0.9011053,
                     'mse': [0.0042169,
                             0.00437998,
                             0.003240988,
                             0.0026799885,
                             0.0051155905,
                             0.007887149,
                             0.008238449,
                             0.005872001,
                             0.006557111,
                             0.0033155568,
                             0.0029443847,
                             0.0026845408,
                             0.004551976,
                             0.006129314,
                             0.005513082,
                             0.0051394324,
                             0.0063526644,
                             0.0033178928,
                             0.004240858,
                             0.0030703791,
                             0.005419961,
                             0.0034001968],
                     'rmse': [0.064937666,
                              0.066181414,
                              0.056929674,
                              0.051768605,
                              0.07152335,
                              0.088809624,
                              0.0907659,
                              0.07662898,
                              0.080975994,
                              0.057580873,
                              0.054262184,
                              0.051812556,
                              0.06746833,
                              0.07828993,
                              0.07425013,
                              0.07168984,
                              0.07970361,
                              0.057601154,
                              0.06512187,
                              0.055411004,
                              0.07362039,
                              0.058311205]},
 'spectra_realpca': {'cosine': [0.99934405,
                                0.99933875,
                                0.9989954,
                                0.9996814,
                                0.99917746,
                                0.99957865,
                                0.99944264,
                                0.9992658,
                                0.9997907,
                                0.9999131,
                                0.9999576,
                                0.9999506,
                                0.999933,
                                0.9999495,
                                0.9998259,
                                0.9998095,
                                0.99981105,
                                0.99989104,
                                0.9997568,
                                0.99991703,
                                0.99991995,
                                0.99981546],
                     'mae': [0.012800893,
                             0.01337615,
                             0.010668419,
                             0.00471799,
                             0.012869651,
                             0.014885835,
                             0.013203666,
                             0.008225326,
                             0.0039019245,
                             0.0019423611,
                             0.0016439819,
                             0.0016981097,
                             0.0017835,
                             0.0015279603,
                             0.0027078488,
                             0.0028549912,
                             0.0028215088,
                             0.0023384881,
                             0.0033856663,
                             0.0019738257,
                             0.0019169523,
                             0.0028038998],
                     'max_mae': 0.014885835,
                     'max_mse': 0.00035574764,
                     'max_rmse': 0.018861273,
                     'median_mae': 0.00283825,
                     'min_cosine': 0.9989954,
                     'mse': [0.00026013338,
                             0.00028659633,
                             0.00018207461,
                             3.5337816e-05,
                             0.00026326836,
                             0.00035574764,
                             0.0002814916,
                             0.00010750563,
                             2.4264064e-05,
                             6.0005755e-06,
                             4.2728902e-06,
                             4.6084397e-06,
                             5.094173e-06,
                             3.7497778e-06,
                             1.1786008e-05,
                             1.3015025e-05,
                             1.2745999e-05,
                             8.7843e-06,
                             1.8427592e-05,
                             6.214016e-06,
                             5.9502213e-06,
                             1.2703217e-05],
                     'rmse': [0.016128652,
                              0.016929157,
                              0.0134935025,
                              0.005944562,
                              0.016225547,
                              0.018861273,
                              0.016777711,
                              0.010368492,
                              0.004925857,
                              0.0024496072,
                              0.002067097,
                              0.0021467276,
                              0.0022570274,
                              0.0019364343,
                              0.0034330755,
                              0.0036076342,
                              0.0035701538,
                              0.0029638319,
                              0.004292737,
                              0.002492793,
                              0.0024393075,
                              0.0035641573]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_95.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453
Directory path: experiments/inpainting/gann_4_night_20180722_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_95.0/images
Optimal number of principal components:  37
Reconstruction error:  4.8338265
Energy conservation:  0.9522806
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_95.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.111089078084709, 2.402641645973186],
                   'kl_div': 1.1210693,
                   'ks_tests': {10000: KstestResult(statistic=0.3184, pvalue=1e-323, statistic_location=0.0038815988, statistic_sign=1),
                                20000: KstestResult(statistic=0.31195000000000006, pvalue=0.0, statistic_location=0.0039672777, statistic_sign=1),
                                30000: KstestResult(statistic=0.31366666666666665, pvalue=0.0, statistic_location=0.004363156, statistic_sign=1),
                                40000: KstestResult(statistic=0.3117000000000001, pvalue=0.0, statistic_location=0.004175699, statistic_sign=1),
                                50000: KstestResult(statistic=0.3146, pvalue=0.0, statistic_location=0.004148202, statistic_sign=1),
                                60000: KstestResult(statistic=0.31235, pvalue=0.0, statistic_location=0.004312317, statistic_sign=1),
                                70000: KstestResult(statistic=0.3122285714285714, pvalue=0.0, statistic_location=0.004299321, statistic_sign=1),
                                80000: KstestResult(statistic=0.31313750000000007, pvalue=0.0, statistic_location=0.0043316493, statistic_sign=1),
                                90000: KstestResult(statistic=0.31520000000000004, pvalue=0.0, statistic_location=0.004232454, statistic_sign=1),
                                100000: KstestResult(statistic=0.31177, pvalue=0.0, statistic_location=0.0041099554, statistic_sign=1),
                                110000: KstestResult(statistic=0.31203636363636367, pvalue=0.0, statistic_location=0.0043298407, statistic_sign=1),
                                120000: KstestResult(statistic=0.3129416666666667, pvalue=0.0, statistic_location=0.0043122387, statistic_sign=1),
                                130000: KstestResult(statistic=0.3116461538461539, pvalue=0.0, statistic_location=0.0042326692, statistic_sign=1),
                                140000: KstestResult(statistic=0.3107714285714286, pvalue=0.0, statistic_location=0.0043219263, statistic_sign=1),
                                150000: KstestResult(statistic=0.3126266666666667, pvalue=0.0, statistic_location=0.0040179407, statistic_sign=1),
                                160000: KstestResult(statistic=0.31163125, pvalue=0.0, statistic_location=0.0043148925, statistic_sign=1),
                                170000: KstestResult(statistic=0.31289999999999996, pvalue=0.0, statistic_location=0.004315637, statistic_sign=1),
                                180000: KstestResult(statistic=0.3120166666666667, pvalue=0.0, statistic_location=0.0043121176, statistic_sign=1),
                                190000: KstestResult(statistic=0.3133789473684211, pvalue=0.0, statistic_location=0.004309751, statistic_sign=1),
                                200000: KstestResult(statistic=0.31110499999999996, pvalue=0.0, statistic_location=0.0042499686, statistic_sign=1),
                                210000: KstestResult(statistic=0.3118857142857143, pvalue=0.0, statistic_location=0.0042278795, statistic_sign=1),
                                220000: KstestResult(statistic=0.3122136363636364, pvalue=0.0, statistic_location=0.0043087164, statistic_sign=1),
                                230000: KstestResult(statistic=0.3121956521739131, pvalue=0.0, statistic_location=0.0043637715, statistic_sign=1),
                                240000: KstestResult(statistic=0.31262500000000004, pvalue=0.0, statistic_location=0.0043121735, statistic_sign=1),
                                250000: KstestResult(statistic=0.31256000000000006, pvalue=0.0, statistic_location=0.004291269, statistic_sign=1),
                                260000: KstestResult(statistic=0.31414230769230767, pvalue=0.0, statistic_location=0.0042245197, statistic_sign=1),
                                270000: KstestResult(statistic=0.3112111111111111, pvalue=0.0, statistic_location=0.004235603, statistic_sign=1),
                                280000: KstestResult(statistic=0.3121178571428571, pvalue=0.0, statistic_location=0.0043298537, statistic_sign=1),
                                290000: KstestResult(statistic=0.3111206896551725, pvalue=0.0, statistic_location=0.0043122387, statistic_sign=1),
                                300000: KstestResult(statistic=0.31234666666666666, pvalue=0.0, statistic_location=0.0042279507, statistic_sign=1),
                                310000: KstestResult(statistic=0.3120516129032258, pvalue=0.0, statistic_location=0.004175907, statistic_sign=1),
                                320000: KstestResult(statistic=0.31174999999999997, pvalue=0.0, statistic_location=0.004363397, statistic_sign=1),
                                330000: KstestResult(statistic=0.3131484848484849, pvalue=0.0, statistic_location=0.0042926515, statistic_sign=1)},
                   'moments': {'mean_error': -0.03692998,
                               'means': [-0.00039863147, 2.6223674e-06],
                               'stds': [0.017679268, 0.0030061472],
                               'variance_ratio': 29.719307}},
 'originals': {'gan': {'mae': 0.05171003192663193,
                       'mse': 0.004362098407000303,
                       'psnr': 28.81952667236328,
                       'rmse': 0.06604618579149246,
                       'ssim': 0.7228677272796631},
               'pca': {'mae': 0.007197315338999033,
                       'mse': 0.00012568301463034004,
                       'psnr': 44.49100875854492,
                       'rmse': 0.011210843920707703,
                       'ssim': 0.9974056482315063}},
 'reconstructions': {'mae': 0.05090174451470375,
                     'mse': 0.004234011285007,
                     'psnr': 29.21625328063965,
                     'rmse': 0.065069280564785,
                     'ssim': 0.7231947779655457},
 'residual_spectra_pcagan': {'cosine': [0.02828343,
                                        0.22005908,
                                        0.32553318,
                                        0.26202574,
                                        0.302864,
                                        0.2604218,
                                        0.25878093,
                                        0.2519917,
                                        0.24963073,
                                        0.117181495,
                                        0.22442894,
                                        0.27368847,
                                        0.2099619,
                                        0.16641645,
                                        0.09759083,
                                        0.048409913,
                                        0.047273625,
                                        0.018486392,
                                        0.044798817,
                                        0.0434252,
                                        0.05754538,
                                        0.07792479,
                                        0.03351252,
                                        0.063187264,
                                        0.095189594,
                                        0.07378297,
                                        0.05037448,
                                        0.06977939,
                                        0.14690723,
                                        0.14639202,
                                        0.21784958,
                                        0.2389093,
                                        0.22625151],
                             'mae': [0.011728,
                                     0.011586673,
                                     0.009145042,
                                     0.009568782,
                                     0.009250402,
                                     0.010515944,
                                     0.01018007,
                                     0.010494221,
                                     0.009772366,
                                     0.010876282,
                                     0.012383724,
                                     0.012113208,
                                     0.014389551,
                                     0.014292715,
                                     0.013397307,
                                     0.012826312,
                                     0.012750061,
                                     0.012095803,
                                     0.015606093,
                                     0.01716211,
                                     0.015762262,
                                     0.014883347,
                                     0.015235052,
                                     0.013531611,
                                     0.013484673,
                                     0.012243096,
                                     0.015653718,
                                     0.012899521,
                                     0.009982411,
                                     0.010323535,
                                     0.009727618,
                                     0.009953558,
                                     0.011376792],
                             'max_mae': 0.01716211,
                             'max_mse': 0.00046944356,
                             'max_rmse': 0.021666646,
                             'median_distance': 1.7387098,
                             'median_mae': 0.012113208,
                             'min_cosine': 0.018486392,
                             'mse': [0.00024829392,
                                     0.0003179223,
                                     0.0001894166,
                                     0.00024412463,
                                     0.00018999347,
                                     0.00030231118,
                                     0.0002469323,
                                     0.00028714596,
                                     0.00024829077,
                                     0.00023776502,
                                     0.00032334836,
                                     0.00026868298,
                                     0.00044527784,
                                     0.00036082903,
                                     0.0003043481,
                                     0.00035813742,
                                     0.00028186812,
                                     0.00028467528,
                                     0.00041796025,
                                     0.00046944356,
                                     0.00040355057,
                                     0.00039508496,
                                     0.00038531344,
                                     0.00033663327,
                                     0.00030567005,
                                     0.0002731104,
                                     0.00040647364,
                                     0.00031536675,
                                     0.00020854377,
                                     0.00020761402,
                                     0.00022087671,
                                     0.00023535485,
                                     0.00030675725],
                             'rmse': [0.015757345,
                                      0.017830376,
                                      0.013762871,
                                      0.015624488,
                                      0.013783812,
                                      0.017387098,
                                      0.01571408,
                                      0.01694538,
                                      0.015757246,
                                      0.015419631,
                                      0.01798189,
                                      0.016391553,
                                      0.021101607,
                                      0.018995501,
                                      0.017445575,
                                      0.01892452,
                                      0.016788928,
                                      0.016872322,
                                      0.020444077,
                                      0.021666646,
                                      0.020088568,
                                      0.019876745,
                                      0.019629402,
                                      0.018347569,
                                      0.017483423,
                                      0.016526053,
                                      0.020161191,
                                      0.017758569,
                                      0.014441045,
                                      0.0144088175,
                                      0.014861922,
                                      0.015341279,
                                      0.017514488]},
 'residuals': {'mae': 0.012278540059924126,
               'mse': 0.00030385199352167547,
               'psnr': 7.305713653564453,
               'rmse': 0.01743135042488575,
               'ssds': [103.19576, 2.9821773],
               'ssim': 0.18980029225349426},
 'spectra_pcagan': {'cosine': [0.99595267,
                               0.9941056,
                               0.99558187,
                               0.9946417,
                               0.99584913,
                               0.9941942,
                               0.9902916,
                               0.99027723,
                               0.9850756,
                               0.9783039,
                               0.98418444,
                               0.9908727,
                               0.98388565,
                               0.95951366,
                               0.95075345,
                               0.9532645,
                               0.97103906,
                               0.9734789,
                               0.9383751,
                               0.91563016,
                               0.9161278,
                               0.92329353,
                               0.90215594,
                               0.9593935,
                               0.9443067,
                               0.9617008,
                               0.92624235,
                               0.95242286,
                               0.97186345,
                               0.9745246,
                               0.98637193,
                               0.9868757,
                               0.98906183],
                    'mae': [0.03017242,
                            0.041917685,
                            0.049474016,
                            0.049742017,
                            0.056418676,
                            0.061772045,
                            0.04939355,
                            0.04945931,
                            0.043872606,
                            0.042144954,
                            0.05797921,
                            0.07184599,
                            0.07261109,
                            0.063081004,
                            0.06425256,
                            0.045971323,
                            0.0434692,
                            0.040746,
                            0.05493752,
                            0.06272392,
                            0.0601882,
                            0.056277983,
                            0.06299821,
                            0.046015967,
                            0.05310224,
                            0.043420527,
                            0.05919323,
                            0.04769603,
                            0.040748373,
                            0.037213977,
                            0.037980523,
                            0.04056701,
                            0.042370263],
                    'max_mae': 0.07261109,
                    'max_mse': 0.008112739,
                    'max_rmse': 0.09007075,
                    'median_mae': 0.04945931,
                    'min_cosine': 0.90215594,
                    'mse': [0.0013951187,
                            0.0031467627,
                            0.0039391974,
                            0.004037943,
                            0.004774873,
                            0.006204726,
                            0.003956614,
                            0.004190457,
                            0.0031355887,
                            0.002791936,
                            0.0049952464,
                            0.007715625,
                            0.008112739,
                            0.0058607697,
                            0.0064124917,
                            0.003318994,
                            0.0029085223,
                            0.0027024017,
                            0.0045389174,
                            0.0060269157,
                            0.0054758596,
                            0.005054656,
                            0.0063030627,
                            0.0032854374,
                            0.0041558295,
                            0.0030425726,
                            0.005365538,
                            0.003422091,
                            0.0027420402,
                            0.0022530071,
                            0.0024557286,
                            0.0027126155,
                            0.0032881198],
                    'rmse': [0.037351288,
                             0.056096014,
                             0.06276303,
                             0.06354481,
                             0.069100454,
                             0.078770086,
                             0.06290162,
                             0.064733736,
                             0.05599633,
                             0.052838773,
                             0.07067706,
                             0.087838635,
                             0.09007075,
                             0.07655566,
                             0.080078036,
                             0.057610713,
                             0.05393072,
                             0.05198463,
                             0.06737149,
                             0.07763321,
                             0.073999055,
                             0.0710961,
                             0.07939183,
                             0.057318736,
                             0.064465724,
                             0.05515952,
                             0.07324983,
                             0.05849864,
                             0.052364495,
                             0.047465853,
                             0.04955531,
                             0.052082777,
                             0.05734213]},
 'spectra_realgan': {'cosine': [0.99594945,
                                0.993599,
                                0.9950832,
                                0.9941495,
                                0.9954565,
                                0.99380606,
                                0.9896941,
                                0.98959345,
                                0.9840586,
                                0.9780391,
                                0.98338234,
                                0.99038804,
                                0.983271,
                                0.9587497,
                                0.95064867,
                                0.95316404,
                                0.97102016,
                                0.97345513,
                                0.93828213,
                                0.9155233,
                                0.9159966,
                                0.92306614,
                                0.90216774,
                                0.95925295,
                                0.9439704,
                                0.96156967,
                                0.92616457,
                                0.95225024,
                                0.9714461,
                                0.9741205,
                                0.98563623,
                                0.98602635,
                                0.98827475],
                     'mae': [0.030195968,
                             0.04384645,
                             0.05171915,
                             0.051315956,
                             0.0585284,
                             0.064356156,
                             0.05100211,
                             0.051354375,
                             0.045245912,
                             0.04232188,
                             0.059441272,
                             0.07366079,
                             0.073836826,
                             0.063720815,
                             0.06439157,
                             0.04602444,
                             0.04345906,
                             0.040787138,
                             0.05499627,
                             0.062789485,
                             0.06026786,
                             0.056387287,
                             0.0629972,
                             0.04607277,
                             0.05318295,
                             0.04348565,
                             0.059214,
                             0.047780782,
                             0.041187927,
                             0.037686408,
                             0.039182164,
                             0.041614648,
                             0.04437734],
                     'max_mae': 0.073836826,
                     'max_mse': 0.008408905,
                     'max_rmse': 0.091700085,
                     'median_mae': 0.051315956,
                     'min_cosine': 0.90216774,
                     'mse': [0.0013965998,
                             0.0033654594,
                             0.0043091304,
                             0.0043066847,
                             0.0051687118,
                             0.00663488,
                             0.004193502,
                             0.0044916635,
                             0.0033190364,
                             0.002811561,
                             0.005270784,
                             0.008125987,
                             0.008408905,
                             0.005973664,
                             0.0064246827,
                             0.0033273175,
                             0.0029098277,
                             0.0027023253,
                             0.0045493,
                             0.0060367663,
                             0.005485335,
                             0.0050676977,
                             0.006299948,
                             0.0032926055,
                             0.0041749026,
                             0.0030507362,
                             0.0053743967,
                             0.0034350727,
                             0.0027860254,
                             0.0022955164,
                             0.0025833887,
                             0.0028579237,
                             0.0035189064],
                     'rmse': [0.03737111,
                              0.05801258,
                              0.065643966,
                              0.06562533,
                              0.07189375,
                              0.08145477,
                              0.06475726,
                              0.06701987,
                              0.057611078,
                              0.053024154,
                              0.07260016,
                              0.090144254,
                              0.091700085,
                              0.077289484,
                              0.08015412,
                              0.057682905,
                              0.05394282,
                              0.051983897,
                              0.0674485,
                              0.07769663,
                              0.07406305,
                              0.071187764,
                              0.07937221,
                              0.05738123,
                              0.064613484,
                              0.05523347,
                              0.07331028,
                              0.058609493,
                              0.052782815,
                              0.047911547,
                              0.05082705,
                              0.05345955,
                              0.05932037]},
 'spectra_realpca': {'cosine': [0.99999785,
                                0.9994284,
                                0.9995055,
                                0.99949414,
                                0.99957407,
                                0.99959934,
                                0.99934405,
                                0.99933875,
                                0.9989954,
                                0.9996814,
                                0.99917746,
                                0.99957865,
                                0.99944264,
                                0.9992658,
                                0.9997907,
                                0.9999131,
                                0.9999576,
                                0.9999506,
                                0.999933,
                                0.9999495,
                                0.9998259,
                                0.9998095,
                                0.99981105,
                                0.99989104,
                                0.9997568,
                                0.99991703,
                                0.99991995,
                                0.99981546,
                                0.99958926,
                                0.99945056,
                                0.9990409,
                                0.9992313,
                                0.9992519],
                     'mae': [0.00068178336,
                             0.012717282,
                             0.014687039,
                             0.013843909,
                             0.0151233,
                             0.015047654,
                             0.012800893,
                             0.01337615,
                             0.010668419,
                             0.00471799,
                             0.012869651,
                             0.014885835,
                             0.013203666,
                             0.008225326,
                             0.0039019245,
                             0.0019423611,
                             0.0016439819,
                             0.0016981097,
                             0.0017835,
                             0.0015279603,
                             0.0027078488,
                             0.0028549912,
                             0.0028215088,
                             0.0023384881,
                             0.0033856663,
                             0.0019738257,
                             0.0019169523,
                             0.0028038998,
                             0.0049925074,
                             0.0055027395,
                             0.010009634,
                             0.009337839,
                             0.011518759],
                     'max_mae': 0.0151233,
                     'max_mse': 0.00036481663,
                     'max_rmse': 0.019100174,
                     'median_mae': 0.0049925074,
                     'min_cosine': 0.9989954,
                     'mse': [7.3874855e-07,
                             0.00026095967,
                             0.00034536168,
                             0.00030649602,
                             0.00036481663,
                             0.00035961007,
                             0.00026013338,
                             0.00028659633,
                             0.00018207461,
                             3.5337816e-05,
                             0.00026326836,
                             0.00035574764,
                             0.0002814916,
                             0.00010750563,
                             2.4264064e-05,
                             6.0005755e-06,
                             4.2728902e-06,
                             4.6084397e-06,
                             5.094173e-06,
                             3.7497778e-06,
                             1.1786008e-05,
                             1.3015025e-05,
                             1.2745999e-05,
                             8.7843e-06,
                             1.8427592e-05,
                             6.214016e-06,
                             5.9502213e-06,
                             1.2703217e-05,
                             4.010783e-05,
                             4.8652226e-05,
                             0.00015929708,
                             0.00013945997,
                             0.00021226768],
                     'rmse': [0.00085950486,
                              0.016154246,
                              0.018583909,
                              0.017507028,
                              0.019100174,
                              0.018963387,
                              0.016128652,
                              0.016929157,
                              0.0134935025,
                              0.005944562,
                              0.016225547,
                              0.018861273,
                              0.016777711,
                              0.010368492,
                              0.004925857,
                              0.0024496072,
                              0.002067097,
                              0.0021467276,
                              0.0022570274,
                              0.0019364343,
                              0.0034330755,
                              0.0036076342,
                              0.0035701538,
                              0.0029638319,
                              0.004292737,
                              0.002492793,
                              0.0024393075,
                              0.0035641573,
                              0.006333074,
                              0.006975115,
                              0.012621295,
                              0.011809317,
                              0.014569409]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_95.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957
Directory path: experiments/inpainting/gann_4_night_20180723_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_95.0/images
Optimal number of principal components:  48
Reconstruction error:  3.7949073
Energy conservation:  0.954911
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_95.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.075287224842861, 1.2184137868449563],
                   'kl_div': 2.2962768,
                   'ks_tests': {10000: KstestResult(statistic=0.4575, pvalue=0.0, statistic_location=0.0017626155, statistic_sign=1),
                                20000: KstestResult(statistic=0.45319999999999994, pvalue=0.0, statistic_location=0.0017818436, statistic_sign=1),
                                30000: KstestResult(statistic=0.4587, pvalue=0.0, statistic_location=0.0017672814, statistic_sign=1),
                                40000: KstestResult(statistic=0.4609000000000001, pvalue=0.0, statistic_location=0.0018266216, statistic_sign=1),
                                50000: KstestResult(statistic=0.45510000000000006, pvalue=0.0, statistic_location=0.0018837852, statistic_sign=1),
                                60000: KstestResult(statistic=0.45810000000000006, pvalue=0.0, statistic_location=0.002001563, statistic_sign=1),
                                70000: KstestResult(statistic=0.4613285714285714, pvalue=0.0, statistic_location=0.0017064321, statistic_sign=1),
                                80000: KstestResult(statistic=0.45643750000000005, pvalue=0.0, statistic_location=0.0018877722, statistic_sign=1),
                                90000: KstestResult(statistic=0.4572111111111111, pvalue=0.0, statistic_location=0.0017734161, statistic_sign=1),
                                100000: KstestResult(statistic=0.45230000000000004, pvalue=0.0, statistic_location=0.001861963, statistic_sign=1),
                                110000: KstestResult(statistic=0.45874545454545446, pvalue=0.0, statistic_location=0.001797297, statistic_sign=1)},
                   'moments': {'mean_error': 1.2440977,
                               'means': [0.00018858185, -2.6731304e-05],
                               'stds': [0.018317485, 0.0007705612],
                               'variance_ratio': 896.0149}},
 'originals': {'gan': {'mae': 0.039080649614334106,
                       'mse': 0.0029828031547367573,
                       'psnr': 25.586721420288086,
                       'rmse': 0.054615046828985214,
                       'ssim': 0.6815907955169678},
               'pca': {'mae': 0.0014309315010905266,
                       'mse': 3.632273774201167e-06,
                       'psnr': 55.47602844238281,
                       'rmse': 0.0019058524630963802,
                       'ssim': 0.9989588260650635}},
 'reconstructions': {'mae': 0.03904913365840912,
                     'mse': 0.002979232696816325,
                     'psnr': 26.336774826049805,
                     'rmse': 0.054582346230745316,
                     'ssim': 0.6814926266670227},
 'residual_spectra_pcagan': {'cosine': [0.013583412,
                                        0.01355384,
                                        0.031342592,
                                        0.031641785,
                                        0.016378185,
                                        0.029945394,
                                        0.030545838,
                                        0.036839526,
                                        0.0039421986,
                                        0.04347615,
                                        0.016351555],
                             'mae': [0.011884143,
                                     0.012915816,
                                     0.012747186,
                                     0.011505961,
                                     0.012764547,
                                     0.012195404,
                                     0.012213861,
                                     0.013078569,
                                     0.013337152,
                                     0.0122749135,
                                     0.013009403],
                             'max_mae': 0.013337152,
                             'max_mse': 0.0004663002,
                             'max_rmse': 0.021593986,
                             'median_distance': 1.7836722,
                             'median_mae': 0.012747186,
                             'min_cosine': 0.0039421986,
                             'mse': [0.0002744894,
                                     0.0004663002,
                                     0.00031814867,
                                     0.00027038585,
                                     0.00041038904,
                                     0.00028166993,
                                     0.0003056665,
                                     0.00033496303,
                                     0.0003683047,
                                     0.0003161078,
                                     0.00034430955],
                             'rmse': [0.016567722,
                                      0.021593986,
                                      0.017836722,
                                      0.016443413,
                                      0.020258062,
                                      0.016783025,
                                      0.01748332,
                                      0.018301995,
                                      0.019191267,
                                      0.017779421,
                                      0.01855558]},
 'residuals': {'mae': 0.012538814917206764,
               'mse': 0.00033552132663317025,
               'psnr': -6.055388450622559,
               'rmse': 0.018317241221666336,
               'ssds': [36.911907, 0.06539212],
               'ssim': 0.23872768878936768},
 'spectra_pcagan': {'cosine': [0.7620619,
                               0.9706957,
                               0.9720075,
                               0.97803676,
                               0.97321904,
                               0.97151566,
                               0.97607464,
                               0.9773136,
                               0.9844424,
                               0.9912403,
                               0.9883792],
                    'mae': [0.12477494,
                            0.037245113,
                            0.03280761,
                            0.028120002,
                            0.030779554,
                            0.03195148,
                            0.030486325,
                            0.031197809,
                            0.029366119,
                            0.025318757,
                            0.02749277],
                    'max_mae': 0.12477494,
                    'max_mse': 0.01730062,
                    'max_rmse': 0.13153182,
                    'median_mae': 0.030779554,
                    'min_cosine': 0.7620619,
                    'mse': [0.01730062,
                            0.0023284345,
                            0.0016975895,
                            0.0013054806,
                            0.0016320678,
                            0.0016328396,
                            0.0015090865,
                            0.0016232159,
                            0.0014270493,
                            0.0010618644,
                            0.0012533095],
                    'rmse': [0.13153182,
                             0.048253853,
                             0.041201815,
                             0.036131434,
                             0.04039886,
                             0.04040841,
                             0.038846962,
                             0.040289152,
                             0.037776306,
                             0.03258626,
                             0.03540211]},
 'spectra_realgan': {'cosine': [0.7618132,
                                0.9706433,
                                0.9719446,
                                0.977983,
                                0.97307557,
                                0.9714739,
                                0.97608113,
                                0.977296,
                                0.98441505,
                                0.99123144,
                                0.9883725],
                     'mae': [0.12483563,
                             0.037253868,
                             0.032851625,
                             0.028157623,
                             0.030859664,
                             0.031978235,
                             0.03047882,
                             0.031209778,
                             0.02941755,
                             0.025339656,
                             0.027504697],
                     'max_mae': 0.12483563,
                     'max_mse': 0.017318122,
                     'max_rmse': 0.13159834,
                     'median_mae': 0.030859664,
                     'min_cosine': 0.7618132,
                     'mse': [0.017318122,
                             0.0023279006,
                             0.0017012808,
                             0.001308548,
                             0.0016385578,
                             0.0016354714,
                             0.0015088693,
                             0.0016243889,
                             0.0014303842,
                             0.001063264,
                             0.0012540491],
                     'rmse': [0.13159834,
                              0.04824832,
                              0.041246586,
                              0.036173858,
                              0.0404791,
                              0.04044096,
                              0.03884417,
                              0.040303707,
                              0.03782042,
                              0.03260773,
                              0.035412557]},
 'spectra_realpca': {'cosine': [0.99996954,
                                0.999917,
                                0.9998882,
                                0.9999543,
                                0.99986106,
                                0.99996454,
                                0.9999683,
                                0.9999278,
                                0.9999665,
                                0.99999136,
                                0.9999897],
                     'mae': [0.0011213617,
                             0.001921282,
                             0.0020697378,
                             0.0013134961,
                             0.002267207,
                             0.0011352734,
                             0.0011295768,
                             0.0017518641,
                             0.001385516,
                             0.0008074788,
                             0.00083745277],
                     'max_mae': 0.002267207,
                     'max_mse': 8.2687e-06,
                     'max_rmse': 0.0028755348,
                     'median_mae': 0.0013134961,
                     'min_cosine': 0.99986106,
                     'mse': [2.00646e-06,
                             5.879816e-06,
                             6.856328e-06,
                             2.748765e-06,
                             8.2687e-06,
                             2.0618088e-06,
                             2.027391e-06,
                             4.8945503e-06,
                             3.0590973e-06,
                             1.0412465e-06,
                             1.1108496e-06],
                     'rmse': [0.0014164957,
                              0.0024248331,
                              0.002618459,
                              0.00165794,
                              0.0028755348,
                              0.0014359,
                              0.0014238649,
                              0.002212363,
                              0.0017490275,
                              0.0010204149,
                              0.0010539684]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_95.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431
Directory path: experiments/inpainting/gann_4_night_20180723_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_95.0/images
Optimal number of principal components:  48
Reconstruction error:  3.7949073
Energy conservation:  0.954911
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_95.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.070708789508587, 1.2730197883379433],
                   'kl_div': 2.2244902,
                   'ks_tests': {10000: KstestResult(statistic=0.4642, pvalue=0.0, statistic_location=0.0017168159, statistic_sign=1),
                                20000: KstestResult(statistic=0.4519500000000001, pvalue=0.0, statistic_location=0.0017759802, statistic_sign=1),
                                30000: KstestResult(statistic=0.45643333333333336, pvalue=0.0, statistic_location=0.0018448923, statistic_sign=1),
                                40000: KstestResult(statistic=0.4519500000000001, pvalue=0.0, statistic_location=0.0017671352, statistic_sign=1),
                                50000: KstestResult(statistic=0.44877999999999996, pvalue=0.0, statistic_location=0.0018118946, statistic_sign=1),
                                60000: KstestResult(statistic=0.45309999999999995, pvalue=0.0, statistic_location=0.0017819447, statistic_sign=1),
                                70000: KstestResult(statistic=0.45785714285714285, pvalue=0.0, statistic_location=0.0018725474, statistic_sign=1),
                                80000: KstestResult(statistic=0.455275, pvalue=0.0, statistic_location=0.001784794, statistic_sign=1),
                                90000: KstestResult(statistic=0.4556, pvalue=0.0, statistic_location=0.0018585554, statistic_sign=1),
                                100000: KstestResult(statistic=0.45393000000000006, pvalue=0.0, statistic_location=0.0017510124, statistic_sign=1),
                                110000: KstestResult(statistic=0.454509090909091, pvalue=0.0, statistic_location=0.001778408, statistic_sign=1),
                                120000: KstestResult(statistic=0.4559500000000001, pvalue=0.0, statistic_location=0.001800545, statistic_sign=1),
                                130000: KstestResult(statistic=0.4530384615384615, pvalue=0.0, statistic_location=0.00178057, statistic_sign=1),
                                140000: KstestResult(statistic=0.4535, pvalue=0.0, statistic_location=0.0017689373, statistic_sign=1),
                                150000: KstestResult(statistic=0.4530333333333334, pvalue=0.0, statistic_location=0.0018587336, statistic_sign=1),
                                160000: KstestResult(statistic=0.45069375, pvalue=0.0, statistic_location=0.0017082314, statistic_sign=1),
                                170000: KstestResult(statistic=0.4518352941176471, pvalue=0.0, statistic_location=0.0018534767, statistic_sign=1),
                                180000: KstestResult(statistic=0.45566666666666666, pvalue=0.0, statistic_location=0.001853324, statistic_sign=1),
                                190000: KstestResult(statistic=0.45431578947368423, pvalue=0.0, statistic_location=0.0017824179, statistic_sign=1),
                                200000: KstestResult(statistic=0.45472, pvalue=0.0, statistic_location=0.0018587545, statistic_sign=1),
                                210000: KstestResult(statistic=0.4565, pvalue=0.0, statistic_location=0.0017824179, statistic_sign=1),
                                220000: KstestResult(statistic=0.4560681818181819, pvalue=0.0, statistic_location=0.0017777253, statistic_sign=1)},
                   'moments': {'mean_error': 1.9645721,
                               'means': [0.0011001013, -1.4971324e-05],
                               'stds': [0.017806092, 0.0009204582],
                               'variance_ratio': 637.5875}},
 'originals': {'gan': {'mae': 0.038087304681539536,
                       'mse': 0.0028102791402488947,
                       'psnr': 27.170915603637695,
                       'rmse': 0.05301206558942795,
                       'ssim': 0.6383501887321472},
               'pca': {'mae': 0.0015244156820699573,
                       'mse': 6.180816399137257e-06,
                       'psnr': 54.230873107910156,
                       'rmse': 0.0024861248675733805,
                       'ssim': 0.9991743564605713}},
 'reconstructions': {'mae': 0.03801744803786278,
                     'mse': 0.0028030339162796736,
                     'psnr': 27.665050506591797,
                     'rmse': 0.05294368788599968,
                     'ssim': 0.6386423110961914},
 'residual_spectra_pcagan': {'cosine': [0.052558288,
                                        0.0117647005,
                                        0.0044806288,
                                        0.20000836,
                                        0.057442073,
                                        0.025105113,
                                        0.019326236,
                                        0.04509566,
                                        0.03617217,
                                        0.024097012,
                                        0.04414646,
                                        0.040415686,
                                        0.04687361,
                                        0.0071349833,
                                        0.0064938725,
                                        0.028501283,
                                        0.006615917,
                                        0.0061102444,
                                        0.034588236,
                                        0.032699022,
                                        0.033718508,
                                        0.021966813],
                             'mae': [0.010474024,
                                     0.011233774,
                                     0.012575109,
                                     0.01109323,
                                     0.012455065,
                                     0.0132698575,
                                     0.011632843,
                                     0.010754559,
                                     0.011204944,
                                     0.011998987,
                                     0.013065737,
                                     0.012553985,
                                     0.012174372,
                                     0.012436388,
                                     0.012673926,
                                     0.013077184,
                                     0.012882751,
                                     0.014460196,
                                     0.013668906,
                                     0.012755676,
                                     0.013459543,
                                     0.011902158],
                             'max_mae': 0.014460196,
                             'max_mse': 0.00048799143,
                             'max_rmse': 0.022090528,
                             'median_distance': 1.74737,
                             'median_mae': 0.0125045255,
                             'min_cosine': 0.0044806288,
                             'mse': [0.00021897913,
                                     0.00030978952,
                                     0.00043175326,
                                     0.00024141255,
                                     0.00032902925,
                                     0.00039722485,
                                     0.00029112134,
                                     0.0002317001,
                                     0.00023024302,
                                     0.00027187783,
                                     0.0003294002,
                                     0.0002959947,
                                     0.0002725281,
                                     0.0002979992,
                                     0.00033616004,
                                     0.00037289315,
                                     0.00031074425,
                                     0.00038498422,
                                     0.00037150306,
                                     0.00030090322,
                                     0.00048799143,
                                     0.0002737448],
                             'rmse': [0.014797944,
                                      0.017600838,
                                      0.020778673,
                                      0.015537457,
                                      0.018139163,
                                      0.0199305,
                                      0.017062278,
                                      0.015221698,
                                      0.015173761,
                                      0.016488718,
                                      0.018149385,
                                      0.017204497,
                                      0.016508425,
                                      0.017262654,
                                      0.018334668,
                                      0.01931044,
                                      0.01762794,
                                      0.019621015,
                                      0.019274415,
                                      0.017346563,
                                      0.022090528,
                                      0.016545236]},
 'residuals': {'mae': 0.012354693375527859,
               'mse': 0.0003176353347953409,
               'psnr': 2.0762760639190674,
               'rmse': 0.017822327092289925,
               'ssds': [70.01845, 0.18644196],
               'ssim': 0.2814467251300812},
 'spectra_pcagan': {'cosine': [0.98428094,
                               0.98722905,
                               0.97196215,
                               0.9865519,
                               0.97527874,
                               0.7807213,
                               0.97555774,
                               0.97941476,
                               0.97715366,
                               0.97530407,
                               0.9670312,
                               0.97759,
                               0.9786661,
                               0.9864099,
                               0.9898652,
                               0.9882218,
                               0.99054825,
                               0.99140215,
                               0.9933383,
                               0.9455032,
                               0.9923625,
                               0.9950612],
                    'mae': [0.03136026,
                            0.033334848,
                            0.032127764,
                            0.032034334,
                            0.034087405,
                            0.12314403,
                            0.03238997,
                            0.027303161,
                            0.028797919,
                            0.029977618,
                            0.035859536,
                            0.031577766,
                            0.031064037,
                            0.027460212,
                            0.02667002,
                            0.031913374,
                            0.02713266,
                            0.028466165,
                            0.028432453,
                            0.113306835,
                            0.025864057,
                            0.024079395],
                    'max_mae': 0.12314403,
                    'max_mse': 0.017232332,
                    'max_rmse': 0.13127197,
                    'median_mae': 0.03121215,
                    'min_cosine': 0.7807213,
                    'mse': [0.0016090166,
                            0.0019631698,
                            0.0018032201,
                            0.0016829415,
                            0.0018733818,
                            0.017232332,
                            0.0017564013,
                            0.0012496399,
                            0.0013827712,
                            0.0014523492,
                            0.0020933866,
                            0.0015845019,
                            0.0015693933,
                            0.0012451085,
                            0.0012407064,
                            0.0016640385,
                            0.0011873321,
                            0.0013205464,
                            0.001378541,
                            0.0141936885,
                            0.0012400278,
                            0.00094425183],
                    'rmse': [0.040112548,
                             0.04430767,
                             0.04246434,
                             0.041023668,
                             0.04328258,
                             0.13127197,
                             0.04190944,
                             0.035350244,
                             0.03718563,
                             0.0381097,
                             0.045753542,
                             0.039805803,
                             0.039615568,
                             0.035286095,
                             0.035223663,
                             0.04079263,
                             0.034457687,
                             0.036339324,
                             0.03712871,
                             0.119137265,
                             0.03521403,
                             0.030728681]},
 'spectra_realgan': {'cosine': [0.9842078,
                                0.9871999,
                                0.9718724,
                                0.985967,
                                0.97519636,
                                0.78046894,
                                0.97550553,
                                0.979332,
                                0.9771153,
                                0.9751869,
                                0.96695566,
                                0.97756875,
                                0.97863656,
                                0.9863973,
                                0.98986506,
                                0.988211,
                                0.99054843,
                                0.9914029,
                                0.9933298,
                                0.9454759,
                                0.99235487,
                                0.99506116],
                     'mae': [0.031449873,
                             0.033358075,
                             0.03223088,
                             0.032833684,
                             0.034184877,
                             0.12320614,
                             0.032412127,
                             0.02735318,
                             0.028834647,
                             0.030076234,
                             0.035897896,
                             0.031591743,
                             0.031081274,
                             0.02747107,
                             0.026677659,
                             0.03191745,
                             0.02713928,
                             0.028460499,
                             0.028434673,
                             0.11333312,
                             0.025898932,
                             0.024077341],
                     'max_mae': 0.12320614,
                     'max_mse': 0.017251171,
                     'max_rmse': 0.1313437,
                     'median_mae': 0.03126557,
                     'min_cosine': 0.78046894,
                     'mse': [0.001616725,
                             0.001966377,
                             0.0018089884,
                             0.0017658881,
                             0.0018792998,
                             0.017251171,
                             0.0017576824,
                             0.0012546197,
                             0.0013850576,
                             0.0014584885,
                             0.0020979233,
                             0.0015857856,
                             0.0015713709,
                             0.0012464509,
                             0.0012413118,
                             0.001664988,
                             0.0011874527,
                             0.0013207701,
                             0.0013795355,
                             0.014200812,
                             0.0012412195,
                             0.0009442255],
                     'rmse': [0.04020852,
                              0.04434385,
                              0.042532206,
                              0.04202247,
                              0.04335089,
                              0.1313437,
                              0.041924722,
                              0.03542061,
                              0.03721636,
                              0.038190164,
                              0.045803092,
                              0.039821923,
                              0.03964052,
                              0.035305113,
                              0.035232253,
                              0.040804263,
                              0.034459434,
                              0.0363424,
                              0.037142098,
                              0.119167164,
                              0.035230946,
                              0.030728253]},
 'spectra_realpca': {'cosine': [0.99994224,
                                0.99998224,
                                0.99992806,
                                0.9994512,
                                0.99986035,
                                0.99996954,
                                0.999917,
                                0.9998882,
                                0.9999543,
                                0.99986106,
                                0.99996454,
                                0.9999683,
                                0.9999278,
                                0.9999665,
                                0.99999136,
                                0.9999897,
                                0.999996,
                                0.99999464,
                                0.9999956,
                                0.99999684,
                                0.9999933,
                                0.9999985],
                     'mae': [0.0019017664,
                             0.0012991122,
                             0.0016965927,
                             0.0065299207,
                             0.002543839,
                             0.0011213617,
                             0.001921282,
                             0.0020697378,
                             0.0013134961,
                             0.002267207,
                             0.0011352734,
                             0.0011295768,
                             0.0017518641,
                             0.001385516,
                             0.0008074788,
                             0.00083745277,
                             0.0005610383,
                             0.00072354556,
                             0.0007251388,
                             0.0005976864,
                             0.00081297924,
                             0.00040528036],
                     'max_mae': 0.0065299207,
                     'max_mse': 6.8520996e-05,
                     'max_rmse': 0.008277741,
                     'median_mae': 0.0012171927,
                     'min_cosine': 0.9994512,
                     'mse': [5.787384e-06,
                             2.6630473e-06,
                             4.6112455e-06,
                             6.8520996e-05,
                             1.0360296e-05,
                             2.00646e-06,
                             5.879816e-06,
                             6.856328e-06,
                             2.748765e-06,
                             8.2687e-06,
                             2.0618088e-06,
                             2.027391e-06,
                             4.8945503e-06,
                             3.0590973e-06,
                             1.0412465e-06,
                             1.1108496e-06,
                             5.063313e-07,
                             8.3205634e-07,
                             8.393149e-07,
                             5.772852e-07,
                             1.0595472e-06,
                             2.6548233e-07],
                     'rmse': [0.0024056982,
                              0.0016318846,
                              0.002147381,
                              0.008277741,
                              0.0032187414,
                              0.0014164957,
                              0.0024248331,
                              0.002618459,
                              0.00165794,
                              0.0028755348,
                              0.0014359,
                              0.0014238649,
                              0.002212363,
                              0.0017490275,
                              0.0010204149,
                              0.0010539684,
                              0.00071156956,
                              0.0009121712,
                              0.0009161413,
                              0.00075979286,
                              0.0010293431,
                              0.0005152498]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_95.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707
Directory path: experiments/inpainting/gann_4_night_20180723_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_95.0/images
Optimal number of principal components:  48
Reconstruction error:  3.7949073
Energy conservation:  0.954911
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_95.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.060522481510419, 1.5193559754532076],
                   'kl_div': 1.9529451,
                   'ks_tests': {10000: KstestResult(statistic=0.3983, pvalue=0.0, statistic_location=-0.0024387501, statistic_sign=-1),
                                20000: KstestResult(statistic=0.3998999999999999, pvalue=0.0, statistic_location=0.0020741953, statistic_sign=1),
                                30000: KstestResult(statistic=0.39836666666666665, pvalue=0.0, statistic_location=0.0019986378, statistic_sign=1),
                                40000: KstestResult(statistic=0.4029250000000001, pvalue=0.0, statistic_location=0.0021396526, statistic_sign=1),
                                50000: KstestResult(statistic=0.39702000000000004, pvalue=0.0, statistic_location=0.0020904867, statistic_sign=1),
                                60000: KstestResult(statistic=0.4027666666666666, pvalue=0.0, statistic_location=0.0021246597, statistic_sign=1),
                                70000: KstestResult(statistic=0.39921428571428563, pvalue=0.0, statistic_location=0.0021228362, statistic_sign=1),
                                80000: KstestResult(statistic=0.40088750000000006, pvalue=0.0, statistic_location=0.0021291394, statistic_sign=1),
                                90000: KstestResult(statistic=0.39803333333333335, pvalue=0.0, statistic_location=0.0021671145, statistic_sign=1),
                                100000: KstestResult(statistic=0.4009100000000001, pvalue=0.0, statistic_location=0.0019842393, statistic_sign=1),
                                110000: KstestResult(statistic=0.4020454545454546, pvalue=0.0, statistic_location=0.0021294402, statistic_sign=1),
                                120000: KstestResult(statistic=0.40036666666666665, pvalue=0.0, statistic_location=0.0021013613, statistic_sign=1),
                                130000: KstestResult(statistic=0.40138461538461545, pvalue=0.0, statistic_location=0.0020405324, statistic_sign=1),
                                140000: KstestResult(statistic=0.40028571428571424, pvalue=0.0, statistic_location=0.002120515, statistic_sign=1),
                                150000: KstestResult(statistic=0.3972066666666667, pvalue=0.0, statistic_location=0.0021301105, statistic_sign=1),
                                160000: KstestResult(statistic=0.40221874999999996, pvalue=0.0, statistic_location=0.0021016866, statistic_sign=1),
                                170000: KstestResult(statistic=0.3987647058823529, pvalue=0.0, statistic_location=0.002120018, statistic_sign=1),
                                180000: KstestResult(statistic=0.3988722222222222, pvalue=0.0, statistic_location=0.0021294402, statistic_sign=1),
                                190000: KstestResult(statistic=0.4001842105263158, pvalue=0.0, statistic_location=0.0020379294, statistic_sign=1),
                                200000: KstestResult(statistic=0.39864999999999995, pvalue=0.0, statistic_location=0.002027817, statistic_sign=1),
                                210000: KstestResult(statistic=0.3993904761904762, pvalue=0.0, statistic_location=0.0021256246, statistic_sign=1),
                                220000: KstestResult(statistic=0.4008636363636364, pvalue=0.0, statistic_location=0.0020922848, statistic_sign=1),
                                230000: KstestResult(statistic=0.39793478260869564, pvalue=0.0, statistic_location=0.0020615936, statistic_sign=1),
                                240000: KstestResult(statistic=0.39974583333333336, pvalue=0.0, statistic_location=0.0021179952, statistic_sign=1),
                                250000: KstestResult(statistic=0.399644, pvalue=0.0, statistic_location=0.0021982538, statistic_sign=1),
                                260000: KstestResult(statistic=0.40058076923076924, pvalue=0.0, statistic_location=0.0020370553, statistic_sign=1),
                                270000: KstestResult(statistic=0.40058148148148154, pvalue=0.0, statistic_location=0.002040608, statistic_sign=1),
                                280000: KstestResult(statistic=0.39984285714285717, pvalue=0.0, statistic_location=0.0021259426, statistic_sign=1),
                                290000: KstestResult(statistic=0.3999931034482759, pvalue=0.0, statistic_location=0.0020379294, statistic_sign=1),
                                300000: KstestResult(statistic=0.39986333333333335, pvalue=0.0, statistic_location=0.0020753178, statistic_sign=1),
                                310000: KstestResult(statistic=0.4002032258064516, pvalue=0.0, statistic_location=0.0020763208, statistic_sign=1),
                                320000: KstestResult(statistic=0.400396875, pvalue=0.0, statistic_location=0.002036266, statistic_sign=1),
                                330000: KstestResult(statistic=0.4001818181818182, pvalue=0.0, statistic_location=0.0020369254, statistic_sign=1)},
                   'moments': {'mean_error': 0.24767593,
                               'means': [4.6829733e-05, -9.156388e-06],
                               'stds': [0.017160652, 0.0014949753],
                               'variance_ratio': 248.84065}},
 'originals': {'gan': {'mae': 0.03634387254714966,
                       'mse': 0.002503450959920883,
                       'psnr': 28.304943084716797,
                       'rmse': 0.05003449693322182,
                       'ssim': 0.6518727540969849},
               'pca': {'mae': 0.002213087398558855,
                       'mse': 2.0046178178745322e-05,
                       'psnr': 49.70124435424805,
                       'rmse': 0.004477296024560928,
                       'ssim': 0.9986035227775574}},
 'reconstructions': {'mae': 0.03615247458219528,
                     'mse': 0.0024832820054143667,
                     'psnr': 28.771297454833984,
                     'rmse': 0.0498325377702713,
                     'ssim': 0.6487300992012024},
 'residual_spectra_pcagan': {'cosine': [0.116410136,
                                        0.0806883,
                                        0.13375989,
                                        0.058478393,
                                        0.14879195,
                                        0.3141775,
                                        0.01564736,
                                        0.0070468164,
                                        0.010427183,
                                        0.19084625,
                                        0.06133289,
                                        0.018527305,
                                        0.024613906,
                                        0.04736966,
                                        0.03255052,
                                        0.02665329,
                                        0.03171085,
                                        0.029037764,
                                        0.043497253,
                                        0.012286399,
                                        0.04562668,
                                        0.019299347,
                                        0.029560508,
                                        0.012559907,
                                        0.026969304,
                                        0.044322986,
                                        0.04664907,
                                        0.012677185,
                                        0.014593293,
                                        0.049064815,
                                        0.06637823,
                                        0.04059591,
                                        0.020704443],
                             'mae': [0.010896402,
                                     0.011442503,
                                     0.010692781,
                                     0.011755136,
                                     0.010584174,
                                     0.0105827,
                                     0.011499969,
                                     0.011877552,
                                     0.011509822,
                                     0.011180605,
                                     0.012352845,
                                     0.01177885,
                                     0.012550357,
                                     0.012243272,
                                     0.011036909,
                                     0.012236421,
                                     0.011671202,
                                     0.011750957,
                                     0.012534788,
                                     0.012925954,
                                     0.011791578,
                                     0.012763905,
                                     0.012181862,
                                     0.01369739,
                                     0.013092253,
                                     0.012139339,
                                     0.013622571,
                                     0.013465019,
                                     0.01158936,
                                     0.0116810985,
                                     0.011160678,
                                     0.011573118,
                                     0.012774182],
                             'max_mae': 0.01369739,
                             'max_mse': 0.00039361938,
                             'max_rmse': 0.019839844,
                             'median_distance': 1.7032753,
                             'median_mae': 0.01177885,
                             'min_cosine': 0.0070468164,
                             'mse': [0.0002344141,
                                     0.00027649562,
                                     0.00023521314,
                                     0.00035492334,
                                     0.00022171102,
                                     0.00031127105,
                                     0.00029628765,
                                     0.00033950774,
                                     0.0002901147,
                                     0.0002531399,
                                     0.00034716568,
                                     0.000274948,
                                     0.00039361938,
                                     0.000277594,
                                     0.00023340668,
                                     0.00032979113,
                                     0.00024469843,
                                     0.00026177292,
                                     0.0003087309,
                                     0.00031885275,
                                     0.00026890784,
                                     0.00032772773,
                                     0.0003174317,
                                     0.00034581407,
                                     0.0003129586,
                                     0.00026685983,
                                     0.00033546265,
                                     0.00034860705,
                                     0.00025195404,
                                     0.00025077042,
                                     0.00023986997,
                                     0.00025238818,
                                     0.00033127808],
                             'rmse': [0.015310587,
                                      0.016628157,
                                      0.01533666,
                                      0.01883941,
                                      0.014889964,
                                      0.017642876,
                                      0.017213007,
                                      0.018425737,
                                      0.017032754,
                                      0.01591037,
                                      0.018632382,
                                      0.016581556,
                                      0.019839844,
                                      0.016661152,
                                      0.015277653,
                                      0.018160153,
                                      0.01564284,
                                      0.016179398,
                                      0.01757074,
                                      0.017856449,
                                      0.01639841,
                                      0.018103251,
                                      0.017816612,
                                      0.018596077,
                                      0.017690636,
                                      0.016335845,
                                      0.01831564,
                                      0.01867102,
                                      0.01587306,
                                      0.015835732,
                                      0.015487736,
                                      0.01588673,
                                      0.018201046]},
 'residuals': {'mae': 0.0119586531072855,
               'mse': 0.00029253598768264055,
               'psnr': 10.241803169250488,
               'rmse': 0.017103683203458786,
               'ssds': [97.18146, 0.7375592],
               'ssim': 0.26101499795913696},
 'spectra_pcagan': {'cosine': [0.9855215,
                               0.9828549,
                               0.9859565,
                               0.98521125,
                               0.98454595,
                               0.99165833,
                               0.98180526,
                               0.9852812,
                               0.97062486,
                               0.98472595,
                               0.97041047,
                               0.7622222,
                               0.97088665,
                               0.97181296,
                               0.978028,
                               0.97297823,
                               0.97127944,
                               0.9764384,
                               0.97747034,
                               0.98425835,
                               0.99090123,
                               0.98853207,
                               0.9913899,
                               0.9913759,
                               0.9938317,
                               0.9381465,
                               0.9917883,
                               0.9926591,
                               0.99521196,
                               0.9935364,
                               0.9913882,
                               0.99310315,
                               0.9935863],
                    'mae': [0.030273011,
                            0.030478828,
                            0.029657546,
                            0.031209558,
                            0.037564684,
                            0.036656722,
                            0.033150047,
                            0.035895053,
                            0.034192264,
                            0.03629309,
                            0.036681738,
                            0.1249592,
                            0.03719579,
                            0.032956377,
                            0.028139172,
                            0.030973008,
                            0.032038905,
                            0.030254077,
                            0.031099549,
                            0.02958488,
                            0.025730716,
                            0.027450537,
                            0.02857802,
                            0.029382208,
                            0.027925476,
                            0.118882924,
                            0.02837815,
                            0.030446539,
                            0.023148732,
                            0.025679404,
                            0.028391961,
                            0.024693506,
                            0.025090063],
                    'max_mae': 0.1249592,
                    'max_mse': 0.017360201,
                    'max_rmse': 0.13175811,
                    'median_mae': 0.030446539,
                    'min_cosine': 0.7622222,
                    'mse': [0.0015561788,
                            0.0015952691,
                            0.0014936721,
                            0.0017666694,
                            0.0021963483,
                            0.0024636737,
                            0.0018531912,
                            0.0022984566,
                            0.0018781758,
                            0.002140773,
                            0.0021894344,
                            0.017360201,
                            0.0023102108,
                            0.0017094099,
                            0.001306007,
                            0.0016429737,
                            0.0016461529,
                            0.0014858389,
                            0.00161121,
                            0.0014448377,
                            0.0011026198,
                            0.0012375225,
                            0.0014096622,
                            0.0013888448,
                            0.0013204514,
                            0.0154607,
                            0.0012933273,
                            0.001487846,
                            0.000877755,
                            0.0010608208,
                            0.0012964038,
                            0.0009890811,
                            0.001074589],
                    'rmse': [0.039448433,
                             0.03994082,
                             0.038648054,
                             0.04203177,
                             0.046865214,
                             0.049635407,
                             0.043048706,
                             0.04794222,
                             0.043337926,
                             0.04626849,
                             0.046791393,
                             0.13175811,
                             0.048064653,
                             0.04134501,
                             0.03613872,
                             0.040533613,
                             0.04057281,
                             0.03854658,
                             0.04013988,
                             0.038011022,
                             0.033205718,
                             0.035178438,
                             0.03754547,
                             0.037267208,
                             0.036338016,
                             0.12434106,
                             0.03596286,
                             0.038572606,
                             0.02962693,
                             0.032570243,
                             0.03600561,
                             0.03144966,
                             0.032780923]},
 'spectra_realgan': {'cosine': [0.9853446,
                                0.98256767,
                                0.98563063,
                                0.9851163,
                                0.98430246,
                                0.990299,
                                0.9817857,
                                0.98526233,
                                0.9705344,
                                0.9840986,
                                0.9703405,
                                0.76197344,
                                0.9708338,
                                0.9717489,
                                0.97797406,
                                0.97283286,
                                0.97123957,
                                0.9764412,
                                0.9774506,
                                0.98423177,
                                0.9908921,
                                0.9885252,
                                0.99138296,
                                0.99137866,
                                0.99382675,
                                0.93811303,
                                0.9917736,
                                0.9926594,
                                0.99521136,
                                0.9935207,
                                0.9913594,
                                0.9931009,
                                0.9935819],
                     'mae': [0.030539649,
                             0.030799946,
                             0.030067993,
                             0.031364214,
                             0.037744008,
                             0.040106792,
                             0.033149246,
                             0.03590371,
                             0.034257147,
                             0.037191924,
                             0.036726058,
                             0.12502028,
                             0.03720985,
                             0.03299886,
                             0.028176099,
                             0.031053208,
                             0.032060817,
                             0.030249339,
                             0.031115105,
                             0.029633017,
                             0.025752932,
                             0.027462823,
                             0.028603967,
                             0.029369647,
                             0.027923938,
                             0.118910305,
                             0.028411163,
                             0.030445337,
                             0.023159923,
                             0.025690857,
                             0.02844735,
                             0.02469657,
                             0.025105963],
                     'max_mae': 0.12502028,
                     'max_mse': 0.01737777,
                     'max_rmse': 0.13182476,
                     'median_mae': 0.030539649,
                     'min_cosine': 0.76197344,
                     'mse': [0.0015809664,
                             0.0016187706,
                             0.0015275833,
                             0.0017778876,
                             0.0022216057,
                             0.0028404759,
                             0.0018558182,
                             0.0022999325,
                             0.0018839997,
                             0.0022377805,
                             0.0021935673,
                             0.01737777,
                             0.002309737,
                             0.0017131699,
                             0.001309091,
                             0.001649585,
                             0.0016486815,
                             0.001485844,
                             0.0016125431,
                             0.0014481085,
                             0.001104015,
                             0.0012382809,
                             0.0014120649,
                             0.0013881207,
                             0.0013205992,
                             0.015468698,
                             0.0012956643,
                             0.0014877166,
                             0.00087834947,
                             0.0010618739,
                             0.0013008178,
                             0.0009894918,
                             0.0010752791],
                     'rmse': [0.03976137,
                              0.040233947,
                              0.03908431,
                              0.042165004,
                              0.04713391,
                              0.053296115,
                              0.04307921,
                              0.04795761,
                              0.043405063,
                              0.047305185,
                              0.046835534,
                              0.13182476,
                              0.048059724,
                              0.041390456,
                              0.036181364,
                              0.04061508,
                              0.040603958,
                              0.038546648,
                              0.040156484,
                              0.03805402,
                              0.03322672,
                              0.035189215,
                              0.03757745,
                              0.037257493,
                              0.03634005,
                              0.12437322,
                              0.035995338,
                              0.03857093,
                              0.02963696,
                              0.032586407,
                              0.036066853,
                              0.031456187,
                              0.032791447]},
 'spectra_realpca': {'cosine': [0.999832,
                                0.9996626,
                                0.99966586,
                                0.9998778,
                                0.99974746,
                                0.99848324,
                                0.99994224,
                                0.99998224,
                                0.99992806,
                                0.9994512,
                                0.99986035,
                                0.99996954,
                                0.999917,
                                0.9998882,
                                0.9999543,
                                0.99986106,
                                0.99996454,
                                0.9999683,
                                0.9999278,
                                0.9999665,
                                0.99999136,
                                0.9999897,
                                0.999996,
                                0.99999464,
                                0.9999956,
                                0.99999684,
                                0.9999933,
                                0.9999985,
                                0.99999684,
                                0.9999921,
                                0.99997735,
                                0.99999255,
                                0.99999774],
                     'mae': [0.003329243,
                             0.0044471174,
                             0.004700889,
                             0.0029904996,
                             0.0042984537,
                             0.01564765,
                             0.0019017664,
                             0.0012991122,
                             0.0016965927,
                             0.0065299207,
                             0.002543839,
                             0.0011213617,
                             0.001921282,
                             0.0020697378,
                             0.0013134961,
                             0.002267207,
                             0.0011352734,
                             0.0011295768,
                             0.0017518641,
                             0.001385516,
                             0.0008074788,
                             0.00083745277,
                             0.0005610383,
                             0.00072354556,
                             0.0007251388,
                             0.0005976864,
                             0.00081297924,
                             0.00040528036,
                             0.00061107404,
                             0.00085702277,
                             0.0013229767,
                             0.0008107227,
                             0.00047909035],
                     'max_mae': 0.01564765,
                     'max_mse': 0.00039075993,
                     'max_rmse': 0.01976765,
                     'median_mae': 0.0013134961,
                     'min_cosine': 0.99848324,
                     'mse': [1.7650174e-05,
                             3.139757e-05,
                             3.5710345e-05,
                             1.4221245e-05,
                             2.9849378e-05,
                             0.00039075993,
                             5.787384e-06,
                             2.6630473e-06,
                             4.6112455e-06,
                             6.8520996e-05,
                             1.0360296e-05,
                             2.00646e-06,
                             5.879816e-06,
                             6.856328e-06,
                             2.748765e-06,
                             8.2687e-06,
                             2.0618088e-06,
                             2.027391e-06,
                             4.8945503e-06,
                             3.0590973e-06,
                             1.0412465e-06,
                             1.1108496e-06,
                             5.063313e-07,
                             8.3205634e-07,
                             8.393149e-07,
                             5.772852e-07,
                             1.0595472e-06,
                             2.6548233e-07,
                             5.943975e-07,
                             1.1760163e-06,
                             2.7721728e-06,
                             1.0494389e-06,
                             3.6491969e-07],
                     'rmse': [0.004201211,
                              0.0056033535,
                              0.005975813,
                              0.0037711065,
                              0.0054634586,
                              0.01976765,
                              0.0024056982,
                              0.0016318846,
                              0.002147381,
                              0.008277741,
                              0.0032187414,
                              0.0014164957,
                              0.0024248331,
                              0.002618459,
                              0.00165794,
                              0.0028755348,
                              0.0014359,
                              0.0014238649,
                              0.002212363,
                              0.0017490275,
                              0.0010204149,
                              0.0010539684,
                              0.00071156956,
                              0.0009121712,
                              0.0009161413,
                              0.00075979286,
                              0.0010293431,
                              0.0005152498,
                              0.00077097176,
                              0.0010844428,
                              0.0016649843,
                              0.0010244212,
                              0.0006040858]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_95.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529
Directory path: experiments/inpainting/gann_4_night_20180901_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_95.0/images
Optimal number of principal components:  51
Reconstruction error:  1.5402524
Energy conservation:  0.95362484
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_95.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.932551248322828, 0.7257888362411621],
                   'kl_div': 2.5767715,
                   'ks_tests': {10000: KstestResult(statistic=0.466, pvalue=0.0, statistic_location=0.0009081536, statistic_sign=1),
                                20000: KstestResult(statistic=0.4657, pvalue=0.0, statistic_location=-0.00083745737, statistic_sign=-1),
                                30000: KstestResult(statistic=0.46693333333333337, pvalue=0.0, statistic_location=-0.0007653688, statistic_sign=-1),
                                40000: KstestResult(statistic=0.46915, pvalue=0.0, statistic_location=-0.00084178196, statistic_sign=-1),
                                50000: KstestResult(statistic=0.46766, pvalue=0.0, statistic_location=-0.00085869804, statistic_sign=-1),
                                60000: KstestResult(statistic=0.46595000000000003, pvalue=0.0, statistic_location=-0.00076822937, statistic_sign=-1),
                                70000: KstestResult(statistic=0.4657714285714285, pvalue=0.0, statistic_location=0.00079395995, statistic_sign=1),
                                80000: KstestResult(statistic=0.464475, pvalue=0.0, statistic_location=-0.00079265237, statistic_sign=-1),
                                90000: KstestResult(statistic=0.46499999999999997, pvalue=0.0, statistic_location=-0.00076724775, statistic_sign=-1),
                                100000: KstestResult(statistic=0.46437, pvalue=0.0, statistic_location=-0.00086989487, statistic_sign=-1),
                                110000: KstestResult(statistic=0.4656727272727273, pvalue=0.0, statistic_location=-0.00088250637, statistic_sign=-1)},
                   'moments': {'mean_error': 3.651314,
                               'means': [0.0006159432, 5.5445335e-06],
                               'stds': [0.023046242, 0.00028298894],
                               'variance_ratio': 10842.207}},
 'originals': {'gan': {'mae': 0.10246782749891281,
                       'mse': 0.08953779190778732,
                       'psnr': 15.509012222290039,
                       'rmse': 0.2992286682128906,
                       'ssim': 0.8870318531990051},
               'pca': {'mae': 0.0003432734520174563,
                       'mse': 2.2061148285956733e-07,
                       'psnr': 71.90571594238281,
                       'rmse': 0.0004696929536294192,
                       'ssim': 0.999980628490448}},
 'reconstructions': {'mae': 0.10245919227600098,
                     'mse': 0.08953682333230972,
                     'psnr': 15.821981430053711,
                     'rmse': 0.2992270290851593,
                     'ssim': 0.887000560760498},
 'residual_spectra_pcagan': {'cosine': [0.009939639,
                                        0.002464473,
                                        0.03299247,
                                        0.023576643,
                                        0.024456859,
                                        0.006338226,
                                        0.021896953,
                                        -0.0023716518,
                                        0.02929885,
                                        0.0065675103,
                                        0.011134626],
                             'mae': [0.011423504,
                                     0.012181223,
                                     0.010278004,
                                     0.01123772,
                                     0.011190221,
                                     0.009500915,
                                     0.010260462,
                                     0.010809624,
                                     0.010314901,
                                     0.010104672,
                                     0.025215771],
                             'max_mae': 0.025215771,
                             'max_mse': 0.0031048036,
                             'max_rmse': 0.055720765,
                             'median_distance': 1.5973653,
                             'median_mae': 0.010809624,
                             'min_cosine': -0.0023716518,
                             'mse': [0.00028325748,
                                     0.00045681925,
                                     0.00025154135,
                                     0.00027893786,
                                     0.0003397287,
                                     0.00020872997,
                                     0.00020509958,
                                     0.00024729062,
                                     0.00025515762,
                                     0.00021428373,
                                     0.0031048036],
                             'rmse': [0.016830254,
                                      0.02137333,
                                      0.015860055,
                                      0.016701434,
                                      0.01843173,
                                      0.01444749,
                                      0.014321298,
                                      0.015725477,
                                      0.015973654,
                                      0.014638433,
                                      0.055720765]},
 'residuals': {'mae': 0.012047001160681248,
               'mse': 0.0005314226727932692,
               'psnr': -10.625188827514648,
               'rmse': 0.023052606731653214,
               'ssds': [58.465424, 0.008812404],
               'ssim': 0.5857255458831787},
 'spectra_pcagan': {'cosine': [0.9990693,
                               0.99340296,
                               0.9957841,
                               0.9978204,
                               0.99875444,
                               0.9965655,
                               0.9971904,
                               0.99853444,
                               0.9972599,
                               0.998835,
                               -0.6451632],
                    'mae': [0.015084886,
                            0.021819085,
                            0.018898707,
                            0.01876778,
                            0.014680057,
                            0.016089967,
                            0.017096076,
                            0.015520937,
                            0.016468756,
                            0.014209506,
                            0.9584153],
                    'max_mae': 0.9584153,
                    'max_mse': 0.98011094,
                    'max_rmse': 0.99000555,
                    'median_mae': 0.016468756,
                    'min_cosine': -0.6451632,
                    'mse': [0.0003815785,
                            0.0007852425,
                            0.0005974186,
                            0.00057338993,
                            0.00037407083,
                            0.0004463863,
                            0.00045979794,
                            0.00038929822,
                            0.00045440043,
                            0.0003325415,
                            0.98011094],
                    'rmse': [0.019534035,
                             0.028022178,
                             0.024442147,
                             0.023945563,
                             0.01934091,
                             0.021127855,
                             0.0214429,
                             0.019730642,
                             0.02131667,
                             0.01823572,
                             0.99000555]},
 'spectra_realgan': {'cosine': [0.99906904,
                                0.99339575,
                                0.9957802,
                                0.9978166,
                                0.99875385,
                                0.99656475,
                                0.99718785,
                                0.99853414,
                                0.9972531,
                                0.9988346,
                                -0.6451681],
                     'mae': [0.015093399,
                             0.02183399,
                             0.018908987,
                             0.018786807,
                             0.014685903,
                             0.016091824,
                             0.017106552,
                             0.015522921,
                             0.01648727,
                             0.014210417,
                             0.9584181],
                     'max_mae': 0.9584181,
                     'max_mse': 0.9801171,
                     'max_rmse': 0.99000865,
                     'median_mae': 0.01648727,
                     'min_cosine': -0.6451681,
                     'mse': [0.00038180724,
                             0.0007860666,
                             0.00059797213,
                             0.0005744336,
                             0.00037425675,
                             0.0004465146,
                             0.000460264,
                             0.00038939045,
                             0.0004553608,
                             0.0003326317,
                             0.9801171],
                     'rmse': [0.019539889,
                              0.02803688,
                              0.024453469,
                              0.023967344,
                              0.019345716,
                              0.021130892,
                              0.021453764,
                              0.019732978,
                              0.021339186,
                              0.018238192,
                              0.99000865]},
 'spectra_realpca': {'cosine': [0.9999997,
                                0.99999774,
                                0.999999,
                                0.999998,
                                0.9999996,
                                0.99999905,
                                0.99999726,
                                0.99999964,
                                0.99999636,
                                0.99999994,
                                0.9999997],
                     'mae': [0.0002832401,
                             0.0004175068,
                             0.00028044585,
                             0.00052264426,
                             0.00023188791,
                             0.00027005482,
                             0.00052541046,
                             0.00024132505,
                             0.00059439393,
                             0.00017595556,
                             0.00023314274],
                     'max_mae': 0.00059439393,
                     'max_mse': 5.769165e-07,
                     'max_rmse': 0.0007595502,
                     'median_mae': 0.00028044585,
                     'min_cosine': 0.99999636,
                     'mse': [1.2940806e-07,
                             2.7858712e-07,
                             1.2632978e-07,
                             4.3618056e-07,
                             8.5994195e-08,
                             1.1790118e-07,
                             4.4286736e-07,
                             9.41157e-08,
                             5.769165e-07,
                             4.976692e-08,
                             8.865936e-08],
                     'rmse': [0.00035973333,
                              0.0005278135,
                              0.00035542902,
                              0.00066043966,
                              0.00029324766,
                              0.0003433674,
                              0.0006654828,
                              0.0003067828,
                              0.0007595502,
                              0.00022308501,
                              0.00029775721]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_95.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319
Directory path: experiments/inpainting/gann_4_night_20180901_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_95.0/images
Optimal number of principal components:  51
Reconstruction error:  1.5402524
Energy conservation:  0.95362484
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_95.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.940780002103074, 1.4040411620843884],
                   'kl_div': 1.9017054,
                   'ks_tests': {10000: KstestResult(statistic=0.3952, pvalue=0.0, statistic_location=-0.0011441465, statistic_sign=-1),
                                20000: KstestResult(statistic=0.3934, pvalue=0.0, statistic_location=-0.0013681725, statistic_sign=-1),
                                30000: KstestResult(statistic=0.4004, pvalue=0.0, statistic_location=-0.0013999492, statistic_sign=-1),
                                40000: KstestResult(statistic=0.3938, pvalue=0.0, statistic_location=-0.001362361, statistic_sign=-1),
                                50000: KstestResult(statistic=0.39854, pvalue=0.0, statistic_location=-0.0011829054, statistic_sign=-1),
                                60000: KstestResult(statistic=0.39541666666666664, pvalue=0.0, statistic_location=-0.0013212087, statistic_sign=-1),
                                70000: KstestResult(statistic=0.3954714285714286, pvalue=0.0, statistic_location=-0.0012084693, statistic_sign=-1),
                                80000: KstestResult(statistic=0.39515, pvalue=0.0, statistic_location=-0.0012155485, statistic_sign=-1),
                                90000: KstestResult(statistic=0.3962, pvalue=0.0, statistic_location=-0.0011574151, statistic_sign=-1),
                                100000: KstestResult(statistic=0.39604, pvalue=0.0, statistic_location=-0.0013091825, statistic_sign=-1),
                                110000: KstestResult(statistic=0.3987454545454545, pvalue=0.0, statistic_location=-0.0013080831, statistic_sign=-1),
                                120000: KstestResult(statistic=0.3959416666666667, pvalue=0.0, statistic_location=-0.001173879, statistic_sign=-1),
                                130000: KstestResult(statistic=0.3980230769230769, pvalue=0.0, statistic_location=-0.0012708157, statistic_sign=-1),
                                140000: KstestResult(statistic=0.3975857142857143, pvalue=0.0, statistic_location=-0.0011613416, statistic_sign=-1),
                                150000: KstestResult(statistic=0.3953, pvalue=0.0, statistic_location=-0.0013192603, statistic_sign=-1),
                                160000: KstestResult(statistic=0.39700625, pvalue=0.0, statistic_location=-0.0011798423, statistic_sign=-1),
                                170000: KstestResult(statistic=0.3991235294117647, pvalue=0.0, statistic_location=-0.0012134723, statistic_sign=-1),
                                180000: KstestResult(statistic=0.39685000000000004, pvalue=0.0, statistic_location=-0.0013089348, statistic_sign=-1),
                                190000: KstestResult(statistic=0.39625789473684214, pvalue=0.0, statistic_location=-0.0011450467, statistic_sign=-1),
                                200000: KstestResult(statistic=0.39647499999999997, pvalue=0.0, statistic_location=-0.0011669602, statistic_sign=-1),
                                210000: KstestResult(statistic=0.3991476190476191, pvalue=0.0, statistic_location=-0.0013079029, statistic_sign=-1),
                                220000: KstestResult(statistic=0.39883636363636366, pvalue=0.0, statistic_location=-0.0013194829, statistic_sign=-1)},
                   'moments': {'mean_error': -0.008277661,
                               'means': [-0.00023313925, 1.0970848e-06],
                               'stds': [0.0203259, 0.0015055483],
                               'variance_ratio': 294.32346}},
 'originals': {'gan': {'mae': 0.07914682477712631,
                       'mse': 0.05103900656104088,
                       'psnr': 18.142791748046875,
                       'rmse': 0.22591814398765564,
                       'ssim': 0.5751686692237854},
               'pca': {'mae': 0.0015840131090953946,
                       'mse': 1.4666423339804169e-05,
                       'psnr': 53.828712463378906,
                       'rmse': 0.0038296766579151154,
                       'ssim': 0.9999423623085022}},
 'reconstructions': {'mae': 0.07903335243463516,
                     'mse': 0.051024001091718674,
                     'psnr': 18.414213180541992,
                     'rmse': 0.22588492929935455,
                     'ssim': 0.5751799941062927},
 'residual_spectra_pcagan': {'cosine': [0.09753395,
                                        0.22118305,
                                        0.10082225,
                                        0.23191191,
                                        0.036914855,
                                        0.013173643,
                                        0.001924205,
                                        0.035476808,
                                        0.028049843,
                                        0.025104815,
                                        0.009107954,
                                        0.022893406,
                                        -0.0033065663,
                                        0.033613224,
                                        0.009722852,
                                        0.01022643,
                                        0.020458184,
                                        0.0047931117,
                                        0.008305014,
                                        0.012176756,
                                        0.00014847747,
                                        0.18644592],
                             'mae': [0.010669852,
                                     0.01135398,
                                     0.0120696565,
                                     0.011220595,
                                     0.0111776935,
                                     0.011212923,
                                     0.011806048,
                                     0.009938926,
                                     0.0107970005,
                                     0.010557004,
                                     0.009212146,
                                     0.010195808,
                                     0.010263971,
                                     0.009880018,
                                     0.009537094,
                                     0.025696442,
                                     0.010568335,
                                     0.012869873,
                                     0.0114409,
                                     0.011001828,
                                     0.011421365,
                                     0.0092300335],
                             'max_mae': 0.025696442,
                             'max_mse': 0.0032348658,
                             'max_rmse': 0.05687588,
                             'median_distance': 1.5832481,
                             'median_mae': 0.010899414,
                             'min_cosine': -0.0033065663,
                             'mse': [0.00023580808,
                                     0.0003584664,
                                     0.000564751,
                                     0.00034159474,
                                     0.0003183027,
                                     0.00027166744,
                                     0.00041238614,
                                     0.00022185565,
                                     0.0002475615,
                                     0.0002767604,
                                     0.00018622598,
                                     0.00020202786,
                                     0.00021252403,
                                     0.00021260929,
                                     0.00017655738,
                                     0.0032348658,
                                     0.0002147211,
                                     0.00033356075,
                                     0.00025379288,
                                     0.00024443958,
                                     0.0003142221,
                                     0.00020126876],
                             'rmse': [0.015356044,
                                      0.018933209,
                                      0.02376449,
                                      0.018482283,
                                      0.01784104,
                                      0.016482336,
                                      0.020307293,
                                      0.01489482,
                                      0.015734088,
                                      0.016636118,
                                      0.013646464,
                                      0.0142136505,
                                      0.014578204,
                                      0.014581128,
                                      0.013287489,
                                      0.05687588,
                                      0.014653365,
                                      0.018263645,
                                      0.015930878,
                                      0.015634563,
                                      0.017726311,
                                      0.014186922]},
 'residuals': {'mae': 0.011460068635642529,
               'mse': 0.0004107259155716747,
               'psnr': 12.780036926269531,
               'rmse': 0.020266374573111534,
               'ssds': [90.90281, 0.49866664],
               'ssim': 0.6070876717567444},
 'spectra_pcagan': {'cosine': [0.9673993,
                               0.9868134,
                               0.97839457,
                               0.98706937,
                               0.9951417,
                               0.99904996,
                               0.9933408,
                               0.9958125,
                               0.99782664,
                               0.99878556,
                               0.99668777,
                               0.99712175,
                               0.9985226,
                               0.9972635,
                               0.9988721,
                               -0.64450955,
                               0.99868965,
                               0.999483,
                               0.99916124,
                               0.99510056,
                               0.006199312,
                               0.98844206],
                    'mae': [0.036209974,
                            0.04623128,
                            0.034022234,
                            0.03445395,
                            0.019796135,
                            0.015093328,
                            0.021902757,
                            0.018814046,
                            0.018684622,
                            0.014541193,
                            0.015912183,
                            0.017359389,
                            0.015556276,
                            0.016512683,
                            0.014030234,
                            0.9586795,
                            0.015738728,
                            0.014388749,
                            0.014925089,
                            0.02215492,
                            0.34483552,
                            0.02889123],
                    'max_mae': 0.9586795,
                    'max_mse': 0.9810136,
                    'max_rmse': 0.9904613,
                    'median_mae': 0.018749334,
                    'min_cosine': -0.64450955,
                    'mse': [0.0018594546,
                            0.003051276,
                            0.0020390323,
                            0.0017829441,
                            0.000669323,
                            0.00038177083,
                            0.0007919982,
                            0.0005894887,
                            0.0005656995,
                            0.0003657004,
                            0.00043053407,
                            0.00047343026,
                            0.00039218398,
                            0.00045492317,
                            0.0003219191,
                            0.9810136,
                            0.00039560616,
                            0.0003332698,
                            0.00035985088,
                            0.00074621534,
                            0.12421832,
                            0.0012915885],
                    'rmse': [0.043121394,
                             0.05523836,
                             0.045155644,
                             0.04222492,
                             0.025871279,
                             0.019538958,
                             0.028142462,
                             0.02427939,
                             0.023784438,
                             0.019123295,
                             0.020749316,
                             0.021758452,
                             0.019803636,
                             0.021328928,
                             0.017942104,
                             0.9904613,
                             0.01988985,
                             0.018255679,
                             0.018969735,
                             0.027316943,
                             0.3524462,
                             0.035938676]},
 'spectra_realgan': {'cosine': [0.9670779,
                                0.9860742,
                                0.9780557,
                                0.9857626,
                                0.99513227,
                                0.99904984,
                                0.99333405,
                                0.9958082,
                                0.9978229,
                                0.99878514,
                                0.9966868,
                                0.9971191,
                                0.9985223,
                                0.9972569,
                                0.9988717,
                                -0.6445146,
                                0.9986887,
                                0.9994831,
                                0.9991611,
                                0.9950985,
                                0.006207302,
                                0.9879399],
                     'mae': [0.03637814,
                             0.046589766,
                             0.03425802,
                             0.03552701,
                             0.019814102,
                             0.015101435,
                             0.021917794,
                             0.018824117,
                             0.018703604,
                             0.014546579,
                             0.015915817,
                             0.017371293,
                             0.0155577045,
                             0.016533121,
                             0.014031357,
                             0.95868224,
                             0.01574497,
                             0.014390489,
                             0.014926638,
                             0.022162864,
                             0.34483668,
                             0.029416412],
                     'max_mae': 0.95868224,
                     'max_mse': 0.98101974,
                     'max_rmse': 0.9904644,
                     'median_mae': 0.01876386,
                     'min_cosine': -0.6445146,
                     'mse': [0.0018786273,
                             0.0031433476,
                             0.0020680986,
                             0.0019107215,
                             0.00067015,
                             0.00038198946,
                             0.0007927825,
                             0.0005900739,
                             0.0005667459,
                             0.00036588756,
                             0.00043069333,
                             0.00047388877,
                             0.0003922546,
                             0.00045585565,
                             0.0003220015,
                             0.98101974,
                             0.00039590697,
                             0.0003332663,
                             0.00035991854,
                             0.0007465517,
                             0.124218725,
                             0.0013407627],
                     'rmse': [0.043343134,
                              0.056065563,
                              0.04547635,
                              0.0437118,
                              0.025887255,
                              0.019544551,
                              0.028156394,
                              0.024291437,
                              0.023806425,
                              0.019128188,
                              0.020753153,
                              0.021768987,
                              0.019805418,
                              0.021350777,
                              0.0179444,
                              0.9904644,
                              0.01989741,
                              0.018255582,
                              0.01897152,
                              0.027323099,
                              0.35244676,
                              0.036616426]},
 'spectra_realpca': {'cosine': [0.9998581,
                                0.9992946,
                                0.9996199,
                                0.9986725,
                                0.9999928,
                                0.9999997,
                                0.99999774,
                                0.999999,
                                0.999998,
                                0.9999996,
                                0.99999905,
                                0.99999726,
                                0.99999964,
                                0.99999636,
                                0.99999994,
                                0.9999997,
                                0.9999994,
                                0.9999998,
                                0.9999999,
                                0.99999803,
                                0.9999978,
                                0.9994996],
                     'mae': [0.0022378603,
                             0.008075121,
                             0.004281849,
                             0.00886711,
                             0.0007123677,
                             0.0002832401,
                             0.0004175068,
                             0.00028044585,
                             0.00052264426,
                             0.00023188791,
                             0.00027005482,
                             0.00052541046,
                             0.00024132505,
                             0.00059439393,
                             0.00017595556,
                             0.00023314274,
                             0.0003163601,
                             0.00015912512,
                             0.00019701314,
                             0.00042167926,
                             0.00037429237,
                             0.005429495],
                     'max_mae': 0.00886711,
                     'max_mse': 0.00012487413,
                     'max_rmse': 0.01117471,
                     'median_mae': 0.00039589958,
                     'min_cosine': 0.9986725,
                     'mse': [8.221756e-06,
                             0.000108600354,
                             2.9754805e-05,
                             0.00012487413,
                             8.224146e-07,
                             1.2940806e-07,
                             2.7858712e-07,
                             1.2632978e-07,
                             4.3618056e-07,
                             8.5994195e-08,
                             1.1790118e-07,
                             4.4286736e-07,
                             9.41157e-08,
                             5.769165e-07,
                             4.976692e-08,
                             8.865936e-08,
                             1.601524e-07,
                             4.1157424e-08,
                             6.241447e-08,
                             2.9112343e-07,
                             2.2700138e-07,
                             4.7179274e-05],
                     'rmse': [0.0028673604,
                              0.010421149,
                              0.0054547964,
                              0.01117471,
                              0.00090687076,
                              0.00035973333,
                              0.0005278135,
                              0.00035542902,
                              0.00066043966,
                              0.00029324766,
                              0.0003433674,
                              0.0006654828,
                              0.0003067828,
                              0.0007595502,
                              0.00022308501,
                              0.00029775721,
                              0.00040019045,
                              0.00020287292,
                              0.00024982888,
                              0.00053955853,
                              0.0004764466,
                              0.0068687173]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_95.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809
Directory path: experiments/inpainting/gann_4_night_20180901_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_95.0/images
Optimal number of principal components:  51
Reconstruction error:  1.5402524
Energy conservation:  0.95362484
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_95.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9130967822707543, 1.492520991862025],
                   'kl_div': 1.7830817,
                   'ks_tests': {10000: KstestResult(statistic=0.3936, pvalue=0.0, statistic_location=-0.0017659008, statistic_sign=-1),
                                20000: KstestResult(statistic=0.389, pvalue=0.0, statistic_location=-0.0019570757, statistic_sign=-1),
                                30000: KstestResult(statistic=0.3877333333333333, pvalue=0.0, statistic_location=-0.0017767902, statistic_sign=-1),
                                40000: KstestResult(statistic=0.38972500000000004, pvalue=0.0, statistic_location=-0.0016568657, statistic_sign=-1),
                                50000: KstestResult(statistic=0.39264, pvalue=0.0, statistic_location=-0.0017375499, statistic_sign=-1),
                                60000: KstestResult(statistic=0.3924, pvalue=0.0, statistic_location=-0.0017662956, statistic_sign=-1),
                                70000: KstestResult(statistic=0.38994285714285715, pvalue=0.0, statistic_location=-0.0017580697, statistic_sign=-1),
                                80000: KstestResult(statistic=0.39357499999999995, pvalue=0.0, statistic_location=-0.0016748449, statistic_sign=-1),
                                90000: KstestResult(statistic=0.39061111111111113, pvalue=0.0, statistic_location=-0.0017020409, statistic_sign=-1),
                                100000: KstestResult(statistic=0.39564, pvalue=0.0, statistic_location=-0.0017908113, statistic_sign=-1),
                                110000: KstestResult(statistic=0.39188181818181816, pvalue=0.0, statistic_location=-0.0017350707, statistic_sign=-1),
                                120000: KstestResult(statistic=0.39080000000000004, pvalue=0.0, statistic_location=-0.0017329331, statistic_sign=-1),
                                130000: KstestResult(statistic=0.39144615384615383, pvalue=0.0, statistic_location=-0.0017717257, statistic_sign=-1),
                                140000: KstestResult(statistic=0.39039999999999997, pvalue=0.0, statistic_location=-0.0017094323, statistic_sign=-1),
                                150000: KstestResult(statistic=0.39438666666666666, pvalue=0.0, statistic_location=-0.001728246, statistic_sign=-1),
                                160000: KstestResult(statistic=0.39229375, pvalue=0.0, statistic_location=-0.0017370069, statistic_sign=-1),
                                170000: KstestResult(statistic=0.3900470588235294, pvalue=0.0, statistic_location=-0.0017610667, statistic_sign=-1),
                                180000: KstestResult(statistic=0.3885555555555556, pvalue=0.0, statistic_location=-0.0016631586, statistic_sign=-1),
                                190000: KstestResult(statistic=0.39202105263157894, pvalue=0.0, statistic_location=-0.0017682235, statistic_sign=-1),
                                200000: KstestResult(statistic=0.39149999999999996, pvalue=0.0, statistic_location=-0.0017095022, statistic_sign=-1),
                                210000: KstestResult(statistic=0.3928666666666667, pvalue=0.0, statistic_location=-0.0017655017, statistic_sign=-1),
                                220000: KstestResult(statistic=0.3892227272727273, pvalue=0.0, statistic_location=-0.0018268861, statistic_sign=-1),
                                230000: KstestResult(statistic=0.39460434782608694, pvalue=0.0, statistic_location=-0.0017083883, statistic_sign=-1),
                                240000: KstestResult(statistic=0.3913916666666667, pvalue=0.0, statistic_location=-0.0017609634, statistic_sign=-1),
                                250000: KstestResult(statistic=0.39435200000000004, pvalue=0.0, statistic_location=-0.0017612223, statistic_sign=-1),
                                260000: KstestResult(statistic=0.3918576923076923, pvalue=0.0, statistic_location=-0.0019615404, statistic_sign=-1),
                                270000: KstestResult(statistic=0.389437037037037, pvalue=0.0, statistic_location=-0.0017617904, statistic_sign=-1),
                                280000: KstestResult(statistic=0.391575, pvalue=0.0, statistic_location=-0.0017409483, statistic_sign=-1),
                                290000: KstestResult(statistic=0.39125862068965517, pvalue=0.0, statistic_location=-0.001761768, statistic_sign=-1),
                                300000: KstestResult(statistic=0.38993, pvalue=0.0, statistic_location=-0.0017620847, statistic_sign=-1),
                                310000: KstestResult(statistic=0.39040322580645165, pvalue=0.0, statistic_location=-0.0017091166, statistic_sign=-1),
                                320000: KstestResult(statistic=0.3898875, pvalue=0.0, statistic_location=-0.001761429, statistic_sign=-1),
                                330000: KstestResult(statistic=0.39, pvalue=0.0, statistic_location=-0.0017092563, statistic_sign=-1)},
                   'moments': {'mean_error': -0.1698854,
                               'means': [-0.00039741758, -1.4375369e-06],
                               'stds': [0.018622587, 0.0014858374],
                               'variance_ratio': 216.70345}},
 'originals': {'gan': {'mae': 0.0611078180372715,
                       'mse': 0.034383539110422134,
                       'psnr': 19.85433006286621,
                       'rmse': 0.18542799353599548,
                       'ssim': 0.6147010922431946},
               'pca': {'mae': 0.0017091113841161132,
                       'mse': 1.381338279315969e-05,
                       'psnr': 54.08895492553711,
                       'rmse': 0.0037166359834372997,
                       'ssim': 0.9995138645172119}},
 'reconstructions': {'mae': 0.06100045144557953,
                     'mse': 0.034370239824056625,
                     'psnr': 20.130130767822266,
                     'rmse': 0.1853921264410019,
                     'ssim': 0.6150292158126831},
 'residual_spectra_pcagan': {'cosine': [0.03585179,
                                        0.063941434,
                                        0.07018559,
                                        0.07230829,
                                        0.09351827,
                                        0.058365796,
                                        0.11323645,
                                        0.23920602,
                                        0.111578144,
                                        0.2324259,
                                        0.03786064,
                                        0.01536541,
                                        0.004099174,
                                        0.034391038,
                                        0.03354937,
                                        0.021839973,
                                        0.008199282,
                                        0.026913451,
                                        -0.0008561786,
                                        0.035279535,
                                        0.013033564,
                                        0.0094268555,
                                        0.02224245,
                                        0.0050285836,
                                        0.011330671,
                                        0.01333947,
                                        0.003372612,
                                        0.20072971,
                                        0.21826449,
                                        0.028860033,
                                        0.016699415,
                                        0.017630894,
                                        0.0013575406],
                             'mae': [0.009855494,
                                     0.009016271,
                                     0.009480415,
                                     0.009300197,
                                     0.009020217,
                                     0.011093252,
                                     0.010202256,
                                     0.010715626,
                                     0.011419794,
                                     0.01116836,
                                     0.010856736,
                                     0.01078965,
                                     0.011582543,
                                     0.009605031,
                                     0.010410231,
                                     0.010206712,
                                     0.009129078,
                                     0.009996349,
                                     0.009824406,
                                     0.009669074,
                                     0.009310913,
                                     0.02585802,
                                     0.010330246,
                                     0.012583507,
                                     0.010985994,
                                     0.010771784,
                                     0.011165483,
                                     0.00876746,
                                     0.009882877,
                                     0.011975278,
                                     0.011194551,
                                     0.011572946,
                                     0.010044301],
                             'max_mae': 0.02585802,
                             'max_mse': 0.0033108878,
                             'max_rmse': 0.057540316,
                             'median_distance': 1.529518,
                             'median_mae': 0.010330246,
                             'min_cosine': -0.0008561786,
                             'mse': [0.00023431699,
                                     0.00017478789,
                                     0.00023316173,
                                     0.00018589004,
                                     0.00016745657,
                                     0.000350831,
                                     0.00020342524,
                                     0.00029593814,
                                     0.00047315445,
                                     0.0003381454,
                                     0.00028789998,
                                     0.00024522768,
                                     0.00035981223,
                                     0.00019695058,
                                     0.00022738917,
                                     0.00024176245,
                                     0.0001846266,
                                     0.00019393694,
                                     0.00018365598,
                                     0.00019251586,
                                     0.00016864235,
                                     0.0033108878,
                                     0.00020230777,
                                     0.00031604696,
                                     0.00022876397,
                                     0.00023394251,
                                     0.00030297154,
                                     0.00016806777,
                                     0.00024603863,
                                     0.000463479,
                                     0.00027962646,
                                     0.00027310586,
                                     0.0002126281],
                             'rmse': [0.015307416,
                                      0.013220737,
                                      0.015269634,
                                      0.01363415,
                                      0.012940501,
                                      0.018730482,
                                      0.014262722,
                                      0.017202852,
                                      0.021752113,
                                      0.01838873,
                                      0.016967615,
                                      0.015659748,
                                      0.018968716,
                                      0.014033908,
                                      0.015079428,
                                      0.015548713,
                                      0.0135877365,
                                      0.013926124,
                                      0.013551974,
                                      0.013875009,
                                      0.012986237,
                                      0.057540316,
                                      0.014223494,
                                      0.01777771,
                                      0.015124945,
                                      0.01529518,
                                      0.017406078,
                                      0.012964095,
                                      0.015685618,
                                      0.021528563,
                                      0.016722035,
                                      0.016525915,
                                      0.014581773]},
 'residuals': {'mae': 0.010841970331966877,
               'mse': 0.00034476950531825423,
               'psnr': 13.540267944335938,
               'rmse': 0.018567970022559166,
               'ssds': [114.495995, 0.72854364],
               'ssim': 0.6028302311897278},
 'spectra_pcagan': {'cosine': [0.98121166,
                               0.97934574,
                               0.98343486,
                               0.98586464,
                               0.9816526,
                               0.98173136,
                               0.9671709,
                               0.9871407,
                               0.97917825,
                               0.9872971,
                               0.99520075,
                               0.9990497,
                               0.9932613,
                               0.9957675,
                               0.99785167,
                               0.99877155,
                               0.9965661,
                               0.99711657,
                               0.9984997,
                               0.9972119,
                               0.99882424,
                               -0.6458993,
                               0.9986549,
                               0.99946666,
                               0.99916714,
                               0.99485654,
                               0.007379704,
                               0.98836297,
                               0.9790618,
                               0.97274333,
                               0.9995058,
                               0.9981992,
                               0.9990261],
                    'mae': [0.025483048,
                            0.028154597,
                            0.023887087,
                            0.02433311,
                            0.026378475,
                            0.02752708,
                            0.03643465,
                            0.046083376,
                            0.033723567,
                            0.03450915,
                            0.019386549,
                            0.015152073,
                            0.021998659,
                            0.018848002,
                            0.018532455,
                            0.014661975,
                            0.01605605,
                            0.017303327,
                            0.015699407,
                            0.016613176,
                            0.014272699,
                            0.9591996,
                            0.015908215,
                            0.014692775,
                            0.014897201,
                            0.022585463,
                            0.34435302,
                            0.029185053,
                            0.037242457,
                            0.032520086,
                            0.014724506,
                            0.017950254,
                            0.014717551],
                    'max_mae': 0.9591996,
                    'max_mse': 0.98148584,
                    'max_rmse': 0.99069965,
                    'median_mae': 0.021998659,
                    'min_cosine': -0.6458993,
                    'mse': [0.001074849,
                            0.0011894335,
                            0.0009765262,
                            0.0009324754,
                            0.0010542059,
                            0.0012722795,
                            0.0018744268,
                            0.00303074,
                            0.0020000744,
                            0.0018083176,
                            0.00063768873,
                            0.00038135692,
                            0.00079983624,
                            0.0005901182,
                            0.0005556999,
                            0.00037114386,
                            0.0004429389,
                            0.00047033443,
                            0.00039812006,
                            0.0004634553,
                            0.00033565296,
                            0.98148584,
                            0.00040714245,
                            0.0003458275,
                            0.0003592223,
                            0.000776131,
                            0.12383653,
                            0.001309758,
                            0.0021105132,
                            0.0016908371,
                            0.0003607891,
                            0.00051219476,
                            0.0003635321],
                    'rmse': [0.03278489,
                             0.034488164,
                             0.031249419,
                             0.03053646,
                             0.03246854,
                             0.03566903,
                             0.043294653,
                             0.055052157,
                             0.044722192,
                             0.04252432,
                             0.025252499,
                             0.019528361,
                             0.028281376,
                             0.024292348,
                             0.023573289,
                             0.019265095,
                             0.021046113,
                             0.021687195,
                             0.019952945,
                             0.021528011,
                             0.018320834,
                             0.99069965,
                             0.02017777,
                             0.018596437,
                             0.018953161,
                             0.027859127,
                             0.35190415,
                             0.03619058,
                             0.04594032,
                             0.041119788,
                             0.018994449,
                             0.02263172,
                             0.019066518]},
 'spectra_realgan': {'cosine': [0.981164,
                                0.97929037,
                                0.98324585,
                                0.98577976,
                                0.98146766,
                                0.9815613,
                                0.96684134,
                                0.9864014,
                                0.9788393,
                                0.9860043,
                                0.9951914,
                                0.9990496,
                                0.99325395,
                                0.99576366,
                                0.9978477,
                                0.99877113,
                                0.99656516,
                                0.9971139,
                                0.9984994,
                                0.99720556,
                                0.9988238,
                                -0.6459042,
                                0.99865395,
                                0.9994668,
                                0.99916726,
                                0.99485415,
                                0.007388013,
                                0.98786664,
                                0.9783934,
                                0.9726016,
                                0.9995058,
                                0.9981981,
                                0.9990261],
                     'mae': [0.025522942,
                             0.028190449,
                             0.024054063,
                             0.024406066,
                             0.026515204,
                             0.02765656,
                             0.036609575,
                             0.04644783,
                             0.033958923,
                             0.035577286,
                             0.019405775,
                             0.015161347,
                             0.02201599,
                             0.018857313,
                             0.018548694,
                             0.014666638,
                             0.016057834,
                             0.017318562,
                             0.015701016,
                             0.016630556,
                             0.014273239,
                             0.95920235,
                             0.015915671,
                             0.014694328,
                             0.014899036,
                             0.022593604,
                             0.34435415,
                             0.029696893,
                             0.03761046,
                             0.032620125,
                             0.014728008,
                             0.017950103,
                             0.014717325],
                     'max_mae': 0.95920235,
                     'max_mse': 0.9814919,
                     'max_rmse': 0.99070275,
                     'median_mae': 0.02201599,
                     'min_cosine': -0.6459042,
                     'mse': [0.0010776084,
                             0.0011927203,
                             0.0009870973,
                             0.00093792763,
                             0.0010650442,
                             0.0012817201,
                             0.0018940727,
                             0.0031226245,
                             0.0020291572,
                             0.0019350208,
                             0.0006385478,
                             0.0003815751,
                             0.0008006527,
                             0.0005906587,
                             0.0005567589,
                             0.00037130978,
                             0.0004430792,
                             0.00047080126,
                             0.00039820815,
                             0.00046431794,
                             0.0003357361,
                             0.9814919,
                             0.00040745607,
                             0.00034584003,
                             0.00035928815,
                             0.00077649223,
                             0.12383691,
                             0.0013584505,
                             0.0021697725,
                             0.0016991085,
                             0.000360817,
                             0.0005125347,
                             0.00036351505],
                     'rmse': [0.032826945,
                              0.03453578,
                              0.031418104,
                              0.030625604,
                              0.032635015,
                              0.03580112,
                              0.043520946,
                              0.05588045,
                              0.04504617,
                              0.043988872,
                              0.025269505,
                              0.019533947,
                              0.028295808,
                              0.02430347,
                              0.02359574,
                              0.0192694,
                              0.021049445,
                              0.021697955,
                              0.019955155,
                              0.021548038,
                              0.018323103,
                              0.99070275,
                              0.020185541,
                              0.018596774,
                              0.018954897,
                              0.027865611,
                              0.3519047,
                              0.036857165,
                              0.046580818,
                              0.041220244,
                              0.018995184,
                              0.02263923,
                              0.019066071]},
 'spectra_realpca': {'cosine': [0.99995905,
                                0.99993515,
                                0.99981934,
                                0.99995714,
                                0.99984926,
                                0.99977374,
                                0.9998581,
                                0.9992946,
                                0.9996199,
                                0.9986725,
                                0.9999928,
                                0.9999997,
                                0.99999774,
                                0.999999,
                                0.999998,
                                0.9999996,
                                0.99999905,
                                0.99999726,
                                0.99999964,
                                0.99999636,
                                0.99999994,
                                0.9999997,
                                0.9999994,
                                0.9999998,
                                0.9999999,
                                0.99999803,
                                0.9999978,
                                0.9994996,
                                0.9991058,
                                0.99992865,
                                0.9999999,
                                0.99999905,
                                0.99999976],
                     'mae': [0.0012029287,
                             0.0015238335,
                             0.0025168916,
                             0.0012858681,
                             0.0023233534,
                             0.002917764,
                             0.0022378603,
                             0.008075121,
                             0.004281849,
                             0.00886711,
                             0.0007123677,
                             0.0002832401,
                             0.0004175068,
                             0.00028044585,
                             0.00052264426,
                             0.00023188791,
                             0.00027005482,
                             0.00052541046,
                             0.00024132505,
                             0.00059439393,
                             0.00017595556,
                             0.00023314274,
                             0.0003163601,
                             0.00015912512,
                             0.00019701314,
                             0.00042167926,
                             0.00037429237,
                             0.005429495,
                             0.0073917047,
                             0.0016190106,
                             0.00017332232,
                             0.00040187678,
                             0.00019584392],
                     'max_mae': 0.00886711,
                     'max_mse': 0.00012487413,
                     'max_rmse': 0.01117471,
                     'median_mae': 0.00052264426,
                     'min_cosine': 0.9986725,
                     'mse': [2.3274672e-06,
                             3.7451443e-06,
                             1.0288597e-05,
                             2.6520654e-06,
                             8.691287e-06,
                             1.376847e-05,
                             8.221756e-06,
                             0.000108600354,
                             2.9754805e-05,
                             0.00012487413,
                             8.224146e-07,
                             1.2940806e-07,
                             2.7858712e-07,
                             1.2632978e-07,
                             4.3618056e-07,
                             8.5994195e-08,
                             1.1790118e-07,
                             4.4286736e-07,
                             9.41157e-08,
                             5.769165e-07,
                             4.976692e-08,
                             8.865936e-08,
                             1.601524e-07,
                             4.1157424e-08,
                             6.241447e-08,
                             2.9112343e-07,
                             2.2700138e-07,
                             4.7179274e-05,
                             8.710284e-05,
                             4.231538e-06,
                             4.804182e-08,
                             2.630531e-07,
                             6.1744885e-08],
                     'rmse': [0.0015256039,
                              0.0019352376,
                              0.0032075844,
                              0.0016285164,
                              0.0029480988,
                              0.003710589,
                              0.0028673604,
                              0.010421149,
                              0.0054547964,
                              0.01117471,
                              0.00090687076,
                              0.00035973333,
                              0.0005278135,
                              0.00035542902,
                              0.00066043966,
                              0.00029324766,
                              0.0003433674,
                              0.0006654828,
                              0.0003067828,
                              0.0007595502,
                              0.00022308501,
                              0.00029775721,
                              0.00040019045,
                              0.00020287292,
                              0.00024982888,
                              0.00053955853,
                              0.0004764466,
                              0.0068687173,
                              0.009332891,
                              0.0020570701,
                              0.00021918444,
                              0.000512887,
                              0.0002484852]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_95.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521
Directory path: experiments/inpainting/gann_4_night_20180904_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_95.0/images
Optimal number of principal components:  51
Reconstruction error:  1.1917074
Energy conservation:  0.95126605
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_95.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9519870688369956, 0.6931396815329358],
                   'kl_div': 2.655196,
                   'ks_tests': {10000: KstestResult(statistic=0.526, pvalue=0.0, statistic_location=0.00039008074, statistic_sign=1),
                                20000: KstestResult(statistic=0.5427, pvalue=0.0, statistic_location=0.00044761866, statistic_sign=1),
                                30000: KstestResult(statistic=0.5303333333333333, pvalue=0.0, statistic_location=0.0004205727, statistic_sign=1),
                                40000: KstestResult(statistic=0.5322499999999999, pvalue=0.0, statistic_location=0.00044625904, statistic_sign=1),
                                50000: KstestResult(statistic=0.5308, pvalue=0.0, statistic_location=0.00044604763, statistic_sign=1),
                                60000: KstestResult(statistic=0.5332000000000001, pvalue=0.0, statistic_location=0.00043031247, statistic_sign=1),
                                70000: KstestResult(statistic=0.5347, pvalue=0.0, statistic_location=0.00045015663, statistic_sign=1),
                                80000: KstestResult(statistic=0.53215, pvalue=0.0, statistic_location=0.0004329388, statistic_sign=1),
                                90000: KstestResult(statistic=0.5318555555555555, pvalue=0.0, statistic_location=0.00044625904, statistic_sign=1),
                                100000: KstestResult(statistic=0.53496, pvalue=0.0, statistic_location=0.00043033436, statistic_sign=1),
                                110000: KstestResult(statistic=0.534309090909091, pvalue=0.0, statistic_location=0.00044830958, statistic_sign=1)},
                   'moments': {'mean_error': 10.45875,
                               'means': [0.00041185232, 2.7084033e-07],
                               'stds': [0.018056862, 0.00012689813],
                               'variance_ratio': 22256.207}},
 'originals': {'gan': {'mae': 0.01545791421085596,
                       'mse': 0.00040660909144207835,
                       'psnr': 33.483253479003906,
                       'rmse': 0.020164551213383675,
                       'ssim': 0.9744042158126831},
               'pca': {'mae': 0.00013682183634955436,
                       'mse': 3.5089090744122586e-08,
                       'psnr': 74.54827117919922,
                       'rmse': 0.00018732082389760762,
                       'ssim': 0.9999978542327881}},
 'reconstructions': {'mae': 0.015456825494766235,
                     'mse': 0.0004065643879584968,
                     'psnr': 33.90870666503906,
                     'rmse': 0.020163441076874733,
                     'ssim': 0.9744048714637756},
 'residual_spectra_pcagan': {'cosine': [0.010992865,
                                        0.020192338,
                                        0.0018220906,
                                        0.014371705,
                                        -0.008819309,
                                        -0.0005590725,
                                        0.0037200667,
                                        0.027252112,
                                        -0.0028668495,
                                        0.020587627,
                                        3.8874305e-06],
                             'mae': [0.011263388,
                                     0.013142926,
                                     0.012195418,
                                     0.011826956,
                                     0.013410199,
                                     0.011490147,
                                     0.011104005,
                                     0.010495258,
                                     0.010653327,
                                     0.01040968,
                                     0.010817453],
                             'max_mae': 0.013410199,
                             'max_mse': 0.0005393291,
                             'max_rmse': 0.02322346,
                             'median_distance': 1.7365781,
                             'median_mae': 0.011263388,
                             'min_cosine': -0.008819309,
                             'mse': [0.00026697494,
                                     0.00048516903,
                                     0.000318435,
                                     0.0002933338,
                                     0.0005393291,
                                     0.00030193332,
                                     0.00028559245,
                                     0.00025477156,
                                     0.0003015704,
                                     0.00023583979,
                                     0.0003051492],
                             'rmse': [0.016339367,
                                      0.022026554,
                                      0.017844748,
                                      0.01712699,
                                      0.02322346,
                                      0.01737623,
                                      0.016899481,
                                      0.015961565,
                                      0.017365782,
                                      0.015357076,
                                      0.017468521]},
 'residuals': {'mae': 0.011528068222105503,
               'mse': 0.0003261907841078937,
               'psnr': -20.542879104614258,
               'rmse': 0.018060753121972084,
               'ssds': [35.88386, 0.0017713369],
               'ssim': 0.2911922037601471},
 'spectra_pcagan': {'cosine': [0.99921286,
                               0.99917674,
                               0.9991685,
                               0.9996013,
                               0.9997202,
                               0.9995684,
                               0.99955654,
                               0.999227,
                               0.9983759,
                               0.9985755,
                               0.998126],
                    'mae': [0.016233653,
                            0.016155528,
                            0.01656345,
                            0.0140996035,
                            0.013372295,
                            0.013901307,
                            0.013647342,
                            0.014647202,
                            0.01715405,
                            0.017001105,
                            0.01724956],
                    'max_mae': 0.01724956,
                    'max_mse': 0.0005167101,
                    'max_rmse': 0.022731258,
                    'median_mae': 0.016155528,
                    'min_cosine': 0.998126,
                    'mse': [0.00043042246,
                            0.00046927042,
                            0.00044534102,
                            0.0003167024,
                            0.00032564052,
                            0.00031647846,
                            0.00030633857,
                            0.0003581472,
                            0.0005167101,
                            0.00047737322,
                            0.00050978386],
                    'rmse': [0.020746626,
                             0.02166265,
                             0.021103105,
                             0.017796135,
                             0.018045513,
                             0.01778984,
                             0.01750253,
                             0.018924776,
                             0.022731258,
                             0.021848872,
                             0.022578394]},
 'spectra_realgan': {'cosine': [0.99921274,
                                0.99917674,
                                0.9991684,
                                0.9996012,
                                0.99972034,
                                0.99956834,
                                0.99955654,
                                0.9992268,
                                0.9983757,
                                0.99857503,
                                0.99812603],
                     'mae': [0.016235683,
                             0.01615547,
                             0.016565902,
                             0.014100476,
                             0.013370989,
                             0.013902402,
                             0.013647534,
                             0.014650018,
                             0.01715387,
                             0.01700483,
                             0.017249877],
                     'max_mae': 0.017249877,
                     'max_mse': 0.00051672745,
                     'max_rmse': 0.02273164,
                     'median_mae': 0.01615547,
                     'min_cosine': 0.99812603,
                     'mse': [0.0004304678,
                             0.00046928387,
                             0.00044544568,
                             0.00031675573,
                             0.0003255909,
                             0.0003165255,
                             0.0003063761,
                             0.00035823113,
                             0.00051672745,
                             0.0004775239,
                             0.0005097719],
                     'rmse': [0.020747717,
                              0.021662962,
                              0.021105584,
                              0.017797632,
                              0.018044138,
                              0.017791163,
                              0.017503602,
                              0.018926995,
                              0.02273164,
                              0.02185232,
                              0.02257813]},
 'spectra_realpca': {'cosine': [0.9999998,
                                1.0,
                                0.9999999,
                                1.0,
                                1.0,
                                1.0,
                                1.0,
                                0.99999976,
                                0.99999976,
                                0.9999998,
                                0.9999998],
                     'mae': [0.00019823704,
                             0.00017564652,
                             0.00017863445,
                             9.6460564e-05,
                             4.1578453e-05,
                             5.7707995e-05,
                             6.904956e-05,
                             0.00016952804,
                             0.00017300875,
                             0.00019896885,
                             0.00014622],
                     'max_mae': 0.00019896885,
                     'max_mse': 6.342619e-08,
                     'max_rmse': 0.00025184557,
                     'median_mae': 0.00016952804,
                     'min_cosine': 0.99999976,
                     'mse': [6.324365e-08,
                             4.9465925e-08,
                             5.1262585e-08,
                             1.4911942e-08,
                             2.76331e-09,
                             5.361779e-09,
                             7.58824e-09,
                             4.5754472e-08,
                             4.8072142e-08,
                             6.342619e-08,
                             3.412976e-08],
                     'rmse': [0.00025148288,
                              0.00022240936,
                              0.00022641242,
                              0.00012211446,
                              5.2567197e-05,
                              7.322417e-05,
                              8.711051e-05,
                              0.00021390295,
                              0.0002192536,
                              0.00025184557,
                              0.00018474241]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_95.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743
Directory path: experiments/inpainting/gann_4_night_20180904_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_95.0/images
Optimal number of principal components:  51
Reconstruction error:  1.1917074
Energy conservation:  0.95126605
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_95.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9538435048012626, 0.6941033480862293],
                   'kl_div': 2.6245797,
                   'ks_tests': {10000: KstestResult(statistic=0.4892, pvalue=0.0, statistic_location=0.0005455788, statistic_sign=1),
                                20000: KstestResult(statistic=0.48455000000000004, pvalue=0.0, statistic_location=0.0005354881, statistic_sign=1),
                                30000: KstestResult(statistic=0.486, pvalue=0.0, statistic_location=0.00053980364, statistic_sign=1),
                                40000: KstestResult(statistic=0.4887499999999999, pvalue=0.0, statistic_location=0.00054521096, statistic_sign=1),
                                50000: KstestResult(statistic=0.4856600000000001, pvalue=0.0, statistic_location=0.00054015266, statistic_sign=1),
                                60000: KstestResult(statistic=0.4825166666666667, pvalue=0.0, statistic_location=0.00053040823, statistic_sign=1),
                                70000: KstestResult(statistic=0.48447142857142855, pvalue=0.0, statistic_location=0.00053960364, statistic_sign=1),
                                80000: KstestResult(statistic=0.48526250000000004, pvalue=0.0, statistic_location=0.00054521766, statistic_sign=1),
                                90000: KstestResult(statistic=0.4873666666666667, pvalue=0.0, statistic_location=0.00054376666, statistic_sign=1),
                                100000: KstestResult(statistic=0.48501000000000005, pvalue=0.0, statistic_location=0.0005919542, statistic_sign=1),
                                110000: KstestResult(statistic=0.48609090909090913, pvalue=0.0, statistic_location=0.0005385941, statistic_sign=1),
                                120000: KstestResult(statistic=0.486175, pvalue=0.0, statistic_location=0.00054250925, statistic_sign=1),
                                130000: KstestResult(statistic=0.48233076923076923, pvalue=0.0, statistic_location=0.0005331142, statistic_sign=1),
                                140000: KstestResult(statistic=0.48496428571428574, pvalue=0.0, statistic_location=0.00053889304, statistic_sign=1),
                                150000: KstestResult(statistic=0.48507333333333336, pvalue=0.0, statistic_location=0.00053980364, statistic_sign=1),
                                160000: KstestResult(statistic=0.4842937500000001, pvalue=0.0, statistic_location=0.00054250925, statistic_sign=1),
                                170000: KstestResult(statistic=0.48530000000000006, pvalue=0.0, statistic_location=0.00053455494, statistic_sign=1),
                                180000: KstestResult(statistic=0.48400555555555547, pvalue=0.0, statistic_location=0.00053960364, statistic_sign=1),
                                190000: KstestResult(statistic=0.48541578947368424, pvalue=0.0, statistic_location=0.00053980364, statistic_sign=1),
                                200000: KstestResult(statistic=0.48438000000000003, pvalue=0.0, statistic_location=0.00052121934, statistic_sign=1),
                                210000: KstestResult(statistic=0.4846904761904762, pvalue=0.0, statistic_location=0.00053963996, statistic_sign=1),
                                220000: KstestResult(statistic=0.4864136363636363, pvalue=0.0, statistic_location=0.00054799113, statistic_sign=1)},
                   'moments': {'mean_error': 1.2894657,
                               'means': [-0.00020164356, 1.2396582e-06],
                               'stds': [0.016210506, 0.00016284874],
                               'variance_ratio': 12182.551}},
 'originals': {'gan': {'mae': 0.022804737091064453,
                       'mse': 0.0012680693762376904,
                       'psnr': 29.031414031982422,
                       'rmse': 0.03560996055603027,
                       'ssim': 0.9156926870346069},
               'pca': {'mae': 0.00020493974443525076,
                       'mse': 8.722057032173325e-08,
                       'psnr': 71.05040740966797,
                       'rmse': 0.000295331294182688,
                       'ssim': 0.9999960660934448}},
 'reconstructions': {'mae': 0.02280118502676487,
                     'mse': 0.0012678415514528751,
                     'psnr': 29.42595100402832,
                     'rmse': 0.03560676425695419,
                     'ssim': 0.9156870245933533},
 'residual_spectra_pcagan': {'cosine': [0.0059667225,
                                        0.019448891,
                                        -0.0036171486,
                                        0.008105757,
                                        0.007024512,
                                        -0.0011815813,
                                        0.03013875,
                                        0.008268755,
                                        0.020426724,
                                        0.00014992744,
                                        0.0043868106,
                                        -0.0118784895,
                                        0.028607463,
                                        0.0025666466,
                                        0.011783858,
                                        0.012787553,
                                        0.004046263,
                                        0.00015021747,
                                        0.048441645,
                                        0.02151231,
                                        0.01104267,
                                        0.02051532],
                             'mae': [0.009668035,
                                     0.010212487,
                                     0.011322468,
                                     0.011760692,
                                     0.011314659,
                                     0.01061958,
                                     0.012190326,
                                     0.010810509,
                                     0.011548697,
                                     0.012161273,
                                     0.010563321,
                                     0.011267672,
                                     0.009854451,
                                     0.011249562,
                                     0.012053976,
                                     0.010770272,
                                     0.010354955,
                                     0.010939521,
                                     0.009418667,
                                     0.00948177,
                                     0.011059652,
                                     0.010234976],
                             'max_mae': 0.012190326,
                             'max_mse': 0.00036574842,
                             'max_rmse': 0.01912455,
                             'median_distance': 1.5913154,
                             'median_mae': 0.010875015,
                             'min_cosine': -0.0118784895,
                             'mse': [0.00019343288,
                                     0.00024677505,
                                     0.00033690676,
                                     0.0002720111,
                                     0.00029870268,
                                     0.00022136481,
                                     0.0003564017,
                                     0.00023342343,
                                     0.00026222414,
                                     0.000345743,
                                     0.00023086638,
                                     0.00025209098,
                                     0.00019074252,
                                     0.00036574842,
                                     0.00029340587,
                                     0.00025575093,
                                     0.00022154291,
                                     0.0002517506,
                                     0.00017005434,
                                     0.0001868325,
                                     0.0003411286,
                                     0.00025436847],
                             'rmse': [0.013908015,
                                      0.015709076,
                                      0.01835502,
                                      0.016492758,
                                      0.017283017,
                                      0.014878334,
                                      0.018878603,
                                      0.015278202,
                                      0.016193336,
                                      0.018594166,
                                      0.0151942875,
                                      0.015877374,
                                      0.013810957,
                                      0.01912455,
                                      0.017129093,
                                      0.015992215,
                                      0.014884317,
                                      0.01586665,
                                      0.013040489,
                                      0.013668668,
                                      0.018469667,
                                      0.015948933]},
 'residuals': {'mae': 0.01085715927183628,
               'mse': 0.00026278491714037955,
               'psnr': -15.839312553405762,
               'rmse': 0.016210641711950302,
               'ssds': [57.820404, 0.005834648],
               'ssim': 0.33437153697013855},
 'spectra_pcagan': {'cosine': [0.9987402,
                               0.9989253,
                               0.9988634,
                               0.9995552,
                               0.9990178,
                               0.9992795,
                               0.99923646,
                               0.9992915,
                               0.99960256,
                               0.9997594,
                               0.9996037,
                               0.99952215,
                               0.99922127,
                               0.9980587,
                               0.9976152,
                               0.99797726,
                               0.96668714,
                               0.99495894,
                               0.98433524,
                               0.9879654,
                               0.9952609,
                               0.98988485],
                    'mae': [0.01676485,
                            0.017768765,
                            0.017114982,
                            0.013837571,
                            0.016757589,
                            0.015727453,
                            0.015651746,
                            0.0157299,
                            0.013696799,
                            0.0118412925,
                            0.012672517,
                            0.0139377285,
                            0.01593448,
                            0.01829549,
                            0.025287006,
                            0.018777886,
                            0.12166016,
                            0.02306221,
                            0.029737359,
                            0.023316775,
                            0.020474559,
                            0.023578925],
                    'max_mae': 0.12166016,
                    'max_mse': 0.01576581,
                    'max_rmse': 0.12556198,
                    'median_mae': 0.016939916,
                    'min_cosine': 0.96668714,
                    'mse': [0.00045434022,
                            0.0005152438,
                            0.0005156811,
                            0.0003145531,
                            0.00046746086,
                            0.0003933608,
                            0.00042597303,
                            0.00039498915,
                            0.00030295757,
                            0.00023688558,
                            0.00027312455,
                            0.0003146903,
                            0.0004139789,
                            0.0006095293,
                            0.001002802,
                            0.00058743294,
                            0.01576581,
                            0.0008938511,
                            0.0013484377,
                            0.0009190216,
                            0.0007945731,
                            0.0009478159],
                    'rmse': [0.021315258,
                             0.022698982,
                             0.022708613,
                             0.017735645,
                             0.021620844,
                             0.019833324,
                             0.020639114,
                             0.019874334,
                             0.017405676,
                             0.015391088,
                             0.01652648,
                             0.017739512,
                             0.020346472,
                             0.024688648,
                             0.03166705,
                             0.024237016,
                             0.12556198,
                             0.029897343,
                             0.03672108,
                             0.03031537,
                             0.028188173,
                             0.030786619]},
 'spectra_realgan': {'cosine': [0.99874026,
                                0.998925,
                                0.9988634,
                                0.9995552,
                                0.99901766,
                                0.9992796,
                                0.9992362,
                                0.99929106,
                                0.9996023,
                                0.9997594,
                                0.99960375,
                                0.99952215,
                                0.999221,
                                0.9980585,
                                0.9976147,
                                0.9979764,
                                0.9666903,
                                0.99495757,
                                0.9843118,
                                0.98795503,
                                0.99525625,
                                0.98986834],
                     'mae': [0.016759194,
                             0.017771685,
                             0.01711368,
                             0.013836631,
                             0.01675953,
                             0.015728213,
                             0.015652657,
                             0.015734455,
                             0.013699593,
                             0.011842468,
                             0.012672553,
                             0.013936571,
                             0.01593477,
                             0.018293846,
                             0.025286539,
                             0.018784618,
                             0.121655606,
                             0.023067566,
                             0.029759774,
                             0.023324125,
                             0.020488558,
                             0.023601586],
                     'max_mae': 0.121655606,
                     'max_mse': 0.01576458,
                     'max_rmse': 0.12555708,
                     'median_mae': 0.016936604,
                     'min_cosine': 0.9666903,
                     'mse': [0.0004542717,
                             0.00051541755,
                             0.00051571685,
                             0.00031454966,
                             0.0004675796,
                             0.00039335707,
                             0.0004261466,
                             0.00039527589,
                             0.00030306508,
                             0.00023689224,
                             0.00027314376,
                             0.00031462498,
                             0.00041400423,
                             0.00060955266,
                             0.0010028669,
                             0.00058770913,
                             0.01576458,
                             0.00089407293,
                             0.0013503262,
                             0.00091981544,
                             0.0007953092,
                             0.0009492488],
                     'rmse': [0.02131365,
                              0.02270281,
                              0.0227094,
                              0.017735548,
                              0.02162359,
                              0.019833231,
                              0.020643318,
                              0.019881546,
                              0.017408764,
                              0.015391304,
                              0.01652706,
                              0.017737672,
                              0.020347094,
                              0.024689121,
                              0.031668074,
                              0.024242712,
                              0.12555708,
                              0.029901052,
                              0.036746785,
                              0.03032846,
                              0.028201226,
                              0.030809881]},
 'spectra_realpca': {'cosine': [0.99999946,
                                0.99999976,
                                1.0,
                                1.0,
                                0.9999999,
                                0.9999998,
                                1.0,
                                0.9999999,
                                1.0,
                                1.0,
                                1.0,
                                1.0,
                                0.99999976,
                                0.99999976,
                                0.9999998,
                                0.9999998,
                                0.99999964,
                                0.9999991,
                                0.99999744,
                                0.9999977,
                                0.99999803,
                                0.9999971],
                     'mae': [0.00030645187,
                             0.00025343048,
                             9.67147e-05,
                             0.000114763905,
                             0.0001296338,
                             0.00019823704,
                             0.00017564652,
                             0.00017863445,
                             9.6460564e-05,
                             4.1578453e-05,
                             5.7707995e-05,
                             6.904956e-05,
                             0.00016952804,
                             0.00017300875,
                             0.00019896885,
                             0.00014622,
                             0.00027150282,
                             0.0003007256,
                             0.00034691778,
                             0.00034095134,
                             0.00043419513,
                             0.00040834647],
                     'max_mae': 0.00043419513,
                     'max_mse': 3.0421458e-07,
                     'max_rmse': 0.0005515565,
                     'median_mae': 0.0001771405,
                     'min_cosine': 0.9999971,
                     'mse': [1.5094466e-07,
                             1.0262056e-07,
                             1.4853382e-08,
                             2.0988136e-08,
                             2.6759578e-08,
                             6.324365e-08,
                             4.9465925e-08,
                             5.1262585e-08,
                             1.4911942e-08,
                             2.76331e-09,
                             5.361779e-09,
                             7.58824e-09,
                             4.5754472e-08,
                             4.8072142e-08,
                             6.342619e-08,
                             3.412976e-08,
                             1.1943013e-07,
                             1.4575527e-07,
                             1.929959e-07,
                             1.8745317e-07,
                             3.0421458e-07,
                             2.668572e-07],
                     'rmse': [0.00038851597,
                              0.00032034444,
                              0.00012187445,
                              0.00014487283,
                              0.00016358355,
                              0.00025148288,
                              0.00022240936,
                              0.00022641242,
                              0.00012211446,
                              5.2567197e-05,
                              7.322417e-05,
                              8.711051e-05,
                              0.00021390295,
                              0.0002192536,
                              0.00025184557,
                              0.00018474241,
                              0.00034558665,
                              0.00038177907,
                              0.00043931298,
                              0.00043295862,
                              0.0005515565,
                              0.0005165822]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_95.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658
Directory path: experiments/inpainting/gann_4_night_20180904_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_95.0/images
Optimal number of principal components:  51
Reconstruction error:  1.1917074
Energy conservation:  0.95126605
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_95.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9187742426194503, 0.6960956762897546],
                   'kl_div': 2.5808334,
                   'ks_tests': {10000: KstestResult(statistic=0.4997, pvalue=0.0, statistic_location=0.0005393503, statistic_sign=1),
                                20000: KstestResult(statistic=0.4871000000000001, pvalue=0.0, statistic_location=0.0005834813, statistic_sign=1),
                                30000: KstestResult(statistic=0.4938, pvalue=0.0, statistic_location=0.00054566143, statistic_sign=1),
                                40000: KstestResult(statistic=0.492675, pvalue=0.0, statistic_location=0.0006166473, statistic_sign=1),
                                50000: KstestResult(statistic=0.493, pvalue=0.0, statistic_location=0.00062225666, statistic_sign=1),
                                60000: KstestResult(statistic=0.4951833333333333, pvalue=0.0, statistic_location=0.0006029303, statistic_sign=1),
                                70000: KstestResult(statistic=0.4955857142857143, pvalue=0.0, statistic_location=0.00059055444, statistic_sign=1),
                                80000: KstestResult(statistic=0.493475, pvalue=0.0, statistic_location=0.00060285255, statistic_sign=1),
                                90000: KstestResult(statistic=0.49368888888888884, pvalue=0.0, statistic_location=0.0006208895, statistic_sign=1),
                                100000: KstestResult(statistic=0.49581000000000003, pvalue=0.0, statistic_location=0.0005855346, statistic_sign=1),
                                110000: KstestResult(statistic=0.4921, pvalue=0.0, statistic_location=0.0005751741, statistic_sign=1),
                                120000: KstestResult(statistic=0.49324999999999997, pvalue=0.0, statistic_location=0.00060448446, statistic_sign=1),
                                130000: KstestResult(statistic=0.49486153846153846, pvalue=0.0, statistic_location=0.0005964893, statistic_sign=1),
                                140000: KstestResult(statistic=0.4932428571428572, pvalue=0.0, statistic_location=0.0005796952, statistic_sign=1),
                                150000: KstestResult(statistic=0.49214666666666673, pvalue=0.0, statistic_location=0.0005966425, statistic_sign=1),
                                160000: KstestResult(statistic=0.49105624999999997, pvalue=0.0, statistic_location=0.00058798445, statistic_sign=1),
                                170000: KstestResult(statistic=0.49283529411764704, pvalue=0.0, statistic_location=0.0005946958, statistic_sign=1),
                                180000: KstestResult(statistic=0.49325555555555556, pvalue=0.0, statistic_location=0.00058736675, statistic_sign=1),
                                190000: KstestResult(statistic=0.4921210526315789, pvalue=0.0, statistic_location=0.00057815434, statistic_sign=1),
                                200000: KstestResult(statistic=0.495325, pvalue=0.0, statistic_location=0.0005581542, statistic_sign=1),
                                210000: KstestResult(statistic=0.4938, pvalue=0.0, statistic_location=0.00058710016, statistic_sign=1),
                                220000: KstestResult(statistic=0.49405909090909095, pvalue=0.0, statistic_location=0.0005998928, statistic_sign=1),
                                230000: KstestResult(statistic=0.4936608695652174, pvalue=0.0, statistic_location=0.0006029303, statistic_sign=1),
                                240000: KstestResult(statistic=0.49530833333333335, pvalue=0.0, statistic_location=0.0006029303, statistic_sign=1),
                                250000: KstestResult(statistic=0.4928800000000001, pvalue=0.0, statistic_location=0.00059112906, statistic_sign=1),
                                260000: KstestResult(statistic=0.49154615384615385, pvalue=0.0, statistic_location=0.00058820564, statistic_sign=1),
                                270000: KstestResult(statistic=0.49349999999999994, pvalue=0.0, statistic_location=0.0006066272, statistic_sign=1),
                                280000: KstestResult(statistic=0.49366071428571423, pvalue=0.0, statistic_location=0.0005917172, statistic_sign=1),
                                290000: KstestResult(statistic=0.4937758620689655, pvalue=0.0, statistic_location=0.00060145, statistic_sign=1),
                                300000: KstestResult(statistic=0.4932633333333333, pvalue=0.0, statistic_location=0.0005873707, statistic_sign=1),
                                310000: KstestResult(statistic=0.49457096774193543, pvalue=0.0, statistic_location=0.0005871053, statistic_sign=1),
                                320000: KstestResult(statistic=0.49292187500000006, pvalue=0.0, statistic_location=0.00059671106, statistic_sign=1),
                                330000: KstestResult(statistic=0.49344242424242424, pvalue=0.0, statistic_location=0.0006029303, statistic_sign=1)},
                   'moments': {'mean_error': 4.076184,
                               'means': [0.00036934364, 1.4081919e-06],
                               'stds': [0.015899327, 0.00018087903],
                               'variance_ratio': 9714.768}},
 'originals': {'gan': {'mae': 0.02468484826385975,
                       'mse': 0.001282560988329351,
                       'psnr': 30.239980697631836,
                       'rmse': 0.0358128622174263,
                       'ssim': 0.9119958281517029},
               'pca': {'mae': 0.0002542067668400705,
                       'mse': 1.3692014988464507e-07,
                       'psnr': 70.5481948852539,
                       'rmse': 0.0003700272354763001,
                       'ssim': 0.9999927282333374}},
 'reconstructions': {'mae': 0.024679621681571007,
                     'mse': 0.0012822404969483614,
                     'psnr': 30.833179473876953,
                     'rmse': 0.03580838441848755,
                     'ssim': 0.9120367169380188},
 'residual_spectra_pcagan': {'cosine': [0.03690625,
                                        0.032309104,
                                        0.029706145,
                                        0.004109062,
                                        0.00032989902,
                                        0.0068125264,
                                        0.00029702325,
                                        0.016366852,
                                        -0.007888379,
                                        0.0029401232,
                                        0.023179354,
                                        0.0075132092,
                                        0.023527745,
                                        0.015012144,
                                        0.026017271,
                                        -0.008625191,
                                        0.0046379007,
                                        0.0029012396,
                                        0.020777535,
                                        0.00052545633,
                                        0.0045449305,
                                        -0.007827249,
                                        0.011069109,
                                        0.0076285275,
                                        0.038408503,
                                        0.020928474,
                                        0.00039430245,
                                        0.012533544,
                                        0.008433496,
                                        -1.0308469e-05,
                                        0.037913855,
                                        0.02779897,
                                        0.0011715945],
                             'mae': [0.010014149,
                                     0.009217286,
                                     0.009583182,
                                     0.009811806,
                                     0.009392817,
                                     0.011169678,
                                     0.010592382,
                                     0.011452649,
                                     0.0123496475,
                                     0.012608891,
                                     0.011024031,
                                     0.011004738,
                                     0.0115030445,
                                     0.0102373455,
                                     0.01136954,
                                     0.011476366,
                                     0.0114462655,
                                     0.010753705,
                                     0.009353646,
                                     0.009798048,
                                     0.008861143,
                                     0.012409726,
                                     0.009965633,
                                     0.010318749,
                                     0.0096416455,
                                     0.009760594,
                                     0.011060416,
                                     0.0092563145,
                                     0.010423345,
                                     0.011337894,
                                     0.010317382,
                                     0.01076218,
                                     0.00929897],
                             'max_mae': 0.012608891,
                             'max_mse': 0.00047244778,
                             'max_rmse': 0.021735864,
                             'median_distance': 1.5480838,
                             'median_mae': 0.010423345,
                             'min_cosine': -0.008625191,
                             'mse': [0.00024157476,
                                     0.00017800694,
                                     0.00021561614,
                                     0.00019946824,
                                     0.00016990861,
                                     0.00030942427,
                                     0.00021803641,
                                     0.000297359,
                                     0.00047244778,
                                     0.00034908377,
                                     0.0002853738,
                                     0.00025784882,
                                     0.000299023,
                                     0.00020270243,
                                     0.00026340038,
                                     0.0002762195,
                                     0.00029061222,
                                     0.00023341585,
                                     0.00016700041,
                                     0.0001863224,
                                     0.00014647491,
                                     0.00037957556,
                                     0.00019991219,
                                     0.00023965638,
                                     0.00018850842,
                                     0.00020411084,
                                     0.00034322162,
                                     0.00017880031,
                                     0.00025457816,
                                     0.00041775807,
                                     0.00026743396,
                                     0.000236377,
                                     0.00017592474],
                             'rmse': [0.015542676,
                                      0.013341924,
                                      0.014683873,
                                      0.014123322,
                                      0.0130349,
                                      0.01759046,
                                      0.014766056,
                                      0.0172441,
                                      0.021735864,
                                      0.018683784,
                                      0.01689301,
                                      0.016057672,
                                      0.017292282,
                                      0.01423736,
                                      0.016229615,
                                      0.016619854,
                                      0.017047353,
                                      0.015277953,
                                      0.012922864,
                                      0.013649996,
                                      0.012102682,
                                      0.019482698,
                                      0.014139031,
                                      0.015480839,
                                      0.013729837,
                                      0.014286736,
                                      0.018526241,
                                      0.013371623,
                                      0.015955506,
                                      0.020439131,
                                      0.016353408,
                                      0.015374557,
                                      0.013263662]},
 'residuals': {'mae': 0.010532520711421967,
               'mse': 0.00025288411416113377,
               'psnr': -14.1535062789917,
               'rmse': 0.015902331098914146,
               'ssds': [83.46498, 0.010797306],
               'ssim': 0.3657946288585663},
 'spectra_pcagan': {'cosine': [0.9814562,
                               0.9844046,
                               0.9814004,
                               0.99869484,
                               0.99876523,
                               0.99869585,
                               0.99827677,
                               0.9986748,
                               0.99838334,
                               0.99947107,
                               0.99905807,
                               0.9991582,
                               0.9993174,
                               0.9992578,
                               0.99959487,
                               0.99976313,
                               0.9995595,
                               0.9995769,
                               0.999222,
                               0.99847835,
                               0.998675,
                               0.9977265,
                               0.96701795,
                               0.9954888,
                               0.984013,
                               0.98092234,
                               0.9940732,
                               0.98902416,
                               0.9749464,
                               0.9770398,
                               0.9866617,
                               0.98371685,
                               0.9820979],
                    'mae': [0.029596798,
                            0.027007464,
                            0.027736027,
                            0.01672405,
                            0.01736146,
                            0.017962858,
                            0.023200873,
                            0.017636737,
                            0.020329654,
                            0.014714707,
                            0.016874209,
                            0.016446378,
                            0.01514773,
                            0.015426923,
                            0.013867807,
                            0.012078018,
                            0.013571184,
                            0.013182169,
                            0.015768204,
                            0.017303117,
                            0.016129544,
                            0.021173725,
                            0.11902517,
                            0.02057226,
                            0.029030094,
                            0.031260505,
                            0.022650266,
                            0.027370954,
                            0.04174179,
                            0.039265145,
                            0.025121948,
                            0.029084466,
                            0.030065427],
                    'max_mae': 0.11902517,
                    'max_mse': 0.015221543,
                    'max_rmse': 0.12337562,
                    'median_mae': 0.020329654,
                    'min_cosine': 0.96701795,
                    'mse': [0.0014222017,
                            0.0011916418,
                            0.0012805348,
                            0.0004700901,
                            0.00048266465,
                            0.0005582257,
                            0.0008049234,
                            0.0005425016,
                            0.00076989195,
                            0.00038417047,
                            0.0004763412,
                            0.00043847307,
                            0.00039243346,
                            0.00039757215,
                            0.00030878797,
                            0.00024371121,
                            0.00030758925,
                            0.00027812662,
                            0.00040911158,
                            0.0004881285,
                            0.0004226036,
                            0.00077105506,
                            0.015221543,
                            0.00073345937,
                            0.0012779748,
                            0.0014523597,
                            0.0009155262,
                            0.0011486163,
                            0.0024369392,
                            0.0025411055,
                            0.001072798,
                            0.0012946466,
                            0.0013781859],
                    'rmse': [0.03771209,
                             0.034520164,
                             0.03578456,
                             0.021681562,
                             0.02196963,
                             0.0236268,
                             0.028371172,
                             0.023291664,
                             0.027746927,
                             0.019600267,
                             0.021825243,
                             0.020939749,
                             0.019809933,
                             0.019939212,
                             0.017572364,
                             0.015611253,
                             0.017538222,
                             0.016677128,
                             0.020226507,
                             0.022093631,
                             0.020557325,
                             0.027767878,
                             0.12337562,
                             0.027082454,
                             0.035748772,
                             0.03810984,
                             0.030257663,
                             0.033891242,
                             0.049365364,
                             0.05040938,
                             0.032753594,
                             0.035981197,
                             0.037123926]},
 'spectra_realgan': {'cosine': [0.9814234,
                                0.98440236,
                                0.98138547,
                                0.99869484,
                                0.9987654,
                                0.9986955,
                                0.99827737,
                                0.99867463,
                                0.99838334,
                                0.9994711,
                                0.9990579,
                                0.9991579,
                                0.9993174,
                                0.9992577,
                                0.99959475,
                                0.99976325,
                                0.99955946,
                                0.9995769,
                                0.9992218,
                                0.9984782,
                                0.9986745,
                                0.9977271,
                                0.9670209,
                                0.9954864,
                                0.9839963,
                                0.9809081,
                                0.9940713,
                                0.98901457,
                                0.9749314,
                                0.97703695,
                                0.9866552,
                                0.98371994,
                                0.9820909],
                     'mae': [0.02963013,
                             0.027003763,
                             0.027751572,
                             0.016725883,
                             0.017361924,
                             0.017964924,
                             0.02319981,
                             0.01763978,
                             0.020330608,
                             0.014716712,
                             0.016876815,
                             0.016450165,
                             0.015147513,
                             0.015430434,
                             0.013868741,
                             0.012076795,
                             0.013571636,
                             0.013182803,
                             0.015767777,
                             0.017304046,
                             0.016133398,
                             0.021173513,
                             0.1190209,
                             0.020585515,
                             0.02904497,
                             0.031276826,
                             0.022662884,
                             0.02738681,
                             0.041745763,
                             0.03928746,
                             0.0251294,
                             0.02908294,
                             0.030067768],
                     'max_mae': 0.1190209,
                     'max_mse': 0.015220314,
                     'max_rmse': 0.12337064,
                     'median_mae': 0.020330608,
                     'min_cosine': 0.9670209,
                     'mse': [0.0014245934,
                             0.0011918122,
                             0.0012815737,
                             0.0004700609,
                             0.00048257312,
                             0.00055841316,
                             0.0008046219,
                             0.00054258434,
                             0.00076988223,
                             0.00038422176,
                             0.0004764858,
                             0.00043862648,
                             0.0003924717,
                             0.00039770163,
                             0.00030885552,
                             0.00024366484,
                             0.000307616,
                             0.00027815977,
                             0.0004091634,
                             0.0004881327,
                             0.00042274222,
                             0.0007710726,
                             0.015220314,
                             0.000733827,
                             0.0012793036,
                             0.0014534317,
                             0.0009158305,
                             0.0011496944,
                             0.0024379536,
                             0.002542532,
                             0.0010734118,
                             0.0012944707,
                             0.0013787111],
                     'rmse': [0.037743784,
                              0.034522634,
                              0.035799075,
                              0.021680888,
                              0.021967547,
                              0.023630768,
                              0.028365858,
                              0.02329344,
                              0.027746752,
                              0.019601576,
                              0.021828555,
                              0.02094341,
                              0.019810898,
                              0.019942459,
                              0.017574286,
                              0.015609767,
                              0.017538985,
                              0.016678123,
                              0.020227788,
                              0.022093726,
                              0.020560697,
                              0.027768193,
                              0.12337064,
                              0.027089242,
                              0.035767354,
                              0.0381239,
                              0.030262692,
                              0.033907145,
                              0.04937564,
                              0.050423525,
                              0.032762963,
                              0.035978753,
                              0.037131]},
 'spectra_realpca': {'cosine': [0.9999935,
                                0.9999978,
                                0.9999979,
                                0.99999976,
                                0.99999976,
                                0.9999998,
                                0.99999946,
                                0.99999976,
                                1.0,
                                1.0,
                                0.9999999,
                                0.9999998,
                                1.0,
                                0.9999999,
                                1.0,
                                1.0,
                                1.0,
                                1.0,
                                0.99999976,
                                0.99999976,
                                0.9999998,
                                0.9999998,
                                0.99999964,
                                0.9999991,
                                0.99999744,
                                0.9999977,
                                0.99999803,
                                0.9999971,
                                0.999993,
                                0.99999714,
                                0.9999927,
                                0.99999774,
                                0.9999974],
                     'mae': [0.00053896697,
                             0.00030955425,
                             0.00030405668,
                             0.00019131883,
                             0.00018556588,
                             0.00012635897,
                             0.00030645187,
                             0.00025343048,
                             9.67147e-05,
                             0.000114763905,
                             0.0001296338,
                             0.00019823704,
                             0.00017564652,
                             0.00017863445,
                             9.6460564e-05,
                             4.1578453e-05,
                             5.7707995e-05,
                             6.904956e-05,
                             0.00016952804,
                             0.00017300875,
                             0.00019896885,
                             0.00014622,
                             0.00027150282,
                             0.0003007256,
                             0.00034691778,
                             0.00034095134,
                             0.00043419513,
                             0.00040834647,
                             0.0005661476,
                             0.00038705664,
                             0.00058836374,
                             0.0003393897,
                             0.00034336885],
                     'max_mae': 0.00058836374,
                     'max_mse': 5.603012e-07,
                     'max_rmse': 0.0007485327,
                     'median_mae': 0.00019896885,
                     'min_cosine': 0.9999927,
                     'mse': [4.6751796e-07,
                             1.5450203e-07,
                             1.477402e-07,
                             5.8031773e-08,
                             5.5923064e-08,
                             2.5680134e-08,
                             1.5094466e-07,
                             1.0262056e-07,
                             1.4853382e-08,
                             2.0988136e-08,
                             2.6759578e-08,
                             6.324365e-08,
                             4.9465925e-08,
                             5.1262585e-08,
                             1.4911942e-08,
                             2.76331e-09,
                             5.361779e-09,
                             7.58824e-09,
                             4.5754472e-08,
                             4.8072142e-08,
                             6.342619e-08,
                             3.412976e-08,
                             1.1943013e-07,
                             1.4575527e-07,
                             1.929959e-07,
                             1.8745317e-07,
                             3.0421458e-07,
                             2.668572e-07,
                             5.178199e-07,
                             2.391798e-07,
                             5.603012e-07,
                             1.8381196e-07,
                             1.8900435e-07],
                     'rmse': [0.0006837529,
                              0.00039306746,
                              0.00038436987,
                              0.00024089785,
                              0.00023648058,
                              0.00016025022,
                              0.00038851597,
                              0.00032034444,
                              0.00012187445,
                              0.00014487283,
                              0.00016358355,
                              0.00025148288,
                              0.00022240936,
                              0.00022641242,
                              0.00012211446,
                              5.2567197e-05,
                              7.322417e-05,
                              8.711051e-05,
                              0.00021390295,
                              0.0002192536,
                              0.00025184557,
                              0.00018474241,
                              0.00034558665,
                              0.00038177907,
                              0.00043931298,
                              0.00043295862,
                              0.0005515565,
                              0.0005165822,
                              0.00071959704,
                              0.0004890601,
                              0.0007485327,
                              0.00042873298,
                              0.0004347463]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_95.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734
Directory path: experiments/inpainting/gann_4_night_20210905_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_95.0/images
Optimal number of principal components:  53
Reconstruction error:  0.7857622
Energy conservation:  0.95525575
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_95.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.8998554886731998, 0.9362576187688315],
                   'kl_div': 2.329618,
                   'ks_tests': {10000: KstestResult(statistic=0.4618, pvalue=0.0, statistic_location=-0.0012143275, statistic_sign=-1),
                                20000: KstestResult(statistic=0.4682, pvalue=0.0, statistic_location=-0.0012858408, statistic_sign=-1),
                                30000: KstestResult(statistic=0.46, pvalue=0.0, statistic_location=-0.0013429578, statistic_sign=-1),
                                40000: KstestResult(statistic=0.46559999999999996, pvalue=0.0, statistic_location=-0.001323482, statistic_sign=-1),
                                50000: KstestResult(statistic=0.46134000000000003, pvalue=0.0, statistic_location=-0.0013303906, statistic_sign=-1),
                                60000: KstestResult(statistic=0.4668833333333333, pvalue=0.0, statistic_location=-0.0013138549, statistic_sign=-1),
                                70000: KstestResult(statistic=0.46835714285714286, pvalue=0.0, statistic_location=-0.0013422184, statistic_sign=-1),
                                80000: KstestResult(statistic=0.4688, pvalue=0.0, statistic_location=-0.0013421942, statistic_sign=-1),
                                90000: KstestResult(statistic=0.46382222222222225, pvalue=0.0, statistic_location=-0.0013215663, statistic_sign=-1),
                                100000: KstestResult(statistic=0.46708, pvalue=0.0, statistic_location=-0.0013240203, statistic_sign=-1),
                                110000: KstestResult(statistic=0.4681, pvalue=0.0, statistic_location=-0.0013643578, statistic_sign=-1)},
                   'moments': {'mean_error': -3.133999,
                               'means': [-0.0013864677, 3.262301e-06],
                               'stds': [0.016771028, 0.00049368147],
                               'variance_ratio': 1894.1216}},
 'originals': {'gan': {'mae': 0.023048721253871918,
                       'mse': 0.0009046081686392426,
                       'psnr': 30.321165084838867,
                       'rmse': 0.030076704919338226,
                       'ssim': 0.9525943994522095},
               'pca': {'mae': 0.0007735848193988204,
                       'mse': 1.3260223568067886e-06,
                       'psnr': 59.3380012512207,
                       'rmse': 0.0011515304213389754,
                       'ssim': 0.9999363422393799}},
 'reconstructions': {'mae': 0.023021209985017776,
                     'mse': 0.0009026816114783287,
                     'psnr': 31.008161544799805,
                     'rmse': 0.030044659972190857,
                     'ssim': 0.9526629447937012},
 'residual_spectra_pcagan': {'cosine': [0.018547561,
                                        0.005924479,
                                        0.014478923,
                                        -0.009786897,
                                        0.010138865,
                                        0.029504746,
                                        0.02691075,
                                        0.053354334,
                                        0.04610063,
                                        0.03558215,
                                        0.03732369],
                             'mae': [0.010599463,
                                     0.011942008,
                                     0.010166745,
                                     0.011250714,
                                     0.011178939,
                                     0.010139413,
                                     0.010573464,
                                     0.009145264,
                                     0.010205826,
                                     0.010939291,
                                     0.011051677],
                             'max_mae': 0.011942008,
                             'max_mse': 0.00040733546,
                             'max_rmse': 0.020182554,
                             'median_distance': 1.6656841,
                             'median_mae': 0.010599463,
                             'min_cosine': -0.009786897,
                             'mse': [0.00023403707,
                                     0.00037941925,
                                     0.00023656763,
                                     0.00028128785,
                                     0.00040733546,
                                     0.0002774504,
                                     0.00024772892,
                                     0.00017434893,
                                     0.00031034977,
                                     0.0002629523,
                                     0.00030163483],
                             'rmse': [0.015298271,
                                      0.019478686,
                                      0.015380755,
                                      0.016771639,
                                      0.020182554,
                                      0.016656842,
                                      0.015739407,
                                      0.013204126,
                                      0.017616747,
                                      0.016215803,
                                      0.017367637]},
 'residuals': {'mae': 0.010653890669345856,
               'mse': 0.0002830102457664907,
               'psnr': -7.258549213409424,
               'rmse': 0.01682290807366371,
               'ssds': [31.150585, 0.026810281],
               'ssim': 0.3057872951030731},
 'spectra_pcagan': {'cosine': [0.99845827,
                               0.99865544,
                               0.9980759,
                               0.9953882,
                               0.9942808,
                               0.99584216,
                               0.98347706,
                               0.9838754,
                               0.98552245,
                               0.98706836,
                               0.98851424],
                    'mae': [0.017761283,
                            0.017582772,
                            0.017667554,
                            0.02494922,
                            0.023596935,
                            0.020196766,
                            0.027724102,
                            0.027467513,
                            0.025091602,
                            0.024868399,
                            0.026327142],
                    'max_mae': 0.027724102,
                    'max_mse': 0.0012451025,
                    'max_rmse': 0.03528601,
                    'median_mae': 0.024868399,
                    'min_cosine': 0.98347706,
                    'mse': [0.0005266127,
                            0.00053920917,
                            0.00051807275,
                            0.0010089803,
                            0.0009221158,
                            0.0007257719,
                            0.0012451025,
                            0.0011744997,
                            0.0010760558,
                            0.0010450258,
                            0.0011480507],
                    'rmse': [0.022948043,
                             0.023220878,
                             0.02276121,
                             0.03176445,
                             0.03036636,
                             0.026940154,
                             0.03528601,
                             0.034270976,
                             0.03280329,
                             0.03232686,
                             0.033882897]},
 'spectra_realgan': {'cosine': [0.99845815,
                                0.99865544,
                                0.9980743,
                                0.99538624,
                                0.9942768,
                                0.9958385,
                                0.9834681,
                                0.9838169,
                                0.9854402,
                                0.98703146,
                                0.9884645],
                     'mae': [0.017761227,
                             0.017582031,
                             0.0176733,
                             0.024944736,
                             0.023610482,
                             0.020209933,
                             0.027730133,
                             0.027510053,
                             0.02518444,
                             0.024926346,
                             0.02640324],
                     'max_mae': 0.027730133,
                     'max_mse': 0.0012458147,
                     'max_rmse': 0.0352961,
                     'median_mae': 0.024926346,
                     'min_cosine': 0.9834681,
                     'mse': [0.00052664767,
                             0.000539212,
                             0.00051849784,
                             0.001009169,
                             0.0009227619,
                             0.00072644174,
                             0.0012458147,
                             0.0011789299,
                             0.0010824356,
                             0.0010481058,
                             0.0011526741],
                     'rmse': [0.022948805,
                              0.02322094,
                              0.022770548,
                              0.03176742,
                              0.030376997,
                              0.026952583,
                              0.0352961,
                              0.03433555,
                              0.03290039,
                              0.03237446,
                              0.033951055]},
 'spectra_realpca': {'cosine': [0.9999999,
                                0.9999999,
                                0.9999989,
                                0.9999945,
                                0.9999981,
                                0.99999845,
                                0.99996716,
                                0.99995625,
                                0.99995166,
                                0.99998105,
                                0.9999779],
                     'mae': [0.000113101945,
                             0.00014019327,
                             0.00039880394,
                             0.0007686165,
                             0.0004399368,
                             0.00038935343,
                             0.0012497163,
                             0.0014123553,
                             0.0015018885,
                             0.0009747154,
                             0.0011207509],
                     'max_mae': 0.0015018885,
                     'max_mse': 3.570227e-06,
                     'max_rmse': 0.0018895044,
                     'median_mae': 0.0007686165,
                     'min_cosine': 0.99995166,
                     'mse': [2.0459265e-08,
                             3.1550123e-08,
                             2.563831e-07,
                             9.4871336e-07,
                             3.0660556e-07,
                             2.444373e-07,
                             2.491692e-06,
                             3.2027904e-06,
                             3.570227e-06,
                             1.5146944e-06,
                             1.9986935e-06],
                     'rmse': [0.00014303588,
                              0.00017762354,
                              0.00050634285,
                              0.0009740192,
                              0.00055371976,
                              0.00049440603,
                              0.0015785095,
                              0.0017896341,
                              0.0018895044,
                              0.0012307293,
                              0.0014137516]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_95.0

Running comparison for experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726
Directory path: experiments/inpainting/gann_4_night_20210905_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_95.0/images
Optimal number of principal components:  53
Reconstruction error:  0.7857622
Energy conservation:  0.95525575
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_95.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9022391383209563, 1.5474223219130856],
                   'kl_div': 1.7097087,
                   'ks_tests': {10000: KstestResult(statistic=0.4056, pvalue=0.0, statistic_location=-0.0016598497, statistic_sign=-1),
                                20000: KstestResult(statistic=0.39949999999999997, pvalue=0.0, statistic_location=-0.0017157383, statistic_sign=-1),
                                30000: KstestResult(statistic=0.3999666666666667, pvalue=0.0, statistic_location=-0.0016933121, statistic_sign=-1),
                                40000: KstestResult(statistic=0.406825, pvalue=0.0, statistic_location=-0.001874866, statistic_sign=-1),
                                50000: KstestResult(statistic=0.4066, pvalue=0.0, statistic_location=-0.0016798563, statistic_sign=-1),
                                60000: KstestResult(statistic=0.4053833333333333, pvalue=0.0, statistic_location=-0.0017077634, statistic_sign=-1),
                                70000: KstestResult(statistic=0.4043428571428571, pvalue=0.0, statistic_location=-0.0017562732, statistic_sign=-1),
                                80000: KstestResult(statistic=0.403925, pvalue=0.0, statistic_location=-0.0017665792, statistic_sign=-1),
                                90000: KstestResult(statistic=0.4021222222222222, pvalue=0.0, statistic_location=-0.0016162638, statistic_sign=-1),
                                100000: KstestResult(statistic=0.40393, pvalue=0.0, statistic_location=-0.0017033694, statistic_sign=-1),
                                110000: KstestResult(statistic=0.40636363636363637, pvalue=0.0, statistic_location=-0.001686532, statistic_sign=-1),
                                120000: KstestResult(statistic=0.404125, pvalue=0.0, statistic_location=-0.0016803662, statistic_sign=-1),
                                130000: KstestResult(statistic=0.4048615384615385, pvalue=0.0, statistic_location=-0.0017090123, statistic_sign=-1),
                                140000: KstestResult(statistic=0.4055785714285714, pvalue=0.0, statistic_location=-0.0017177691, statistic_sign=-1),
                                150000: KstestResult(statistic=0.4056133333333334, pvalue=0.0, statistic_location=-0.0016803201, statistic_sign=-1),
                                160000: KstestResult(statistic=0.4060625, pvalue=0.0, statistic_location=-0.0016795676, statistic_sign=-1),
                                170000: KstestResult(statistic=0.4026764705882353, pvalue=0.0, statistic_location=-0.0016803201, statistic_sign=-1),
                                180000: KstestResult(statistic=0.4020166666666667, pvalue=0.0, statistic_location=-0.0016810643, statistic_sign=-1),
                                190000: KstestResult(statistic=0.40373684210526317, pvalue=0.0, statistic_location=-0.0018752525, statistic_sign=-1),
                                200000: KstestResult(statistic=0.40447500000000003, pvalue=0.0, statistic_location=-0.0016577034, statistic_sign=-1),
                                210000: KstestResult(statistic=0.4037, pvalue=0.0, statistic_location=-0.0017545428, statistic_sign=-1),
                                220000: KstestResult(statistic=0.4049590909090909, pvalue=0.0, statistic_location=-0.0016803201, statistic_sign=-1)},
                   'moments': {'mean_error': -1.0053133,
                               'means': [-0.0014589109, 4.624399e-07],
                               'stds': [0.01597184, 0.0014663133],
                               'variance_ratio': 180.02582}},
 'originals': {'gan': {'mae': 0.029288172721862793,
                       'mse': 0.001597895403392613,
                       'psnr': 30.15612030029297,
                       'rmse': 0.03997368365526199,
                       'ssim': 0.8410302996635437},
               'pca': {'mae': 0.0020659747533500195,
                       'mse': 1.6850250176503323e-05,
                       'psnr': 49.974456787109375,
                       'rmse': 0.004104905761778355,
                       'ssim': 0.9995213747024536}},
 'reconstructions': {'mae': 0.02908320352435112,
                     'mse': 0.0015815463848412037,
                     'psnr': 30.249706268310547,
                     'rmse': 0.03976866230368614,
                     'ssim': 0.839537501335144},
 'residual_spectra_pcagan': {'cosine': [0.021464469,
                                        0.014774289,
                                        -0.027910745,
                                        0.017351909,
                                        0.026187954,
                                        0.019309612,
                                        0.0014384079,
                                        0.019940423,
                                        -0.003435965,
                                        0.016978469,
                                        0.027028618,
                                        0.031916652,
                                        0.05938045,
                                        0.05130179,
                                        0.038732808,
                                        0.038081788,
                                        0.14705777,
                                        0.11812871,
                                        0.16947326,
                                        0.30832955,
                                        0.15941624,
                                        0.12866226],
                             'mae': [0.010243228,
                                     0.01004673,
                                     0.011765579,
                                     0.01269231,
                                     0.011144783,
                                     0.0099609345,
                                     0.011340231,
                                     0.009655623,
                                     0.010819264,
                                     0.011034727,
                                     0.009470406,
                                     0.009908401,
                                     0.00862211,
                                     0.010036879,
                                     0.010944865,
                                     0.010614758,
                                     0.009005621,
                                     0.010919899,
                                     0.008986556,
                                     0.008796531,
                                     0.010666706,
                                     0.011384384],
                             'max_mae': 0.01269231,
                             'max_mse': 0.00040909124,
                             'max_rmse': 0.020226004,
                             'median_distance': 1.6188235,
                             'median_mae': 0.010428993,
                             'min_cosine': -0.027910745,
                             'mse': [0.00021852893,
                                     0.00026172964,
                                     0.00040909124,
                                     0.00031540566,
                                     0.00029249347,
                                     0.00019950297,
                                     0.00032272545,
                                     0.0001957741,
                                     0.000249638,
                                     0.0003500795,
                                     0.00021712169,
                                     0.00019079464,
                                     0.0001408087,
                                     0.0002807617,
                                     0.00026602705,
                                     0.00026745762,
                                     0.000223664,
                                     0.0002623885,
                                     0.00016301959,
                                     0.00017862141,
                                     0.0003208893,
                                     0.000285005],
                             'rmse': [0.014782724,
                                      0.01617806,
                                      0.020226004,
                                      0.017759664,
                                      0.01710244,
                                      0.014124552,
                                      0.01796456,
                                      0.01399193,
                                      0.015799936,
                                      0.018710412,
                                      0.01473505,
                                      0.013812844,
                                      0.011866284,
                                      0.016755946,
                                      0.016310336,
                                      0.016354132,
                                      0.0149554005,
                                      0.01619841,
                                      0.012767913,
                                      0.0133649325,
                                      0.017913383,
                                      0.016882092]},
 'residuals': {'mae': 0.010366388596594334,
               'mse': 0.000255069462582469,
               'psnr': 7.394003391265869,
               'rmse': 0.015970895066857338,
               'ssds': [56.58993, 0.4730143],
               'ssim': 0.3505077362060547},
 'spectra_pcagan': {'cosine': [0.99124926,
                               0.99027705,
                               0.987196,
                               0.9979622,
                               0.99890083,
                               0.99846435,
                               0.998604,
                               0.99804246,
                               0.9952081,
                               0.99366105,
                               0.9958134,
                               0.9833095,
                               0.9836517,
                               0.98478305,
                               0.9859789,
                               0.9874386,
                               0.9886077,
                               0.9805635,
                               0.9898362,
                               0.9920748,
                               0.98674583,
                               0.98561436],
                    'mae': [0.03329055,
                            0.025789859,
                            0.1023213,
                            0.023084374,
                            0.018354453,
                            0.017656183,
                            0.017891238,
                            0.01793901,
                            0.025358744,
                            0.025289139,
                            0.02114548,
                            0.028000107,
                            0.027858887,
                            0.026070721,
                            0.026286982,
                            0.02686488,
                            0.025723321,
                            0.033063665,
                            0.029252883,
                            0.027221972,
                            0.029229311,
                            0.03213734],
                    'max_mae': 0.1023213,
                    'max_mse': 0.011329347,
                    'max_rmse': 0.106439404,
                    'median_mae': 0.026178852,
                    'min_cosine': 0.9805635,
                    'mse': [0.001586973,
                            0.0011107458,
                            0.011329347,
                            0.00086246355,
                            0.0005671431,
                            0.0005198441,
                            0.00055679376,
                            0.00053228886,
                            0.0010315214,
                            0.001028097,
                            0.00077232777,
                            0.0012560781,
                            0.0011955987,
                            0.0011541167,
                            0.0011496488,
                            0.0011880092,
                            0.001131427,
                            0.0018038893,
                            0.0014616718,
                            0.0013244314,
                            0.00150641,
                            0.001725195],
                    'rmse': [0.039836828,
                             0.033327855,
                             0.106439404,
                             0.02936773,
                             0.023814766,
                             0.02280009,
                             0.023596479,
                             0.023071386,
                             0.032117307,
                             0.032063954,
                             0.027790785,
                             0.035441194,
                             0.03457743,
                             0.033972293,
                             0.03390647,
                             0.034467507,
                             0.033636693,
                             0.042472217,
                             0.038231816,
                             0.036392737,
                             0.038812496,
                             0.041535467]},
 'spectra_realgan': {'cosine': [0.9912347,
                                0.99026316,
                                0.9871963,
                                0.99796176,
                                0.99890083,
                                0.99846447,
                                0.99860394,
                                0.99804103,
                                0.99520475,
                                0.9936569,
                                0.9958095,
                                0.98329765,
                                0.9835999,
                                0.984698,
                                0.9859396,
                                0.9873891,
                                0.98822236,
                                0.98030156,
                                0.98952353,
                                0.99124986,
                                0.9861594,
                                0.98525864],
                     'mae': [0.033294223,
                             0.025828766,
                             0.10232119,
                             0.023086667,
                             0.018353976,
                             0.017655889,
                             0.017890586,
                             0.017944146,
                             0.025359493,
                             0.025303021,
                             0.02115929,
                             0.028000534,
                             0.02790281,
                             0.026169525,
                             0.026349448,
                             0.026940206,
                             0.026175488,
                             0.033334527,
                             0.029743722,
                             0.0290685,
                             0.029867712,
                             0.032590088],
                     'max_mae': 0.10232119,
                     'max_mse': 0.011329362,
                     'max_rmse': 0.10643948,
                     'median_mae': 0.026262468,
                     'min_cosine': 0.98030156,
                     'mse': [0.0015887473,
                             0.0011122684,
                             0.011329362,
                             0.0008626093,
                             0.00056718534,
                             0.000519867,
                             0.0005567879,
                             0.0005326666,
                             0.0010319458,
                             0.0010287849,
                             0.0007730675,
                             0.0012570083,
                             0.0011995912,
                             0.0011607567,
                             0.0011529385,
                             0.0011925612,
                             0.0011627872,
                             0.0018270607,
                             0.0015063379,
                             0.001459091,
                             0.0015643693,
                             0.0017679054],
                     'rmse': [0.039859094,
                              0.033350687,
                              0.10643948,
                              0.029370211,
                              0.023815654,
                              0.022800593,
                              0.023596354,
                              0.023079572,
                              0.032123912,
                              0.03207468,
                              0.027804092,
                              0.035454314,
                              0.034635115,
                              0.03406988,
                              0.03395495,
                              0.03453348,
                              0.034099665,
                              0.04274413,
                              0.03881157,
                              0.03819805,
                              0.039552107,
                              0.04204647]},
 'spectra_realpca': {'cosine': [0.9999861,
                                0.9999897,
                                0.99999994,
                                0.9999996,
                                0.9999999,
                                0.9999999,
                                0.9999999,
                                0.9999989,
                                0.9999945,
                                0.9999981,
                                0.99999845,
                                0.99996716,
                                0.99995625,
                                0.99995166,
                                0.99998105,
                                0.9999779,
                                0.9995509,
                                0.99974,
                                0.99963784,
                                0.99908745,
                                0.9994722,
                                0.99962246],
                     'mae': [0.0010418415,
                             0.0008106341,
                             8.83222e-05,
                             0.0002828473,
                             0.00015770012,
                             0.000113101945,
                             0.00014019327,
                             0.00039880394,
                             0.0007686165,
                             0.0004399368,
                             0.00038935343,
                             0.0012497163,
                             0.0014123553,
                             0.0015018885,
                             0.0009747154,
                             0.0011207509,
                             0.004793094,
                             0.0037948147,
                             0.005627184,
                             0.009673315,
                             0.005492372,
                             0.0051798853],
                     'max_mae': 0.009673315,
                     'max_mse': 0.000150972,
                     'max_rmse': 0.012287066,
                     'median_mae': 0.0010082785,
                     'min_cosine': 0.99908745,
                     'mse': [1.7453194e-06,
                             1.0563398e-06,
                             1.2530541e-08,
                             1.2738394e-07,
                             3.9975355e-08,
                             2.0459265e-08,
                             3.1550123e-08,
                             2.563831e-07,
                             9.4871336e-07,
                             3.0660556e-07,
                             2.444373e-07,
                             2.491692e-06,
                             3.2027904e-06,
                             3.570227e-06,
                             1.5146944e-06,
                             1.9986935e-06,
                             3.6682115e-05,
                             2.3029575e-05,
                             5.117701e-05,
                             0.000150972,
                             4.8339843e-05,
                             4.2937194e-05],
                     'rmse': [0.0013211054,
                              0.001027784,
                              0.0001119399,
                              0.00035690886,
                              0.00019993838,
                              0.00014303588,
                              0.00017762354,
                              0.00050634285,
                              0.0009740192,
                              0.00055371976,
                              0.00049440603,
                              0.0015785095,
                              0.0017896341,
                              0.0018895044,
                              0.0012307293,
                              0.0014137516,
                              0.006056576,
                              0.004798914,
                              0.007153811,
                              0.012287066,
                              0.0069526862,
                              0.006552648]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_95.0

Running comparison for experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226
Directory path: experiments/inpainting/gann_4_night_20210905_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 95.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_95.0/images
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_95.0/images
Optimal number of principal components:  53
Reconstruction error:  0.7857622
Energy conservation:  0.95525575
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_95.0
saved spectra in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_95.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_95.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_95.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.867696224533345, 1.478103202468155],
                   'kl_div': 1.7360512,
                   'ks_tests': {10000: KstestResult(statistic=0.3962, pvalue=0.0, statistic_location=-0.0016922913, statistic_sign=-1),
                                20000: KstestResult(statistic=0.40015, pvalue=0.0, statistic_location=-0.0014814343, statistic_sign=-1),
                                30000: KstestResult(statistic=0.3933666666666667, pvalue=0.0, statistic_location=-0.0018191943, statistic_sign=-1),
                                40000: KstestResult(statistic=0.394425, pvalue=0.0, statistic_location=-0.0015536379, statistic_sign=-1),
                                50000: KstestResult(statistic=0.3956, pvalue=0.0, statistic_location=-0.0016745925, statistic_sign=-1),
                                60000: KstestResult(statistic=0.39258333333333334, pvalue=0.0, statistic_location=-0.0015235031, statistic_sign=-1),
                                70000: KstestResult(statistic=0.39575714285714286, pvalue=0.0, statistic_location=-0.0016813781, statistic_sign=-1),
                                80000: KstestResult(statistic=0.40011250000000004, pvalue=0.0, statistic_location=-0.0014693495, statistic_sign=-1),
                                90000: KstestResult(statistic=0.3937777777777778, pvalue=0.0, statistic_location=-0.0016708621, statistic_sign=-1),
                                100000: KstestResult(statistic=0.39506, pvalue=0.0, statistic_location=-0.001654892, statistic_sign=-1),
                                110000: KstestResult(statistic=0.39534545454545456, pvalue=0.0, statistic_location=-0.0015719226, statistic_sign=-1),
                                120000: KstestResult(statistic=0.3930416666666667, pvalue=0.0, statistic_location=-0.0016448312, statistic_sign=-1),
                                130000: KstestResult(statistic=0.39476923076923076, pvalue=0.0, statistic_location=-0.0016097613, statistic_sign=-1),
                                140000: KstestResult(statistic=0.39585714285714285, pvalue=0.0, statistic_location=-0.0016660936, statistic_sign=-1),
                                150000: KstestResult(statistic=0.39543333333333336, pvalue=0.0, statistic_location=-0.0016699908, statistic_sign=-1),
                                160000: KstestResult(statistic=0.394775, pvalue=0.0, statistic_location=-0.0015325211, statistic_sign=-1),
                                170000: KstestResult(statistic=0.3957529411764706, pvalue=0.0, statistic_location=-0.0015951842, statistic_sign=-1),
                                180000: KstestResult(statistic=0.39731666666666665, pvalue=0.0, statistic_location=-0.0016670641, statistic_sign=-1),
                                190000: KstestResult(statistic=0.396721052631579, pvalue=0.0, statistic_location=-0.0016686507, statistic_sign=-1),
                                200000: KstestResult(statistic=0.3958, pvalue=0.0, statistic_location=-0.0016674255, statistic_sign=-1),
                                210000: KstestResult(statistic=0.3942047619047619, pvalue=0.0, statistic_location=-0.0016675284, statistic_sign=-1),
                                220000: KstestResult(statistic=0.3945409090909091, pvalue=0.0, statistic_location=-0.0015613418, statistic_sign=-1),
                                230000: KstestResult(statistic=0.39704347826086955, pvalue=0.0, statistic_location=-0.0016801599, statistic_sign=-1),
                                240000: KstestResult(statistic=0.3965666666666667, pvalue=0.0, statistic_location=-0.0016713673, statistic_sign=-1),
                                250000: KstestResult(statistic=0.395932, pvalue=0.0, statistic_location=-0.0016646385, statistic_sign=-1),
                                260000: KstestResult(statistic=0.39593076923076925, pvalue=0.0, statistic_location=-0.001670525, statistic_sign=-1),
                                270000: KstestResult(statistic=0.39540000000000003, pvalue=0.0, statistic_location=-0.0016785283, statistic_sign=-1),
                                280000: KstestResult(statistic=0.39595357142857146, pvalue=0.0, statistic_location=-0.0015620734, statistic_sign=-1),
                                290000: KstestResult(statistic=0.3954586206896552, pvalue=0.0, statistic_location=-0.001679955, statistic_sign=-1),
                                300000: KstestResult(statistic=0.3947833333333333, pvalue=0.0, statistic_location=-0.0016674255, statistic_sign=-1),
                                310000: KstestResult(statistic=0.39636451612903223, pvalue=0.0, statistic_location=-0.0016674255, statistic_sign=-1),
                                320000: KstestResult(statistic=0.3965875, pvalue=0.0, statistic_location=-0.0016674255, statistic_sign=-1),
                                330000: KstestResult(statistic=0.39546060606060607, pvalue=0.0, statistic_location=-0.0015702099, statistic_sign=-1)},
                   'moments': {'mean_error': -0.43858036,
                               'means': [-0.00065364566, 6.051045e-07],
                               'stds': [0.015172766, 0.0013778066],
                               'variance_ratio': 189.57268}},
 'originals': {'gan': {'mae': 0.04760230705142021,
                       'mse': 0.01523522287607193,
                       'psnr': 23.570749282836914,
                       'rmse': 0.12343104183673859,
                       'ssim': 0.8455835580825806},
               'pca': {'mae': 0.0018418431282043457,
                       'mse': 1.462989894207567e-05,
                       'psnr': 54.1215934753418,
                       'rmse': 0.003824905026704073,
                       'ssim': 0.9986706376075745}},
 'reconstructions': {'mae': 0.04743318259716034,
                     'mse': 0.015221212059259415,
                     'psnr': 23.949514389038086,
                     'rmse': 0.12337427586317062,
                     'ssim': 0.8463780879974365},
 'residual_spectra_pcagan': {'cosine': [0.0047778003,
                                        0.00087675033,
                                        0.0010408405,
                                        0.012656492,
                                        0.018697817,
                                        0.0044990513,
                                        0.028326038,
                                        0.019230915,
                                        -0.028401554,
                                        0.02442369,
                                        0.0224563,
                                        0.020810513,
                                        0.0061219567,
                                        0.026943367,
                                        -0.00038177866,
                                        0.01884541,
                                        0.024993429,
                                        0.033393383,
                                        0.06378492,
                                        0.05087765,
                                        0.040621333,
                                        0.038716797,
                                        0.16300966,
                                        0.1298924,
                                        0.18967216,
                                        0.3229409,
                                        0.15911435,
                                        0.13105103,
                                        0.20906365,
                                        0.036455974,
                                        -0.013228633,
                                        0.12276093,
                                        0.07953578],
                             'mae': [0.008974106,
                                     0.009132737,
                                     0.00827841,
                                     0.010241633,
                                     0.009098169,
                                     0.010246606,
                                     0.009100467,
                                     0.009409743,
                                     0.011259929,
                                     0.012268395,
                                     0.010848076,
                                     0.009652115,
                                     0.010712347,
                                     0.009157499,
                                     0.010162732,
                                     0.010336604,
                                     0.009252749,
                                     0.009238879,
                                     0.008130822,
                                     0.0093841,
                                     0.010244658,
                                     0.010150534,
                                     0.008648737,
                                     0.010193116,
                                     0.0085690785,
                                     0.008302314,
                                     0.01040638,
                                     0.010779553,
                                     0.009492184,
                                     0.011103042,
                                     0.013194431,
                                     0.011103693,
                                     0.008751951],
                             'max_mae': 0.013194431,
                             'max_mse': 0.0004605143,
                             'max_rmse': 0.021459596,
                             'median_distance': 1.4847072,
                             'median_mae': 0.009652115,
                             'min_cosine': -0.028401554,
                             'mse': [0.00018653202,
                                     0.00017915468,
                                     0.00014009967,
                                     0.00026684994,
                                     0.00016557904,
                                     0.00031250963,
                                     0.000172358,
                                     0.00022308357,
                                     0.00034201375,
                                     0.00029120635,
                                     0.0002740181,
                                     0.00019319542,
                                     0.000274245,
                                     0.00017005882,
                                     0.00021350663,
                                     0.0003078959,
                                     0.00020799892,
                                     0.00016721255,
                                     0.00012460026,
                                     0.00023455627,
                                     0.00022043553,
                                     0.0002490685,
                                     0.00019190888,
                                     0.00022515902,
                                     0.00014452987,
                                     0.00015339197,
                                     0.00030482348,
                                     0.000259999,
                                     0.00020801464,
                                     0.000277768,
                                     0.0004605143,
                                     0.00023505722,
                                     0.00017245875],
                             'rmse': [0.013657672,
                                      0.013384867,
                                      0.01183637,
                                      0.016335541,
                                      0.0128677515,
                                      0.017677942,
                                      0.013128519,
                                      0.014935982,
                                      0.018493613,
                                      0.017064769,
                                      0.016553491,
                                      0.013899475,
                                      0.016560344,
                                      0.01304066,
                                      0.014611866,
                                      0.017546963,
                                      0.014422168,
                                      0.012931069,
                                      0.011162449,
                                      0.01531523,
                                      0.014847071,
                                      0.015781904,
                                      0.013853118,
                                      0.0150053,
                                      0.012022058,
                                      0.012385151,
                                      0.017459195,
                                      0.016124485,
                                      0.014422713,
                                      0.016666373,
                                      0.021459596,
                                      0.015331576,
                                      0.013132355]},
 'residuals': {'mae': 0.009873509407043457,
               'mse': 0.00022878193703945726,
               'psnr': 7.866370677947998,
               'rmse': 0.015125539153814316,
               'ssds': [76.11101, 0.6264542],
               'ssim': 0.45765936374664307},
 'spectra_pcagan': {'cosine': [0.99551654,
                               0.9987652,
                               0.9988337,
                               0.9975665,
                               0.99837804,
                               0.9977363,
                               0.99212235,
                               0.99017465,
                               0.9875071,
                               0.9980456,
                               0.998884,
                               0.99843335,
                               0.99866533,
                               0.99810493,
                               0.99540216,
                               0.9941026,
                               0.99583346,
                               0.9838869,
                               0.9832662,
                               0.9855933,
                               0.9865666,
                               0.98819876,
                               0.9883628,
                               0.9821176,
                               0.9901061,
                               0.99216914,
                               0.98641706,
                               0.9858721,
                               0.9873122,
                               0.94859636,
                               0.22053675,
                               0.95230144,
                               0.9869935],
                    'mae': [0.020038879,
                            0.015910557,
                            0.014394012,
                            0.02383693,
                            0.016506629,
                            0.020243518,
                            0.031387974,
                            0.025843589,
                            0.10156127,
                            0.022793435,
                            0.0183845,
                            0.017780164,
                            0.017534543,
                            0.017568216,
                            0.024625028,
                            0.024178961,
                            0.020805566,
                            0.027522419,
                            0.027860297,
                            0.025100147,
                            0.025432719,
                            0.02653719,
                            0.02512297,
                            0.031411316,
                            0.029103534,
                            0.026982592,
                            0.028956171,
                            0.03160221,
                            0.027316535,
                            0.05268663,
                            0.6607609,
                            0.061101045,
                            0.024404654],
                    'max_mae': 0.6607609,
                    'max_mse': 0.45395342,
                    'max_rmse': 0.67376065,
                    'median_mae': 0.02512297,
                    'min_cosine': 0.22053675,
                    'mse': [0.0006846969,
                            0.00042051877,
                            0.0003553073,
                            0.00083527813,
                            0.00044598774,
                            0.00071788114,
                            0.0014057212,
                            0.0011198898,
                            0.011160198,
                            0.0008365404,
                            0.0005706268,
                            0.0005313319,
                            0.00053461746,
                            0.0005109083,
                            0.0009840442,
                            0.0009554995,
                            0.000753745,
                            0.0012162393,
                            0.0012187137,
                            0.0010710179,
                            0.001081254,
                            0.0011575499,
                            0.0010928427,
                            0.0016510143,
                            0.0014322445,
                            0.0012996718,
                            0.0014843981,
                            0.0016720445,
                            0.0013033001,
                            0.003731356,
                            0.45395342,
                            0.0051148054,
                            0.0009973163],
                    'rmse': [0.026166713,
                             0.020506555,
                             0.018849596,
                             0.028901178,
                             0.021118421,
                             0.026793305,
                             0.03749295,
                             0.033464756,
                             0.105641834,
                             0.028923009,
                             0.023887796,
                             0.023050638,
                             0.023121797,
                             0.02260328,
                             0.031369478,
                             0.030911155,
                             0.027454415,
                             0.03487462,
                             0.03491008,
                             0.03272641,
                             0.032882426,
                             0.034022786,
                             0.03305817,
                             0.040632676,
                             0.037845008,
                             0.03605096,
                             0.038527887,
                             0.04089064,
                             0.036101248,
                             0.061084826,
                             0.67376065,
                             0.07151787,
                             0.031580314]},
 'spectra_realgan': {'cosine': [0.9955164,
                                0.9987649,
                                0.99883413,
                                0.99756616,
                                0.9983779,
                                0.9977365,
                                0.9921055,
                                0.9901596,
                                0.98750746,
                                0.998045,
                                0.998884,
                                0.99843335,
                                0.99866533,
                                0.99810344,
                                0.9953992,
                                0.99409825,
                                0.99583006,
                                0.9838781,
                                0.9832142,
                                0.9855101,
                                0.9865281,
                                0.9881487,
                                0.9879645,
                                0.981844,
                                0.98978984,
                                0.99135745,
                                0.98583984,
                                0.9855272,
                                0.986517,
                                0.9485304,
                                0.22053947,
                                0.9521743,
                                0.98690134],
                     'mae': [0.02003736,
                             0.015912456,
                             0.01439145,
                             0.023837384,
                             0.016507413,
                             0.02024578,
                             0.03139986,
                             0.025885034,
                             0.101561256,
                             0.022796463,
                             0.018384555,
                             0.017779883,
                             0.017534263,
                             0.017570963,
                             0.024620226,
                             0.024195084,
                             0.020818792,
                             0.02751676,
                             0.027908234,
                             0.025199236,
                             0.025496928,
                             0.026612235,
                             0.025614794,
                             0.03171184,
                             0.029572342,
                             0.028771188,
                             0.029580686,
                             0.032048475,
                             0.028307416,
                             0.052727886,
                             0.6607605,
                             0.061088167,
                             0.024481287],
                     'max_mae': 0.6607605,
                     'max_mse': 0.45395273,
                     'max_rmse': 0.6737601,
                     'median_mae': 0.025496928,
                     'min_cosine': 0.22053947,
                     'mse': [0.00068473973,
                             0.00042061973,
                             0.00035520172,
                             0.000835334,
                             0.00044601268,
                             0.0007178525,
                             0.0014078384,
                             0.0011215287,
                             0.011160203,
                             0.0008367609,
                             0.0005706602,
                             0.0005313679,
                             0.00053463364,
                             0.00051129406,
                             0.0009844217,
                             0.00095619133,
                             0.0007544167,
                             0.0012169371,
                             0.0012226732,
                             0.0010774712,
                             0.0010844683,
                             0.0011621849,
                             0.0011252535,
                             0.0016751633,
                             0.0014775015,
                             0.0014325989,
                             0.0015413836,
                             0.0017134062,
                             0.0013875705,
                             0.0037367907,
                             0.45395273,
                             0.005122695,
                             0.0010044419],
                     'rmse': [0.026167532,
                              0.020509016,
                              0.018846795,
                              0.028902145,
                              0.021119012,
                              0.02679277,
                              0.037521172,
                              0.03348923,
                              0.105641864,
                              0.02892682,
                              0.023888495,
                              0.023051418,
                              0.023122147,
                              0.022611812,
                              0.031375494,
                              0.030922344,
                              0.027466647,
                              0.034884624,
                              0.034966744,
                              0.032824855,
                              0.03293127,
                              0.034090832,
                              0.033544797,
                              0.04092876,
                              0.038438283,
                              0.037849687,
                              0.03926046,
                              0.04139331,
                              0.03725011,
                              0.061129294,
                              0.6737601,
                              0.071573004,
                              0.03169293]},
 'spectra_realpca': {'cosine': [0.99999934,
                                0.9999996,
                                0.9999995,
                                1.0,
                                1.0,
                                0.9999985,
                                0.9999861,
                                0.9999897,
                                0.99999994,
                                0.9999996,
                                0.9999999,
                                0.9999999,
                                0.9999999,
                                0.9999989,
                                0.9999945,
                                0.9999981,
                                0.99999845,
                                0.99996716,
                                0.99995625,
                                0.99995166,
                                0.99998105,
                                0.9999779,
                                0.9995509,
                                0.99974,
                                0.99963784,
                                0.99908745,
                                0.9994722,
                                0.99962246,
                                0.9991901,
                                0.9999636,
                                0.9999996,
                                0.9997813,
                                0.9999505],
                     'mae': [0.00023370078,
                             0.00028567653,
                             0.00029202088,
                             0.000115243456,
                             5.4670953e-05,
                             0.0005159792,
                             0.0010418415,
                             0.0008106341,
                             8.83222e-05,
                             0.0002828473,
                             0.00015770012,
                             0.000113101945,
                             0.00014019327,
                             0.00039880394,
                             0.0007686165,
                             0.0004399368,
                             0.00038935343,
                             0.0012497163,
                             0.0014123553,
                             0.0015018885,
                             0.0009747154,
                             0.0011207509,
                             0.004793094,
                             0.0037948147,
                             0.005627184,
                             0.009673315,
                             0.005492372,
                             0.0051798853,
                             0.0072171898,
                             0.0013050365,
                             0.00011818485,
                             0.003657313,
                             0.0015343678],
                     'max_mae': 0.009673315,
                     'max_mse': 0.000150972,
                     'max_rmse': 0.012287066,
                     'median_mae': 0.0008106341,
                     'min_cosine': 0.99908745,
                     'mse': [8.697097e-08,
                             1.3118587e-07,
                             1.3686054e-07,
                             2.1351635e-08,
                             4.8181983e-09,
                             4.2789867e-07,
                             1.7453194e-06,
                             1.0563398e-06,
                             1.2530541e-08,
                             1.2738394e-07,
                             3.9975355e-08,
                             2.0459265e-08,
                             3.1550123e-08,
                             2.563831e-07,
                             9.4871336e-07,
                             3.0660556e-07,
                             2.444373e-07,
                             2.491692e-06,
                             3.2027904e-06,
                             3.570227e-06,
                             1.5146944e-06,
                             1.9986935e-06,
                             3.6682115e-05,
                             2.3029575e-05,
                             5.117701e-05,
                             0.000150972,
                             4.8339843e-05,
                             4.2937194e-05,
                             8.3310035e-05,
                             2.7158794e-06,
                             2.2354296e-08,
                             2.1450127e-05,
                             3.7736152e-06],
                     'rmse': [0.00029490842,
                              0.0003621959,
                              0.00036994668,
                              0.00014612198,
                              6.941324e-05,
                              0.0006541396,
                              0.0013211054,
                              0.001027784,
                              0.0001119399,
                              0.00035690886,
                              0.00019993838,
                              0.00014303588,
                              0.00017762354,
                              0.00050634285,
                              0.0009740192,
                              0.00055371976,
                              0.00049440603,
                              0.0015785095,
                              0.0017896341,
                              0.0018895044,
                              0.0012307293,
                              0.0014137516,
                              0.006056576,
                              0.004798914,
                              0.007153811,
                              0.012287066,
                              0.0069526862,
                              0.006552648,
                              0.009127433,
                              0.0016479925,
                              0.00014951354,
                              0.004631428,
                              0.0019425795]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_95.0
