
Running comparison for experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805
Directory path: experiments/inpainting/gann_4_night_20180708_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_80.0/images
Optimal number of principal components:  33
Reconstruction error:  10.711919
Energy conservation:  0.8053884
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_80.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [3.933204310299706, 3.0938667236348625],
                   'kl_div': 0.36665335,
                   'ks_tests': {10000: KstestResult(statistic=0.1773, pvalue=1.1529768083743243e-137, statistic_location=0.006242007, statistic_sign=1),
                                20000: KstestResult(statistic=0.1744, pvalue=1.804483368160737e-266, statistic_location=0.0058204704, statistic_sign=1),
                                30000: KstestResult(statistic=0.17969999999999997, pvalue=0.0, statistic_location=0.006495798, statistic_sign=1),
                                40000: KstestResult(statistic=0.17872500000000002, pvalue=0.0, statistic_location=0.006457617, statistic_sign=1),
                                50000: KstestResult(statistic=0.17891999999999997, pvalue=0.0, statistic_location=0.0064969477, statistic_sign=1),
                                60000: KstestResult(statistic=0.1786833333333333, pvalue=0.0, statistic_location=0.0055938317, statistic_sign=1),
                                70000: KstestResult(statistic=0.18134285714285714, pvalue=0.0, statistic_location=0.0058120503, statistic_sign=1),
                                80000: KstestResult(statistic=0.18072500000000002, pvalue=0.0, statistic_location=0.006066245, statistic_sign=1),
                                90000: KstestResult(statistic=0.1786333333333333, pvalue=0.0, statistic_location=0.005823248, statistic_sign=1),
                                100000: KstestResult(statistic=0.17935, pvalue=0.0, statistic_location=0.0062693586, statistic_sign=1),
                                110000: KstestResult(statistic=0.18009090909090908, pvalue=0.0, statistic_location=0.0060238075, statistic_sign=1)},
                   'moments': {'mean_error': 0.08102928,
                               'means': [-1.1889718e-05, -0.00010489126],
                               'stds': [0.017084507, 0.0056310715],
                               'variance_ratio': 7.945818}},
 'originals': {'gan': {'mae': 0.04473433643579483,
                       'mse': 0.005009250715374947,
                       'psnr': 27.33820915222168,
                       'rmse': 0.0707760602235794,
                       'ssim': 0.9471725821495056},
               'pca': {'mae': 0.011866220273077488,
                       'mse': 0.0002704682992771268,
                       'psnr': 39.96768569946289,
                       'rmse': 0.01644591987133026,
                       'ssim': 0.9973368644714355}},
 'reconstructions': {'mae': 0.042279988527297974,
                     'mse': 0.004775016102939844,
                     'psnr': 27.499099731445312,
                     'rmse': 0.0691014900803566,
                     'ssim': 0.9489201903343201},
 'residual_spectra_pcagan': {'cosine': [0.33666798,
                                        0.03890994,
                                        0.35760513,
                                        0.36186552,
                                        0.07068564,
                                        0.38254768,
                                        0.3859069,
                                        0.42566654,
                                        0.41321388,
                                        0.43529445,
                                        0.2774006],
                             'mae': [0.010772294,
                                     0.013452185,
                                     0.009009495,
                                     0.010039241,
                                     0.012158701,
                                     0.008420064,
                                     0.008739293,
                                     0.008652604,
                                     0.008782702,
                                     0.008599853,
                                     0.01135508],
                             'max_mae': 0.013452185,
                             'max_mse': 0.00041932307,
                             'max_rmse': 0.020477379,
                             'median_distance': 1.4572914,
                             'median_mae': 0.009009495,
                             'min_cosine': 0.03890994,
                             'mse': [0.0002939082,
                                     0.00041932307,
                                     0.00021236982,
                                     0.00024395833,
                                     0.00039057055,
                                     0.00018682754,
                                     0.00016472132,
                                     0.00018204693,
                                     0.00020064779,
                                     0.00017376008,
                                     0.00041788863],
                             'rmse': [0.01714375,
                                      0.020477379,
                                      0.014572914,
                                      0.015619165,
                                      0.019762859,
                                      0.013668487,
                                      0.01283438,
                                      0.013492477,
                                      0.01416502,
                                      0.013181808,
                                      0.020442324]},
 'residuals': {'mae': 0.009998319670557976,
               'mse': 0.00026236564735881984,
               'psnr': 20.880552291870117,
               'rmse': 0.016197705641388893,
               'ssds': [32.106564, 3.489165],
               'ssim': 0.422919362783432},
 'spectra_pcagan': {'cosine': [0.99309224,
                               0.9993874,
                               0.99795645,
                               0.99078035,
                               0.9924945,
                               0.99755883,
                               0.99708873,
                               0.9746702,
                               0.99523544,
                               0.99180853,
                               0.98535526],
                    'mae': [0.028776342,
                            0.021966897,
                            0.0368034,
                            0.02415455,
                            0.02132853,
                            0.038325835,
                            0.03004623,
                            0.1935947,
                            0.022773417,
                            0.020473426,
                            0.026836645],
                    'max_mae': 0.1935947,
                    'max_mse': 0.039562304,
                    'max_rmse': 0.19890276,
                    'median_mae': 0.026836645,
                    'min_cosine': 0.9746702,
                    'mse': [0.0015174948,
                            0.0006932228,
                            0.0021679301,
                            0.0010311031,
                            0.0008033064,
                            0.0022411095,
                            0.0014765499,
                            0.039562304,
                            0.00093561294,
                            0.00073520537,
                            0.0013613399],
                    'rmse': [0.038955037,
                             0.026329124,
                             0.046561036,
                             0.032110795,
                             0.02834266,
                             0.04734036,
                             0.0384259,
                             0.19890276,
                             0.03058779,
                             0.02711467,
                             0.03689634]},
 'spectra_realgan': {'cosine': [0.99175346,
                                0.9993864,
                                0.99747366,
                                0.9885627,
                                0.992407,
                                0.99695754,
                                0.9963519,
                                0.9731586,
                                0.99355114,
                                0.9888123,
                                0.9826635],
                     'mae': [0.0322774,
                             0.021971013,
                             0.03922895,
                             0.027653696,
                             0.021448659,
                             0.040448003,
                             0.033102304,
                             0.1935307,
                             0.027468912,
                             0.024600834,
                             0.030347236],
                     'max_mae': 0.1935307,
                     'max_mse': 0.039805476,
                     'max_rmse': 0.1995131,
                     'median_mae': 0.030347236,
                     'min_cosine': 0.9731586,
                     'mse': [0.0018117565,
                             0.00069365033,
                             0.0024994782,
                             0.0012799334,
                             0.00081188104,
                             0.002571153,
                             0.0017536072,
                             0.039805476,
                             0.0012606254,
                             0.0009979106,
                             0.001616281],
                     'rmse': [0.042564735,
                              0.026337242,
                              0.04999478,
                              0.035776157,
                              0.028493525,
                              0.05070654,
                              0.041876093,
                              0.1995131,
                              0.035505287,
                              0.031589724,
                              0.040202998]},
 'spectra_realpca': {'cosine': [0.9985848,
                                0.99999946,
                                0.9994807,
                                0.9975085,
                                0.9999377,
                                0.9993421,
                                0.9991371,
                                0.9983531,
                                0.99836755,
                                0.9966823,
                                0.9970589],
                     'mae': [0.013965566,
                             0.00043760153,
                             0.015608139,
                             0.013119194,
                             0.0019762777,
                             0.015508009,
                             0.015335468,
                             0.014029666,
                             0.014061579,
                             0.0134795075,
                             0.013007417],
                     'max_mae': 0.015608139,
                     'max_mse': 0.0003923621,
                     'max_rmse': 0.019808132,
                     'median_mae': 0.013965566,
                     'min_cosine': 0.9966823,
                     'mse': [0.00031206664,
                             3.0981963e-07,
                             0.0003923621,
                             0.00027741803,
                             6.260682e-06,
                             0.0003841892,
                             0.00037591357,
                             0.00034439893,
                             0.00031792303,
                             0.00029006432,
                             0.000274245],
                     'rmse': [0.017665409,
                              0.0005566144,
                              0.019808132,
                              0.016655872,
                              0.0025021355,
                              0.019600745,
                              0.019388491,
                              0.018557988,
                              0.017830396,
                              0.017031275,
                              0.016560344]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_80.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628
Directory path: experiments/inpainting/gann_4_night_20180708_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_80.0/images
Optimal number of principal components:  33
Reconstruction error:  10.711919
Energy conservation:  0.8053884
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_80.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.079875858281184, 2.898167829281533],
                   'kl_div': 0.66642743,
                   'ks_tests': {10000: KstestResult(statistic=0.2481, pvalue=1.5086739567182236e-270, statistic_location=-0.0057367207, statistic_sign=-1),
                                20000: KstestResult(statistic=0.25479999999999997, pvalue=0.0, statistic_location=-0.0048284614, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2505, pvalue=0.0, statistic_location=-0.0058496, statistic_sign=-1),
                                40000: KstestResult(statistic=0.256075, pvalue=0.0, statistic_location=-0.0060641915, statistic_sign=-1),
                                50000: KstestResult(statistic=0.24858000000000002, pvalue=0.0, statistic_location=-0.005718601, statistic_sign=-1),
                                60000: KstestResult(statistic=0.24994999999999998, pvalue=0.0, statistic_location=-0.0055164923, statistic_sign=-1),
                                70000: KstestResult(statistic=0.24820000000000003, pvalue=0.0, statistic_location=-0.005934395, statistic_sign=-1),
                                80000: KstestResult(statistic=0.24922500000000003, pvalue=0.0, statistic_location=-0.0058238627, statistic_sign=-1),
                                90000: KstestResult(statistic=0.25085555555555555, pvalue=0.0, statistic_location=-0.006140709, statistic_sign=-1),
                                100000: KstestResult(statistic=0.24707, pvalue=0.0, statistic_location=-0.0059142318, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2522, pvalue=0.0, statistic_location=-0.0059099654, statistic_sign=-1),
                                120000: KstestResult(statistic=0.2491833333333333, pvalue=0.0, statistic_location=-0.0057131834, statistic_sign=-1),
                                130000: KstestResult(statistic=0.24761538461538463, pvalue=0.0, statistic_location=-0.005931427, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2479857142857143, pvalue=0.0, statistic_location=-0.006118726, statistic_sign=-1),
                                150000: KstestResult(statistic=0.24916000000000002, pvalue=0.0, statistic_location=-0.005934764, statistic_sign=-1),
                                160000: KstestResult(statistic=0.2493375, pvalue=0.0, statistic_location=-0.0060141254, statistic_sign=-1),
                                170000: KstestResult(statistic=0.24760588235294118, pvalue=0.0, statistic_location=-0.00594184, statistic_sign=-1),
                                180000: KstestResult(statistic=0.2494111111111111, pvalue=0.0, statistic_location=-0.005932912, statistic_sign=-1),
                                190000: KstestResult(statistic=0.24753684210526314, pvalue=0.0, statistic_location=-0.005857574, statistic_sign=-1),
                                200000: KstestResult(statistic=0.24965500000000002, pvalue=0.0, statistic_location=-0.005934395, statistic_sign=-1),
                                210000: KstestResult(statistic=0.24926190476190474, pvalue=0.0, statistic_location=-0.0058812127, statistic_sign=-1),
                                220000: KstestResult(statistic=0.24772272727272726, pvalue=0.0, statistic_location=-0.0059236083, statistic_sign=-1)},
                   'moments': {'mean_error': -0.2069425,
                               'means': [-0.0014181881, -4.999981e-05],
                               'stds': [0.01881039, 0.00502042],
                               'variance_ratio': 11.898439}},
 'originals': {'gan': {'mae': 0.04141571745276451,
                       'mse': 0.0036904599983245134,
                       'psnr': 29.55628204345703,
                       'rmse': 0.060749154537916183,
                       'ssim': 0.9063165187835693},
               'pca': {'mae': 0.00965912640094757,
                       'mse': 0.00021328830916900188,
                       'psnr': 42.10514831542969,
                       'rmse': 0.014604393392801285,
                       'ssim': 0.9944041967391968}},
 'reconstructions': {'mae': 0.03997538983821869,
                     'mse': 0.0034986056853085756,
                     'psnr': 29.95587158203125,
                     'rmse': 0.059149011969566345,
                     'ssim': 0.9093114733695984},
 'residual_spectra_pcagan': {'cosine': [0.03736278,
                                        0.05108042,
                                        0.13265796,
                                        0.280473,
                                        0.29689634,
                                        0.39600167,
                                        0.02301011,
                                        0.30651128,
                                        0.350661,
                                        0.055469066,
                                        0.36286336,
                                        0.33030474,
                                        0.37735766,
                                        0.31382772,
                                        0.33438316,
                                        0.34579408,
                                        0.365867,
                                        0.35813344,
                                        0.11599496,
                                        0.017232431,
                                        0.3708295,
                                        0.031013882],
                             'mae': [0.0141531145,
                                     0.015146587,
                                     0.013599176,
                                     0.013903326,
                                     0.012008323,
                                     0.009946238,
                                     0.014509601,
                                     0.011286731,
                                     0.012001854,
                                     0.013665237,
                                     0.009889419,
                                     0.011190024,
                                     0.010104137,
                                     0.011159384,
                                     0.011868643,
                                     0.011782901,
                                     0.009830305,
                                     0.011380425,
                                     0.011887237,
                                     0.012817087,
                                     0.009959083,
                                     0.011897774],
                             'max_mae': 0.015146587,
                             'max_mse': 0.00049058336,
                             'max_rmse': 0.022149116,
                             'median_distance': 1.776756,
                             'median_mae': 0.01187794,
                             'min_cosine': 0.017232431,
                             'mse': [0.00039639702,
                                     0.00049058336,
                                     0.00043311963,
                                     0.00036954708,
                                     0.00031765847,
                                     0.00020234857,
                                     0.0004367733,
                                     0.00031372014,
                                     0.00030090896,
                                     0.00048736285,
                                     0.0002204194,
                                     0.00026769206,
                                     0.00024954244,
                                     0.0004106007,
                                     0.00031887158,
                                     0.00033383668,
                                     0.00025041113,
                                     0.00028637686,
                                     0.00025917983,
                                     0.00033049582,
                                     0.00028995343,
                                     0.00030929493],
                             'rmse': [0.019909723,
                                      0.022149116,
                                      0.020811526,
                                      0.019223608,
                                      0.017822975,
                                      0.014224928,
                                      0.020899123,
                                      0.017712146,
                                      0.017346727,
                                      0.022076296,
                                      0.014846528,
                                      0.016361298,
                                      0.015796913,
                                      0.020263284,
                                      0.017856976,
                                      0.018271198,
                                      0.015824385,
                                      0.016922673,
                                      0.016099064,
                                      0.018179543,
                                      0.017028019,
                                      0.017586783]},
 'residuals': {'mae': 0.011999391950666904,
               'mse': 0.0003306860744487494,
               'psnr': 19.875465393066406,
               'rmse': 0.018184775486588478,
               'ssds': [78.28488, 5.54554],
               'ssim': 0.326081246137619},
 'spectra_pcagan': {'cosine': [0.99894565,
                               0.99940306,
                               0.9821883,
                               0.9947013,
                               0.99687964,
                               0.99307853,
                               0.9991669,
                               0.99680626,
                               0.98465365,
                               0.9885448,
                               0.99667937,
                               0.9948435,
                               0.9781928,
                               0.99188006,
                               0.9596325,
                               0.97996396,
                               0.9892353,
                               0.9811551,
                               0.98848724,
                               0.9993161,
                               0.98492086,
                               0.99742967],
                    'mae': [0.017117504,
                            0.020167034,
                            0.028082598,
                            0.048485324,
                            0.057363477,
                            0.030390989,
                            0.019979227,
                            0.05427856,
                            0.032555338,
                            0.026165659,
                            0.046969958,
                            0.04294194,
                            0.17967704,
                            0.03072963,
                            0.057732012,
                            0.032949578,
                            0.02572954,
                            0.040232807,
                            0.027235592,
                            0.017707963,
                            0.022818603,
                            0.020148188],
                    'max_mae': 0.17967704,
                    'max_mse': 0.034967214,
                    'max_rmse': 0.18699522,
                    'median_mae': 0.030560309,
                    'min_cosine': 0.9596325,
                    'mse': [0.00047158785,
                            0.000592539,
                            0.0013147222,
                            0.00365928,
                            0.005466302,
                            0.001557112,
                            0.0006229024,
                            0.0043129683,
                            0.0017498597,
                            0.0011668251,
                            0.003270138,
                            0.0029123356,
                            0.034967214,
                            0.0018009093,
                            0.004277143,
                            0.0018821193,
                            0.0011439634,
                            0.0024653035,
                            0.0012023947,
                            0.00047671204,
                            0.0009825141,
                            0.00067446596],
                    'rmse': [0.021716073,
                             0.024342125,
                             0.0362591,
                             0.060491983,
                             0.07393444,
                             0.039460257,
                             0.024958013,
                             0.065673195,
                             0.041831322,
                             0.034158822,
                             0.05718512,
                             0.05396606,
                             0.18699522,
                             0.04243712,
                             0.06539987,
                             0.0433834,
                             0.03382253,
                             0.049651824,
                             0.034675565,
                             0.021833736,
                             0.03134508,
                             0.025970483]},
 'spectra_realgan': {'cosine': [0.9989435,
                                0.99940234,
                                0.9814531,
                                0.99415386,
                                0.99652416,
                                0.9916952,
                                0.99916625,
                                0.99628115,
                                0.9822147,
                                0.9884819,
                                0.99601847,
                                0.9940579,
                                0.9766486,
                                0.9902268,
                                0.9571101,
                                0.9767987,
                                0.9864783,
                                0.97842246,
                                0.9882579,
                                0.99931574,
                                0.98092294,
                                0.99741125],
                     'mae': [0.017146073,
                             0.020168338,
                             0.028706213,
                             0.05080038,
                             0.059404433,
                             0.03350953,
                             0.019985914,
                             0.055692006,
                             0.035312053,
                             0.026215857,
                             0.048675224,
                             0.044680163,
                             0.17965947,
                             0.034048,
                             0.05834629,
                             0.035970148,
                             0.028960336,
                             0.04211719,
                             0.027531927,
                             0.017711481,
                             0.026319299,
                             0.020185547],
                     'max_mae': 0.17965947,
                     'max_mse': 0.03522281,
                     'max_rmse': 0.18767741,
                     'median_mae': 0.033778764,
                     'min_cosine': 0.9571101,
                     'mse': [0.00047266582,
                             0.00059270475,
                             0.0013652452,
                             0.004039467,
                             0.0058127195,
                             0.0018575714,
                             0.0006232368,
                             0.0046497514,
                             0.0020181763,
                             0.0011730577,
                             0.0036266036,
                             0.0031747748,
                             0.03522281,
                             0.0021111225,
                             0.004506631,
                             0.0021810557,
                             0.0014073143,
                             0.002753931,
                             0.0012253441,
                             0.00047696987,
                             0.0012224697,
                             0.0006764924],
                     'rmse': [0.02174088,
                              0.024345528,
                              0.036949225,
                              0.0635568,
                              0.076241195,
                              0.043099552,
                              0.02496471,
                              0.068189085,
                              0.044924118,
                              0.03424993,
                              0.06022129,
                              0.05634514,
                              0.18767741,
                              0.045946952,
                              0.067131445,
                              0.046701774,
                              0.037514187,
                              0.05247791,
                              0.035004918,
                              0.02183964,
                              0.034963835,
                              0.026009468]},
 'spectra_realpca': {'cosine': [0.99999857,
                                0.99999964,
                                0.99941736,
                                0.99941325,
                                0.99963444,
                                0.9985848,
                                0.99999946,
                                0.9994807,
                                0.9975085,
                                0.9999377,
                                0.9993421,
                                0.9991371,
                                0.9983531,
                                0.99836755,
                                0.9966823,
                                0.9970589,
                                0.99717426,
                                0.9972464,
                                0.99986774,
                                0.9999996,
                                0.9960936,
                                0.99998784],
                     'mae': [0.00062334706,
                             0.00039045425,
                             0.0051291445,
                             0.015883803,
                             0.016881369,
                             0.013965566,
                             0.00043760153,
                             0.015608139,
                             0.013119194,
                             0.0019762777,
                             0.015508009,
                             0.015335468,
                             0.014029666,
                             0.014061579,
                             0.0134795075,
                             0.013007417,
                             0.013006158,
                             0.013540988,
                             0.0027754996,
                             0.0003961035,
                             0.012026079,
                             0.0013194246],
                     'max_mae': 0.016881369,
                     'max_mse': 0.00045783888,
                     'max_rmse': 0.02139717,
                     'median_mae': 0.013063306,
                     'min_cosine': 0.9960936,
                     'mse': [6.2147603e-07,
                             2.4323953e-07,
                             4.2358606e-05,
                             0.00040609512,
                             0.00045783888,
                             0.00031206664,
                             3.0981963e-07,
                             0.0003923621,
                             0.00027741803,
                             6.260682e-06,
                             0.0003841892,
                             0.00037591357,
                             0.00034439893,
                             0.00031792303,
                             0.00029006432,
                             0.000274245,
                             0.0002700774,
                             0.00029155027,
                             1.2266539e-05,
                             2.5233686e-07,
                             0.00023309367,
                             2.793885e-06],
                     'rmse': [0.0007883375,
                              0.0004931932,
                              0.006508349,
                              0.020151801,
                              0.02139717,
                              0.017665409,
                              0.0005566144,
                              0.019808132,
                              0.016655872,
                              0.0025021355,
                              0.019600745,
                              0.019388491,
                              0.018557988,
                              0.017830396,
                              0.017031275,
                              0.016560344,
                              0.016434032,
                              0.017074844,
                              0.003502362,
                              0.0005023314,
                              0.015267406,
                              0.0016714919]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_80.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354
Directory path: experiments/inpainting/gann_4_night_20180708_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_80.0/images
Optimal number of principal components:  33
Reconstruction error:  10.711919
Energy conservation:  0.8053884
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_80.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.061857105227111, 2.6907302680726195],
                   'kl_div': 0.8330178,
                   'ks_tests': {10000: KstestResult(statistic=0.2676, pvalue=3.144850127e-315, statistic_location=-0.00430004, statistic_sign=-1),
                                20000: KstestResult(statistic=0.26789999999999997, pvalue=0.0, statistic_location=-0.0042770486, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2589, pvalue=0.0, statistic_location=-0.005076293, statistic_sign=-1),
                                40000: KstestResult(statistic=0.26094999999999996, pvalue=0.0, statistic_location=-0.0047458317, statistic_sign=-1),
                                50000: KstestResult(statistic=0.26171999999999995, pvalue=0.0, statistic_location=-0.004000031, statistic_sign=-1),
                                60000: KstestResult(statistic=0.26180000000000003, pvalue=0.0, statistic_location=-0.0042362455, statistic_sign=-1),
                                70000: KstestResult(statistic=0.26371428571428573, pvalue=0.0, statistic_location=-0.004246846, statistic_sign=-1),
                                80000: KstestResult(statistic=0.259275, pvalue=0.0, statistic_location=-0.0043043885, statistic_sign=-1),
                                90000: KstestResult(statistic=0.25926666666666665, pvalue=0.0, statistic_location=-0.0042832587, statistic_sign=-1),
                                100000: KstestResult(statistic=0.26087, pvalue=0.0, statistic_location=-0.004288373, statistic_sign=-1),
                                110000: KstestResult(statistic=0.25984545454545455, pvalue=0.0, statistic_location=-0.0042564212, statistic_sign=-1),
                                120000: KstestResult(statistic=0.260525, pvalue=0.0, statistic_location=-0.0042466074, statistic_sign=-1),
                                130000: KstestResult(statistic=0.2601307692307693, pvalue=0.0, statistic_location=-0.0042773895, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2591285714285715, pvalue=0.0, statistic_location=-0.0042539127, statistic_sign=-1),
                                150000: KstestResult(statistic=0.26076, pvalue=0.0, statistic_location=-0.0041777883, statistic_sign=-1),
                                160000: KstestResult(statistic=0.2600375, pvalue=0.0, statistic_location=-0.004209387, statistic_sign=-1),
                                170000: KstestResult(statistic=0.2588117647058824, pvalue=0.0, statistic_location=-0.004299151, statistic_sign=-1),
                                180000: KstestResult(statistic=0.2618166666666667, pvalue=0.0, statistic_location=-0.0043000807, statistic_sign=-1),
                                190000: KstestResult(statistic=0.2631157894736842, pvalue=0.0, statistic_location=-0.004288324, statistic_sign=-1),
                                200000: KstestResult(statistic=0.25839500000000004, pvalue=0.0, statistic_location=-0.004236916, statistic_sign=-1),
                                210000: KstestResult(statistic=0.26398571428571427, pvalue=0.0, statistic_location=-0.004303147, statistic_sign=-1),
                                220000: KstestResult(statistic=0.25972272727272727, pvalue=0.0, statistic_location=-0.004282795, statistic_sign=-1),
                                230000: KstestResult(statistic=0.2590652173913044, pvalue=0.0, statistic_location=-0.0042625926, statistic_sign=-1),
                                240000: KstestResult(statistic=0.2608, pvalue=0.0, statistic_location=-0.0043050954, statistic_sign=-1),
                                250000: KstestResult(statistic=0.26113200000000003, pvalue=0.0, statistic_location=-0.0042799916, statistic_sign=-1),
                                260000: KstestResult(statistic=0.2623076923076923, pvalue=0.0, statistic_location=-0.0042656213, statistic_sign=-1),
                                270000: KstestResult(statistic=0.26171481481481484, pvalue=0.0, statistic_location=-0.0045049563, statistic_sign=-1),
                                280000: KstestResult(statistic=0.2587178571428571, pvalue=0.0, statistic_location=-0.0044926526, statistic_sign=-1),
                                290000: KstestResult(statistic=0.2602, pvalue=0.0, statistic_location=-0.00431744, statistic_sign=-1),
                                300000: KstestResult(statistic=0.2593566666666667, pvalue=0.0, statistic_location=-0.0042680763, statistic_sign=-1),
                                310000: KstestResult(statistic=0.2603064516129032, pvalue=0.0, statistic_location=-0.004235321, statistic_sign=-1),
                                320000: KstestResult(statistic=0.260578125, pvalue=0.0, statistic_location=-0.0042777634, statistic_sign=-1),
                                330000: KstestResult(statistic=0.26181515151515156, pvalue=0.0, statistic_location=-0.004299501, statistic_sign=-1)},
                   'moments': {'mean_error': -0.061998487,
                               'means': [-0.0005078844, -3.0160216e-05],
                               'stds': [0.017889043, 0.0044290265],
                               'variance_ratio': 14.890975}},
 'originals': {'gan': {'mae': 0.03434794768691063,
                       'mse': 0.0026877608615905046,
                       'psnr': 30.955209732055664,
                       'rmse': 0.05184362083673477,
                       'ssim': 0.9331126809120178},
               'pca': {'mae': 0.007581521291285753,
                       'mse': 0.00015547980729024857,
                       'psnr': 43.56008529663086,
                       'rmse': 0.012469153851270676,
                       'ssim': 0.9963163733482361}},
 'reconstructions': {'mae': 0.03318274766206741,
                     'mse': 0.002545856172218919,
                     'psnr': 31.418485641479492,
                     'rmse': 0.05045647919178009,
                     'ssim': 0.9352277517318726},
 'residual_spectra_pcagan': {'cosine': [0.057990026,
                                        0.057621144,
                                        0.35657454,
                                        0.101057716,
                                        0.29994506,
                                        0.046665546,
                                        0.03365249,
                                        0.046534996,
                                        0.13362736,
                                        0.2766117,
                                        0.30814856,
                                        0.4081327,
                                        0.024996853,
                                        0.31162074,
                                        0.37483463,
                                        0.06360726,
                                        0.3780793,
                                        0.33228177,
                                        0.38217023,
                                        0.32398415,
                                        0.34783435,
                                        0.35800037,
                                        0.37939146,
                                        0.37381718,
                                        0.1172091,
                                        0.016547197,
                                        0.3748422,
                                        0.029221833,
                                        0.37942308,
                                        0.09118708,
                                        0.1421262,
                                        0.063885435,
                                        0.015925314],
                             'mae': [0.01083111,
                                     0.011650323,
                                     0.009471324,
                                     0.012035121,
                                     0.01045613,
                                     0.014446717,
                                     0.014289175,
                                     0.015049594,
                                     0.013477517,
                                     0.013913121,
                                     0.011616989,
                                     0.009634714,
                                     0.014328763,
                                     0.011139821,
                                     0.011439565,
                                     0.01314837,
                                     0.009488247,
                                     0.0110638,
                                     0.009851306,
                                     0.010873164,
                                     0.01160223,
                                     0.011514248,
                                     0.009619935,
                                     0.011114932,
                                     0.011798971,
                                     0.01261391,
                                     0.009802696,
                                     0.011962288,
                                     0.0102085285,
                                     0.010878131,
                                     0.01033246,
                                     0.011574454,
                                     0.0134546375],
                             'max_mae': 0.015049594,
                             'max_mse': 0.00047203922,
                             'max_rmse': 0.021726463,
                             'median_distance': 1.6767137,
                             'median_mae': 0.011514248,
                             'min_cosine': 0.015925314,
                             'mse': [0.00021895762,
                                     0.00025555285,
                                     0.00019321058,
                                     0.00035542058,
                                     0.0002083514,
                                     0.0004316759,
                                     0.00040700092,
                                     0.00047203922,
                                     0.00041940555,
                                     0.0003765027,
                                     0.00029766344,
                                     0.00019218001,
                                     0.00042048685,
                                     0.0003018686,
                                     0.0002574923,
                                     0.00041526952,
                                     0.00019639253,
                                     0.00026762998,
                                     0.00023576128,
                                     0.00037746227,
                                     0.00029418684,
                                     0.0003211523,
                                     0.00022870078,
                                     0.00026249155,
                                     0.00025148035,
                                     0.0003235913,
                                     0.0002811369,
                                     0.00032177498,
                                     0.0002382391,
                                     0.0002164505,
                                     0.00022869899,
                                     0.00027946802,
                                     0.0003651799],
                             'rmse': [0.014797216,
                                      0.01598602,
                                      0.013900021,
                                      0.0188526,
                                      0.014434382,
                                      0.020776812,
                                      0.020174263,
                                      0.021726463,
                                      0.020479394,
                                      0.019403677,
                                      0.017252926,
                                      0.0138629,
                                      0.020505777,
                                      0.017374367,
                                      0.016046567,
                                      0.020378163,
                                      0.014014012,
                                      0.0163594,
                                      0.01535452,
                                      0.01942839,
                                      0.017151875,
                                      0.017920723,
                                      0.015122856,
                                      0.016201591,
                                      0.015858132,
                                      0.017988643,
                                      0.016767137,
                                      0.017938087,
                                      0.015434996,
                                      0.014712256,
                                      0.015122797,
                                      0.016717296,
                                      0.019109681]},
 'residuals': {'mae': 0.011657040566205978,
               'mse': 0.0003003901510965079,
               'psnr': 20.292768478393555,
               'rmse': 0.017331767827272415,
               'ssds': [105.69071, 6.473652],
               'ssim': 0.32043033838272095},
 'spectra_pcagan': {'cosine': [0.9972639,
                               0.99922514,
                               0.98559475,
                               0.9943228,
                               0.9844302,
                               0.998492,
                               0.99892604,
                               0.99940944,
                               0.98202825,
                               0.9946504,
                               0.99689835,
                               0.9931203,
                               0.99917537,
                               0.99681085,
                               0.98499006,
                               0.9890225,
                               0.99674284,
                               0.99483776,
                               0.978141,
                               0.9921186,
                               0.9601105,
                               0.9806103,
                               0.98942965,
                               0.98132294,
                               0.98845154,
                               0.99931204,
                               0.98474467,
                               0.99738425,
                               0.9872785,
                               0.9954052,
                               0.99528146,
                               0.9983513,
                               0.9996884],
                    'mae': [0.018500164,
                            0.014950876,
                            0.021983923,
                            0.02090258,
                            0.022786526,
                            0.018269638,
                            0.01731178,
                            0.019903721,
                            0.02816393,
                            0.04859419,
                            0.057161864,
                            0.030253714,
                            0.019977035,
                            0.05356788,
                            0.03223577,
                            0.02572341,
                            0.046688158,
                            0.043382768,
                            0.18027717,
                            0.029943094,
                            0.057426807,
                            0.03242121,
                            0.02542016,
                            0.04034764,
                            0.027288046,
                            0.017821949,
                            0.022786826,
                            0.020140871,
                            0.022648502,
                            0.020563442,
                            0.021863412,
                            0.0189025,
                            0.016821267],
                    'max_mae': 0.18027717,
                    'max_mse': 0.03520072,
                    'max_rmse': 0.18761854,
                    'median_mae': 0.022786826,
                    'min_cosine': 0.9601105,
                    'mse': [0.0005553851,
                            0.00035710048,
                            0.00081982726,
                            0.0007464263,
                            0.0008781192,
                            0.0005718839,
                            0.00048397804,
                            0.00057876576,
                            0.0013227009,
                            0.0036929706,
                            0.0054234806,
                            0.0015444902,
                            0.0006218006,
                            0.0042298865,
                            0.0017114131,
                            0.0011125372,
                            0.0032301517,
                            0.0029419777,
                            0.03520072,
                            0.0017276802,
                            0.0042285314,
                            0.0018178269,
                            0.0011135648,
                            0.0024447239,
                            0.0012083082,
                            0.0004814268,
                            0.000989612,
                            0.0006800364,
                            0.0008417952,
                            0.00068214466,
                            0.00078607013,
                            0.00057568675,
                            0.0004122409],
                    'rmse': [0.02356661,
                             0.018897103,
                             0.028632626,
                             0.027320804,
                             0.029633077,
                             0.023914095,
                             0.0219995,
                             0.02405755,
                             0.036368955,
                             0.060769815,
                             0.07364429,
                             0.039300002,
                             0.02493593,
                             0.06503758,
                             0.04136923,
                             0.03335472,
                             0.056834422,
                             0.05424,
                             0.18761854,
                             0.041565374,
                             0.06502716,
                             0.04263598,
                             0.03337012,
                             0.04944415,
                             0.03476073,
                             0.02194144,
                             0.0314581,
                             0.026077507,
                             0.029013706,
                             0.026117899,
                             0.028036943,
                             0.023993474,
                             0.020303717]},
 'spectra_realgan': {'cosine': [0.9972507,
                                0.9992217,
                                0.9832243,
                                0.9942406,
                                0.98270684,
                                0.99848765,
                                0.9989239,
                                0.99940866,
                                0.98129684,
                                0.9941069,
                                0.996538,
                                0.9917249,
                                0.99917454,
                                0.9962871,
                                0.98253864,
                                0.9889617,
                                0.9960905,
                                0.994045,
                                0.9766165,
                                0.9904791,
                                0.9575873,
                                0.97740895,
                                0.98670197,
                                0.97857785,
                                0.98822325,
                                0.99931175,
                                0.9807604,
                                0.99736637,
                                0.9840904,
                                0.9953627,
                                0.99517846,
                                0.99834555,
                                0.9996882],
                     'mae': [0.018541973,
                             0.014985775,
                             0.02386623,
                             0.021071842,
                             0.024249298,
                             0.018311137,
                             0.017341804,
                             0.019904895,
                             0.028784148,
                             0.05091309,
                             0.059168056,
                             0.033459667,
                             0.019981584,
                             0.055011425,
                             0.034977544,
                             0.025771717,
                             0.04837447,
                             0.04506424,
                             0.18023525,
                             0.033359118,
                             0.05806257,
                             0.035551503,
                             0.02864438,
                             0.042166773,
                             0.02758376,
                             0.01782493,
                             0.026277808,
                             0.020177415,
                             0.025291368,
                             0.020647036,
                             0.022136088,
                             0.018928431,
                             0.016816895],
                     'max_mae': 0.18023525,
                     'max_mse': 0.035449773,
                     'max_rmse': 0.1882811,
                     'median_mae': 0.025771717,
                     'min_cosine': 0.9575873,
                     'mse': [0.0005579768,
                             0.0003586828,
                             0.0009543781,
                             0.0007570529,
                             0.00097594125,
                             0.0005737485,
                             0.00048503466,
                             0.00057895307,
                             0.0013730444,
                             0.0040705525,
                             0.005776141,
                             0.0018476726,
                             0.00062216754,
                             0.0045668143,
                             0.0019810977,
                             0.0011185798,
                             0.0035820678,
                             0.0032059608,
                             0.035449773,
                             0.0020360262,
                             0.0044579804,
                             0.002119876,
                             0.001374371,
                             0.002734498,
                             0.0012311825,
                             0.00048168038,
                             0.0012288566,
                             0.00068194215,
                             0.0010366915,
                             0.0006882512,
                             0.0008001519,
                             0.00057677197,
                             0.00041220099],
                     'rmse': [0.023621531,
                              0.018938923,
                              0.030893011,
                              0.027514594,
                              0.031240059,
                              0.023953049,
                              0.022023503,
                              0.024061443,
                              0.037054613,
                              0.06380088,
                              0.07600093,
                              0.042984564,
                              0.024943287,
                              0.06757821,
                              0.044509523,
                              0.033445176,
                              0.05985038,
                              0.056621205,
                              0.1882811,
                              0.045122348,
                              0.06676811,
                              0.04604211,
                              0.03707251,
                              0.052292425,
                              0.03508821,
                              0.021947218,
                              0.035055052,
                              0.026114022,
                              0.032197695,
                              0.026234543,
                              0.028286956,
                              0.024016077,
                              0.020302733]},
 'spectra_realpca': {'cosine': [0.99999315,
                                0.9999987,
                                0.9975809,
                                0.99993336,
                                0.99825996,
                                0.999998,
                                0.99999857,
                                0.99999964,
                                0.99941736,
                                0.99941325,
                                0.99963444,
                                0.9985848,
                                0.99999946,
                                0.9994807,
                                0.9975085,
                                0.9999377,
                                0.9993421,
                                0.9991371,
                                0.9983531,
                                0.99836755,
                                0.9966823,
                                0.9970589,
                                0.99717426,
                                0.9972464,
                                0.99986774,
                                0.9999996,
                                0.9960936,
                                0.99998784,
                                0.99708563,
                                0.99996614,
                                0.99989355,
                                0.999997,
                                0.99999976],
                     'mae': [0.00091701985,
                             0.0006181604,
                             0.009227894,
                             0.0023324883,
                             0.007822132,
                             0.0006810386,
                             0.00062334706,
                             0.00039045425,
                             0.0051291445,
                             0.015883803,
                             0.016881369,
                             0.013965566,
                             0.00043760153,
                             0.015608139,
                             0.013119194,
                             0.0019762777,
                             0.015508009,
                             0.015335468,
                             0.014029666,
                             0.014061579,
                             0.0134795075,
                             0.013007417,
                             0.013006158,
                             0.013540988,
                             0.0027754996,
                             0.0003961035,
                             0.012026079,
                             0.0013194246,
                             0.010443308,
                             0.0017547737,
                             0.0029263133,
                             0.00072214706,
                             0.0002441642],
                     'max_mae': 0.016881369,
                     'max_mse': 0.00045783888,
                     'max_rmse': 0.02139717,
                     'median_mae': 0.007822132,
                     'min_cosine': 0.9960936,
                     'mse': [1.354285e-06,
                             6.115705e-07,
                             0.00013532718,
                             8.745081e-06,
                             9.732204e-05,
                             7.519756e-07,
                             6.2147603e-07,
                             2.4323953e-07,
                             4.2358606e-05,
                             0.00040609512,
                             0.00045783888,
                             0.00031206664,
                             3.0981963e-07,
                             0.0003923621,
                             0.00027741803,
                             6.260682e-06,
                             0.0003841892,
                             0.00037591357,
                             0.00034439893,
                             0.00031792303,
                             0.00029006432,
                             0.000274245,
                             0.0002700774,
                             0.00029155027,
                             1.2266539e-05,
                             2.5233686e-07,
                             0.00023309367,
                             2.793885e-06,
                             0.00017467339,
                             5.022327e-06,
                             1.3738659e-05,
                             8.490995e-07,
                             9.5716224e-08],
                     'rmse': [0.0011637375,
                              0.0007820297,
                              0.011633021,
                              0.0029572083,
                              0.009865194,
                              0.0008671653,
                              0.0007883375,
                              0.0004931932,
                              0.006508349,
                              0.020151801,
                              0.02139717,
                              0.017665409,
                              0.0005566144,
                              0.019808132,
                              0.016655872,
                              0.0025021355,
                              0.019600745,
                              0.019388491,
                              0.018557988,
                              0.017830396,
                              0.017031275,
                              0.016560344,
                              0.016434032,
                              0.017074844,
                              0.003502362,
                              0.0005023314,
                              0.015267406,
                              0.0016714919,
                              0.013216406,
                              0.0022410548,
                              0.0037065698,
                              0.0009214659,
                              0.00030938038]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_80.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516
Directory path: experiments/inpainting/gann_4_night_20180722_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_80.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_80.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.35918432275619, 3.1215890132546327],
                   'kl_div': 0.8423621,
                   'ks_tests': {10000: KstestResult(statistic=0.3067, pvalue=1e-323, statistic_location=0.008179503, statistic_sign=1),
                                20000: KstestResult(statistic=0.30080000000000007, pvalue=0.0, statistic_location=0.008291485, statistic_sign=1),
                                30000: KstestResult(statistic=0.3066000000000001, pvalue=0.0, statistic_location=0.008693956, statistic_sign=1),
                                40000: KstestResult(statistic=0.3057000000000001, pvalue=0.0, statistic_location=0.008756464, statistic_sign=1),
                                50000: KstestResult(statistic=0.30252, pvalue=0.0, statistic_location=0.0088835545, statistic_sign=1),
                                60000: KstestResult(statistic=0.3026500000000001, pvalue=0.0, statistic_location=0.008682785, statistic_sign=1),
                                70000: KstestResult(statistic=0.3069428571428571, pvalue=0.0, statistic_location=0.008601122, statistic_sign=1),
                                80000: KstestResult(statistic=0.303925, pvalue=0.0, statistic_location=0.008600043, statistic_sign=1),
                                90000: KstestResult(statistic=0.30371111111111104, pvalue=0.0, statistic_location=0.0086937435, statistic_sign=1),
                                100000: KstestResult(statistic=0.30365, pvalue=0.0, statistic_location=0.0086937435, statistic_sign=1),
                                110000: KstestResult(statistic=0.3037181818181819, pvalue=0.0, statistic_location=0.00876186, statistic_sign=1)},
                   'moments': {'mean_error': 0.08277822,
                               'means': [-0.00073593855, -0.00044577167],
                               'stds': [0.022726193, 0.005489738],
                               'variance_ratio': 8.24979}},
 'originals': {'gan': {'mae': 0.05885758250951767,
                       'mse': 0.005448393989354372,
                       'psnr': 27.10418128967285,
                       'rmse': 0.07381323724985123,
                       'ssim': 0.603545069694519},
               'pca': {'mae': 0.012983637861907482,
                       'mse': 0.0002722899953369051,
                       'psnr': 40.598304748535156,
                       'rmse': 0.016501212492585182,
                       'ssim': 0.9844791293144226}},
 'reconstructions': {'mae': 0.057177815586328506,
                     'mse': 0.005125264637172222,
                     'psnr': 27.851459503173828,
                     'rmse': 0.07159095257520676,
                     'ssim': 0.6051655411720276},
 'residual_spectra_pcagan': {'cosine': [0.26564148,
                                        0.23854306,
                                        0.23416865,
                                        0.26053408,
                                        0.25381,
                                        0.33885944,
                                        0.29297134,
                                        0.24404314,
                                        0.2251663,
                                        0.22150944,
                                        0.2624583],
                             'mae': [0.014994153,
                                     0.017118374,
                                     0.017104134,
                                     0.016188318,
                                     0.014930034,
                                     0.014704486,
                                     0.013270199,
                                     0.018236991,
                                     0.020036701,
                                     0.018978633,
                                     0.016830673],
                             'max_mae': 0.020036701,
                             'max_mse': 0.0006272451,
                             'max_rmse': 0.025044862,
                             'median_distance': 2.189767,
                             'median_mae': 0.016830673,
                             'min_cosine': 0.22150944,
                             'mse': [0.0003872383,
                                     0.0006108163,
                                     0.0005075031,
                                     0.00041695996,
                                     0.00047950787,
                                     0.00036319596,
                                     0.0003557844,
                                     0.0005323883,
                                     0.0006272451,
                                     0.0005663711,
                                     0.0004724926],
                             'rmse': [0.019678371,
                                      0.024714697,
                                      0.022527829,
                                      0.020419598,
                                      0.021897668,
                                      0.0190577,
                                      0.018862247,
                                      0.023073541,
                                      0.025044862,
                                      0.023798551,
                                      0.021736896]},
 'residuals': {'mae': 0.016581155359745026,
               'mse': 0.0004835911968257278,
               'psnr': 8.197175025939941,
               'rmse': 0.021990707144141197,
               'ssds': [56.87184, 3.3369234],
               'ssim': 0.12163029611110687},
 'spectra_pcagan': {'cosine': [0.99116933,
                               0.9842978,
                               0.96088547,
                               0.95188564,
                               0.95586,
                               0.972211,
                               0.975154,
                               0.93962836,
                               0.9159561,
                               0.91690403,
                               0.9272211],
                    'mae': [0.071225174,
                            0.07258539,
                            0.06246844,
                            0.06437354,
                            0.045106705,
                            0.042673133,
                            0.03895635,
                            0.054263283,
                            0.06242841,
                            0.059908032,
                            0.05496742],
                    'max_mae': 0.07258539,
                    'max_mse': 0.007976555,
                    'max_rmse': 0.08931156,
                    'median_mae': 0.059908032,
                    'min_cosine': 0.9159561,
                    'mse': [0.0075000906,
                            0.007976555,
                            0.005692697,
                            0.006373456,
                            0.0031035342,
                            0.0027325316,
                            0.0024625135,
                            0.004419792,
                            0.0059709065,
                            0.005377533,
                            0.004768304],
                    'rmse': [0.08660306,
                             0.08931156,
                             0.075449966,
                             0.07983393,
                             0.055709373,
                             0.052273624,
                             0.04962372,
                             0.066481516,
                             0.07727164,
                             0.07333166,
                             0.069052905]},
 'spectra_realgan': {'cosine': [0.99050224,
                                0.98320454,
                                0.958425,
                                0.9485156,
                                0.95228004,
                                0.96986884,
                                0.97265184,
                                0.9365318,
                                0.912984,
                                0.91408354,
                                0.92231876],
                     'mae': [0.073525995,
                             0.07423982,
                             0.06392931,
                             0.066407725,
                             0.046533234,
                             0.044256676,
                             0.041072655,
                             0.05594315,
                             0.06368616,
                             0.06099438,
                             0.056844275],
                     'max_mae': 0.07423982,
                     'max_mse': 0.00842498,
                     'max_rmse': 0.09178769,
                     'median_mae': 0.06099438,
                     'min_cosine': 0.912984,
                     'mse': [0.008046477,
                             0.00842498,
                             0.0059988564,
                             0.0067990287,
                             0.0033501007,
                             0.0030101966,
                             0.0027172633,
                             0.004679983,
                             0.006192801,
                             0.005587246,
                             0.0051254076],
                     'rmse': [0.08970216,
                              0.09178769,
                              0.07745229,
                              0.08245622,
                              0.057880055,
                              0.05486526,
                              0.052127376,
                              0.068410404,
                              0.07869435,
                              0.07474788,
                              0.07159195]},
 'spectra_realpca': {'cosine': [0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349],
                     'mae': [0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197],
                     'max_mae': 0.015567541,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.012521197,
                     'min_cosine': 0.9963109,
                     'mse': [0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102],
                     'rmse': [0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_80.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115
Directory path: experiments/inpainting/gann_4_night_20180722_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_80.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_80.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.22363691969865, 3.112562869251242],
                   'kl_div': 0.6277143,
                   'ks_tests': {10000: KstestResult(statistic=0.2548, pvalue=1.680366247837351e-285, statistic_location=0.008400853, statistic_sign=1),
                                20000: KstestResult(statistic=0.25265000000000004, pvalue=0.0, statistic_location=0.008500584, statistic_sign=1),
                                30000: KstestResult(statistic=0.2539, pvalue=0.0, statistic_location=0.008012868, statistic_sign=1),
                                40000: KstestResult(statistic=0.25575000000000003, pvalue=0.0, statistic_location=0.008484378, statistic_sign=1),
                                50000: KstestResult(statistic=0.25576, pvalue=0.0, statistic_location=0.008136401, statistic_sign=1),
                                60000: KstestResult(statistic=0.2505833333333334, pvalue=0.0, statistic_location=0.008271135, statistic_sign=1),
                                70000: KstestResult(statistic=0.2564000000000001, pvalue=0.0, statistic_location=0.008342166, statistic_sign=1),
                                80000: KstestResult(statistic=0.25534999999999997, pvalue=0.0, statistic_location=0.008181885, statistic_sign=1),
                                90000: KstestResult(statistic=0.2541888888888889, pvalue=0.0, statistic_location=0.008129517, statistic_sign=1),
                                100000: KstestResult(statistic=0.2543500000000001, pvalue=0.0, statistic_location=0.008619256, statistic_sign=1),
                                110000: KstestResult(statistic=0.25236363636363635, pvalue=0.0, statistic_location=0.008462103, statistic_sign=1),
                                120000: KstestResult(statistic=0.2515666666666667, pvalue=0.0, statistic_location=0.0082676895, statistic_sign=1),
                                130000: KstestResult(statistic=0.25216153846153855, pvalue=0.0, statistic_location=0.008079743, statistic_sign=1),
                                140000: KstestResult(statistic=0.25425714285714285, pvalue=0.0, statistic_location=0.008374175, statistic_sign=1),
                                150000: KstestResult(statistic=0.25394000000000005, pvalue=0.0, statistic_location=0.008505292, statistic_sign=1),
                                160000: KstestResult(statistic=0.25543125, pvalue=0.0, statistic_location=0.008359736, statistic_sign=1),
                                170000: KstestResult(statistic=0.2511529411764707, pvalue=0.0, statistic_location=0.008374482, statistic_sign=1),
                                180000: KstestResult(statistic=0.2514722222222222, pvalue=0.0, statistic_location=0.008496827, statistic_sign=1),
                                190000: KstestResult(statistic=0.2526894736842106, pvalue=0.0, statistic_location=0.008585449, statistic_sign=1),
                                200000: KstestResult(statistic=0.25319, pvalue=0.0, statistic_location=0.008590412, statistic_sign=1),
                                210000: KstestResult(statistic=0.25115714285714286, pvalue=0.0, statistic_location=0.008625232, statistic_sign=1),
                                220000: KstestResult(statistic=0.2526772727272727, pvalue=0.0, statistic_location=0.008010173, statistic_sign=1)},
                   'moments': {'mean_error': 0.0038906129,
                               'means': [-0.00054423965, -5.0476283e-05],
                               'stds': [0.019667108, 0.0054564234],
                               'variance_ratio': 8.458123}},
 'originals': {'gan': {'mae': 0.05455929413437843,
                       'mse': 0.004739472642540932,
                       'psnr': 27.725784301757812,
                       'rmse': 0.06884382665157318,
                       'ssim': 0.6566916704177856},
               'pca': {'mae': 0.013096767477691174,
                       'mse': 0.00027656604652293026,
                       'psnr': 40.53063201904297,
                       'rmse': 0.016630275174975395,
                       'ssim': 0.9780802726745605}},
 'reconstructions': {'mae': 0.05278368294239044,
                     'mse': 0.004443435464054346,
                     'psnr': 28.471435546875,
                     'rmse': 0.0666591003537178,
                     'ssim': 0.6628926396369934},
 'residual_spectra_pcagan': {'cosine': [0.28260374,
                                        0.25427267,
                                        0.268355,
                                        0.29584593,
                                        0.23188978,
                                        0.28962916,
                                        0.25852224,
                                        0.26286912,
                                        0.29332796,
                                        0.2820993,
                                        0.37338552,
                                        0.32056358,
                                        0.26874948,
                                        0.25312474,
                                        0.2513672,
                                        0.27952856,
                                        0.23953755,
                                        0.28502464,
                                        0.30253372,
                                        0.32720825,
                                        0.27045548,
                                        0.29371408],
                             'mae': [0.010502031,
                                     0.010798579,
                                     0.010070845,
                                     0.010413214,
                                     0.012834576,
                                     0.012951301,
                                     0.0151773235,
                                     0.014890109,
                                     0.013906689,
                                     0.012997799,
                                     0.012823609,
                                     0.011811436,
                                     0.016060349,
                                     0.017822467,
                                     0.016626589,
                                     0.01516656,
                                     0.016007427,
                                     0.013797997,
                                     0.013872792,
                                     0.012407163,
                                     0.016223252,
                                     0.01292536],
                             'max_mae': 0.017822467,
                             'max_mse': 0.0005019679,
                             'max_rmse': 0.02240464,
                             'median_distance': 1.8121607,
                             'median_mae': 0.013397898,
                             'min_cosine': 0.23188978,
                             'mse': [0.00025930666,
                                     0.00030546763,
                                     0.00030148434,
                                     0.00024392085,
                                     0.00033087173,
                                     0.0003042353,
                                     0.0004983933,
                                     0.0003948954,
                                     0.00032153615,
                                     0.00038831035,
                                     0.0002838249,
                                     0.00029352694,
                                     0.00043116504,
                                     0.0005019679,
                                     0.00044528552,
                                     0.0003979254,
                                     0.00041768374,
                                     0.00035424353,
                                     0.0003210409,
                                     0.00029152032,
                                     0.00044081043,
                                     0.0003259229],
                             'rmse': [0.016103001,
                                      0.017477632,
                                      0.017363304,
                                      0.015617966,
                                      0.01818988,
                                      0.017442342,
                                      0.022324724,
                                      0.019871976,
                                      0.01793143,
                                      0.019705592,
                                      0.016847104,
                                      0.017132629,
                                      0.020764515,
                                      0.02240464,
                                      0.02110179,
                                      0.019948067,
                                      0.020437313,
                                      0.018821359,
                                      0.017917614,
                                      0.017073967,
                                      0.020995487,
                                      0.018053336]},
 'residuals': {'mae': 0.013640339486300945,
               'mse': 0.0003569700347725302,
               'psnr': 20.099227905273438,
               'rmse': 0.0188936498016119,
               'ssds': [85.1597, 6.550493],
               'ssim': 0.16781511902809143},
 'spectra_pcagan': {'cosine': [0.9902773,
                               0.99058205,
                               0.98593557,
                               0.98166245,
                               0.98475355,
                               0.99134403,
                               0.98469067,
                               0.9618693,
                               0.9533671,
                               0.9566785,
                               0.97290313,
                               0.9757846,
                               0.94132704,
                               0.91703165,
                               0.91814286,
                               0.9270977,
                               0.9028449,
                               0.9609457,
                               0.9464992,
                               0.9642788,
                               0.9262062,
                               0.9555533],
                    'mae': [0.04954987,
                            0.04831482,
                            0.04154204,
                            0.037994385,
                            0.056879994,
                            0.070389315,
                            0.07150371,
                            0.061738495,
                            0.06303579,
                            0.044605147,
                            0.042243615,
                            0.038479164,
                            0.05336855,
                            0.06202688,
                            0.0593197,
                            0.054996807,
                            0.06251957,
                            0.0451165,
                            0.05207317,
                            0.041342534,
                            0.058123376,
                            0.046077438],
                    'max_mae': 0.07150371,
                    'max_mse': 0.007799086,
                    'max_rmse': 0.08831243,
                    'median_mae': 0.05272086,
                    'min_cosine': 0.9028449,
                    'mse': [0.0040059844,
                            0.0040321765,
                            0.0028679508,
                            0.0023258596,
                            0.0047913417,
                            0.0073422515,
                            0.007799086,
                            0.005567095,
                            0.0061341664,
                            0.0030706367,
                            0.0026718352,
                            0.002433345,
                            0.004295135,
                            0.0059063034,
                            0.0053027747,
                            0.0047799936,
                            0.006218094,
                            0.0031185155,
                            0.00393515,
                            0.00280235,
                            0.00520777,
                            0.003147773],
                    'rmse': [0.063292846,
                             0.06349942,
                             0.053553253,
                             0.04822717,
                             0.069219515,
                             0.08568694,
                             0.08831243,
                             0.07461297,
                             0.07832092,
                             0.055413324,
                             0.0516898,
                             0.049328946,
                             0.06553728,
                             0.07685248,
                             0.07282016,
                             0.0691375,
                             0.07885489,
                             0.05584367,
                             0.062730774,
                             0.05293723,
                             0.07216488,
                             0.056105018]},
 'spectra_realgan': {'cosine': [0.9896691,
                                0.9898579,
                                0.98456603,
                                0.9791487,
                                0.983875,
                                0.9906742,
                                0.9836056,
                                0.95940924,
                                0.950004,
                                0.9531188,
                                0.9706316,
                                0.9733282,
                                0.93827266,
                                0.91403544,
                                0.91530865,
                                0.92216086,
                                0.9011053,
                                0.9585088,
                                0.94279194,
                                0.9608301,
                                0.92520034,
                                0.95235986],
                     'mae': [0.05091956,
                             0.05065085,
                             0.044404034,
                             0.041118804,
                             0.058669947,
                             0.07273627,
                             0.07316233,
                             0.063168325,
                             0.06512662,
                             0.046040375,
                             0.04382759,
                             0.040590435,
                             0.05506352,
                             0.06331624,
                             0.060418434,
                             0.056880366,
                             0.06340985,
                             0.046374947,
                             0.05363102,
                             0.043673262,
                             0.059573457,
                             0.04754814],
                     'max_mae': 0.07316233,
                     'max_mse': 0.008238449,
                     'max_rmse': 0.0907659,
                     'median_mae': 0.05434727,
                     'min_cosine': 0.9011053,
                     'mse': [0.0042169,
                             0.00437998,
                             0.003240988,
                             0.0026799885,
                             0.0051155905,
                             0.007887149,
                             0.008238449,
                             0.005872001,
                             0.006557111,
                             0.0033155568,
                             0.0029443847,
                             0.0026845408,
                             0.004551976,
                             0.006129314,
                             0.005513082,
                             0.0051394324,
                             0.0063526644,
                             0.0033178928,
                             0.004240858,
                             0.0030703791,
                             0.005419961,
                             0.0034001968],
                     'rmse': [0.064937666,
                              0.066181414,
                              0.056929674,
                              0.051768605,
                              0.07152335,
                              0.088809624,
                              0.0907659,
                              0.07662898,
                              0.080975994,
                              0.057580873,
                              0.054262184,
                              0.051812556,
                              0.06746833,
                              0.07828993,
                              0.07425013,
                              0.07168984,
                              0.07970361,
                              0.057601154,
                              0.06512187,
                              0.055411004,
                              0.07362039,
                              0.058311205]},
 'spectra_realpca': {'cosine': [0.99914396,
                                0.9992311,
                                0.9983727,
                                0.9974544,
                                0.99898773,
                                0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349,
                                0.99650675,
                                0.9971242,
                                0.9965543,
                                0.9968424,
                                0.9962396,
                                0.99634945],
                     'mae': [0.014836307,
                             0.01447966,
                             0.013651306,
                             0.013377094,
                             0.014316244,
                             0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197,
                             0.012154227,
                             0.011967489,
                             0.012771271,
                             0.012152725,
                             0.013049042,
                             0.0125535],
                     'max_mae': 0.015567541,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.012704127,
                     'min_cosine': 0.9962396,
                     'mse': [0.00034976797,
                             0.00033549307,
                             0.00029904975,
                             0.00028346918,
                             0.00032609524,
                             0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102,
                             0.00023534271,
                             0.00023139741,
                             0.00026069232,
                             0.00023610053,
                             0.0002807898,
                             0.0002510656],
                     'rmse': [0.018702084,
                              0.01831647,
                              0.017293055,
                              0.016836543,
                              0.018058106,
                              0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779,
                              0.015340883,
                              0.015211753,
                              0.016145969,
                              0.015365563,
                              0.016756784,
                              0.01584505]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_80.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453
Directory path: experiments/inpainting/gann_4_night_20180722_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_80.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_80.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.111089078084709, 3.1001794530905693],
                   'kl_div': 0.49720812,
                   'ks_tests': {10000: KstestResult(statistic=0.2215, pvalue=2.8831612633786395e-215, statistic_location=0.0074372683, statistic_sign=1),
                                20000: KstestResult(statistic=0.22175, pvalue=0.0, statistic_location=0.007706125, statistic_sign=1),
                                30000: KstestResult(statistic=0.22253333333333336, pvalue=0.0, statistic_location=0.0074420315, statistic_sign=1),
                                40000: KstestResult(statistic=0.21772500000000006, pvalue=0.0, statistic_location=0.0074366117, statistic_sign=1),
                                50000: KstestResult(statistic=0.21950000000000003, pvalue=0.0, statistic_location=0.0078068804, statistic_sign=1),
                                60000: KstestResult(statistic=0.2165166666666667, pvalue=0.0, statistic_location=0.007899987, statistic_sign=1),
                                70000: KstestResult(statistic=0.22235714285714292, pvalue=0.0, statistic_location=0.008005932, statistic_sign=1),
                                80000: KstestResult(statistic=0.2175125, pvalue=0.0, statistic_location=0.007433532, statistic_sign=1),
                                90000: KstestResult(statistic=0.21955555555555561, pvalue=0.0, statistic_location=0.007486264, statistic_sign=1),
                                100000: KstestResult(statistic=0.21581000000000006, pvalue=0.0, statistic_location=0.007809587, statistic_sign=1),
                                110000: KstestResult(statistic=0.21789999999999998, pvalue=0.0, statistic_location=0.00751871, statistic_sign=1),
                                120000: KstestResult(statistic=0.21816666666666673, pvalue=0.0, statistic_location=0.007429977, statistic_sign=1),
                                130000: KstestResult(statistic=0.21815384615384625, pvalue=0.0, statistic_location=0.00752395, statistic_sign=1),
                                140000: KstestResult(statistic=0.21722857142857144, pvalue=0.0, statistic_location=0.0075003346, statistic_sign=1),
                                150000: KstestResult(statistic=0.21662000000000003, pvalue=0.0, statistic_location=0.007873185, statistic_sign=1),
                                160000: KstestResult(statistic=0.21756874999999998, pvalue=0.0, statistic_location=0.007892787, statistic_sign=1),
                                170000: KstestResult(statistic=0.21804705882352937, pvalue=0.0, statistic_location=0.007517312, statistic_sign=1),
                                180000: KstestResult(statistic=0.21739444444444445, pvalue=0.0, statistic_location=0.0075238347, statistic_sign=1),
                                190000: KstestResult(statistic=0.21717894736842103, pvalue=0.0, statistic_location=0.0075293523, statistic_sign=1),
                                200000: KstestResult(statistic=0.21931500000000004, pvalue=0.0, statistic_location=0.007530289, statistic_sign=1),
                                210000: KstestResult(statistic=0.22000952380952388, pvalue=0.0, statistic_location=0.007524167, statistic_sign=1),
                                220000: KstestResult(statistic=0.21738636363636366, pvalue=0.0, statistic_location=0.0077533256, statistic_sign=1),
                                230000: KstestResult(statistic=0.2180695652173913, pvalue=0.0, statistic_location=0.0078633195, statistic_sign=1),
                                240000: KstestResult(statistic=0.21826250000000003, pvalue=0.0, statistic_location=0.007959049, statistic_sign=1),
                                250000: KstestResult(statistic=0.21726, pvalue=0.0, statistic_location=0.007816728, statistic_sign=1),
                                260000: KstestResult(statistic=0.2172615384615385, pvalue=0.0, statistic_location=0.007494458, statistic_sign=1),
                                270000: KstestResult(statistic=0.21627777777777768, pvalue=0.0, statistic_location=0.0078630345, statistic_sign=1),
                                280000: KstestResult(statistic=0.2187785714285715, pvalue=0.0, statistic_location=0.0075188437, statistic_sign=1),
                                290000: KstestResult(statistic=0.2178, pvalue=0.0, statistic_location=0.007816067, statistic_sign=1),
                                300000: KstestResult(statistic=0.21839000000000008, pvalue=0.0, statistic_location=0.007882036, statistic_sign=1),
                                310000: KstestResult(statistic=0.21830322580645167, pvalue=0.0, statistic_location=0.007879695, statistic_sign=1),
                                320000: KstestResult(statistic=0.21909062499999998, pvalue=0.0, statistic_location=0.007525685, statistic_sign=1),
                                330000: KstestResult(statistic=0.2177242424242425, pvalue=0.0, statistic_location=0.0075507206, statistic_sign=1)},
                   'moments': {'mean_error': -0.0042404295,
                               'means': [-0.00039863147, -2.1693977e-05],
                               'stds': [0.017679268, 0.005385532],
                               'variance_ratio': 8.627582}},
 'originals': {'gan': {'mae': 0.05171003192663193,
                       'mse': 0.004362098407000303,
                       'psnr': 28.81952667236328,
                       'rmse': 0.06604618579149246,
                       'ssim': 0.7228677272796631},
               'pca': {'mae': 0.013429644517600536,
                       'mse': 0.00029108254238963127,
                       'psnr': 40.7747917175293,
                       'rmse': 0.01706114038825035,
                       'ssim': 0.9816524982452393}},
 'reconstructions': {'mae': 0.04971151053905487,
                     'mse': 0.004055059049278498,
                     'psnr': 29.33498191833496,
                     'rmse': 0.06367934495210648,
                     'ssim': 0.7297914624214172},
 'residual_spectra_pcagan': {'cosine': [0.43865642,
                                        0.24162422,
                                        0.33851382,
                                        0.2904345,
                                        0.31440586,
                                        0.27107003,
                                        0.29740414,
                                        0.26412457,
                                        0.30329663,
                                        0.31571752,
                                        0.2341939,
                                        0.30094036,
                                        0.27264938,
                                        0.28328276,
                                        0.31187657,
                                        0.30602232,
                                        0.39502403,
                                        0.35032323,
                                        0.28461316,
                                        0.2715893,
                                        0.27236634,
                                        0.28819954,
                                        0.25545248,
                                        0.30801818,
                                        0.32594854,
                                        0.35910082,
                                        0.2935288,
                                        0.30909878,
                                        0.3610874,
                                        0.37976265,
                                        0.32860368,
                                        0.33697698,
                                        0.28380537],
                             'mae': [0.010307829,
                                     0.011543067,
                                     0.009078416,
                                     0.009397869,
                                     0.009183342,
                                     0.010454051,
                                     0.0099123595,
                                     0.010413985,
                                     0.009421885,
                                     0.010166941,
                                     0.012307652,
                                     0.012033404,
                                     0.014177274,
                                     0.01385857,
                                     0.012729086,
                                     0.011991444,
                                     0.011697062,
                                     0.011068564,
                                     0.014922364,
                                     0.016551461,
                                     0.015271266,
                                     0.014176084,
                                     0.014681517,
                                     0.012756438,
                                     0.012809018,
                                     0.011260095,
                                     0.014887729,
                                     0.01216543,
                                     0.009162823,
                                     0.009436313,
                                     0.009196771,
                                     0.009405595,
                                     0.011066853],
                             'max_mae': 0.016551461,
                             'max_mse': 0.0004356272,
                             'max_rmse': 0.020871684,
                             'median_distance': 1.6654694,
                             'median_mae': 0.011543067,
                             'min_cosine': 0.2341939,
                             'mse': [0.00020070293,
                                     0.000314841,
                                     0.00018760165,
                                     0.00023998735,
                                     0.00018848691,
                                     0.00030048433,
                                     0.00024126201,
                                     0.0002852728,
                                     0.00024048776,
                                     0.00021730617,
                                     0.00032217198,
                                     0.00026426348,
                                     0.00043222724,
                                     0.0003413647,
                                     0.00027737874,
                                     0.00032536022,
                                     0.00023890019,
                                     0.0002495822,
                                     0.00038487438,
                                     0.0004356272,
                                     0.00037485873,
                                     0.00036444768,
                                     0.00036045545,
                                     0.00030593012,
                                     0.00027573522,
                                     0.00023915702,
                                     0.00037236547,
                                     0.00028663193,
                                     0.00018535437,
                                     0.00018155565,
                                     0.00020665588,
                                     0.00022121977,
                                     0.0002972659],
                             'rmse': [0.014166966,
                                      0.017743759,
                                      0.013696775,
                                      0.015491525,
                                      0.013729054,
                                      0.017334484,
                                      0.015532611,
                                      0.016890021,
                                      0.015507667,
                                      0.014741308,
                                      0.017949149,
                                      0.016256183,
                                      0.020790076,
                                      0.018476058,
                                      0.01665469,
                                      0.018037744,
                                      0.015456396,
                                      0.01579817,
                                      0.019618215,
                                      0.020871684,
                                      0.019361269,
                                      0.019090513,
                                      0.018985664,
                                      0.017490858,
                                      0.016605277,
                                      0.015464703,
                                      0.019296773,
                                      0.016930208,
                                      0.013614491,
                                      0.013474259,
                                      0.01437553,
                                      0.014873459,
                                      0.017241402]},
 'residuals': {'mae': 0.011742199771106243,
               'mse': 0.00028363082674331963,
               'psnr': 21.098011016845703,
               'rmse': 0.01684134267270565,
               'ssds': [103.19576, 9.571429],
               'ssim': 0.22103337943553925},
 'spectra_pcagan': {'cosine': [0.9963698,
                               0.99438685,
                               0.9956266,
                               0.9947156,
                               0.9958619,
                               0.9941898,
                               0.99029875,
                               0.99031955,
                               0.9854418,
                               0.9806126,
                               0.9842539,
                               0.99106264,
                               0.98436266,
                               0.9612392,
                               0.95402,
                               0.95667464,
                               0.9732843,
                               0.9759182,
                               0.9413496,
                               0.9185366,
                               0.9188191,
                               0.92797846,
                               0.90390915,
                               0.9617075,
                               0.94762224,
                               0.9649784,
                               0.9271132,
                               0.9554265,
                               0.9740822,
                               0.9776025,
                               0.98743755,
                               0.98771983,
                               0.9894869],
                    'mae': [0.02895067,
                            0.04266675,
                            0.049023084,
                            0.048572775,
                            0.056023497,
                            0.061252892,
                            0.0495633,
                            0.04903637,
                            0.042492125,
                            0.03926784,
                            0.057685602,
                            0.071342446,
                            0.07214283,
                            0.062262837,
                            0.062302727,
                            0.04457293,
                            0.04187726,
                            0.038644116,
                            0.053261742,
                            0.06150753,
                            0.059135124,
                            0.054507904,
                            0.062075067,
                            0.044807233,
                            0.0516789,
                            0.041154943,
                            0.057749476,
                            0.046301115,
                            0.03875649,
                            0.0349078,
                            0.036869936,
                            0.038954005,
                            0.04113254],
                    'max_mae': 0.07214283,
                    'max_mse': 0.0079698,
                    'max_rmse': 0.089273736,
                    'median_mae': 0.049023084,
                    'min_cosine': 0.90390915,
                    'mse': [0.0012863175,
                            0.003211473,
                            0.0038858878,
                            0.0039039506,
                            0.004709052,
                            0.006123947,
                            0.0039803,
                            0.0041435203,
                            0.0029436299,
                            0.0024493064,
                            0.004946753,
                            0.0075787306,
                            0.0079698,
                            0.0056669,
                            0.0060025654,
                            0.0030856284,
                            0.0026376077,
                            0.0024500329,
                            0.004291196,
                            0.005813097,
                            0.0052758013,
                            0.0047103073,
                            0.0061652604,
                            0.0030924445,
                            0.0038729415,
                            0.0027854885,
                            0.0051631485,
                            0.0031829113,
                            0.0024941468,
                            0.0020058854,
                            0.0023234044,
                            0.002516884,
                            0.0031486047],
                    'rmse': [0.03586527,
                             0.05666986,
                             0.06233689,
                             0.0624816,
                             0.06862253,
                             0.07825565,
                             0.06308962,
                             0.064370185,
                             0.05425523,
                             0.049490467,
                             0.07033315,
                             0.08705591,
                             0.089273736,
                             0.07527881,
                             0.077476226,
                             0.055548433,
                             0.051357646,
                             0.049497806,
                             0.06550722,
                             0.07624367,
                             0.07263471,
                             0.06863168,
                             0.07851917,
                             0.05560975,
                             0.06223296,
                             0.052777726,
                             0.07185505,
                             0.056417298,
                             0.049941435,
                             0.044787113,
                             0.048201706,
                             0.050168555,
                             0.056112427]},
 'spectra_realgan': {'cosine': [0.99594945,
                                0.993599,
                                0.9950832,
                                0.9941495,
                                0.9954565,
                                0.99380606,
                                0.9896941,
                                0.98959345,
                                0.9840586,
                                0.9780391,
                                0.98338234,
                                0.99038804,
                                0.983271,
                                0.9587497,
                                0.95064867,
                                0.95316404,
                                0.97102016,
                                0.97345513,
                                0.93828213,
                                0.9155233,
                                0.9159966,
                                0.92306614,
                                0.90216774,
                                0.95925295,
                                0.9439704,
                                0.96156967,
                                0.92616457,
                                0.95225024,
                                0.9714461,
                                0.9741205,
                                0.98563623,
                                0.98602635,
                                0.98827475],
                     'mae': [0.030195968,
                             0.04384645,
                             0.05171915,
                             0.051315956,
                             0.0585284,
                             0.064356156,
                             0.05100211,
                             0.051354375,
                             0.045245912,
                             0.04232188,
                             0.059441272,
                             0.07366079,
                             0.073836826,
                             0.063720815,
                             0.06439157,
                             0.04602444,
                             0.04345906,
                             0.040787138,
                             0.05499627,
                             0.062789485,
                             0.06026786,
                             0.056387287,
                             0.0629972,
                             0.04607277,
                             0.05318295,
                             0.04348565,
                             0.059214,
                             0.047780782,
                             0.041187927,
                             0.037686408,
                             0.039182164,
                             0.041614648,
                             0.04437734],
                     'max_mae': 0.073836826,
                     'max_mse': 0.008408905,
                     'max_rmse': 0.091700085,
                     'median_mae': 0.051315956,
                     'min_cosine': 0.90216774,
                     'mse': [0.0013965998,
                             0.0033654594,
                             0.0043091304,
                             0.0043066847,
                             0.0051687118,
                             0.00663488,
                             0.004193502,
                             0.0044916635,
                             0.0033190364,
                             0.002811561,
                             0.005270784,
                             0.008125987,
                             0.008408905,
                             0.005973664,
                             0.0064246827,
                             0.0033273175,
                             0.0029098277,
                             0.0027023253,
                             0.0045493,
                             0.0060367663,
                             0.005485335,
                             0.0050676977,
                             0.006299948,
                             0.0032926055,
                             0.0041749026,
                             0.0030507362,
                             0.0053743967,
                             0.0034350727,
                             0.0027860254,
                             0.0022955164,
                             0.0025833887,
                             0.0028579237,
                             0.0035189064],
                     'rmse': [0.03737111,
                              0.05801258,
                              0.065643966,
                              0.06562533,
                              0.07189375,
                              0.08145477,
                              0.06475726,
                              0.06701987,
                              0.057611078,
                              0.053024154,
                              0.07260016,
                              0.090144254,
                              0.091700085,
                              0.077289484,
                              0.08015412,
                              0.057682905,
                              0.05394282,
                              0.051983897,
                              0.0674485,
                              0.07769663,
                              0.07406305,
                              0.071187764,
                              0.07937221,
                              0.05738123,
                              0.064613484,
                              0.05523347,
                              0.07331028,
                              0.058609493,
                              0.052782815,
                              0.047911547,
                              0.05082705,
                              0.05345955,
                              0.05932037]},
 'spectra_realpca': {'cosine': [0.99945366,
                                0.99925643,
                                0.99947244,
                                0.99940675,
                                0.9995555,
                                0.99957067,
                                0.99914396,
                                0.9992311,
                                0.9983727,
                                0.9974544,
                                0.99898773,
                                0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349,
                                0.99650675,
                                0.9971242,
                                0.9965543,
                                0.9968424,
                                0.9962396,
                                0.99634945,
                                0.99715966,
                                0.99691385,
                                0.9982245,
                                0.99834263,
                                0.9988524],
                     'mae': [0.011083274,
                             0.014802759,
                             0.015157819,
                             0.015070052,
                             0.015472084,
                             0.015633475,
                             0.014836307,
                             0.01447966,
                             0.013651306,
                             0.013377094,
                             0.014316244,
                             0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197,
                             0.012154227,
                             0.011967489,
                             0.012771271,
                             0.012152725,
                             0.013049042,
                             0.0125535,
                             0.013193458,
                             0.0130807385,
                             0.013555716,
                             0.013718692,
                             0.014281331],
                     'max_mae': 0.015633475,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.013377094,
                     'min_cosine': 0.9962396,
                     'mse': [0.00019629093,
                             0.00035259564,
                             0.00036871652,
                             0.00035998295,
                             0.00038198216,
                             0.00038844542,
                             0.00034976797,
                             0.00033549307,
                             0.00029904975,
                             0.00028346918,
                             0.00032609524,
                             0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102,
                             0.00023534271,
                             0.00023139741,
                             0.00026069232,
                             0.00023610053,
                             0.0002807898,
                             0.0002510656,
                             0.00027758113,
                             0.00027334486,
                             0.00029565947,
                             0.00030083008,
                             0.0003258427],
                     'rmse': [0.014010387,
                              0.01877753,
                              0.019201992,
                              0.018973216,
                              0.019544363,
                              0.019709019,
                              0.018702084,
                              0.01831647,
                              0.017293055,
                              0.016836543,
                              0.018058106,
                              0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779,
                              0.015340883,
                              0.015211753,
                              0.016145969,
                              0.015365563,
                              0.016756784,
                              0.01584505,
                              0.016660767,
                              0.016533144,
                              0.017194752,
                              0.017344454,
                              0.018051114]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_80.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957
Directory path: experiments/inpainting/gann_4_night_20180723_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_80.0/images
Optimal number of principal components:  26
Reconstruction error:  16.324028
Energy conservation:  0.8060469
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_80.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.075287224842861, 3.0889320314486013],
                   'kl_div': 0.5088089,
                   'ks_tests': {10000: KstestResult(statistic=0.2295, pvalue=3.290410761099884e-231, statistic_location=0.0056713684, statistic_sign=1),
                                20000: KstestResult(statistic=0.23415000000000008, pvalue=0.0, statistic_location=0.0070365723, statistic_sign=1),
                                30000: KstestResult(statistic=0.23726666666666674, pvalue=0.0, statistic_location=0.005734238, statistic_sign=1),
                                40000: KstestResult(statistic=0.242375, pvalue=0.0, statistic_location=0.0064041787, statistic_sign=1),
                                50000: KstestResult(statistic=0.23356, pvalue=0.0, statistic_location=0.0061761104, statistic_sign=1),
                                60000: KstestResult(statistic=0.23493333333333333, pvalue=0.0, statistic_location=0.0066052466, statistic_sign=1),
                                70000: KstestResult(statistic=0.24027142857142858, pvalue=0.0, statistic_location=0.0065927985, statistic_sign=1),
                                80000: KstestResult(statistic=0.2387125, pvalue=0.0, statistic_location=0.0062847827, statistic_sign=1),
                                90000: KstestResult(statistic=0.23753333333333337, pvalue=0.0, statistic_location=0.006269022, statistic_sign=1),
                                100000: KstestResult(statistic=0.23951, pvalue=0.0, statistic_location=0.0065830704, statistic_sign=1),
                                110000: KstestResult(statistic=0.23645454545454536, pvalue=0.0, statistic_location=0.006265531, statistic_sign=1)},
                   'moments': {'mean_error': 0.15307364,
                               'means': [0.00018858185, -0.00010217862],
                               'stds': [0.018317485, 0.0054829195],
                               'variance_ratio': 11.078781}},
 'originals': {'gan': {'mae': 0.03907667472958565,
                       'mse': 0.0029821956995874643,
                       'psnr': 25.586721420288086,
                       'rmse': 0.05460948497056961,
                       'ssim': 0.6817914843559265},
               'pca': {'mae': 0.010057191364467144,
                       'mse': 0.0001909879210870713,
                       'psnr': 37.766937255859375,
                       'rmse': 0.01381983794271946,
                       'ssim': 0.942899227142334}},
 'reconstructions': {'mae': 0.03706997260451317,
                     'mse': 0.0027758146170526743,
                     'psnr': 26.14309310913086,
                     'rmse': 0.052685998380184174,
                     'ssim': 0.7056605219841003},
 'residual_spectra_pcagan': {'cosine': [0.2921861,
                                        0.31548274,
                                        0.3783199,
                                        0.42033452,
                                        0.3263583,
                                        0.3904873,
                                        0.3072562,
                                        0.2531523,
                                        0.088191174,
                                        0.11400934,
                                        0.12244394],
                             'mae': [0.011232181,
                                     0.011377359,
                                     0.011479299,
                                     0.009868037,
                                     0.011405352,
                                     0.010820874,
                                     0.011410546,
                                     0.012595178,
                                     0.013183909,
                                     0.012127522,
                                     0.012876446],
                             'max_mae': 0.013183909,
                             'max_mse': 0.00041979505,
                             'max_rmse': 0.020488901,
                             'median_distance': 1.7678668,
                             'median_mae': 0.011410546,
                             'min_cosine': 0.088191174,
                             'mse': [0.0002509866,
                                     0.00041979505,
                                     0.00027269768,
                                     0.00022300122,
                                     0.0003662436,
                                     0.0002389636,
                                     0.00027706882,
                                     0.00031386368,
                                     0.00036584467,
                                     0.00031253533,
                                     0.00033924883],
                             'rmse': [0.015842557,
                                      0.020488901,
                                      0.01651356,
                                      0.014933226,
                                      0.019137492,
                                      0.015458448,
                                      0.016645385,
                                      0.0177162,
                                      0.019127067,
                                      0.017678669,
                                      0.018418709]},
 'residuals': {'mae': 0.011670609936118126,
               'mse': 0.000307295355014503,
               'psnr': 12.094284057617188,
               'rmse': 0.017529841512441635,
               'ssds': [36.911907, 3.3079834],
               'ssim': 0.31553441286087036},
 'spectra_pcagan': {'cosine': [0.76690847,
                               0.975771,
                               0.9768038,
                               0.9832438,
                               0.9779933,
                               0.9759065,
                               0.97833705,
                               0.9789248,
                               0.9846734,
                               0.99136335,
                               0.9885759],
                    'mae': [0.123921365,
                            0.033708073,
                            0.029641207,
                            0.023873782,
                            0.027232306,
                            0.029055076,
                            0.028960012,
                            0.030059958,
                            0.02907024,
                            0.02503371,
                            0.027213953],
                    'max_mae': 0.123921365,
                    'max_mse': 0.016930647,
                    'max_rmse': 0.13011782,
                    'median_mae': 0.029055076,
                    'min_cosine': 0.76690847,
                    'mse': [0.016930647,
                            0.0019531897,
                            0.0013982583,
                            0.0009848056,
                            0.0013419029,
                            0.001371796,
                            0.0013602705,
                            0.0015101851,
                            0.001407105,
                            0.0010449534,
                            0.0012308466],
                    'rmse': [0.13011782,
                             0.044194907,
                             0.03739329,
                             0.031381615,
                             0.036631994,
                             0.037037764,
                             0.036881845,
                             0.0388611,
                             0.037511397,
                             0.032325737,
                             0.035083424]},
 'spectra_realgan': {'cosine': [0.76182497,
                                0.97065604,
                                0.97193724,
                                0.97797906,
                                0.97307193,
                                0.9714668,
                                0.9760686,
                                0.9772819,
                                0.9844042,
                                0.9912256,
                                0.9883645],
                     'mae': [0.12482292,
                             0.03725007,
                             0.032848276,
                             0.028154755,
                             0.030856522,
                             0.03197498,
                             0.030475717,
                             0.031206599,
                             0.029414551,
                             0.025337076,
                             0.027501896],
                     'max_mae': 0.12482292,
                     'max_mse': 0.017314594,
                     'max_rmse': 0.13158493,
                     'median_mae': 0.030856522,
                     'min_cosine': 0.76182497,
                     'mse': [0.017314594,
                             0.0023274266,
                             0.0017009343,
                             0.0013082811,
                             0.001638224,
                             0.0016351383,
                             0.001508562,
                             0.001624058,
                             0.0014300928,
                             0.0010630474,
                             0.0012537937],
                     'rmse': [0.13158493,
                              0.04824341,
                              0.041242383,
                              0.03617017,
                              0.04047498,
                              0.04043684,
                              0.038840212,
                              0.0402996,
                              0.03781657,
                              0.032604408,
                              0.03540895]},
 'spectra_realpca': {'cosine': [0.9978403,
                                0.99466586,
                                0.9954986,
                                0.9941912,
                                0.9949266,
                                0.9950008,
                                0.9973039,
                                0.9982493,
                                0.9996128,
                                0.9998175,
                                0.99980885],
                     'mae': [0.0093868915,
                             0.015355125,
                             0.013041408,
                             0.014747629,
                             0.013731478,
                             0.013409369,
                             0.010357431,
                             0.008602166,
                             0.004713209,
                             0.0037145214,
                             0.0035698658],
                     'max_mae': 0.015355125,
                     'max_mse': 0.0003766009,
                     'max_rmse': 0.019406207,
                     'median_mae': 0.010357431,
                     'min_cosine': 0.9941912,
                     'mse': [0.00014214726,
                             0.0003766009,
                             0.00027519703,
                             0.00034795696,
                             0.0003010368,
                             0.00028990058,
                             0.00017154944,
                             0.000118533884,
                             3.534327e-05,
                             2.2215221e-05,
                             2.03856e-05],
                     'rmse': [0.011922552,
                              0.019406207,
                              0.016589064,
                              0.018653605,
                              0.017350413,
                              0.017026467,
                              0.013097689,
                              0.010887327,
                              0.0059450204,
                              0.0047133025,
                              0.0045150416]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_80.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431
Directory path: experiments/inpainting/gann_4_night_20180723_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_80.0/images
Optimal number of principal components:  26
Reconstruction error:  16.324028
Energy conservation:  0.8060469
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_80.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.070708789508587, 2.9755982709624824],
                   'kl_div': 0.6014296,
                   'ks_tests': {10000: KstestResult(statistic=0.2508, pvalue=1.5949366876132734e-276, statistic_location=0.005372457, statistic_sign=1),
                                20000: KstestResult(statistic=0.2574000000000001, pvalue=0.0, statistic_location=0.0045347195, statistic_sign=1),
                                30000: KstestResult(statistic=0.25173333333333325, pvalue=0.0, statistic_location=0.0045378394, statistic_sign=1),
                                40000: KstestResult(statistic=0.2528, pvalue=0.0, statistic_location=0.004563051, statistic_sign=1),
                                50000: KstestResult(statistic=0.25278, pvalue=0.0, statistic_location=0.005184711, statistic_sign=1),
                                60000: KstestResult(statistic=0.2547666666666667, pvalue=0.0, statistic_location=0.004929768, statistic_sign=1),
                                70000: KstestResult(statistic=0.25547142857142857, pvalue=0.0, statistic_location=0.0054272674, statistic_sign=1),
                                80000: KstestResult(statistic=0.2552749999999999, pvalue=0.0, statistic_location=0.005239671, statistic_sign=1),
                                90000: KstestResult(statistic=0.25312222222222225, pvalue=0.0, statistic_location=0.0050067613, statistic_sign=1),
                                100000: KstestResult(statistic=0.25385, pvalue=0.0, statistic_location=0.0052529713, statistic_sign=1),
                                110000: KstestResult(statistic=0.2524727272727273, pvalue=0.0, statistic_location=0.005184711, statistic_sign=1),
                                120000: KstestResult(statistic=0.25254999999999994, pvalue=0.0, statistic_location=0.005184632, statistic_sign=1),
                                130000: KstestResult(statistic=0.2533384615384615, pvalue=0.0, statistic_location=0.005168437, statistic_sign=1),
                                140000: KstestResult(statistic=0.25422857142857147, pvalue=0.0, statistic_location=0.0052915434, statistic_sign=1),
                                150000: KstestResult(statistic=0.2530866666666667, pvalue=0.0, statistic_location=0.0049953694, statistic_sign=1),
                                160000: KstestResult(statistic=0.2541, pvalue=0.0, statistic_location=0.005222569, statistic_sign=1),
                                170000: KstestResult(statistic=0.2521058823529412, pvalue=0.0, statistic_location=0.005186263, statistic_sign=1),
                                180000: KstestResult(statistic=0.2542888888888889, pvalue=0.0, statistic_location=0.005257732, statistic_sign=1),
                                190000: KstestResult(statistic=0.2513736842105263, pvalue=0.0, statistic_location=0.004789235, statistic_sign=1),
                                200000: KstestResult(statistic=0.251275, pvalue=0.0, statistic_location=0.004773418, statistic_sign=1),
                                210000: KstestResult(statistic=0.2534666666666666, pvalue=0.0, statistic_location=0.00504015, statistic_sign=1),
                                220000: KstestResult(statistic=0.2530181818181818, pvalue=0.0, statistic_location=0.004823937, statistic_sign=1)},
                   'moments': {'mean_error': 0.2800603,
                               'means': [0.0011001013, -6.4866617e-06],
                               'stds': [0.017806092, 0.005219327],
                               'variance_ratio': 11.088573}},
 'originals': {'gan': {'mae': 0.03808341547846794,
                       'mse': 0.00280970660969615,
                       'psnr': 27.170915603637695,
                       'rmse': 0.05300666391849518,
                       'ssim': 0.6383866667747498},
               'pca': {'mae': 0.009259676560759544,
                       'mse': 0.00018924569303635508,
                       'psnr': 39.04936981201172,
                       'rmse': 0.01375665981322527,
                       'ssim': 0.9645010828971863}},
 'reconstructions': {'mae': 0.035954587161540985,
                     'mse': 0.002612476469948888,
                     'psnr': 27.649112701416016,
                     'rmse': 0.05111239105463028,
                     'ssim': 0.6499639749526978},
 'residual_spectra_pcagan': {'cosine': [0.4980378,
                                        0.38559958,
                                        0.31700447,
                                        0.42340833,
                                        0.38404936,
                                        0.2505541,
                                        0.40769392,
                                        0.41853526,
                                        0.47183016,
                                        0.39241403,
                                        0.3635364,
                                        0.31816813,
                                        0.25612664,
                                        0.14382194,
                                        0.10150732,
                                        0.105477974,
                                        0.059996266,
                                        0.078910835,
                                        0.063254744,
                                        0.06630925,
                                        0.059339255,
                                        0.10211147],
                             'mae': [0.008606263,
                                     0.009492252,
                                     0.011013696,
                                     0.009734931,
                                     0.010865256,
                                     0.012510468,
                                     0.009907792,
                                     0.009338822,
                                     0.009503824,
                                     0.01061517,
                                     0.011754549,
                                     0.011768249,
                                     0.01171581,
                                     0.012258485,
                                     0.012545724,
                                     0.012960254,
                                     0.012851198,
                                     0.014408456,
                                     0.013641262,
                                     0.012735052,
                                     0.013381418,
                                     0.011819315],
                             'max_mae': 0.014408456,
                             'max_mse': 0.00048685237,
                             'max_rmse': 0.02206473,
                             'median_distance': 1.6849861,
                             'median_mae': 0.011761399,
                             'min_cosine': 0.059339255,
                             'mse': [0.00016514181,
                                     0.00026377934,
                                     0.0003882604,
                                     0.00020636604,
                                     0.00028144903,
                                     0.00037252888,
                                     0.00024261794,
                                     0.00019144632,
                                     0.00017924169,
                                     0.00022978162,
                                     0.00028639747,
                                     0.00026645797,
                                     0.00025531332,
                                     0.00029144992,
                                     0.00033270288,
                                     0.00036904047,
                                     0.0003097534,
                                     0.00038266703,
                                     0.00037043015,
                                     0.00029987894,
                                     0.00048685237,
                                     0.00027110457],
                             'rmse': [0.012850751,
                                      0.016241284,
                                      0.019704325,
                                      0.014365446,
                                      0.016776443,
                                      0.019301007,
                                      0.015576198,
                                      0.013836413,
                                      0.013388118,
                                      0.01515855,
                                      0.016923282,
                                      0.01632354,
                                      0.015978526,
                                      0.017071905,
                                      0.018240144,
                                      0.019210426,
                                      0.017599812,
                                      0.019561877,
                                      0.019246561,
                                      0.017317014,
                                      0.02206473,
                                      0.016465254]},
 'residuals': {'mae': 0.01151946559548378,
               'mse': 0.0002928482717834413,
               'psnr': 12.958548545837402,
               'rmse': 0.017112810164690018,
               'ssds': [70.01845, 5.9930844],
               'ssim': 0.33785322308540344},
 'spectra_pcagan': {'cosine': [0.98850185,
                               0.9900414,
                               0.9768694,
                               0.98914987,
                               0.980178,
                               0.7854404,
                               0.98057383,
                               0.9836104,
                               0.9826329,
                               0.9799203,
                               0.9712402,
                               0.9799434,
                               0.98010784,
                               0.9867935,
                               0.99002635,
                               0.98839825,
                               0.9905965,
                               0.99147433,
                               0.99333674,
                               0.9455546,
                               0.99244434,
                               0.9951233],
                    'mae': [0.026530497,
                            0.027731545,
                            0.02825846,
                            0.02793499,
                            0.030078998,
                            0.12226558,
                            0.027898349,
                            0.023806954,
                            0.024631402,
                            0.026437158,
                            0.033593774,
                            0.029996436,
                            0.03010335,
                            0.027065223,
                            0.026334189,
                            0.03175771,
                            0.027068552,
                            0.028326005,
                            0.02843831,
                            0.11318605,
                            0.025683941,
                            0.02387342],
                    'max_mae': 0.12226558,
                    'max_mse': 0.01686246,
                    'max_rmse': 0.12985553,
                    'median_mae': 0.02791667,
                    'min_cosine': 0.7854404,
                    'mse': [0.0011728627,
                            0.0015074741,
                            0.001478542,
                            0.0013493958,
                            0.0015034335,
                            0.01686246,
                            0.0013902767,
                            0.0009878599,
                            0.001047811,
                            0.001171952,
                            0.0018407435,
                            0.0014308455,
                            0.0014682381,
                            0.0012092388,
                            0.0012183388,
                            0.0016462833,
                            0.0011800203,
                            0.0013078047,
                            0.0013795054,
                            0.01416061,
                            0.001229827,
                            0.00093095744],
                    'rmse': [0.03424708,
                             0.038826205,
                             0.038451813,
                             0.036734123,
                             0.038774133,
                             0.12985553,
                             0.037286416,
                             0.031430237,
                             0.032369908,
                             0.034233786,
                             0.042903885,
                             0.03782652,
                             0.038317595,
                             0.03477411,
                             0.03490471,
                             0.040574417,
                             0.034351423,
                             0.036163583,
                             0.037141692,
                             0.11899836,
                             0.03506889,
                             0.030511595]},
 'spectra_realgan': {'cosine': [0.9842154,
                                0.98720634,
                                0.97187227,
                                0.985974,
                                0.975201,
                                0.78049195,
                                0.9755134,
                                0.9793263,
                                0.977111,
                                0.97518516,
                                0.9669428,
                                0.97755563,
                                0.97862273,
                                0.986388,
                                0.98985815,
                                0.98820204,
                                0.99054193,
                                0.99139744,
                                0.9933257,
                                0.94541675,
                                0.99235016,
                                0.995058],
                     'mae': [0.03144667,
                             0.033354674,
                             0.0322276,
                             0.03283034,
                             0.034181397,
                             0.12319361,
                             0.032408826,
                             0.027350396,
                             0.028831711,
                             0.030073166,
                             0.03589424,
                             0.03158853,
                             0.03107811,
                             0.027468268,
                             0.02667494,
                             0.0319142,
                             0.027136518,
                             0.028457599,
                             0.028431775,
                             0.11332157,
                             0.025896296,
                             0.024074888],
                     'max_mae': 0.12319361,
                     'max_mse': 0.017247658,
                     'max_rmse': 0.13133034,
                     'median_mae': 0.03126239,
                     'min_cosine': 0.78049195,
                     'mse': [0.0016163955,
                             0.0019659763,
                             0.0018086198,
                             0.0017655283,
                             0.001878917,
                             0.017247658,
                             0.0017573244,
                             0.001254364,
                             0.0013847754,
                             0.0014581915,
                             0.002097496,
                             0.0015854626,
                             0.0015710508,
                             0.001246197,
                             0.0012410587,
                             0.0016646486,
                             0.0011872109,
                             0.0013205011,
                             0.0013792544,
                             0.014197919,
                             0.0012409664,
                             0.00094403303],
                     'rmse': [0.04020442,
                              0.044339333,
                              0.04252787,
                              0.04201819,
                              0.043346476,
                              0.13133034,
                              0.041920453,
                              0.035417,
                              0.03721257,
                              0.038186274,
                              0.04579843,
                              0.03981787,
                              0.039636485,
                              0.035301518,
                              0.035228662,
                              0.040800106,
                              0.034455925,
                              0.036338698,
                              0.037138313,
                              0.11915502,
                              0.03522735,
                              0.03072512]},
 'spectra_realpca': {'cosine': [0.99587274,
                                0.99696285,
                                0.9946063,
                                0.9966444,
                                0.9949172,
                                0.9978403,
                                0.99466586,
                                0.9954986,
                                0.9941912,
                                0.9949266,
                                0.9950008,
                                0.9973039,
                                0.9982493,
                                0.9996128,
                                0.9998175,
                                0.99980885,
                                0.9999245,
                                0.9998956,
                                0.9999645,
                                0.99997586,
                                0.99993277,
                                0.99995846],
                     'mae': [0.016098313,
                             0.016840948,
                             0.014712745,
                             0.01619039,
                             0.015229957,
                             0.0093868915,
                             0.015355125,
                             0.013041408,
                             0.014747629,
                             0.013731478,
                             0.013409369,
                             0.010357431,
                             0.008602166,
                             0.004713209,
                             0.0037145214,
                             0.0035698658,
                             0.002420658,
                             0.003165357,
                             0.0020503665,
                             0.0016376402,
                             0.0025717823,
                             0.0021656437],
                     'max_mae': 0.016840948,
                     'max_mse': 0.0004556818,
                     'max_rmse': 0.021346705,
                     'median_mae': 0.009872161,
                     'min_cosine': 0.9941912,
                     'mse': [0.00041345405,
                             0.0004556818,
                             0.00034461176,
                             0.00041813488,
                             0.00037594725,
                             0.00014214726,
                             0.0003766009,
                             0.00027519703,
                             0.00034795696,
                             0.0003010368,
                             0.00028990058,
                             0.00017154944,
                             0.000118533884,
                             3.534327e-05,
                             2.2215221e-05,
                             2.03856e-05,
                             9.470676e-06,
                             1.6085336e-05,
                             6.7175797e-06,
                             4.298202e-06,
                             1.06071775e-05,
                             7.5302096e-06],
                     'rmse': [0.02033357,
                              0.021346705,
                              0.018563721,
                              0.020448346,
                              0.01938936,
                              0.011922552,
                              0.019406207,
                              0.016589064,
                              0.018653605,
                              0.017350413,
                              0.017026467,
                              0.013097689,
                              0.010887327,
                              0.0059450204,
                              0.0047133025,
                              0.0045150416,
                              0.0030774463,
                              0.0040106527,
                              0.0025918295,
                              0.0020732104,
                              0.0032568662,
                              0.0027441226]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_80.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707
Directory path: experiments/inpainting/gann_4_night_20180723_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_80.0/images
Optimal number of principal components:  26
Reconstruction error:  16.324028
Energy conservation:  0.8060469
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_80.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.060522481510419, 2.9714872501739116],
                   'kl_div': 0.5885499,
                   'ks_tests': {10000: KstestResult(statistic=0.2258, pvalue=9.1940963288919e-224, statistic_location=0.005435855, statistic_sign=1),
                                20000: KstestResult(statistic=0.22535000000000005, pvalue=0.0, statistic_location=0.0042340853, statistic_sign=1),
                                30000: KstestResult(statistic=0.22279999999999997, pvalue=0.0, statistic_location=-0.004877749, statistic_sign=-1),
                                40000: KstestResult(statistic=0.22089999999999999, pvalue=0.0, statistic_location=0.0047790348, statistic_sign=1),
                                50000: KstestResult(statistic=0.22052000000000005, pvalue=0.0, statistic_location=0.00540206, statistic_sign=1),
                                60000: KstestResult(statistic=0.22624999999999995, pvalue=0.0, statistic_location=0.005100247, statistic_sign=1),
                                70000: KstestResult(statistic=0.2230000000000001, pvalue=0.0, statistic_location=0.0048626126, statistic_sign=1),
                                80000: KstestResult(statistic=0.2239875, pvalue=0.0, statistic_location=0.0051731127, statistic_sign=1),
                                90000: KstestResult(statistic=0.22167777777777775, pvalue=0.0, statistic_location=-0.00519667, statistic_sign=-1),
                                100000: KstestResult(statistic=0.22558, pvalue=0.0, statistic_location=0.0053203227, statistic_sign=1),
                                110000: KstestResult(statistic=0.224409090909091, pvalue=0.0, statistic_location=0.005468441, statistic_sign=1),
                                120000: KstestResult(statistic=0.2219, pvalue=0.0, statistic_location=0.0051846723, statistic_sign=1),
                                130000: KstestResult(statistic=0.22753076923076931, pvalue=0.0, statistic_location=0.004904287, statistic_sign=1),
                                140000: KstestResult(statistic=0.22092142857142855, pvalue=0.0, statistic_location=-0.0046720374, statistic_sign=-1),
                                150000: KstestResult(statistic=0.22042000000000006, pvalue=0.0, statistic_location=0.0053448356, statistic_sign=1),
                                160000: KstestResult(statistic=0.22571249999999998, pvalue=0.0, statistic_location=0.0050108787, statistic_sign=1),
                                170000: KstestResult(statistic=0.22677058823529417, pvalue=0.0, statistic_location=0.005323369, statistic_sign=1),
                                180000: KstestResult(statistic=0.22162222222222228, pvalue=0.0, statistic_location=0.0050986474, statistic_sign=1),
                                190000: KstestResult(statistic=0.2252421052631579, pvalue=0.0, statistic_location=0.00498417, statistic_sign=1),
                                200000: KstestResult(statistic=0.2248, pvalue=0.0, statistic_location=0.004877996, statistic_sign=1),
                                210000: KstestResult(statistic=0.2233666666666667, pvalue=0.0, statistic_location=0.005379813, statistic_sign=1),
                                220000: KstestResult(statistic=0.22355454545454545, pvalue=0.0, statistic_location=0.0053227153, statistic_sign=1),
                                230000: KstestResult(statistic=0.22221304347826087, pvalue=0.0, statistic_location=0.0048607164, statistic_sign=1),
                                240000: KstestResult(statistic=0.22390416666666668, pvalue=0.0, statistic_location=0.005039378, statistic_sign=1),
                                250000: KstestResult(statistic=0.22584400000000004, pvalue=0.0, statistic_location=0.0053406935, statistic_sign=1),
                                260000: KstestResult(statistic=0.2231653846153846, pvalue=0.0, statistic_location=0.0050986474, statistic_sign=1),
                                270000: KstestResult(statistic=0.2237, pvalue=0.0, statistic_location=0.0050986474, statistic_sign=1),
                                280000: KstestResult(statistic=0.22353214285714285, pvalue=0.0, statistic_location=0.0053629577, statistic_sign=1),
                                290000: KstestResult(statistic=0.22324827586206897, pvalue=0.0, statistic_location=0.00489743, statistic_sign=1),
                                300000: KstestResult(statistic=0.2210833333333334, pvalue=0.0, statistic_location=0.0050087636, statistic_sign=1),
                                310000: KstestResult(statistic=0.22396774193548397, pvalue=0.0, statistic_location=0.004881464, statistic_sign=1),
                                320000: KstestResult(statistic=0.22583125000000004, pvalue=0.0, statistic_location=0.005008143, statistic_sign=1),
                                330000: KstestResult(statistic=0.22312424242424245, pvalue=0.0, statistic_location=0.0051847366, statistic_sign=1)},
                   'moments': {'mean_error': 0.049636364,
                               'means': [4.6829733e-05, 2.4449047e-05],
                               'stds': [0.017160652, 0.005253878],
                               'variance_ratio': 10.074206}},
 'originals': {'gan': {'mae': 0.036340177059173584,
                       'mse': 0.002502941759303212,
                       'psnr': 28.304943084716797,
                       'rmse': 0.05002940818667412,
                       'ssim': 0.6518767476081848},
               'pca': {'mae': 0.0094994455575943,
                       'mse': 0.0002036661608144641,
                       'psnr': 39.51583480834961,
                       'rmse': 0.014271165244281292,
                       'ssim': 0.9755141139030457}},
 'reconstructions': {'mae': 0.034126777201890945,
                     'mse': 0.0022934467997401953,
                     'psnr': 29.00013542175293,
                     'rmse': 0.04788994416594505,
                     'ssim': 0.6600713729858398},
 'residual_spectra_pcagan': {'cosine': [0.4387626,
                                        0.41599864,
                                        0.42613742,
                                        0.360659,
                                        0.468969,
                                        0.3533895,
                                        0.3902504,
                                        0.35494515,
                                        0.3939279,
                                        0.41062677,
                                        0.36097977,
                                        0.30207518,
                                        0.34641826,
                                        0.4046147,
                                        0.45715454,
                                        0.36398712,
                                        0.42486072,
                                        0.34136277,
                                        0.26955205,
                                        0.097995624,
                                        0.12323273,
                                        0.12656759,
                                        0.087921366,
                                        0.08215378,
                                        0.0696855,
                                        0.07912246,
                                        0.10409538,
                                        0.07176719,
                                        0.091908224,
                                        0.06502632,
                                        0.14065637,
                                        0.117391214,
                                        0.067796305],
                             'mae': [0.009382668,
                                     0.009908492,
                                     0.009211297,
                                     0.010133679,
                                     0.009041244,
                                     0.010240561,
                                     0.009852667,
                                     0.010356153,
                                     0.009896762,
                                     0.010058502,
                                     0.010885249,
                                     0.011073996,
                                     0.010986031,
                                     0.010947844,
                                     0.00935588,
                                     0.010818651,
                                     0.010233925,
                                     0.010895461,
                                     0.012018554,
                                     0.012802533,
                                     0.011650951,
                                     0.012634756,
                                     0.01210576,
                                     0.013635444,
                                     0.013055558,
                                     0.01210564,
                                     0.013552969,
                                     0.013401265,
                                     0.011522068,
                                     0.011652079,
                                     0.011048467,
                                     0.011472613,
                                     0.012744593],
                             'max_mae': 0.013635444,
                             'max_mse': 0.00034686862,
                             'max_rmse': 0.01862441,
                             'median_distance': 1.6289206,
                             'median_mae': 0.010986031,
                             'min_cosine': 0.06502632,
                             'mse': [0.00019187198,
                                     0.00022979069,
                                     0.00019615733,
                                     0.00030990303,
                                     0.00017678892,
                                     0.0003022063,
                                     0.0002511937,
                                     0.0002969381,
                                     0.00024500221,
                                     0.00021846574,
                                     0.00030325956,
                                     0.00024989148,
                                     0.0003465581,
                                     0.00023263558,
                                     0.0001849262,
                                     0.00028597115,
                                     0.00020073354,
                                     0.00023146023,
                                     0.00028683996,
                                     0.00031631274,
                                     0.00026533828,
                                     0.00032263104,
                                     0.0003152286,
                                     0.00034367855,
                                     0.0003116733,
                                     0.00026565883,
                                     0.00033252445,
                                     0.00034686862,
                                     0.00024985787,
                                     0.0002502924,
                                     0.00023611455,
                                     0.00024930242,
                                     0.0003298978],
                             'rmse': [0.013851786,
                                      0.015158849,
                                      0.014005618,
                                      0.017604062,
                                      0.013296199,
                                      0.017384082,
                                      0.015849091,
                                      0.017231891,
                                      0.015652547,
                                      0.014780587,
                                      0.01741435,
                                      0.015807956,
                                      0.018616071,
                                      0.0152523955,
                                      0.013598758,
                                      0.016910682,
                                      0.014168046,
                                      0.015213817,
                                      0.01693635,
                                      0.017785184,
                                      0.016289208,
                                      0.017961932,
                                      0.017754678,
                                      0.01853857,
                                      0.017654272,
                                      0.016299045,
                                      0.018235253,
                                      0.01862441,
                                      0.015806893,
                                      0.015820632,
                                      0.015366019,
                                      0.015789313,
                                      0.018163089]},
 'residuals': {'mae': 0.011172191239893436,
               'mse': 0.0002689688408281654,
               'psnr': 13.335091590881348,
               'rmse': 0.01640027016401291,
               'ssds': [97.18146, 9.109238],
               'ssim': 0.3307795226573944},
 'spectra_pcagan': {'cosine': [0.9887659,
                               0.98646796,
                               0.9891089,
                               0.98858225,
                               0.9879582,
                               0.9920108,
                               0.98568064,
                               0.9880415,
                               0.9759085,
                               0.9872148,
                               0.97488207,
                               0.76706815,
                               0.97596574,
                               0.9765911,
                               0.98319095,
                               0.97775674,
                               0.97566,
                               0.9787678,
                               0.9790952,
                               0.98449445,
                               0.9910218,
                               0.98872876,
                               0.99147594,
                               0.9914214,
                               0.9938412,
                               0.93819517,
                               0.9918957,
                               0.9927317,
                               0.99526256,
                               0.9935521,
                               0.9915305,
                               0.99317604,
                               0.9936094],
                    'mae': [0.025762519,
                            0.025953906,
                            0.025171282,
                            0.026316956,
                            0.033578075,
                            0.035367265,
                            0.028798101,
                            0.030828323,
                            0.030450817,
                            0.03290971,
                            0.03323048,
                            0.12410525,
                            0.03363924,
                            0.029805109,
                            0.023904284,
                            0.027446698,
                            0.029179074,
                            0.02868381,
                            0.02995586,
                            0.029299164,
                            0.02546047,
                            0.027177831,
                            0.028417887,
                            0.029285144,
                            0.027921619,
                            0.11875998,
                            0.028177481,
                            0.030289426,
                            0.023011962,
                            0.025608176,
                            0.028153474,
                            0.024509123,
                            0.025025059],
                    'max_mae': 0.12410525,
                    'max_mse': 0.016989611,
                    'max_rmse': 0.1303442,
                    'median_mae': 0.02868381,
                    'min_cosine': 0.76706815,
                    'mse': [0.0012098363,
                            0.0012447641,
                            0.0011492777,
                            0.0013718772,
                            0.0017486454,
                            0.0023468612,
                            0.0014480102,
                            0.001840514,
                            0.0015305837,
                            0.0018093697,
                            0.0018473463,
                            0.016989611,
                            0.0019348513,
                            0.001411104,
                            0.0009878527,
                            0.0013525044,
                            0.0013856085,
                            0.0013328949,
                            0.0014972588,
                            0.0014244829,
                            0.0010859979,
                            0.0012150905,
                            0.0013964864,
                            0.0013810478,
                            0.0013197431,
                            0.015426207,
                            0.0012761761,
                            0.0014709583,
                            0.0008692888,
                            0.0010556164,
                            0.0012772417,
                            0.0009775521,
                            0.0010690887],
                    'rmse': [0.0347827,
                             0.035281215,
                             0.033901,
                             0.03703886,
                             0.04181681,
                             0.048444413,
                             0.03805273,
                             0.04290121,
                             0.039122675,
                             0.042536687,
                             0.042980768,
                             0.1303442,
                             0.043986946,
                             0.037564665,
                             0.031430125,
                             0.03677641,
                             0.037223764,
                             0.036508832,
                             0.03869443,
                             0.037742324,
                             0.032954484,
                             0.03485815,
                             0.037369594,
                             0.03716245,
                             0.036328267,
                             0.12420228,
                             0.035723608,
                             0.038353074,
                             0.029483704,
                             0.03249025,
                             0.03573852,
                             0.03126583,
                             0.03269692]},
 'spectra_realgan': {'cosine': [0.9853506,
                                0.98257405,
                                0.9856367,
                                0.9851226,
                                0.984312,
                                0.9903035,
                                0.9817942,
                                0.9852701,
                                0.9705349,
                                0.98410785,
                                0.9703468,
                                0.76198614,
                                0.9708464,
                                0.97174156,
                                0.9779699,
                                0.9728292,
                                0.97123253,
                                0.976429,
                                0.9774365,
                                0.98422086,
                                0.99088603,
                                0.9885171,
                                0.99137664,
                                0.9913728,
                                0.993823,
                                0.9380459,
                                0.99176824,
                                0.9926546,
                                0.9952085,
                                0.9935163,
                                0.99135286,
                                0.9930964,
                                0.99357784],
                     'mae': [0.030536542,
                             0.030796807,
                             0.03006493,
                             0.031361017,
                             0.037740167,
                             0.040102705,
                             0.03314587,
                             0.035900053,
                             0.034253657,
                             0.037188135,
                             0.036722314,
                             0.12500755,
                             0.03720606,
                             0.032995503,
                             0.02817323,
                             0.031050043,
                             0.03205755,
                             0.030246256,
                             0.031111939,
                             0.029629998,
                             0.025750311,
                             0.027460026,
                             0.02860105,
                             0.029366657,
                             0.027921094,
                             0.11889819,
                             0.02840827,
                             0.030442234,
                             0.023157563,
                             0.025688238,
                             0.028444458,
                             0.024694055,
                             0.025103405],
                     'max_mae': 0.12500755,
                     'max_mse': 0.01737423,
                     'max_rmse': 0.13181135,
                     'median_mae': 0.030536542,
                     'min_cosine': 0.76198614,
                     'mse': [0.0015806443,
                             0.0016184408,
                             0.0015272722,
                             0.0017775253,
                             0.002221153,
                             0.0028398973,
                             0.0018554403,
                             0.0022994638,
                             0.0018836159,
                             0.0022373246,
                             0.0021931205,
                             0.01737423,
                             0.0023092662,
                             0.0017128208,
                             0.0013088244,
                             0.0016492489,
                             0.0016483456,
                             0.0014855413,
                             0.0016122146,
                             0.0014478135,
                             0.0011037901,
                             0.0012380288,
                             0.0014117775,
                             0.0013878379,
                             0.0013203301,
                             0.015465548,
                             0.0012954004,
                             0.0014874135,
                             0.0008781706,
                             0.0010616574,
                             0.0013005527,
                             0.0009892903,
                             0.0010750601],
                     'rmse': [0.03975732,
                              0.04022985,
                              0.03908033,
                              0.04216071,
                              0.04712911,
                              0.053290688,
                              0.043074824,
                              0.047952726,
                              0.043400645,
                              0.047300365,
                              0.046830766,
                              0.13181135,
                              0.048054826,
                              0.04138624,
                              0.03617768,
                              0.040610947,
                              0.040599823,
                              0.03854272,
                              0.040152393,
                              0.038050145,
                              0.03322334,
                              0.03518563,
                              0.037573628,
                              0.037253696,
                              0.036336347,
                              0.124360554,
                              0.035991672,
                              0.038567,
                              0.029633943,
                              0.032583084,
                              0.036063176,
                              0.031452987,
                              0.03278811]},
 'spectra_realpca': {'cosine': [0.996249,
                                0.99579334,
                                0.9963791,
                                0.99636245,
                                0.99638027,
                                0.9981375,
                                0.99587274,
                                0.99696285,
                                0.9946063,
                                0.9966444,
                                0.9949172,
                                0.9978403,
                                0.99466586,
                                0.9954986,
                                0.9941912,
                                0.9949266,
                                0.9950008,
                                0.9973039,
                                0.9982493,
                                0.9996128,
                                0.9998175,
                                0.99980885,
                                0.9999245,
                                0.9998956,
                                0.9999645,
                                0.99997586,
                                0.99993277,
                                0.99995846,
                                0.999959,
                                0.99995476,
                                0.9998384,
                                0.9998871,
                                0.9999587],
                     'mae': [0.015675312,
                             0.015601024,
                             0.01562363,
                             0.016223658,
                             0.016283337,
                             0.017377125,
                             0.016098313,
                             0.016840948,
                             0.014712745,
                             0.01619039,
                             0.015229957,
                             0.0093868915,
                             0.015355125,
                             0.013041408,
                             0.014747629,
                             0.013731478,
                             0.013409369,
                             0.010357431,
                             0.008602166,
                             0.004713209,
                             0.0037145214,
                             0.0035698658,
                             0.002420658,
                             0.003165357,
                             0.0020503665,
                             0.0016376402,
                             0.0025717823,
                             0.0021656437,
                             0.002176167,
                             0.002026073,
                             0.0035156282,
                             0.003182254,
                             0.0020845775],
                     'max_mae': 0.017377125,
                     'max_mse': 0.00048063518,
                     'max_rmse': 0.021923393,
                     'median_mae': 0.010357431,
                     'min_cosine': 0.9941912,
                     'mse': [0.00039255095,
                             0.00039023586,
                             0.00038655993,
                             0.0004229122,
                             0.0004276365,
                             0.00048063518,
                             0.00041345405,
                             0.0004556818,
                             0.00034461176,
                             0.00041813488,
                             0.00037594725,
                             0.00014214726,
                             0.0003766009,
                             0.00027519703,
                             0.00034795696,
                             0.0003010368,
                             0.00028990058,
                             0.00017154944,
                             0.000118533884,
                             3.534327e-05,
                             2.2215221e-05,
                             2.03856e-05,
                             9.470676e-06,
                             1.6085336e-05,
                             6.7175797e-06,
                             4.298202e-06,
                             1.06071775e-05,
                             7.5302096e-06,
                             7.515757e-06,
                             6.609153e-06,
                             1.9790174e-05,
                             1.6179929e-05,
                             6.9515618e-06],
                     'rmse': [0.019812899,
                              0.019754387,
                              0.019661127,
                              0.02056483,
                              0.020679373,
                              0.021923393,
                              0.02033357,
                              0.021346705,
                              0.018563721,
                              0.020448346,
                              0.01938936,
                              0.011922552,
                              0.019406207,
                              0.016589064,
                              0.018653605,
                              0.017350413,
                              0.017026467,
                              0.013097689,
                              0.010887327,
                              0.0059450204,
                              0.0047133025,
                              0.0045150416,
                              0.0030774463,
                              0.0040106527,
                              0.0025918295,
                              0.0020732104,
                              0.0032568662,
                              0.0027441226,
                              0.0027414882,
                              0.0025708273,
                              0.004448615,
                              0.0040224283,
                              0.0026365814]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_80.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529
Directory path: experiments/inpainting/gann_4_night_20180901_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_80.0/images
Optimal number of principal components:  35
Reconstruction error:  6.319179
Energy conservation:  0.80973655
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_80.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.932551248322828, 1.2729080452348625],
                   'kl_div': 2.0324419,
                   'ks_tests': {10000: KstestResult(statistic=0.4137, pvalue=0.0, statistic_location=-0.0016729422, statistic_sign=-1),
                                20000: KstestResult(statistic=0.4212, pvalue=0.0, statistic_location=-0.0017763954, statistic_sign=-1),
                                30000: KstestResult(statistic=0.4134, pvalue=0.0, statistic_location=-0.0017433092, statistic_sign=-1),
                                40000: KstestResult(statistic=0.41447500000000004, pvalue=0.0, statistic_location=-0.001828216, statistic_sign=-1),
                                50000: KstestResult(statistic=0.41676, pvalue=0.0, statistic_location=-0.001851345, statistic_sign=-1),
                                60000: KstestResult(statistic=0.41895, pvalue=0.0, statistic_location=-0.0018750676, statistic_sign=-1),
                                70000: KstestResult(statistic=0.41762857142857146, pvalue=0.0, statistic_location=-0.0017760703, statistic_sign=-1),
                                80000: KstestResult(statistic=0.41828750000000003, pvalue=0.0, statistic_location=-0.0017763954, statistic_sign=-1),
                                90000: KstestResult(statistic=0.4157222222222222, pvalue=0.0, statistic_location=-0.0018812176, statistic_sign=-1),
                                100000: KstestResult(statistic=0.41738000000000003, pvalue=0.0, statistic_location=-0.0018774634, statistic_sign=-1),
                                110000: KstestResult(statistic=0.4192090909090909, pvalue=0.0, statistic_location=-0.0017763954, statistic_sign=-1)},
                   'moments': {'mean_error': 0.99748546,
                               'means': [0.0006159432, 3.172168e-05],
                               'stds': [0.023046242, 0.00083169923],
                               'variance_ratio': 838.63934}},
 'originals': {'gan': {'mae': 0.10246788710355759,
                       'mse': 0.08953791111707687,
                       'psnr': 15.509013175964355,
                       'rmse': 0.29922884702682495,
                       'ssim': 0.8870316743850708},
               'pca': {'mae': 0.001014933455735445,
                       'mse': 2.0797724573640153e-06,
                       'psnr': 62.15809631347656,
                       'rmse': 0.0014421415980905294,
                       'ssim': 0.9998148679733276}},
 'reconstructions': {'mae': 0.10240252315998077,
                     'mse': 0.08953050523996353,
                     'psnr': 15.818548202514648,
                     'rmse': 0.29921647906303406,
                     'ssim': 0.8871300220489502},
 'residual_spectra_pcagan': {'cosine': [0.023509942,
                                        0.062464524,
                                        0.08884042,
                                        0.031128542,
                                        0.06230663,
                                        0.07405201,
                                        0.054572806,
                                        0.032720245,
                                        0.03149404,
                                        0.03620717,
                                        0.018331343],
                             'mae': [0.01142415,
                                     0.012113962,
                                     0.010215408,
                                     0.011230443,
                                     0.011161918,
                                     0.009460346,
                                     0.010233757,
                                     0.0108032655,
                                     0.01029628,
                                     0.010098553,
                                     0.025215587],
                             'max_mae': 0.025215587,
                             'max_mse': 0.0031045007,
                             'max_rmse': 0.055718046,
                             'median_distance': 1.5977411,
                             'median_mae': 0.0108032655,
                             'min_cosine': 0.018331343,
                             'mse': [0.00028312646,
                                     0.0004549999,
                                     0.00024990414,
                                     0.00027884112,
                                     0.000338796,
                                     0.00020758438,
                                     0.00020460134,
                                     0.00024697007,
                                     0.00025527764,
                                     0.0002140092,
                                     0.0031045007],
                             'rmse': [0.016826361,
                                      0.021330727,
                                      0.015808357,
                                      0.016698537,
                                      0.018406412,
                                      0.014407789,
                                      0.014303893,
                                      0.01571528,
                                      0.01597741,
                                      0.014629053,
                                      0.055718046]},
 'residuals': {'mae': 0.012023061513900757,
               'mse': 0.0005307828541845083,
               'psnr': -5.311237335205078,
               'rmse': 0.023038724437355995,
               'ssds': [58.465424, 0.07619959],
               'ssim': 0.5879096388816833},
 'spectra_pcagan': {'cosine': [0.9990699,
                               0.9935178,
                               0.99582845,
                               0.9978239,
                               0.99876094,
                               0.9965967,
                               0.99720824,
                               0.99853706,
                               0.9972739,
                               0.9988382,
                               -0.6451357],
                    'mae': [0.015086818,
                            0.02161509,
                            0.018775748,
                            0.018751455,
                            0.014636798,
                            0.016011849,
                            0.017028054,
                            0.015507059,
                            0.016419888,
                            0.01419697,
                            0.95839804],
                    'max_mae': 0.95839804,
                    'max_mse': 0.9800742,
                    'max_rmse': 0.98998696,
                    'median_mae': 0.016419888,
                    'min_cosine': -0.6451357,
                    'mse': [0.00038142284,
                            0.00077186746,
                            0.00059121934,
                            0.00057246635,
                            0.0003724439,
                            0.00044225034,
                            0.00045672426,
                            0.00038865328,
                            0.00045252737,
                            0.0003317738,
                            0.9800742],
                    'rmse': [0.01953005,
                             0.027782504,
                             0.024315003,
                             0.02392627,
                             0.019298805,
                             0.021029748,
                             0.021371108,
                             0.019714292,
                             0.021272691,
                             0.01821466,
                             0.98998696]},
 'spectra_realgan': {'cosine': [0.99906915,
                                0.9933958,
                                0.99578017,
                                0.9978164,
                                0.9987539,
                                0.99656457,
                                0.9971878,
                                0.99853414,
                                0.99725324,
                                0.9988347,
                                -0.6451682],
                     'mae': [0.015093413,
                             0.021834007,
                             0.018909004,
                             0.01878682,
                             0.014685913,
                             0.016091838,
                             0.017106565,
                             0.015522933,
                             0.016487284,
                             0.014210428,
                             0.95841867],
                     'max_mae': 0.95841867,
                     'max_mse': 0.98011833,
                     'max_rmse': 0.99000925,
                     'median_mae': 0.016487284,
                     'min_cosine': -0.6451682,
                     'mse': [0.00038180794,
                             0.0007860678,
                             0.00059797306,
                             0.00057443464,
                             0.00037425736,
                             0.00044651533,
                             0.00046026468,
                             0.00038939103,
                             0.0004553615,
                             0.00033263222,
                             0.98011833],
                     'rmse': [0.019539906,
                              0.0280369,
                              0.024453487,
                              0.023967367,
                              0.019345732,
                              0.02113091,
                              0.02145378,
                              0.019732993,
                              0.0213392,
                              0.018238207,
                              0.99000925]},
 'spectra_realpca': {'cosine': [0.99999887,
                                0.99993944,
                                0.99997705,
                                0.9999944,
                                0.99999684,
                                0.9999697,
                                0.9999843,
                                0.999998,
                                0.99998546,
                                0.999998,
                                0.9999993],
                     'mae': [0.00050922425,
                             0.00212097,
                             0.0013939334,
                             0.00084039295,
                             0.0007461581,
                             0.0015564451,
                             0.0012520396,
                             0.0005795231,
                             0.0012119334,
                             0.00060389156,
                             0.0003497562],
                     'max_mae': 0.00212097,
                     'max_mse': 7.2318426e-06,
                     'max_rmse': 0.0026892086,
                     'median_mae': 0.00084039295,
                     'min_cosine': 0.99993944,
                     'mse': [4.1661715e-07,
                             7.2318426e-06,
                             3.1176896e-06,
                             1.1368973e-06,
                             8.9680145e-07,
                             3.8691614e-06,
                             2.5229836e-06,
                             5.392124e-07,
                             2.3623477e-06,
                             5.874298e-07,
                             1.9651377e-07],
                     'rmse': [0.0006454589,
                              0.0026892086,
                              0.0017656981,
                              0.0010662539,
                              0.00094699604,
                              0.0019670185,
                              0.0015883902,
                              0.00073431083,
                              0.0015369931,
                              0.00076643965,
                              0.00044329872]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_80.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319
Directory path: experiments/inpainting/gann_4_night_20180901_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_80.0/images
Optimal number of principal components:  35
Reconstruction error:  6.319179
Energy conservation:  0.80973655
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_80.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.940780002103074, 1.9250008155746527],
                   'kl_div': 1.4030392,
                   'ks_tests': {10000: KstestResult(statistic=0.3544, pvalue=0.0, statistic_location=-0.0021131951, statistic_sign=-1),
                                20000: KstestResult(statistic=0.35145, pvalue=0.0, statistic_location=-0.0020328348, statistic_sign=-1),
                                30000: KstestResult(statistic=0.3506666666666667, pvalue=0.0, statistic_location=-0.0020522047, statistic_sign=-1),
                                40000: KstestResult(statistic=0.346175, pvalue=0.0, statistic_location=-0.0019683833, statistic_sign=-1),
                                50000: KstestResult(statistic=0.35051999999999994, pvalue=0.0, statistic_location=-0.0020651491, statistic_sign=-1),
                                60000: KstestResult(statistic=0.34975, pvalue=0.0, statistic_location=-0.0021253452, statistic_sign=-1),
                                70000: KstestResult(statistic=0.3513857142857143, pvalue=0.0, statistic_location=-0.0018927725, statistic_sign=-1),
                                80000: KstestResult(statistic=0.34773750000000003, pvalue=0.0, statistic_location=-0.002049055, statistic_sign=-1),
                                90000: KstestResult(statistic=0.3488111111111111, pvalue=0.0, statistic_location=-0.0019603106, statistic_sign=-1),
                                100000: KstestResult(statistic=0.34782, pvalue=0.0, statistic_location=-0.0020477884, statistic_sign=-1),
                                110000: KstestResult(statistic=0.3501363636363637, pvalue=0.0, statistic_location=-0.0020503215, statistic_sign=-1),
                                120000: KstestResult(statistic=0.34625, pvalue=0.0, statistic_location=-0.00196228, statistic_sign=-1),
                                130000: KstestResult(statistic=0.3486307692307692, pvalue=0.0, statistic_location=-0.0020878767, statistic_sign=-1),
                                140000: KstestResult(statistic=0.3513428571428571, pvalue=0.0, statistic_location=-0.002052052, statistic_sign=-1),
                                150000: KstestResult(statistic=0.35196666666666665, pvalue=0.0, statistic_location=-0.0020945156, statistic_sign=-1),
                                160000: KstestResult(statistic=0.35028125, pvalue=0.0, statistic_location=-0.002126731, statistic_sign=-1),
                                170000: KstestResult(statistic=0.34786470588235296, pvalue=0.0, statistic_location=-0.0021265987, statistic_sign=-1),
                                180000: KstestResult(statistic=0.34762777777777776, pvalue=0.0, statistic_location=-0.0020476375, statistic_sign=-1),
                                190000: KstestResult(statistic=0.3501526315789474, pvalue=0.0, statistic_location=-0.0020569563, statistic_sign=-1),
                                200000: KstestResult(statistic=0.34956000000000004, pvalue=0.0, statistic_location=-0.0020476375, statistic_sign=-1),
                                210000: KstestResult(statistic=0.3496, pvalue=0.0, statistic_location=-0.0019638203, statistic_sign=-1),
                                220000: KstestResult(statistic=0.34914545454545454, pvalue=0.0, statistic_location=-0.0020573265, statistic_sign=-1)},
                   'moments': {'mean_error': -0.00033779297,
                               'means': [-0.00023313925, -1.0349345e-05],
                               'stds': [0.0203259, 0.0025482618],
                               'variance_ratio': 64.16617}},
 'originals': {'gan': {'mae': 0.0791468694806099,
                       'mse': 0.051039062440395355,
                       'psnr': 18.142791748046875,
                       'rmse': 0.2259182631969452,
                       'ssim': 0.575168788433075},
               'pca': {'mae': 0.003025508252903819,
                       'mse': 3.821253631031141e-05,
                       'psnr': 49.6656379699707,
                       'rmse': 0.006181628908962011,
                       'ssim': 0.9998088479042053}},
 'reconstructions': {'mae': 0.07887451350688934,
                     'mse': 0.05100134760141373,
                     'psnr': 18.41187858581543,
                     'rmse': 0.22583477199077606,
                     'ssim': 0.5752770900726318},
 'residual_spectra_pcagan': {'cosine': [0.33402824,
                                        0.29329294,
                                        0.22499497,
                                        0.2447529,
                                        0.076562084,
                                        0.029223446,
                                        0.07119478,
                                        0.09355611,
                                        0.03625281,
                                        0.07041703,
                                        0.08299686,
                                        0.054981433,
                                        0.03287061,
                                        0.04159417,
                                        0.04063483,
                                        0.016036496,
                                        0.04549955,
                                        0.018742917,
                                        0.02906257,
                                        0.043338887,
                                        0.03622622,
                                        0.3632206],
                             'mae': [0.00967369,
                                     0.010892828,
                                     0.011299738,
                                     0.011098193,
                                     0.011126524,
                                     0.011212435,
                                     0.011723502,
                                     0.0098751,
                                     0.01078389,
                                     0.010527807,
                                     0.009169073,
                                     0.0101743145,
                                     0.010254043,
                                     0.009860139,
                                     0.009532488,
                                     0.025696356,
                                     0.010555452,
                                     0.012867206,
                                     0.011434976,
                                     0.0109851975,
                                     0.011417794,
                                     0.008372245],
                             'max_mae': 0.025696356,
                             'max_mse': 0.0032346116,
                             'max_rmse': 0.056873646,
                             'median_distance': 1.5827357,
                             'median_mae': 0.01083836,
                             'min_cosine': 0.016036496,
                             'mse': [0.00021149564,
                                     0.00034461106,
                                     0.00054167595,
                                     0.00033944787,
                                     0.00031684135,
                                     0.00027148,
                                     0.00041023555,
                                     0.00022025092,
                                     0.00024743704,
                                     0.00027578426,
                                     0.00018495628,
                                     0.00020153885,
                                     0.00021223347,
                                     0.00021256319,
                                     0.00017628256,
                                     0.0032346116,
                                     0.00021436777,
                                     0.00033344203,
                                     0.00025359236,
                                     0.00024402642,
                                     0.0003137472,
                                     0.00018102115],
                             'rmse': [0.01454289,
                                      0.018563703,
                                      0.023273934,
                                      0.01842411,
                                      0.017800039,
                                      0.01647665,
                                      0.020254273,
                                      0.014840853,
                                      0.015730131,
                                      0.016606754,
                                      0.013599863,
                                      0.014196438,
                                      0.014568235,
                                      0.014579547,
                                      0.013277144,
                                      0.056873646,
                                      0.014641304,
                                      0.018260395,
                                      0.015924584,
                                      0.0156213455,
                                      0.017712912,
                                      0.01345441]},
 'residuals': {'mae': 0.01129695400595665,
               'mse': 0.0004064382810611278,
               'psnr': 16.656862258911133,
               'rmse': 0.020160313695669174,
               'ssds': [90.90281, 1.4286177],
               'ssim': 0.6091494560241699},
 'spectra_pcagan': {'cosine': [0.9694354,
                               0.98748845,
                               0.9800414,
                               0.9872829,
                               0.9951991,
                               0.9990506,
                               0.993456,
                               0.995856,
                               0.99783015,
                               0.99879193,
                               0.9967191,
                               0.997139,
                               0.99852514,
                               0.9972771,
                               0.99887514,
                               -0.64448214,
                               0.9986959,
                               0.9994831,
                               0.9991622,
                               0.9951255,
                               0.006193434,
                               0.98965853],
                    'mae': [0.03564285,
                            0.046084266,
                            0.03291041,
                            0.03440648,
                            0.019689463,
                            0.015094009,
                            0.021695442,
                            0.01868768,
                            0.018667813,
                            0.01450248,
                            0.0158449,
                            0.017291937,
                            0.015537534,
                            0.016465858,
                            0.014016574,
                            0.9586621,
                            0.015719086,
                            0.014387991,
                            0.014914827,
                            0.022104727,
                            0.3448415,
                            0.028071243],
                    'max_mae': 0.9586621,
                    'max_mse': 0.98097676,
                    'max_rmse': 0.9904427,
                    'median_mae': 0.018677747,
                    'min_cosine': -0.64448214,
                    'mse': [0.0017398605,
                            0.0029838164,
                            0.0019209574,
                            0.001771233,
                            0.00066334783,
                            0.0003815899,
                            0.0007786262,
                            0.00058341253,
                            0.00056482124,
                            0.0003641306,
                            0.00042637505,
                            0.0004703886,
                            0.00039154926,
                            0.0004531349,
                            0.00032115114,
                            0.98097676,
                            0.0003944499,
                            0.00033315763,
                            0.00035936627,
                            0.000742276,
                            0.124221146,
                            0.0011880127],
                    'rmse': [0.041711636,
                             0.05462432,
                             0.043828726,
                             0.04208602,
                             0.02575554,
                             0.019534325,
                             0.027903873,
                             0.024153935,
                             0.023765968,
                             0.019082205,
                             0.02064885,
                             0.021688445,
                             0.019787604,
                             0.021286966,
                             0.01792069,
                             0.9904427,
                             0.019860763,
                             0.018252606,
                             0.01895696,
                             0.027244743,
                             0.3524502,
                             0.03446756]},
 'spectra_realgan': {'cosine': [0.9670778,
                                0.9860739,
                                0.9780557,
                                0.98576266,
                                0.9951324,
                                0.99904984,
                                0.993334,
                                0.9958081,
                                0.9978229,
                                0.99878496,
                                0.99668676,
                                0.99711907,
                                0.9985224,
                                0.9972569,
                                0.99887186,
                                -0.6445148,
                                0.9986888,
                                0.9994831,
                                0.9991609,
                                0.9950985,
                                0.00620771,
                                0.98793983],
                     'mae': [0.03637817,
                             0.046589788,
                             0.034258008,
                             0.035527002,
                             0.019814119,
                             0.015101448,
                             0.02191781,
                             0.018824134,
                             0.018703619,
                             0.014546591,
                             0.015915832,
                             0.017371306,
                             0.015557715,
                             0.016533135,
                             0.014031367,
                             0.95868284,
                             0.01574498,
                             0.0143905,
                             0.014926655,
                             0.02216288,
                             0.34483683,
                             0.029416408],
                     'max_mae': 0.95868284,
                     'max_mse': 0.9810211,
                     'max_rmse': 0.9904651,
                     'median_mae': 0.018763877,
                     'min_cosine': -0.6445148,
                     'mse': [0.0018786305,
                             0.0031433513,
                             0.0020680984,
                             0.0019107212,
                             0.00067015114,
                             0.00038199013,
                             0.00079278374,
                             0.0005900748,
                             0.0005667468,
                             0.00036588818,
                             0.000430694,
                             0.00047388955,
                             0.0003922552,
                             0.0004558564,
                             0.00032200202,
                             0.9810211,
                             0.0003959076,
                             0.0003332668,
                             0.00035991942,
                             0.0007465529,
                             0.12421885,
                             0.001340763],
                     'rmse': [0.04334317,
                              0.056065597,
                              0.04547635,
                              0.043711796,
                              0.025887277,
                              0.019544568,
                              0.028156416,
                              0.024291456,
                              0.023806445,
                              0.019128203,
                              0.020753168,
                              0.021769004,
                              0.019805433,
                              0.021350794,
                              0.017944414,
                              0.9904651,
                              0.019897427,
                              0.018255597,
                              0.018971542,
                              0.02732312,
                              0.35244694,
                              0.03661643]},
 'spectra_realpca': {'cosine': [0.9975594,
                                0.9987801,
                                0.9979684,
                                0.9983811,
                                0.99994576,
                                0.99999887,
                                0.99993944,
                                0.99997705,
                                0.9999944,
                                0.99999684,
                                0.9999697,
                                0.9999843,
                                0.999998,
                                0.99998546,
                                0.999998,
                                0.9999993,
                                0.9999972,
                                0.99999976,
                                0.99999905,
                                0.9999849,
                                0.9999857,
                                0.9982369],
                     'mae': [0.009397122,
                             0.010575426,
                             0.0099671455,
                             0.00976587,
                             0.0019564244,
                             0.00050922425,
                             0.00212097,
                             0.0013939334,
                             0.00084039295,
                             0.0007461581,
                             0.0015564451,
                             0.0012520396,
                             0.0005795231,
                             0.0012119334,
                             0.00060389156,
                             0.0003497562,
                             0.0007127237,
                             0.00027102302,
                             0.0004820669,
                             0.0011600062,
                             0.00097283564,
                             0.010136268],
                     'max_mae': 0.010575426,
                     'max_mse': 0.0001880867,
                     'max_rmse': 0.013714471,
                     'median_mae': 0.0011859698,
                     'min_cosine': 0.9975594,
                     'mse': [0.00014116472,
                             0.0001880867,
                             0.00015890227,
                             0.00015226906,
                             6.153387e-06,
                             4.1661715e-07,
                             7.2318426e-06,
                             3.1176896e-06,
                             1.1368973e-06,
                             8.9680145e-07,
                             3.8691614e-06,
                             2.5229836e-06,
                             5.392124e-07,
                             2.3623477e-06,
                             5.874298e-07,
                             1.9651377e-07,
                             8.23492e-07,
                             1.1838623e-07,
                             3.757694e-07,
                             2.1579872e-06,
                             1.5149402e-06,
                             0.0001662316],
                     'rmse': [0.011881276,
                              0.013714471,
                              0.012605645,
                              0.0123397345,
                              0.0024806021,
                              0.0006454589,
                              0.0026892086,
                              0.0017656981,
                              0.0010662539,
                              0.00094699604,
                              0.0019670185,
                              0.0015883902,
                              0.00073431083,
                              0.0015369931,
                              0.00076643965,
                              0.00044329872,
                              0.0009074646,
                              0.000344073,
                              0.0006130003,
                              0.0014690089,
                              0.001230829,
                              0.0128930835]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_80.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809
Directory path: experiments/inpainting/gann_4_night_20180901_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_80.0/images
Optimal number of principal components:  35
Reconstruction error:  6.319179
Energy conservation:  0.80973655
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_80.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9130967822707543, 2.263199905950067],
                   'kl_div': 1.0584062,
                   'ks_tests': {10000: KstestResult(statistic=0.2947, pvalue=1e-323, statistic_location=-0.002224937, statistic_sign=-1),
                                20000: KstestResult(statistic=0.30255, pvalue=0.0, statistic_location=-0.0022084182, statistic_sign=-1),
                                30000: KstestResult(statistic=0.3015333333333333, pvalue=0.0, statistic_location=-0.0023632748, statistic_sign=-1),
                                40000: KstestResult(statistic=0.293625, pvalue=0.0, statistic_location=-0.002380737, statistic_sign=-1),
                                50000: KstestResult(statistic=0.3024, pvalue=0.0, statistic_location=-0.002323363, statistic_sign=-1),
                                60000: KstestResult(statistic=0.29610000000000003, pvalue=0.0, statistic_location=-0.0023172814, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2980571428571429, pvalue=0.0, statistic_location=-0.0021486953, statistic_sign=-1),
                                80000: KstestResult(statistic=0.296825, pvalue=0.0, statistic_location=-0.0022724126, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2970666666666667, pvalue=0.0, statistic_location=-0.0022717174, statistic_sign=-1),
                                100000: KstestResult(statistic=0.29932000000000003, pvalue=0.0, statistic_location=-0.0022940636, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2993363636363636, pvalue=0.0, statistic_location=-0.0022737533, statistic_sign=-1),
                                120000: KstestResult(statistic=0.2975333333333333, pvalue=0.0, statistic_location=-0.002160496, statistic_sign=-1),
                                130000: KstestResult(statistic=0.2994692307692308, pvalue=0.0, statistic_location=-0.0022731526, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2968642857142857, pvalue=0.0, statistic_location=-0.002274427, statistic_sign=-1),
                                150000: KstestResult(statistic=0.29929333333333336, pvalue=0.0, statistic_location=-0.002298832, statistic_sign=-1),
                                160000: KstestResult(statistic=0.298025, pvalue=0.0, statistic_location=-0.002210251, statistic_sign=-1),
                                170000: KstestResult(statistic=0.2979352941176471, pvalue=0.0, statistic_location=-0.0022731526, statistic_sign=-1),
                                180000: KstestResult(statistic=0.2973055555555556, pvalue=0.0, statistic_location=-0.0022733994, statistic_sign=-1),
                                190000: KstestResult(statistic=0.29936315789473683, pvalue=0.0, statistic_location=-0.0022731526, statistic_sign=-1),
                                200000: KstestResult(statistic=0.29831, pvalue=0.0, statistic_location=-0.002276918, statistic_sign=-1),
                                210000: KstestResult(statistic=0.29865238095238095, pvalue=0.0, statistic_location=-0.0022731526, statistic_sign=-1),
                                220000: KstestResult(statistic=0.29900000000000004, pvalue=0.0, statistic_location=-0.0022247788, statistic_sign=-1),
                                230000: KstestResult(statistic=0.29886521739130434, pvalue=0.0, statistic_location=-0.0022401405, statistic_sign=-1),
                                240000: KstestResult(statistic=0.298925, pvalue=0.0, statistic_location=-0.0022731526, statistic_sign=-1),
                                250000: KstestResult(statistic=0.29866800000000004, pvalue=0.0, statistic_location=-0.0022733994, statistic_sign=-1),
                                260000: KstestResult(statistic=0.2979807692307692, pvalue=0.0, statistic_location=-0.002268725, statistic_sign=-1),
                                270000: KstestResult(statistic=0.2973222222222222, pvalue=0.0, statistic_location=-0.002254732, statistic_sign=-1),
                                280000: KstestResult(statistic=0.2989607142857143, pvalue=0.0, statistic_location=-0.0022937637, statistic_sign=-1),
                                290000: KstestResult(statistic=0.29669655172413795, pvalue=0.0, statistic_location=-0.0022739917, statistic_sign=-1),
                                300000: KstestResult(statistic=0.29717333333333334, pvalue=0.0, statistic_location=-0.0022866726, statistic_sign=-1),
                                310000: KstestResult(statistic=0.29973225806451614, pvalue=0.0, statistic_location=-0.0022723097, statistic_sign=-1),
                                320000: KstestResult(statistic=0.29824375000000003, pvalue=0.0, statistic_location=-0.0022715614, statistic_sign=-1),
                                330000: KstestResult(statistic=0.2983030303030303, pvalue=0.0, statistic_location=-0.0022675246, statistic_sign=-1)},
                   'moments': {'mean_error': -0.05964995,
                               'means': [-0.00039741758, -1.2194379e-05],
                               'stds': [0.018622587, 0.0032514466],
                               'variance_ratio': 27.400137}},
 'originals': {'gan': {'mae': 0.061107855290174484,
                       'mse': 0.03438358008861542,
                       'psnr': 19.85433006286621,
                       'rmse': 0.18542809784412384,
                       'ssim': 0.6147010922431946},
               'pca': {'mae': 0.004248368553817272,
                       'mse': 5.720969056710601e-05,
                       'psnr': 47.91299819946289,
                       'rmse': 0.007563708815723658,
                       'ssim': 0.9981507062911987}},
 'reconstructions': {'mae': 0.06057796999812126,
                     'mse': 0.03432800993323326,
                     'psnr': 20.131210327148438,
                     'rmse': 0.18527819216251373,
                     'ssim': 0.6156668663024902},
 'residual_spectra_pcagan': {'cosine': [0.3372921,
                                        0.37475938,
                                        0.30985922,
                                        0.37181878,
                                        0.39017612,
                                        0.26612717,
                                        0.36621633,
                                        0.32215995,
                                        0.2449883,
                                        0.2468095,
                                        0.07797374,
                                        0.029364165,
                                        0.079481274,
                                        0.09932152,
                                        0.04347057,
                                        0.07004713,
                                        0.08568734,
                                        0.06500626,
                                        0.035223935,
                                        0.04904203,
                                        0.042014703,
                                        0.014652204,
                                        0.052466907,
                                        0.02076339,
                                        0.035792403,
                                        0.04178457,
                                        0.038599003,
                                        0.3954199,
                                        0.2823629,
                                        0.20692727,
                                        0.03611248,
                                        0.038451202,
                                        0.027819507],
                             'mae': [0.008717267,
                                     0.007939734,
                                     0.008611371,
                                     0.008238248,
                                     0.0080537265,
                                     0.0100995945,
                                     0.009214723,
                                     0.010209375,
                                     0.010601738,
                                     0.011036263,
                                     0.010802339,
                                     0.010790969,
                                     0.011500839,
                                     0.009548519,
                                     0.010397481,
                                     0.010181055,
                                     0.009087408,
                                     0.0099687,
                                     0.009816686,
                                     0.009650189,
                                     0.009304433,
                                     0.025857044,
                                     0.010316357,
                                     0.012579845,
                                     0.010977752,
                                     0.010760837,
                                     0.011162321,
                                     0.007871942,
                                     0.00954978,
                                     0.011234645,
                                     0.011190165,
                                     0.011561305,
                                     0.0100364955],
                             'max_mae': 0.025857044,
                             'max_mse': 0.0033106578,
                             'max_rmse': 0.057538316,
                             'median_distance': 1.5116336,
                             'median_mae': 0.010181055,
                             'min_cosine': 0.014652204,
                             'mse': [0.00020791209,
                                     0.00015097373,
                                     0.00021172418,
                                     0.00016101162,
                                     0.0001432308,
                                     0.00032697903,
                                     0.00017833475,
                                     0.00028151003,
                                     0.00045035325,
                                     0.00033573588,
                                     0.00028653725,
                                     0.00024507387,
                                     0.00035750307,
                                     0.00019532685,
                                     0.00022720537,
                                     0.00024086252,
                                     0.00018328318,
                                     0.00019325757,
                                     0.0001833821,
                                     0.0001923364,
                                     0.0001683737,
                                     0.0033106578,
                                     0.00020186476,
                                     0.000315912,
                                     0.0002285036,
                                     0.00023360158,
                                     0.00030248598,
                                     0.00014774915,
                                     0.00023793215,
                                     0.0004439126,
                                     0.00027940044,
                                     0.00027278485,
                                     0.0002124568],
                             'rmse': [0.014419157,
                                      0.012287137,
                                      0.0145507455,
                                      0.012689035,
                                      0.011967908,
                                      0.018082561,
                                      0.013354204,
                                      0.01677826,
                                      0.021221528,
                                      0.018323097,
                                      0.016927412,
                                      0.015654836,
                                      0.018907752,
                                      0.013975938,
                                      0.015073333,
                                      0.015519746,
                                      0.013538212,
                                      0.013901711,
                                      0.013541865,
                                      0.0138685405,
                                      0.012975889,
                                      0.057538316,
                                      0.014207912,
                                      0.017773913,
                                      0.015116336,
                                      0.01528403,
                                      0.017392123,
                                      0.012155211,
                                      0.01542505,
                                      0.021069234,
                                      0.016715275,
                                      0.0165162,
                                      0.014575898]},
 'residuals': {'mae': 0.0105111850425601,
               'mse': 0.00033661117777228355,
               'psnr': 17.55622100830078,
               'rmse': 0.018346967175602913,
               'ssds': [114.495995, 3.4887674],
               'ssim': 0.6131283640861511},
 'spectra_pcagan': {'cosine': [0.9835662,
                               0.9814311,
                               0.98536694,
                               0.98779285,
                               0.98350006,
                               0.9839018,
                               0.9691891,
                               0.9878283,
                               0.98083395,
                               0.9875129,
                               0.99525833,
                               0.9990504,
                               0.99337906,
                               0.99581176,
                               0.99785495,
                               0.9987778,
                               0.9965976,
                               0.99713486,
                               0.99850243,
                               0.9972256,
                               0.99882716,
                               -0.645872,
                               0.9986612,
                               0.99946684,
                               0.9991684,
                               0.9948811,
                               0.007373891,
                               0.98957497,
                               0.97955984,
                               0.9746212,
                               0.99950624,
                               0.9982018,
                               0.9990278],
                    'mae': [0.023541287,
                            0.02691421,
                            0.02235997,
                            0.022648592,
                            0.025274867,
                            0.026035868,
                            0.035898197,
                            0.04592182,
                            0.03259917,
                            0.03444315,
                            0.019276243,
                            0.015153836,
                            0.021790048,
                            0.018723005,
                            0.018515341,
                            0.014626228,
                            0.015983233,
                            0.017237574,
                            0.015683789,
                            0.016565476,
                            0.01425592,
                            0.9591823,
                            0.015888888,
                            0.014692853,
                            0.014887428,
                            0.022529028,
                            0.34435895,
                            0.02838818,
                            0.03684402,
                            0.03149195,
                            0.01472202,
                            0.01793883,
                            0.014700698],
                    'max_mae': 0.9591823,
                    'max_mse': 0.98144895,
                    'max_rmse': 0.99068105,
                    'median_mae': 0.021790048,
                    'min_cosine': -0.645872,
                    'mse': [0.00093904656,
                            0.0010667095,
                            0.00086682127,
                            0.00081187696,
                            0.00094631617,
                            0.0011462624,
                            0.0017557195,
                            0.0029618968,
                            0.001881597,
                            0.0017966587,
                            0.0006315999,
                            0.00038117595,
                            0.0007863533,
                            0.0005839796,
                            0.00055483065,
                            0.00036959452,
                            0.00043885774,
                            0.00046724678,
                            0.00039743393,
                            0.00046164665,
                            0.00033486518,
                            0.98144895,
                            0.00040598927,
                            0.00034572164,
                            0.0003587396,
                            0.00077227515,
                            0.12383934,
                            0.0012068187,
                            0.0020561751,
                            0.0015748077,
                            0.00036064233,
                            0.00051153044,
                            0.00036277957],
                    'rmse': [0.030643867,
                             0.032660518,
                             0.029441828,
                             0.028493455,
                             0.030762251,
                             0.033856496,
                             0.041901305,
                             0.05442331,
                             0.043377377,
                             0.042387012,
                             0.025131652,
                             0.019523729,
                             0.028041992,
                             0.02416567,
                             0.023554843,
                             0.019224841,
                             0.020948932,
                             0.021615893,
                             0.019935746,
                             0.021485964,
                             0.018299323,
                             0.99068105,
                             0.020149175,
                             0.01859359,
                             0.018940423,
                             0.027789839,
                             0.35190815,
                             0.034739297,
                             0.045345068,
                             0.039683845,
                             0.018990586,
                             0.022617038,
                             0.019046772]},
 'spectra_realgan': {'cosine': [0.98116416,
                                0.9792906,
                                0.9832459,
                                0.98577976,
                                0.9814677,
                                0.98156124,
                                0.9668413,
                                0.9864012,
                                0.97883904,
                                0.9860042,
                                0.99519145,
                                0.9990496,
                                0.9932539,
                                0.9957636,
                                0.99784756,
                                0.9987711,
                                0.996565,
                                0.9971138,
                                0.9984994,
                                0.9972058,
                                0.9988238,
                                -0.64590436,
                                0.998654,
                                0.99946684,
                                0.999167,
                                0.9948542,
                                0.0073883943,
                                0.9878665,
                                0.97839326,
                                0.97260165,
                                0.99950576,
                                0.9981981,
                                0.99902624],
                     'mae': [0.025522962,
                             0.02819047,
                             0.024054082,
                             0.024406085,
                             0.026515229,
                             0.02765658,
                             0.0366096,
                             0.04644786,
                             0.033958904,
                             0.03557728,
                             0.01940579,
                             0.015161359,
                             0.022016011,
                             0.018857328,
                             0.018548708,
                             0.01466665,
                             0.016057845,
                             0.017318573,
                             0.015701028,
                             0.016630571,
                             0.01427325,
                             0.95920295,
                             0.01591568,
                             0.014694339,
                             0.014899051,
                             0.02259362,
                             0.3443543,
                             0.029696891,
                             0.03761046,
                             0.032620154,
                             0.014728023,
                             0.01795012,
                             0.014717337],
                     'max_mae': 0.95920295,
                     'max_mse': 0.9814932,
                     'max_rmse': 0.99070334,
                     'median_mae': 0.022016011,
                     'min_cosine': -0.64590436,
                     'mse': [0.0010776102,
                             0.0011927221,
                             0.0009870987,
                             0.00093792914,
                             0.0010650458,
                             0.0012817222,
                             0.0018940758,
                             0.0031226284,
                             0.0020291568,
                             0.0019350204,
                             0.0006385489,
                             0.00038157578,
                             0.000800654,
                             0.0005906596,
                             0.00055675977,
                             0.00037131037,
                             0.00044307986,
                             0.00047080207,
                             0.0003982088,
                             0.00046431867,
                             0.00033573667,
                             0.9814932,
                             0.00040745668,
                             0.00034584056,
                             0.00035928897,
                             0.00077649346,
                             0.123837024,
                             0.0013584506,
                             0.0021697725,
                             0.0016991112,
                             0.0003608177,
                             0.00051253545,
                             0.00036351563],
                     'rmse': [0.032826975,
                              0.03453581,
                              0.031418126,
                              0.030625628,
                              0.03263504,
                              0.03580115,
                              0.04352098,
                              0.055880483,
                              0.04504616,
                              0.04398887,
                              0.025269525,
                              0.019533964,
                              0.02829583,
                              0.02430349,
                              0.023595758,
                              0.019269416,
                              0.021049462,
                              0.021697974,
                              0.01995517,
                              0.021548055,
                              0.018323118,
                              0.99070334,
                              0.020185556,
                              0.018596789,
                              0.01895492,
                              0.027865632,
                              0.35190484,
                              0.036857165,
                              0.046580818,
                              0.041220278,
                              0.018995203,
                              0.022639247,
                              0.019066086]},
 'spectra_realpca': {'cosine': [0.99766916,
                                0.99764395,
                                0.99786013,
                                0.9982213,
                                0.997657,
                                0.9975011,
                                0.9975594,
                                0.9987801,
                                0.9979684,
                                0.9983811,
                                0.99994576,
                                0.99999887,
                                0.99993944,
                                0.99997705,
                                0.9999944,
                                0.99999684,
                                0.9999697,
                                0.9999843,
                                0.999998,
                                0.99998546,
                                0.999998,
                                0.9999993,
                                0.9999972,
                                0.99999976,
                                0.99999905,
                                0.9999849,
                                0.9999857,
                                0.9982369,
                                0.99835575,
                                0.9983272,
                                0.99999964,
                                0.9999964,
                                0.99999833],
                     'mae': [0.009069746,
                             0.009207796,
                             0.008746092,
                             0.008299641,
                             0.009183048,
                             0.009683565,
                             0.009397122,
                             0.010575426,
                             0.0099671455,
                             0.00976587,
                             0.0019564244,
                             0.00050922425,
                             0.00212097,
                             0.0013939334,
                             0.00084039295,
                             0.0007461581,
                             0.0015564451,
                             0.0012520396,
                             0.0005795231,
                             0.0012119334,
                             0.00060389156,
                             0.0003497562,
                             0.0007127237,
                             0.00027102302,
                             0.0004820669,
                             0.0011600062,
                             0.00097283564,
                             0.010136268,
                             0.009905317,
                             0.007849261,
                             0.0003144302,
                             0.00078395824,
                             0.0005921303],
                     'max_mae': 0.010575426,
                     'max_mse': 0.0001880867,
                     'max_rmse': 0.013714471,
                     'median_mae': 0.0013939334,
                     'min_cosine': 0.9975011,
                     'mse': [0.0001321939,
                             0.00013555371,
                             0.00012176704,
                             0.000109879824,
                             0.00013486043,
                             0.00015197175,
                             0.00014116472,
                             0.0001880867,
                             0.00015890227,
                             0.00015226906,
                             6.153387e-06,
                             4.1661715e-07,
                             7.2318426e-06,
                             3.1176896e-06,
                             1.1368973e-06,
                             8.9680145e-07,
                             3.8691614e-06,
                             2.5229836e-06,
                             5.392124e-07,
                             2.3623477e-06,
                             5.874298e-07,
                             1.9651377e-07,
                             8.23492e-07,
                             1.1838623e-07,
                             3.757694e-07,
                             2.1579872e-06,
                             1.5149402e-06,
                             0.0001662316,
                             0.00016002475,
                             9.927745e-05,
                             1.5914354e-07,
                             9.868568e-07,
                             5.689739e-07],
                     'rmse': [0.011497561,
                              0.011642753,
                              0.011034811,
                              0.010482358,
                              0.011612942,
                              0.012327682,
                              0.011881276,
                              0.013714471,
                              0.012605645,
                              0.0123397345,
                              0.0024806021,
                              0.0006454589,
                              0.0026892086,
                              0.0017656981,
                              0.0010662539,
                              0.00094699604,
                              0.0019670185,
                              0.0015883902,
                              0.00073431083,
                              0.0015369931,
                              0.00076643965,
                              0.00044329872,
                              0.0009074646,
                              0.000344073,
                              0.0006130003,
                              0.0014690089,
                              0.001230829,
                              0.0128930835,
                              0.012650089,
                              0.009963807,
                              0.00039892798,
                              0.0009934066,
                              0.0007543036]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_80.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521
Directory path: experiments/inpainting/gann_4_night_20180904_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_80.0/images
Optimal number of principal components:  39
Reconstruction error:  4.737751
Energy conservation:  0.80625314
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_80.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9519870688369956, 0.8845663691763775],
                   'kl_div': 2.464681,
                   'ks_tests': {10000: KstestResult(statistic=0.49, pvalue=0.0, statistic_location=0.001199818, statistic_sign=1),
                                20000: KstestResult(statistic=0.49850000000000005, pvalue=0.0, statistic_location=0.0012256862, statistic_sign=1),
                                30000: KstestResult(statistic=0.4977666666666667, pvalue=0.0, statistic_location=0.0011805808, statistic_sign=1),
                                40000: KstestResult(statistic=0.49892500000000006, pvalue=0.0, statistic_location=0.0011376115, statistic_sign=1),
                                50000: KstestResult(statistic=0.49788000000000004, pvalue=0.0, statistic_location=0.0012927921, statistic_sign=1),
                                60000: KstestResult(statistic=0.4989833333333333, pvalue=0.0, statistic_location=0.0011885474, statistic_sign=1),
                                70000: KstestResult(statistic=0.49538571428571426, pvalue=0.0, statistic_location=0.0012003696, statistic_sign=1),
                                80000: KstestResult(statistic=0.4945125, pvalue=0.0, statistic_location=0.0012364888, statistic_sign=1),
                                90000: KstestResult(statistic=0.49512222222222224, pvalue=0.0, statistic_location=0.0011878852, statistic_sign=1),
                                100000: KstestResult(statistic=0.49554000000000004, pvalue=0.0, statistic_location=0.0011945688, statistic_sign=1),
                                110000: KstestResult(statistic=0.4967636363636364, pvalue=0.0, statistic_location=0.0012960732, statistic_sign=1)},
                   'moments': {'mean_error': 2.7614424,
                               'means': [0.00041185232, -4.697429e-06],
                               'stds': [0.018056862, 0.0004561731],
                               'variance_ratio': 1396.1368}},
 'originals': {'gan': {'mae': 0.015457252971827984,
                       'mse': 0.0004065742250531912,
                       'psnr': 33.48286437988281,
                       'rmse': 0.020163685083389282,
                       'ssim': 0.9744046926498413},
               'pca': {'mae': 0.0004907316179014742,
                       'mse': 5.297320058161858e-07,
                       'psnr': 62.75943374633789,
                       'rmse': 0.00072782690403983,
                       'ssim': 0.9999834895133972}},
 'reconstructions': {'mae': 0.015444743447005749,
                     'mse': 0.00040604424430057406,
                     'psnr': 33.91426467895508,
                     'rmse': 0.02015054039657116,
                     'ssim': 0.9744101762771606},
 'residual_spectra_pcagan': {'cosine': [0.018332805,
                                        0.026204169,
                                        0.028972961,
                                        0.014885438,
                                        0.007771172,
                                        -0.0058964924,
                                        0.019774888,
                                        0.033948664,
                                        0.041681603,
                                        0.04501615,
                                        0.015424083],
                             'mae': [0.011259215,
                                     0.013135764,
                                     0.012190133,
                                     0.011825807,
                                     0.013409172,
                                     0.011489528,
                                     0.011101485,
                                     0.01048979,
                                     0.010632014,
                                     0.01039292,
                                     0.010810747],
                             'max_mae': 0.013409172,
                             'max_mse': 0.0005392727,
                             'max_rmse': 0.023222245,
                             'median_distance': 1.7350118,
                             'median_mae': 0.011259215,
                             'min_cosine': -0.0058964924,
                             'mse': [0.0002669207,
                                     0.00048499778,
                                     0.00031817745,
                                     0.0002933091,
                                     0.0005392727,
                                     0.0003020193,
                                     0.00028548745,
                                     0.00025459312,
                                     0.00030102656,
                                     0.00023543651,
                                     0.0003051932],
                             'rmse': [0.016337708,
                                      0.022022665,
                                      0.01783753,
                                      0.01712627,
                                      0.023222245,
                                      0.017378703,
                                      0.016896375,
                                      0.015955975,
                                      0.017350117,
                                      0.015343941,
                                      0.01746978]},
 'residuals': {'mae': 0.011521505191922188,
               'mse': 0.00032603941508568823,
               'psnr': -7.637996196746826,
               'rmse': 0.018056562170386314,
               'ssds': [35.88386, 0.022892544],
               'ssim': 0.2913976013660431},
 'spectra_pcagan': {'cosine': [0.9992131,
                               0.9991769,
                               0.9991689,
                               0.9996014,
                               0.9997204,
                               0.99956834,
                               0.99955666,
                               0.99922776,
                               0.99838096,
                               0.9985793,
                               0.9981274],
                    'mae': [0.016224133,
                            0.016146233,
                            0.016555721,
                            0.014098105,
                            0.01337081,
                            0.013900551,
                            0.013645299,
                            0.014640471,
                            0.017106365,
                            0.01696926,
                            0.017235236],
                    'max_mae': 0.017235236,
                    'max_mse': 0.00051459484,
                    'max_rmse': 0.022684682,
                    'median_mae': 0.016146233,
                    'min_cosine': 0.9981274,
                    'mse': [0.00043011794,
                            0.0004689847,
                            0.00044503078,
                            0.00031663704,
                            0.00032564398,
                            0.00031644758,
                            0.00030625792,
                            0.00035774117,
                            0.00051459484,
                            0.0004756893,
                            0.0005093414],
                    'rmse': [0.020739285,
                             0.021656055,
                             0.021095753,
                             0.017794298,
                             0.018045608,
                             0.017788973,
                             0.017500225,
                             0.018914048,
                             0.022684682,
                             0.021810303,
                             0.022568593]},
 'spectra_realgan': {'cosine': [0.99921256,
                                0.99917656,
                                0.9991682,
                                0.99960124,
                                0.99972034,
                                0.9995683,
                                0.9995564,
                                0.9992268,
                                0.9983754,
                                0.9985747,
                                0.9981257],
                     'mae': [0.016234985,
                             0.01615478,
                             0.016565192,
                             0.0140998745,
                             0.013370418,
                             0.013901806,
                             0.01364695,
                             0.014649391,
                             0.01715313,
                             0.017004097,
                             0.017249139],
                     'max_mae': 0.017249139,
                     'max_mse': 0.00051668304,
                     'max_rmse': 0.022730663,
                     'median_mae': 0.01615478,
                     'min_cosine': 0.9981257,
                     'mse': [0.0004304309,
                             0.0004692437,
                             0.0004454075,
                             0.00031672863,
                             0.00032556313,
                             0.00031649842,
                             0.00030634998,
                             0.00035820052,
                             0.00051668304,
                             0.0004774827,
                             0.00050972827],
                     'rmse': [0.020746829,
                              0.021662034,
                              0.02110468,
                              0.017796872,
                              0.018043367,
                              0.017790403,
                              0.017502856,
                              0.018926186,
                              0.022730663,
                              0.021851378,
                              0.022577163]},
 'spectra_realpca': {'cosine': [0.9999994,
                                0.99999946,
                                0.9999995,
                                0.9999999,
                                0.9999999,
                                0.9999999,
                                0.99999976,
                                0.99999917,
                                0.99999374,
                                0.99999624,
                                0.99999535],
                     'mae': [0.00039922787,
                             0.0003964026,
                             0.00039495542,
                             0.0002305362,
                             0.0001489674,
                             0.00020698586,
                             0.00028053427,
                             0.0005108387,
                             0.0010984236,
                             0.0008566162,
                             0.0008745598],
                     'max_mae': 0.0010984236,
                     'max_mse': 1.9410797e-06,
                     'max_rmse': 0.0013932263,
                     'median_mae': 0.0003964026,
                     'min_cosine': 0.99999374,
                     'mse': [2.553581e-07,
                             2.501082e-07,
                             2.5079873e-07,
                             8.5128235e-08,
                             3.547354e-08,
                             6.957105e-08,
                             1.2579159e-07,
                             4.243286e-07,
                             1.9410797e-06,
                             1.1702191e-06,
                             1.2191953e-06],
                     'rmse': [0.0005053297,
                              0.0005001082,
                              0.0005007981,
                              0.00029176744,
                              0.0001883442,
                              0.00026376324,
                              0.0003546711,
                              0.0006514051,
                              0.0013932263,
                              0.0010817667,
                              0.0011041717]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_80.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743
Directory path: experiments/inpainting/gann_4_night_20180904_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_80.0/images
Optimal number of principal components:  39
Reconstruction error:  4.737751
Energy conservation:  0.80625314
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_80.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9538435048012626, 1.350387970001902],
                   'kl_div': 1.9747705,
                   'ks_tests': {10000: KstestResult(statistic=0.4074, pvalue=0.0, statistic_location=0.0014905438, statistic_sign=1),
                                20000: KstestResult(statistic=0.40815, pvalue=0.0, statistic_location=0.0014681229, statistic_sign=1),
                                30000: KstestResult(statistic=0.4044333333333334, pvalue=0.0, statistic_location=0.0017518923, statistic_sign=1),
                                40000: KstestResult(statistic=0.401675, pvalue=0.0, statistic_location=0.0015138863, statistic_sign=1),
                                50000: KstestResult(statistic=0.40648000000000006, pvalue=0.0, statistic_location=0.0014802413, statistic_sign=1),
                                60000: KstestResult(statistic=0.4017833333333334, pvalue=0.0, statistic_location=0.0014851864, statistic_sign=1),
                                70000: KstestResult(statistic=0.40769999999999995, pvalue=0.0, statistic_location=0.0015006522, statistic_sign=1),
                                80000: KstestResult(statistic=0.4062125, pvalue=0.0, statistic_location=0.0015855115, statistic_sign=1),
                                90000: KstestResult(statistic=0.40246666666666664, pvalue=0.0, statistic_location=0.0014548695, statistic_sign=1),
                                100000: KstestResult(statistic=0.40868000000000004, pvalue=0.0, statistic_location=0.0015079277, statistic_sign=1),
                                110000: KstestResult(statistic=0.40583636363636366, pvalue=0.0, statistic_location=0.0014863366, statistic_sign=1),
                                120000: KstestResult(statistic=0.4053583333333334, pvalue=0.0, statistic_location=0.0015560435, statistic_sign=1),
                                130000: KstestResult(statistic=0.40313846153846156, pvalue=0.0, statistic_location=0.0014868313, statistic_sign=1),
                                140000: KstestResult(statistic=0.4062928571428571, pvalue=0.0, statistic_location=0.0014510266, statistic_sign=1),
                                150000: KstestResult(statistic=0.4027733333333333, pvalue=0.0, statistic_location=0.0015720951, statistic_sign=1),
                                160000: KstestResult(statistic=0.40778125, pvalue=0.0, statistic_location=0.001572177, statistic_sign=1),
                                170000: KstestResult(statistic=0.4044764705882352, pvalue=0.0, statistic_location=0.0014552795, statistic_sign=1),
                                180000: KstestResult(statistic=0.40280000000000005, pvalue=0.0, statistic_location=0.0014601103, statistic_sign=1),
                                190000: KstestResult(statistic=0.40273157894736844, pvalue=0.0, statistic_location=0.001520311, statistic_sign=1),
                                200000: KstestResult(statistic=0.4076000000000001, pvalue=0.0, statistic_location=0.0015764055, statistic_sign=1),
                                210000: KstestResult(statistic=0.4063523809523809, pvalue=0.0, statistic_location=0.0014628419, statistic_sign=1),
                                220000: KstestResult(statistic=0.40801818181818184, pvalue=0.0, statistic_location=0.0014548926, statistic_sign=1)},
                   'moments': {'mean_error': 0.1617478,
                               'means': [-0.00020164356, -8.561924e-06],
                               'stds': [0.016210506, 0.0011861621],
                               'variance_ratio': 266.20865}},
 'originals': {'gan': {'mae': 0.022803761065006256,
                       'mse': 0.0012679608771577477,
                       'psnr': 29.031415939331055,
                       'rmse': 0.0356084369122982,
                       'ssim': 0.9156925082206726},
               'pca': {'mae': 0.0012561680050566792,
                       'mse': 6.80727134749759e-06,
                       'psnr': 52.096168518066406,
                       'rmse': 0.002609074814245105,
                       'ssim': 0.9998857975006104}},
 'reconstructions': {'mae': 0.02272173948585987,
                     'mse': 0.0012620935449376702,
                     'psnr': 29.41498565673828,
                     'rmse': 0.03552595525979996,
                     'ssim': 0.9156849384307861},
 'residual_spectra_pcagan': {'cosine': [0.043743756,
                                        0.056170452,
                                        0.013026388,
                                        0.018502893,
                                        -0.0013542018,
                                        0.009518516,
                                        0.02664464,
                                        0.03579808,
                                        0.015721073,
                                        0.016965253,
                                        -0.00395791,
                                        0.020715991,
                                        0.056369882,
                                        0.042351887,
                                        0.04505635,
                                        0.021263562,
                                        0.028752478,
                                        0.0997793,
                                        0.2165281,
                                        0.17833206,
                                        0.025200358,
                                        0.14696054],
                             'mae': [0.009651431,
                                     0.010203278,
                                     0.01131907,
                                     0.01175792,
                                     0.011311958,
                                     0.010616479,
                                     0.012188631,
                                     0.0108063845,
                                     0.011549565,
                                     0.012159866,
                                     0.0105644725,
                                     0.011264196,
                                     0.009843784,
                                     0.011228291,
                                     0.012031828,
                                     0.010761383,
                                     0.010343073,
                                     0.010860489,
                                     0.00912872,
                                     0.00923122,
                                     0.0110477405,
                                     0.009997255],
                             'max_mae': 0.012188631,
                             'max_mse': 0.00036508846,
                             'max_rmse': 0.019107288,
                             'median_distance': 1.5831013,
                             'median_mae': 0.010833437,
                             'min_cosine': -0.00395791,
                             'mse': [0.00019304696,
                                     0.0002462817,
                                     0.00033685297,
                                     0.00027193828,
                                     0.00029891334,
                                     0.00022135334,
                                     0.00035632544,
                                     0.00023317494,
                                     0.0002622172,
                                     0.0003456582,
                                     0.0002309432,
                                     0.0002519542,
                                     0.00019034377,
                                     0.00036508846,
                                     0.0002928646,
                                     0.00025574924,
                                     0.00022137947,
                                     0.00024929136,
                                     0.0001624253,
                                     0.00018108706,
                                     0.00034103572,
                                     0.000249064],
                             'rmse': [0.013894134,
                                      0.015693365,
                                      0.018353555,
                                      0.01649055,
                                      0.01728911,
                                      0.014877948,
                                      0.018876584,
                                      0.015270066,
                                      0.016193122,
                                      0.018591885,
                                      0.015196815,
                                      0.015873065,
                                      0.013796513,
                                      0.019107288,
                                      0.017113287,
                                      0.015992163,
                                      0.014878826,
                                      0.015788963,
                                      0.012744619,
                                      0.01345686,
                                      0.018467152,
                                      0.015781762]},
 'residuals': {'mae': 0.01081213727593422,
               'mse': 0.0002616813580971211,
               'psnr': 4.057457447052002,
               'rmse': 0.01617656834423542,
               'ssds': [57.820404, 0.30955046],
               'ssim': 0.335538774728775},
 'spectra_pcagan': {'cosine': [0.9987434,
                               0.99892753,
                               0.99886304,
                               0.9995551,
                               0.999018,
                               0.99927986,
                               0.9992363,
                               0.99929184,
                               0.9996025,
                               0.9997593,
                               0.99960387,
                               0.9995223,
                               0.99922305,
                               0.99806416,
                               0.99761915,
                               0.99797904,
                               0.9666772,
                               0.99500895,
                               0.98485595,
                               0.9883648,
                               0.9952674,
                               0.99026626],
                    'mae': [0.016733715,
                            0.017751737,
                            0.017113332,
                            0.013834086,
                            0.016751034,
                            0.015716895,
                            0.01565185,
                            0.015726442,
                            0.013697165,
                            0.011839796,
                            0.012670115,
                            0.013930087,
                            0.015911419,
                            0.018264398,
                            0.025280176,
                            0.01876731,
                            0.12165598,
                            0.022923898,
                            0.029286465,
                            0.022829615,
                            0.020438904,
                            0.023103777],
                    'max_mae': 0.12165598,
                    'max_mse': 0.015763054,
                    'max_rmse': 0.125551,
                    'median_mae': 0.016932182,
                    'min_cosine': 0.9666772,
                    'mse': [0.00045291716,
                            0.00051419705,
                            0.00051579607,
                            0.0003144062,
                            0.00046715335,
                            0.00039300194,
                            0.00042590915,
                            0.00039474497,
                            0.00030296308,
                            0.00023683229,
                            0.00027308788,
                            0.0003144697,
                            0.0004128612,
                            0.0006077561,
                            0.0010019775,
                            0.0005871322,
                            0.015763054,
                            0.00088592444,
                            0.0013082506,
                            0.00088820123,
                            0.00079286814,
                            0.00091255474],
                    'rmse': [0.02128185,
                             0.022675913,
                             0.022711145,
                             0.017731503,
                             0.02161373,
                             0.019824276,
                             0.020637566,
                             0.01986819,
                             0.017405834,
                             0.015389357,
                             0.016525371,
                             0.017733295,
                             0.020318987,
                             0.02465271,
                             0.031654026,
                             0.02423081,
                             0.125551,
                             0.029764483,
                             0.03616975,
                             0.029802704,
                             0.028157914,
                             0.03020852]},
 'spectra_realgan': {'cosine': [0.99874,
                                0.9989248,
                                0.9988631,
                                0.99955505,
                                0.99901766,
                                0.99927944,
                                0.9992359,
                                0.9992909,
                                0.9996024,
                                0.9997592,
                                0.9996036,
                                0.9995221,
                                0.999221,
                                0.9980581,
                                0.99761426,
                                0.9979761,
                                0.9666768,
                                0.99495614,
                                0.98430717,
                                0.98795205,
                                0.995255,
                                0.98986566],
                     'mae': [0.016758474,
                             0.017770926,
                             0.017112948,
                             0.01383604,
                             0.016758813,
                             0.015727537,
                             0.015651986,
                             0.01573378,
                             0.013699008,
                             0.011841962,
                             0.012672014,
                             0.013935976,
                             0.015934087,
                             0.018293058,
                             0.025285449,
                             0.018783813,
                             0.121650405,
                             0.023066582,
                             0.029758502,
                             0.023323128,
                             0.020487681,
                             0.02360058],
                     'max_mae': 0.121650405,
                     'max_mse': 0.01576323,
                     'max_rmse': 0.1255517,
                     'median_mae': 0.016935881,
                     'min_cosine': 0.9666768,
                     'mse': [0.0004542326,
                             0.00051537354,
                             0.0005156728,
                             0.00031452283,
                             0.00046753965,
                             0.00039332334,
                             0.0004261101,
                             0.00039524198,
                             0.0003030392,
                             0.00023687206,
                             0.00027312044,
                             0.0003145981,
                             0.0004139688,
                             0.00060950033,
                             0.0010027804,
                             0.0005876587,
                             0.01576323,
                             0.0008939966,
                             0.001350211,
                             0.00091973686,
                             0.00079524127,
                             0.00094916765],
                     'rmse': [0.021312732,
                              0.02270184,
                              0.022708429,
                              0.017734792,
                              0.021622665,
                              0.019832382,
                              0.020642435,
                              0.019880693,
                              0.01740802,
                              0.0153906485,
                              0.016526356,
                              0.017736914,
                              0.020346224,
                              0.024688061,
                              0.031666707,
                              0.024241673,
                              0.1255517,
                              0.029899776,
                              0.036745217,
                              0.030327164,
                              0.028200023,
                              0.030808564]},
 'spectra_realpca': {'cosine': [0.99999696,
                                0.99999887,
                                0.99999934,
                                0.9999999,
                                0.999999,
                                0.9999994,
                                0.99999946,
                                0.9999995,
                                0.9999999,
                                0.9999999,
                                0.9999999,
                                0.99999976,
                                0.99999917,
                                0.99999374,
                                0.99999624,
                                0.99999535,
                                0.99999523,
                                0.99995965,
                                0.99928796,
                                0.9994419,
                                0.9999851,
                                0.9996368],
                     'mae': [0.0007838863,
                             0.0005321874,
                             0.00045881138,
                             0.00024023511,
                             0.0005048291,
                             0.00039922787,
                             0.0003964026,
                             0.00039495542,
                             0.0002305362,
                             0.0001489674,
                             0.00020698586,
                             0.00028053427,
                             0.0005108387,
                             0.0010984236,
                             0.0008566162,
                             0.0008745598,
                             0.0008652647,
                             0.002022782,
                             0.0058862017,
                             0.0051250877,
                             0.001202193,
                             0.004616171],
                     'max_mae': 0.0058862017,
                     'max_mse': 5.532719e-05,
                     'max_rmse': 0.0074382247,
                     'median_mae': 0.00052151305,
                     'min_cosine': 0.99928796,
                     'mse': [9.93146e-07,
                             4.540789e-07,
                             3.3783894e-07,
                             9.3222496e-08,
                             4.109959e-07,
                             2.553581e-07,
                             2.501082e-07,
                             2.5079873e-07,
                             8.5128235e-08,
                             3.547354e-08,
                             6.957105e-08,
                             1.2579159e-07,
                             4.243286e-07,
                             1.9410797e-06,
                             1.1702191e-06,
                             1.2191953e-06,
                             1.1891408e-06,
                             6.5760614e-06,
                             5.532719e-05,
                             4.2047504e-05,
                             2.3142777e-06,
                             3.4189463e-05],
                     'rmse': [0.0009965671,
                              0.0006738538,
                              0.0005812391,
                              0.0003053236,
                              0.00064108963,
                              0.0005053297,
                              0.0005001082,
                              0.0005007981,
                              0.00029176744,
                              0.0001883442,
                              0.00026376324,
                              0.0003546711,
                              0.0006514051,
                              0.0013932263,
                              0.0010817667,
                              0.0011041717,
                              0.0010904773,
                              0.0025643832,
                              0.0074382247,
                              0.0064844047,
                              0.001521275,
                              0.0058471756]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_80.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658
Directory path: experiments/inpainting/gann_4_night_20180904_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_80.0/images
Optimal number of principal components:  39
Reconstruction error:  4.737751
Energy conservation:  0.80625314
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_80.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9187742426194503, 1.782115826152204],
                   'kl_div': 1.5167307,
                   'ks_tests': {10000: KstestResult(statistic=0.37, pvalue=0.0, statistic_location=0.0021522464, statistic_sign=1),
                                20000: KstestResult(statistic=0.359, pvalue=0.0, statistic_location=0.0023598876, statistic_sign=1),
                                30000: KstestResult(statistic=0.3632333333333333, pvalue=0.0, statistic_location=0.0022574398, statistic_sign=1),
                                40000: KstestResult(statistic=0.35995, pvalue=0.0, statistic_location=0.0023554752, statistic_sign=1),
                                50000: KstestResult(statistic=0.35952000000000006, pvalue=0.0, statistic_location=0.002351788, statistic_sign=1),
                                60000: KstestResult(statistic=0.36495, pvalue=0.0, statistic_location=0.0022400646, statistic_sign=1),
                                70000: KstestResult(statistic=0.3655285714285714, pvalue=0.0, statistic_location=0.0022265464, statistic_sign=1),
                                80000: KstestResult(statistic=0.3641375, pvalue=0.0, statistic_location=0.0020482717, statistic_sign=1),
                                90000: KstestResult(statistic=0.3613333333333333, pvalue=0.0, statistic_location=0.0021485896, statistic_sign=1),
                                100000: KstestResult(statistic=0.36153, pvalue=0.0, statistic_location=0.0022245902, statistic_sign=1),
                                110000: KstestResult(statistic=0.3621363636363637, pvalue=0.0, statistic_location=0.0022196192, statistic_sign=1),
                                120000: KstestResult(statistic=0.3599333333333333, pvalue=0.0, statistic_location=0.0021554208, statistic_sign=1),
                                130000: KstestResult(statistic=0.3620000000000001, pvalue=0.0, statistic_location=0.0021626055, statistic_sign=1),
                                140000: KstestResult(statistic=0.36345000000000005, pvalue=0.0, statistic_location=0.002161525, statistic_sign=1),
                                150000: KstestResult(statistic=0.36216666666666664, pvalue=0.0, statistic_location=0.00216487, statistic_sign=1),
                                160000: KstestResult(statistic=0.36197500000000005, pvalue=0.0, statistic_location=0.002239571, statistic_sign=1),
                                170000: KstestResult(statistic=0.36255294117647063, pvalue=0.0, statistic_location=0.00224305, statistic_sign=1),
                                180000: KstestResult(statistic=0.3600888888888889, pvalue=0.0, statistic_location=0.0022252882, statistic_sign=1),
                                190000: KstestResult(statistic=0.361021052631579, pvalue=0.0, statistic_location=0.0022231117, statistic_sign=1),
                                200000: KstestResult(statistic=0.36112500000000003, pvalue=0.0, statistic_location=0.00223968, statistic_sign=1),
                                210000: KstestResult(statistic=0.3608380952380953, pvalue=0.0, statistic_location=0.002042827, statistic_sign=1),
                                220000: KstestResult(statistic=0.3634909090909091, pvalue=0.0, statistic_location=0.0021561394, statistic_sign=1),
                                230000: KstestResult(statistic=0.3620478260869565, pvalue=0.0, statistic_location=0.0022136231, statistic_sign=1),
                                240000: KstestResult(statistic=0.363275, pvalue=0.0, statistic_location=0.0021010516, statistic_sign=1),
                                250000: KstestResult(statistic=0.36195599999999994, pvalue=0.0, statistic_location=0.0021561394, statistic_sign=1),
                                260000: KstestResult(statistic=0.36239999999999994, pvalue=0.0, statistic_location=0.0022252835, statistic_sign=1),
                                270000: KstestResult(statistic=0.36296296296296304, pvalue=0.0, statistic_location=0.002245138, statistic_sign=1),
                                280000: KstestResult(statistic=0.3608178571428572, pvalue=0.0, statistic_location=0.0022268787, statistic_sign=1),
                                290000: KstestResult(statistic=0.36098275862068974, pvalue=0.0, statistic_location=0.0021561256, statistic_sign=1),
                                300000: KstestResult(statistic=0.36288333333333334, pvalue=0.0, statistic_location=0.0022252891, statistic_sign=1),
                                310000: KstestResult(statistic=0.3605967741935484, pvalue=0.0, statistic_location=0.002160137, statistic_sign=1),
                                320000: KstestResult(statistic=0.36297500000000005, pvalue=0.0, statistic_location=0.0021467432, statistic_sign=1),
                                330000: KstestResult(statistic=0.3618030303030303, pvalue=0.0, statistic_location=0.0021507875, statistic_sign=1)},
                   'moments': {'mean_error': 0.35936132,
                               'means': [0.00036934364, -3.3954743e-06],
                               'stds': [0.015899327, 0.0019625952],
                               'variance_ratio': 76.54065}},
 'originals': {'gan': {'mae': 0.024683792144060135,
                       'mse': 0.0012824512086808681,
                       'psnr': 30.239980697631836,
                       'rmse': 0.035811327397823334,
                       'ssim': 0.9119865298271179},
               'pca': {'mae': 0.002409190870821476,
                       'mse': 2.17880242416868e-05,
                       'psnr': 48.36676025390625,
                       'rmse': 0.004667764529585838,
                       'ssim': 0.9994431138038635}},
 'reconstructions': {'mae': 0.024460425600409508,
                     'mse': 0.0012604903895407915,
                     'psnr': 30.743545532226562,
                     'rmse': 0.035503387451171875,
                     'ssim': 0.9120226502418518},
 'residual_spectra_pcagan': {'cosine': [0.1885859,
                                        0.36727616,
                                        0.18262382,
                                        0.03262658,
                                        0.032473527,
                                        0.021660894,
                                        0.054285415,
                                        0.058159567,
                                        0.017771835,
                                        -0.001205728,
                                        0.018976603,
                                        -0.0017659796,
                                        0.03532332,
                                        0.03288797,
                                        0.018485349,
                                        0.009751698,
                                        -0.014735452,
                                        0.02172428,
                                        0.046141334,
                                        0.047212556,
                                        0.042165328,
                                        0.01537353,
                                        0.033681832,
                                        0.10975538,
                                        0.22684126,
                                        0.18225886,
                                        0.024857203,
                                        0.19761188,
                                        0.17238615,
                                        0.2498507,
                                        0.15836506,
                                        0.12057307,
                                        0.23345932],
                             'mae': [0.009690596,
                                     0.008291587,
                                     0.009310371,
                                     0.009805395,
                                     0.009381706,
                                     0.011161371,
                                     0.010575681,
                                     0.011441907,
                                     0.012345536,
                                     0.01260908,
                                     0.011019176,
                                     0.011004771,
                                     0.011497916,
                                     0.01023178,
                                     0.011370327,
                                     0.0114749875,
                                     0.011448466,
                                     0.010749531,
                                     0.009351738,
                                     0.009778231,
                                     0.008854429,
                                     0.012395006,
                                     0.00995643,
                                     0.010246469,
                                     0.009290406,
                                     0.009513415,
                                     0.011045443,
                                     0.008990082,
                                     0.010139421,
                                     0.010363625,
                                     0.010090354,
                                     0.010639412,
                                     0.0089590335],
                             'max_mae': 0.01260908,
                             'max_mse': 0.00047226463,
                             'max_rmse': 0.02173165,
                             'median_distance': 1.5274471,
                             'median_mae': 0.010246469,
                             'min_cosine': -0.014735452,
                             'mse': [0.00023324676,
                                     0.00015409694,
                                     0.00020853683,
                                     0.00019925348,
                                     0.00016971573,
                                     0.00030930256,
                                     0.0002173831,
                                     0.0002967516,
                                     0.00047226463,
                                     0.00034915828,
                                     0.00028535366,
                                     0.00025800723,
                                     0.00029881467,
                                     0.00020253849,
                                     0.00026338993,
                                     0.0002761762,
                                     0.00029077288,
                                     0.0002333095,
                                     0.00016672576,
                                     0.00018592393,
                                     0.00014622629,
                                     0.00037955,
                                     0.00019972688,
                                     0.00023694115,
                                     0.00017897427,
                                     0.00019743916,
                                     0.00034302814,
                                     0.00017184095,
                                     0.0002470611,
                                     0.00039164853,
                                     0.00026102108,
                                     0.00023308945,
                                     0.0001663172],
                             'rmse': [0.015272418,
                                      0.012413579,
                                      0.014440805,
                                      0.014115717,
                                      0.0130274985,
                                      0.017587,
                                      0.014743918,
                                      0.01722648,
                                      0.02173165,
                                      0.018685777,
                                      0.016892415,
                                      0.016062604,
                                      0.017286256,
                                      0.014231602,
                                      0.016229292,
                                      0.01661855,
                                      0.017052064,
                                      0.015274473,
                                      0.012912233,
                                      0.013635392,
                                      0.012092406,
                                      0.019482043,
                                      0.014132476,
                                      0.015392893,
                                      0.013378127,
                                      0.014051305,
                                      0.018521018,
                                      0.013108812,
                                      0.015718177,
                                      0.019790111,
                                      0.016156146,
                                      0.015267267,
                                      0.012896403]},
 'residuals': {'mae': 0.010394656099379063,
               'mse': 0.00024919959832914174,
               'psnr': 8.83559513092041,
               'rmse': 0.015786057338118553,
               'ssds': [83.46498, 1.2710873],
               'ssim': 0.3704821467399597},
 'spectra_pcagan': {'cosine': [0.9822895,
                               0.9863043,
                               0.9819055,
                               0.9986967,
                               0.99876636,
                               0.99869686,
                               0.9982818,
                               0.99867684,
                               0.99838316,
                               0.9994712,
                               0.9990591,
                               0.99915814,
                               0.99931777,
                               0.99925834,
                               0.9995948,
                               0.9997633,
                               0.9995595,
                               0.9995772,
                               0.9992233,
                               0.9984834,
                               0.9986783,
                               0.9977311,
                               0.96700805,
                               0.99554145,
                               0.9846456,
                               0.9811303,
                               0.9940821,
                               0.989466,
                               0.97545695,
                               0.9792336,
                               0.9871414,
                               0.98401386,
                               0.98272437],
                    'mae': [0.028902953,
                            0.025201943,
                            0.027302645,
                            0.016709521,
                            0.017352853,
                            0.017952628,
                            0.023173554,
                            0.017619079,
                            0.020332605,
                            0.014710201,
                            0.016860925,
                            0.016440246,
                            0.015138469,
                            0.015419209,
                            0.013865718,
                            0.01207495,
                            0.013569727,
                            0.013175684,
                            0.015752042,
                            0.01727332,
                            0.016103024,
                            0.021153135,
                            0.11901783,
                            0.020441016,
                            0.028531,
                            0.031161008,
                            0.02260887,
                            0.026817627,
                            0.04169135,
                            0.037735485,
                            0.024623895,
                            0.028876428,
                            0.02960511],
                    'max_mae': 0.11901783,
                    'max_mse': 0.015218897,
                    'max_rmse': 0.123364896,
                    'median_mae': 0.020332605,
                    'min_cosine': 0.96700805,
                    'mse': [0.0013607063,
                            0.0010485545,
                            0.0012435367,
                            0.00046925913,
                            0.00048226328,
                            0.0005577377,
                            0.0008022911,
                            0.00054151413,
                            0.00077008904,
                            0.00038405354,
                            0.00047552848,
                            0.00043835893,
                            0.00039205307,
                            0.00039723268,
                            0.0003087187,
                            0.00024365736,
                            0.00030763092,
                            0.00027789717,
                            0.00040823402,
                            0.00048660816,
                            0.00042135606,
                            0.00077044347,
                            0.015218897,
                            0.00072426884,
                            0.001227742,
                            0.0014351206,
                            0.00091373903,
                            0.0011042639,
                            0.0023994092,
                            0.0023474002,
                            0.0010361489,
                            0.0012703759,
                            0.0013310832],
                    'rmse': [0.036887754,
                             0.032381393,
                             0.035263814,
                             0.02166239,
                             0.021960493,
                             0.02361647,
                             0.028324744,
                             0.023270456,
                             0.027750479,
                             0.019597284,
                             0.021806614,
                             0.020937024,
                             0.01980033,
                             0.019930696,
                             0.017570393,
                             0.015609528,
                             0.01753941,
                             0.016670248,
                             0.020204801,
                             0.022059197,
                             0.020526959,
                             0.027756864,
                             0.123364896,
                             0.026912244,
                             0.03503915,
                             0.037882984,
                             0.030228116,
                             0.03323047,
                             0.048983764,
                             0.048449975,
                             0.032189265,
                             0.035642333,
                             0.036484014]},
 'spectra_realgan': {'cosine': [0.98141897,
                                0.9843984,
                                0.9813822,
                                0.9986946,
                                0.9987652,
                                0.9986954,
                                0.99827695,
                                0.9986744,
                                0.9983832,
                                0.999471,
                                0.9990576,
                                0.9991577,
                                0.99931717,
                                0.9992575,
                                0.9995947,
                                0.9997633,
                                0.9995595,
                                0.99957675,
                                0.9992219,
                                0.998478,
                                0.9986742,
                                0.9977266,
                                0.9670079,
                                0.9954852,
                                0.98399204,
                                0.9809032,
                                0.9940697,
                                0.98901117,
                                0.97492296,
                                0.9770428,
                                0.9866524,
                                0.98371595,
                                0.9820864],
                     'mae': [0.029628867,
                             0.027002612,
                             0.027750384,
                             0.016725158,
                             0.017361175,
                             0.017964158,
                             0.023198808,
                             0.017639028,
                             0.02032974,
                             0.014716084,
                             0.016876092,
                             0.01644946,
                             0.015146863,
                             0.01542977,
                             0.013868148,
                             0.012076279,
                             0.0135710575,
                             0.013182241,
                             0.015767101,
                             0.0173033,
                             0.016132703,
                             0.021172605,
                             0.119015805,
                             0.020584635,
                             0.029043728,
                             0.03127549,
                             0.022661917,
                             0.02738564,
                             0.041743986,
                             0.03928578,
                             0.02512833,
                             0.029081695,
                             0.030066486],
                     'max_mae': 0.119015805,
                     'max_mse': 0.015219015,
                     'max_rmse': 0.12336537,
                     'median_mae': 0.02032974,
                     'min_cosine': 0.9670079,
                     'mse': [0.0014244716,
                             0.0011917106,
                             0.0012814642,
                             0.0004700204,
                             0.00048253156,
                             0.0005583655,
                             0.00080455246,
                             0.00054253795,
                             0.0007698164,
                             0.00038418898,
                             0.0004764451,
                             0.00043858882,
                             0.0003924381,
                             0.00039766746,
                             0.00030882916,
                             0.00024364404,
                             0.0003075897,
                             0.00027813605,
                             0.00040912838,
                             0.0004880907,
                             0.00042270575,
                             0.0007710065,
                             0.015219015,
                             0.00073376443,
                             0.0012791941,
                             0.0014533076,
                             0.0009157522,
                             0.0011495962,
                             0.002437745,
                             0.0025423148,
                             0.0010733202,
                             0.0012943601,
                             0.0013785933],
                     'rmse': [0.03774217,
                              0.034521163,
                              0.035797544,
                              0.021679955,
                              0.0219666,
                              0.023629759,
                              0.028364634,
                              0.023292445,
                              0.027745565,
                              0.01960074,
                              0.021827623,
                              0.020942513,
                              0.01981005,
                              0.019941602,
                              0.017573535,
                              0.015609101,
                              0.017538236,
                              0.016677411,
                              0.020226922,
                              0.022092775,
                              0.020559808,
                              0.027767004,
                              0.12336537,
                              0.027088087,
                              0.035765823,
                              0.03812227,
                              0.030261397,
                              0.033905696,
                              0.049373526,
                              0.050421372,
                              0.032761566,
                              0.03597722,
                              0.037129413]},
 'spectra_realpca': {'cosine': [0.99925286,
                                0.99819714,
                                0.99939626,
                                0.9999985,
                                0.9999981,
                                0.9999987,
                                0.99999696,
                                0.99999887,
                                0.99999934,
                                0.9999999,
                                0.999999,
                                0.9999994,
                                0.99999946,
                                0.9999995,
                                0.9999999,
                                0.9999999,
                                0.9999999,
                                0.99999976,
                                0.99999917,
                                0.99999374,
                                0.99999624,
                                0.99999535,
                                0.99999523,
                                0.99995965,
                                0.99928796,
                                0.9994419,
                                0.9999851,
                                0.9996368,
                                0.99935484,
                                0.9978431,
                                0.99956113,
                                0.99973303,
                                0.9993306],
                     'mae': [0.0057735224,
                             0.009098575,
                             0.0051162625,
                             0.0005504723,
                             0.00064742984,
                             0.0005864953,
                             0.0007838863,
                             0.0005321874,
                             0.00045881138,
                             0.00024023511,
                             0.0005048291,
                             0.00039922787,
                             0.0003964026,
                             0.00039495542,
                             0.0002305362,
                             0.0001489674,
                             0.00020698586,
                             0.00028053427,
                             0.0005108387,
                             0.0010984236,
                             0.0008566162,
                             0.0008745598,
                             0.0008652647,
                             0.002022782,
                             0.0058862017,
                             0.0051250877,
                             0.001202193,
                             0.004616171,
                             0.005510279,
                             0.010758376,
                             0.004622725,
                             0.0036435986,
                             0.0055598537],
                     'max_mae': 0.010758376,
                     'max_mse': 0.00018536963,
                     'max_rmse': 0.013615051,
                     'median_mae': 0.0008566162,
                     'min_cosine': 0.9978431,
                     'mse': [5.340662e-05,
                             0.00013316807,
                             4.1932966e-05,
                             4.864511e-07,
                             6.776766e-07,
                             5.4560564e-07,
                             9.93146e-07,
                             4.540789e-07,
                             3.3783894e-07,
                             9.3222496e-08,
                             4.109959e-07,
                             2.553581e-07,
                             2.501082e-07,
                             2.5079873e-07,
                             8.5128235e-08,
                             3.547354e-08,
                             6.957105e-08,
                             1.2579159e-07,
                             4.243286e-07,
                             1.9410797e-06,
                             1.1702191e-06,
                             1.2191953e-06,
                             1.1891408e-06,
                             6.5760614e-06,
                             5.532719e-05,
                             4.2047504e-05,
                             2.3142777e-06,
                             3.4189463e-05,
                             4.8732367e-05,
                             0.00018536963,
                             3.427151e-05,
                             2.1360975e-05,
                             4.9292983e-05],
                     'rmse': [0.0073079835,
                              0.011539847,
                              0.006475567,
                              0.00069746043,
                              0.00082321116,
                              0.00073865126,
                              0.0009965671,
                              0.0006738538,
                              0.0005812391,
                              0.0003053236,
                              0.00064108963,
                              0.0005053297,
                              0.0005001082,
                              0.0005007981,
                              0.00029176744,
                              0.0001883442,
                              0.00026376324,
                              0.0003546711,
                              0.0006514051,
                              0.0013932263,
                              0.0010817667,
                              0.0011041717,
                              0.0010904773,
                              0.0025643832,
                              0.0074382247,
                              0.0064844047,
                              0.001521275,
                              0.0058471756,
                              0.0069808573,
                              0.013615051,
                              0.0058541875,
                              0.0046217935,
                              0.0070208963]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_80.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734
Directory path: experiments/inpainting/gann_4_night_20210905_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_80.0/images
Optimal number of principal components:  41
Reconstruction error:  3.4037192
Energy conservation:  0.80618006
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_80.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.8998554886731998, 2.0802895789439604],
                   'kl_div': 1.2108679,
                   'ks_tests': {10000: KstestResult(statistic=0.3291, pvalue=1e-323, statistic_location=-0.0028614253, statistic_sign=-1),
                                20000: KstestResult(statistic=0.33345, pvalue=0.0, statistic_location=-0.0028324868, statistic_sign=-1),
                                30000: KstestResult(statistic=0.3394, pvalue=0.0, statistic_location=-0.0028580388, statistic_sign=-1),
                                40000: KstestResult(statistic=0.337275, pvalue=0.0, statistic_location=-0.0028845686, statistic_sign=-1),
                                50000: KstestResult(statistic=0.3377, pvalue=0.0, statistic_location=-0.0026979744, statistic_sign=-1),
                                60000: KstestResult(statistic=0.3361166666666667, pvalue=0.0, statistic_location=-0.002866161, statistic_sign=-1),
                                70000: KstestResult(statistic=0.33327142857142855, pvalue=0.0, statistic_location=-0.0027928557, statistic_sign=-1),
                                80000: KstestResult(statistic=0.3362375, pvalue=0.0, statistic_location=-0.0028030337, statistic_sign=-1),
                                90000: KstestResult(statistic=0.33440000000000003, pvalue=0.0, statistic_location=-0.0027724751, statistic_sign=-1),
                                100000: KstestResult(statistic=0.33253, pvalue=0.0, statistic_location=-0.0031356197, statistic_sign=-1),
                                110000: KstestResult(statistic=0.3331818181818182, pvalue=0.0, statistic_location=-0.0027868124, statistic_sign=-1)},
                   'moments': {'mean_error': -0.53847,
                               'means': [-0.0013864677, 1.9626805e-05],
                               'stds': [0.016771028, 0.002373867],
                               'variance_ratio': 44.79564}},
 'originals': {'gan': {'mae': 0.023048721253871918,
                       'mse': 0.0009046081686392426,
                       'psnr': 30.321165084838867,
                       'rmse': 0.030076704919338226,
                       'ssim': 0.9525943994522095},
               'pca': {'mae': 0.0034420329611748457,
                       'mse': 3.2368392567150295e-05,
                       'psnr': 45.27127456665039,
                       'rmse': 0.005689322482794523,
                       'ssim': 0.9986420273780823}},
 'reconstructions': {'mae': 0.02256075106561184,
                     'mse': 0.0008695228025317192,
                     'psnr': 30.97967529296875,
                     'rmse': 0.029487671330571175,
                     'ssim': 0.9538206458091736},
 'residual_spectra_pcagan': {'cosine': [0.042460192,
                                        0.019429738,
                                        0.03200466,
                                        0.025473332,
                                        0.053579863,
                                        0.04287117,
                                        0.16526954,
                                        0.2940263,
                                        0.211278,
                                        0.20921706,
                                        0.1533287],
                             'mae': [0.010590741,
                                     0.011935024,
                                     0.010156562,
                                     0.011234174,
                                     0.011163245,
                                     0.0101179825,
                                     0.010300079,
                                     0.00851953,
                                     0.009582493,
                                     0.010588619,
                                     0.010812965],
                             'max_mae': 0.011935024,
                             'max_mse': 0.0004063335,
                             'max_rmse': 0.020157715,
                             'median_distance': 1.664728,
                             'median_mae': 0.010588619,
                             'min_cosine': 0.019429738,
                             'mse': [0.00023369653,
                                     0.00037928962,
                                     0.00023637664,
                                     0.00028092158,
                                     0.0004063335,
                                     0.00027713194,
                                     0.00024111185,
                                     0.00015983074,
                                     0.00029724868,
                                     0.0002517991,
                                     0.00029495382],
                             'rmse': [0.015287136,
                                      0.01947536,
                                      0.015374545,
                                      0.016760716,
                                      0.020157715,
                                      0.016647281,
                                      0.015527776,
                                      0.012642418,
                                      0.0172409,
                                      0.01586818,
                                      0.01717422]},
 'residuals': {'mae': 0.010454674251377583,
               'mse': 0.00027806308935396373,
               'psnr': 7.241410732269287,
               'rmse': 0.016675224527716637,
               'ssds': [31.150585, 0.61991364],
               'ssim': 0.3211929500102997},
 'spectra_pcagan': {'cosine': [0.99846035,
                               0.99865735,
                               0.9980776,
                               0.9953996,
                               0.9942952,
                               0.9958554,
                               0.9840817,
                               0.9854191,
                               0.9868678,
                               0.9877715,
                               0.98892677],
                    'mae': [0.017749049,
                            0.017566055,
                            0.017658701,
                            0.024922084,
                            0.023571195,
                            0.020154428,
                            0.027099887,
                            0.025956534,
                            0.023608824,
                            0.02401236,
                            0.025869159],
                    'max_mae': 0.027099887,
                    'max_mse': 0.0011987656,
                    'max_rmse': 0.034623194,
                    'median_mae': 0.023608824,
                    'min_cosine': 0.9840817,
                    'mse': [0.0005258894,
                            0.00053863926,
                            0.0005176434,
                            0.0010070202,
                            0.0009197811,
                            0.00072348345,
                            0.0011987656,
                            0.0010595118,
                            0.0009768318,
                            0.0009868385,
                            0.001110346],
                    'rmse': [0.022932278,
                             0.023208603,
                             0.022751778,
                             0.031733584,
                             0.030327894,
                             0.026897648,
                             0.034623194,
                             0.03255014,
                             0.031254306,
                             0.031413987,
                             0.033321854]},
 'spectra_realgan': {'cosine': [0.99845815,
                                0.99865544,
                                0.9980743,
                                0.99538624,
                                0.9942768,
                                0.9958385,
                                0.9834681,
                                0.9838169,
                                0.9854402,
                                0.98703146,
                                0.9884645],
                     'mae': [0.017761227,
                             0.017582031,
                             0.0176733,
                             0.024944736,
                             0.023610482,
                             0.020209933,
                             0.027730133,
                             0.027510053,
                             0.02518444,
                             0.024926346,
                             0.02640324],
                     'max_mae': 0.027730133,
                     'max_mse': 0.0012458147,
                     'max_rmse': 0.0352961,
                     'median_mae': 0.024926346,
                     'min_cosine': 0.9834681,
                     'mse': [0.00052664767,
                             0.000539212,
                             0.00051849784,
                             0.001009169,
                             0.0009227619,
                             0.00072644174,
                             0.0012458147,
                             0.0011789299,
                             0.0010824356,
                             0.0010481058,
                             0.0011526741],
                     'rmse': [0.022948805,
                              0.02322094,
                              0.022770548,
                              0.03176742,
                              0.030376997,
                              0.026952583,
                              0.0352961,
                              0.03433555,
                              0.03290039,
                              0.03237446,
                              0.033951055]},
 'spectra_realpca': {'cosine': [0.9999982,
                                0.99999905,
                                0.99999607,
                                0.9999819,
                                0.99998695,
                                0.99998355,
                                0.99941695,
                                0.9985467,
                                0.9986237,
                                0.9992905,
                                0.99959],
                     'mae': [0.0005973827,
                             0.0004943899,
                             0.0008029025,
                             0.0014032813,
                             0.0011462688,
                             0.001303968,
                             0.005253833,
                             0.008123226,
                             0.007927386,
                             0.005978541,
                             0.0048311837],
                     'max_mae': 0.008123226,
                     'max_mse': 0.00010664239,
                     'max_rmse': 0.01032678,
                     'median_mae': 0.0014032813,
                     'min_cosine': 0.9985467,
                     'mse': [5.7258626e-07,
                             3.9415696e-07,
                             1.0319284e-06,
                             3.1501695e-06,
                             2.0947402e-06,
                             2.705557e-06,
                             4.4238168e-05,
                             0.00010664239,
                             0.00010147713,
                             5.673368e-05,
                             3.701178e-05],
                     'rmse': [0.0007566943,
                              0.0006278192,
                              0.0010158387,
                              0.0017748717,
                              0.0014473217,
                              0.0016448578,
                              0.006651178,
                              0.01032678,
                              0.010073586,
                              0.007532176,
                              0.006083731]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_80.0

Running comparison for experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726
Directory path: experiments/inpainting/gann_4_night_20210905_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_80.0/images
Optimal number of principal components:  41
Reconstruction error:  3.4037192
Energy conservation:  0.80618006
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_80.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9022391383209563, 2.27217119739964],
                   'kl_div': 1.0188979,
                   'ks_tests': {10000: KstestResult(statistic=0.3264, pvalue=1e-323, statistic_location=-0.0029690806, statistic_sign=-1),
                                20000: KstestResult(statistic=0.31935, pvalue=0.0, statistic_location=-0.0035185646, statistic_sign=-1),
                                30000: KstestResult(statistic=0.3156, pvalue=0.0, statistic_location=-0.003394641, statistic_sign=-1),
                                40000: KstestResult(statistic=0.3175, pvalue=0.0, statistic_location=-0.0034094993, statistic_sign=-1),
                                50000: KstestResult(statistic=0.32312, pvalue=0.0, statistic_location=-0.0033155512, statistic_sign=-1),
                                60000: KstestResult(statistic=0.316, pvalue=0.0, statistic_location=-0.0033140834, statistic_sign=-1),
                                70000: KstestResult(statistic=0.31994285714285714, pvalue=0.0, statistic_location=-0.003330417, statistic_sign=-1),
                                80000: KstestResult(statistic=0.3185375, pvalue=0.0, statistic_location=-0.0033687886, statistic_sign=-1),
                                90000: KstestResult(statistic=0.3163777777777778, pvalue=0.0, statistic_location=-0.003263507, statistic_sign=-1),
                                100000: KstestResult(statistic=0.31414000000000003, pvalue=0.0, statistic_location=-0.0033338317, statistic_sign=-1),
                                110000: KstestResult(statistic=0.31615454545454547, pvalue=0.0, statistic_location=-0.0033112313, statistic_sign=-1),
                                120000: KstestResult(statistic=0.317175, pvalue=0.0, statistic_location=-0.0035450645, statistic_sign=-1),
                                130000: KstestResult(statistic=0.31551538461538464, pvalue=0.0, statistic_location=-0.0029630493, statistic_sign=-1),
                                140000: KstestResult(statistic=0.3156785714285714, pvalue=0.0, statistic_location=-0.0033976457, statistic_sign=-1),
                                150000: KstestResult(statistic=0.31825333333333333, pvalue=0.0, statistic_location=-0.00346783, statistic_sign=-1),
                                160000: KstestResult(statistic=0.31788125, pvalue=0.0, statistic_location=-0.0033687353, statistic_sign=-1),
                                170000: KstestResult(statistic=0.3170117647058824, pvalue=0.0, statistic_location=-0.0033685584, statistic_sign=-1),
                                180000: KstestResult(statistic=0.3174388888888889, pvalue=0.0, statistic_location=-0.0033419095, statistic_sign=-1),
                                190000: KstestResult(statistic=0.31973684210526315, pvalue=0.0, statistic_location=-0.0033264118, statistic_sign=-1),
                                200000: KstestResult(statistic=0.316445, pvalue=0.0, statistic_location=-0.0033687886, statistic_sign=-1),
                                210000: KstestResult(statistic=0.3156809523809524, pvalue=0.0, statistic_location=-0.00334193, statistic_sign=-1),
                                220000: KstestResult(statistic=0.3191909090909091, pvalue=0.0, statistic_location=-0.0033687805, statistic_sign=-1)},
                   'moments': {'mean_error': -0.42332518,
                               'means': [-0.0014589109, 1.0938976e-05],
                               'stds': [0.01597184, 0.0028343713],
                               'variance_ratio': 25.686373}},
 'originals': {'gan': {'mae': 0.029288172721862793,
                       'mse': 0.001597895403392613,
                       'psnr': 30.15612030029297,
                       'rmse': 0.03997368365526199,
                       'ssim': 0.8410302996635437},
               'pca': {'mae': 0.004556933417916298,
                       'mse': 5.559298733714968e-05,
                       'psnr': 44.79910659790039,
                       'rmse': 0.007456070277839899,
                       'ssim': 0.9954424500465393}},
 'reconstructions': {'mae': 0.028591463342308998,
                     'mse': 0.0015413699438795447,
                     'psnr': 30.3702392578125,
                     'rmse': 0.03926028311252594,
                     'ssim': 0.8426399230957031},
 'residual_spectra_pcagan': {'cosine': [0.07949512,
                                        0.08658715,
                                        0.002850492,
                                        0.020769788,
                                        0.022050876,
                                        0.038736682,
                                        0.0141331,
                                        0.039143804,
                                        0.03386798,
                                        0.06461339,
                                        0.044224642,
                                        0.18681861,
                                        0.32786968,
                                        0.22359513,
                                        0.21058674,
                                        0.15897743,
                                        0.27734643,
                                        0.25015575,
                                        0.309571,
                                        0.3190014,
                                        0.25014463,
                                        0.23494321],
                             'mae': [0.010191015,
                                     0.009957939,
                                     0.0117612425,
                                     0.012691271,
                                     0.011143767,
                                     0.009951671,
                                     0.011335057,
                                     0.009647391,
                                     0.010800989,
                                     0.011010649,
                                     0.009449646,
                                     0.009637935,
                                     0.007989182,
                                     0.00941897,
                                     0.010578834,
                                     0.010391452,
                                     0.008453165,
                                     0.010478594,
                                     0.008581022,
                                     0.008740903,
                                     0.010200387,
                                     0.010945964],
                             'max_mae': 0.012691271,
                             'max_mse': 0.00040904092,
                             'max_rmse': 0.02022476,
                             'median_distance': 1.5875802,
                             'median_mae': 0.0101957,
                             'min_cosine': 0.002850492,
                             'mse': [0.00021719052,
                                     0.0002598304,
                                     0.00040904092,
                                     0.00031535968,
                                     0.00029245115,
                                     0.00019925239,
                                     0.00032267452,
                                     0.00019555219,
                                     0.0002491865,
                                     0.0003489556,
                                     0.00021686012,
                                     0.00018431337,
                                     0.00012621055,
                                     0.0002675267,
                                     0.00025465988,
                                     0.00026108234,
                                     0.00021103029,
                                     0.00024943578,
                                     0.00015175418,
                                     0.0001773175,
                                     0.00030859752,
                                     0.00027391105],
                             'rmse': [0.014737385,
                                      0.016119257,
                                      0.02022476,
                                      0.01775837,
                                      0.017101204,
                                      0.014115679,
                                      0.017963143,
                                      0.0139839975,
                                      0.015785642,
                                      0.018680353,
                                      0.014726171,
                                      0.013576206,
                                      0.011234347,
                                      0.016356243,
                                      0.015958067,
                                      0.016158042,
                                      0.014526881,
                                      0.015793536,
                                      0.012318855,
                                      0.013316062,
                                      0.017566944,
                                      0.016550258]},
 'residuals': {'mae': 0.01015259325504303,
               'mse': 0.0002496451197657734,
               'psnr': 14.358092308044434,
               'rmse': 0.01580016128718853,
               'ssds': [56.58993, 1.7674234],
               'ssim': 0.3695613443851471},
 'spectra_pcagan': {'cosine': [0.9913249,
                               0.9903397,
                               0.9871942,
                               0.9979649,
                               0.99890137,
                               0.9984664,
                               0.9986058,
                               0.9980442,
                               0.99521893,
                               0.99367684,
                               0.9958256,
                               0.98391217,
                               0.98522365,
                               0.9861168,
                               0.98666126,
                               0.98784244,
                               0.9897919,
                               0.981813,
                               0.99049073,
                               0.9921423,
                               0.98757553,
                               0.98651266],
                    'mae': [0.03317319,
                            0.025736881,
                            0.10232334,
                            0.023063835,
                            0.018360985,
                            0.01764584,
                            0.017875107,
                            0.017932944,
                            0.025334634,
                            0.025259467,
                            0.021105058,
                            0.02737279,
                            0.02638192,
                            0.024691958,
                            0.025512218,
                            0.026434174,
                            0.024451932,
                            0.03181152,
                            0.028212573,
                            0.027073853,
                            0.028322943,
                            0.030935107],
                    'max_mae': 0.10232334,
                    'max_mse': 0.011330039,
                    'max_rmse': 0.10644266,
                    'median_mae': 0.02562455,
                    'min_cosine': 0.981813,
                    'mse': [0.00157519,
                            0.0011056147,
                            0.011330039,
                            0.00086099224,
                            0.00056714105,
                            0.0005191903,
                            0.0005562378,
                            0.00053184136,
                            0.0010296482,
                            0.001025547,
                            0.00077014655,
                            0.0012099455,
                            0.0010785495,
                            0.001055997,
                            0.0010926581,
                            0.0011510999,
                            0.001033367,
                            0.0016854355,
                            0.0013679529,
                            0.0013129812,
                            0.0014309061,
                            0.0016196569],
                    'rmse': [0.03968866,
                             0.033250786,
                             0.10644266,
                             0.02934267,
                             0.023814723,
                             0.022785747,
                             0.023584696,
                             0.023061685,
                             0.03208813,
                             0.032024164,
                             0.027751515,
                             0.034784272,
                             0.032841276,
                             0.032496106,
                             0.03305538,
                             0.03392786,
                             0.032146025,
                             0.041054055,
                             0.036985848,
                             0.036235083,
                             0.03782732,
                             0.040244963]},
 'spectra_realgan': {'cosine': [0.9912347,
                                0.99026316,
                                0.9871963,
                                0.99796176,
                                0.99890083,
                                0.99846447,
                                0.99860394,
                                0.99804103,
                                0.99520475,
                                0.9936569,
                                0.9958095,
                                0.98329765,
                                0.9835999,
                                0.984698,
                                0.9859396,
                                0.9873891,
                                0.98822236,
                                0.98030156,
                                0.98952353,
                                0.99124986,
                                0.9861594,
                                0.98525864],
                     'mae': [0.033294223,
                             0.025828766,
                             0.10232119,
                             0.023086667,
                             0.018353976,
                             0.017655889,
                             0.017890586,
                             0.017944146,
                             0.025359493,
                             0.025303021,
                             0.02115929,
                             0.028000534,
                             0.02790281,
                             0.026169525,
                             0.026349448,
                             0.026940206,
                             0.026175488,
                             0.033334527,
                             0.029743722,
                             0.0290685,
                             0.029867712,
                             0.032590088],
                     'max_mae': 0.10232119,
                     'max_mse': 0.011329362,
                     'max_rmse': 0.10643948,
                     'median_mae': 0.026262468,
                     'min_cosine': 0.98030156,
                     'mse': [0.0015887473,
                             0.0011122684,
                             0.011329362,
                             0.0008626093,
                             0.00056718534,
                             0.000519867,
                             0.0005567879,
                             0.0005326666,
                             0.0010319458,
                             0.0010287849,
                             0.0007730675,
                             0.0012570083,
                             0.0011995912,
                             0.0011607567,
                             0.0011529385,
                             0.0011925612,
                             0.0011627872,
                             0.0018270607,
                             0.0015063379,
                             0.001459091,
                             0.0015643693,
                             0.0017679054],
                     'rmse': [0.039859094,
                              0.033350687,
                              0.10643948,
                              0.029370211,
                              0.023815654,
                              0.022800593,
                              0.023596354,
                              0.023079572,
                              0.032123912,
                              0.03207468,
                              0.027804092,
                              0.035454314,
                              0.034635115,
                              0.03406988,
                              0.03395495,
                              0.03453348,
                              0.034099665,
                              0.04274413,
                              0.03881157,
                              0.03819805,
                              0.039552107,
                              0.04204647]},
 'spectra_realpca': {'cosine': [0.9999342,
                                0.99987614,
                                0.9999996,
                                0.9999987,
                                0.99999934,
                                0.9999982,
                                0.99999905,
                                0.99999607,
                                0.9999819,
                                0.99998695,
                                0.99998355,
                                0.99941695,
                                0.9985467,
                                0.9986237,
                                0.9992905,
                                0.99959,
                                0.9984303,
                                0.99861956,
                                0.9989226,
                                0.9990415,
                                0.9985181,
                                0.99870044],
                     'mae': [0.0022863888,
                             0.0028411278,
                             0.00031751645,
                             0.0005480782,
                             0.0004364704,
                             0.0005973827,
                             0.0004943899,
                             0.0008029025,
                             0.0014032813,
                             0.0011462688,
                             0.001303968,
                             0.005253833,
                             0.008123226,
                             0.007927386,
                             0.005978541,
                             0.0048311837,
                             0.008913523,
                             0.008705934,
                             0.009633596,
                             0.009927972,
                             0.009185416,
                             0.009594158],
                     'max_mae': 0.009927972,
                     'max_mse': 0.00015855453,
                     'max_rmse': 0.0125918435,
                     'median_mae': 0.0038361559,
                     'min_cosine': 0.9984303,
                     'mse': [8.388576e-06,
                             1.2939334e-05,
                             1.6117292e-07,
                             4.78455e-07,
                             3.0528597e-07,
                             5.7258626e-07,
                             3.9415696e-07,
                             1.0319284e-06,
                             3.1501695e-06,
                             2.0947402e-06,
                             2.705557e-06,
                             4.4238168e-05,
                             0.00010664239,
                             0.00010147713,
                             5.673368e-05,
                             3.701178e-05,
                             0.00012812791,
                             0.0001222514,
                             0.0001524457,
                             0.00015855453,
                             0.00013564138,
                             0.00014769961],
                     'rmse': [0.0028963038,
                              0.0035971284,
                              0.00040146348,
                              0.0006917044,
                              0.0005525269,
                              0.0007566943,
                              0.0006278192,
                              0.0010158387,
                              0.0017748717,
                              0.0014473217,
                              0.0016448578,
                              0.006651178,
                              0.01032678,
                              0.010073586,
                              0.007532176,
                              0.006083731,
                              0.01131936,
                              0.011056735,
                              0.012346891,
                              0.0125918435,
                              0.0116465185,
                              0.012153173]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_80.0

Running comparison for experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226
Directory path: experiments/inpainting/gann_4_night_20210905_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 80.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_80.0/images
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_80.0/images
Optimal number of principal components:  41
Reconstruction error:  3.4037192
Energy conservation:  0.80618006
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_80.0
saved spectra in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_80.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_80.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_80.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.867696224533345, 2.1969340462257074],
                   'kl_div': 1.0526935,
                   'ks_tests': {10000: KstestResult(statistic=0.3081, pvalue=1e-323, statistic_location=-0.0030446462, statistic_sign=-1),
                                20000: KstestResult(statistic=0.31065000000000004, pvalue=0.0, statistic_location=-0.0026263492, statistic_sign=-1),
                                30000: KstestResult(statistic=0.30496666666666666, pvalue=0.0, statistic_location=-0.0031607766, statistic_sign=-1),
                                40000: KstestResult(statistic=0.30479999999999996, pvalue=0.0, statistic_location=-0.002696786, statistic_sign=-1),
                                50000: KstestResult(statistic=0.30542, pvalue=0.0, statistic_location=-0.0029284097, statistic_sign=-1),
                                60000: KstestResult(statistic=0.30325, pvalue=0.0, statistic_location=-0.0028080568, statistic_sign=-1),
                                70000: KstestResult(statistic=0.3035714285714286, pvalue=0.0, statistic_location=-0.0025928766, statistic_sign=-1),
                                80000: KstestResult(statistic=0.3044875, pvalue=0.0, statistic_location=-0.0031816019, statistic_sign=-1),
                                90000: KstestResult(statistic=0.30623333333333336, pvalue=0.0, statistic_location=-0.0029822215, statistic_sign=-1),
                                100000: KstestResult(statistic=0.30596, pvalue=0.0, statistic_location=-0.0029413123, statistic_sign=-1),
                                110000: KstestResult(statistic=0.3055181818181818, pvalue=0.0, statistic_location=-0.0028461097, statistic_sign=-1),
                                120000: KstestResult(statistic=0.3076083333333334, pvalue=0.0, statistic_location=-0.0027868706, statistic_sign=-1),
                                130000: KstestResult(statistic=0.3071615384615385, pvalue=0.0, statistic_location=-0.0027953554, statistic_sign=-1),
                                140000: KstestResult(statistic=0.30659285714285717, pvalue=0.0, statistic_location=-0.003071107, statistic_sign=-1),
                                150000: KstestResult(statistic=0.30774, pvalue=0.0, statistic_location=-0.0027162991, statistic_sign=-1),
                                160000: KstestResult(statistic=0.30529375, pvalue=0.0, statistic_location=-0.0027978048, statistic_sign=-1),
                                170000: KstestResult(statistic=0.30555882352941177, pvalue=0.0, statistic_location=-0.0027414025, statistic_sign=-1),
                                180000: KstestResult(statistic=0.30461111111111105, pvalue=0.0, statistic_location=-0.0028459243, statistic_sign=-1),
                                190000: KstestResult(statistic=0.3054315789473684, pvalue=0.0, statistic_location=-0.0027577393, statistic_sign=-1),
                                200000: KstestResult(statistic=0.30249000000000004, pvalue=0.0, statistic_location=-0.0028380402, statistic_sign=-1),
                                210000: KstestResult(statistic=0.3050952380952381, pvalue=0.0, statistic_location=-0.0027866652, statistic_sign=-1),
                                220000: KstestResult(statistic=0.30505000000000004, pvalue=0.0, statistic_location=-0.0028383937, statistic_sign=-1),
                                230000: KstestResult(statistic=0.30444782608695653, pvalue=0.0, statistic_location=-0.0027966788, statistic_sign=-1),
                                240000: KstestResult(statistic=0.3054583333333334, pvalue=0.0, statistic_location=-0.002808731, statistic_sign=-1),
                                250000: KstestResult(statistic=0.306132, pvalue=0.0, statistic_location=-0.00279831, statistic_sign=-1),
                                260000: KstestResult(statistic=0.3068576923076923, pvalue=0.0, statistic_location=-0.0027970336, statistic_sign=-1),
                                270000: KstestResult(statistic=0.3054407407407408, pvalue=0.0, statistic_location=-0.002799783, statistic_sign=-1),
                                280000: KstestResult(statistic=0.3041714285714286, pvalue=0.0, statistic_location=-0.0027981913, statistic_sign=-1),
                                290000: KstestResult(statistic=0.304551724137931, pvalue=0.0, statistic_location=-0.0027895672, statistic_sign=-1),
                                300000: KstestResult(statistic=0.3048, pvalue=0.0, statistic_location=-0.0027970336, statistic_sign=-1),
                                310000: KstestResult(statistic=0.3043806451612903, pvalue=0.0, statistic_location=-0.002797422, statistic_sign=-1),
                                320000: KstestResult(statistic=0.30527187499999997, pvalue=0.0, statistic_location=-0.0028416454, statistic_sign=-1),
                                330000: KstestResult(statistic=0.3036181818181818, pvalue=0.0, statistic_location=-0.00279831, statistic_sign=-1)},
                   'moments': {'mean_error': -0.17170464,
                               'means': [-0.00065364566, -7.478581e-06],
                               'stds': [0.015172766, 0.0027350748],
                               'variance_ratio': 26.612637}},
 'originals': {'gan': {'mae': 0.04760230705142021,
                       'mse': 0.01523522287607193,
                       'psnr': 23.570749282836914,
                       'rmse': 0.12343104183673859,
                       'ssim': 0.8455835580825806},
               'pca': {'mae': 0.0042485869489610195,
                       'mse': 5.125457391841337e-05,
                       'psnr': 48.66019821166992,
                       'rmse': 0.007159229833632708,
                       'ssim': 0.9956223368644714}},
 'reconstructions': {'mae': 0.04704293608665466,
                     'mse': 0.015187600627541542,
                     'psnr': 23.9426326751709,
                     'rmse': 0.1232379823923111,
                     'ssim': 0.8485071063041687},
 'residual_spectra_pcagan': {'cosine': [0.067765325,
                                        0.013956331,
                                        0.07134873,
                                        0.027339311,
                                        0.046638485,
                                        0.017829642,
                                        0.0878359,
                                        0.09755281,
                                        0.0052817883,
                                        0.030118674,
                                        0.020846719,
                                        0.04110501,
                                        0.019925846,
                                        0.04558386,
                                        0.035954397,
                                        0.06713935,
                                        0.05393735,
                                        0.20333683,
                                        0.34801883,
                                        0.25006625,
                                        0.22875305,
                                        0.15958355,
                                        0.2975081,
                                        0.2733942,
                                        0.3350355,
                                        0.33369565,
                                        0.24967849,
                                        0.24185778,
                                        0.28010267,
                                        0.2210361,
                                        0.019708157,
                                        0.2843152,
                                        0.29532132],
                             'mae': [0.008925668,
                                     0.009122727,
                                     0.008254531,
                                     0.010237244,
                                     0.009074203,
                                     0.010238077,
                                     0.009037543,
                                     0.009318577,
                                     0.011257895,
                                     0.012266097,
                                     0.010846578,
                                     0.009639567,
                                     0.0107068615,
                                     0.00915023,
                                     0.010146217,
                                     0.010313926,
                                     0.00922432,
                                     0.00894715,
                                     0.0074339663,
                                     0.008729161,
                                     0.00988606,
                                     0.009920436,
                                     0.008084744,
                                     0.00972618,
                                     0.008127702,
                                     0.008249627,
                                     0.00993632,
                                     0.01034871,
                                     0.009167868,
                                     0.010688356,
                                     0.013195055,
                                     0.010655659,
                                     0.008071691],
                             'max_mae': 0.013195055,
                             'max_mse': 0.00046030764,
                             'max_rmse': 0.021454781,
                             'median_distance': 1.4555991,
                             'median_mae': 0.009639567,
                             'min_cosine': 0.0052817883,
                             'mse': [0.00018569865,
                                     0.00017917407,
                                     0.00013939965,
                                     0.00026668087,
                                     0.0001652361,
                                     0.00031244286,
                                     0.00017114732,
                                     0.0002210443,
                                     0.00034194955,
                                     0.00029108478,
                                     0.00027397886,
                                     0.00019292593,
                                     0.0002741506,
                                     0.00016982487,
                                     0.00021312053,
                                     0.00030682352,
                                     0.00020751175,
                                     0.00016044843,
                                     0.00011005342,
                                     0.00022051764,
                                     0.00020928218,
                                     0.00024311461,
                                     0.00017971412,
                                     0.00021187688,
                                     0.00013310398,
                                     0.00015218882,
                                     0.00029319598,
                                     0.0002492044,
                                     0.0002004316,
                                     0.00026454593,
                                     0.00046030764,
                                     0.00021934188,
                                     0.00015839732],
                             'rmse': [0.01362713,
                                      0.013385592,
                                      0.011806763,
                                      0.016330367,
                                      0.01285442,
                                      0.017676054,
                                      0.013082328,
                                      0.014867559,
                                      0.018491877,
                                      0.017061207,
                                      0.016552307,
                                      0.0138897775,
                                      0.016557494,
                                      0.013031687,
                                      0.014598648,
                                      0.017516378,
                                      0.014405268,
                                      0.012666824,
                                      0.0104906345,
                                      0.014849836,
                                      0.014466588,
                                      0.015592133,
                                      0.01340575,
                                      0.014555991,
                                      0.011537069,
                                      0.012336483,
                                      0.017122967,
                                      0.01578621,
                                      0.0141573865,
                                      0.016264869,
                                      0.021454781,
                                      0.014810195,
                                      0.0125856]},
 'residuals': {'mae': 0.009664514102041721,
               'mse': 0.00022357329726219177,
               'psnr': 14.83712387084961,
               'rmse': 0.014952367171645164,
               'ssds': [76.11101, 2.4686208],
               'ssim': 0.4734421372413635},
 'spectra_pcagan': {'cosine': [0.9955587,
                               0.9987668,
                               0.9988377,
                               0.9975667,
                               0.99838394,
                               0.997742,
                               0.99219537,
                               0.9902356,
                               0.98750526,
                               0.9980482,
                               0.99888474,
                               0.9984354,
                               0.9986671,
                               0.99810666,
                               0.99541163,
                               0.9941175,
                               0.99584854,
                               0.9844914,
                               0.9848331,
                               0.98695433,
                               0.98724,
                               0.9885982,
                               0.9895304,
                               0.9833716,
                               0.9907737,
                               0.9922302,
                               0.98723775,
                               0.9867608,
                               0.98781806,
                               0.9496757,
                               0.22046117,
                               0.9526369,
                               0.98796034],
                    'mae': [0.0199357,
                            0.0158842,
                            0.014364621,
                            0.023825882,
                            0.016469775,
                            0.020206304,
                            0.031268407,
                            0.025785662,
                            0.10156373,
                            0.022771155,
                            0.018389668,
                            0.017767185,
                            0.017514298,
                            0.017561547,
                            0.024594948,
                            0.024154756,
                            0.020765562,
                            0.026890447,
                            0.026370648,
                            0.023645187,
                            0.02464958,
                            0.026118238,
                            0.023857903,
                            0.030048585,
                            0.028052874,
                            0.026841382,
                            0.028067008,
                            0.0304885,
                            0.026588397,
                            0.052482355,
                            0.6607745,
                            0.061342377,
                            0.023375565],
                    'max_mae': 0.6607745,
                    'max_mse': 0.45397323,
                    'max_rmse': 0.6737754,
                    'median_mae': 0.024594948,
                    'min_cosine': 0.22046117,
                    'mse': [0.0006783536,
                            0.00041975637,
                            0.00035421643,
                            0.00083486317,
                            0.00044429788,
                            0.00071600906,
                            0.0013944613,
                            0.0011148967,
                            0.011160883,
                            0.0008351238,
                            0.0005705107,
                            0.0005306534,
                            0.0005340875,
                            0.0005104522,
                            0.0009824164,
                            0.00095306814,
                            0.00075112056,
                            0.0011698809,
                            0.0011019764,
                            0.00097068347,
                            0.0010253729,
                            0.0011210624,
                            0.0009960822,
                            0.0015328741,
                            0.0013359173,
                            0.0012893225,
                            0.0014095402,
                            0.0015677274,
                            0.001252781,
                            0.0036484336,
                            0.45397323,
                            0.005087955,
                            0.00092274876],
                    'rmse': [0.026045222,
                             0.020487957,
                             0.018820638,
                             0.028893998,
                             0.021078374,
                             0.026758345,
                             0.037342485,
                             0.033390068,
                             0.10564508,
                             0.02889851,
                             0.023885366,
                             0.023035916,
                             0.023110332,
                             0.022593189,
                             0.031343523,
                             0.030871801,
                             0.027406579,
                             0.034203522,
                             0.03319603,
                             0.031155793,
                             0.032021444,
                             0.033482272,
                             0.03156077,
                             0.039151937,
                             0.0365502,
                             0.03590714,
                             0.037543844,
                             0.03959454,
                             0.035394646,
                             0.060402267,
                             0.6737754,
                             0.0713299,
                             0.03037678]},
 'spectra_realgan': {'cosine': [0.9955164,
                                0.9987649,
                                0.99883413,
                                0.99756616,
                                0.9983779,
                                0.9977365,
                                0.9921055,
                                0.9901596,
                                0.98750746,
                                0.998045,
                                0.998884,
                                0.99843335,
                                0.99866533,
                                0.99810344,
                                0.9953992,
                                0.99409825,
                                0.99583006,
                                0.9838781,
                                0.9832142,
                                0.9855101,
                                0.9865281,
                                0.9881487,
                                0.9879645,
                                0.981844,
                                0.98978984,
                                0.99135745,
                                0.98583984,
                                0.9855272,
                                0.986517,
                                0.9485304,
                                0.22053947,
                                0.9521743,
                                0.98690134],
                     'mae': [0.02003736,
                             0.015912456,
                             0.01439145,
                             0.023837384,
                             0.016507413,
                             0.02024578,
                             0.03139986,
                             0.025885034,
                             0.101561256,
                             0.022796463,
                             0.018384555,
                             0.017779883,
                             0.017534263,
                             0.017570963,
                             0.024620226,
                             0.024195084,
                             0.020818792,
                             0.02751676,
                             0.027908234,
                             0.025199236,
                             0.025496928,
                             0.026612235,
                             0.025614794,
                             0.03171184,
                             0.029572342,
                             0.028771188,
                             0.029580686,
                             0.032048475,
                             0.028307416,
                             0.052727886,
                             0.6607605,
                             0.061088167,
                             0.024481287],
                     'max_mae': 0.6607605,
                     'max_mse': 0.45395273,
                     'max_rmse': 0.6737601,
                     'median_mae': 0.025496928,
                     'min_cosine': 0.22053947,
                     'mse': [0.00068473973,
                             0.00042061973,
                             0.00035520172,
                             0.000835334,
                             0.00044601268,
                             0.0007178525,
                             0.0014078384,
                             0.0011215287,
                             0.011160203,
                             0.0008367609,
                             0.0005706602,
                             0.0005313679,
                             0.00053463364,
                             0.00051129406,
                             0.0009844217,
                             0.00095619133,
                             0.0007544167,
                             0.0012169371,
                             0.0012226732,
                             0.0010774712,
                             0.0010844683,
                             0.0011621849,
                             0.0011252535,
                             0.0016751633,
                             0.0014775015,
                             0.0014325989,
                             0.0015413836,
                             0.0017134062,
                             0.0013875705,
                             0.0037367907,
                             0.45395273,
                             0.005122695,
                             0.0010044419],
                     'rmse': [0.026167532,
                              0.020509016,
                              0.018846795,
                              0.028902145,
                              0.021119012,
                              0.02679277,
                              0.037521172,
                              0.03348923,
                              0.105641864,
                              0.02892682,
                              0.023888495,
                              0.023051418,
                              0.023122147,
                              0.022611812,
                              0.031375494,
                              0.030922344,
                              0.027466647,
                              0.034884624,
                              0.034966744,
                              0.032824855,
                              0.03293127,
                              0.034090832,
                              0.033544797,
                              0.04092876,
                              0.038438283,
                              0.037849687,
                              0.03926046,
                              0.04139331,
                              0.03725011,
                              0.061129294,
                              0.6737601,
                              0.071573004,
                              0.03169293]},
 'spectra_realpca': {'cosine': [0.9999682,
                                0.99999785,
                                0.9999965,
                                0.99999756,
                                0.9999957,
                                0.9999954,
                                0.9999342,
                                0.99987614,
                                0.9999996,
                                0.9999987,
                                0.99999934,
                                0.9999982,
                                0.99999905,
                                0.99999607,
                                0.9999819,
                                0.99998695,
                                0.99998355,
                                0.99941695,
                                0.9985467,
                                0.9986237,
                                0.9992905,
                                0.99959,
                                0.9984303,
                                0.99861956,
                                0.9989226,
                                0.9990415,
                                0.9985181,
                                0.99870044,
                                0.99863803,
                                0.9988664,
                                0.999992,
                                0.9986288,
                                0.9987014],
                     'mae': [0.0017450085,
                             0.000663059,
                             0.00083466293,
                             0.00068261824,
                             0.0008402695,
                             0.00090247573,
                             0.0022863888,
                             0.0028411278,
                             0.00031751645,
                             0.0005480782,
                             0.0004364704,
                             0.0005973827,
                             0.0004943899,
                             0.0008029025,
                             0.0014032813,
                             0.0011462688,
                             0.001303968,
                             0.005253833,
                             0.008123226,
                             0.007927386,
                             0.005978541,
                             0.0048311837,
                             0.008913523,
                             0.008705934,
                             0.009633596,
                             0.009927972,
                             0.009185416,
                             0.009594158,
                             0.009369758,
                             0.007255253,
                             0.00061620015,
                             0.009161319,
                             0.007880197],
                     'max_mae': 0.009927972,
                     'max_mse': 0.00015855453,
                     'max_rmse': 0.0125918435,
                     'median_mae': 0.0022863888,
                     'min_cosine': 0.9984303,
                     'mse': [4.8506977e-06,
                             7.0556524e-07,
                             1.1205229e-06,
                             7.512839e-07,
                             1.1397619e-06,
                             1.3022704e-06,
                             8.388576e-06,
                             1.2939334e-05,
                             1.6117292e-07,
                             4.78455e-07,
                             3.0528597e-07,
                             5.7258626e-07,
                             3.9415696e-07,
                             1.0319284e-06,
                             3.1501695e-06,
                             2.0947402e-06,
                             2.705557e-06,
                             4.4238168e-05,
                             0.00010664239,
                             0.00010147713,
                             5.673368e-05,
                             3.701178e-05,
                             0.00012812791,
                             0.0001222514,
                             0.0001524457,
                             0.00015855453,
                             0.00013564138,
                             0.00014769961,
                             0.0001400772,
                             8.4335195e-05,
                             6.1336715e-07,
                             0.00013449512,
                             9.8964236e-05],
                     'rmse': [0.00220243,
                              0.00083997933,
                              0.0010585475,
                              0.0008667663,
                              0.0010675964,
                              0.0011411706,
                              0.0028963038,
                              0.0035971284,
                              0.00040146348,
                              0.0006917044,
                              0.0005525269,
                              0.0007566943,
                              0.0006278192,
                              0.0010158387,
                              0.0017748717,
                              0.0014473217,
                              0.0016448578,
                              0.006651178,
                              0.01032678,
                              0.010073586,
                              0.007532176,
                              0.006083731,
                              0.01131936,
                              0.011056735,
                              0.012346891,
                              0.0125918435,
                              0.0116465185,
                              0.012153173,
                              0.011835421,
                              0.00918342,
                              0.0007831776,
                              0.011597203,
                              0.009948077]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_80.0
