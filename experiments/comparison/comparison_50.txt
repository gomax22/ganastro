
Running comparison for experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805
Directory path: experiments/inpainting/gann_4_night_20180708_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_50.0/images
Optimal number of principal components:  11
Reconstruction error:  26.716219
Energy conservation:  0.5146262
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_50.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [3.933204310299706, 3.243135042084822],
                   'kl_div': 0.25206497,
                   'ks_tests': {10000: KstestResult(statistic=0.1581, pvalue=1.9731374299500712e-109, statistic_location=0.006372874, statistic_sign=1),
                                20000: KstestResult(statistic=0.16215000000000002, pvalue=3.393243974530015e-230, statistic_location=0.007991497, statistic_sign=1),
                                30000: KstestResult(statistic=0.15713333333333335, pvalue=0.0, statistic_location=0.00803006, statistic_sign=1),
                                40000: KstestResult(statistic=0.16497499999999998, pvalue=0.0, statistic_location=0.007567969, statistic_sign=1),
                                50000: KstestResult(statistic=0.16018, pvalue=0.0, statistic_location=0.007988335, statistic_sign=1),
                                60000: KstestResult(statistic=0.15784999999999993, pvalue=0.0, statistic_location=0.0065428303, statistic_sign=1),
                                70000: KstestResult(statistic=0.1618142857142857, pvalue=0.0, statistic_location=0.0064537213, statistic_sign=1),
                                80000: KstestResult(statistic=0.16061250000000005, pvalue=0.0, statistic_location=0.0076082908, statistic_sign=1),
                                90000: KstestResult(statistic=0.1612444444444444, pvalue=0.0, statistic_location=0.006396941, statistic_sign=1),
                                100000: KstestResult(statistic=0.15901999999999994, pvalue=0.0, statistic_location=0.008097086, statistic_sign=1),
                                110000: KstestResult(statistic=0.15991818181818185, pvalue=0.0, statistic_location=0.0065398156, statistic_sign=1)},
                   'moments': {'mean_error': 0.08928331,
                               'means': [-1.1889718e-05, -0.00019336969],
                               'stds': [0.017084507, 0.0062695867],
                               'variance_ratio': 6.2785172}},
 'originals': {'gan': {'mae': 0.04473419114947319,
                       'mse': 0.005009218584746122,
                       'psnr': 27.338207244873047,
                       'rmse': 0.0707758367061615,
                       'ssim': 0.9471726417541504},
               'pca': {'mae': 0.013218195177614689,
                       'mse': 0.00030458541004918516,
                       'psnr': 39.47321319580078,
                       'rmse': 0.01745237596333027,
                       'ssim': 0.9967527389526367}},
 'reconstructions': {'mae': 0.04187556728720665,
                     'mse': 0.004738048184663057,
                     'psnr': 27.55431365966797,
                     'rmse': 0.06883348524570465,
                     'ssim': 0.9495739936828613},
 'residual_spectra_pcagan': {'cosine': [0.34648353,
                                        0.07831706,
                                        0.36183983,
                                        0.38455048,
                                        0.3963833,
                                        0.38094932,
                                        0.39241984,
                                        0.43412766,
                                        0.4193971,
                                        0.44133127,
                                        0.29499084],
                             'mae': [0.01073947,
                                     0.013338382,
                                     0.009003654,
                                     0.009917178,
                                     0.009966473,
                                     0.008428104,
                                     0.008694484,
                                     0.0085460385,
                                     0.008742073,
                                     0.0085519655,
                                     0.01126363],
                             'max_mae': 0.013338382,
                             'max_mse': 0.00041767262,
                             'max_rmse': 0.020437041,
                             'median_distance': 1.4547454,
                             'median_mae': 0.009003654,
                             'min_cosine': 0.07831706,
                             'mse': [0.00029168715,
                                     0.00041767262,
                                     0.00021162849,
                                     0.00023916793,
                                     0.0003308498,
                                     0.00018713284,
                                     0.00016378395,
                                     0.00018043912,
                                     0.00019940171,
                                     0.00017265041,
                                     0.0004131824],
                             'rmse': [0.01707885,
                                      0.020437041,
                                      0.014547456,
                                      0.015465055,
                                      0.018189277,
                                      0.013679651,
                                      0.01279781,
                                      0.013432763,
                                      0.014120967,
                                      0.01313965,
                                      0.020326888]},
 'residuals': {'mae': 0.009744676761329174,
               'mse': 0.0002552360238041729,
               'psnr': 21.408601760864258,
               'rmse': 0.015976108610630035,
               'ssds': [32.106564, 4.327923],
               'ssim': 0.464847207069397},
 'spectra_pcagan': {'cosine': [0.9931536,
                               0.9993983,
                               0.99795926,
                               0.99095523,
                               0.9947936,
                               0.99756116,
                               0.9971018,
                               0.9749134,
                               0.9952666,
                               0.9919009,
                               0.9853925],
                    'mae': [0.028701276,
                            0.022100512,
                            0.037120298,
                            0.02390134,
                            0.016864946,
                            0.03871622,
                            0.030157084,
                            0.19310252,
                            0.02270701,
                            0.020356841,
                            0.026903177],
                    'max_mae': 0.19310252,
                    'max_mse': 0.039344095,
                    'max_rmse': 0.19835345,
                    'median_mae': 0.026903177,
                    'min_cosine': 0.9749134,
                    'mse': [0.0015099783,
                            0.0006967265,
                            0.002193809,
                            0.0010124496,
                            0.0005764433,
                            0.0022776593,
                            0.0014861893,
                            0.039344095,
                            0.0009334997,
                            0.00072725513,
                            0.0013604296],
                    'rmse': [0.03885844,
                             0.026395578,
                             0.046838116,
                             0.031819012,
                             0.024009233,
                             0.047724828,
                             0.038551126,
                             0.19835345,
                             0.030553227,
                             0.026967669,
                             0.036884002]},
 'spectra_realgan': {'cosine': [0.9917535,
                                0.9993863,
                                0.9974737,
                                0.9885627,
                                0.9924067,
                                0.99695754,
                                0.9963519,
                                0.9731593,
                                0.9935513,
                                0.9888126,
                                0.9826637],
                     'mae': [0.0322773,
                             0.021970944,
                             0.039228827,
                             0.027653607,
                             0.02144859,
                             0.04044788,
                             0.033102203,
                             0.19353008,
                             0.027468828,
                             0.024600755,
                             0.030347137],
                     'max_mae': 0.19353008,
                     'max_mse': 0.039805226,
                     'max_rmse': 0.19951247,
                     'median_mae': 0.030347137,
                     'min_cosine': 0.9731593,
                     'mse': [0.0018117451,
                             0.00069364597,
                             0.0024994626,
                             0.0012799253,
                             0.0008118759,
                             0.002571137,
                             0.0017535965,
                             0.039805226,
                             0.0012606175,
                             0.0009979043,
                             0.0016162709],
                     'rmse': [0.0425646,
                              0.02633716,
                              0.049994625,
                              0.035776045,
                              0.028493436,
                              0.05070638,
                              0.041875966,
                              0.19951247,
                              0.035505176,
                              0.031589624,
                              0.04020287]},
 'spectra_realpca': {'cosine': [0.99849313,
                                0.999987,
                                0.9994718,
                                0.9972872,
                                0.99765736,
                                0.9993236,
                                0.9991078,
                                0.9982571,
                                0.9983211,
                                0.99656826,
                                0.9968377],
                     'mae': [0.014457437,
                             0.0020972046,
                             0.015758704,
                             0.013740601,
                             0.012077498,
                             0.015750695,
                             0.0155895855,
                             0.01443225,
                             0.014297189,
                             0.013716113,
                             0.013482868],
                     'max_mae': 0.015758704,
                     'max_mse': 0.00039996256,
                     'max_rmse': 0.019999065,
                     'median_mae': 0.014297189,
                     'min_cosine': 0.99656826,
                     'mse': [0.00033298857,
                             7.028208e-06,
                             0.00039996256,
                             0.00030240926,
                             0.00023535857,
                             0.00039585686,
                             0.00039003143,
                             0.00036444652,
                             0.00032727545,
                             0.00030001925,
                             0.0002950631],
                     'rmse': [0.018247975,
                              0.0026510768,
                              0.019999065,
                              0.017389918,
                              0.0153414,
                              0.019896151,
                              0.019749213,
                              0.019090483,
                              0.018090757,
                              0.017321063,
                              0.017177401]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_50.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628
Directory path: experiments/inpainting/gann_4_night_20180708_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_50.0/images
Optimal number of principal components:  11
Reconstruction error:  26.716219
Energy conservation:  0.5146262
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_50.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.079875858281184, 3.248694773221874],
                   'kl_div': 0.36833322,
                   'ks_tests': {10000: KstestResult(statistic=0.1974, pvalue=9.175170802947736e-171, statistic_location=-0.007334018, statistic_sign=-1),
                                20000: KstestResult(statistic=0.2027, pvalue=0.0, statistic_location=-0.0075290785, statistic_sign=-1),
                                30000: KstestResult(statistic=0.20263333333333333, pvalue=0.0, statistic_location=-0.0075956583, statistic_sign=-1),
                                40000: KstestResult(statistic=0.200575, pvalue=0.0, statistic_location=-0.00754504, statistic_sign=-1),
                                50000: KstestResult(statistic=0.20024000000000003, pvalue=0.0, statistic_location=-0.007516935, statistic_sign=-1),
                                60000: KstestResult(statistic=0.19805, pvalue=0.0, statistic_location=-0.0076104766, statistic_sign=-1),
                                70000: KstestResult(statistic=0.19871428571428573, pvalue=0.0, statistic_location=-0.007546248, statistic_sign=-1),
                                80000: KstestResult(statistic=0.200125, pvalue=0.0, statistic_location=-0.007739881, statistic_sign=-1),
                                90000: KstestResult(statistic=0.20063333333333336, pvalue=0.0, statistic_location=-0.0073950253, statistic_sign=-1),
                                100000: KstestResult(statistic=0.20204, pvalue=0.0, statistic_location=-0.0075443946, statistic_sign=-1),
                                110000: KstestResult(statistic=0.19731818181818184, pvalue=0.0, statistic_location=-0.007514313, statistic_sign=-1),
                                120000: KstestResult(statistic=0.19841666666666669, pvalue=0.0, statistic_location=-0.007852588, statistic_sign=-1),
                                130000: KstestResult(statistic=0.19754615384615382, pvalue=0.0, statistic_location=-0.007849755, statistic_sign=-1),
                                140000: KstestResult(statistic=0.19805714285714288, pvalue=0.0, statistic_location=-0.0075091496, statistic_sign=-1),
                                150000: KstestResult(statistic=0.19874666666666668, pvalue=0.0, statistic_location=-0.0077158455, statistic_sign=-1),
                                160000: KstestResult(statistic=0.1977, pvalue=0.0, statistic_location=-0.007554801, statistic_sign=-1),
                                170000: KstestResult(statistic=0.19822941176470588, pvalue=0.0, statistic_location=-0.0076759146, statistic_sign=-1),
                                180000: KstestResult(statistic=0.1997166666666667, pvalue=0.0, statistic_location=-0.0074883904, statistic_sign=-1),
                                190000: KstestResult(statistic=0.19959473684210527, pvalue=0.0, statistic_location=-0.0075618885, statistic_sign=-1),
                                200000: KstestResult(statistic=0.198665, pvalue=0.0, statistic_location=-0.007599851, statistic_sign=-1),
                                210000: KstestResult(statistic=0.20040952380952382, pvalue=0.0, statistic_location=-0.0075443946, statistic_sign=-1),
                                220000: KstestResult(statistic=0.20015454545454547, pvalue=0.0, statistic_location=-0.0075039538, statistic_sign=-1)},
                   'moments': {'mean_error': -0.15006393,
                               'means': [-0.0014181881, -0.00011537762],
                               'stds': [0.01881039, 0.00637477],
                               'variance_ratio': 7.1535397}},
 'originals': {'gan': {'mae': 0.04141559451818466,
                       'mse': 0.0036904369480907917,
                       'psnr': 29.5562801361084,
                       'rmse': 0.06074896827340126,
                       'ssim': 0.906316876411438},
               'pca': {'mae': 0.012043953873217106,
                       'mse': 0.00026798484032042325,
                       'psnr': 41.1002311706543,
                       'rmse': 0.016370242461562157,
                       'ssim': 0.9937921762466431}},
 'reconstructions': {'mae': 0.03931243345141411,
                     'mse': 0.0034526127856224775,
                     'psnr': 29.999855041503906,
                     'rmse': 0.0587589368224144,
                     'ssim': 0.9098342061042786},
 'residual_spectra_pcagan': {'cosine': [0.38430348,
                                        0.113531955,
                                        0.361776,
                                        0.28838003,
                                        0.3009431,
                                        0.4055095,
                                        0.08059162,
                                        0.31048277,
                                        0.37111762,
                                        0.36264277,
                                        0.37069246,
                                        0.3302259,
                                        0.38455802,
                                        0.32326388,
                                        0.3395761,
                                        0.3615544,
                                        0.3839729,
                                        0.36774164,
                                        0.4887126,
                                        0.06383099,
                                        0.39300746,
                                        0.4835722],
                             'mae': [0.012615813,
                                     0.015072715,
                                     0.012309825,
                                     0.013870067,
                                     0.011990207,
                                     0.009907259,
                                     0.014408482,
                                     0.011281403,
                                     0.011878496,
                                     0.011721913,
                                     0.009851879,
                                     0.01119246,
                                     0.01003452,
                                     0.011119627,
                                     0.011835593,
                                     0.011685217,
                                     0.009692283,
                                     0.011328501,
                                     0.009984477,
                                     0.012759742,
                                     0.009730266,
                                     0.009461107],
                             'max_mae': 0.015072715,
                             'max_mse': 0.00048620653,
                             'max_rmse': 0.022050092,
                             'median_distance': 1.7743704,
                             'median_mae': 0.011506859,
                             'min_cosine': 0.06383099,
                             'mse': [0.0003383661,
                                     0.00048620653,
                                     0.0003831089,
                                     0.00036772928,
                                     0.00031680753,
                                     0.00020052462,
                                     0.00043446498,
                                     0.0003128768,
                                     0.00029587233,
                                     0.00042458405,
                                     0.00021896363,
                                     0.000267797,
                                     0.00024794418,
                                     0.0004079525,
                                     0.00031763315,
                                     0.00032964855,
                                     0.00024651038,
                                     0.00028408534,
                                     0.00019999142,
                                     0.00032923277,
                                     0.00028425182,
                                     0.00023701997],
                             'rmse': [0.018394731,
                                      0.022050092,
                                      0.019573169,
                                      0.019176269,
                                      0.017799089,
                                      0.014160671,
                                      0.020843824,
                                      0.017688325,
                                      0.01720094,
                                      0.020605437,
                                      0.014797419,
                                      0.016364504,
                                      0.015746243,
                                      0.020197835,
                                      0.017822266,
                                      0.018156227,
                                      0.01570065,
                                      0.016854832,
                                      0.0141418325,
                                      0.018144773,
                                      0.01685977,
                                      0.015395453]},
 'residuals': {'mae': 0.011533267796039581,
               'mse': 0.0003150714619550854,
               'psnr': 20.630855560302734,
               'rmse': 0.017750252038240433,
               'ssds': [78.28488, 8.94318],
               'ssim': 0.34028178453445435},
 'spectra_pcagan': {'cosine': [0.9992102,
                               0.9994082,
                               0.9849953,
                               0.9947048,
                               0.9968774,
                               0.99312705,
                               0.9991828,
                               0.99680245,
                               0.9847813,
                               0.99107504,
                               0.9966899,
                               0.99483585,
                               0.97840416,
                               0.9919336,
                               0.95969,
                               0.97999185,
                               0.98945737,
                               0.9810494,
                               0.99104005,
                               0.99932116,
                               0.98542786,
                               0.9982742],
                    'mae': [0.01476373,
                            0.020154916,
                            0.025476875,
                            0.04849558,
                            0.057712823,
                            0.030391537,
                            0.019967327,
                            0.054662544,
                            0.032472346,
                            0.022482568,
                            0.04740769,
                            0.04320957,
                            0.1791834,
                            0.030742291,
                            0.057753045,
                            0.033081356,
                            0.025593737,
                            0.04061529,
                            0.023941236,
                            0.017686315,
                            0.022344913,
                            0.016734503],
                    'max_mae': 0.1791834,
                    'max_mse': 0.034767132,
                    'max_rmse': 0.18645947,
                    'median_mae': 0.030566914,
                    'min_cosine': 0.95969,
                    'mse': [0.00036106014,
                            0.00059000857,
                            0.0011090902,
                            0.0036644868,
                            0.0055209,
                            0.0015588001,
                            0.00062133506,
                            0.004363483,
                            0.0017473486,
                            0.0009161682,
                            0.003312904,
                            0.0029421777,
                            0.034767132,
                            0.0018033028,
                            0.004272159,
                            0.0018919542,
                            0.0011393474,
                            0.0024998838,
                            0.0009590004,
                            0.00047564064,
                            0.0009539211,
                            0.0004873803],
                    'rmse': [0.019001583,
                             0.024290092,
                             0.033303004,
                             0.060535006,
                             0.074302755,
                             0.039481644,
                             0.024926594,
                             0.06605666,
                             0.0418013,
                             0.03026827,
                             0.057557832,
                             0.054241844,
                             0.18645947,
                             0.042465314,
                             0.06536175,
                             0.0434966,
                             0.033754222,
                             0.04999884,
                             0.030967731,
                             0.021809187,
                             0.030885613,
                             0.022076692]},
 'spectra_realgan': {'cosine': [0.99894327,
                                0.9994024,
                                0.9814528,
                                0.99415404,
                                0.99652416,
                                0.99169517,
                                0.99916613,
                                0.99628097,
                                0.98221505,
                                0.98848164,
                                0.9960186,
                                0.99405783,
                                0.9766493,
                                0.9902268,
                                0.9571112,
                                0.9767989,
                                0.9864785,
                                0.9784229,
                                0.9882576,
                                0.9993158,
                                0.9809229,
                                0.9974111],
                     'mae': [0.017146017,
                             0.020168275,
                             0.028706122,
                             0.05080022,
                             0.059404247,
                             0.03350943,
                             0.019985853,
                             0.055691835,
                             0.03531195,
                             0.026215777,
                             0.04867507,
                             0.04468002,
                             0.1796589,
                             0.03404789,
                             0.058346108,
                             0.03597004,
                             0.028960248,
                             0.04211706,
                             0.027531842,
                             0.017711425,
                             0.026319213,
                             0.020185484],
                     'max_mae': 0.1796589,
                     'max_mse': 0.035222594,
                     'max_rmse': 0.18767683,
                     'median_mae': 0.03377866,
                     'min_cosine': 0.9571112,
                     'mse': [0.00047266282,
                             0.000592701,
                             0.0013652366,
                             0.0040394417,
                             0.005812684,
                             0.0018575595,
                             0.0006232329,
                             0.0046497225,
                             0.0020181634,
                             0.0011730504,
                             0.0036265813,
                             0.0031747546,
                             0.035222594,
                             0.0021111092,
                             0.0045066024,
                             0.002181042,
                             0.0014073055,
                             0.0027539139,
                             0.0012253365,
                             0.00047696684,
                             0.001222462,
                             0.0006764882],
                     'rmse': [0.021740811,
                              0.024345452,
                              0.03694911,
                              0.063556604,
                              0.076240964,
                              0.043099415,
                              0.024964632,
                              0.068188876,
                              0.044923972,
                              0.034249824,
                              0.060221102,
                              0.05634496,
                              0.18767683,
                              0.045946807,
                              0.067131236,
                              0.04670163,
                              0.037514072,
                              0.052477747,
                              0.035004806,
                              0.02183957,
                              0.034963723,
                              0.026009386]},
 'spectra_realpca': {'cosine': [0.9997344,
                                0.99999666,
                                0.9966756,
                                0.99939466,
                                0.99962264,
                                0.99849313,
                                0.999987,
                                0.9994718,
                                0.9972872,
                                0.99765736,
                                0.9993236,
                                0.9991078,
                                0.9982571,
                                0.9983211,
                                0.99656826,
                                0.9968377,
                                0.9968534,
                                0.99711406,
                                0.9974841,
                                0.99999696,
                                0.99557704,
                                0.999159],
                     'mae': [0.008301534,
                             0.0011990971,
                             0.012263583,
                             0.01613472,
                             0.017152265,
                             0.014457437,
                             0.0020972046,
                             0.015758704,
                             0.013740601,
                             0.012077498,
                             0.015750695,
                             0.0155895855,
                             0.01443225,
                             0.014297189,
                             0.013716113,
                             0.013482868,
                             0.013712644,
                             0.013885544,
                             0.012120582,
                             0.0010439588,
                             0.012812877,
                             0.010940018],
                     'max_mae': 0.017152265,
                     'max_mse': 0.00047412576,
                     'max_rmse': 0.02177443,
                     'median_mae': 0.013714379,
                     'min_cosine': 0.99557704,
                     'mse': [0.00011031397,
                             2.295075e-06,
                             0.00024132588,
                             0.0004191545,
                             0.00047412576,
                             0.00033298857,
                             7.028208e-06,
                             0.00039996256,
                             0.00030240926,
                             0.00023535857,
                             0.00039585686,
                             0.00039003143,
                             0.00036444652,
                             0.00032727545,
                             0.00030001925,
                             0.0002950631,
                             0.00030110127,
                             0.00030579657,
                             0.00023305776,
                             1.7527444e-06,
                             0.00026385934,
                             0.00019244368],
                     'rmse': [0.010503046,
                              0.0015149505,
                              0.015534667,
                              0.020473262,
                              0.02177443,
                              0.018247975,
                              0.0026510768,
                              0.019999065,
                              0.017389918,
                              0.0153414,
                              0.019896151,
                              0.019749213,
                              0.019090483,
                              0.018090757,
                              0.017321063,
                              0.017177401,
                              0.01735227,
                              0.01748704,
                              0.015266229,
                              0.0013239125,
                              0.016243748,
                              0.013872407]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_50.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354
Directory path: experiments/inpainting/gann_4_night_20180708_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_50.0/images
Optimal number of principal components:  11
Reconstruction error:  26.716219
Energy conservation:  0.5146262
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_50.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.061857105227111, 3.317416670029916],
                   'kl_div': 0.30429178,
                   'ks_tests': {10000: KstestResult(statistic=0.1796, pvalue=2.8736131626086614e-141, statistic_location=-0.008116104, statistic_sign=-1),
                                20000: KstestResult(statistic=0.16834999999999997, pvalue=3.2358526116886174e-248, statistic_location=-0.008039413, statistic_sign=-1),
                                30000: KstestResult(statistic=0.17173333333333335, pvalue=0.0, statistic_location=-0.007956221, statistic_sign=-1),
                                40000: KstestResult(statistic=0.16722499999999998, pvalue=0.0, statistic_location=-0.008195593, statistic_sign=-1),
                                50000: KstestResult(statistic=0.17466, pvalue=0.0, statistic_location=-0.0079765245, statistic_sign=-1),
                                60000: KstestResult(statistic=0.17049999999999998, pvalue=0.0, statistic_location=-0.00804662, statistic_sign=-1),
                                70000: KstestResult(statistic=0.16594285714285714, pvalue=0.0, statistic_location=-0.008277714, statistic_sign=-1),
                                80000: KstestResult(statistic=0.16665000000000002, pvalue=0.0, statistic_location=-0.0075741224, statistic_sign=-1),
                                90000: KstestResult(statistic=0.16785555555555554, pvalue=0.0, statistic_location=-0.008019265, statistic_sign=-1),
                                100000: KstestResult(statistic=0.16632999999999998, pvalue=0.0, statistic_location=-0.008111506, statistic_sign=-1),
                                110000: KstestResult(statistic=0.16857272727272726, pvalue=0.0, statistic_location=-0.0076090135, statistic_sign=-1),
                                120000: KstestResult(statistic=0.16829166666666667, pvalue=0.0, statistic_location=-0.007886973, statistic_sign=-1),
                                130000: KstestResult(statistic=0.16993846153846157, pvalue=0.0, statistic_location=-0.0076039294, statistic_sign=-1),
                                140000: KstestResult(statistic=0.16975, pvalue=0.0, statistic_location=-0.00825884, statistic_sign=-1),
                                150000: KstestResult(statistic=0.16871333333333335, pvalue=0.0, statistic_location=-0.008068993, statistic_sign=-1),
                                160000: KstestResult(statistic=0.166575, pvalue=0.0, statistic_location=-0.008263819, statistic_sign=-1),
                                170000: KstestResult(statistic=0.16768235294117645, pvalue=0.0, statistic_location=-0.0078047663, statistic_sign=-1),
                                180000: KstestResult(statistic=0.16970555555555555, pvalue=0.0, statistic_location=-0.008019332, statistic_sign=-1),
                                190000: KstestResult(statistic=0.16924210526315786, pvalue=0.0, statistic_location=-0.007872984, statistic_sign=-1),
                                200000: KstestResult(statistic=0.16965000000000002, pvalue=0.0, statistic_location=-0.008033686, statistic_sign=-1),
                                210000: KstestResult(statistic=0.16912857142857143, pvalue=0.0, statistic_location=-0.00804788, statistic_sign=-1),
                                220000: KstestResult(statistic=0.1678, pvalue=0.0, statistic_location=-0.008259218, statistic_sign=-1),
                                230000: KstestResult(statistic=0.1692434782608696, pvalue=0.0, statistic_location=-0.0076047014, statistic_sign=-1),
                                240000: KstestResult(statistic=0.16823750000000004, pvalue=0.0, statistic_location=-0.008292863, statistic_sign=-1),
                                250000: KstestResult(statistic=0.16926000000000002, pvalue=0.0, statistic_location=-0.008033654, statistic_sign=-1),
                                260000: KstestResult(statistic=0.16829615384615387, pvalue=0.0, statistic_location=-0.007900197, statistic_sign=-1),
                                270000: KstestResult(statistic=0.16855185185185184, pvalue=0.0, statistic_location=-0.007838122, statistic_sign=-1),
                                280000: KstestResult(statistic=0.16962142857142853, pvalue=0.0, statistic_location=-0.007805273, statistic_sign=-1),
                                290000: KstestResult(statistic=0.16939310344827588, pvalue=0.0, statistic_location=-0.008024578, statistic_sign=-1),
                                300000: KstestResult(statistic=0.16943999999999998, pvalue=0.0, statistic_location=-0.008034341, statistic_sign=-1),
                                310000: KstestResult(statistic=0.16980967741935482, pvalue=0.0, statistic_location=-0.008041217, statistic_sign=-1),
                                320000: KstestResult(statistic=0.169821875, pvalue=0.0, statistic_location=-0.008052938, statistic_sign=-1),
                                330000: KstestResult(statistic=0.1698181818181818, pvalue=0.0, statistic_location=-0.008019265, statistic_sign=-1)},
                   'moments': {'mean_error': -0.03624444,
                               'means': [-0.0005078844, -5.290622e-05],
                               'stds': [0.017889043, 0.0068370886],
                               'variance_ratio': 5.8869357}},
 'originals': {'gan': {'mae': 0.034347835928201675,
                       'mse': 0.0026877440977841616,
                       'psnr': 30.955209732055664,
                       'rmse': 0.05184345692396164,
                       'ssim': 0.9331133365631104},
               'pca': {'mae': 0.01144302636384964,
                       'mse': 0.0002405366103630513,
                       'psnr': 41.65397644042969,
                       'rmse': 0.015509243123233318,
                       'ssim': 0.995380699634552}},
 'reconstructions': {'mae': 0.03186676651239395,
                     'mse': 0.00246835476718843,
                     'psnr': 31.54171371459961,
                     'rmse': 0.04968253895640373,
                     'ssim': 0.9358569979667664},
 'residual_spectra_pcagan': {'cosine': [0.57519376,
                                        0.5665427,
                                        0.4716177,
                                        0.39311847,
                                        0.45535576,
                                        0.40720817,
                                        0.382769,
                                        0.11232743,
                                        0.36795187,
                                        0.28565472,
                                        0.31291276,
                                        0.41906977,
                                        0.07884795,
                                        0.3163468,
                                        0.39527777,
                                        0.3922623,
                                        0.3877156,
                                        0.33300772,
                                        0.3900358,
                                        0.33503908,
                                        0.353685,
                                        0.37372655,
                                        0.40003854,
                                        0.38510954,
                                        0.49682817,
                                        0.058937103,
                                        0.3981685,
                                        0.4775851,
                                        0.46354234,
                                        0.5304833,
                                        0.5368645,
                                        0.54735565,
                                        0.059125133],
                             'mae': [0.008251289,
                                     0.008769611,
                                     0.00867761,
                                     0.010202458,
                                     0.009483893,
                                     0.012439352,
                                     0.012721229,
                                     0.014972748,
                                     0.012154582,
                                     0.013874854,
                                     0.011596071,
                                     0.0095705455,
                                     0.014238054,
                                     0.01112674,
                                     0.011311301,
                                     0.011177781,
                                     0.0094372425,
                                     0.01105833,
                                     0.009766741,
                                     0.010814725,
                                     0.011564098,
                                     0.011408093,
                                     0.0094459895,
                                     0.011052033,
                                     0.009859075,
                                     0.012556829,
                                     0.009550282,
                                     0.009475277,
                                     0.009489716,
                                     0.008776314,
                                     0.007889886,
                                     0.008824663,
                                     0.013424921],
                             'max_mae': 0.014972748,
                             'max_mse': 0.000467765,
                             'max_rmse': 0.021627875,
                             'median_distance': 1.635708,
                             'median_mae': 0.010814725,
                             'min_cosine': 0.058937103,
                             'mse': [0.0001470358,
                                     0.00017412126,
                                     0.00017214414,
                                     0.00030362993,
                                     0.0001815362,
                                     0.00036084908,
                                     0.0003477882,
                                     0.000467765,
                                     0.00036913785,
                                     0.00037440704,
                                     0.00029668497,
                                     0.00019009151,
                                     0.0004185094,
                                     0.00030088553,
                                     0.00025279366,
                                     0.00035280848,
                                     0.00019470032,
                                     0.00026755407,
                                     0.00023409266,
                                     0.00037449374,
                                     0.00029282318,
                                     0.00031696926,
                                     0.0002244128,
                                     0.00025987581,
                                     0.00019207294,
                                     0.0003225428,
                                     0.00027523545,
                                     0.0002483907,
                                     0.00021851111,
                                     0.00015692756,
                                     0.00016620588,
                                     0.00019652401,
                                     0.0003640665],
                             'rmse': [0.012125832,
                                      0.013195502,
                                      0.013120371,
                                      0.01742498,
                                      0.013473537,
                                      0.018996028,
                                      0.01864908,
                                      0.021627875,
                                      0.019212961,
                                      0.019349601,
                                      0.017224547,
                                      0.013787367,
                                      0.020457502,
                                      0.017346052,
                                      0.015899487,
                                      0.018783197,
                                      0.013953506,
                                      0.016357081,
                                      0.015300087,
                                      0.01935184,
                                      0.017112076,
                                      0.01780363,
                                      0.014980414,
                                      0.016120665,
                                      0.013859038,
                                      0.017959476,
                                      0.01659022,
                                      0.015760414,
                                      0.014782121,
                                      0.012527073,
                                      0.012892086,
                                      0.014018702,
                                      0.019080527]},
 'residuals': {'mae': 0.010756433941423893,
               'mse': 0.00027319963555783033,
               'psnr': 21.68922996520996,
               'rmse': 0.016528751701116562,
               'ssds': [105.69071, 15.426989],
               'ssim': 0.3586612641811371},
 'spectra_pcagan': {'cosine': [0.9982449,
                               0.999529,
                               0.9874201,
                               0.9956789,
                               0.986827,
                               0.9988899,
                               0.99918944,
                               0.99941456,
                               0.98484504,
                               0.99465644,
                               0.99689686,
                               0.9931716,
                               0.9991907,
                               0.99680734,
                               0.9851064,
                               0.99153525,
                               0.9967536,
                               0.9948311,
                               0.9783517,
                               0.9921756,
                               0.96017265,
                               0.9806362,
                               0.98965645,
                               0.9812174,
                               0.9910079,
                               0.9993171,
                               0.9852557,
                               0.9982316,
                               0.9886973,
                               0.9967446,
                               0.9968412,
                               0.9989869,
                               0.99968946],
                    'mae': [0.014543852,
                            0.011573767,
                            0.020425623,
                            0.017863862,
                            0.020624474,
                            0.015032904,
                            0.014990374,
                            0.019885395,
                            0.025581589,
                            0.04860165,
                            0.057513043,
                            0.030225964,
                            0.019979456,
                            0.05395107,
                            0.032156885,
                            0.022029016,
                            0.0471191,
                            0.04365274,
                            0.17978494,
                            0.029953552,
                            0.05744393,
                            0.032548882,
                            0.025275195,
                            0.04073047,
                            0.024009528,
                            0.017803868,
                            0.022276197,
                            0.016722944,
                            0.021211667,
                            0.016846677,
                            0.018780332,
                            0.0156551,
                            0.01680956],
                    'max_mae': 0.17978494,
                    'max_mse': 0.035000242,
                    'max_rmse': 0.18708351,
                    'median_mae': 0.022029016,
                    'min_cosine': 0.96017265,
                    'mse': [0.00035902087,
                            0.00022206214,
                            0.00071674754,
                            0.0005677948,
                            0.000742967,
                            0.0004289157,
                            0.00037399385,
                            0.00057622883,
                            0.0011163241,
                            0.003696151,
                            0.0054764887,
                            0.0015452096,
                            0.0006205124,
                            0.0042793364,
                            0.00170989,
                            0.00086304627,
                            0.003272757,
                            0.0029718836,
                            0.035000242,
                            0.0017287188,
                            0.004223206,
                            0.0018272571,
                            0.0011078703,
                            0.0024791788,
                            0.0009645155,
                            0.00048050532,
                            0.0009607646,
                            0.0004921706,
                            0.00075573055,
                            0.00048526254,
                            0.0005938694,
                            0.00040529663,
                            0.00041178407],
                    'rmse': [0.018947845,
                             0.01490175,
                             0.026772141,
                             0.023828445,
                             0.027257422,
                             0.02071028,
                             0.01933892,
                             0.024004767,
                             0.033411436,
                             0.060795978,
                             0.0740033,
                             0.039309155,
                             0.024910087,
                             0.065416634,
                             0.041350815,
                             0.029377649,
                             0.057208013,
                             0.054514986,
                             0.18708351,
                             0.041577864,
                             0.0649862,
                             0.04274643,
                             0.033284687,
                             0.049791355,
                             0.03105665,
                             0.021920431,
                             0.030996203,
                             0.02218492,
                             0.027490554,
                             0.022028675,
                             0.024369435,
                             0.020131981,
                             0.020292463]},
 'spectra_realgan': {'cosine': [0.9972507,
                                0.9992216,
                                0.983224,
                                0.9942405,
                                0.9827066,
                                0.9984878,
                                0.9989239,
                                0.9994087,
                                0.9812966,
                                0.9941067,
                                0.9965379,
                                0.9917252,
                                0.99917454,
                                0.99628705,
                                0.9825389,
                                0.9889614,
                                0.99609065,
                                0.99404496,
                                0.9766171,
                                0.9904792,
                                0.95758843,
                                0.9774093,
                                0.9867021,
                                0.9785784,
                                0.9882231,
                                0.9993118,
                                0.9807603,
                                0.99736637,
                                0.9840902,
                                0.9953627,
                                0.99517846,
                                0.99834555,
                                0.9996882],
                     'mae': [0.018541913,
                             0.014985727,
                             0.023866154,
                             0.021071775,
                             0.02424922,
                             0.018311078,
                             0.01734175,
                             0.019904833,
                             0.028784057,
                             0.05091293,
                             0.05916787,
                             0.03345956,
                             0.019981522,
                             0.05501125,
                             0.034977432,
                             0.025771637,
                             0.04837432,
                             0.0450641,
                             0.18023469,
                             0.033359013,
                             0.05806239,
                             0.03555139,
                             0.028644288,
                             0.042166643,
                             0.027583674,
                             0.017824871,
                             0.026277723,
                             0.020177353,
                             0.025291286,
                             0.020646969,
                             0.02213602,
                             0.018928371,
                             0.016816843],
                     'max_mae': 0.18023469,
                     'max_mse': 0.03544955,
                     'max_rmse': 0.18828051,
                     'median_mae': 0.025771637,
                     'min_cosine': 0.95758843,
                     'mse': [0.0005579732,
                             0.00035868053,
                             0.0009543721,
                             0.0007570482,
                             0.0009759351,
                             0.0005737449,
                             0.0004850316,
                             0.00057894946,
                             0.0013730358,
                             0.004070527,
                             0.0057761045,
                             0.0018476612,
                             0.0006221637,
                             0.004566786,
                             0.0019810856,
                             0.0011185728,
                             0.0035820454,
                             0.003205941,
                             0.03544955,
                             0.0020360134,
                             0.0044579525,
                             0.0021198627,
                             0.0013743625,
                             0.0027344807,
                             0.0012311748,
                             0.0004816774,
                             0.001228849,
                             0.0006819379,
                             0.0010366851,
                             0.0006882469,
                             0.00080014684,
                             0.00057676836,
                             0.00041219837],
                     'rmse': [0.023621457,
                              0.018938864,
                              0.030892914,
                              0.027514508,
                              0.03123996,
                              0.023952972,
                              0.022023434,
                              0.024061369,
                              0.037054498,
                              0.06380068,
                              0.07600069,
                              0.04298443,
                              0.02494321,
                              0.067577995,
                              0.04450939,
                              0.03344507,
                              0.05985019,
                              0.05662103,
                              0.18828051,
                              0.045122206,
                              0.0667679,
                              0.046041965,
                              0.037072394,
                              0.05229226,
                              0.0350881,
                              0.02194715,
                              0.035054944,
                              0.02611394,
                              0.032197595,
                              0.026234461,
                              0.028286867,
                              0.024016002,
                              0.020302668]},
 'spectra_realpca': {'cosine': [0.99904615,
                                0.9996867,
                                0.99546355,
                                0.99844384,
                                0.99552953,
                                0.9996376,
                                0.9997344,
                                0.99999666,
                                0.9966756,
                                0.99939466,
                                0.99962264,
                                0.99849313,
                                0.999987,
                                0.9994718,
                                0.9972872,
                                0.99765736,
                                0.9993236,
                                0.9991078,
                                0.9982571,
                                0.9983211,
                                0.99656826,
                                0.9968377,
                                0.9968534,
                                0.99711406,
                                0.9974841,
                                0.99999696,
                                0.99557704,
                                0.999159,
                                0.995534,
                                0.99857205,
                                0.9983396,
                                0.9993875,
                                0.99999917],
                     'mae': [0.010884516,
                             0.009408038,
                             0.012538583,
                             0.011291803,
                             0.012456224,
                             0.009048,
                             0.008301534,
                             0.0011990971,
                             0.012263583,
                             0.01613472,
                             0.017152265,
                             0.014457437,
                             0.0020972046,
                             0.015758704,
                             0.013740601,
                             0.012077498,
                             0.015750695,
                             0.0155895855,
                             0.01443225,
                             0.014297189,
                             0.013716113,
                             0.013482868,
                             0.013712644,
                             0.013885544,
                             0.012120582,
                             0.0010439588,
                             0.012812877,
                             0.010940018,
                             0.012877823,
                             0.01148076,
                             0.011589843,
                             0.010476299,
                             0.0006010313],
                     'max_mae': 0.017152265,
                     'max_mse': 0.00047412576,
                     'max_rmse': 0.02177443,
                     'median_mae': 0.012456224,
                     'min_cosine': 0.99546355,
                     'mse': [0.00019150566,
                             0.00014198014,
                             0.0002535211,
                             0.00020389554,
                             0.00024979547,
                             0.0001312126,
                             0.00011031397,
                             2.295075e-06,
                             0.00024132588,
                             0.0004191545,
                             0.00047412576,
                             0.00033298857,
                             7.028208e-06,
                             0.00039996256,
                             0.00030240926,
                             0.00023535857,
                             0.00039585686,
                             0.00039003143,
                             0.00036444652,
                             0.00032727545,
                             0.00030001925,
                             0.0002950631,
                             0.00030110127,
                             0.00030579657,
                             0.00023305776,
                             1.7527444e-06,
                             0.00026385934,
                             0.00019244368,
                             0.0002674749,
                             0.00021148892,
                             0.00021400492,
                             0.00017657857,
                             5.844596e-07],
                     'rmse': [0.0138385575,
                              0.011915542,
                              0.015922347,
                              0.0142792,
                              0.015804918,
                              0.011454807,
                              0.010503046,
                              0.0015149505,
                              0.015534667,
                              0.020473262,
                              0.02177443,
                              0.018247975,
                              0.0026510768,
                              0.019999065,
                              0.017389918,
                              0.0153414,
                              0.019896151,
                              0.019749213,
                              0.019090483,
                              0.018090757,
                              0.017321063,
                              0.017177401,
                              0.01735227,
                              0.01748704,
                              0.015266229,
                              0.0013239125,
                              0.016243748,
                              0.013872407,
                              0.01635466,
                              0.014542659,
                              0.014628907,
                              0.013288287,
                              0.0007644996]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_50.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516
Directory path: experiments/inpainting/gann_4_night_20180722_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_50.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_50.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.35918432275619, 3.1215890132546327],
                   'kl_div': 0.8423621,
                   'ks_tests': {10000: KstestResult(statistic=0.3057, pvalue=1e-323, statistic_location=0.009026034, statistic_sign=1),
                                20000: KstestResult(statistic=0.2992, pvalue=0.0, statistic_location=0.008681623, statistic_sign=1),
                                30000: KstestResult(statistic=0.30310000000000004, pvalue=0.0, statistic_location=0.008522993, statistic_sign=1),
                                40000: KstestResult(statistic=0.29964999999999997, pvalue=0.0, statistic_location=0.008693956, statistic_sign=1),
                                50000: KstestResult(statistic=0.2987000000000001, pvalue=0.0, statistic_location=0.008085007, statistic_sign=1),
                                60000: KstestResult(statistic=0.2987833333333333, pvalue=0.0, statistic_location=0.008364605, statistic_sign=1),
                                70000: KstestResult(statistic=0.3020571428571429, pvalue=0.0, statistic_location=0.008112694, statistic_sign=1),
                                80000: KstestResult(statistic=0.30265, pvalue=0.0, statistic_location=0.008693375, statistic_sign=1),
                                90000: KstestResult(statistic=0.3058444444444445, pvalue=0.0, statistic_location=0.008808844, statistic_sign=1),
                                100000: KstestResult(statistic=0.3071600000000001, pvalue=0.0, statistic_location=0.008454197, statistic_sign=1),
                                110000: KstestResult(statistic=0.3026818181818183, pvalue=0.0, statistic_location=0.0084098345, statistic_sign=1)},
                   'moments': {'mean_error': 0.08277822,
                               'means': [-0.00073593855, -0.00044577167],
                               'stds': [0.022726193, 0.005489738],
                               'variance_ratio': 8.24979}},
 'originals': {'gan': {'mae': 0.05885758250951767,
                       'mse': 0.005448393989354372,
                       'psnr': 27.10418128967285,
                       'rmse': 0.07381323724985123,
                       'ssim': 0.603545069694519},
               'pca': {'mae': 0.012983637861907482,
                       'mse': 0.0002722899953369051,
                       'psnr': 40.598304748535156,
                       'rmse': 0.016501212492585182,
                       'ssim': 0.9844791293144226}},
 'reconstructions': {'mae': 0.057177815586328506,
                     'mse': 0.005125264637172222,
                     'psnr': 27.851459503173828,
                     'rmse': 0.07159095257520676,
                     'ssim': 0.6051655411720276},
 'residual_spectra_pcagan': {'cosine': [0.26564148,
                                        0.23854306,
                                        0.23416865,
                                        0.26053408,
                                        0.25381,
                                        0.33885944,
                                        0.29297134,
                                        0.24404314,
                                        0.2251663,
                                        0.22150944,
                                        0.2624583],
                             'mae': [0.014994153,
                                     0.017118374,
                                     0.017104134,
                                     0.016188318,
                                     0.014930034,
                                     0.014704486,
                                     0.013270199,
                                     0.018236991,
                                     0.020036701,
                                     0.018978633,
                                     0.016830673],
                             'max_mae': 0.020036701,
                             'max_mse': 0.0006272451,
                             'max_rmse': 0.025044862,
                             'median_distance': 2.189767,
                             'median_mae': 0.016830673,
                             'min_cosine': 0.22150944,
                             'mse': [0.0003872383,
                                     0.0006108163,
                                     0.0005075031,
                                     0.00041695996,
                                     0.00047950787,
                                     0.00036319596,
                                     0.0003557844,
                                     0.0005323883,
                                     0.0006272451,
                                     0.0005663711,
                                     0.0004724926],
                             'rmse': [0.019678371,
                                      0.024714697,
                                      0.022527829,
                                      0.020419598,
                                      0.021897668,
                                      0.0190577,
                                      0.018862247,
                                      0.023073541,
                                      0.025044862,
                                      0.023798551,
                                      0.021736896]},
 'residuals': {'mae': 0.016581155359745026,
               'mse': 0.0004835911968257278,
               'psnr': 8.197175025939941,
               'rmse': 0.021990707144141197,
               'ssds': [56.87184, 3.3369234],
               'ssim': 0.12163029611110687},
 'spectra_pcagan': {'cosine': [0.99116933,
                               0.9842978,
                               0.96088547,
                               0.95188564,
                               0.95586,
                               0.972211,
                               0.975154,
                               0.93962836,
                               0.9159561,
                               0.91690403,
                               0.9272211],
                    'mae': [0.071225174,
                            0.07258539,
                            0.06246844,
                            0.06437354,
                            0.045106705,
                            0.042673133,
                            0.03895635,
                            0.054263283,
                            0.06242841,
                            0.059908032,
                            0.05496742],
                    'max_mae': 0.07258539,
                    'max_mse': 0.007976555,
                    'max_rmse': 0.08931156,
                    'median_mae': 0.059908032,
                    'min_cosine': 0.9159561,
                    'mse': [0.0075000906,
                            0.007976555,
                            0.005692697,
                            0.006373456,
                            0.0031035342,
                            0.0027325316,
                            0.0024625135,
                            0.004419792,
                            0.0059709065,
                            0.005377533,
                            0.004768304],
                    'rmse': [0.08660306,
                             0.08931156,
                             0.075449966,
                             0.07983393,
                             0.055709373,
                             0.052273624,
                             0.04962372,
                             0.066481516,
                             0.07727164,
                             0.07333166,
                             0.069052905]},
 'spectra_realgan': {'cosine': [0.99050224,
                                0.98320454,
                                0.958425,
                                0.9485156,
                                0.95228004,
                                0.96986884,
                                0.97265184,
                                0.9365318,
                                0.912984,
                                0.91408354,
                                0.92231876],
                     'mae': [0.073525995,
                             0.07423982,
                             0.06392931,
                             0.066407725,
                             0.046533234,
                             0.044256676,
                             0.041072655,
                             0.05594315,
                             0.06368616,
                             0.06099438,
                             0.056844275],
                     'max_mae': 0.07423982,
                     'max_mse': 0.00842498,
                     'max_rmse': 0.09178769,
                     'median_mae': 0.06099438,
                     'min_cosine': 0.912984,
                     'mse': [0.008046477,
                             0.00842498,
                             0.0059988564,
                             0.0067990287,
                             0.0033501007,
                             0.0030101966,
                             0.0027172633,
                             0.004679983,
                             0.006192801,
                             0.005587246,
                             0.0051254076],
                     'rmse': [0.08970216,
                              0.09178769,
                              0.07745229,
                              0.08245622,
                              0.057880055,
                              0.05486526,
                              0.052127376,
                              0.068410404,
                              0.07869435,
                              0.07474788,
                              0.07159195]},
 'spectra_realpca': {'cosine': [0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349],
                     'mae': [0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197],
                     'max_mae': 0.015567541,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.012521197,
                     'min_cosine': 0.9963109,
                     'mse': [0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102],
                     'rmse': [0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_50.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115
Directory path: experiments/inpainting/gann_4_night_20180722_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_50.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_50.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.22363691969865, 3.112562869251242],
                   'kl_div': 0.6277143,
                   'ks_tests': {10000: KstestResult(statistic=0.2463, pvalue=1.333544814897419e-266, statistic_location=0.008353364, statistic_sign=1),
                                20000: KstestResult(statistic=0.254, pvalue=0.0, statistic_location=0.008312529, statistic_sign=1),
                                30000: KstestResult(statistic=0.2513333333333333, pvalue=0.0, statistic_location=0.007647346, statistic_sign=1),
                                40000: KstestResult(statistic=0.255, pvalue=0.0, statistic_location=0.008010626, statistic_sign=1),
                                50000: KstestResult(statistic=0.25346, pvalue=0.0, statistic_location=0.008395769, statistic_sign=1),
                                60000: KstestResult(statistic=0.25336666666666663, pvalue=0.0, statistic_location=0.008108371, statistic_sign=1),
                                70000: KstestResult(statistic=0.2551428571428571, pvalue=0.0, statistic_location=0.00862372, statistic_sign=1),
                                80000: KstestResult(statistic=0.2522875, pvalue=0.0, statistic_location=0.008437588, statistic_sign=1),
                                90000: KstestResult(statistic=0.2531111111111112, pvalue=0.0, statistic_location=0.008374821, statistic_sign=1),
                                100000: KstestResult(statistic=0.25116000000000005, pvalue=0.0, statistic_location=0.008376581, statistic_sign=1),
                                110000: KstestResult(statistic=0.2520363636363636, pvalue=0.0, statistic_location=0.00848617, statistic_sign=1),
                                120000: KstestResult(statistic=0.25212500000000004, pvalue=0.0, statistic_location=0.008061857, statistic_sign=1),
                                130000: KstestResult(statistic=0.2537615384615385, pvalue=0.0, statistic_location=0.008400353, statistic_sign=1),
                                140000: KstestResult(statistic=0.2521214285714285, pvalue=0.0, statistic_location=0.008533411, statistic_sign=1),
                                150000: KstestResult(statistic=0.2514466666666666, pvalue=0.0, statistic_location=0.008542703, statistic_sign=1),
                                160000: KstestResult(statistic=0.2547250000000001, pvalue=0.0, statistic_location=0.008581464, statistic_sign=1),
                                170000: KstestResult(statistic=0.25416470588235296, pvalue=0.0, statistic_location=0.008377151, statistic_sign=1),
                                180000: KstestResult(statistic=0.2547277777777778, pvalue=0.0, statistic_location=0.008496898, statistic_sign=1),
                                190000: KstestResult(statistic=0.25531052631578954, pvalue=0.0, statistic_location=0.008586083, statistic_sign=1),
                                200000: KstestResult(statistic=0.25194000000000005, pvalue=0.0, statistic_location=0.008374821, statistic_sign=1),
                                210000: KstestResult(statistic=0.253395238095238, pvalue=0.0, statistic_location=0.008400518, statistic_sign=1),
                                220000: KstestResult(statistic=0.25422727272727275, pvalue=0.0, statistic_location=0.0085856635, statistic_sign=1)},
                   'moments': {'mean_error': 0.0038906129,
                               'means': [-0.00054423965, -5.0476283e-05],
                               'stds': [0.019667108, 0.0054564234],
                               'variance_ratio': 8.458123}},
 'originals': {'gan': {'mae': 0.05455929413437843,
                       'mse': 0.004739472642540932,
                       'psnr': 27.725784301757812,
                       'rmse': 0.06884382665157318,
                       'ssim': 0.6566916704177856},
               'pca': {'mae': 0.013096767477691174,
                       'mse': 0.00027656604652293026,
                       'psnr': 40.53063201904297,
                       'rmse': 0.016630275174975395,
                       'ssim': 0.9780802726745605}},
 'reconstructions': {'mae': 0.05278368294239044,
                     'mse': 0.004443435464054346,
                     'psnr': 28.471435546875,
                     'rmse': 0.0666591003537178,
                     'ssim': 0.6628926396369934},
 'residual_spectra_pcagan': {'cosine': [0.28260374,
                                        0.25427267,
                                        0.268355,
                                        0.29584593,
                                        0.23188978,
                                        0.28962916,
                                        0.25852224,
                                        0.26286912,
                                        0.29332796,
                                        0.2820993,
                                        0.37338552,
                                        0.32056358,
                                        0.26874948,
                                        0.25312474,
                                        0.2513672,
                                        0.27952856,
                                        0.23953755,
                                        0.28502464,
                                        0.30253372,
                                        0.32720825,
                                        0.27045548,
                                        0.29371408],
                             'mae': [0.010502031,
                                     0.010798579,
                                     0.010070845,
                                     0.010413214,
                                     0.012834576,
                                     0.012951301,
                                     0.0151773235,
                                     0.014890109,
                                     0.013906689,
                                     0.012997799,
                                     0.012823609,
                                     0.011811436,
                                     0.016060349,
                                     0.017822467,
                                     0.016626589,
                                     0.01516656,
                                     0.016007427,
                                     0.013797997,
                                     0.013872792,
                                     0.012407163,
                                     0.016223252,
                                     0.01292536],
                             'max_mae': 0.017822467,
                             'max_mse': 0.0005019679,
                             'max_rmse': 0.02240464,
                             'median_distance': 1.8121607,
                             'median_mae': 0.013397898,
                             'min_cosine': 0.23188978,
                             'mse': [0.00025930666,
                                     0.00030546763,
                                     0.00030148434,
                                     0.00024392085,
                                     0.00033087173,
                                     0.0003042353,
                                     0.0004983933,
                                     0.0003948954,
                                     0.00032153615,
                                     0.00038831035,
                                     0.0002838249,
                                     0.00029352694,
                                     0.00043116504,
                                     0.0005019679,
                                     0.00044528552,
                                     0.0003979254,
                                     0.00041768374,
                                     0.00035424353,
                                     0.0003210409,
                                     0.00029152032,
                                     0.00044081043,
                                     0.0003259229],
                             'rmse': [0.016103001,
                                      0.017477632,
                                      0.017363304,
                                      0.015617966,
                                      0.01818988,
                                      0.017442342,
                                      0.022324724,
                                      0.019871976,
                                      0.01793143,
                                      0.019705592,
                                      0.016847104,
                                      0.017132629,
                                      0.020764515,
                                      0.02240464,
                                      0.02110179,
                                      0.019948067,
                                      0.020437313,
                                      0.018821359,
                                      0.017917614,
                                      0.017073967,
                                      0.020995487,
                                      0.018053336]},
 'residuals': {'mae': 0.013640339486300945,
               'mse': 0.0003569700347725302,
               'psnr': 20.099227905273438,
               'rmse': 0.0188936498016119,
               'ssds': [85.1597, 6.550493],
               'ssim': 0.16781511902809143},
 'spectra_pcagan': {'cosine': [0.9902773,
                               0.99058205,
                               0.98593557,
                               0.98166245,
                               0.98475355,
                               0.99134403,
                               0.98469067,
                               0.9618693,
                               0.9533671,
                               0.9566785,
                               0.97290313,
                               0.9757846,
                               0.94132704,
                               0.91703165,
                               0.91814286,
                               0.9270977,
                               0.9028449,
                               0.9609457,
                               0.9464992,
                               0.9642788,
                               0.9262062,
                               0.9555533],
                    'mae': [0.04954987,
                            0.04831482,
                            0.04154204,
                            0.037994385,
                            0.056879994,
                            0.070389315,
                            0.07150371,
                            0.061738495,
                            0.06303579,
                            0.044605147,
                            0.042243615,
                            0.038479164,
                            0.05336855,
                            0.06202688,
                            0.0593197,
                            0.054996807,
                            0.06251957,
                            0.0451165,
                            0.05207317,
                            0.041342534,
                            0.058123376,
                            0.046077438],
                    'max_mae': 0.07150371,
                    'max_mse': 0.007799086,
                    'max_rmse': 0.08831243,
                    'median_mae': 0.05272086,
                    'min_cosine': 0.9028449,
                    'mse': [0.0040059844,
                            0.0040321765,
                            0.0028679508,
                            0.0023258596,
                            0.0047913417,
                            0.0073422515,
                            0.007799086,
                            0.005567095,
                            0.0061341664,
                            0.0030706367,
                            0.0026718352,
                            0.002433345,
                            0.004295135,
                            0.0059063034,
                            0.0053027747,
                            0.0047799936,
                            0.006218094,
                            0.0031185155,
                            0.00393515,
                            0.00280235,
                            0.00520777,
                            0.003147773],
                    'rmse': [0.063292846,
                             0.06349942,
                             0.053553253,
                             0.04822717,
                             0.069219515,
                             0.08568694,
                             0.08831243,
                             0.07461297,
                             0.07832092,
                             0.055413324,
                             0.0516898,
                             0.049328946,
                             0.06553728,
                             0.07685248,
                             0.07282016,
                             0.0691375,
                             0.07885489,
                             0.05584367,
                             0.062730774,
                             0.05293723,
                             0.07216488,
                             0.056105018]},
 'spectra_realgan': {'cosine': [0.9896691,
                                0.9898579,
                                0.98456603,
                                0.9791487,
                                0.983875,
                                0.9906742,
                                0.9836056,
                                0.95940924,
                                0.950004,
                                0.9531188,
                                0.9706316,
                                0.9733282,
                                0.93827266,
                                0.91403544,
                                0.91530865,
                                0.92216086,
                                0.9011053,
                                0.9585088,
                                0.94279194,
                                0.9608301,
                                0.92520034,
                                0.95235986],
                     'mae': [0.05091956,
                             0.05065085,
                             0.044404034,
                             0.041118804,
                             0.058669947,
                             0.07273627,
                             0.07316233,
                             0.063168325,
                             0.06512662,
                             0.046040375,
                             0.04382759,
                             0.040590435,
                             0.05506352,
                             0.06331624,
                             0.060418434,
                             0.056880366,
                             0.06340985,
                             0.046374947,
                             0.05363102,
                             0.043673262,
                             0.059573457,
                             0.04754814],
                     'max_mae': 0.07316233,
                     'max_mse': 0.008238449,
                     'max_rmse': 0.0907659,
                     'median_mae': 0.05434727,
                     'min_cosine': 0.9011053,
                     'mse': [0.0042169,
                             0.00437998,
                             0.003240988,
                             0.0026799885,
                             0.0051155905,
                             0.007887149,
                             0.008238449,
                             0.005872001,
                             0.006557111,
                             0.0033155568,
                             0.0029443847,
                             0.0026845408,
                             0.004551976,
                             0.006129314,
                             0.005513082,
                             0.0051394324,
                             0.0063526644,
                             0.0033178928,
                             0.004240858,
                             0.0030703791,
                             0.005419961,
                             0.0034001968],
                     'rmse': [0.064937666,
                              0.066181414,
                              0.056929674,
                              0.051768605,
                              0.07152335,
                              0.088809624,
                              0.0907659,
                              0.07662898,
                              0.080975994,
                              0.057580873,
                              0.054262184,
                              0.051812556,
                              0.06746833,
                              0.07828993,
                              0.07425013,
                              0.07168984,
                              0.07970361,
                              0.057601154,
                              0.06512187,
                              0.055411004,
                              0.07362039,
                              0.058311205]},
 'spectra_realpca': {'cosine': [0.99914396,
                                0.9992311,
                                0.9983727,
                                0.9974544,
                                0.99898773,
                                0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349,
                                0.99650675,
                                0.9971242,
                                0.9965543,
                                0.9968424,
                                0.9962396,
                                0.99634945],
                     'mae': [0.014836307,
                             0.01447966,
                             0.013651306,
                             0.013377094,
                             0.014316244,
                             0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197,
                             0.012154227,
                             0.011967489,
                             0.012771271,
                             0.012152725,
                             0.013049042,
                             0.0125535],
                     'max_mae': 0.015567541,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.012704127,
                     'min_cosine': 0.9962396,
                     'mse': [0.00034976797,
                             0.00033549307,
                             0.00029904975,
                             0.00028346918,
                             0.00032609524,
                             0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102,
                             0.00023534271,
                             0.00023139741,
                             0.00026069232,
                             0.00023610053,
                             0.0002807898,
                             0.0002510656],
                     'rmse': [0.018702084,
                              0.01831647,
                              0.017293055,
                              0.016836543,
                              0.018058106,
                              0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779,
                              0.015340883,
                              0.015211753,
                              0.016145969,
                              0.015365563,
                              0.016756784,
                              0.01584505]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_50.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453
Directory path: experiments/inpainting/gann_4_night_20180722_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_50.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_50.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.111089078084709, 3.1001794530905693],
                   'kl_div': 0.49720812,
                   'ks_tests': {10000: KstestResult(statistic=0.2263, pvalue=9.216889251324466e-225, statistic_location=0.0075661354, statistic_sign=1),
                                20000: KstestResult(statistic=0.21739999999999993, pvalue=0.0, statistic_location=0.0074811876, statistic_sign=1),
                                30000: KstestResult(statistic=0.21596666666666675, pvalue=0.0, statistic_location=0.007445179, statistic_sign=1),
                                40000: KstestResult(statistic=0.221375, pvalue=0.0, statistic_location=0.0071665766, statistic_sign=1),
                                50000: KstestResult(statistic=0.2166800000000001, pvalue=0.0, statistic_location=0.008020271, statistic_sign=1),
                                60000: KstestResult(statistic=0.21606666666666663, pvalue=0.0, statistic_location=0.007550083, statistic_sign=1),
                                70000: KstestResult(statistic=0.21920000000000006, pvalue=0.0, statistic_location=0.0076101194, statistic_sign=1),
                                80000: KstestResult(statistic=0.2204750000000001, pvalue=0.0, statistic_location=0.008371812, statistic_sign=1),
                                90000: KstestResult(statistic=0.21573333333333333, pvalue=0.0, statistic_location=0.007844271, statistic_sign=1),
                                100000: KstestResult(statistic=0.21628000000000003, pvalue=0.0, statistic_location=0.007794395, statistic_sign=1),
                                110000: KstestResult(statistic=0.21755454545454544, pvalue=0.0, statistic_location=0.0074388147, statistic_sign=1),
                                120000: KstestResult(statistic=0.22073333333333334, pvalue=0.0, statistic_location=0.0074323397, statistic_sign=1),
                                130000: KstestResult(statistic=0.21973076923076929, pvalue=0.0, statistic_location=0.0075245555, statistic_sign=1),
                                140000: KstestResult(statistic=0.2152571428571428, pvalue=0.0, statistic_location=0.0077838176, statistic_sign=1),
                                150000: KstestResult(statistic=0.21919333333333335, pvalue=0.0, statistic_location=0.0075806426, statistic_sign=1),
                                160000: KstestResult(statistic=0.2180875, pvalue=0.0, statistic_location=0.007854266, statistic_sign=1),
                                170000: KstestResult(statistic=0.21709411764705888, pvalue=0.0, statistic_location=0.0075296247, statistic_sign=1),
                                180000: KstestResult(statistic=0.21776666666666666, pvalue=0.0, statistic_location=0.007497309, statistic_sign=1),
                                190000: KstestResult(statistic=0.21765789473684205, pvalue=0.0, statistic_location=0.0075318264, statistic_sign=1),
                                200000: KstestResult(statistic=0.21883999999999992, pvalue=0.0, statistic_location=0.007870501, statistic_sign=1),
                                210000: KstestResult(statistic=0.21783333333333332, pvalue=0.0, statistic_location=0.007433122, statistic_sign=1),
                                220000: KstestResult(statistic=0.21804999999999997, pvalue=0.0, statistic_location=0.007923212, statistic_sign=1),
                                230000: KstestResult(statistic=0.21554782608695655, pvalue=0.0, statistic_location=0.0078147575, statistic_sign=1),
                                240000: KstestResult(statistic=0.21753333333333336, pvalue=0.0, statistic_location=0.007814433, statistic_sign=1),
                                250000: KstestResult(statistic=0.21788400000000008, pvalue=0.0, statistic_location=0.0078630345, statistic_sign=1),
                                260000: KstestResult(statistic=0.21865, pvalue=0.0, statistic_location=0.007550083, statistic_sign=1),
                                270000: KstestResult(statistic=0.21694814814814822, pvalue=0.0, statistic_location=0.007530064, statistic_sign=1),
                                280000: KstestResult(statistic=0.21823928571428575, pvalue=0.0, statistic_location=0.007507796, statistic_sign=1),
                                290000: KstestResult(statistic=0.21792758620689656, pvalue=0.0, statistic_location=0.0075245374, statistic_sign=1),
                                300000: KstestResult(statistic=0.21852666666666665, pvalue=0.0, statistic_location=0.007864193, statistic_sign=1),
                                310000: KstestResult(statistic=0.21812903225806446, pvalue=0.0, statistic_location=0.007519443, statistic_sign=1),
                                320000: KstestResult(statistic=0.21713749999999998, pvalue=0.0, statistic_location=0.007600807, statistic_sign=1),
                                330000: KstestResult(statistic=0.21784545454545456, pvalue=0.0, statistic_location=0.007519409, statistic_sign=1)},
                   'moments': {'mean_error': -0.0042404295,
                               'means': [-0.00039863147, -2.1693977e-05],
                               'stds': [0.017679268, 0.005385532],
                               'variance_ratio': 8.627582}},
 'originals': {'gan': {'mae': 0.05171003192663193,
                       'mse': 0.004362098407000303,
                       'psnr': 28.81952667236328,
                       'rmse': 0.06604618579149246,
                       'ssim': 0.7228677272796631},
               'pca': {'mae': 0.013429644517600536,
                       'mse': 0.00029108254238963127,
                       'psnr': 40.7747917175293,
                       'rmse': 0.01706114038825035,
                       'ssim': 0.9816524982452393}},
 'reconstructions': {'mae': 0.04971151053905487,
                     'mse': 0.004055059049278498,
                     'psnr': 29.33498191833496,
                     'rmse': 0.06367934495210648,
                     'ssim': 0.7297914624214172},
 'residual_spectra_pcagan': {'cosine': [0.43865642,
                                        0.24162422,
                                        0.33851382,
                                        0.2904345,
                                        0.31440586,
                                        0.27107003,
                                        0.29740414,
                                        0.26412457,
                                        0.30329663,
                                        0.31571752,
                                        0.2341939,
                                        0.30094036,
                                        0.27264938,
                                        0.28328276,
                                        0.31187657,
                                        0.30602232,
                                        0.39502403,
                                        0.35032323,
                                        0.28461316,
                                        0.2715893,
                                        0.27236634,
                                        0.28819954,
                                        0.25545248,
                                        0.30801818,
                                        0.32594854,
                                        0.35910082,
                                        0.2935288,
                                        0.30909878,
                                        0.3610874,
                                        0.37976265,
                                        0.32860368,
                                        0.33697698,
                                        0.28380537],
                             'mae': [0.010307829,
                                     0.011543067,
                                     0.009078416,
                                     0.009397869,
                                     0.009183342,
                                     0.010454051,
                                     0.0099123595,
                                     0.010413985,
                                     0.009421885,
                                     0.010166941,
                                     0.012307652,
                                     0.012033404,
                                     0.014177274,
                                     0.01385857,
                                     0.012729086,
                                     0.011991444,
                                     0.011697062,
                                     0.011068564,
                                     0.014922364,
                                     0.016551461,
                                     0.015271266,
                                     0.014176084,
                                     0.014681517,
                                     0.012756438,
                                     0.012809018,
                                     0.011260095,
                                     0.014887729,
                                     0.01216543,
                                     0.009162823,
                                     0.009436313,
                                     0.009196771,
                                     0.009405595,
                                     0.011066853],
                             'max_mae': 0.016551461,
                             'max_mse': 0.0004356272,
                             'max_rmse': 0.020871684,
                             'median_distance': 1.6654694,
                             'median_mae': 0.011543067,
                             'min_cosine': 0.2341939,
                             'mse': [0.00020070293,
                                     0.000314841,
                                     0.00018760165,
                                     0.00023998735,
                                     0.00018848691,
                                     0.00030048433,
                                     0.00024126201,
                                     0.0002852728,
                                     0.00024048776,
                                     0.00021730617,
                                     0.00032217198,
                                     0.00026426348,
                                     0.00043222724,
                                     0.0003413647,
                                     0.00027737874,
                                     0.00032536022,
                                     0.00023890019,
                                     0.0002495822,
                                     0.00038487438,
                                     0.0004356272,
                                     0.00037485873,
                                     0.00036444768,
                                     0.00036045545,
                                     0.00030593012,
                                     0.00027573522,
                                     0.00023915702,
                                     0.00037236547,
                                     0.00028663193,
                                     0.00018535437,
                                     0.00018155565,
                                     0.00020665588,
                                     0.00022121977,
                                     0.0002972659],
                             'rmse': [0.014166966,
                                      0.017743759,
                                      0.013696775,
                                      0.015491525,
                                      0.013729054,
                                      0.017334484,
                                      0.015532611,
                                      0.016890021,
                                      0.015507667,
                                      0.014741308,
                                      0.017949149,
                                      0.016256183,
                                      0.020790076,
                                      0.018476058,
                                      0.01665469,
                                      0.018037744,
                                      0.015456396,
                                      0.01579817,
                                      0.019618215,
                                      0.020871684,
                                      0.019361269,
                                      0.019090513,
                                      0.018985664,
                                      0.017490858,
                                      0.016605277,
                                      0.015464703,
                                      0.019296773,
                                      0.016930208,
                                      0.013614491,
                                      0.013474259,
                                      0.01437553,
                                      0.014873459,
                                      0.017241402]},
 'residuals': {'mae': 0.011742199771106243,
               'mse': 0.00028363082674331963,
               'psnr': 21.098011016845703,
               'rmse': 0.01684134267270565,
               'ssds': [103.19576, 9.571429],
               'ssim': 0.22103337943553925},
 'spectra_pcagan': {'cosine': [0.9963698,
                               0.99438685,
                               0.9956266,
                               0.9947156,
                               0.9958619,
                               0.9941898,
                               0.99029875,
                               0.99031955,
                               0.9854418,
                               0.9806126,
                               0.9842539,
                               0.99106264,
                               0.98436266,
                               0.9612392,
                               0.95402,
                               0.95667464,
                               0.9732843,
                               0.9759182,
                               0.9413496,
                               0.9185366,
                               0.9188191,
                               0.92797846,
                               0.90390915,
                               0.9617075,
                               0.94762224,
                               0.9649784,
                               0.9271132,
                               0.9554265,
                               0.9740822,
                               0.9776025,
                               0.98743755,
                               0.98771983,
                               0.9894869],
                    'mae': [0.02895067,
                            0.04266675,
                            0.049023084,
                            0.048572775,
                            0.056023497,
                            0.061252892,
                            0.0495633,
                            0.04903637,
                            0.042492125,
                            0.03926784,
                            0.057685602,
                            0.071342446,
                            0.07214283,
                            0.062262837,
                            0.062302727,
                            0.04457293,
                            0.04187726,
                            0.038644116,
                            0.053261742,
                            0.06150753,
                            0.059135124,
                            0.054507904,
                            0.062075067,
                            0.044807233,
                            0.0516789,
                            0.041154943,
                            0.057749476,
                            0.046301115,
                            0.03875649,
                            0.0349078,
                            0.036869936,
                            0.038954005,
                            0.04113254],
                    'max_mae': 0.07214283,
                    'max_mse': 0.0079698,
                    'max_rmse': 0.089273736,
                    'median_mae': 0.049023084,
                    'min_cosine': 0.90390915,
                    'mse': [0.0012863175,
                            0.003211473,
                            0.0038858878,
                            0.0039039506,
                            0.004709052,
                            0.006123947,
                            0.0039803,
                            0.0041435203,
                            0.0029436299,
                            0.0024493064,
                            0.004946753,
                            0.0075787306,
                            0.0079698,
                            0.0056669,
                            0.0060025654,
                            0.0030856284,
                            0.0026376077,
                            0.0024500329,
                            0.004291196,
                            0.005813097,
                            0.0052758013,
                            0.0047103073,
                            0.0061652604,
                            0.0030924445,
                            0.0038729415,
                            0.0027854885,
                            0.0051631485,
                            0.0031829113,
                            0.0024941468,
                            0.0020058854,
                            0.0023234044,
                            0.002516884,
                            0.0031486047],
                    'rmse': [0.03586527,
                             0.05666986,
                             0.06233689,
                             0.0624816,
                             0.06862253,
                             0.07825565,
                             0.06308962,
                             0.064370185,
                             0.05425523,
                             0.049490467,
                             0.07033315,
                             0.08705591,
                             0.089273736,
                             0.07527881,
                             0.077476226,
                             0.055548433,
                             0.051357646,
                             0.049497806,
                             0.06550722,
                             0.07624367,
                             0.07263471,
                             0.06863168,
                             0.07851917,
                             0.05560975,
                             0.06223296,
                             0.052777726,
                             0.07185505,
                             0.056417298,
                             0.049941435,
                             0.044787113,
                             0.048201706,
                             0.050168555,
                             0.056112427]},
 'spectra_realgan': {'cosine': [0.99594945,
                                0.993599,
                                0.9950832,
                                0.9941495,
                                0.9954565,
                                0.99380606,
                                0.9896941,
                                0.98959345,
                                0.9840586,
                                0.9780391,
                                0.98338234,
                                0.99038804,
                                0.983271,
                                0.9587497,
                                0.95064867,
                                0.95316404,
                                0.97102016,
                                0.97345513,
                                0.93828213,
                                0.9155233,
                                0.9159966,
                                0.92306614,
                                0.90216774,
                                0.95925295,
                                0.9439704,
                                0.96156967,
                                0.92616457,
                                0.95225024,
                                0.9714461,
                                0.9741205,
                                0.98563623,
                                0.98602635,
                                0.98827475],
                     'mae': [0.030195968,
                             0.04384645,
                             0.05171915,
                             0.051315956,
                             0.0585284,
                             0.064356156,
                             0.05100211,
                             0.051354375,
                             0.045245912,
                             0.04232188,
                             0.059441272,
                             0.07366079,
                             0.073836826,
                             0.063720815,
                             0.06439157,
                             0.04602444,
                             0.04345906,
                             0.040787138,
                             0.05499627,
                             0.062789485,
                             0.06026786,
                             0.056387287,
                             0.0629972,
                             0.04607277,
                             0.05318295,
                             0.04348565,
                             0.059214,
                             0.047780782,
                             0.041187927,
                             0.037686408,
                             0.039182164,
                             0.041614648,
                             0.04437734],
                     'max_mae': 0.073836826,
                     'max_mse': 0.008408905,
                     'max_rmse': 0.091700085,
                     'median_mae': 0.051315956,
                     'min_cosine': 0.90216774,
                     'mse': [0.0013965998,
                             0.0033654594,
                             0.0043091304,
                             0.0043066847,
                             0.0051687118,
                             0.00663488,
                             0.004193502,
                             0.0044916635,
                             0.0033190364,
                             0.002811561,
                             0.005270784,
                             0.008125987,
                             0.008408905,
                             0.005973664,
                             0.0064246827,
                             0.0033273175,
                             0.0029098277,
                             0.0027023253,
                             0.0045493,
                             0.0060367663,
                             0.005485335,
                             0.0050676977,
                             0.006299948,
                             0.0032926055,
                             0.0041749026,
                             0.0030507362,
                             0.0053743967,
                             0.0034350727,
                             0.0027860254,
                             0.0022955164,
                             0.0025833887,
                             0.0028579237,
                             0.0035189064],
                     'rmse': [0.03737111,
                              0.05801258,
                              0.065643966,
                              0.06562533,
                              0.07189375,
                              0.08145477,
                              0.06475726,
                              0.06701987,
                              0.057611078,
                              0.053024154,
                              0.07260016,
                              0.090144254,
                              0.091700085,
                              0.077289484,
                              0.08015412,
                              0.057682905,
                              0.05394282,
                              0.051983897,
                              0.0674485,
                              0.07769663,
                              0.07406305,
                              0.071187764,
                              0.07937221,
                              0.05738123,
                              0.064613484,
                              0.05523347,
                              0.07331028,
                              0.058609493,
                              0.052782815,
                              0.047911547,
                              0.05082705,
                              0.05345955,
                              0.05932037]},
 'spectra_realpca': {'cosine': [0.99945366,
                                0.99925643,
                                0.99947244,
                                0.99940675,
                                0.9995555,
                                0.99957067,
                                0.99914396,
                                0.9992311,
                                0.9983727,
                                0.9974544,
                                0.99898773,
                                0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349,
                                0.99650675,
                                0.9971242,
                                0.9965543,
                                0.9968424,
                                0.9962396,
                                0.99634945,
                                0.99715966,
                                0.99691385,
                                0.9982245,
                                0.99834263,
                                0.9988524],
                     'mae': [0.011083274,
                             0.014802759,
                             0.015157819,
                             0.015070052,
                             0.015472084,
                             0.015633475,
                             0.014836307,
                             0.01447966,
                             0.013651306,
                             0.013377094,
                             0.014316244,
                             0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197,
                             0.012154227,
                             0.011967489,
                             0.012771271,
                             0.012152725,
                             0.013049042,
                             0.0125535,
                             0.013193458,
                             0.0130807385,
                             0.013555716,
                             0.013718692,
                             0.014281331],
                     'max_mae': 0.015633475,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.013377094,
                     'min_cosine': 0.9962396,
                     'mse': [0.00019629093,
                             0.00035259564,
                             0.00036871652,
                             0.00035998295,
                             0.00038198216,
                             0.00038844542,
                             0.00034976797,
                             0.00033549307,
                             0.00029904975,
                             0.00028346918,
                             0.00032609524,
                             0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102,
                             0.00023534271,
                             0.00023139741,
                             0.00026069232,
                             0.00023610053,
                             0.0002807898,
                             0.0002510656,
                             0.00027758113,
                             0.00027334486,
                             0.00029565947,
                             0.00030083008,
                             0.0003258427],
                     'rmse': [0.014010387,
                              0.01877753,
                              0.019201992,
                              0.018973216,
                              0.019544363,
                              0.019709019,
                              0.018702084,
                              0.01831647,
                              0.017293055,
                              0.016836543,
                              0.018058106,
                              0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779,
                              0.015340883,
                              0.015211753,
                              0.016145969,
                              0.015365563,
                              0.016756784,
                              0.01584505,
                              0.016660767,
                              0.016533144,
                              0.017194752,
                              0.017344454,
                              0.018051114]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_50.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957
Directory path: experiments/inpainting/gann_4_night_20180723_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_50.0/images
Optimal number of principal components:  1
Reconstruction error:  37.32791
Energy conservation:  0.5564905
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_50.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.075287224842861, 3.4964184850129745],
                   'kl_div': 0.20606722,
                   'ks_tests': {10000: KstestResult(statistic=0.1565, pvalue=3.158007085297466e-107, statistic_location=0.010485123, statistic_sign=1),
                                20000: KstestResult(statistic=0.15105000000000002, pvalue=1.164278824303083e-199, statistic_location=0.009468357, statistic_sign=1),
                                30000: KstestResult(statistic=0.15016666666666667, pvalue=9.350008762353623e-296, statistic_location=0.010319568, statistic_sign=1),
                                40000: KstestResult(statistic=0.15239999999999998, pvalue=0.0, statistic_location=0.01034932, statistic_sign=1),
                                50000: KstestResult(statistic=0.1483, pvalue=0.0, statistic_location=0.010191342, statistic_sign=1),
                                60000: KstestResult(statistic=0.14951666666666674, pvalue=0.0, statistic_location=0.009502736, statistic_sign=1),
                                70000: KstestResult(statistic=0.15021428571428574, pvalue=0.0, statistic_location=0.010313424, statistic_sign=1),
                                80000: KstestResult(statistic=0.14974999999999994, pvalue=0.0, statistic_location=0.010050551, statistic_sign=1),
                                90000: KstestResult(statistic=0.14788888888888885, pvalue=0.0, statistic_location=0.010345777, statistic_sign=1),
                                100000: KstestResult(statistic=0.15151000000000003, pvalue=0.0, statistic_location=0.010207238, statistic_sign=1),
                                110000: KstestResult(statistic=0.14790909090909088, pvalue=0.0, statistic_location=0.010023662, statistic_sign=1)},
                   'moments': {'mean_error': 0.07655598,
                               'means': [0.00018858185, 7.818885e-05],
                               'stds': [0.018317485, 0.007997076],
                               'variance_ratio': 4.478869}},
 'originals': {'gan': {'mae': 0.039080649614334106,
                       'mse': 0.0029828031547367573,
                       'psnr': 25.586721420288086,
                       'rmse': 0.054615046828985214,
                       'ssim': 0.6815907955169678},
               'pca': {'mae': 0.015239655040204525,
                       'mse': 0.0003732801997102797,
                       'psnr': 34.66868209838867,
                       'rmse': 0.01932046003639698,
                       'ssim': 0.9052591919898987}},
 'reconstructions': {'mae': 0.03522789478302002,
                     'mse': 0.0026523121632635593,
                     'psnr': 26.152782440185547,
                     'rmse': 0.051500603556632996,
                     'ssim': 0.7235210537910461},
 'residual_spectra_pcagan': {'cosine': [0.49722892,
                                        0.3240914,
                                        0.4364389,
                                        0.44185713,
                                        0.37728757,
                                        0.44706908,
                                        0.4521612,
                                        0.43837196,
                                        0.4147927,
                                        0.43419728,
                                        0.41694158],
                             'mae': [0.009953221,
                                     0.011259149,
                                     0.0109881675,
                                     0.009651379,
                                     0.010863328,
                                     0.010445458,
                                     0.010327345,
                                     0.011400976,
                                     0.011446331,
                                     0.010200861,
                                     0.011071397],
                             'max_mae': 0.011446331,
                             'max_mse': 0.00041735388,
                             'max_rmse': 0.02042924,
                             'median_distance': 1.6050719,
                             'median_mae': 0.010863328,
                             'min_cosine': 0.3240914,
                             'mse': [0.0002065896,
                                     0.00041735388,
                                     0.0002576256,
                                     0.0002180222,
                                     0.00035156336,
                                     0.0002257124,
                                     0.00024340535,
                                     0.00027091225,
                                     0.00030462252,
                                     0.0002574948,
                                     0.00028478488],
                             'rmse': [0.014373225,
                                      0.02042924,
                                      0.016050719,
                                      0.0147655755,
                                      0.018750023,
                                      0.015023728,
                                      0.015601453,
                                      0.016459413,
                                      0.017453438,
                                      0.016046645,
                                      0.01687557]},
 'residuals': {'mae': 0.010691600851714611,
               'mse': 0.00027618970489129424,
               'psnr': 17.64501190185547,
               'rmse': 0.01661895588040352,
               'ssds': [36.911907, 7.035464],
               'ssim': 0.36256638169288635},
 'spectra_pcagan': {'cosine': [0.76163626,
                               0.97629756,
                               0.9786622,
                               0.9838063,
                               0.9794047,
                               0.97732747,
                               0.9818559,
                               0.98232406,
                               0.98810315,
                               0.993833,
                               0.9911037],
                    'mae': [0.12606625,
                            0.033039965,
                            0.028330218,
                            0.023389474,
                            0.026058083,
                            0.028030232,
                            0.026332555,
                            0.027417487,
                            0.025055585,
                            0.020544477,
                            0.02324248],
                    'max_mae': 0.12606625,
                    'max_mse': 0.017294303,
                    'max_rmse': 0.1315078,
                    'median_mae': 0.026332555,
                    'min_cosine': 0.76163626,
                    'mse': [0.017294303,
                            0.0018945434,
                            0.001283867,
                            0.00095048296,
                            0.0012539864,
                            0.0012882113,
                            0.0011364926,
                            0.0012786449,
                            0.0010834228,
                            0.00075091916,
                            0.00096056063],
                    'rmse': [0.1315078,
                             0.04352635,
                             0.03583109,
                             0.030829905,
                             0.03541167,
                             0.03589166,
                             0.033711907,
                             0.035758145,
                             0.032915387,
                             0.027402904,
                             0.030992912]},
 'spectra_realgan': {'cosine': [0.7618132,
                                0.9706433,
                                0.9719446,
                                0.977983,
                                0.97307557,
                                0.9714739,
                                0.97608113,
                                0.977296,
                                0.98441505,
                                0.99123144,
                                0.9883725],
                     'mae': [0.12483563,
                             0.037253868,
                             0.032851625,
                             0.028157623,
                             0.030859664,
                             0.031978235,
                             0.03047882,
                             0.031209778,
                             0.02941755,
                             0.025339656,
                             0.027504697],
                     'max_mae': 0.12483563,
                     'max_mse': 0.017318122,
                     'max_rmse': 0.13159834,
                     'median_mae': 0.030859664,
                     'min_cosine': 0.7618132,
                     'mse': [0.017318122,
                             0.0023279006,
                             0.0017012808,
                             0.001308548,
                             0.0016385578,
                             0.0016354714,
                             0.0015088693,
                             0.0016243889,
                             0.0014303842,
                             0.001063264,
                             0.0012540491],
                     'rmse': [0.13159834,
                              0.04824832,
                              0.041246586,
                              0.036173858,
                              0.0404791,
                              0.04044096,
                              0.03884417,
                              0.040303707,
                              0.03782042,
                              0.03260773,
                              0.035412557]},
 'spectra_realpca': {'cosine': [0.9941098,
                                0.99416333,
                                0.9936037,
                                0.993588,
                                0.99322087,
                                0.9932172,
                                0.9941703,
                                0.99471545,
                                0.99618137,
                                0.99729186,
                                0.9969032],
                     'mae': [0.0153628765,
                             0.016044892,
                             0.015603104,
                             0.015481151,
                             0.015898915,
                             0.01568693,
                             0.015209607,
                             0.014896314,
                             0.014717062,
                             0.014370954,
                             0.014364395],
                     'max_mae': 0.016044892,
                     'max_mse': 0.0004121807,
                     'max_rmse': 0.020302234,
                     'median_mae': 0.0153628765,
                     'min_cosine': 0.9932172,
                     'mse': [0.00038744128,
                             0.0004121807,
                             0.00039086267,
                             0.00038415138,
                             0.00040199846,
                             0.00039318297,
                             0.00037064194,
                             0.00035742685,
                             0.00034816508,
                             0.00032996802,
                             0.00033006273],
                     'rmse': [0.019683529,
                              0.020302234,
                              0.019770248,
                              0.01959978,
                              0.0200499,
                              0.019828841,
                              0.019252064,
                              0.018905737,
                              0.018659182,
                              0.018165022,
                              0.018167628]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_50.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431
Directory path: experiments/inpainting/gann_4_night_20180723_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_50.0/images
Optimal number of principal components:  1
Reconstruction error:  37.32791
Energy conservation:  0.5564905
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_50.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.070708789508587, 3.5066548983187453],
                   'kl_div': 0.19183466,
                   'ks_tests': {10000: KstestResult(statistic=0.1501, pvalue=1.226371728713033e-98, statistic_location=0.009491525, statistic_sign=1),
                                20000: KstestResult(statistic=0.15274999999999994, pvalue=3.4109053464725854e-204, statistic_location=0.009976228, statistic_sign=1),
                                30000: KstestResult(statistic=0.1538666666666667, pvalue=1.4457740605679e-310, statistic_location=0.00972221, statistic_sign=1),
                                40000: KstestResult(statistic=0.15510000000000002, pvalue=0.0, statistic_location=0.009093727, statistic_sign=1),
                                50000: KstestResult(statistic=0.15146000000000004, pvalue=0.0, statistic_location=0.01044211, statistic_sign=1),
                                60000: KstestResult(statistic=0.15098333333333325, pvalue=0.0, statistic_location=0.009606564, statistic_sign=1),
                                70000: KstestResult(statistic=0.14870000000000005, pvalue=0.0, statistic_location=0.009854615, statistic_sign=1),
                                80000: KstestResult(statistic=0.1502, pvalue=0.0, statistic_location=0.009872569, statistic_sign=1),
                                90000: KstestResult(statistic=0.1529111111111111, pvalue=0.0, statistic_location=0.009608941, statistic_sign=1),
                                100000: KstestResult(statistic=0.15264, pvalue=0.0, statistic_location=0.010157409, statistic_sign=1),
                                110000: KstestResult(statistic=0.15171818181818175, pvalue=0.0, statistic_location=0.009990984, statistic_sign=1),
                                120000: KstestResult(statistic=0.152675, pvalue=0.0, statistic_location=0.009593821, statistic_sign=1),
                                130000: KstestResult(statistic=0.15091538461538456, pvalue=0.0, statistic_location=0.009676554, statistic_sign=1),
                                140000: KstestResult(statistic=0.1513714285714286, pvalue=0.0, statistic_location=0.009995241, statistic_sign=1),
                                150000: KstestResult(statistic=0.15047333333333335, pvalue=0.0, statistic_location=0.010133061, statistic_sign=1),
                                160000: KstestResult(statistic=0.1511437499999999, pvalue=0.0, statistic_location=0.010133412, statistic_sign=1),
                                170000: KstestResult(statistic=0.15047647058823532, pvalue=0.0, statistic_location=0.009625094, statistic_sign=1),
                                180000: KstestResult(statistic=0.15059999999999996, pvalue=0.0, statistic_location=0.0096158, statistic_sign=1),
                                190000: KstestResult(statistic=0.15102105263157894, pvalue=0.0, statistic_location=0.009375775, statistic_sign=1),
                                200000: KstestResult(statistic=0.15181499999999992, pvalue=0.0, statistic_location=0.009624515, statistic_sign=1),
                                210000: KstestResult(statistic=0.1500190476190476, pvalue=0.0, statistic_location=0.009375362, statistic_sign=1),
                                220000: KstestResult(statistic=0.1528772727272727, pvalue=0.0, statistic_location=0.009593932, statistic_sign=1)},
                   'moments': {'mean_error': 0.16780457,
                               'means': [0.0011001013, 6.326892e-05],
                               'stds': [0.017806092, 0.00808623],
                               'variance_ratio': 4.192596}},
 'originals': {'gan': {'mae': 0.038087304681539536,
                       'mse': 0.0028102791402488947,
                       'psnr': 27.170915603637695,
                       'rmse': 0.05301206558942795,
                       'ssim': 0.6383501887321472},
               'pca': {'mae': 0.01515172328799963,
                       'mse': 0.0003704703995026648,
                       'psnr': 36.02420425415039,
                       'rmse': 0.01924760825932026,
                       'ssim': 0.9280337691307068}},
 'reconstructions': {'mae': 0.03391638398170471,
                     'mse': 0.0024530470836907625,
                     'psnr': 27.814680099487305,
                     'rmse': 0.04952824488282204,
                     'ssim': 0.6689038872718811},
 'residual_spectra_pcagan': {'cosine': [0.5079951,
                                        0.3937583,
                                        0.33680183,
                                        0.4334264,
                                        0.40612775,
                                        0.41281027,
                                        0.4218578,
                                        0.50377035,
                                        0.49244198,
                                        0.45941406,
                                        0.43792796,
                                        0.4740008,
                                        0.47784123,
                                        0.49302512,
                                        0.46467963,
                                        0.42274934,
                                        0.45041078,
                                        0.44436386,
                                        0.4656129,
                                        0.5096901,
                                        0.3612277,
                                        0.52482975],
                             'mae': [0.008516513,
                                     0.009436671,
                                     0.010655085,
                                     0.009657092,
                                     0.01062305,
                                     0.011241151,
                                     0.009801728,
                                     0.008692186,
                                     0.009297976,
                                     0.010066298,
                                     0.011186055,
                                     0.010658029,
                                     0.010479355,
                                     0.010294387,
                                     0.010323269,
                                     0.010973703,
                                     0.010967226,
                                     0.01244181,
                                     0.011362965,
                                     0.010458437,
                                     0.011269257,
                                     0.009446785],
                             'max_mae': 0.01244181,
                             'max_mse': 0.00042531118,
                             'max_rmse': 0.020623075,
                             'median_distance': 1.5608661,
                             'median_mae': 0.0104688965,
                             'min_cosine': 0.33680183,
                             'mse': [0.00016293838,
                                     0.00026180534,
                                     0.00038291942,
                                     0.00020422763,
                                     0.00027568737,
                                     0.0003297554,
                                     0.00023924588,
                                     0.00017321331,
                                     0.00017469886,
                                     0.0002142632,
                                     0.0002667101,
                                     0.00022988566,
                                     0.00021074977,
                                     0.00022530678,
                                     0.00026348553,
                                     0.00030650597,
                                     0.00024805457,
                                     0.00030891356,
                                     0.00029128313,
                                     0.00022294908,
                                     0.00042531118,
                                     0.00019843571],
                             'rmse': [0.012764731,
                                      0.0161804,
                                      0.019568328,
                                      0.014290824,
                                      0.016603837,
                                      0.018159168,
                                      0.015467575,
                                      0.013161053,
                                      0.013217369,
                                      0.014637732,
                                      0.016331261,
                                      0.015161981,
                                      0.014517223,
                                      0.015010223,
                                      0.016232237,
                                      0.017507313,
                                      0.015749749,
                                      0.017575936,
                                      0.017067019,
                                      0.0149314795,
                                      0.020623075,
                                      0.0140867205]},
 'residuals': {'mae': 0.010356773622334003,
               'mse': 0.00025528849801048636,
               'psnr': 19.211566925048828,
               'rmse': 0.015977749601006508,
               'ssds': [70.01845, 14.385978],
               'ssim': 0.4118771553039551},
 'spectra_pcagan': {'cosine': [0.9887463,
                               0.990139,
                               0.9779671,
                               0.9892989,
                               0.9810675,
                               0.7804825,
                               0.9810114,
                               0.9854521,
                               0.98324066,
                               0.9815486,
                               0.9734479,
                               0.98342425,
                               0.98339427,
                               0.9904055,
                               0.99274224,
                               0.9912833,
                               0.99298567,
                               0.9935543,
                               0.9950227,
                               0.9476585,
                               0.99394304,
                               0.99658066],
                    'mae': [0.02606924,
                            0.027398705,
                            0.027143838,
                            0.027696613,
                            0.029187916,
                            0.12437559,
                            0.027417261,
                            0.022199407,
                            0.024055727,
                            0.025110302,
                            0.032202877,
                            0.027299978,
                            0.027692815,
                            0.022493802,
                            0.021887505,
                            0.0284531,
                            0.022840876,
                            0.023932846,
                            0.023748504,
                            0.112930715,
                            0.021393595,
                            0.020629162],
                    'max_mae': 0.12437559,
                    'max_mse': 0.017227633,
                    'max_rmse': 0.13125408,
                    'median_mae': 0.02660654,
                    'min_cosine': 0.7804825,
                    'mse': [0.0011375411,
                            0.0014836584,
                            0.0014017262,
                            0.0013274117,
                            0.00143827,
                            0.017227633,
                            0.0013474034,
                            0.0008749589,
                            0.0010115086,
                            0.0010736282,
                            0.00171012,
                            0.0012049923,
                            0.0012453889,
                            0.00087740936,
                            0.00090184907,
                            0.0013397846,
                            0.00088122766,
                            0.0009903678,
                            0.0010467389,
                            0.013796326,
                            0.0009570788,
                            0.00069201685],
                    'rmse': [0.033727452,
                             0.038518287,
                             0.037439633,
                             0.036433663,
                             0.037924528,
                             0.13125408,
                             0.036706995,
                             0.029579705,
                             0.031804223,
                             0.032766268,
                             0.0413536,
                             0.034713,
                             0.035290066,
                             0.029621096,
                             0.030030802,
                             0.036603067,
                             0.029685479,
                             0.03147011,
                             0.032353345,
                             0.11745776,
                             0.03093669,
                             0.026306214]},
 'spectra_realgan': {'cosine': [0.9842078,
                                0.9871999,
                                0.9718724,
                                0.985967,
                                0.97519636,
                                0.78046894,
                                0.97550553,
                                0.979332,
                                0.9771153,
                                0.9751869,
                                0.96695566,
                                0.97756875,
                                0.97863656,
                                0.9863973,
                                0.98986506,
                                0.988211,
                                0.99054843,
                                0.9914029,
                                0.9933298,
                                0.9454759,
                                0.99235487,
                                0.99506116],
                     'mae': [0.031449873,
                             0.033358075,
                             0.03223088,
                             0.032833684,
                             0.034184877,
                             0.12320614,
                             0.032412127,
                             0.02735318,
                             0.028834647,
                             0.030076234,
                             0.035897896,
                             0.031591743,
                             0.031081274,
                             0.02747107,
                             0.026677659,
                             0.03191745,
                             0.02713928,
                             0.028460499,
                             0.028434673,
                             0.11333312,
                             0.025898932,
                             0.024077341],
                     'max_mae': 0.12320614,
                     'max_mse': 0.017251171,
                     'max_rmse': 0.1313437,
                     'median_mae': 0.03126557,
                     'min_cosine': 0.78046894,
                     'mse': [0.001616725,
                             0.001966377,
                             0.0018089884,
                             0.0017658881,
                             0.0018792998,
                             0.017251171,
                             0.0017576824,
                             0.0012546197,
                             0.0013850576,
                             0.0014584885,
                             0.0020979233,
                             0.0015857856,
                             0.0015713709,
                             0.0012464509,
                             0.0012413118,
                             0.001664988,
                             0.0011874527,
                             0.0013207701,
                             0.0013795355,
                             0.014200812,
                             0.0012412195,
                             0.0009442255],
                     'rmse': [0.04020852,
                              0.04434385,
                              0.042532206,
                              0.04202247,
                              0.04335089,
                              0.1313437,
                              0.041924722,
                              0.03542061,
                              0.03721636,
                              0.038190164,
                              0.045803092,
                              0.039821923,
                              0.03964052,
                              0.035305113,
                              0.035232253,
                              0.040804263,
                              0.034459434,
                              0.0363424,
                              0.037142098,
                              0.119167164,
                              0.035230946,
                              0.030728253]},
 'spectra_realpca': {'cosine': [0.9956891,
                                0.9968456,
                                0.9937453,
                                0.99647313,
                                0.99432063,
                                0.9941098,
                                0.99416333,
                                0.9936037,
                                0.993588,
                                0.99322087,
                                0.9932172,
                                0.9941703,
                                0.99471545,
                                0.99618137,
                                0.99729186,
                                0.9969032,
                                0.9973674,
                                0.99799657,
                                0.9983731,
                                0.9982278,
                                0.99801546,
                                0.9983513],
                     'mae': [0.016451024,
                             0.017186759,
                             0.015872382,
                             0.016606808,
                             0.016171038,
                             0.0153628765,
                             0.016044892,
                             0.015603104,
                             0.015481151,
                             0.015898915,
                             0.01568693,
                             0.015209607,
                             0.014896314,
                             0.014717062,
                             0.014370954,
                             0.014364395,
                             0.014272489,
                             0.013810243,
                             0.0138713,
                             0.013732071,
                             0.014032854,
                             0.013694668],
                     'max_mae': 0.017186759,
                     'max_mse': 0.00047408525,
                     'max_rmse': 0.021773499,
                     'median_mae': 0.015286242,
                     'min_cosine': 0.9932172,
                     'mse': [0.0004324034,
                             0.00047408525,
                             0.00039966742,
                             0.00043955294,
                             0.00042048618,
                             0.00038744128,
                             0.0004121807,
                             0.00039086267,
                             0.00038415138,
                             0.00040199846,
                             0.00039318297,
                             0.00037064194,
                             0.00035742685,
                             0.00034816508,
                             0.00032996802,
                             0.00033006273,
                             0.0003302328,
                             0.0003088054,
                             0.00030680178,
                             0.00031553913,
                             0.00031555345,
                             0.00030113885],
                     'rmse': [0.020794312,
                              0.021773499,
                              0.019991685,
                              0.020965518,
                              0.02050576,
                              0.019683529,
                              0.020302234,
                              0.019770248,
                              0.01959978,
                              0.0200499,
                              0.019828841,
                              0.019252064,
                              0.018905737,
                              0.018659182,
                              0.018165022,
                              0.018167628,
                              0.018172309,
                              0.01757286,
                              0.017515758,
                              0.017763421,
                              0.017763825,
                              0.017353352]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_50.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707
Directory path: experiments/inpainting/gann_4_night_20180723_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_50.0/images
Optimal number of principal components:  1
Reconstruction error:  37.32791
Energy conservation:  0.5564905
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_50.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.060522481510419, 3.5009956763846626],
                   'kl_div': 0.18481323,
                   'ks_tests': {10000: KstestResult(statistic=0.1279, pvalue=1.1640382789879722e-71, statistic_location=0.009099118, statistic_sign=1),
                                20000: KstestResult(statistic=0.13195, pvalue=2.799551492956108e-152, statistic_location=0.00934455, statistic_sign=1),
                                30000: KstestResult(statistic=0.12516666666666665, pvalue=2.7055319765265573e-205, statistic_location=0.01028227, statistic_sign=1),
                                40000: KstestResult(statistic=0.13312500000000005, pvalue=1.494054565591585e-309, statistic_location=0.009349184, statistic_sign=1),
                                50000: KstestResult(statistic=0.12946000000000002, pvalue=0.0, statistic_location=0.0102344295, statistic_sign=1),
                                60000: KstestResult(statistic=0.13078333333333336, pvalue=0.0, statistic_location=0.010262058, statistic_sign=1),
                                70000: KstestResult(statistic=0.1280285714285715, pvalue=0.0, statistic_location=0.009608868, statistic_sign=1),
                                80000: KstestResult(statistic=0.1322875, pvalue=0.0, statistic_location=0.010694509, statistic_sign=1),
                                90000: KstestResult(statistic=0.12929999999999997, pvalue=0.0, statistic_location=0.010591976, statistic_sign=1),
                                100000: KstestResult(statistic=0.13094000000000006, pvalue=0.0, statistic_location=0.010356157, statistic_sign=1),
                                110000: KstestResult(statistic=0.12943636363636368, pvalue=0.0, statistic_location=0.009609913, statistic_sign=1),
                                120000: KstestResult(statistic=0.1287583333333333, pvalue=0.0, statistic_location=0.010463657, statistic_sign=1),
                                130000: KstestResult(statistic=0.13086923076923074, pvalue=0.0, statistic_location=0.009832814, statistic_sign=1),
                                140000: KstestResult(statistic=0.13199285714285713, pvalue=0.0, statistic_location=0.009846419, statistic_sign=1),
                                150000: KstestResult(statistic=0.12951333333333337, pvalue=0.0, statistic_location=0.009915128, statistic_sign=1),
                                160000: KstestResult(statistic=0.12726250000000006, pvalue=0.0, statistic_location=0.010607402, statistic_sign=1),
                                170000: KstestResult(statistic=0.12962941176470588, pvalue=0.0, statistic_location=0.009664904, statistic_sign=1),
                                180000: KstestResult(statistic=0.12955000000000005, pvalue=0.0, statistic_location=0.010649473, statistic_sign=1),
                                190000: KstestResult(statistic=0.13101052631578947, pvalue=0.0, statistic_location=0.0103188325, statistic_sign=1),
                                200000: KstestResult(statistic=0.12992000000000004, pvalue=0.0, statistic_location=0.010587531, statistic_sign=1),
                                210000: KstestResult(statistic=0.12722857142857147, pvalue=0.0, statistic_location=0.010261552, statistic_sign=1),
                                220000: KstestResult(statistic=0.12857727272727282, pvalue=0.0, statistic_location=0.009652797, statistic_sign=1),
                                230000: KstestResult(statistic=0.12871304347826085, pvalue=0.0, statistic_location=0.0099259475, statistic_sign=1),
                                240000: KstestResult(statistic=0.12898750000000003, pvalue=0.0, statistic_location=0.010461104, statistic_sign=1),
                                250000: KstestResult(statistic=0.12852399999999997, pvalue=0.0, statistic_location=0.010191707, statistic_sign=1),
                                260000: KstestResult(statistic=0.12774615384615384, pvalue=0.0, statistic_location=0.010320311, statistic_sign=1),
                                270000: KstestResult(statistic=0.12841481481481476, pvalue=0.0, statistic_location=0.0104416385, statistic_sign=1),
                                280000: KstestResult(statistic=0.1281714285714285, pvalue=0.0, statistic_location=0.010269588, statistic_sign=1),
                                290000: KstestResult(statistic=0.1289137931034483, pvalue=0.0, statistic_location=0.009610847, statistic_sign=1),
                                300000: KstestResult(statistic=0.12885666666666673, pvalue=0.0, statistic_location=0.010598304, statistic_sign=1),
                                310000: KstestResult(statistic=0.1298096774193549, pvalue=0.0, statistic_location=0.009615352, statistic_sign=1),
                                320000: KstestResult(statistic=0.13002187499999995, pvalue=0.0, statistic_location=0.009916427, statistic_sign=1),
                                330000: KstestResult(statistic=0.1289636363636364, pvalue=0.0, statistic_location=0.009608999, statistic_sign=1)},
                   'moments': {'mean_error': 0.039026465,
                               'means': [4.6829733e-05, -2.5352574e-05],
                               'stds': [0.017160652, 0.008039438],
                               'variance_ratio': 4.0468526}},
 'originals': {'gan': {'mae': 0.03634387254714966,
                       'mse': 0.002503450959920883,
                       'psnr': 28.304943084716797,
                       'rmse': 0.05003449693322182,
                       'ssim': 0.6518727540969849},
               'pca': {'mae': 0.015256275422871113,
                       'mse': 0.00037564767990261316,
                       'psnr': 36.753177642822266,
                       'rmse': 0.019381633028388023,
                       'ssim': 0.9370474815368652}},
 'reconstructions': {'mae': 0.03217441588640213,
                     'mse': 0.0021439767442643642,
                     'psnr': 29.188785552978516,
                     'rmse': 0.046303097158670425,
                     'ssim': 0.6720669865608215},
 'residual_spectra_pcagan': {'cosine': [0.46280694,
                                        0.42908224,
                                        0.4485824,
                                        0.3723156,
                                        0.47799316,
                                        0.35842064,
                                        0.3966747,
                                        0.36205736,
                                        0.42108402,
                                        0.41949308,
                                        0.38530084,
                                        0.5089599,
                                        0.35357076,
                                        0.46764103,
                                        0.48056498,
                                        0.42451936,
                                        0.48404557,
                                        0.49388403,
                                        0.45988375,
                                        0.4522839,
                                        0.479768,
                                        0.4342832,
                                        0.45464528,
                                        0.45082676,
                                        0.47556105,
                                        0.52569693,
                                        0.47055554,
                                        0.46243423,
                                        0.5190771,
                                        0.5270974,
                                        0.5379233,
                                        0.5334589,
                                        0.4372685],
                             'mae': [0.009200426,
                                     0.009786001,
                                     0.009020552,
                                     0.010061527,
                                     0.008967212,
                                     0.010203884,
                                     0.009777578,
                                     0.010333325,
                                     0.009613474,
                                     0.010012924,
                                     0.010656165,
                                     0.00974055,
                                     0.010904565,
                                     0.010421906,
                                     0.0091466885,
                                     0.010237687,
                                     0.009821953,
                                     0.009764892,
                                     0.010714889,
                                     0.010939448,
                                     0.009688253,
                                     0.0107483845,
                                     0.01006907,
                                     0.011798442,
                                     0.010968133,
                                     0.00987337,
                                     0.011535484,
                                     0.011351655,
                                     0.009364166,
                                     0.009473162,
                                     0.0087627685,
                                     0.009109559,
                                     0.010697824],
                             'max_mae': 0.011798442,
                             'max_mse': 0.00034473842,
                             'max_rmse': 0.018567134,
                             'median_distance': 1.5450668,
                             'median_mae': 0.010012924,
                             'min_cosine': 0.35357076,
                             'mse': [0.00018670871,
                                     0.00022672334,
                                     0.00019156521,
                                     0.00030684748,
                                     0.00017484983,
                                     0.00030096318,
                                     0.00024974914,
                                     0.00029521418,
                                     0.00023872318,
                                     0.00021656709,
                                     0.00029688526,
                                     0.00020386316,
                                     0.00034473842,
                                     0.00021733755,
                                     0.0001798306,
                                     0.00027022944,
                                     0.00018764412,
                                     0.00019807722,
                                     0.00024389198,
                                     0.0002534503,
                                     0.00020775213,
                                     0.0002661654,
                                     0.00025221275,
                                     0.0002755704,
                                     0.00024261355,
                                     0.0001934982,
                                     0.0002616691,
                                     0.00027411708,
                                     0.00018431357,
                                     0.00018156672,
                                     0.00017118725,
                                     0.00018091527,
                                     0.00026864698],
                             'rmse': [0.013664139,
                                      0.015057335,
                                      0.013840709,
                                      0.017517062,
                                      0.01322308,
                                      0.01734829,
                                      0.015803453,
                                      0.017181799,
                                      0.015450669,
                                      0.014716218,
                                      0.017230358,
                                      0.014278065,
                                      0.018567134,
                                      0.014742373,
                                      0.013410093,
                                      0.016438657,
                                      0.0136983255,
                                      0.014073991,
                                      0.015617041,
                                      0.015920123,
                                      0.014413609,
                                      0.016314577,
                                      0.015881207,
                                      0.016600313,
                                      0.015576057,
                                      0.013910363,
                                      0.01617619,
                                      0.01655648,
                                      0.013576213,
                                      0.013474669,
                                      0.013083855,
                                      0.0134504745,
                                      0.016390454]},
 'residuals': {'mae': 0.010083815082907677,
               'mse': 0.00023466935090254992,
               'psnr': 19.942420959472656,
               'rmse': 0.015318921767175198,
               'ssds': [97.18146, 21.328897],
               'ssim': 0.41037213802337646},
 'spectra_pcagan': {'cosine': [0.98911756,
                               0.9867175,
                               0.9894729,
                               0.98879904,
                               0.9881075,
                               0.9920359,
                               0.98586,
                               0.98813164,
                               0.9774954,
                               0.98735213,
                               0.97603744,
                               0.76180047,
                               0.9764946,
                               0.97843117,
                               0.9837356,
                               0.97917336,
                               0.9770709,
                               0.98228383,
                               0.9825257,
                               0.9879658,
                               0.993476,
                               0.99124295,
                               0.99388415,
                               0.9933848,
                               0.99534637,
                               0.9400053,
                               0.9935038,
                               0.9938017,
                               0.99674195,
                               0.99544245,
                               0.9939824,
                               0.99537677,
                               0.995172],
                    'mae': [0.025403416,
                            0.025611347,
                            0.024644459,
                            0.026017841,
                            0.03326511,
                            0.03505089,
                            0.028350241,
                            0.030533817,
                            0.029135162,
                            0.03265596,
                            0.032138504,
                            0.12625188,
                            0.032962095,
                            0.028516605,
                            0.023430554,
                            0.026276046,
                            0.028157728,
                            0.025993658,
                            0.02731576,
                            0.025239987,
                            0.021106832,
                            0.02322372,
                            0.025064684,
                            0.025636047,
                            0.023551175,
                            0.118536204,
                            0.024845926,
                            0.029161539,
                            0.018338477,
                            0.020720711,
                            0.024048926,
                            0.019759115,
                            0.020811405],
                    'max_mae': 0.12625188,
                    'max_mse': 0.01735428,
                    'max_rmse': 0.13173564,
                    'median_mae': 0.025993658,
                    'min_cosine': 0.76180047,
                    'mse': [0.0011822496,
                            0.0012229802,
                            0.0011145048,
                            0.0013478335,
                            0.001718116,
                            0.0023167424,
                            0.001417616,
                            0.0018149437,
                            0.0014245185,
                            0.0017848305,
                            0.0017567852,
                            0.01735428,
                            0.0018762416,
                            0.001297769,
                            0.00095453224,
                            0.0012643152,
                            0.0013025863,
                            0.0011094145,
                            0.0012635714,
                            0.0010969121,
                            0.0007932823,
                            0.00094631844,
                            0.001123102,
                            0.0010730015,
                            0.0010190097,
                            0.015098785,
                            0.0010188612,
                            0.0013200733,
                            0.0005839896,
                            0.0007298255,
                            0.00095240516,
                            0.0006635466,
                            0.00080829347],
                    'rmse': [0.034383856,
                             0.034971133,
                             0.0333842,
                             0.03671285,
                             0.04145016,
                             0.04813255,
                             0.03765124,
                             0.042602155,
                             0.037742794,
                             0.042247254,
                             0.04191402,
                             0.13173564,
                             0.043315604,
                             0.036024563,
                             0.030895505,
                             0.03555721,
                             0.03609136,
                             0.033307873,
                             0.03554675,
                             0.033119664,
                             0.028165268,
                             0.030762289,
                             0.033512715,
                             0.0327567,
                             0.03192193,
                             0.12287711,
                             0.031919606,
                             0.036332812,
                             0.024165876,
                             0.027015284,
                             0.030861063,
                             0.025759399,
                             0.028430503]},
 'spectra_realgan': {'cosine': [0.9853446,
                                0.98256767,
                                0.98563063,
                                0.9851163,
                                0.98430246,
                                0.990299,
                                0.9817857,
                                0.98526233,
                                0.9705344,
                                0.9840986,
                                0.9703405,
                                0.76197344,
                                0.9708338,
                                0.9717489,
                                0.97797406,
                                0.97283286,
                                0.97123957,
                                0.9764412,
                                0.9774506,
                                0.98423177,
                                0.9908921,
                                0.9885252,
                                0.99138296,
                                0.99137866,
                                0.99382675,
                                0.93811303,
                                0.9917736,
                                0.9926594,
                                0.99521136,
                                0.9935207,
                                0.9913594,
                                0.9931009,
                                0.9935819],
                     'mae': [0.030539649,
                             0.030799946,
                             0.030067993,
                             0.031364214,
                             0.037744008,
                             0.040106792,
                             0.033149246,
                             0.03590371,
                             0.034257147,
                             0.037191924,
                             0.036726058,
                             0.12502028,
                             0.03720985,
                             0.03299886,
                             0.028176099,
                             0.031053208,
                             0.032060817,
                             0.030249339,
                             0.031115105,
                             0.029633017,
                             0.025752932,
                             0.027462823,
                             0.028603967,
                             0.029369647,
                             0.027923938,
                             0.118910305,
                             0.028411163,
                             0.030445337,
                             0.023159923,
                             0.025690857,
                             0.02844735,
                             0.02469657,
                             0.025105963],
                     'max_mae': 0.12502028,
                     'max_mse': 0.01737777,
                     'max_rmse': 0.13182476,
                     'median_mae': 0.030539649,
                     'min_cosine': 0.76197344,
                     'mse': [0.0015809664,
                             0.0016187706,
                             0.0015275833,
                             0.0017778876,
                             0.0022216057,
                             0.0028404759,
                             0.0018558182,
                             0.0022999325,
                             0.0018839997,
                             0.0022377805,
                             0.0021935673,
                             0.01737777,
                             0.002309737,
                             0.0017131699,
                             0.001309091,
                             0.001649585,
                             0.0016486815,
                             0.001485844,
                             0.0016125431,
                             0.0014481085,
                             0.001104015,
                             0.0012382809,
                             0.0014120649,
                             0.0013881207,
                             0.0013205992,
                             0.015468698,
                             0.0012956643,
                             0.0014877166,
                             0.00087834947,
                             0.0010618739,
                             0.0013008178,
                             0.0009894918,
                             0.0010752791],
                     'rmse': [0.03976137,
                              0.040233947,
                              0.03908431,
                              0.042165004,
                              0.04713391,
                              0.053296115,
                              0.04307921,
                              0.04795761,
                              0.043405063,
                              0.047305185,
                              0.046835534,
                              0.13182476,
                              0.048059724,
                              0.041390456,
                              0.036181364,
                              0.04061508,
                              0.040603958,
                              0.038546648,
                              0.040156484,
                              0.03805402,
                              0.03322672,
                              0.035189215,
                              0.03757745,
                              0.037257493,
                              0.03634005,
                              0.12437322,
                              0.035995338,
                              0.03857093,
                              0.02963696,
                              0.032586407,
                              0.036066853,
                              0.031456187,
                              0.032791447]},
 'spectra_realpca': {'cosine': [0.99592394,
                                0.99552435,
                                0.9958711,
                                0.99616116,
                                0.99626154,
                                0.9981005,
                                0.9956891,
                                0.9968456,
                                0.9937453,
                                0.99647313,
                                0.99432063,
                                0.9941098,
                                0.99416333,
                                0.9936037,
                                0.993588,
                                0.99322087,
                                0.9932172,
                                0.9941703,
                                0.99471545,
                                0.99618137,
                                0.99729186,
                                0.9969032,
                                0.9973674,
                                0.99799657,
                                0.9983731,
                                0.9982278,
                                0.99801546,
                                0.9983513,
                                0.99839914,
                                0.9978632,
                                0.9973172,
                                0.9976903,
                                0.9981454],
                     'mae': [0.016293611,
                             0.016118683,
                             0.016647164,
                             0.016692823,
                             0.016566422,
                             0.017548027,
                             0.016451024,
                             0.017186759,
                             0.015872382,
                             0.016606808,
                             0.016171038,
                             0.0153628765,
                             0.016044892,
                             0.015603104,
                             0.015481151,
                             0.015898915,
                             0.01568693,
                             0.015209607,
                             0.014896314,
                             0.014717062,
                             0.014370954,
                             0.014364395,
                             0.014272489,
                             0.013810243,
                             0.0138713,
                             0.013732071,
                             0.014032854,
                             0.013694668,
                             0.013622743,
                             0.0140278,
                             0.014324599,
                             0.014308351,
                             0.013968963],
                     'max_mae': 0.017548027,
                     'max_mse': 0.0004912639,
                     'max_rmse': 0.022164475,
                     'median_mae': 0.0153628765,
                     'min_cosine': 0.9932172,
                     'mse': [0.0004262989,
                             0.0004150114,
                             0.0004401752,
                             0.00044638838,
                             0.00044198942,
                             0.0004912639,
                             0.0004324034,
                             0.00047408525,
                             0.00039966742,
                             0.00043955294,
                             0.00042048618,
                             0.00038744128,
                             0.0004121807,
                             0.00039086267,
                             0.00038415138,
                             0.00040199846,
                             0.00039318297,
                             0.00037064194,
                             0.00035742685,
                             0.00034816508,
                             0.00032996802,
                             0.00033006273,
                             0.0003302328,
                             0.0003088054,
                             0.00030680178,
                             0.00031553913,
                             0.00031555345,
                             0.00030113885,
                             0.00029916505,
                             0.00031643105,
                             0.00032870966,
                             0.00032910553,
                             0.00031148677],
                     'rmse': [0.020647008,
                              0.020371828,
                              0.020980353,
                              0.021127906,
                              0.021023545,
                              0.022164475,
                              0.020794312,
                              0.021773499,
                              0.019991685,
                              0.020965518,
                              0.02050576,
                              0.019683529,
                              0.020302234,
                              0.019770248,
                              0.01959978,
                              0.0200499,
                              0.019828841,
                              0.019252064,
                              0.018905737,
                              0.018659182,
                              0.018165022,
                              0.018167628,
                              0.018172309,
                              0.01757286,
                              0.017515758,
                              0.017763421,
                              0.017763825,
                              0.017353352,
                              0.017296389,
                              0.017788509,
                              0.018130353,
                              0.018141266,
                              0.017648987]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_50.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529
Directory path: experiments/inpainting/gann_4_night_20180901_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_50.0/images
Optimal number of principal components:  11
Reconstruction error:  16.573595
Energy conservation:  0.5009875
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_50.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.932551248322828, 3.1488162646353652],
                   'kl_div': 0.31391633,
                   'ks_tests': {10000: KstestResult(statistic=0.1638, pvalue=1.8075078202502098e-117, statistic_location=0.007163695, statistic_sign=1),
                                20000: KstestResult(statistic=0.16359999999999997, pvalue=2.3888105656757628e-234, statistic_location=0.0068348334, statistic_sign=1),
                                30000: KstestResult(statistic=0.16446666666666665, pvalue=0.0, statistic_location=0.006993422, statistic_sign=1),
                                40000: KstestResult(statistic=0.164825, pvalue=0.0, statistic_location=-0.006466315, statistic_sign=-1),
                                50000: KstestResult(statistic=0.16444000000000003, pvalue=0.0, statistic_location=0.0067956643, statistic_sign=1),
                                60000: KstestResult(statistic=0.16274999999999995, pvalue=0.0, statistic_location=0.0069991304, statistic_sign=1),
                                70000: KstestResult(statistic=0.1628857142857143, pvalue=0.0, statistic_location=0.0073810513, statistic_sign=1),
                                80000: KstestResult(statistic=0.162825, pvalue=0.0, statistic_location=0.0070371847, statistic_sign=1),
                                90000: KstestResult(statistic=0.16533333333333333, pvalue=0.0, statistic_location=-0.0065626604, statistic_sign=-1),
                                100000: KstestResult(statistic=0.16342, pvalue=0.0, statistic_location=0.0071417186, statistic_sign=1),
                                110000: KstestResult(statistic=0.16303636363636353, pvalue=0.0, statistic_location=0.0071700015, statistic_sign=1)},
                   'moments': {'mean_error': 0.15969732,
                               'means': [0.0006159432, -6.137115e-05],
                               'stds': [0.023046242, 0.005796251],
                               'variance_ratio': 13.230761}},
 'originals': {'gan': {'mae': 0.10246788710355759,
                       'mse': 0.08953791111707687,
                       'psnr': 15.509013175964355,
                       'rmse': 0.29922884702682495,
                       'ssim': 0.8870316743850708},
               'pca': {'mae': 0.007093281019479036,
                       'mse': 9.090427192859352e-05,
                       'psnr': 45.70763397216797,
                       'rmse': 0.009534372948110104,
                       'ssim': 0.9905824065208435}},
 'reconstructions': {'mae': 0.10055193305015564,
                     'mse': 0.08946290612220764,
                     'psnr': 15.777047157287598,
                     'rmse': 0.2991034984588623,
                     'ssim': 0.8942459225654602},
 'residual_spectra_pcagan': {'cosine': [0.20223117,
                                        0.2994932,
                                        0.38302815,
                                        0.38255182,
                                        0.35558066,
                                        0.37617072,
                                        0.40182054,
                                        0.38818863,
                                        0.37366515,
                                        0.44218877,
                                        0.013637508],
                             'mae': [0.011091644,
                                     0.010867933,
                                     0.008775887,
                                     0.009845191,
                                     0.009467436,
                                     0.008172566,
                                     0.008941316,
                                     0.009454404,
                                     0.008783621,
                                     0.008434514,
                                     0.025210653],
                             'max_mae': 0.025210653,
                             'max_mse': 0.0031044388,
                             'max_rmse': 0.05571749,
                             'median_distance': 1.4825462,
                             'median_mae': 0.009454404,
                             'min_cosine': 0.013637508,
                             'mse': [0.00027174596,
                                     0.0004159204,
                                     0.00021478524,
                                     0.00023825605,
                                     0.00029693038,
                                     0.00017967608,
                                     0.00017231038,
                                     0.00020998245,
                                     0.00021979432,
                                     0.00017248627,
                                     0.0031044388],
                             'rmse': [0.016484719,
                                      0.020394126,
                                      0.014655553,
                                      0.015435545,
                                      0.017231667,
                                      0.01340433,
                                      0.013126705,
                                      0.014490771,
                                      0.014825462,
                                      0.013133403,
                                      0.05571749]},
 'residuals': {'mae': 0.010822287760674953,
               'mse': 0.0004996660281904042,
               'psnr': 10.527085304260254,
               'rmse': 0.022353211417794228,
               'ssds': [58.465424, 3.695998],
               'ssim': 0.6530844569206238},
 'spectra_pcagan': {'cosine': [0.99912184,
                               0.99431574,
                               0.9966145,
                               0.9983264,
                               0.99907273,
                               0.9974334,
                               0.99785984,
                               0.9988853,
                               0.99796504,
                               0.9991792,
                               -0.6452829],
                    'mae': [0.014628926,
                            0.020303138,
                            0.01710498,
                            0.016784912,
                            0.012061471,
                            0.013393455,
                            0.01469496,
                            0.0133175235,
                            0.013675223,
                            0.011621228,
                            0.9584854],
                    'max_mae': 0.9584854,
                    'max_mse': 0.98026013,
                    'max_rmse': 0.9900809,
                    'median_mae': 0.014628926,
                    'min_cosine': -0.6452829,
                    'mse': [0.00036150322,
                            0.00067547197,
                            0.00048556662,
                            0.00047094398,
                            0.00027926112,
                            0.00033590512,
                            0.00035265874,
                            0.00029643712,
                            0.00033945945,
                            0.00023455096,
                            0.98026013],
                    'rmse': [0.019013237,
                             0.025989844,
                             0.022035576,
                             0.021701245,
                             0.016711108,
                             0.018327715,
                             0.01877921,
                             0.01721735,
                             0.018424425,
                             0.015315057,
                             0.9900809]},
 'spectra_realgan': {'cosine': [0.99906915,
                                0.9933958,
                                0.99578017,
                                0.9978164,
                                0.9987539,
                                0.99656457,
                                0.9971878,
                                0.99853414,
                                0.99725324,
                                0.9988347,
                                -0.6451682],
                     'mae': [0.015093413,
                             0.021834007,
                             0.018909004,
                             0.01878682,
                             0.014685913,
                             0.016091838,
                             0.017106565,
                             0.015522933,
                             0.016487284,
                             0.014210428,
                             0.95841867],
                     'max_mae': 0.95841867,
                     'max_mse': 0.98011833,
                     'max_rmse': 0.99000925,
                     'median_mae': 0.016487284,
                     'min_cosine': -0.6451682,
                     'mse': [0.00038180794,
                             0.0007860678,
                             0.00059797306,
                             0.00057443464,
                             0.00037425736,
                             0.00044651533,
                             0.00046026468,
                             0.00038939103,
                             0.0004553615,
                             0.00033263222,
                             0.98011833],
                     'rmse': [0.019539906,
                              0.0280369,
                              0.024453487,
                              0.023967367,
                              0.019345732,
                              0.02113091,
                              0.02145378,
                              0.019732993,
                              0.0213392,
                              0.018238207,
                              0.99000925]},
 'spectra_realpca': {'cosine': [0.9999519,
                                0.99896455,
                                0.9991228,
                                0.9994974,
                                0.99967813,
                                0.99904114,
                                0.99928886,
                                0.9996738,
                                0.99928874,
                                0.99964875,
                                0.9999959],
                     'mae': [0.0033533305,
                             0.008767113,
                             0.008608527,
                             0.008021071,
                             0.007711911,
                             0.008698487,
                             0.008424503,
                             0.0073564285,
                             0.008421346,
                             0.007863821,
                             0.0007995655],
                     'max_mae': 0.008767113,
                     'max_mse': 0.00012323359,
                     'max_rmse': 0.011101062,
                     'median_mae': 0.008021071,
                     'min_cosine': 0.99896455,
                     'mse': [1.7971497e-05,
                             0.00012323359,
                             0.00011948924,
                             0.000103411854,
                             9.52752e-05,
                             0.00012259724,
                             0.0001144476,
                             8.684425e-05,
                             0.00011538503,
                             0.000100238656,
                             1.0526956e-06],
                     'rmse': [0.0042392802,
                              0.011101062,
                              0.010931114,
                              0.0101691615,
                              0.009760901,
                              0.011072364,
                              0.010698019,
                              0.009319026,
                              0.010741742,
                              0.010011925,
                              0.0010260096]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_50.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319
Directory path: experiments/inpainting/gann_4_night_20180901_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_50.0/images
Optimal number of principal components:  11
Reconstruction error:  16.573595
Energy conservation:  0.5009875
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_50.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.940780002103074, 3.0911926499762075],
                   'kl_div': 0.3570913,
                   'ks_tests': {10000: KstestResult(statistic=0.1803, pvalue=2.2507221743698865e-142, statistic_location=-0.006014544, statistic_sign=-1),
                                20000: KstestResult(statistic=0.1789, pvalue=1.7765960756166735e-280, statistic_location=-0.005976936, statistic_sign=-1),
                                30000: KstestResult(statistic=0.1867, pvalue=0.0, statistic_location=-0.0061489344, statistic_sign=-1),
                                40000: KstestResult(statistic=0.18277500000000002, pvalue=0.0, statistic_location=-0.0062931776, statistic_sign=-1),
                                50000: KstestResult(statistic=0.17958, pvalue=0.0, statistic_location=-0.006481931, statistic_sign=-1),
                                60000: KstestResult(statistic=0.18081666666666665, pvalue=0.0, statistic_location=-0.006379173, statistic_sign=-1),
                                70000: KstestResult(statistic=0.18141428571428575, pvalue=0.0, statistic_location=-0.006363659, statistic_sign=-1),
                                80000: KstestResult(statistic=0.18182499999999996, pvalue=0.0, statistic_location=-0.0062996186, statistic_sign=-1),
                                90000: KstestResult(statistic=0.18142222222222226, pvalue=0.0, statistic_location=-0.0067977747, statistic_sign=-1),
                                100000: KstestResult(statistic=0.17932, pvalue=0.0, statistic_location=-0.006394457, statistic_sign=-1),
                                110000: KstestResult(statistic=0.17925454545454544, pvalue=0.0, statistic_location=-0.006387518, statistic_sign=-1),
                                120000: KstestResult(statistic=0.18115833333333337, pvalue=0.0, statistic_location=-0.006645548, statistic_sign=-1),
                                130000: KstestResult(statistic=0.18228461538461538, pvalue=0.0, statistic_location=-0.006314501, statistic_sign=-1),
                                140000: KstestResult(statistic=0.18060000000000004, pvalue=0.0, statistic_location=-0.0062931776, statistic_sign=-1),
                                150000: KstestResult(statistic=0.1791, pvalue=0.0, statistic_location=-0.0064697266, statistic_sign=-1),
                                160000: KstestResult(statistic=0.1822375, pvalue=0.0, statistic_location=-0.0062875785, statistic_sign=-1),
                                170000: KstestResult(statistic=0.18368235294117646, pvalue=0.0, statistic_location=-0.0063601527, statistic_sign=-1),
                                180000: KstestResult(statistic=0.18144444444444446, pvalue=0.0, statistic_location=-0.006292668, statistic_sign=-1),
                                190000: KstestResult(statistic=0.1806263157894737, pvalue=0.0, statistic_location=-0.0063129165, statistic_sign=-1),
                                200000: KstestResult(statistic=0.18111999999999998, pvalue=0.0, statistic_location=-0.0062962407, statistic_sign=-1),
                                210000: KstestResult(statistic=0.18153809523809525, pvalue=0.0, statistic_location=-0.006316606, statistic_sign=-1),
                                220000: KstestResult(statistic=0.1816409090909091, pvalue=0.0, statistic_location=-0.0064266473, statistic_sign=-1)},
                   'moments': {'mean_error': 0.013342334,
                               'means': [-0.00023313925, -5.715594e-05],
                               'stds': [0.0203259, 0.0055038794],
                               'variance_ratio': 10.455289}},
 'originals': {'gan': {'mae': 0.0791468694806099,
                       'mse': 0.051039062440395355,
                       'psnr': 18.142791748046875,
                       'rmse': 0.2259182631969452,
                       'ssim': 0.575168788433075},
               'pca': {'mae': 0.007499891798943281,
                       'mse': 0.00010603910777717829,
                       'psnr': 45.187339782714844,
                       'rmse': 0.010297529399394989,
                       'ssim': 0.9933721423149109}},
 'reconstructions': {'mae': 0.07766567915678024,
                     'mse': 0.05094508081674576,
                     'psnr': 18.3709774017334,
                     'rmse': 0.2257101684808731,
                     'ssim': 0.5781656503677368},
 'residual_spectra_pcagan': {'cosine': [0.3393128,
                                        0.2969558,
                                        0.22770536,
                                        0.25268957,
                                        0.32699984,
                                        0.2085158,
                                        0.3136137,
                                        0.4074237,
                                        0.40571675,
                                        0.39798418,
                                        0.40333876,
                                        0.4043311,
                                        0.4201232,
                                        0.4134032,
                                        0.49036515,
                                        0.012048287,
                                        0.43455312,
                                        0.053437725,
                                        0.12277577,
                                        0.40393963,
                                        0.36690757,
                                        0.36286396],
                             'mae': [0.009645339,
                                     0.010880329,
                                     0.011278066,
                                     0.01104417,
                                     0.009804711,
                                     0.010887302,
                                     0.010434163,
                                     0.008428516,
                                     0.009382688,
                                     0.008732483,
                                     0.0078460155,
                                     0.00884766,
                                     0.008881752,
                                     0.008312428,
                                     0.007772548,
                                     0.025693152,
                                     0.009154062,
                                     0.012829061,
                                     0.011322543,
                                     0.009656865,
                                     0.0101470845,
                                     0.0083610965],
                             'max_mae': 0.025693152,
                             'max_mse': 0.0032345844,
                             'max_rmse': 0.056873407,
                             'median_distance': 1.4889913,
                             'median_mae': 0.009651102,
                             'min_cosine': 0.012048287,
                             'mse': [0.00021065716,
                                     0.00034381147,
                                     0.00054098543,
                                     0.0003380212,
                                     0.00028464754,
                                     0.00025997098,
                                     0.0003718741,
                                     0.00018517576,
                                     0.0002069797,
                                     0.00023304441,
                                     0.00015633114,
                                     0.00016934064,
                                     0.00017496453,
                                     0.00017651722,
                                     0.00013418682,
                                     0.0032345844,
                                     0.00017425469,
                                     0.0003326365,
                                     0.00024998063,
                                     0.00020459476,
                                     0.000271867,
                                     0.00018106175],
                             'rmse': [0.014514034,
                                      0.018542154,
                                      0.023259094,
                                      0.018385353,
                                      0.0168715,
                                      0.016123615,
                                      0.019284038,
                                      0.013607929,
                                      0.014386789,
                                      0.015265793,
                                      0.012503245,
                                      0.013013095,
                                      0.013227416,
                                      0.013285979,
                                      0.011583904,
                                      0.056873407,
                                      0.013200556,
                                      0.018238325,
                                      0.015810777,
                                      0.014303663,
                                      0.01648839,
                                      0.013455919]},
 'residuals': {'mae': 0.010424637235701084,
               'mse': 0.00038343126652762294,
               'psnr': 20.882226943969727,
               'rmse': 0.019581401720643044,
               'ssds': [90.90281, 6.6650805],
               'ssim': 0.660227358341217},
 'spectra_pcagan': {'cosine': [0.96937454,
                               0.9875073,
                               0.9800427,
                               0.98729116,
                               0.99625826,
                               0.9991027,
                               0.9942543,
                               0.99663866,
                               0.998335,
                               0.99910504,
                               0.997559,
                               0.9977913,
                               0.9988719,
                               0.9979713,
                               0.999218,
                               -0.64462936,
                               0.99899876,
                               0.9994858,
                               0.999177,
                               0.9959544,
                               0.0065543726,
                               0.9896032],
                    'mae': [0.035690717,
                            0.046072077,
                            0.03294419,
                            0.0345374,
                            0.017196698,
                            0.014659482,
                            0.020383932,
                            0.017006371,
                            0.016722469,
                            0.011889498,
                            0.013197944,
                            0.014984787,
                            0.013375027,
                            0.0137478225,
                            0.011418859,
                            0.9587496,
                            0.013714652,
                            0.014373495,
                            0.014786113,
                            0.020123456,
                            0.34481227,
                            0.028257962],
                    'max_mae': 0.9587496,
                    'max_mse': 0.9811628,
                    'max_rmse': 0.99053663,
                    'median_mae': 0.016864419,
                    'min_cosine': -0.64462936,
                    'mse': [0.0017432901,
                            0.0029817608,
                            0.0019222058,
                            0.0017779627,
                            0.00053687976,
                            0.00036168622,
                            0.0006820342,
                            0.00047800373,
                            0.0004627299,
                            0.00027053145,
                            0.0003196653,
                            0.00036642767,
                            0.0002999444,
                            0.00033954415,
                            0.00022340505,
                            0.9811628,
                            0.00030757426,
                            0.00033256345,
                            0.00035373375,
                            0.0006237895,
                            0.12404459,
                            0.0012005718],
                    'rmse': [0.041752726,
                             0.054605503,
                             0.043842968,
                             0.042165894,
                             0.023170667,
                             0.01901805,
                             0.026115784,
                             0.021863297,
                             0.021511158,
                             0.01644784,
                             0.017879186,
                             0.0191423,
                             0.017318903,
                             0.018426724,
                             0.01494674,
                             0.99053663,
                             0.017537795,
                             0.018236322,
                             0.018807812,
                             0.024975779,
                             0.35219964,
                             0.034649268]},
 'spectra_realgan': {'cosine': [0.9670778,
                                0.9860739,
                                0.9780557,
                                0.98576266,
                                0.9951324,
                                0.99904984,
                                0.993334,
                                0.9958081,
                                0.9978229,
                                0.99878496,
                                0.99668676,
                                0.99711907,
                                0.9985224,
                                0.9972569,
                                0.99887186,
                                -0.6445148,
                                0.9986888,
                                0.9994831,
                                0.9991609,
                                0.9950985,
                                0.00620771,
                                0.98793983],
                     'mae': [0.03637817,
                             0.046589788,
                             0.034258008,
                             0.035527002,
                             0.019814119,
                             0.015101448,
                             0.02191781,
                             0.018824134,
                             0.018703619,
                             0.014546591,
                             0.015915832,
                             0.017371306,
                             0.015557715,
                             0.016533135,
                             0.014031367,
                             0.95868284,
                             0.01574498,
                             0.0143905,
                             0.014926655,
                             0.02216288,
                             0.34483683,
                             0.029416408],
                     'max_mae': 0.95868284,
                     'max_mse': 0.9810211,
                     'max_rmse': 0.9904651,
                     'median_mae': 0.018763877,
                     'min_cosine': -0.6445148,
                     'mse': [0.0018786305,
                             0.0031433513,
                             0.0020680984,
                             0.0019107212,
                             0.00067015114,
                             0.00038199013,
                             0.00079278374,
                             0.0005900748,
                             0.0005667468,
                             0.00036588818,
                             0.000430694,
                             0.00047388955,
                             0.0003922552,
                             0.0004558564,
                             0.00032200202,
                             0.9810211,
                             0.0003959076,
                             0.0003332668,
                             0.00035991942,
                             0.0007465529,
                             0.12421885,
                             0.001340763],
                     'rmse': [0.04334317,
                              0.056065597,
                              0.04547635,
                              0.043711796,
                              0.025887277,
                              0.019544568,
                              0.028156416,
                              0.024291456,
                              0.023806445,
                              0.019128203,
                              0.020753168,
                              0.021769004,
                              0.019805433,
                              0.021350794,
                              0.017944414,
                              0.9904651,
                              0.019897427,
                              0.018255597,
                              0.018971542,
                              0.02732312,
                              0.35244694,
                              0.03661643]},
 'spectra_realpca': {'cosine': [0.997468,
                                0.9987545,
                                0.9979362,
                                0.99829084,
                                0.9989291,
                                0.9999519,
                                0.99896455,
                                0.9991228,
                                0.9994974,
                                0.99967813,
                                0.99904114,
                                0.99928886,
                                0.9996738,
                                0.99928874,
                                0.99964875,
                                0.9999959,
                                0.9997083,
                                0.9999972,
                                0.99998534,
                                0.9991795,
                                0.99840695,
                                0.9981812],
                     'mae': [0.009566453,
                             0.010662238,
                             0.010036717,
                             0.010041405,
                             0.00867608,
                             0.0033533305,
                             0.008767113,
                             0.008608527,
                             0.008021071,
                             0.007711911,
                             0.008698487,
                             0.008424503,
                             0.0073564285,
                             0.008421346,
                             0.007863821,
                             0.0007995655,
                             0.0072419266,
                             0.0009865025,
                             0.0019672976,
                             0.008543075,
                             0.008949155,
                             0.010300653],
                     'max_mae': 0.010662238,
                     'max_mse': 0.00019202523,
                     'max_rmse': 0.013857316,
                     'median_mae': 0.008483789,
                     'min_cosine': 0.997468,
                     'mse': [0.00014645405,
                             0.00019202523,
                             0.00016142636,
                             0.00016079591,
                             0.00012149677,
                             1.7971497e-05,
                             0.00012323359,
                             0.00011948924,
                             0.000103411854,
                             9.52752e-05,
                             0.00012259724,
                             0.0001144476,
                             8.684425e-05,
                             0.00011538503,
                             0.000100238656,
                             1.0526956e-06,
                             8.443591e-05,
                             1.5743544e-06,
                             6.1729775e-06,
                             0.00011729619,
                             0.00016958488,
                             0.000171651],
                     'rmse': [0.012101821,
                              0.013857316,
                              0.012705367,
                              0.012680532,
                              0.0110225575,
                              0.0042392802,
                              0.011101062,
                              0.010931114,
                              0.0101691615,
                              0.009760901,
                              0.011072364,
                              0.010698019,
                              0.009319026,
                              0.010741742,
                              0.010011925,
                              0.0010260096,
                              0.009188902,
                              0.0012547328,
                              0.0024845477,
                              0.010830336,
                              0.013022476,
                              0.013101565]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_50.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809
Directory path: experiments/inpainting/gann_4_night_20180901_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_50.0/images
Optimal number of principal components:  11
Reconstruction error:  16.573595
Energy conservation:  0.5009875
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_50.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9130967822707543, 3.0892662945708134],
                   'kl_div': 0.33475444,
                   'ks_tests': {10000: KstestResult(statistic=0.1826, pvalue=4.864010618518248e-146, statistic_location=-0.0069965795, statistic_sign=-1),
                                20000: KstestResult(statistic=0.17925000000000002, pvalue=1.395670865489119e-281, statistic_location=-0.006009423, statistic_sign=-1),
                                30000: KstestResult(statistic=0.18063333333333337, pvalue=0.0, statistic_location=-0.0071493266, statistic_sign=-1),
                                40000: KstestResult(statistic=0.17575000000000002, pvalue=0.0, statistic_location=-0.0065221563, statistic_sign=-1),
                                50000: KstestResult(statistic=0.17862, pvalue=0.0, statistic_location=-0.006232898, statistic_sign=-1),
                                60000: KstestResult(statistic=0.17443333333333333, pvalue=0.0, statistic_location=-0.006557987, statistic_sign=-1),
                                70000: KstestResult(statistic=0.17912857142857141, pvalue=0.0, statistic_location=-0.0066250972, statistic_sign=-1),
                                80000: KstestResult(statistic=0.17593750000000002, pvalue=0.0, statistic_location=-0.0060739554, statistic_sign=-1),
                                90000: KstestResult(statistic=0.17903333333333332, pvalue=0.0, statistic_location=-0.00620077, statistic_sign=-1),
                                100000: KstestResult(statistic=0.17837999999999998, pvalue=0.0, statistic_location=-0.006064168, statistic_sign=-1),
                                110000: KstestResult(statistic=0.178, pvalue=0.0, statistic_location=-0.0060069747, statistic_sign=-1),
                                120000: KstestResult(statistic=0.1793833333333333, pvalue=0.0, statistic_location=-0.00632252, statistic_sign=-1),
                                130000: KstestResult(statistic=0.1773923076923077, pvalue=0.0, statistic_location=-0.0066113016, statistic_sign=-1),
                                140000: KstestResult(statistic=0.17982857142857145, pvalue=0.0, statistic_location=-0.006631206, statistic_sign=-1),
                                150000: KstestResult(statistic=0.17728666666666665, pvalue=0.0, statistic_location=-0.0063784085, statistic_sign=-1),
                                160000: KstestResult(statistic=0.177375, pvalue=0.0, statistic_location=-0.0065266993, statistic_sign=-1),
                                170000: KstestResult(statistic=0.17708235294117647, pvalue=0.0, statistic_location=-0.0064340457, statistic_sign=-1),
                                180000: KstestResult(statistic=0.17753333333333332, pvalue=0.0, statistic_location=-0.0063968482, statistic_sign=-1),
                                190000: KstestResult(statistic=0.17674736842105265, pvalue=0.0, statistic_location=-0.006384507, statistic_sign=-1),
                                200000: KstestResult(statistic=0.17600000000000002, pvalue=0.0, statistic_location=-0.006622076, statistic_sign=-1),
                                210000: KstestResult(statistic=0.1748714285714286, pvalue=0.0, statistic_location=-0.0065661967, statistic_sign=-1),
                                220000: KstestResult(statistic=0.17747272727272725, pvalue=0.0, statistic_location=-0.0066275094, statistic_sign=-1),
                                230000: KstestResult(statistic=0.17559565217391304, pvalue=0.0, statistic_location=-0.0063976706, statistic_sign=-1),
                                240000: KstestResult(statistic=0.17602083333333332, pvalue=0.0, statistic_location=-0.0059484933, statistic_sign=-1),
                                250000: KstestResult(statistic=0.17638800000000002, pvalue=0.0, statistic_location=-0.006554574, statistic_sign=-1),
                                260000: KstestResult(statistic=0.1794769230769231, pvalue=0.0, statistic_location=-0.0066311955, statistic_sign=-1),
                                270000: KstestResult(statistic=0.17804074074074072, pvalue=0.0, statistic_location=-0.006628974, statistic_sign=-1),
                                280000: KstestResult(statistic=0.17605714285714283, pvalue=0.0, statistic_location=-0.005988475, statistic_sign=-1),
                                290000: KstestResult(statistic=0.1780965517241379, pvalue=0.0, statistic_location=-0.0066103023, statistic_sign=-1),
                                300000: KstestResult(statistic=0.17852666666666667, pvalue=0.0, statistic_location=-0.0066138785, statistic_sign=-1),
                                310000: KstestResult(statistic=0.1778290322580645, pvalue=0.0, statistic_location=-0.006619552, statistic_sign=-1),
                                320000: KstestResult(statistic=0.17695, pvalue=0.0, statistic_location=-0.006317809, statistic_sign=-1),
                                330000: KstestResult(statistic=0.17790303030303034, pvalue=0.0, statistic_location=-0.0063900826, statistic_sign=-1)},
                   'moments': {'mean_error': -0.022648638,
                               'means': [-0.00039741758, -6.1415e-05],
                               'stds': [0.018622587, 0.0054470263],
                               'variance_ratio': 8.967577}},
 'originals': {'gan': {'mae': 0.061107855290174484,
                       'mse': 0.03438358008861542,
                       'psnr': 19.85433006286621,
                       'rmse': 0.18542809784412384,
                       'ssim': 0.6147010922431946},
               'pca': {'mae': 0.007795852608978748,
                       'mse': 0.00011175875988556072,
                       'psnr': 44.95918273925781,
                       'rmse': 0.010571601800620556,
                       'ssim': 0.9942822456359863}},
 'reconstructions': {'mae': 0.05966870114207268,
                     'mse': 0.034284595400094986,
                     'psnr': 20.09101104736328,
                     'rmse': 0.18516099452972412,
                     'ssim': 0.6172244548797607},
 'residual_spectra_pcagan': {'cosine': [0.3465454,
                                        0.3832009,
                                        0.34060735,
                                        0.4099903,
                                        0.40240192,
                                        0.26764426,
                                        0.3722175,
                                        0.32536033,
                                        0.24777731,
                                        0.2544667,
                                        0.34665096,
                                        0.21470702,
                                        0.33380765,
                                        0.43481347,
                                        0.42070922,
                                        0.43100914,
                                        0.40255535,
                                        0.41515693,
                                        0.45255706,
                                        0.43914077,
                                        0.5018434,
                                        0.010053912,
                                        0.44914067,
                                        0.05703641,
                                        0.13427271,
                                        0.41245705,
                                        0.37857205,
                                        0.39498532,
                                        0.2919419,
                                        0.25575694,
                                        0.08074508,
                                        0.4018926,
                                        0.3829062],
                             'mae': [0.00862183,
                                     0.007865065,
                                     0.008376702,
                                     0.007958942,
                                     0.007943464,
                                     0.010076068,
                                     0.009183082,
                                     0.010195737,
                                     0.010585875,
                                     0.010986153,
                                     0.009435729,
                                     0.010462099,
                                     0.010207976,
                                     0.008062542,
                                     0.0089642955,
                                     0.008336389,
                                     0.0077544586,
                                     0.008601857,
                                     0.008432233,
                                     0.008086113,
                                     0.0075031677,
                                     0.02585322,
                                     0.0088770185,
                                     0.012541622,
                                     0.010844222,
                                     0.00943802,
                                     0.009845401,
                                     0.007860067,
                                     0.009489465,
                                     0.010841572,
                                     0.011137274,
                                     0.010038312,
                                     0.008859252],
                             'max_mae': 0.02585322,
                             'max_mse': 0.0033107318,
                             'max_rmse': 0.05753896,
                             'median_distance': 1.4367931,
                             'median_mae': 0.009183082,
                             'min_cosine': 0.010053912,
                             'mse': [0.00020643744,
                                     0.0001498708,
                                     0.00020707969,
                                     0.00015541718,
                                     0.00014161186,
                                     0.0003267189,
                                     0.00017742498,
                                     0.00028085825,
                                     0.0004497022,
                                     0.00033436538,
                                     0.00025365458,
                                     0.00023401546,
                                     0.00031976536,
                                     0.00015983949,
                                     0.00018734667,
                                     0.00019692998,
                                     0.00015514868,
                                     0.00016084826,
                                     0.0001460064,
                                     0.0001556041,
                                     0.0001262624,
                                     0.0033107318,
                                     0.00016158786,
                                     0.00031503596,
                                     0.00022467329,
                                     0.00019418861,
                                     0.00025952622,
                                     0.00014779795,
                                     0.00023654675,
                                     0.00043343115,
                                     0.0002778743,
                                     0.00022907458,
                                     0.00018143504],
                             'rmse': [0.014367931,
                                      0.012242173,
                                      0.014390264,
                                      0.012466642,
                                      0.0119000785,
                                      0.018075367,
                                      0.013320097,
                                      0.016758826,
                                      0.021206183,
                                      0.01828566,
                                      0.015926536,
                                      0.015297564,
                                      0.017881984,
                                      0.0126427645,
                                      0.0136874635,
                                      0.014033174,
                                      0.0124558695,
                                      0.012682596,
                                      0.012083311,
                                      0.012474137,
                                      0.011236655,
                                      0.05753896,
                                      0.0127117215,
                                      0.017749252,
                                      0.014989106,
                                      0.013935157,
                                      0.016109817,
                                      0.0121572185,
                                      0.015380076,
                                      0.02081901,
                                      0.016669562,
                                      0.01513521,
                                      0.013469783]},
 'residuals': {'mae': 0.009795915335416794,
               'mse': 0.00031808525091037154,
               'psnr': 21.901643753051758,
               'rmse': 0.017834944650530815,
               'ssds': [114.495995, 9.792347],
               'ssim': 0.651421844959259},
 'spectra_pcagan': {'cosine': [0.98365134,
                               0.9813877,
                               0.9856094,
                               0.98806065,
                               0.98357093,
                               0.9838875,
                               0.96912986,
                               0.98784626,
                               0.9808347,
                               0.987529,
                               0.9963219,
                               0.9991028,
                               0.9941779,
                               0.9965956,
                               0.9983493,
                               0.9990901,
                               0.99742496,
                               0.9977878,
                               0.99884975,
                               0.99792117,
                               0.99917054,
                               -0.64601916,
                               0.99896204,
                               0.9994696,
                               0.9991837,
                               0.9957033,
                               0.007746795,
                               0.9895219,
                               0.9794584,
                               0.97481537,
                               0.99951243,
                               0.9985771,
                               0.9992179],
                    'mae': [0.023461862,
                            0.026993958,
                            0.022281088,
                            0.022462266,
                            0.02527372,
                            0.026105614,
                            0.03594563,
                            0.04591671,
                            0.032629706,
                            0.034575045,
                            0.016751487,
                            0.014716015,
                            0.020477286,
                            0.017015878,
                            0.016558584,
                            0.012032355,
                            0.013373975,
                            0.014926999,
                            0.013547389,
                            0.01385049,
                            0.011691583,
                            0.9592697,
                            0.013925101,
                            0.014680781,
                            0.014757852,
                            0.020605454,
                            0.34433165,
                            0.028582595,
                            0.037143335,
                            0.031645343,
                            0.014693393,
                            0.015821358,
                            0.013023169],
                    'max_mae': 0.9592697,
                    'max_mse': 0.98163515,
                    'max_rmse': 0.99077505,
                    'median_mae': 0.020477286,
                    'min_cosine': -0.64601916,
                    'mse': [0.00093412836,
                            0.0010691382,
                            0.00085462496,
                            0.00079550524,
                            0.00094250153,
                            0.0011496732,
                            0.001759081,
                            0.0029599743,
                            0.0018829006,
                            0.0018029694,
                            0.00050542364,
                            0.00036117516,
                            0.0006890657,
                            0.00047803993,
                            0.00045493201,
                            0.00027618866,
                            0.00033330172,
                            0.00036275535,
                            0.00030583935,
                            0.00034781327,
                            0.00023700244,
                            0.98163515,
                            0.00031973945,
                            0.00034516476,
                            0.0003529661,
                            0.0006546795,
                            0.123661585,
                            0.0012193192,
                            0.0020777362,
                            0.001562788,
                            0.0003593591,
                            0.00040522357,
                            0.00029610662],
                    'rmse': [0.030563513,
                             0.032697678,
                             0.02923397,
                             0.028204702,
                             0.030700188,
                             0.033906832,
                             0.0419414,
                             0.054405645,
                             0.0433924,
                             0.042461388,
                             0.02248163,
                             0.01900461,
                             0.02625006,
                             0.021864124,
                             0.021329135,
                             0.016618924,
                             0.018256553,
                             0.019046137,
                             0.017488264,
                             0.018649753,
                             0.015394884,
                             0.99077505,
                             0.01788126,
                             0.018578611,
                             0.018787391,
                             0.025586706,
                             0.35165548,
                             0.03491875,
                             0.04558219,
                             0.039532114,
                             0.01895677,
                             0.020130165,
                             0.01720775]},
 'spectra_realgan': {'cosine': [0.98116416,
                                0.9792906,
                                0.9832459,
                                0.98577976,
                                0.9814677,
                                0.98156124,
                                0.9668413,
                                0.9864012,
                                0.97883904,
                                0.9860042,
                                0.99519145,
                                0.9990496,
                                0.9932539,
                                0.9957636,
                                0.99784756,
                                0.9987711,
                                0.996565,
                                0.9971138,
                                0.9984994,
                                0.9972058,
                                0.9988238,
                                -0.64590436,
                                0.998654,
                                0.99946684,
                                0.999167,
                                0.9948542,
                                0.0073883943,
                                0.9878665,
                                0.97839326,
                                0.97260165,
                                0.99950576,
                                0.9981981,
                                0.99902624],
                     'mae': [0.025522962,
                             0.02819047,
                             0.024054082,
                             0.024406085,
                             0.026515229,
                             0.02765658,
                             0.0366096,
                             0.04644786,
                             0.033958904,
                             0.03557728,
                             0.01940579,
                             0.015161359,
                             0.022016011,
                             0.018857328,
                             0.018548708,
                             0.01466665,
                             0.016057845,
                             0.017318573,
                             0.015701028,
                             0.016630571,
                             0.01427325,
                             0.95920295,
                             0.01591568,
                             0.014694339,
                             0.014899051,
                             0.02259362,
                             0.3443543,
                             0.029696891,
                             0.03761046,
                             0.032620154,
                             0.014728023,
                             0.01795012,
                             0.014717337],
                     'max_mae': 0.95920295,
                     'max_mse': 0.9814932,
                     'max_rmse': 0.99070334,
                     'median_mae': 0.022016011,
                     'min_cosine': -0.64590436,
                     'mse': [0.0010776102,
                             0.0011927221,
                             0.0009870987,
                             0.00093792914,
                             0.0010650458,
                             0.0012817222,
                             0.0018940758,
                             0.0031226284,
                             0.0020291568,
                             0.0019350204,
                             0.0006385489,
                             0.00038157578,
                             0.000800654,
                             0.0005906596,
                             0.00055675977,
                             0.00037131037,
                             0.00044307986,
                             0.00047080207,
                             0.0003982088,
                             0.00046431867,
                             0.00033573667,
                             0.9814932,
                             0.00040745668,
                             0.00034584056,
                             0.00035928897,
                             0.00077649346,
                             0.123837024,
                             0.0013584506,
                             0.0021697725,
                             0.0016991112,
                             0.0003608177,
                             0.00051253545,
                             0.00036351563],
                     'rmse': [0.032826975,
                              0.03453581,
                              0.031418126,
                              0.030625628,
                              0.03263504,
                              0.03580115,
                              0.04352098,
                              0.055880483,
                              0.04504616,
                              0.04398887,
                              0.025269525,
                              0.019533964,
                              0.02829583,
                              0.02430349,
                              0.023595758,
                              0.019269416,
                              0.021049462,
                              0.021697974,
                              0.01995517,
                              0.021548055,
                              0.018323118,
                              0.99070334,
                              0.020185556,
                              0.018596789,
                              0.01895492,
                              0.027865632,
                              0.35190484,
                              0.036857165,
                              0.046580818,
                              0.041220278,
                              0.018995203,
                              0.022639247,
                              0.019066086]},
 'spectra_realpca': {'cosine': [0.99749637,
                                0.99752307,
                                0.997356,
                                0.9977354,
                                0.997477,
                                0.9974479,
                                0.997468,
                                0.9987545,
                                0.9979362,
                                0.99829084,
                                0.9989291,
                                0.9999519,
                                0.99896455,
                                0.9991228,
                                0.9994974,
                                0.99967813,
                                0.99904114,
                                0.99928886,
                                0.9996738,
                                0.99928874,
                                0.99964875,
                                0.9999959,
                                0.9997083,
                                0.9999972,
                                0.99998534,
                                0.9991795,
                                0.99840695,
                                0.9981812,
                                0.99823856,
                                0.9974883,
                                0.99999547,
                                0.99965936,
                                0.9998178],
                     'mae': [0.009419457,
                             0.009457352,
                             0.009769513,
                             0.009312919,
                             0.00952201,
                             0.009804035,
                             0.009566453,
                             0.010662238,
                             0.010036717,
                             0.010041405,
                             0.00867608,
                             0.0033533305,
                             0.008767113,
                             0.008608527,
                             0.008021071,
                             0.007711911,
                             0.008698487,
                             0.008424503,
                             0.0073564285,
                             0.008421346,
                             0.007863821,
                             0.0007995655,
                             0.0072419266,
                             0.0009865025,
                             0.0019672976,
                             0.008543075,
                             0.008949155,
                             0.010300653,
                             0.010257302,
                             0.009649051,
                             0.0011975607,
                             0.0076940972,
                             0.006182212],
                     'max_mae': 0.010662238,
                     'max_mse': 0.00019202523,
                     'max_rmse': 0.013857316,
                     'median_mae': 0.00867608,
                     'min_cosine': 0.997356,
                     'mse': [0.00014198608,
                             0.00014250391,
                             0.00015045665,
                             0.00013985712,
                             0.00014520677,
                             0.00015523784,
                             0.00014645405,
                             0.00019202523,
                             0.00016142636,
                             0.00016079591,
                             0.00012149677,
                             1.7971497e-05,
                             0.00012323359,
                             0.00011948924,
                             0.000103411854,
                             9.52752e-05,
                             0.00012259724,
                             0.0001144476,
                             8.684425e-05,
                             0.00011538503,
                             0.000100238656,
                             1.0526956e-06,
                             8.443591e-05,
                             1.5743544e-06,
                             6.1729775e-06,
                             0.00011729619,
                             0.00016958488,
                             0.000171651,
                             0.00017167148,
                             0.00014898607,
                             2.3260093e-06,
                             9.549722e-05,
                             6.1449384e-05],
                     'rmse': [0.011915791,
                              0.0119375,
                              0.012266077,
                              0.01182612,
                              0.012050177,
                              0.012459448,
                              0.012101821,
                              0.013857316,
                              0.012705367,
                              0.012680532,
                              0.0110225575,
                              0.0042392802,
                              0.011101062,
                              0.010931114,
                              0.0101691615,
                              0.009760901,
                              0.011072364,
                              0.010698019,
                              0.009319026,
                              0.010741742,
                              0.010011925,
                              0.0010260096,
                              0.009188902,
                              0.0012547328,
                              0.0024845477,
                              0.010830336,
                              0.013022476,
                              0.013101565,
                              0.013102346,
                              0.012205985,
                              0.0015251259,
                              0.009772268,
                              0.007838965]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_50.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521
Directory path: experiments/inpainting/gann_4_night_20180904_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_50.0/images
Optimal number of principal components:  20
Reconstruction error:  11.854828
Energy conservation:  0.5152052
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_50.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9519870688369956, 1.905282664493144],
                   'kl_div': 1.4628496,
                   'ks_tests': {10000: KstestResult(statistic=0.3893, pvalue=0.0, statistic_location=0.0022447351, statistic_sign=1),
                                20000: KstestResult(statistic=0.39385000000000003, pvalue=0.0, statistic_location=0.0021109008, statistic_sign=1),
                                30000: KstestResult(statistic=0.3949666666666667, pvalue=0.0, statistic_location=0.002285649, statistic_sign=1),
                                40000: KstestResult(statistic=0.39842500000000003, pvalue=0.0, statistic_location=0.0022187368, statistic_sign=1),
                                50000: KstestResult(statistic=0.39956, pvalue=0.0, statistic_location=0.0022832258, statistic_sign=1),
                                60000: KstestResult(statistic=0.39708333333333334, pvalue=0.0, statistic_location=0.0022220248, statistic_sign=1),
                                70000: KstestResult(statistic=0.3927571428571428, pvalue=0.0, statistic_location=0.0023965137, statistic_sign=1),
                                80000: KstestResult(statistic=0.39708750000000004, pvalue=0.0, statistic_location=0.0022255108, statistic_sign=1),
                                90000: KstestResult(statistic=0.39980000000000004, pvalue=0.0, statistic_location=0.0022361763, statistic_sign=1),
                                100000: KstestResult(statistic=0.3988999999999999, pvalue=0.0, statistic_location=0.0023125384, statistic_sign=1),
                                110000: KstestResult(statistic=0.3947909090909091, pvalue=0.0, statistic_location=0.002289703, statistic_sign=1)},
                   'moments': {'mean_error': 0.72582215,
                               'means': [0.00041185232, -2.9374622e-05],
                               'stds': [0.018056862, 0.0020431532],
                               'variance_ratio': 104.69388}},
 'originals': {'gan': {'mae': 0.015455946326255798,
                       'mse': 0.00040650571463629603,
                       'psnr': 33.482093811035156,
                       'rmse': 0.020161986351013184,
                       'ssim': 0.9744045734405518},
               'pca': {'mae': 0.001963410060852766,
                       'mse': 1.1786529285018332e-05,
                       'psnr': 49.28614044189453,
                       'rmse': 0.003433151403442025,
                       'ssim': 0.9997972846031189}},
 'reconstructions': {'mae': 0.015201364643871784,
                     'mse': 0.00039430518518202007,
                     'psnr': 34.04167556762695,
                     'rmse': 0.019857119768857956,
                     'ssim': 0.9745581746101379},
 'residual_spectra_pcagan': {'cosine': [0.037336618,
                                        0.0647419,
                                        0.049284074,
                                        0.039282005,
                                        0.03581567,
                                        0.048567943,
                                        0.06929873,
                                        0.06749288,
                                        0.20852642,
                                        0.22350174,
                                        0.23242344],
                             'mae': [0.011255448,
                                     0.013103741,
                                     0.012176288,
                                     0.01181695,
                                     0.013400943,
                                     0.0114825275,
                                     0.011091327,
                                     0.010474484,
                                     0.010243498,
                                     0.010001146,
                                     0.010201176],
                             'max_mae': 0.013400943,
                             'max_mse': 0.00053866196,
                             'max_rmse': 0.023209091,
                             'median_distance': 1.6990381,
                             'median_mae': 0.011255448,
                             'min_cosine': 0.03581567,
                             'mse': [0.00026665692,
                                     0.00048362292,
                                     0.0003176624,
                                     0.00029293026,
                                     0.00053866196,
                                     0.0003012887,
                                     0.00028427294,
                                     0.00025375086,
                                     0.00028858808,
                                     0.0002241303,
                                     0.0002886731],
                             'rmse': [0.016329633,
                                      0.021991428,
                                      0.017823087,
                                      0.017115206,
                                      0.023209091,
                                      0.01735767,
                                      0.016860396,
                                      0.01592956,
                                      0.01698788,
                                      0.0149709815,
                                      0.016990382]},
 'residuals': {'mae': 0.011386139318346977,
               'mse': 0.00032183987786993384,
               'psnr': 7.956155776977539,
               'rmse': 0.017939895391464233,
               'ssds': [35.88386, 0.45928305],
               'ssim': 0.2929089367389679},
 'spectra_pcagan': {'cosine': [0.9992144,
                               0.9991796,
                               0.999171,
                               0.99960196,
                               0.9997208,
                               0.99956906,
                               0.9995585,
                               0.9992319,
                               0.9984847,
                               0.9986742,
                               0.9983277],
                    'mae': [0.016203146,
                            0.016108612,
                            0.01652231,
                            0.014076434,
                            0.013353615,
                            0.013898006,
                            0.013613808,
                            0.014605871,
                            0.016432859,
                            0.01631135,
                            0.01608899],
                    'max_mae': 0.01652231,
                    'max_mse': 0.0004816142,
                    'max_rmse': 0.021945711,
                    'median_mae': 0.01608899,
                    'min_cosine': 0.9983277,
                    'mse': [0.0004288681,
                            0.00046720143,
                            0.00044362908,
                            0.00031575668,
                            0.00032496444,
                            0.00031593954,
                            0.00030448497,
                            0.00035552858,
                            0.0004816142,
                            0.0004440697,
                            0.00045530015],
                    'rmse': [0.02070913,
                             0.021614842,
                             0.021062505,
                             0.017769543,
                             0.01802677,
                             0.017774688,
                             0.017449498,
                             0.018855466,
                             0.021945711,
                             0.021072961,
                             0.021337764]},
 'spectra_realgan': {'cosine': [0.99921256,
                                0.99917614,
                                0.99916786,
                                0.99960107,
                                0.99972016,
                                0.9995682,
                                0.9995563,
                                0.9992264,
                                0.9983747,
                                0.9985742,
                                0.9981249],
                     'mae': [0.016233621,
                             0.016153421,
                             0.0165638,
                             0.014098686,
                             0.013369292,
                             0.013900637,
                             0.013645801,
                             0.014648158,
                             0.017151682,
                             0.017002659,
                             0.017247684],
                     'max_mae': 0.017247684,
                     'max_mse': 0.0005165957,
                     'max_rmse': 0.022728743,
                     'median_mae': 0.016153421,
                     'min_cosine': 0.9981249,
                     'mse': [0.00043035854,
                             0.0004691648,
                             0.0004453326,
                             0.00031667532,
                             0.00032550827,
                             0.0003164451,
                             0.00030629835,
                             0.00035814018,
                             0.0005165957,
                             0.00047740192,
                             0.0005096423],
                     'rmse': [0.020745086,
                              0.021660212,
                              0.021102905,
                              0.017795373,
                              0.018041847,
                              0.017788904,
                              0.017501382,
                              0.018924592,
                              0.022728743,
                              0.02184953,
                              0.02257526]},
 'spectra_realpca': {'cosine': [0.9999977,
                                0.99999774,
                                0.99999624,
                                0.9999992,
                                0.9999996,
                                0.9999992,
                                0.99999785,
                                0.9999925,
                                0.99990404,
                                0.9998933,
                                0.99979395],
                     'mae': [0.0008488882,
                             0.0008807938,
                             0.001115644,
                             0.0005333738,
                             0.000490275,
                             0.0005562077,
                             0.0009434065,
                             0.0014729281,
                             0.004297578,
                             0.004586499,
                             0.0058719153],
                     'max_mae': 0.0058719153,
                     'max_mse': 5.5273955e-05,
                     'max_rmse': 0.0074346457,
                     'median_mae': 0.0009434065,
                     'min_cosine': 0.99979395,
                     'mse': [1.156012e-06,
                             1.2502122e-06,
                             1.993936e-06,
                             4.604385e-07,
                             3.838831e-07,
                             4.9793226e-07,
                             1.4343219e-06,
                             3.4922987e-06,
                             2.970215e-05,
                             3.4006687e-05,
                             5.5273955e-05],
                     'rmse': [0.00107518,
                              0.0011181289,
                              0.0014120679,
                              0.0006785562,
                              0.000619583,
                              0.00070564315,
                              0.0011976318,
                              0.0018687693,
                              0.005449968,
                              0.005831525,
                              0.0074346457]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_50.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743
Directory path: experiments/inpainting/gann_4_night_20180904_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_50.0/images
Optimal number of principal components:  20
Reconstruction error:  11.854828
Energy conservation:  0.5152052
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_50.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9538435048012626, 2.355679018850844],
                   'kl_div': 1.0159086,
                   'ks_tests': {10000: KstestResult(statistic=0.2957, pvalue=1e-323, statistic_location=0.0035402644, statistic_sign=1),
                                20000: KstestResult(statistic=0.2942, pvalue=0.0, statistic_location=0.0029263678, statistic_sign=1),
                                30000: KstestResult(statistic=0.29523333333333335, pvalue=0.0, statistic_location=0.0028735702, statistic_sign=1),
                                40000: KstestResult(statistic=0.296025, pvalue=0.0, statistic_location=0.0030974778, statistic_sign=1),
                                50000: KstestResult(statistic=0.29484, pvalue=0.0, statistic_location=0.002815929, statistic_sign=1),
                                60000: KstestResult(statistic=0.2950999999999999, pvalue=0.0, statistic_location=0.002920472, statistic_sign=1),
                                70000: KstestResult(statistic=0.2934714285714286, pvalue=0.0, statistic_location=0.0030453533, statistic_sign=1),
                                80000: KstestResult(statistic=0.29528750000000004, pvalue=0.0, statistic_location=0.0030479734, statistic_sign=1),
                                90000: KstestResult(statistic=0.29400000000000004, pvalue=0.0, statistic_location=0.002925728, statistic_sign=1),
                                100000: KstestResult(statistic=0.29101, pvalue=0.0, statistic_location=0.0029710233, statistic_sign=1),
                                110000: KstestResult(statistic=0.2946181818181818, pvalue=0.0, statistic_location=0.0029272558, statistic_sign=1),
                                120000: KstestResult(statistic=0.2914, pvalue=0.0, statistic_location=0.0028309727, statistic_sign=1),
                                130000: KstestResult(statistic=0.29265384615384615, pvalue=0.0, statistic_location=0.0029354258, statistic_sign=1),
                                140000: KstestResult(statistic=0.2938642857142858, pvalue=0.0, statistic_location=0.0028959229, statistic_sign=1),
                                150000: KstestResult(statistic=0.2954866666666667, pvalue=0.0, statistic_location=0.0028938116, statistic_sign=1),
                                160000: KstestResult(statistic=0.294625, pvalue=0.0, statistic_location=0.0030471506, statistic_sign=1),
                                170000: KstestResult(statistic=0.2954941176470588, pvalue=0.0, statistic_location=0.002931167, statistic_sign=1),
                                180000: KstestResult(statistic=0.29280555555555554, pvalue=0.0, statistic_location=0.0030229376, statistic_sign=1),
                                190000: KstestResult(statistic=0.29282105263157887, pvalue=0.0, statistic_location=0.0030486886, statistic_sign=1),
                                200000: KstestResult(statistic=0.29437500000000005, pvalue=0.0, statistic_location=0.0029308293, statistic_sign=1),
                                210000: KstestResult(statistic=0.2925809523809524, pvalue=0.0, statistic_location=0.0028881095, statistic_sign=1),
                                220000: KstestResult(statistic=0.2954545454545455, pvalue=0.0, statistic_location=0.003083196, statistic_sign=1)},
                   'moments': {'mean_error': 0.059785888,
                               'means': [-0.00020164356, -2.450661e-05],
                               'stds': [0.016210506, 0.0032944607],
                               'variance_ratio': 24.86998}},
 'originals': {'gan': {'mae': 0.02280183508992195,
                       'mse': 0.0012677471386268735,
                       'psnr': 29.031415939331055,
                       'rmse': 0.03560543805360794,
                       'ssim': 0.9156923294067383},
               'pca': {'mae': 0.0038071691524237394,
                       'mse': 4.485501631279476e-05,
                       'psnr': 43.80497741699219,
                       'rmse': 0.006697388831526041,
                       'ssim': 0.9985576272010803}},
 'reconstructions': {'mae': 0.022146044299006462,
                     'mse': 0.0012233932502567768,
                     'psnr': 29.447429656982422,
                     'rmse': 0.03497703745961189,
                     'ssim': 0.9165177941322327},
 'residual_spectra_pcagan': {'cosine': [0.14703274,
                                        0.09204263,
                                        0.04506671,
                                        0.048748534,
                                        0.0668522,
                                        0.03450608,
                                        0.067011096,
                                        0.061070792,
                                        0.03338995,
                                        0.051075283,
                                        0.04493213,
                                        0.08306553,
                                        0.09305924,
                                        0.18555653,
                                        0.20796627,
                                        0.26348028,
                                        0.23020957,
                                        0.3656303,
                                        0.41860777,
                                        0.38182414,
                                        0.32521245,
                                        0.33824658],
                             'mae': [0.009517343,
                                     0.010164432,
                                     0.0112867,
                                     0.01174194,
                                     0.011279335,
                                     0.010611043,
                                     0.0121660065,
                                     0.010788624,
                                     0.0115466155,
                                     0.012146386,
                                     0.010557352,
                                     0.011226603,
                                     0.009797477,
                                     0.0108849155,
                                     0.01168153,
                                     0.010125965,
                                     0.009952467,
                                     0.0097854035,
                                     0.008226892,
                                     0.008318676,
                                     0.009632443,
                                     0.009042208],
                             'max_mae': 0.0121660065,
                             'max_mse': 0.00035515917,
                             'max_rmse': 0.018845666,
                             'median_distance': 1.5538163,
                             'median_mae': 0.010584198,
                             'min_cosine': 0.03338995,
                             'mse': [0.00018930233,
                                     0.00024486714,
                                     0.00033623696,
                                     0.00027147398,
                                     0.0002973842,
                                     0.00022112374,
                                     0.00035515917,
                                     0.0002325731,
                                     0.00026199096,
                                     0.00034495306,
                                     0.00023041629,
                                     0.0002504556,
                                     0.00018918379,
                                     0.00035325816,
                                     0.00028075886,
                                     0.00023802619,
                                     0.00020987177,
                                     0.0002180829,
                                     0.00014048404,
                                     0.00015984869,
                                     0.0003050896,
                                     0.00022546589],
                             'rmse': [0.013758718,
                                      0.01564823,
                                      0.018336765,
                                      0.016476467,
                                      0.01724483,
                                      0.01487023,
                                      0.018845666,
                                      0.015250348,
                                      0.016186135,
                                      0.018572912,
                                      0.015179469,
                                      0.01582579,
                                      0.01375441,
                                      0.018795162,
                                      0.01675586,
                                      0.015428097,
                                      0.014486952,
                                      0.01476763,
                                      0.011852597,
                                      0.012643128,
                                      0.017466815,
                                      0.015015522]},
 'residuals': {'mae': 0.010476379655301571,
               'mse': 0.0002525457239244133,
               'psnr': 12.497049331665039,
               'rmse': 0.01589168794453144,
               'ssds': [57.820404, 2.3878849],
               'ssim': 0.35353216528892517},
 'spectra_pcagan': {'cosine': [0.99877983,
                               0.998935,
                               0.99886763,
                               0.99955606,
                               0.9990256,
                               0.99928087,
                               0.9992387,
                               0.9992956,
                               0.9996027,
                               0.9997602,
                               0.9996046,
                               0.9995253,
                               0.9992284,
                               0.99817026,
                               0.997723,
                               0.99819875,
                               0.9668183,
                               0.99577916,
                               0.9862834,
                               0.98999995,
                               0.99619627,
                               0.991391],
                    'mae': [0.016505731,
                            0.017712297,
                            0.017045068,
                            0.013810784,
                            0.016695263,
                            0.015700283,
                            0.015613554,
                            0.01568591,
                            0.013684755,
                            0.011823854,
                            0.012658174,
                            0.013881192,
                            0.015892584,
                            0.017636044,
                            0.024909576,
                            0.017597094,
                            0.121476576,
                            0.021042844,
                            0.028141145,
                            0.020787552,
                            0.017440166,
                            0.021472506],
                    'max_mae': 0.121476576,
                    'max_mse': 0.015682278,
                    'max_rmse': 0.1252289,
                    'median_mae': 0.016870165,
                    'min_cosine': 0.9668183,
                    'mse': [0.00044174909,
                            0.0005114644,
                            0.00051320315,
                            0.00031361484,
                            0.000464231,
                            0.0003920297,
                            0.00042439016,
                            0.00039256114,
                            0.00030242128,
                            0.00023605638,
                            0.00027230664,
                            0.00031241472,
                            0.00041136876,
                            0.0005746944,
                            0.00097072916,
                            0.0005278419,
                            0.015682278,
                            0.000758773,
                            0.0011939256,
                            0.0007635705,
                            0.0006509859,
                            0.00080403977],
                    'rmse': [0.021017827,
                             0.022615578,
                             0.022653988,
                             0.017709173,
                             0.021546021,
                             0.01979974,
                             0.020600732,
                             0.019813156,
                             0.017390264,
                             0.015364126,
                             0.016501717,
                             0.017675256,
                             0.020282228,
                             0.023972785,
                             0.031156527,
                             0.02297481,
                             0.1252289,
                             0.027545834,
                             0.03455323,
                             0.027632779,
                             0.025514426,
                             0.028355595]},
 'spectra_realgan': {'cosine': [0.9987396,
                                0.9989243,
                                0.99886256,
                                0.99955493,
                                0.99901724,
                                0.99927926,
                                0.99923575,
                                0.99929065,
                                0.99960226,
                                0.99975926,
                                0.9996036,
                                0.9995221,
                                0.99922085,
                                0.99805737,
                                0.9976132,
                                0.99797523,
                                0.9666503,
                                0.9949535,
                                0.984298,
                                0.9879464,
                                0.99525267,
                                0.9898604],
                     'mae': [0.016757052,
                             0.01776943,
                             0.017111506,
                             0.013834872,
                             0.0167574,
                             0.015726216,
                             0.01565067,
                             0.015732458,
                             0.013697854,
                             0.011840964,
                             0.012670945,
                             0.013934802,
                             0.015932746,
                             0.01829151,
                             0.025283307,
                             0.01878223,
                             0.121640146,
                             0.02306464,
                             0.029755997,
                             0.023321165,
                             0.020485954,
                             0.02359859],
                     'max_mae': 0.121640146,
                     'max_mse': 0.015760576,
                     'max_rmse': 0.12554114,
                     'median_mae': 0.016934454,
                     'min_cosine': 0.9666503,
                     'mse': [0.00045415564,
                             0.00051528675,
                             0.000515586,
                             0.00031446983,
                             0.00046746092,
                             0.00039325724,
                             0.00042603846,
                             0.00039517556,
                             0.00030298816,
                             0.00023683214,
                             0.00027307443,
                             0.0003145451,
                             0.00041389908,
                             0.0006093973,
                             0.0010026107,
                             0.00058755954,
                             0.015760576,
                             0.0008938459,
                             0.0013499834,
                             0.000919582,
                             0.0007951073,
                             0.0009490078],
                     'rmse': [0.021310927,
                              0.022699928,
                              0.022706518,
                              0.017733296,
                              0.021620845,
                              0.019830715,
                              0.0206407,
                              0.019879023,
                              0.017406555,
                              0.015389351,
                              0.016524963,
                              0.01773542,
                              0.02034451,
                              0.024685973,
                              0.03166403,
                              0.024239628,
                              0.12554114,
                              0.029897256,
                              0.03674212,
                              0.03032461,
                              0.028197646,
                              0.03080597]},
 'spectra_realpca': {'cosine': [0.9999551,
                                0.99999243,
                                0.9999946,
                                0.9999996,
                                0.9999924,
                                0.9999977,
                                0.99999774,
                                0.99999624,
                                0.9999992,
                                0.9999996,
                                0.9999992,
                                0.99999785,
                                0.9999925,
                                0.99990404,
                                0.9998933,
                                0.99979395,
                                0.99982667,
                                0.9991424,
                                0.9977814,
                                0.9977374,
                                0.99903876,
                                0.998309],
                     'mae': [0.0030153668,
                             0.0013783128,
                             0.001209138,
                             0.00048075686,
                             0.001452473,
                             0.0008488882,
                             0.0008807938,
                             0.001115644,
                             0.0005333738,
                             0.000490275,
                             0.0005562077,
                             0.0009434065,
                             0.0014729281,
                             0.004297578,
                             0.004586499,
                             0.0058719153,
                             0.005195912,
                             0.009291722,
                             0.010320521,
                             0.010318696,
                             0.009567635,
                             0.009929673],
                     'max_mae': 0.010320521,
                     'max_mse': 0.00017213606,
                     'max_rmse': 0.013120064,
                     'median_mae': 0.0014627005,
                     'min_cosine': 0.9977374,
                     'mse': [1.4743528e-05,
                             3.0574026e-06,
                             2.3175055e-06,
                             3.681509e-07,
                             3.3725914e-06,
                             1.156012e-06,
                             1.2502122e-06,
                             1.993936e-06,
                             4.604385e-07,
                             3.838831e-07,
                             4.9793226e-07,
                             1.4343219e-06,
                             3.4922987e-06,
                             2.970215e-05,
                             3.4006687e-05,
                             5.5273955e-05,
                             4.4283704e-05,
                             0.00013936176,
                             0.00017213606,
                             0.00017015732,
                             0.00014846133,
                             0.00015889922],
                     'rmse': [0.00383973,
                              0.001748543,
                              0.0015223356,
                              0.0006067544,
                              0.0018364617,
                              0.00107518,
                              0.0011181289,
                              0.0014120679,
                              0.0006785562,
                              0.000619583,
                              0.00070564315,
                              0.0011976318,
                              0.0018687693,
                              0.005449968,
                              0.005831525,
                              0.0074346457,
                              0.0066546,
                              0.011805158,
                              0.013120064,
                              0.013044436,
                              0.012184471,
                              0.012605524]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_50.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658
Directory path: experiments/inpainting/gann_4_night_20180904_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_50.0/images
Optimal number of principal components:  20
Reconstruction error:  11.854828
Energy conservation:  0.5152052
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_50.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9187742426194503, 2.5928298442827424],
                   'kl_div': 0.7666722,
                   'ks_tests': {10000: KstestResult(statistic=0.2671, pvalue=4.870096159e-314, statistic_location=0.0037294822, statistic_sign=1),
                                20000: KstestResult(statistic=0.26615, pvalue=0.0, statistic_location=0.0034895414, statistic_sign=1),
                                30000: KstestResult(statistic=0.2677666666666667, pvalue=0.0, statistic_location=0.0032853023, statistic_sign=1),
                                40000: KstestResult(statistic=0.26460000000000006, pvalue=0.0, statistic_location=0.0035916318, statistic_sign=1),
                                50000: KstestResult(statistic=0.2659, pvalue=0.0, statistic_location=0.003734284, statistic_sign=1),
                                60000: KstestResult(statistic=0.2648166666666667, pvalue=0.0, statistic_location=0.0034035295, statistic_sign=1),
                                70000: KstestResult(statistic=0.2638857142857143, pvalue=0.0, statistic_location=0.0034517376, statistic_sign=1),
                                80000: KstestResult(statistic=0.26332500000000003, pvalue=0.0, statistic_location=0.0035985708, statistic_sign=1),
                                90000: KstestResult(statistic=0.2641888888888888, pvalue=0.0, statistic_location=0.0033705237, statistic_sign=1),
                                100000: KstestResult(statistic=0.26537999999999995, pvalue=0.0, statistic_location=0.003413401, statistic_sign=1),
                                110000: KstestResult(statistic=0.26542727272727273, pvalue=0.0, statistic_location=0.0035341526, statistic_sign=1),
                                120000: KstestResult(statistic=0.266575, pvalue=0.0, statistic_location=0.003421906, statistic_sign=1),
                                130000: KstestResult(statistic=0.26572307692307695, pvalue=0.0, statistic_location=0.003345952, statistic_sign=1),
                                140000: KstestResult(statistic=0.26467857142857143, pvalue=0.0, statistic_location=0.0033410487, statistic_sign=1),
                                150000: KstestResult(statistic=0.2641066666666667, pvalue=0.0, statistic_location=0.0034146942, statistic_sign=1),
                                160000: KstestResult(statistic=0.26616875000000007, pvalue=0.0, statistic_location=0.0033602705, statistic_sign=1),
                                170000: KstestResult(statistic=0.2624705882352941, pvalue=0.0, statistic_location=0.0037040163, statistic_sign=1),
                                180000: KstestResult(statistic=0.26584444444444444, pvalue=0.0, statistic_location=0.0035617058, statistic_sign=1),
                                190000: KstestResult(statistic=0.2640368421052631, pvalue=0.0, statistic_location=0.003295973, statistic_sign=1),
                                200000: KstestResult(statistic=0.26497000000000004, pvalue=0.0, statistic_location=0.0035868394, statistic_sign=1),
                                210000: KstestResult(statistic=0.2641285714285714, pvalue=0.0, statistic_location=0.0033104972, statistic_sign=1),
                                220000: KstestResult(statistic=0.264390909090909, pvalue=0.0, statistic_location=0.0036776187, statistic_sign=1),
                                230000: KstestResult(statistic=0.2659869565217391, pvalue=0.0, statistic_location=0.0035735485, statistic_sign=1),
                                240000: KstestResult(statistic=0.26536666666666664, pvalue=0.0, statistic_location=0.0034033197, statistic_sign=1),
                                250000: KstestResult(statistic=0.264564, pvalue=0.0, statistic_location=0.0035611135, statistic_sign=1),
                                260000: KstestResult(statistic=0.2658730769230768, pvalue=0.0, statistic_location=0.0035803802, statistic_sign=1),
                                270000: KstestResult(statistic=0.2645518518518518, pvalue=0.0, statistic_location=0.0035345608, statistic_sign=1),
                                280000: KstestResult(statistic=0.26415357142857143, pvalue=0.0, statistic_location=0.003414512, statistic_sign=1),
                                290000: KstestResult(statistic=0.2661137931034483, pvalue=0.0, statistic_location=0.0034087999, statistic_sign=1),
                                300000: KstestResult(statistic=0.2648866666666667, pvalue=0.0, statistic_location=0.0037297448, statistic_sign=1),
                                310000: KstestResult(statistic=0.264941935483871, pvalue=0.0, statistic_location=0.0035745231, statistic_sign=1),
                                320000: KstestResult(statistic=0.2661625000000001, pvalue=0.0, statistic_location=0.003417925, statistic_sign=1),
                                330000: KstestResult(statistic=0.2668242424242424, pvalue=0.0, statistic_location=0.003310266, statistic_sign=1)},
                   'moments': {'mean_error': 0.16781636,
                               'means': [0.00036934364, -1.3717745e-05],
                               'stds': [0.015899327, 0.0038945437],
                               'variance_ratio': 14.20828}},
 'originals': {'gan': {'mae': 0.024681715294718742,
                       'mse': 0.001282235374674201,
                       'psnr': 30.239980697631836,
                       'rmse': 0.03580831363797188,
                       'ssim': 0.9119683504104614},
               'pca': {'mae': 0.005269715096801519,
                       'mse': 7.395839202217758e-05,
                       'psnr': 43.03854751586914,
                       'rmse': 0.008599906228482723,
                       'ssim': 0.9969360828399658}},
 'reconstructions': {'mae': 0.023803334683179855,
                     'mse': 0.0012059509754180908,
                     'psnr': 30.91512680053711,
                     'rmse': 0.03472680598497391,
                     'ssim': 0.9143328070640564},
 'residual_spectra_pcagan': {'cosine': [0.3677711,
                                        0.41907957,
                                        0.37741336,
                                        0.16968183,
                                        0.070691355,
                                        0.057418164,
                                        0.1555883,
                                        0.09074598,
                                        0.043454554,
                                        0.040379975,
                                        0.060965363,
                                        0.031186761,
                                        0.069793165,
                                        0.071115494,
                                        0.039447907,
                                        0.03937957,
                                        0.04171326,
                                        0.05583812,
                                        0.087596044,
                                        0.2602756,
                                        0.27206612,
                                        0.19471467,
                                        0.260317,
                                        0.39785942,
                                        0.41094533,
                                        0.37627044,
                                        0.33062285,
                                        0.44029203,
                                        0.35889152,
                                        0.26078317,
                                        0.345988,
                                        0.3595353,
                                        0.42066398],
                             'mae': [0.008680407,
                                     0.0079693645,
                                     0.00821313,
                                     0.00961728,
                                     0.009364067,
                                     0.0111292815,
                                     0.010415136,
                                     0.01140453,
                                     0.01230912,
                                     0.012594657,
                                     0.010995521,
                                     0.011000296,
                                     0.011470416,
                                     0.010200117,
                                     0.011366044,
                                     0.01146274,
                                     0.0114390105,
                                     0.010729843,
                                     0.009312771,
                                     0.00940051,
                                     0.008467374,
                                     0.0118796965,
                                     0.009489231,
                                     0.008860645,
                                     0.008393466,
                                     0.008532318,
                                     0.009615886,
                                     0.0078086015,
                                     0.0091581745,
                                     0.010250801,
                                     0.009047585,
                                     0.009587203,
                                     0.007961104],
                             'max_mae': 0.012594657,
                             'max_mse': 0.0004715254,
                             'max_rmse': 0.021714635,
                             'median_distance': 1.4584471,
                             'median_mae': 0.009615886,
                             'min_cosine': 0.031186761,
                             'mse': [0.0002091158,
                                     0.00014684023,
                                     0.00018501954,
                                     0.00019372112,
                                     0.0001690499,
                                     0.00030842086,
                                     0.0002127068,
                                     0.00029517268,
                                     0.0004715254,
                                     0.0003485774,
                                     0.00028441433,
                                     0.00025767565,
                                     0.0002978231,
                                     0.00020172009,
                                     0.00026307095,
                                     0.00027577547,
                                     0.00029013096,
                                     0.00023269918,
                                     0.0001657931,
                                     0.0001737958,
                                     0.00013566342,
                                     0.00036530563,
                                     0.00018638787,
                                     0.00020177617,
                                     0.00015681518,
                                     0.00017535708,
                                     0.0003056409,
                                     0.00014418214,
                                     0.00022177961,
                                     0.00038931626,
                                     0.00023568251,
                                     0.00020598917,
                                     0.00014477447],
                             'rmse': [0.014460837,
                                      0.012117765,
                                      0.013602189,
                                      0.013918374,
                                      0.01300192,
                                      0.017561914,
                                      0.0145844715,
                                      0.01718059,
                                      0.021714635,
                                      0.018670227,
                                      0.016864588,
                                      0.01605228,
                                      0.017257553,
                                      0.01420282,
                                      0.016219461,
                                      0.01660649,
                                      0.01703323,
                                      0.015254481,
                                      0.012876067,
                                      0.0131831635,
                                      0.011647464,
                                      0.01911297,
                                      0.0136523945,
                                      0.014204794,
                                      0.012522587,
                                      0.013242247,
                                      0.017482588,
                                      0.012007587,
                                      0.014892267,
                                      0.019731099,
                                      0.015351955,
                                      0.014352323,
                                      0.012032227]},
 'residuals': {'mae': 0.00994322169572115,
               'mse': 0.00023793087166268378,
               'psnr': 12.755942344665527,
               'rmse': 0.015425007790327072,
               'ssds': [83.46498, 5.005311],
               'ssim': 0.39895182847976685},
 'spectra_pcagan': {'cosine': [0.9840592,
                               0.9867694,
                               0.98386496,
                               0.99874634,
                               0.99877256,
                               0.99870235,
                               0.99832064,
                               0.99868345,
                               0.99838877,
                               0.99947166,
                               0.9990639,
                               0.99915934,
                               0.9993206,
                               0.99926126,
                               0.99959534,
                               0.9997636,
                               0.99956024,
                               0.99957925,
                               0.9992281,
                               0.99858576,
                               0.998771,
                               0.9979163,
                               0.96717286,
                               0.99637944,
                               0.986165,
                               0.9830111,
                               0.9950457,
                               0.99075705,
                               0.97731,
                               0.9794792,
                               0.98890233,
                               0.9857281,
                               0.9844337],
                    'mae': [0.02748902,
                            0.024755264,
                            0.025725974,
                            0.016342258,
                            0.017317597,
                            0.017898846,
                            0.023029136,
                            0.017568784,
                            0.020254573,
                            0.014696112,
                            0.016836444,
                            0.016422551,
                            0.015099492,
                            0.015375644,
                            0.013854108,
                            0.012057276,
                            0.013562657,
                            0.013135692,
                            0.015728997,
                            0.016668268,
                            0.015480003,
                            0.020247016,
                            0.11882042,
                            0.017843932,
                            0.02721947,
                            0.029663611,
                            0.020217787,
                            0.025585035,
                            0.0407617,
                            0.037569188,
                            0.022664282,
                            0.027356122,
                            0.028262792],
                    'max_mae': 0.11882042,
                    'max_mse': 0.015134802,
                    'max_rmse': 0.123023584,
                    'median_mae': 0.017898846,
                    'min_cosine': 0.96717286,
                    'mse': [0.001232629,
                            0.0010133552,
                            0.0011066208,
                            0.00045141554,
                            0.00047914402,
                            0.00055515236,
                            0.0007918481,
                            0.0005387825,
                            0.0007666749,
                            0.0003833527,
                            0.00047407683,
                            0.0004373227,
                            0.0003903461,
                            0.00039542318,
                            0.00030801425,
                            0.00024301886,
                            0.00030684544,
                            0.00027643505,
                            0.00040694533,
                            0.00045500413,
                            0.00039125176,
                            0.00072059024,
                            0.015134802,
                            0.0005876994,
                            0.0011072858,
                            0.0012911852,
                            0.00076400395,
                            0.0009823012,
                            0.0022460418,
                            0.0023268042,
                            0.0008994139,
                            0.0011306212,
                            0.0012019718],
                    'rmse': [0.035108816,
                             0.03183324,
                             0.03326591,
                             0.021246541,
                             0.021889359,
                             0.023561671,
                             0.028139796,
                             0.02321169,
                             0.027688894,
                             0.019579394,
                             0.021773305,
                             0.020912262,
                             0.019757178,
                             0.01988525,
                             0.017550334,
                             0.015589062,
                             0.017517004,
                             0.016626336,
                             0.020172887,
                             0.021330826,
                             0.019780084,
                             0.026843812,
                             0.123023584,
                             0.024242513,
                             0.033275906,
                             0.035933066,
                             0.027640622,
                             0.031341683,
                             0.047392424,
                             0.04823696,
                             0.02999023,
                             0.033624712,
                             0.034669466]},
 'spectra_realgan': {'cosine': [0.98141015,
                                0.9843909,
                                0.9813762,
                                0.998694,
                                0.99876475,
                                0.998695,
                                0.99827635,
                                0.9986738,
                                0.99838275,
                                0.99947095,
                                0.9990575,
                                0.9991575,
                                0.9993171,
                                0.9992573,
                                0.99959457,
                                0.9997631,
                                0.9995594,
                                0.99957675,
                                0.9992216,
                                0.9984775,
                                0.9986738,
                                0.99772567,
                                0.966982,
                                0.99548286,
                                0.98398364,
                                0.98089397,
                                0.99406666,
                                0.98900443,
                                0.9749063,
                                0.9770541,
                                0.9866472,
                                0.983708,
                                0.9820773],
                     'mae': [0.02962637,
                             0.027000336,
                             0.027748046,
                             0.016723743,
                             0.017359708,
                             0.017962644,
                             0.02319684,
                             0.017637543,
                             0.020328026,
                             0.014714845,
                             0.016874673,
                             0.016448077,
                             0.0151455905,
                             0.015428474,
                             0.01386698,
                             0.012075261,
                             0.013569914,
                             0.013181128,
                             0.015765777,
                             0.017301837,
                             0.016131334,
                             0.021170821,
                             0.119005784,
                             0.020582903,
                             0.029041281,
                             0.031272855,
                             0.022660008,
                             0.027383331,
                             0.041740462,
                             0.03928247,
                             0.025126211,
                             0.029079247,
                             0.030063953],
                     'max_mae': 0.119005784,
                     'max_mse': 0.01521645,
                     'max_rmse': 0.12335498,
                     'median_mae': 0.020328026,
                     'min_cosine': 0.966982,
                     'mse': [0.0014242317,
                             0.0011915098,
                             0.0012812482,
                             0.00046994086,
                             0.00048244992,
                             0.0005582715,
                             0.0008044162,
                             0.0005424466,
                             0.00076968677,
                             0.00038412426,
                             0.0004763649,
                             0.00043851513,
                             0.0003923721,
                             0.00039760064,
                             0.00030877718,
                             0.00024360299,
                             0.0003075379,
                             0.0002780892,
                             0.00040905952,
                             0.0004880081,
                             0.00042263413,
                             0.0007708765,
                             0.01521645,
                             0.0007336408,
                             0.0012789788,
                             0.0014530626,
                             0.0009155981,
                             0.0011494025,
                             0.0024373343,
                             0.0025418864,
                             0.0010731391,
                             0.0012941421,
                             0.0013783609],
                     'rmse': [0.037738994,
                              0.034518253,
                              0.035794526,
                              0.02167812,
                              0.021964742,
                              0.02362777,
                              0.028362231,
                              0.023290483,
                              0.02774323,
                              0.019599088,
                              0.021825785,
                              0.020940753,
                              0.019808386,
                              0.019939926,
                              0.017572057,
                              0.015607786,
                              0.01753676,
                              0.016676007,
                              0.02022522,
                              0.022090906,
                              0.020558067,
                              0.027764663,
                              0.12335498,
                              0.027085805,
                              0.035762813,
                              0.03811906,
                              0.030258851,
                              0.03390284,
                              0.049369365,
                              0.050417125,
                              0.032758802,
                              0.035974186,
                              0.037126284]},
 'spectra_realpca': {'cosine': [0.9974603,
                                0.9976862,
                                0.9973418,
                                0.9999515,
                                0.9999921,
                                0.99999464,
                                0.9999551,
                                0.99999243,
                                0.9999946,
                                0.9999996,
                                0.9999924,
                                0.9999977,
                                0.99999774,
                                0.99999624,
                                0.9999992,
                                0.9999996,
                                0.9999992,
                                0.99999785,
                                0.9999925,
                                0.99990404,
                                0.9998933,
                                0.99979395,
                                0.99982667,
                                0.9991424,
                                0.9977814,
                                0.9977374,
                                0.99903876,
                                0.998309,
                                0.99770045,
                                0.9976375,
                                0.9977996,
                                0.9978153,
                                0.9976358],
                     'mae': [0.010652762,
                             0.010249893,
                             0.010776318,
                             0.0031563968,
                             0.0013156277,
                             0.0011701528,
                             0.0030153668,
                             0.0013783128,
                             0.001209138,
                             0.00048075686,
                             0.001452473,
                             0.0008488882,
                             0.0008807938,
                             0.001115644,
                             0.0005333738,
                             0.000490275,
                             0.0005562077,
                             0.0009434065,
                             0.0014729281,
                             0.004297578,
                             0.004586499,
                             0.0058719153,
                             0.005195912,
                             0.009291722,
                             0.010320521,
                             0.010318696,
                             0.009567635,
                             0.009929673,
                             0.010392289,
                             0.01124155,
                             0.010349568,
                             0.010427509,
                             0.010410821],
                     'max_mae': 0.01124155,
                     'max_mse': 0.00020302644,
                     'max_rmse': 0.014248735,
                     'median_mae': 0.004297578,
                     'min_cosine': 0.9973418,
                     'mse': [0.00018126261,
                             0.00017075044,
                             0.00018434966,
                             1.605752e-05,
                             2.7788292e-06,
                             2.2031152e-06,
                             1.4743528e-05,
                             3.0574026e-06,
                             2.3175055e-06,
                             3.681509e-07,
                             3.3725914e-06,
                             1.156012e-06,
                             1.2502122e-06,
                             1.993936e-06,
                             4.604385e-07,
                             3.838831e-07,
                             4.9793226e-07,
                             1.4343219e-06,
                             3.4922987e-06,
                             2.970215e-05,
                             3.4006687e-05,
                             5.5273955e-05,
                             4.4283704e-05,
                             0.00013936176,
                             0.00017213606,
                             0.00017015732,
                             0.00014846133,
                             0.00015889922,
                             0.00017346659,
                             0.00020302644,
                             0.00017159108,
                             0.00017449801,
                             0.00017383244],
                     'rmse': [0.013463381,
                              0.013067151,
                              0.013577542,
                              0.0040071835,
                              0.0016669821,
                              0.0014842894,
                              0.00383973,
                              0.001748543,
                              0.0015223356,
                              0.0006067544,
                              0.0018364617,
                              0.00107518,
                              0.0011181289,
                              0.0014120679,
                              0.0006785562,
                              0.000619583,
                              0.00070564315,
                              0.0011976318,
                              0.0018687693,
                              0.005449968,
                              0.005831525,
                              0.0074346457,
                              0.0066546,
                              0.011805158,
                              0.013120064,
                              0.013044436,
                              0.012184471,
                              0.012605524,
                              0.013170672,
                              0.014248735,
                              0.013099277,
                              0.0132097695,
                              0.013184553]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_50.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734
Directory path: experiments/inpainting/gann_4_night_20210905_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_50.0/images
Optimal number of principal components:  22
Reconstruction error:  8.5416355
Energy conservation:  0.5136088
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_50.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.8998554886731998, 2.7866339318045763],
                   'kl_div': 0.56320924,
                   'ks_tests': {10000: KstestResult(statistic=0.2371, pvalue=6.734311005568024e-247, statistic_location=-0.0042350413, statistic_sign=-1),
                                20000: KstestResult(statistic=0.23615000000000003, pvalue=0.0, statistic_location=-0.0049996097, statistic_sign=-1),
                                30000: KstestResult(statistic=0.23966666666666664, pvalue=0.0, statistic_location=-0.0049861134, statistic_sign=-1),
                                40000: KstestResult(statistic=0.236675, pvalue=0.0, statistic_location=-0.004538536, statistic_sign=-1),
                                50000: KstestResult(statistic=0.24112, pvalue=0.0, statistic_location=-0.0050188387, statistic_sign=-1),
                                60000: KstestResult(statistic=0.23719999999999997, pvalue=0.0, statistic_location=-0.00517565, statistic_sign=-1),
                                70000: KstestResult(statistic=0.23645714285714287, pvalue=0.0, statistic_location=-0.0049396306, statistic_sign=-1),
                                80000: KstestResult(statistic=0.24155, pvalue=0.0, statistic_location=-0.004948369, statistic_sign=-1),
                                90000: KstestResult(statistic=0.23635555555555557, pvalue=0.0, statistic_location=-0.0045696218, statistic_sign=-1),
                                100000: KstestResult(statistic=0.23715000000000003, pvalue=0.0, statistic_location=-0.004389899, statistic_sign=-1),
                                110000: KstestResult(statistic=0.23830909090909091, pvalue=0.0, statistic_location=-0.005018793, statistic_sign=-1)},
                   'moments': {'mean_error': -0.2745164,
                               'means': [-0.0013864677, -4.459311e-06],
                               'stds': [0.016771028, 0.004098189],
                               'variance_ratio': 11.493128}},
 'originals': {'gan': {'mae': 0.023048575967550278,
                       'mse': 0.0009045966435223818,
                       'psnr': 30.321165084838867,
                       'rmse': 0.030076513066887856,
                       'ssim': 0.9525923132896423},
               'pca': {'mae': 0.006572507321834564,
                       'mse': 8.415383490500972e-05,
                       'psnr': 41.10622024536133,
                       'rmse': 0.009173540398478508,
                       'ssim': 0.9947772026062012}},
 'reconstructions': {'mae': 0.021868638694286346,
                     'mse': 0.0008227720973081887,
                     'psnr': 31.204166412353516,
                     'rmse': 0.02868400327861309,
                     'ssim': 0.95733642578125},
 'residual_spectra_pcagan': {'cosine': [0.097058676,
                                        0.08159839,
                                        0.09883533,
                                        0.27975824,
                                        0.23851816,
                                        0.27171102,
                                        0.26422936,
                                        0.3243286,
                                        0.25853714,
                                        0.3054693,
                                        0.27077842],
                             'mae': [0.010546331,
                                     0.011884763,
                                     0.010092706,
                                     0.010475975,
                                     0.010420597,
                                     0.009118384,
                                     0.009936902,
                                     0.008362435,
                                     0.009380128,
                                     0.010231499,
                                     0.0102689],
                             'max_mae': 0.011884763,
                             'max_mse': 0.00038424475,
                             'max_rmse': 0.01960216,
                             'median_distance': 1.6042132,
                             'median_mae': 0.010231499,
                             'min_cosine': 0.08159839,
                             'mse': [0.00023195682,
                                     0.00037715616,
                                     0.00023432098,
                                     0.0002589075,
                                     0.00038424475,
                                     0.00025735,
                                     0.00023089001,
                                     0.00015660639,
                                     0.00029022424,
                                     0.00023875633,
                                     0.00027991773],
                             'rmse': [0.015230129,
                                      0.019420508,
                                      0.015307547,
                                      0.016090604,
                                      0.01960216,
                                      0.016042132,
                                      0.015195065,
                                      0.012514248,
                                      0.017035969,
                                      0.015451742,
                                      0.016730743]},
 'residuals': {'mae': 0.01006532832980156,
               'mse': 0.00026730282115750015,
               'psnr': 9.002347946166992,
               'rmse': 0.016349397599697113,
               'ssds': [31.150585, 1.8474525],
               'ssim': 0.36404481530189514},
 'spectra_pcagan': {'cosine': [0.99847007,
                               0.99866736,
                               0.99810874,
                               0.99592215,
                               0.99480546,
                               0.99642617,
                               0.98500293,
                               0.985609,
                               0.9872376,
                               0.98831254,
                               0.98973113],
                    'mae': [0.017695587,
                            0.017500613,
                            0.017506603,
                            0.0236401,
                            0.022367332,
                            0.01814002,
                            0.026314212,
                            0.025786512,
                            0.023277119,
                            0.023288183,
                            0.025038732],
                    'max_mae': 0.026314212,
                    'max_mse': 0.0011288598,
                    'max_rmse': 0.03359851,
                    'median_mae': 0.023277119,
                    'min_cosine': 0.98500293,
                    'mse': [0.00052299147,
                            0.0005345723,
                            0.00050916517,
                            0.00091602275,
                            0.0008374227,
                            0.00062718947,
                            0.0011288598,
                            0.0010459088,
                            0.0009495184,
                            0.00094149925,
                            0.0010373432],
                    'rmse': [0.022869006,
                             0.023120819,
                             0.022564689,
                             0.030265868,
                             0.028938256,
                             0.02504375,
                             0.03359851,
                             0.03234051,
                             0.030814257,
                             0.03068386,
                             0.032207813]},
 'spectra_realgan': {'cosine': [0.998458,
                                0.9986554,
                                0.99807423,
                                0.99538594,
                                0.99427664,
                                0.9958382,
                                0.9834679,
                                0.9838168,
                                0.9854401,
                                0.98703116,
                                0.9884639],
                     'mae': [0.017761111,
                             0.01758192,
                             0.01767319,
                             0.024944576,
                             0.023610331,
                             0.020209806,
                             0.027729956,
                             0.02750988,
                             0.02518428,
                             0.024926186,
                             0.026403077],
                     'max_mae': 0.027729956,
                     'max_mse': 0.0012457987,
                     'max_rmse': 0.035295874,
                     'median_mae': 0.024926186,
                     'min_cosine': 0.9834679,
                     'mse': [0.000526641,
                             0.0005392051,
                             0.00051849126,
                             0.0010091561,
                             0.0009227501,
                             0.0007264325,
                             0.0012457987,
                             0.0011789148,
                             0.0010824219,
                             0.0010480924,
                             0.0011526594],
                     'rmse': [0.02294866,
                              0.02322079,
                              0.022770403,
                              0.03176722,
                              0.030376801,
                              0.026952412,
                              0.035295874,
                              0.03433533,
                              0.03290018,
                              0.032374255,
                              0.03395084]},
 'spectra_realpca': {'cosine': [0.9999877,
                                0.9999925,
                                0.99997735,
                                0.9994823,
                                0.99946415,
                                0.9993942,
                                0.9982729,
                                0.9981971,
                                0.9982434,
                                0.9984338,
                                0.9986859],
                     'mae': [0.001596631,
                             0.0013634961,
                             0.0019441155,
                             0.007472016,
                             0.0073413397,
                             0.007899154,
                             0.009074967,
                             0.009079989,
                             0.009003199,
                             0.008879161,
                             0.008643506],
                     'max_mae': 0.009079989,
                     'max_mse': 0.00013228337,
                     'max_rmse': 0.011501451,
                     'median_mae': 0.007899154,
                     'min_cosine': 0.9981971,
                     'mse': [4.058206e-06,
                             2.9850469e-06,
                             6.0769503e-06,
                             8.9946225e-05,
                             8.598163e-05,
                             0.00010015788,
                             0.00013098553,
                             0.00013228337,
                             0.00012949387,
                             0.00012517409,
                             0.00011854929],
                     'rmse': [0.002014499,
                              0.0017277289,
                              0.002465147,
                              0.009483999,
                              0.0092726275,
                              0.010007891,
                              0.011444891,
                              0.011501451,
                              0.011379537,
                              0.011188122,
                              0.0108880345]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_50.0

Running comparison for experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726
Directory path: experiments/inpainting/gann_4_night_20210905_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_50.0/images
Optimal number of principal components:  22
Reconstruction error:  8.5416355
Energy conservation:  0.5136088
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_50.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9022391383209563, 2.7642793918020963],
                   'kl_div': 0.57412595,
                   'ks_tests': {10000: KstestResult(statistic=0.2498, pvalue=2.653963173299173e-274, statistic_location=-0.0045221797, statistic_sign=-1),
                                20000: KstestResult(statistic=0.25095, pvalue=0.0, statistic_location=-0.004559965, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2546333333333334, pvalue=0.0, statistic_location=-0.0051868167, statistic_sign=-1),
                                40000: KstestResult(statistic=0.24945, pvalue=0.0, statistic_location=-0.004719397, statistic_sign=-1),
                                50000: KstestResult(statistic=0.25018, pvalue=0.0, statistic_location=-0.0051316693, statistic_sign=-1),
                                60000: KstestResult(statistic=0.25098333333333334, pvalue=0.0, statistic_location=-0.004834569, statistic_sign=-1),
                                70000: KstestResult(statistic=0.253, pvalue=0.0, statistic_location=-0.004670537, statistic_sign=-1),
                                80000: KstestResult(statistic=0.252, pvalue=0.0, statistic_location=-0.0051832567, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2521666666666667, pvalue=0.0, statistic_location=-0.0047857184, statistic_sign=-1),
                                100000: KstestResult(statistic=0.25141, pvalue=0.0, statistic_location=-0.004763782, statistic_sign=-1),
                                110000: KstestResult(statistic=0.25271818181818184, pvalue=0.0, statistic_location=-0.005190626, statistic_sign=-1),
                                120000: KstestResult(statistic=0.251775, pvalue=0.0, statistic_location=-0.004843494, statistic_sign=-1),
                                130000: KstestResult(statistic=0.24977692307692312, pvalue=0.0, statistic_location=-0.0047453977, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2525642857142857, pvalue=0.0, statistic_location=-0.004828967, statistic_sign=-1),
                                150000: KstestResult(statistic=0.25081333333333333, pvalue=0.0, statistic_location=-0.0045026336, statistic_sign=-1),
                                160000: KstestResult(statistic=0.24988749999999998, pvalue=0.0, statistic_location=-0.0048634466, statistic_sign=-1),
                                170000: KstestResult(statistic=0.25114705882352945, pvalue=0.0, statistic_location=-0.0047445707, statistic_sign=-1),
                                180000: KstestResult(statistic=0.2523944444444444, pvalue=0.0, statistic_location=-0.004955925, statistic_sign=-1),
                                190000: KstestResult(statistic=0.2511473684210527, pvalue=0.0, statistic_location=-0.004576576, statistic_sign=-1),
                                200000: KstestResult(statistic=0.252, pvalue=0.0, statistic_location=-0.004878476, statistic_sign=-1),
                                210000: KstestResult(statistic=0.24967142857142857, pvalue=0.0, statistic_location=-0.0045430744, statistic_sign=-1),
                                220000: KstestResult(statistic=0.25218636363636365, pvalue=0.0, statistic_location=-0.004835782, statistic_sign=-1)},
                   'moments': {'mean_error': -0.28801534,
                               'means': [-0.0014589109, 1.0098807e-05],
                               'stds': [0.01597184, 0.004026498],
                               'variance_ratio': 11.5746155}},
 'originals': {'gan': {'mae': 0.02928798459470272,
                       'mse': 0.0015978750307112932,
                       'psnr': 30.15612030029297,
                       'rmse': 0.0399734303355217,
                       'ssim': 0.841036856174469},
               'pca': {'mae': 0.0068868896923959255,
                       'mse': 9.432422666577622e-05,
                       'psnr': 42.491573333740234,
                       'rmse': 0.009712065570056438,
                       'ssim': 0.9911195635795593}},
 'reconstructions': {'mae': 0.028132649138569832,
                     'mse': 0.001505874446593225,
                     'psnr': 30.459918975830078,
                     'rmse': 0.03880559653043747,
                     'ssim': 0.8446964621543884},
 'residual_spectra_pcagan': {'cosine': [0.32893473,
                                        0.2549844,
                                        0.049656186,
                                        0.06664549,
                                        0.080732316,
                                        0.094082095,
                                        0.08577917,
                                        0.10418664,
                                        0.29838416,
                                        0.25544682,
                                        0.3174328,
                                        0.30228636,
                                        0.36680967,
                                        0.26984778,
                                        0.30597967,
                                        0.29091445,
                                        0.2781682,
                                        0.2744152,
                                        0.32613564,
                                        0.32100552,
                                        0.25513807,
                                        0.23906565],
                             'mae': [0.009396669,
                                     0.009241764,
                                     0.011730519,
                                     0.012666568,
                                     0.011106677,
                                     0.009910337,
                                     0.011278853,
                                     0.00957903,
                                     0.010049405,
                                     0.010265712,
                                     0.008435094,
                                     0.009262947,
                                     0.007800578,
                                     0.009208804,
                                     0.01022229,
                                     0.009794659,
                                     0.008421147,
                                     0.0103598,
                                     0.00850111,
                                     0.008719566,
                                     0.010152658,
                                     0.010938649],
                             'max_mae': 0.012666568,
                             'max_mse': 0.00040801015,
                             'max_rmse': 0.020199262,
                             'median_distance': 1.5599723,
                             'median_mae': 0.009852498,
                             'min_cosine': 0.049656186,
                             'mse': [0.00019489457,
                                     0.0002453877,
                                     0.00040801015,
                                     0.00031409488,
                                     0.0002907795,
                                     0.00019779368,
                                     0.00032054816,
                                     0.00019373154,
                                     0.00022714601,
                                     0.0003273626,
                                     0.00019546306,
                                     0.00017381548,
                                     0.0001223951,
                                     0.00026100507,
                                     0.00024152975,
                                     0.00024517984,
                                     0.00021097498,
                                     0.00024605438,
                                     0.00014998004,
                                     0.00017704956,
                                     0.00030774187,
                                     0.0002733721],
                             'rmse': [0.013960465,
                                      0.015664855,
                                      0.020199262,
                                      0.017722722,
                                      0.017052257,
                                      0.014063914,
                                      0.017903859,
                                      0.013918748,
                                      0.015071364,
                                      0.018093165,
                                      0.0139808105,
                                      0.01318391,
                                      0.011063232,
                                      0.01615565,
                                      0.015541228,
                                      0.01565822,
                                      0.014524978,
                                      0.01568612,
                                      0.012246634,
                                      0.0133059975,
                                      0.017542573,
                                      0.016533969]},
 'residuals': {'mae': 0.009865582920610905,
               'mse': 0.0002420140808681026,
               'psnr': 15.151717185974121,
               'rmse': 0.015556802041828632,
               'ssds': [56.58993, 3.5667975],
               'ssim': 0.3968444764614105},
 'spectra_pcagan': {'cosine': [0.9922057,
                               0.9914351,
                               0.9871807,
                               0.9979812,
                               0.9989094,
                               0.99847513,
                               0.9986161,
                               0.9980767,
                               0.99573344,
                               0.9941884,
                               0.996422,
                               0.98480684,
                               0.9854189,
                               0.98646915,
                               0.9871709,
                               0.98864347,
                               0.9898532,
                               0.98201764,
                               0.99058926,
                               0.9921685,
                               0.9876531,
                               0.9865688],
                    'mae': [0.032209914,
                            0.02399458,
                            0.10237486,
                            0.0229381,
                            0.018315915,
                            0.017598704,
                            0.017805196,
                            0.01778114,
                            0.024098027,
                            0.024159208,
                            0.019246833,
                            0.026653174,
                            0.0262096,
                            0.024402102,
                            0.024891293,
                            0.025643924,
                            0.024403483,
                            0.031812623,
                            0.028034516,
                            0.027034314,
                            0.028336518,
                            0.0309742],
                    'max_mae': 0.10237486,
                    'max_mse': 0.011339578,
                    'max_rmse': 0.10648745,
                    'median_mae': 0.024647389,
                    'min_cosine': 0.98201764,
                    'mse': [0.0014562793,
                            0.0009855016,
                            0.011339578,
                            0.00085308054,
                            0.00056392385,
                            0.0005164977,
                            0.00055201206,
                            0.00052284147,
                            0.000940102,
                            0.0009429567,
                            0.0006684619,
                            0.0011422702,
                            0.0010648409,
                            0.0010299738,
                            0.0010492699,
                            0.0010781358,
                            0.0010309543,
                            0.0016759464,
                            0.001353873,
                            0.0013104234,
                            0.0014319258,
                            0.0016203958],
                    'rmse': [0.03816123,
                             0.0313927,
                             0.10648745,
                             0.029207543,
                             0.023747081,
                             0.022726586,
                             0.023494937,
                             0.022865728,
                             0.030661082,
                             0.0307076,
                             0.02585463,
                             0.033797488,
                             0.0326319,
                             0.032093205,
                             0.032392435,
                             0.032834977,
                             0.03210848,
                             0.040938325,
                             0.036795013,
                             0.03619977,
                             0.037840795,
                             0.04025414]},
 'spectra_realgan': {'cosine': [0.9912343,
                                0.9902628,
                                0.98719573,
                                0.99796164,
                                0.9989008,
                                0.9984643,
                                0.998604,
                                0.99804103,
                                0.9952046,
                                0.9936565,
                                0.99580944,
                                0.9832973,
                                0.98359984,
                                0.98469806,
                                0.9859393,
                                0.9873887,
                                0.9882225,
                                0.98030204,
                                0.98952395,
                                0.99125004,
                                0.9861595,
                                0.9852589],
                     'mae': [0.03329401,
                             0.025828602,
                             0.102320544,
                             0.02308652,
                             0.018353857,
                             0.017655777,
                             0.01789047,
                             0.01794403,
                             0.02535933,
                             0.025302859,
                             0.021159155,
                             0.028000355,
                             0.027902631,
                             0.026169358,
                             0.02634928,
                             0.026940033,
                             0.026175318,
                             0.033334315,
                             0.02974353,
                             0.029068317,
                             0.029867522,
                             0.032589875],
                     'max_mae': 0.102320544,
                     'max_mse': 0.011329218,
                     'max_rmse': 0.1064388,
                     'median_mae': 0.026262298,
                     'min_cosine': 0.98030204,
                     'mse': [0.001588727,
                             0.0011122541,
                             0.011329218,
                             0.0008625983,
                             0.0005671781,
                             0.00051986036,
                             0.0005567807,
                             0.0005326598,
                             0.0010319327,
                             0.0010287716,
                             0.00077305763,
                             0.0012569921,
                             0.001199576,
                             0.0011607418,
                             0.0011529238,
                             0.001192546,
                             0.0011627724,
                             0.0018270374,
                             0.0015063187,
                             0.0014590723,
                             0.0015643495,
                             0.0017678827],
                     'rmse': [0.039858837,
                              0.033350475,
                              0.1064388,
                              0.029370025,
                              0.023815501,
                              0.022800447,
                              0.023596201,
                              0.023079423,
                              0.032123707,
                              0.03207447,
                              0.027803915,
                              0.035454083,
                              0.034634896,
                              0.03406966,
                              0.033954732,
                              0.03453326,
                              0.03409945,
                              0.042743858,
                              0.038811322,
                              0.038197804,
                              0.039551858,
                              0.042046197]},
 'spectra_realpca': {'cosine': [0.99914026,
                                0.99888456,
                                0.9999898,
                                0.99999094,
                                0.9999936,
                                0.9999877,
                                0.9999925,
                                0.99997735,
                                0.9994823,
                                0.99946415,
                                0.9993942,
                                0.9982729,
                                0.9981971,
                                0.9982434,
                                0.9984338,
                                0.9986859,
                                0.99832165,
                                0.9983338,
                                0.99882364,
                                0.9990118,
                                0.9984186,
                                0.9986386],
                     'mae': [0.008268759,
                             0.008512475,
                             0.0014473104,
                             0.0014350216,
                             0.0013100725,
                             0.001596631,
                             0.0013634961,
                             0.0019441155,
                             0.007472016,
                             0.0073413397,
                             0.007899154,
                             0.009074967,
                             0.009079989,
                             0.009003199,
                             0.008879161,
                             0.008643506,
                             0.009237599,
                             0.009567612,
                             0.010033422,
                             0.010070807,
                             0.009511826,
                             0.009819094],
                     'max_mae': 0.010070807,
                     'max_mse': 0.00016647487,
                     'max_rmse': 0.012902514,
                     'median_mae': 0.00857799,
                     'min_cosine': 0.9981971,
                     'mse': [0.00010950316,
                             0.00011651739,
                             3.3933609e-06,
                             3.3336632e-06,
                             2.7327262e-06,
                             4.058206e-06,
                             2.9850469e-06,
                             6.0769503e-06,
                             8.9946225e-05,
                             8.598163e-05,
                             0.00010015788,
                             0.00013098553,
                             0.00013228337,
                             0.00012949387,
                             0.00012517409,
                             0.00011854929,
                             0.000136993,
                             0.0001475043,
                             0.00016647487,
                             0.0001635146,
                             0.00014475366,
                             0.0001547199],
                     'rmse': [0.010464376,
                              0.010794322,
                              0.0018421077,
                              0.0018258322,
                              0.0016530959,
                              0.002014499,
                              0.0017277289,
                              0.002465147,
                              0.009483999,
                              0.0092726275,
                              0.010007891,
                              0.011444891,
                              0.011501451,
                              0.011379537,
                              0.011188122,
                              0.0108880345,
                              0.011704401,
                              0.012145135,
                              0.012902514,
                              0.0127872825,
                              0.012031361,
                              0.012438646]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_50.0

Running comparison for experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226
Directory path: experiments/inpainting/gann_4_night_20210905_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 50.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_50.0/images
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_50.0/images
Optimal number of principal components:  22
Reconstruction error:  8.5416355
Energy conservation:  0.5136088
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_50.0
saved spectra in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_50.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_50.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_50.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.867696224533345, 2.692136943093782],
                   'kl_div': 0.6017017,
                   'ks_tests': {10000: KstestResult(statistic=0.2492, pvalue=5.651178075894295e-273, statistic_location=-0.00424771, statistic_sign=-1),
                                20000: KstestResult(statistic=0.24195, pvalue=0.0, statistic_location=-0.004399119, statistic_sign=-1),
                                30000: KstestResult(statistic=0.24553333333333333, pvalue=0.0, statistic_location=-0.004588858, statistic_sign=-1),
                                40000: KstestResult(statistic=0.24585, pvalue=0.0, statistic_location=-0.004320733, statistic_sign=-1),
                                50000: KstestResult(statistic=0.2469, pvalue=0.0, statistic_location=-0.004411755, statistic_sign=-1),
                                60000: KstestResult(statistic=0.2424333333333333, pvalue=0.0, statistic_location=-0.003986116, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2466428571428571, pvalue=0.0, statistic_location=-0.0043025017, statistic_sign=-1),
                                80000: KstestResult(statistic=0.2451375, pvalue=0.0, statistic_location=-0.004535321, statistic_sign=-1),
                                90000: KstestResult(statistic=0.24594444444444444, pvalue=0.0, statistic_location=-0.0046930127, statistic_sign=-1),
                                100000: KstestResult(statistic=0.24497000000000002, pvalue=0.0, statistic_location=-0.004255196, statistic_sign=-1),
                                110000: KstestResult(statistic=0.24411818181818182, pvalue=0.0, statistic_location=-0.004192088, statistic_sign=-1),
                                120000: KstestResult(statistic=0.24346666666666666, pvalue=0.0, statistic_location=-0.0039782356, statistic_sign=-1),
                                130000: KstestResult(statistic=0.2447923076923077, pvalue=0.0, statistic_location=-0.0043532234, statistic_sign=-1),
                                140000: KstestResult(statistic=0.24351428571428574, pvalue=0.0, statistic_location=-0.0045881392, statistic_sign=-1),
                                150000: KstestResult(statistic=0.24416000000000004, pvalue=0.0, statistic_location=-0.004565165, statistic_sign=-1),
                                160000: KstestResult(statistic=0.24718125000000002, pvalue=0.0, statistic_location=-0.004253638, statistic_sign=-1),
                                170000: KstestResult(statistic=0.24325882352941175, pvalue=0.0, statistic_location=-0.0042431727, statistic_sign=-1),
                                180000: KstestResult(statistic=0.24560000000000004, pvalue=0.0, statistic_location=-0.0045958385, statistic_sign=-1),
                                190000: KstestResult(statistic=0.24546315789473683, pvalue=0.0, statistic_location=-0.004416071, statistic_sign=-1),
                                200000: KstestResult(statistic=0.24323999999999998, pvalue=0.0, statistic_location=-0.0042440807, statistic_sign=-1),
                                210000: KstestResult(statistic=0.24580476190476191, pvalue=0.0, statistic_location=-0.00433251, statistic_sign=-1),
                                220000: KstestResult(statistic=0.2453227272727273, pvalue=0.0, statistic_location=-0.004536908, statistic_sign=-1),
                                230000: KstestResult(statistic=0.2439434782608696, pvalue=0.0, statistic_location=-0.004274126, statistic_sign=-1),
                                240000: KstestResult(statistic=0.24593333333333334, pvalue=0.0, statistic_location=-0.004246165, statistic_sign=-1),
                                250000: KstestResult(statistic=0.24569600000000003, pvalue=0.0, statistic_location=-0.0043117343, statistic_sign=-1),
                                260000: KstestResult(statistic=0.24331153846153847, pvalue=0.0, statistic_location=-0.004308429, statistic_sign=-1),
                                270000: KstestResult(statistic=0.24474814814814816, pvalue=0.0, statistic_location=-0.004253596, statistic_sign=-1),
                                280000: KstestResult(statistic=0.2444607142857143, pvalue=0.0, statistic_location=-0.0044159973, statistic_sign=-1),
                                290000: KstestResult(statistic=0.24403103448275862, pvalue=0.0, statistic_location=-0.004536867, statistic_sign=-1),
                                300000: KstestResult(statistic=0.24501, pvalue=0.0, statistic_location=-0.004253638, statistic_sign=-1),
                                310000: KstestResult(statistic=0.24460645161290326, pvalue=0.0, statistic_location=-0.0043052286, statistic_sign=-1),
                                320000: KstestResult(statistic=0.242840625, pvalue=0.0, statistic_location=-0.004568109, statistic_sign=-1),
                                330000: KstestResult(statistic=0.24508484848484846, pvalue=0.0, statistic_location=-0.004338096, statistic_sign=-1)},
                   'moments': {'mean_error': -0.122175045,
                               'means': [-0.00065364566, -1.43562e-06],
                               'stds': [0.015172766, 0.0038036231],
                               'variance_ratio': 12.75496}},
 'originals': {'gan': {'mae': 0.04760200157761574,
                       'mse': 0.01523502916097641,
                       'psnr': 23.570751190185547,
                       'rmse': 0.12343025952577591,
                       'ssim': 0.8455862402915955},
               'pca': {'mae': 0.006345813162624836,
                       'mse': 8.419231744483113e-05,
                       'psnr': 46.364768981933594,
                       'rmse': 0.009175636805593967,
                       'ssim': 0.9931083917617798}},
 'reconstructions': {'mae': 0.046641696244478226,
                     'mse': 0.015161707997322083,
                     'psnr': 23.810012817382812,
                     'rmse': 0.12313288450241089,
                     'ssim': 0.8488274812698364},
 'residual_spectra_pcagan': {'cosine': [0.31984892,
                                        0.07818231,
                                        0.16051482,
                                        0.062445186,
                                        0.11637203,
                                        0.16392864,
                                        0.37129492,
                                        0.2838441,
                                        0.054911744,
                                        0.07094886,
                                        0.07879845,
                                        0.09462553,
                                        0.087891296,
                                        0.11151816,
                                        0.3213528,
                                        0.27173883,
                                        0.32603177,
                                        0.32871005,
                                        0.3916088,
                                        0.29990098,
                                        0.3279862,
                                        0.30242765,
                                        0.30120307,
                                        0.30169544,
                                        0.35027263,
                                        0.33510977,
                                        0.256476,
                                        0.24755006,
                                        0.2912074,
                                        0.28653196,
                                        0.03691998,
                                        0.29646456,
                                        0.33378327],
                             'mae': [0.00811921,
                                     0.00908315,
                                     0.00814108,
                                     0.010190378,
                                     0.008989898,
                                     0.009966802,
                                     0.008120334,
                                     0.008547336,
                                     0.011224335,
                                     0.012249636,
                                     0.010809971,
                                     0.009600295,
                                     0.0106524285,
                                     0.009090552,
                                     0.0093453135,
                                     0.009506653,
                                     0.008180884,
                                     0.00850298,
                                     0.00723622,
                                     0.008507473,
                                     0.00946928,
                                     0.009268726,
                                     0.008038709,
                                     0.009579484,
                                     0.008050427,
                                     0.008224188,
                                     0.00986978,
                                     0.010335646,
                                     0.009093777,
                                     0.010374292,
                                     0.013197392,
                                     0.010592487,
                                     0.007816704],
                             'max_mae': 0.013197392,
                             'max_mse': 0.0004598611,
                             'max_rmse': 0.021444373,
                             'median_distance': 1.4109122,
                             'median_mae': 0.009268726,
                             'min_cosine': 0.03691998,
                             'mse': [0.00016748064,
                                     0.00017801854,
                                     0.00013645583,
                                     0.00026601637,
                                     0.0001633537,
                                     0.00030435954,
                                     0.00014866388,
                                     0.00020565167,
                                     0.00034091357,
                                     0.00028988192,
                                     0.00027244858,
                                     0.00019152145,
                                     0.0002722706,
                                     0.0001680663,
                                     0.00019124222,
                                     0.00028528887,
                                     0.00018607656,
                                     0.00014950761,
                                     0.000106011656,
                                     0.00021401446,
                                     0.00019705572,
                                     0.0002266285,
                                     0.0001793121,
                                     0.00020814987,
                                     0.00013154354,
                                     0.00015201903,
                                     0.0002921149,
                                     0.00024847963,
                                     0.0001990673,
                                     0.00025530005,
                                     0.0004598611,
                                     0.00021764581,
                                     0.000154216],
                             'rmse': [0.012941431,
                                      0.013342359,
                                      0.011681431,
                                      0.016310008,
                                      0.0127809895,
                                      0.017445903,
                                      0.01219278,
                                      0.01434056,
                                      0.018463844,
                                      0.01702592,
                                      0.016506016,
                                      0.0138391275,
                                      0.016500624,
                                      0.012964038,
                                      0.013829036,
                                      0.016890496,
                                      0.013640989,
                                      0.01222733,
                                      0.010296196,
                                      0.014629234,
                                      0.014037654,
                                      0.015054186,
                                      0.013390747,
                                      0.0144274,
                                      0.011469243,
                                      0.0123296,
                                      0.01709137,
                                      0.015763236,
                                      0.014109122,
                                      0.015978111,
                                      0.021444373,
                                      0.014752824,
                                      0.0124183735]},
 'residuals': {'mae': 0.009393205866217613,
               'mse': 0.0002169283980038017,
               'psnr': 15.626958847045898,
               'rmse': 0.014728489331901073,
               'ssds': [76.11101, 4.7742786],
               'ssim': 0.4951573610305786},
 'spectra_pcagan': {'cosine': [0.9960788,
                               0.9987765,
                               0.99886286,
                               0.9975819,
                               0.9984092,
                               0.99780494,
                               0.99306774,
                               0.99136764,
                               0.98749244,
                               0.99806416,
                               0.9988929,
                               0.99844474,
                               0.9986773,
                               0.99813884,
                               0.9959369,
                               0.99462813,
                               0.996437,
                               0.98540235,
                               0.98502636,
                               0.9873115,
                               0.9877597,
                               0.9894033,
                               0.9895906,
                               0.98359185,
                               0.99086154,
                               0.9922543,
                               0.98731375,
                               0.9868202,
                               0.9878909,
                               0.95077664,
                               0.21990964,
                               0.95247793,
                               0.98838353],
                    'mae': [0.018545317,
                            0.015809847,
                            0.014196457,
                            0.023766033,
                            0.01634317,
                            0.019991694,
                            0.030300347,
                            0.024005596,
                            0.10161537,
                            0.022650285,
                            0.018344177,
                            0.01771883,
                            0.017441768,
                            0.017407387,
                            0.023250788,
                            0.02297201,
                            0.018795429,
                            0.026099598,
                            0.026215408,
                            0.023307694,
                            0.023969714,
                            0.025335182,
                            0.023816967,
                            0.030039024,
                            0.027887842,
                            0.026797995,
                            0.028075434,
                            0.030519065,
                            0.026522443,
                            0.052092455,
                            0.66087353,
                            0.061559387,
                            0.022909706],
                    'max_mae': 0.66087353,
                    'max_mse': 0.45411742,
                    'max_rmse': 0.67388237,
                    'median_mae': 0.023816967,
                    'min_cosine': 0.21990964,
                    'mse': [0.00059916876,
                            0.0004164815,
                            0.0003467781,
                            0.00083024654,
                            0.00043780293,
                            0.00069953816,
                            0.0012772148,
                            0.0009909122,
                            0.011170242,
                            0.0008272835,
                            0.00056732807,
                            0.00052785303,
                            0.00052994717,
                            0.0005016397,
                            0.00089092064,
                            0.00087070256,
                            0.0006511392,
                            0.0011006175,
                            0.0010881287,
                            0.0009442743,
                            0.0009817012,
                            0.0010479172,
                            0.0009934541,
                            0.0015213301,
                            0.0013232839,
                            0.0012867994,
                            0.0014101869,
                            0.0015675129,
                            0.001249369,
                            0.0035652434,
                            0.45411742,
                            0.0051138788,
                            0.0008900327],
                    'rmse': [0.024477923,
                             0.020407878,
                             0.01862198,
                             0.028814,
                             0.020923741,
                             0.026448784,
                             0.035738144,
                             0.03147876,
                             0.10568937,
                             0.028762536,
                             0.02381865,
                             0.022975052,
                             0.023020582,
                             0.022397313,
                             0.029848294,
                             0.029507669,
                             0.025517428,
                             0.033175554,
                             0.032986794,
                             0.030729046,
                             0.031332113,
                             0.032371547,
                             0.031519108,
                             0.039004233,
                             0.036376968,
                             0.035871986,
                             0.037552454,
                             0.039591826,
                             0.035346415,
                             0.05970966,
                             0.67388237,
                             0.07151139,
                             0.029833416]},
 'spectra_realgan': {'cosine': [0.9955162,
                                0.99876505,
                                0.9988341,
                                0.99756604,
                                0.99837786,
                                0.9977364,
                                0.99210507,
                                0.9901592,
                                0.9875068,
                                0.99804497,
                                0.9988841,
                                0.9984334,
                                0.99866533,
                                0.99810344,
                                0.9953989,
                                0.994098,
                                0.9958299,
                                0.9838778,
                                0.98321414,
                                0.98550993,
                                0.9865277,
                                0.9881482,
                                0.98796463,
                                0.9818444,
                                0.9897901,
                                0.9913576,
                                0.9858401,
                                0.98552763,
                                0.9865174,
                                0.9485298,
                                0.22056651,
                                0.9521763,
                                0.98690104],
                     'mae': [0.020037234,
                             0.015912354,
                             0.014391359,
                             0.023837233,
                             0.016507305,
                             0.020245649,
                             0.03139966,
                             0.025884869,
                             0.10156061,
                             0.022796316,
                             0.018384436,
                             0.01777977,
                             0.017534152,
                             0.017570853,
                             0.024620065,
                             0.024194928,
                             0.020818658,
                             0.027516587,
                             0.027908057,
                             0.025199078,
                             0.025496764,
                             0.026612066,
                             0.02561463,
                             0.031711638,
                             0.029572153,
                             0.028771006,
                             0.029580496,
                             0.03204827,
                             0.028307233,
                             0.052727547,
                             0.66075623,
                             0.06108778,
                             0.02448113],
                     'max_mae': 0.66075623,
                     'max_mse': 0.45394692,
                     'max_rmse': 0.6737558,
                     'median_mae': 0.025496764,
                     'min_cosine': 0.22056651,
                     'mse': [0.00068473094,
                             0.00042061438,
                             0.0003551972,
                             0.00083532336,
                             0.00044600692,
                             0.0007178433,
                             0.0014078204,
                             0.0011215144,
                             0.01116006,
                             0.0008367502,
                             0.0005706529,
                             0.0005313611,
                             0.00053462683,
                             0.0005112875,
                             0.000984409,
                             0.00095617905,
                             0.00075440714,
                             0.0012169214,
                             0.0012226574,
                             0.0010774576,
                             0.0010844546,
                             0.0011621701,
                             0.0011252391,
                             0.0016751419,
                             0.0014774826,
                             0.0014325805,
                             0.0015413639,
                             0.0017133843,
                             0.0013875528,
                             0.0037367428,
                             0.45394692,
                             0.005122629,
                             0.0010044291],
                     'rmse': [0.026167365,
                              0.020508885,
                              0.018846676,
                              0.02890196,
                              0.021118876,
                              0.026792597,
                              0.037520934,
                              0.03348902,
                              0.105641186,
                              0.028926635,
                              0.023888342,
                              0.023051271,
                              0.023122,
                              0.022611666,
                              0.031375293,
                              0.030922145,
                              0.027466472,
                              0.0348844,
                              0.034966517,
                              0.03282465,
                              0.03293106,
                              0.034090616,
                              0.033544585,
                              0.040928498,
                              0.038438037,
                              0.037849445,
                              0.03926021,
                              0.041393045,
                              0.03724987,
                              0.061128903,
                              0.6737558,
                              0.07157254,
                              0.03169273]},
 'spectra_realpca': {'cosine': [0.99943405,
                                0.9999909,
                                0.99996763,
                                0.99997884,
                                0.99997455,
                                0.9999413,
                                0.99914026,
                                0.99888456,
                                0.9999898,
                                0.99999094,
                                0.9999936,
                                0.9999877,
                                0.9999925,
                                0.99997735,
                                0.9994823,
                                0.99946415,
                                0.9993942,
                                0.9982729,
                                0.9981971,
                                0.9982434,
                                0.9984338,
                                0.9986859,
                                0.99832165,
                                0.9983338,
                                0.99882364,
                                0.9990118,
                                0.9984186,
                                0.9986386,
                                0.9985175,
                                0.9981157,
                                0.99993396,
                                0.9984693,
                                0.9983478],
                     'mae': [0.007349382,
                             0.0013765096,
                             0.0024878911,
                             0.0019751645,
                             0.0020855058,
                             0.0032375022,
                             0.008268759,
                             0.008512475,
                             0.0014473104,
                             0.0014350216,
                             0.0013100725,
                             0.001596631,
                             0.0013634961,
                             0.0019441155,
                             0.007472016,
                             0.0073413397,
                             0.007899154,
                             0.009074967,
                             0.009079989,
                             0.009003199,
                             0.008879161,
                             0.008643506,
                             0.009237599,
                             0.009567612,
                             0.010033422,
                             0.010070807,
                             0.009511826,
                             0.009819094,
                             0.00979314,
                             0.009319468,
                             0.00173996,
                             0.00968094,
                             0.008854794],
                     'max_mae': 0.010070807,
                     'max_mse': 0.00016647487,
                     'max_rmse': 0.012902514,
                     'median_mae': 0.008268759,
                     'min_cosine': 0.9981157,
                     'mse': [8.651721e-05,
                             3.0414617e-06,
                             9.903068e-06,
                             6.2646955e-06,
                             7.0064575e-06,
                             1.6702043e-05,
                             0.00010950316,
                             0.00011651739,
                             3.3933609e-06,
                             3.3336632e-06,
                             2.7327262e-06,
                             4.058206e-06,
                             2.9850469e-06,
                             6.0769503e-06,
                             8.9946225e-05,
                             8.598163e-05,
                             0.00010015788,
                             0.00013098553,
                             0.00013228337,
                             0.00012949387,
                             0.00012517409,
                             0.00011854929,
                             0.000136993,
                             0.0001475043,
                             0.00016647487,
                             0.0001635146,
                             0.00014475366,
                             0.0001547199,
                             0.00015254176,
                             0.00014010533,
                             4.988962e-06,
                             0.00015027104,
                             0.00012587185],
                     'rmse': [0.009301463,
                              0.0017439787,
                              0.003146914,
                              0.0025029373,
                              0.0026469715,
                              0.0040868134,
                              0.010464376,
                              0.010794322,
                              0.0018421077,
                              0.0018258322,
                              0.0016530959,
                              0.002014499,
                              0.0017277289,
                              0.002465147,
                              0.009483999,
                              0.0092726275,
                              0.010007891,
                              0.011444891,
                              0.011501451,
                              0.011379537,
                              0.011188122,
                              0.0108880345,
                              0.011704401,
                              0.012145135,
                              0.012902514,
                              0.0127872825,
                              0.012031361,
                              0.012438646,
                              0.01235078,
                              0.01183661,
                              0.0022335984,
                              0.012258509,
                              0.011219263]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_50.0
