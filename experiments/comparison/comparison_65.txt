
Running comparison for experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805
Directory path: experiments/inpainting/gann_4_night_20180708_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_65.0/images
Optimal number of principal components:  20
Reconstruction error:  19.02481
Energy conservation:  0.6543618
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_65.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [3.933204310299706, 3.2205013491392096],
                   'kl_div': 0.26997986,
                   'ks_tests': {10000: KstestResult(statistic=0.1614, pvalue=4.751650783281221e-114, statistic_location=0.006426841, statistic_sign=1),
                                20000: KstestResult(statistic=0.1653, pvalue=2.894518815534552e-239, statistic_location=0.0065546953, statistic_sign=1),
                                30000: KstestResult(statistic=0.15870000000000006, pvalue=0.0, statistic_location=0.00649728, statistic_sign=1),
                                40000: KstestResult(statistic=0.1614000000000001, pvalue=0.0, statistic_location=0.008024341, statistic_sign=1),
                                50000: KstestResult(statistic=0.16260000000000008, pvalue=0.0, statistic_location=0.0063805003, statistic_sign=1),
                                60000: KstestResult(statistic=0.15588333333333337, pvalue=0.0, statistic_location=0.006792021, statistic_sign=1),
                                70000: KstestResult(statistic=0.15775714285714293, pvalue=0.0, statistic_location=0.006497879, statistic_sign=1),
                                80000: KstestResult(statistic=0.15773749999999997, pvalue=0.0, statistic_location=0.008021416, statistic_sign=1),
                                90000: KstestResult(statistic=0.1603444444444444, pvalue=0.0, statistic_location=0.007106192, statistic_sign=1),
                                100000: KstestResult(statistic=0.15949999999999998, pvalue=0.0, statistic_location=0.006534596, statistic_sign=1),
                                110000: KstestResult(statistic=0.15871818181818187, pvalue=0.0, statistic_location=0.006464168, statistic_sign=1)},
                   'moments': {'mean_error': 0.07937841,
                               'means': [-1.1889718e-05, -0.00013655056],
                               'stds': [0.017084507, 0.0061847903],
                               'variance_ratio': 6.4833703}},
 'originals': {'gan': {'mae': 0.044734351336956024,
                       'mse': 0.00500925537198782,
                       'psnr': 27.338207244873047,
                       'rmse': 0.0707760900259018,
                       'ssim': 0.9471726417541504},
               'pca': {'mae': 0.013008755631744862,
                       'mse': 0.00029981110128574073,
                       'psnr': 39.527042388916016,
                       'rmse': 0.017315054312348366,
                       'ssim': 0.996826708316803}},
 'reconstructions': {'mae': 0.04184899851679802,
                     'mse': 0.004743258468806744,
                     'psnr': 27.53474998474121,
                     'rmse': 0.06887131929397583,
                     'ssim': 0.9495472311973572},
 'residual_spectra_pcagan': {'cosine': [0.34397942,
                                        0.046778448,
                                        0.35995638,
                                        0.38275295,
                                        0.3941225,
                                        0.38072282,
                                        0.39108694,
                                        0.432978,
                                        0.41895154,
                                        0.44014806,
                                        0.2946652],
                             'mae': [0.010747319,
                                     0.013419723,
                                     0.009008023,
                                     0.009920837,
                                     0.0100112595,
                                     0.008434099,
                                     0.008698992,
                                     0.008572787,
                                     0.008747577,
                                     0.008562747,
                                     0.011266407],
                             'max_mae': 0.013419723,
                             'max_mse': 0.00041894036,
                             'max_rmse': 0.020468032,
                             'median_distance': 1.4558834,
                             'median_mae': 0.009008023,
                             'min_cosine': 0.046778448,
                             'mse': [0.00029225936,
                                     0.00041894036,
                                     0.00021195965,
                                     0.00023955369,
                                     0.00033155747,
                                     0.0001871559,
                                     0.00016393256,
                                     0.0001806554,
                                     0.00019949734,
                                     0.00017287412,
                                     0.0004132384],
                             'rmse': [0.017095594,
                                      0.020468032,
                                      0.014558834,
                                      0.015477522,
                                      0.01820872,
                                      0.013680493,
                                      0.012803615,
                                      0.013440811,
                                      0.0141243525,
                                      0.013148161,
                                      0.020328267]},
 'residuals': {'mae': 0.009762706235051155,
               'mse': 0.0002556022081989795,
               'psnr': 21.363821029663086,
               'rmse': 0.015987563878297806,
               'ssds': [32.106564, 4.2096925],
               'ssim': 0.46619319915771484},
 'spectra_pcagan': {'cosine': [0.99313945,
                               0.9993897,
                               0.99795824,
                               0.99095845,
                               0.9947366,
                               0.9975584,
                               0.9971058,
                               0.97481626,
                               0.9952667,
                               0.9918861,
                               0.98543215],
                    'mae': [0.028710708,
                            0.021987151,
                            0.036910765,
                            0.023876235,
                            0.01706276,
                            0.038529735,
                            0.030052356,
                            0.1933438,
                            0.022682266,
                            0.020379672,
                            0.02680354],
                    'max_mae': 0.1933438,
                    'max_mse': 0.039446652,
                    'max_rmse': 0.19861181,
                    'median_mae': 0.02680354,
                    'min_cosine': 0.97481626,
                    'mse': [0.0015099394,
                            0.0006932509,
                            0.0021776927,
                            0.0010116888,
                            0.00058438245,
                            0.0022617467,
                            0.0014757775,
                            0.039446652,
                            0.00093081675,
                            0.00072816917,
                            0.001355728],
                    'rmse': [0.03885794,
                             0.026329659,
                             0.046665754,
                             0.031807058,
                             0.024174003,
                             0.047557823,
                             0.03841585,
                             0.19861181,
                             0.03050929,
                             0.02698461,
                             0.03682021]},
 'spectra_realgan': {'cosine': [0.99175346,
                                0.9993864,
                                0.9974738,
                                0.9885626,
                                0.992407,
                                0.99695754,
                                0.996352,
                                0.97315854,
                                0.99355114,
                                0.98881245,
                                0.9826634],
                     'mae': [0.032277416,
                             0.021971023,
                             0.039228965,
                             0.027653707,
                             0.021448666,
                             0.04044802,
                             0.03310232,
                             0.19353077,
                             0.027468923,
                             0.024600843,
                             0.030347247],
                     'max_mae': 0.19353077,
                     'max_mse': 0.039805513,
                     'max_rmse': 0.1995132,
                     'median_mae': 0.030347247,
                     'min_cosine': 0.97315854,
                     'mse': [0.001811758,
                             0.00069365103,
                             0.0024994803,
                             0.0012799344,
                             0.00081188173,
                             0.002571155,
                             0.0017536087,
                             0.039805513,
                             0.0012606264,
                             0.0009979114,
                             0.0016162823],
                     'rmse': [0.04256475,
                              0.026337255,
                              0.049994804,
                              0.03577617,
                              0.028493538,
                              0.050706558,
                              0.04187611,
                              0.1995132,
                              0.035505302,
                              0.031589735,
                              0.040203013]},
 'spectra_realpca': {'cosine': [0.9985155,
                                0.9999979,
                                0.99947584,
                                0.9973105,
                                0.9977682,
                                0.9993314,
                                0.99912035,
                                0.99827576,
                                0.99833775,
                                0.9965816,
                                0.99687755],
                     'mae': [0.014350504,
                             0.0008286392,
                             0.015691921,
                             0.013674681,
                             0.011808165,
                             0.015641429,
                             0.015466908,
                             0.014332716,
                             0.014227754,
                             0.013680603,
                             0.013392996],
                     'max_mae': 0.015691921,
                     'max_mse': 0.00039634015,
                     'max_rmse': 0.019908294,
                     'median_mae': 0.014227754,
                     'min_cosine': 0.9965816,
                     'mse': [0.0003276158,
                             1.1026099e-06,
                             0.00039634015,
                             0.0002996277,
                             0.00022430987,
                             0.000390806,
                             0.00038375976,
                             0.0003604948,
                             0.00032379542,
                             0.0002988494,
                             0.00029122058],
                     'rmse': [0.01810016,
                              0.0010500523,
                              0.019908294,
                              0.017309757,
                              0.014976978,
                              0.019768814,
                              0.019589787,
                              0.0189867,
                              0.017994316,
                              0.017287262,
                              0.017065186]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_65.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628
Directory path: experiments/inpainting/gann_4_night_20180708_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_65.0/images
Optimal number of principal components:  20
Reconstruction error:  19.02481
Energy conservation:  0.6543618
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_65.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.079875858281184, 3.121068030928673],
                   'kl_div': 0.47318748,
                   'ks_tests': {10000: KstestResult(statistic=0.2159, pvalue=1.869667019440696e-204, statistic_location=-0.0068623116, statistic_sign=-1),
                                20000: KstestResult(statistic=0.2167, pvalue=0.0, statistic_location=-0.0072321687, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2144, pvalue=0.0, statistic_location=-0.007844037, statistic_sign=-1),
                                40000: KstestResult(statistic=0.21865, pvalue=0.0, statistic_location=-0.005923182, statistic_sign=-1),
                                50000: KstestResult(statistic=0.22298, pvalue=0.0, statistic_location=-0.0070558246, statistic_sign=-1),
                                60000: KstestResult(statistic=0.21983333333333333, pvalue=0.0, statistic_location=-0.0067531653, statistic_sign=-1),
                                70000: KstestResult(statistic=0.22205714285714287, pvalue=0.0, statistic_location=-0.00680336, statistic_sign=-1),
                                80000: KstestResult(statistic=0.2193875, pvalue=0.0, statistic_location=-0.0073562535, statistic_sign=-1),
                                90000: KstestResult(statistic=0.22114444444444442, pvalue=0.0, statistic_location=-0.0072367643, statistic_sign=-1),
                                100000: KstestResult(statistic=0.21932999999999997, pvalue=0.0, statistic_location=-0.0065523386, statistic_sign=-1),
                                110000: KstestResult(statistic=0.21745454545454546, pvalue=0.0, statistic_location=-0.0068004252, statistic_sign=-1),
                                120000: KstestResult(statistic=0.21700833333333336, pvalue=0.0, statistic_location=-0.006875704, statistic_sign=-1),
                                130000: KstestResult(statistic=0.22099230769230768, pvalue=0.0, statistic_location=-0.0067957435, statistic_sign=-1),
                                140000: KstestResult(statistic=0.21967857142857142, pvalue=0.0, statistic_location=-0.006785442, statistic_sign=-1),
                                150000: KstestResult(statistic=0.21952000000000002, pvalue=0.0, statistic_location=-0.007315344, statistic_sign=-1),
                                160000: KstestResult(statistic=0.2202, pvalue=0.0, statistic_location=-0.0067342767, statistic_sign=-1),
                                170000: KstestResult(statistic=0.2201588235294118, pvalue=0.0, statistic_location=-0.0066427737, statistic_sign=-1),
                                180000: KstestResult(statistic=0.21836111111111112, pvalue=0.0, statistic_location=-0.0069591254, statistic_sign=-1),
                                190000: KstestResult(statistic=0.21965263157894738, pvalue=0.0, statistic_location=-0.0068933256, statistic_sign=-1),
                                200000: KstestResult(statistic=0.218905, pvalue=0.0, statistic_location=-0.0068440977, statistic_sign=-1),
                                210000: KstestResult(statistic=0.21921904761904765, pvalue=0.0, statistic_location=-0.0073224874, statistic_sign=-1),
                                220000: KstestResult(statistic=0.22085909090909095, pvalue=0.0, statistic_location=-0.006550312, statistic_sign=-1)},
                   'moments': {'mean_error': -0.17213856,
                               'means': [-0.0014181881, -7.802698e-05],
                               'stds': [0.01881039, 0.0058209454],
                               'variance_ratio': 8.711272}},
 'originals': {'gan': {'mae': 0.041415736079216,
                       'mse': 0.003690463025122881,
                       'psnr': 29.55628204345703,
                       'rmse': 0.06074918061494827,
                       'ssim': 0.9063164591789246},
               'pca': {'mae': 0.011187768541276455,
                       'mse': 0.0002508918405510485,
                       'psnr': 41.39651107788086,
                       'rmse': 0.01583956554532051,
                       'ssim': 0.9938800930976868}},
 'reconstructions': {'mae': 0.03950515761971474,
                     'mse': 0.0034622387029230595,
                     'psnr': 29.9978084564209,
                     'rmse': 0.0588407926261425,
                     'ssim': 0.9098129272460938},
 'residual_spectra_pcagan': {'cosine': [0.10619062,
                                        0.0744277,
                                        0.3509479,
                                        0.28352663,
                                        0.30027413,
                                        0.4068068,
                                        0.026385745,
                                        0.30862373,
                                        0.3684595,
                                        0.35810253,
                                        0.36795294,
                                        0.33042893,
                                        0.38603094,
                                        0.320852,
                                        0.33899724,
                                        0.3608792,
                                        0.38389027,
                                        0.36568218,
                                        0.48616245,
                                        0.022748983,
                                        0.39274272,
                                        0.07209035],
                             'mae': [0.014046351,
                                     0.015130554,
                                     0.012368168,
                                     0.013880875,
                                     0.011997119,
                                     0.009903019,
                                     0.014499756,
                                     0.011278104,
                                     0.011882362,
                                     0.011808678,
                                     0.009868612,
                                     0.011185186,
                                     0.010040799,
                                     0.011136538,
                                     0.011842465,
                                     0.011694799,
                                     0.009685733,
                                     0.01134383,
                                     0.010007166,
                                     0.012807605,
                                     0.009744405,
                                     0.011859061],
                             'max_mae': 0.015130554,
                             'max_mse': 0.0004893159,
                             'max_rmse': 0.022120485,
                             'median_distance': 1.7751465,
                             'median_mae': 0.011751738,
                             'min_cosine': 0.022748983,
                             'mse': [0.0003924678,
                                     0.0004893159,
                                     0.00038648772,
                                     0.00036885228,
                                     0.00031696016,
                                     0.00020026669,
                                     0.00043681965,
                                     0.00031327415,
                                     0.0002965399,
                                     0.00042621655,
                                     0.00021947692,
                                     0.00026770827,
                                     0.00024761623,
                                     0.00040863844,
                                     0.00031776895,
                                     0.0003298509,
                                     0.00024651218,
                                     0.00028458127,
                                     0.00020066052,
                                     0.00033043174,
                                     0.00028432356,
                                     0.00030808873],
                             'rmse': [0.0198108,
                                      0.022120485,
                                      0.01965929,
                                      0.019205527,
                                      0.017803375,
                                      0.014151561,
                                      0.02090023,
                                      0.017699553,
                                      0.017220333,
                                      0.020645013,
                                      0.014814753,
                                      0.016361794,
                                      0.015735826,
                                      0.020214807,
                                      0.017826075,
                                      0.018161798,
                                      0.015700707,
                                      0.016869538,
                                      0.014165469,
                                      0.018177781,
                                      0.016861897,
                                      0.017552456]},
 'residuals': {'mae': 0.011727781966328621,
               'mse': 0.00032149357139132917,
               'psnr': 20.440650939941406,
               'rmse': 0.01793024130165577,
               'ssds': [78.28488, 7.455655],
               'ssim': 0.33994460105895996},
 'spectra_pcagan': {'cosine': [0.99896795,
                               0.9994049,
                               0.98502123,
                               0.99470603,
                               0.9968786,
                               0.99313426,
                               0.99916923,
                               0.99680877,
                               0.9848153,
                               0.9910644,
                               0.99669015,
                               0.9948505,
                               0.97832537,
                               0.99192154,
                               0.9597189,
                               0.9800589,
                               0.98946196,
                               0.98112226,
                               0.991043,
                               0.99931663,
                               0.9853874,
                               0.99744534],
                    'mae': [0.01694142,
                            0.020155465,
                            0.025466172,
                            0.048475873,
                            0.05751208,
                            0.03032565,
                            0.019967565,
                            0.05441511,
                            0.032367803,
                            0.02254677,
                            0.04718663,
                            0.043012656,
                            0.179421,
                            0.030688843,
                            0.05771295,
                            0.032956656,
                            0.025494661,
                            0.040421486,
                            0.023891564,
                            0.017705979,
                            0.022384781,
                            0.020062415],
                    'max_mae': 0.179421,
                    'max_mse': 0.034859985,
                    'max_rmse': 0.18670829,
                    'median_mae': 0.030507246,
                    'min_cosine': 0.9597189,
                    'mse': [0.00046317582,
                            0.00059117266,
                            0.0011089742,
                            0.0036594926,
                            0.005491076,
                            0.0015508429,
                            0.0006225886,
                            0.0043300707,
                            0.0017391682,
                            0.0009194462,
                            0.0032905599,
                            0.0029208253,
                            0.034859985,
                            0.0017971246,
                            0.004268248,
                            0.0018813515,
                            0.0011329362,
                            0.0024815265,
                            0.00095787115,
                            0.00047658634,
                            0.0009561018,
                            0.00067012344],
                    'rmse': [0.02152152,
                             0.024314042,
                             0.033301264,
                             0.06049374,
                             0.0741018,
                             0.039380744,
                             0.024951726,
                             0.065803275,
                             0.041703336,
                             0.030322371,
                             0.057363402,
                             0.05404466,
                             0.18670829,
                             0.042392507,
                             0.06533183,
                             0.04337455,
                             0.03365912,
                             0.04981492,
                             0.030949494,
                             0.021830857,
                             0.030920897,
                             0.025886742]},
 'spectra_realgan': {'cosine': [0.99894327,
                                0.99940234,
                                0.98145306,
                                0.99415404,
                                0.9965239,
                                0.991695,
                                0.99916625,
                                0.99628097,
                                0.9822146,
                                0.9884819,
                                0.9960184,
                                0.994058,
                                0.97664857,
                                0.99022675,
                                0.95710987,
                                0.97679853,
                                0.98647827,
                                0.9784223,
                                0.9882579,
                                0.99931574,
                                0.98092294,
                                0.997411],
                     'mae': [0.017146079,
                             0.020168345,
                             0.028706223,
                             0.050800398,
                             0.059404463,
                             0.033509545,
                             0.019985925,
                             0.055692036,
                             0.03531207,
                             0.02621587,
                             0.048675243,
                             0.044680182,
                             0.17965956,
                             0.03404801,
                             0.05834632,
                             0.035970166,
                             0.028960349,
                             0.04211721,
                             0.02753194,
                             0.017711489,
                             0.026319312,
                             0.020185553],
                     'max_mae': 0.17965956,
                     'max_mse': 0.035222843,
                     'max_rmse': 0.1876775,
                     'median_mae': 0.03377878,
                     'min_cosine': 0.95710987,
                     'mse': [0.00047266626,
                             0.00059270527,
                             0.0013652463,
                             0.00403947,
                             0.005812725,
                             0.0018575729,
                             0.0006232374,
                             0.004649755,
                             0.0020181779,
                             0.0011730588,
                             0.0036266067,
                             0.0031747771,
                             0.035222843,
                             0.0021111243,
                             0.004506634,
                             0.0021810574,
                             0.0014073155,
                             0.0027539334,
                             0.0012253452,
                             0.00047697028,
                             0.0012224708,
                             0.0006764928],
                     'rmse': [0.02174089,
                              0.02434554,
                              0.03694924,
                              0.06355683,
                              0.07624123,
                              0.04309957,
                              0.024964724,
                              0.068189114,
                              0.044924136,
                              0.034249946,
                              0.060221314,
                              0.05634516,
                              0.1876775,
                              0.045946974,
                              0.06713147,
                              0.046701793,
                              0.037514202,
                              0.052477933,
                              0.035004932,
                              0.021839648,
                              0.03496385,
                              0.026009476]},
 'spectra_realpca': {'cosine': [0.9999832,
                                0.99999875,
                                0.9967681,
                                0.9994052,
                                0.9996286,
                                0.9985155,
                                0.9999979,
                                0.99947584,
                                0.9973105,
                                0.9977682,
                                0.9993314,
                                0.99912035,
                                0.99827576,
                                0.99833775,
                                0.9965816,
                                0.99687755,
                                0.99688196,
                                0.9971458,
                                0.99752945,
                                0.9999992,
                                0.9955944,
                                0.9999606],
                     'mae': [0.0020792447,
                             0.00071239646,
                             0.012075761,
                             0.015990539,
                             0.017016644,
                             0.014350504,
                             0.0008286392,
                             0.015691921,
                             0.013674681,
                             0.011808165,
                             0.015641429,
                             0.015466908,
                             0.014332716,
                             0.014227754,
                             0.013680603,
                             0.013392996,
                             0.013646216,
                             0.013817455,
                             0.012011342,
                             0.00051225646,
                             0.012797409,
                             0.002375326],
                     'max_mae': 0.017016644,
                     'max_mse': 0.00046590014,
                     'max_rmse': 0.02158472,
                     'median_mae': 0.013660449,
                     'min_cosine': 0.9955944,
                     'mse': [6.9714383e-06,
                             8.0806564e-07,
                             0.00023464623,
                             0.0004117622,
                             0.00046590014,
                             0.0003276158,
                             1.1026099e-06,
                             0.00039634015,
                             0.0002996277,
                             0.00022430987,
                             0.000390806,
                             0.00038375976,
                             0.0003604948,
                             0.00032379542,
                             0.0002988494,
                             0.00029122058,
                             0.00029816874,
                             0.0003022724,
                             0.00022888882,
                             4.3033455e-07,
                             0.00026282214,
                             9.028615e-06],
                     'rmse': [0.0026403482,
                              0.0008989247,
                              0.015318166,
                              0.020291924,
                              0.02158472,
                              0.01810016,
                              0.0010500523,
                              0.019908294,
                              0.017309757,
                              0.014976978,
                              0.019768814,
                              0.019589787,
                              0.0189867,
                              0.017994316,
                              0.017287262,
                              0.017065186,
                              0.017267562,
                              0.017385984,
                              0.015129072,
                              0.0006559989,
                              0.016211791,
                              0.0030047654]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_65.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354
Directory path: experiments/inpainting/gann_4_night_20180708_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_65.0/images
Optimal number of principal components:  20
Reconstruction error:  19.02481
Energy conservation:  0.6543618
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_65.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.061857105227111, 3.113639947224606],
                   'kl_div': 0.46311277,
                   'ks_tests': {10000: KstestResult(statistic=0.204, pvalue=1.992224027391873e-182, statistic_location=-0.0076538613, statistic_sign=-1),
                                20000: KstestResult(statistic=0.20955000000000001, pvalue=0.0, statistic_location=-0.0072733783, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2023333333333333, pvalue=0.0, statistic_location=-0.0053989557, statistic_sign=-1),
                                40000: KstestResult(statistic=0.199975, pvalue=0.0, statistic_location=-0.006781876, statistic_sign=-1),
                                50000: KstestResult(statistic=0.20086, pvalue=0.0, statistic_location=-0.006046163, statistic_sign=-1),
                                60000: KstestResult(statistic=0.20410000000000003, pvalue=0.0, statistic_location=-0.006367963, statistic_sign=-1),
                                70000: KstestResult(statistic=0.20534285714285716, pvalue=0.0, statistic_location=-0.007046502, statistic_sign=-1),
                                80000: KstestResult(statistic=0.20415000000000003, pvalue=0.0, statistic_location=-0.0061513595, statistic_sign=-1),
                                90000: KstestResult(statistic=0.20473333333333335, pvalue=0.0, statistic_location=-0.006209041, statistic_sign=-1),
                                100000: KstestResult(statistic=0.20276000000000002, pvalue=0.0, statistic_location=-0.0063583273, statistic_sign=-1),
                                110000: KstestResult(statistic=0.20487272727272726, pvalue=0.0, statistic_location=-0.0061891954, statistic_sign=-1),
                                120000: KstestResult(statistic=0.20463333333333333, pvalue=0.0, statistic_location=-0.0064764638, statistic_sign=-1),
                                130000: KstestResult(statistic=0.20453846153846156, pvalue=0.0, statistic_location=-0.006198423, statistic_sign=-1),
                                140000: KstestResult(statistic=0.20420714285714286, pvalue=0.0, statistic_location=-0.006523926, statistic_sign=-1),
                                150000: KstestResult(statistic=0.20324, pvalue=0.0, statistic_location=-0.0067598075, statistic_sign=-1),
                                160000: KstestResult(statistic=0.20518125, pvalue=0.0, statistic_location=-0.006931983, statistic_sign=-1),
                                170000: KstestResult(statistic=0.20335882352941176, pvalue=0.0, statistic_location=-0.0061986446, statistic_sign=-1),
                                180000: KstestResult(statistic=0.20423333333333338, pvalue=0.0, statistic_location=-0.0064979587, statistic_sign=-1),
                                190000: KstestResult(statistic=0.2043105263157895, pvalue=0.0, statistic_location=-0.006751476, statistic_sign=-1),
                                200000: KstestResult(statistic=0.20221, pvalue=0.0, statistic_location=-0.006484476, statistic_sign=-1),
                                210000: KstestResult(statistic=0.20545238095238094, pvalue=0.0, statistic_location=-0.006490416, statistic_sign=-1),
                                220000: KstestResult(statistic=0.2010681818181818, pvalue=0.0, statistic_location=-0.0064532794, statistic_sign=-1),
                                230000: KstestResult(statistic=0.20303478260869567, pvalue=0.0, statistic_location=-0.006799124, statistic_sign=-1),
                                240000: KstestResult(statistic=0.2059125, pvalue=0.0, statistic_location=-0.006490498, statistic_sign=-1),
                                250000: KstestResult(statistic=0.20418, pvalue=0.0, statistic_location=-0.0067601427, statistic_sign=-1),
                                260000: KstestResult(statistic=0.20428461538461534, pvalue=0.0, statistic_location=-0.006517624, statistic_sign=-1),
                                270000: KstestResult(statistic=0.20254074074074074, pvalue=0.0, statistic_location=-0.0064891577, statistic_sign=-1),
                                280000: KstestResult(statistic=0.20426071428571427, pvalue=0.0, statistic_location=-0.006519055, statistic_sign=-1),
                                290000: KstestResult(statistic=0.20195862068965517, pvalue=0.0, statistic_location=-0.0061781984, statistic_sign=-1),
                                300000: KstestResult(statistic=0.20409666666666665, pvalue=0.0, statistic_location=-0.0061981264, statistic_sign=-1),
                                310000: KstestResult(statistic=0.2037645161290323, pvalue=0.0, statistic_location=-0.0068183765, statistic_sign=-1),
                                320000: KstestResult(statistic=0.20441250000000002, pvalue=0.0, statistic_location=-0.006130309, statistic_sign=-1),
                                330000: KstestResult(statistic=0.20297878787878787, pvalue=0.0, statistic_location=-0.0064889314, statistic_sign=-1)},
                   'moments': {'mean_error': -0.046731956,
                               'means': [-0.0005078844, -2.907818e-05],
                               'stds': [0.017889043, 0.0058295447],
                               'variance_ratio': 8.211163}},
 'originals': {'gan': {'mae': 0.03434796258807182,
                       'mse': 0.0026877636555582285,
                       'psnr': 30.955209732055664,
                       'rmse': 0.05184364691376686,
                       'ssim': 0.9331125020980835},
               'pca': {'mae': 0.010052843950688839,
                       'mse': 0.0002111581270582974,
                       'psnr': 42.22557830810547,
                       'rmse': 0.014531280845403671,
                       'ssim': 0.9956021308898926}},
 'reconstructions': {'mae': 0.03236624225974083,
                     'mse': 0.0024920182768255472,
                     'psnr': 31.506145477294922,
                     'rmse': 0.04992011934518814,
                     'ssim': 0.9357735514640808},
 'residual_spectra_pcagan': {'cosine': [0.47190985,
                                        0.1319731,
                                        0.462932,
                                        0.3655118,
                                        0.44802815,
                                        0.09981762,
                                        0.099983856,
                                        0.069481425,
                                        0.35765234,
                                        0.28055036,
                                        0.31187278,
                                        0.41915187,
                                        0.029340588,
                                        0.31434873,
                                        0.3930506,
                                        0.3862901,
                                        0.38466135,
                                        0.33388856,
                                        0.3919589,
                                        0.3319764,
                                        0.35330918,
                                        0.37335545,
                                        0.3998078,
                                        0.3824586,
                                        0.49296966,
                                        0.019909747,
                                        0.39792055,
                                        0.07783803,
                                        0.46242425,
                                        0.49143234,
                                        0.52206784,
                                        0.17909415,
                                        0.021835815],
                             'mae': [0.009257764,
                                     0.011544631,
                                     0.008765479,
                                     0.010557002,
                                     0.009541884,
                                     0.014360524,
                                     0.014191597,
                                     0.015033475,
                                     0.012216174,
                                     0.0138852345,
                                     0.011604878,
                                     0.00957643,
                                     0.014316582,
                                     0.01112352,
                                     0.011313605,
                                     0.0112794675,
                                     0.0094568785,
                                     0.01104727,
                                     0.00977489,
                                     0.010836702,
                                     0.011572558,
                                     0.011414906,
                                     0.009448995,
                                     0.0110701155,
                                     0.009889583,
                                     0.012605108,
                                     0.009564393,
                                     0.011904132,
                                     0.0095090605,
                                     0.009106786,
                                     0.008035524,
                                     0.011327399,
                                     0.01344867],
                             'max_mae': 0.015033475,
                             'max_mse': 0.0004709,
                             'max_rmse': 0.021700231,
                             'median_distance': 1.6592221,
                             'median_mae': 0.01112352,
                             'min_cosine': 0.019909747,
                             'mse': [0.00017097319,
                                     0.00025192776,
                                     0.00017391918,
                                     0.00031107798,
                                     0.00018304143,
                                     0.00042832666,
                                     0.00040338287,
                                     0.0004709,
                                     0.0003723062,
                                     0.00037559727,
                                     0.00029691166,
                                     0.0001900803,
                                     0.0004204732,
                                     0.00030130497,
                                     0.0002533176,
                                     0.00035477008,
                                     0.00019524078,
                                     0.00026732808,
                                     0.00023366816,
                                     0.00037532448,
                                     0.00029290418,
                                     0.00031710163,
                                     0.00022444726,
                                     0.00026049674,
                                     0.00019305486,
                                     0.0003235765,
                                     0.0002753018,
                                     0.00032004758,
                                     0.00021881156,
                                     0.00016561287,
                                     0.00016984424,
                                     0.00027140914,
                                     0.00036510624],
                             'rmse': [0.013075671,
                                      0.015872233,
                                      0.013187842,
                                      0.017637404,
                                      0.01352928,
                                      0.020696055,
                                      0.020084394,
                                      0.021700231,
                                      0.019295238,
                                      0.019380333,
                                      0.017231125,
                                      0.013786961,
                                      0.020505443,
                                      0.01735814,
                                      0.015915954,
                                      0.018835342,
                                      0.013972859,
                                      0.01635017,
                                      0.015286208,
                                      0.019373292,
                                      0.017114444,
                                      0.017807348,
                                      0.014981564,
                                      0.016139911,
                                      0.013894418,
                                      0.017988233,
                                      0.016592221,
                                      0.017889874,
                                      0.01479228,
                                      0.012869067,
                                      0.01303243,
                                      0.0164745,
                                      0.019107753]},
 'residuals': {'mae': 0.011169128119945526,
               'mse': 0.0002856844221241772,
               'psnr': 21.040130615234375,
               'rmse': 0.016902200877666473,
               'ssds': [105.69071, 11.214829],
               'ssim': 0.34375622868537903},
 'spectra_pcagan': {'cosine': [0.99791515,
                               0.9992394,
                               0.98729867,
                               0.9954733,
                               0.98675245,
                               0.998511,
                               0.9989485,
                               0.9994112,
                               0.9848784,
                               0.99465656,
                               0.9968976,
                               0.99317634,
                               0.9991775,
                               0.99681336,
                               0.9851423,
                               0.9915168,
                               0.99675363,
                               0.99484575,
                               0.97827375,
                               0.99216044,
                               0.96020526,
                               0.9807017,
                               0.98966044,
                               0.9812881,
                               0.9910096,
                               0.99931276,
                               0.9852181,
                               0.9974,
                               0.9886881,
                               0.9965779,
                               0.99676585,
                               0.99841404,
                               0.99968857],
                    'mae': [0.01591519,
                            0.014805392,
                            0.020536983,
                            0.018414307,
                            0.020691147,
                            0.018155288,
                            0.01714438,
                            0.019889725,
                            0.025570536,
                            0.048586864,
                            0.05731162,
                            0.030163849,
                            0.01996753,
                            0.05370352,
                            0.032053474,
                            0.022096911,
                            0.04689876,
                            0.04346115,
                            0.18002158,
                            0.029902142,
                            0.05740315,
                            0.032427922,
                            0.025173044,
                            0.040539164,
                            0.023961835,
                            0.017820036,
                            0.022310892,
                            0.020054065,
                            0.021236297,
                            0.017379936,
                            0.0190655,
                            0.018605804,
                            0.016817959],
                    'max_mae': 0.18002158,
                    'max_mse': 0.03509312,
                    'max_rmse': 0.18733159,
                    'median_mae': 0.022096911,
                    'min_cosine': 0.96020526,
                    'mse': [0.00042287156,
                            0.0003504182,
                            0.00072365697,
                            0.0005949417,
                            0.0007471399,
                            0.0005653742,
                            0.00047566614,
                            0.00057743036,
                            0.001115662,
                            0.003692025,
                            0.0054478105,
                            0.0015379776,
                            0.000621546,
                            0.00424654,
                            0.0017015925,
                            0.00086683605,
                            0.0032505814,
                            0.0029502537,
                            0.03509312,
                            0.0017235958,
                            0.004219048,
                            0.0018169777,
                            0.0011017547,
                            0.0024610816,
                            0.00096346444,
                            0.00048132954,
                            0.0009628,
                            0.00067569554,
                            0.00075646065,
                            0.0005117833,
                            0.0006096611,
                            0.0005592874,
                            0.000412214],
                    'rmse': [0.02056384,
                             0.01871946,
                             0.026900873,
                             0.024391428,
                             0.02733386,
                             0.023777599,
                             0.021809772,
                             0.02402978,
                             0.033401527,
                             0.060762037,
                             0.07380929,
                             0.03921706,
                             0.024930824,
                             0.06516548,
                             0.041250363,
                             0.02944208,
                             0.05701387,
                             0.054316238,
                             0.18733159,
                             0.04151621,
                             0.0649542,
                             0.042626023,
                             0.03319269,
                             0.04960929,
                             0.031039724,
                             0.021939224,
                             0.03102902,
                             0.025994144,
                             0.02750383,
                             0.022622628,
                             0.024691317,
                             0.023649257,
                             0.020303054]},
 'spectra_realgan': {'cosine': [0.9972508,
                                0.9992217,
                                0.9832243,
                                0.9942407,
                                0.9827068,
                                0.99848765,
                                0.9989239,
                                0.99940866,
                                0.981297,
                                0.9941067,
                                0.9965379,
                                0.99172515,
                                0.99917454,
                                0.99628705,
                                0.98253846,
                                0.98896176,
                                0.9960904,
                                0.9940449,
                                0.9766165,
                                0.9904791,
                                0.95758724,
                                0.9774088,
                                0.98670197,
                                0.97857785,
                                0.9882232,
                                0.99931186,
                                0.9807606,
                                0.99736637,
                                0.9840904,
                                0.9953628,
                                0.9951784,
                                0.99834573,
                                0.9996884],
                     'mae': [0.01854198,
                             0.014985778,
                             0.023866238,
                             0.021071851,
                             0.024249308,
                             0.018311145,
                             0.017341811,
                             0.019904904,
                             0.028784158,
                             0.050913114,
                             0.059168078,
                             0.03345968,
                             0.019981595,
                             0.055011444,
                             0.03497756,
                             0.025771726,
                             0.048374493,
                             0.04506426,
                             0.18023531,
                             0.033359133,
                             0.05806259,
                             0.03555152,
                             0.02864439,
                             0.04216679,
                             0.02758377,
                             0.017824937,
                             0.026277814,
                             0.02017742,
                             0.02529138,
                             0.020647043,
                             0.022136098,
                             0.018928431,
                             0.016816907],
                     'max_mae': 0.18023531,
                     'max_mse': 0.035449803,
                     'max_rmse': 0.18828118,
                     'median_mae': 0.025771726,
                     'min_cosine': 0.95758724,
                     'mse': [0.00055797707,
                             0.00035868314,
                             0.00095437886,
                             0.0007570537,
                             0.0009759421,
                             0.0005737491,
                             0.00048503513,
                             0.0005789536,
                             0.0013730456,
                             0.004070556,
                             0.0057761464,
                             0.0018476741,
                             0.0006221682,
                             0.0045668185,
                             0.0019810996,
                             0.0011185808,
                             0.0035820708,
                             0.0032059634,
                             0.035449803,
                             0.0020360278,
                             0.004457984,
                             0.0021198776,
                             0.0013743723,
                             0.0027345,
                             0.0012311836,
                             0.00048168088,
                             0.0012288577,
                             0.0006819425,
                             0.0010366923,
                             0.0006882518,
                             0.0008001526,
                             0.0005767722,
                             0.0004122014],
                     'rmse': [0.023621539,
                              0.018938933,
                              0.030893022,
                              0.027514609,
                              0.031240072,
                              0.02395306,
                              0.022023514,
                              0.024061454,
                              0.03705463,
                              0.06380091,
                              0.076000966,
                              0.04298458,
                              0.0249433,
                              0.06757824,
                              0.044509545,
                              0.03344519,
                              0.059850402,
                              0.056621227,
                              0.18828118,
                              0.045122366,
                              0.06676814,
                              0.04604213,
                              0.03707253,
                              0.052292448,
                              0.035088226,
                              0.02194723,
                              0.035055067,
                              0.026114028,
                              0.032197706,
                              0.026234554,
                              0.02828697,
                              0.024016082,
                              0.020302743]},
 'spectra_realpca': {'cosine': [0.99941355,
                                0.99998814,
                                0.9957356,
                                0.998698,
                                0.99569887,
                                0.9999845,
                                0.9999832,
                                0.99999875,
                                0.9967681,
                                0.9994052,
                                0.9996286,
                                0.9985155,
                                0.9999979,
                                0.99947584,
                                0.9973105,
                                0.9977682,
                                0.9993314,
                                0.99912035,
                                0.99827576,
                                0.99833775,
                                0.9965816,
                                0.99687755,
                                0.99688196,
                                0.9971458,
                                0.99752945,
                                0.9999992,
                                0.9955944,
                                0.9999606,
                                0.9955735,
                                0.99877906,
                                0.9984161,
                                0.9999313,
                                0.99999976],
                     'mae': [0.008563769,
                             0.0018350834,
                             0.012190897,
                             0.0103168795,
                             0.012213137,
                             0.0018597958,
                             0.0020792447,
                             0.00071239646,
                             0.012075761,
                             0.015990539,
                             0.017016644,
                             0.014350504,
                             0.0008286392,
                             0.015691921,
                             0.013674681,
                             0.011808165,
                             0.015641429,
                             0.015466908,
                             0.014332716,
                             0.014227754,
                             0.013680603,
                             0.013392996,
                             0.013646216,
                             0.013817455,
                             0.012011342,
                             0.00051225646,
                             0.012797409,
                             0.002375326,
                             0.012817001,
                             0.010629831,
                             0.011318606,
                             0.0035068558,
                             0.0003610792],
                     'max_mae': 0.017016644,
                     'max_mse': 0.00046590014,
                     'max_rmse': 0.02158472,
                     'median_mae': 0.012190897,
                     'min_cosine': 0.9955735,
                     'mse': [0.00011781584,
                             5.4096836e-06,
                             0.00023832786,
                             0.00017065123,
                             0.00024033082,
                             5.588147e-06,
                             6.9714383e-06,
                             8.0806564e-07,
                             0.00023464623,
                             0.0004117622,
                             0.00046590014,
                             0.0003276158,
                             1.1026099e-06,
                             0.00039634015,
                             0.0002996277,
                             0.00022430987,
                             0.000390806,
                             0.00038375976,
                             0.0003604948,
                             0.00032379542,
                             0.0002988494,
                             0.00029122058,
                             0.00029816874,
                             0.0003022724,
                             0.00022888882,
                             4.3033455e-07,
                             0.00026282214,
                             9.028615e-06,
                             0.00026510863,
                             0.00018106286,
                             0.00020429459,
                             1.9797682e-05,
                             2.1103553e-07],
                     'rmse': [0.010854301,
                              0.0023258727,
                              0.015437871,
                              0.013063354,
                              0.0155026065,
                              0.0023639263,
                              0.0026403482,
                              0.0008989247,
                              0.015318166,
                              0.020291924,
                              0.02158472,
                              0.01810016,
                              0.0010500523,
                              0.019908294,
                              0.017309757,
                              0.014976978,
                              0.019768814,
                              0.019589787,
                              0.0189867,
                              0.017994316,
                              0.017287262,
                              0.017065186,
                              0.017267562,
                              0.017385984,
                              0.015129072,
                              0.0006559989,
                              0.016211791,
                              0.0030047654,
                              0.016282156,
                              0.01345596,
                              0.014293166,
                              0.004449459,
                              0.00045938604]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_65.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516
Directory path: experiments/inpainting/gann_4_night_20180722_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_65.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_65.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.35918432275619, 3.1215890132546327],
                   'kl_div': 0.8423621,
                   'ks_tests': {10000: KstestResult(statistic=0.3062, pvalue=1e-323, statistic_location=0.007794395, statistic_sign=1),
                                20000: KstestResult(statistic=0.3094, pvalue=0.0, statistic_location=0.008423564, statistic_sign=1),
                                30000: KstestResult(statistic=0.30023333333333335, pvalue=0.0, statistic_location=0.00735577, statistic_sign=1),
                                40000: KstestResult(statistic=0.303825, pvalue=0.0, statistic_location=0.008372767, statistic_sign=1),
                                50000: KstestResult(statistic=0.30402000000000007, pvalue=0.0, statistic_location=0.008763181, statistic_sign=1),
                                60000: KstestResult(statistic=0.30353333333333343, pvalue=0.0, statistic_location=0.008789714, statistic_sign=1),
                                70000: KstestResult(statistic=0.30107142857142855, pvalue=0.0, statistic_location=0.008792667, statistic_sign=1),
                                80000: KstestResult(statistic=0.30252500000000004, pvalue=0.0, statistic_location=0.008496827, statistic_sign=1),
                                90000: KstestResult(statistic=0.30503333333333327, pvalue=0.0, statistic_location=0.008097749, statistic_sign=1),
                                100000: KstestResult(statistic=0.30848, pvalue=0.0, statistic_location=0.008698792, statistic_sign=1),
                                110000: KstestResult(statistic=0.3008545454545455, pvalue=0.0, statistic_location=0.00869315, statistic_sign=1)},
                   'moments': {'mean_error': 0.08277822,
                               'means': [-0.00073593855, -0.00044577167],
                               'stds': [0.022726193, 0.005489738],
                               'variance_ratio': 8.24979}},
 'originals': {'gan': {'mae': 0.05885758250951767,
                       'mse': 0.005448393989354372,
                       'psnr': 27.10418128967285,
                       'rmse': 0.07381323724985123,
                       'ssim': 0.603545069694519},
               'pca': {'mae': 0.012983637861907482,
                       'mse': 0.0002722899953369051,
                       'psnr': 40.598304748535156,
                       'rmse': 0.016501212492585182,
                       'ssim': 0.9844791293144226}},
 'reconstructions': {'mae': 0.057177815586328506,
                     'mse': 0.005125264637172222,
                     'psnr': 27.851459503173828,
                     'rmse': 0.07159095257520676,
                     'ssim': 0.6051655411720276},
 'residual_spectra_pcagan': {'cosine': [0.26564148,
                                        0.23854306,
                                        0.23416865,
                                        0.26053408,
                                        0.25381,
                                        0.33885944,
                                        0.29297134,
                                        0.24404314,
                                        0.2251663,
                                        0.22150944,
                                        0.2624583],
                             'mae': [0.014994153,
                                     0.017118374,
                                     0.017104134,
                                     0.016188318,
                                     0.014930034,
                                     0.014704486,
                                     0.013270199,
                                     0.018236991,
                                     0.020036701,
                                     0.018978633,
                                     0.016830673],
                             'max_mae': 0.020036701,
                             'max_mse': 0.0006272451,
                             'max_rmse': 0.025044862,
                             'median_distance': 2.189767,
                             'median_mae': 0.016830673,
                             'min_cosine': 0.22150944,
                             'mse': [0.0003872383,
                                     0.0006108163,
                                     0.0005075031,
                                     0.00041695996,
                                     0.00047950787,
                                     0.00036319596,
                                     0.0003557844,
                                     0.0005323883,
                                     0.0006272451,
                                     0.0005663711,
                                     0.0004724926],
                             'rmse': [0.019678371,
                                      0.024714697,
                                      0.022527829,
                                      0.020419598,
                                      0.021897668,
                                      0.0190577,
                                      0.018862247,
                                      0.023073541,
                                      0.025044862,
                                      0.023798551,
                                      0.021736896]},
 'residuals': {'mae': 0.016581155359745026,
               'mse': 0.0004835911968257278,
               'psnr': 8.197175025939941,
               'rmse': 0.021990707144141197,
               'ssds': [56.87184, 3.3369234],
               'ssim': 0.12163029611110687},
 'spectra_pcagan': {'cosine': [0.99116933,
                               0.9842978,
                               0.96088547,
                               0.95188564,
                               0.95586,
                               0.972211,
                               0.975154,
                               0.93962836,
                               0.9159561,
                               0.91690403,
                               0.9272211],
                    'mae': [0.071225174,
                            0.07258539,
                            0.06246844,
                            0.06437354,
                            0.045106705,
                            0.042673133,
                            0.03895635,
                            0.054263283,
                            0.06242841,
                            0.059908032,
                            0.05496742],
                    'max_mae': 0.07258539,
                    'max_mse': 0.007976555,
                    'max_rmse': 0.08931156,
                    'median_mae': 0.059908032,
                    'min_cosine': 0.9159561,
                    'mse': [0.0075000906,
                            0.007976555,
                            0.005692697,
                            0.006373456,
                            0.0031035342,
                            0.0027325316,
                            0.0024625135,
                            0.004419792,
                            0.0059709065,
                            0.005377533,
                            0.004768304],
                    'rmse': [0.08660306,
                             0.08931156,
                             0.075449966,
                             0.07983393,
                             0.055709373,
                             0.052273624,
                             0.04962372,
                             0.066481516,
                             0.07727164,
                             0.07333166,
                             0.069052905]},
 'spectra_realgan': {'cosine': [0.99050224,
                                0.98320454,
                                0.958425,
                                0.9485156,
                                0.95228004,
                                0.96986884,
                                0.97265184,
                                0.9365318,
                                0.912984,
                                0.91408354,
                                0.92231876],
                     'mae': [0.073525995,
                             0.07423982,
                             0.06392931,
                             0.066407725,
                             0.046533234,
                             0.044256676,
                             0.041072655,
                             0.05594315,
                             0.06368616,
                             0.06099438,
                             0.056844275],
                     'max_mae': 0.07423982,
                     'max_mse': 0.00842498,
                     'max_rmse': 0.09178769,
                     'median_mae': 0.06099438,
                     'min_cosine': 0.912984,
                     'mse': [0.008046477,
                             0.00842498,
                             0.0059988564,
                             0.0067990287,
                             0.0033501007,
                             0.0030101966,
                             0.0027172633,
                             0.004679983,
                             0.006192801,
                             0.005587246,
                             0.0051254076],
                     'rmse': [0.08970216,
                              0.09178769,
                              0.07745229,
                              0.08245622,
                              0.057880055,
                              0.05486526,
                              0.052127376,
                              0.068410404,
                              0.07869435,
                              0.07474788,
                              0.07159195]},
 'spectra_realpca': {'cosine': [0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349],
                     'mae': [0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197],
                     'max_mae': 0.015567541,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.012521197,
                     'min_cosine': 0.9963109,
                     'mse': [0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102],
                     'rmse': [0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_65.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115
Directory path: experiments/inpainting/gann_4_night_20180722_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_65.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_65.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.22363691969865, 3.112562869251242],
                   'kl_div': 0.6277143,
                   'ks_tests': {10000: KstestResult(statistic=0.2502, pvalue=3.439903058634323e-275, statistic_location=0.008001285, statistic_sign=1),
                                20000: KstestResult(statistic=0.25555000000000005, pvalue=0.0, statistic_location=0.00811347, statistic_sign=1),
                                30000: KstestResult(statistic=0.2543000000000001, pvalue=0.0, statistic_location=0.007995765, statistic_sign=1),
                                40000: KstestResult(statistic=0.254375, pvalue=0.0, statistic_location=0.0083919, statistic_sign=1),
                                50000: KstestResult(statistic=0.24974000000000007, pvalue=0.0, statistic_location=0.008576353, statistic_sign=1),
                                60000: KstestResult(statistic=0.25803333333333334, pvalue=0.0, statistic_location=0.008529812, statistic_sign=1),
                                70000: KstestResult(statistic=0.25384285714285715, pvalue=0.0, statistic_location=0.0081029, statistic_sign=1),
                                80000: KstestResult(statistic=0.25251250000000003, pvalue=0.0, statistic_location=0.008463716, statistic_sign=1),
                                90000: KstestResult(statistic=0.25187777777777776, pvalue=0.0, statistic_location=0.008588418, statistic_sign=1),
                                100000: KstestResult(statistic=0.2543700000000001, pvalue=0.0, statistic_location=0.007816604, statistic_sign=1),
                                110000: KstestResult(statistic=0.2551181818181818, pvalue=0.0, statistic_location=0.008534518, statistic_sign=1),
                                120000: KstestResult(statistic=0.25236666666666663, pvalue=0.0, statistic_location=0.008589868, statistic_sign=1),
                                130000: KstestResult(statistic=0.25086153846153847, pvalue=0.0, statistic_location=0.008585449, statistic_sign=1),
                                140000: KstestResult(statistic=0.25286428571428565, pvalue=0.0, statistic_location=0.008400332, statistic_sign=1),
                                150000: KstestResult(statistic=0.25302666666666673, pvalue=0.0, statistic_location=0.008109527, statistic_sign=1),
                                160000: KstestResult(statistic=0.25354375000000007, pvalue=0.0, statistic_location=0.008629643, statistic_sign=1),
                                170000: KstestResult(statistic=0.2546294117647059, pvalue=0.0, statistic_location=0.008111283, statistic_sign=1),
                                180000: KstestResult(statistic=0.25203333333333344, pvalue=0.0, statistic_location=0.008406952, statistic_sign=1),
                                190000: KstestResult(statistic=0.25336315789473685, pvalue=0.0, statistic_location=0.0085856635, statistic_sign=1),
                                200000: KstestResult(statistic=0.25373499999999993, pvalue=0.0, statistic_location=0.008115018, statistic_sign=1),
                                210000: KstestResult(statistic=0.25120952380952377, pvalue=0.0, statistic_location=0.007954748, statistic_sign=1),
                                220000: KstestResult(statistic=0.2525454545454545, pvalue=0.0, statistic_location=0.008589868, statistic_sign=1)},
                   'moments': {'mean_error': 0.0038906129,
                               'means': [-0.00054423965, -5.0476283e-05],
                               'stds': [0.019667108, 0.0054564234],
                               'variance_ratio': 8.458123}},
 'originals': {'gan': {'mae': 0.05455929413437843,
                       'mse': 0.004739472642540932,
                       'psnr': 27.725784301757812,
                       'rmse': 0.06884382665157318,
                       'ssim': 0.6566916704177856},
               'pca': {'mae': 0.013096767477691174,
                       'mse': 0.00027656604652293026,
                       'psnr': 40.53063201904297,
                       'rmse': 0.016630275174975395,
                       'ssim': 0.9780802726745605}},
 'reconstructions': {'mae': 0.05278368294239044,
                     'mse': 0.004443435464054346,
                     'psnr': 28.471435546875,
                     'rmse': 0.0666591003537178,
                     'ssim': 0.6628926396369934},
 'residual_spectra_pcagan': {'cosine': [0.28260374,
                                        0.25427267,
                                        0.268355,
                                        0.29584593,
                                        0.23188978,
                                        0.28962916,
                                        0.25852224,
                                        0.26286912,
                                        0.29332796,
                                        0.2820993,
                                        0.37338552,
                                        0.32056358,
                                        0.26874948,
                                        0.25312474,
                                        0.2513672,
                                        0.27952856,
                                        0.23953755,
                                        0.28502464,
                                        0.30253372,
                                        0.32720825,
                                        0.27045548,
                                        0.29371408],
                             'mae': [0.010502031,
                                     0.010798579,
                                     0.010070845,
                                     0.010413214,
                                     0.012834576,
                                     0.012951301,
                                     0.0151773235,
                                     0.014890109,
                                     0.013906689,
                                     0.012997799,
                                     0.012823609,
                                     0.011811436,
                                     0.016060349,
                                     0.017822467,
                                     0.016626589,
                                     0.01516656,
                                     0.016007427,
                                     0.013797997,
                                     0.013872792,
                                     0.012407163,
                                     0.016223252,
                                     0.01292536],
                             'max_mae': 0.017822467,
                             'max_mse': 0.0005019679,
                             'max_rmse': 0.02240464,
                             'median_distance': 1.8121607,
                             'median_mae': 0.013397898,
                             'min_cosine': 0.23188978,
                             'mse': [0.00025930666,
                                     0.00030546763,
                                     0.00030148434,
                                     0.00024392085,
                                     0.00033087173,
                                     0.0003042353,
                                     0.0004983933,
                                     0.0003948954,
                                     0.00032153615,
                                     0.00038831035,
                                     0.0002838249,
                                     0.00029352694,
                                     0.00043116504,
                                     0.0005019679,
                                     0.00044528552,
                                     0.0003979254,
                                     0.00041768374,
                                     0.00035424353,
                                     0.0003210409,
                                     0.00029152032,
                                     0.00044081043,
                                     0.0003259229],
                             'rmse': [0.016103001,
                                      0.017477632,
                                      0.017363304,
                                      0.015617966,
                                      0.01818988,
                                      0.017442342,
                                      0.022324724,
                                      0.019871976,
                                      0.01793143,
                                      0.019705592,
                                      0.016847104,
                                      0.017132629,
                                      0.020764515,
                                      0.02240464,
                                      0.02110179,
                                      0.019948067,
                                      0.020437313,
                                      0.018821359,
                                      0.017917614,
                                      0.017073967,
                                      0.020995487,
                                      0.018053336]},
 'residuals': {'mae': 0.013640339486300945,
               'mse': 0.0003569700347725302,
               'psnr': 20.099227905273438,
               'rmse': 0.0188936498016119,
               'ssds': [85.1597, 6.550493],
               'ssim': 0.16781511902809143},
 'spectra_pcagan': {'cosine': [0.9902773,
                               0.99058205,
                               0.98593557,
                               0.98166245,
                               0.98475355,
                               0.99134403,
                               0.98469067,
                               0.9618693,
                               0.9533671,
                               0.9566785,
                               0.97290313,
                               0.9757846,
                               0.94132704,
                               0.91703165,
                               0.91814286,
                               0.9270977,
                               0.9028449,
                               0.9609457,
                               0.9464992,
                               0.9642788,
                               0.9262062,
                               0.9555533],
                    'mae': [0.04954987,
                            0.04831482,
                            0.04154204,
                            0.037994385,
                            0.056879994,
                            0.070389315,
                            0.07150371,
                            0.061738495,
                            0.06303579,
                            0.044605147,
                            0.042243615,
                            0.038479164,
                            0.05336855,
                            0.06202688,
                            0.0593197,
                            0.054996807,
                            0.06251957,
                            0.0451165,
                            0.05207317,
                            0.041342534,
                            0.058123376,
                            0.046077438],
                    'max_mae': 0.07150371,
                    'max_mse': 0.007799086,
                    'max_rmse': 0.08831243,
                    'median_mae': 0.05272086,
                    'min_cosine': 0.9028449,
                    'mse': [0.0040059844,
                            0.0040321765,
                            0.0028679508,
                            0.0023258596,
                            0.0047913417,
                            0.0073422515,
                            0.007799086,
                            0.005567095,
                            0.0061341664,
                            0.0030706367,
                            0.0026718352,
                            0.002433345,
                            0.004295135,
                            0.0059063034,
                            0.0053027747,
                            0.0047799936,
                            0.006218094,
                            0.0031185155,
                            0.00393515,
                            0.00280235,
                            0.00520777,
                            0.003147773],
                    'rmse': [0.063292846,
                             0.06349942,
                             0.053553253,
                             0.04822717,
                             0.069219515,
                             0.08568694,
                             0.08831243,
                             0.07461297,
                             0.07832092,
                             0.055413324,
                             0.0516898,
                             0.049328946,
                             0.06553728,
                             0.07685248,
                             0.07282016,
                             0.0691375,
                             0.07885489,
                             0.05584367,
                             0.062730774,
                             0.05293723,
                             0.07216488,
                             0.056105018]},
 'spectra_realgan': {'cosine': [0.9896691,
                                0.9898579,
                                0.98456603,
                                0.9791487,
                                0.983875,
                                0.9906742,
                                0.9836056,
                                0.95940924,
                                0.950004,
                                0.9531188,
                                0.9706316,
                                0.9733282,
                                0.93827266,
                                0.91403544,
                                0.91530865,
                                0.92216086,
                                0.9011053,
                                0.9585088,
                                0.94279194,
                                0.9608301,
                                0.92520034,
                                0.95235986],
                     'mae': [0.05091956,
                             0.05065085,
                             0.044404034,
                             0.041118804,
                             0.058669947,
                             0.07273627,
                             0.07316233,
                             0.063168325,
                             0.06512662,
                             0.046040375,
                             0.04382759,
                             0.040590435,
                             0.05506352,
                             0.06331624,
                             0.060418434,
                             0.056880366,
                             0.06340985,
                             0.046374947,
                             0.05363102,
                             0.043673262,
                             0.059573457,
                             0.04754814],
                     'max_mae': 0.07316233,
                     'max_mse': 0.008238449,
                     'max_rmse': 0.0907659,
                     'median_mae': 0.05434727,
                     'min_cosine': 0.9011053,
                     'mse': [0.0042169,
                             0.00437998,
                             0.003240988,
                             0.0026799885,
                             0.0051155905,
                             0.007887149,
                             0.008238449,
                             0.005872001,
                             0.006557111,
                             0.0033155568,
                             0.0029443847,
                             0.0026845408,
                             0.004551976,
                             0.006129314,
                             0.005513082,
                             0.0051394324,
                             0.0063526644,
                             0.0033178928,
                             0.004240858,
                             0.0030703791,
                             0.005419961,
                             0.0034001968],
                     'rmse': [0.064937666,
                              0.066181414,
                              0.056929674,
                              0.051768605,
                              0.07152335,
                              0.088809624,
                              0.0907659,
                              0.07662898,
                              0.080975994,
                              0.057580873,
                              0.054262184,
                              0.051812556,
                              0.06746833,
                              0.07828993,
                              0.07425013,
                              0.07168984,
                              0.07970361,
                              0.057601154,
                              0.06512187,
                              0.055411004,
                              0.07362039,
                              0.058311205]},
 'spectra_realpca': {'cosine': [0.99914396,
                                0.9992311,
                                0.9983727,
                                0.9974544,
                                0.99898773,
                                0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349,
                                0.99650675,
                                0.9971242,
                                0.9965543,
                                0.9968424,
                                0.9962396,
                                0.99634945],
                     'mae': [0.014836307,
                             0.01447966,
                             0.013651306,
                             0.013377094,
                             0.014316244,
                             0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197,
                             0.012154227,
                             0.011967489,
                             0.012771271,
                             0.012152725,
                             0.013049042,
                             0.0125535],
                     'max_mae': 0.015567541,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.012704127,
                     'min_cosine': 0.9962396,
                     'mse': [0.00034976797,
                             0.00033549307,
                             0.00029904975,
                             0.00028346918,
                             0.00032609524,
                             0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102,
                             0.00023534271,
                             0.00023139741,
                             0.00026069232,
                             0.00023610053,
                             0.0002807898,
                             0.0002510656],
                     'rmse': [0.018702084,
                              0.01831647,
                              0.017293055,
                              0.016836543,
                              0.018058106,
                              0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779,
                              0.015340883,
                              0.015211753,
                              0.016145969,
                              0.015365563,
                              0.016756784,
                              0.01584505]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_65.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453
Directory path: experiments/inpainting/gann_4_night_20180722_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_65.0/images
Optimal number of principal components:  1
Reconstruction error:  17.037945
Energy conservation:  0.8318019
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_65.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.111089078084709, 3.1001794530905693],
                   'kl_div': 0.49720812,
                   'ks_tests': {10000: KstestResult(statistic=0.2232, pvalue=1.3214384633841424e-218, statistic_location=0.008322258, statistic_sign=1),
                                20000: KstestResult(statistic=0.2238, pvalue=0.0, statistic_location=0.0074604955, statistic_sign=1),
                                30000: KstestResult(statistic=0.21606666666666663, pvalue=0.0, statistic_location=0.008135723, statistic_sign=1),
                                40000: KstestResult(statistic=0.21660000000000001, pvalue=0.0, statistic_location=0.007530013, statistic_sign=1),
                                50000: KstestResult(statistic=0.21822000000000008, pvalue=0.0, statistic_location=0.008071249, statistic_sign=1),
                                60000: KstestResult(statistic=0.21653333333333324, pvalue=0.0, statistic_location=0.0074658208, statistic_sign=1),
                                70000: KstestResult(statistic=0.21548571428571428, pvalue=0.0, statistic_location=0.007525025, statistic_sign=1),
                                80000: KstestResult(statistic=0.21894999999999998, pvalue=0.0, statistic_location=0.0075053163, statistic_sign=1),
                                90000: KstestResult(statistic=0.21899999999999997, pvalue=0.0, statistic_location=0.007957669, statistic_sign=1),
                                100000: KstestResult(statistic=0.21660999999999997, pvalue=0.0, statistic_location=0.008082017, statistic_sign=1),
                                110000: KstestResult(statistic=0.217409090909091, pvalue=0.0, statistic_location=0.0075507206, statistic_sign=1),
                                120000: KstestResult(statistic=0.2190416666666667, pvalue=0.0, statistic_location=0.008084369, statistic_sign=1),
                                130000: KstestResult(statistic=0.2164846153846154, pvalue=0.0, statistic_location=0.008008445, statistic_sign=1),
                                140000: KstestResult(statistic=0.2181928571428572, pvalue=0.0, statistic_location=0.008068031, statistic_sign=1),
                                150000: KstestResult(statistic=0.21933333333333327, pvalue=0.0, statistic_location=0.008113654, statistic_sign=1),
                                160000: KstestResult(statistic=0.22031250000000002, pvalue=0.0, statistic_location=0.0075090257, statistic_sign=1),
                                170000: KstestResult(statistic=0.2197058823529412, pvalue=0.0, statistic_location=0.007530013, statistic_sign=1),
                                180000: KstestResult(statistic=0.2182222222222222, pvalue=0.0, statistic_location=0.0081029, statistic_sign=1),
                                190000: KstestResult(statistic=0.21999999999999997, pvalue=0.0, statistic_location=0.007523282, statistic_sign=1),
                                200000: KstestResult(statistic=0.21719999999999995, pvalue=0.0, statistic_location=0.007525025, statistic_sign=1),
                                210000: KstestResult(statistic=0.21769523809523805, pvalue=0.0, statistic_location=0.007470891, statistic_sign=1),
                                220000: KstestResult(statistic=0.21833636363636366, pvalue=0.0, statistic_location=0.007485315, statistic_sign=1),
                                230000: KstestResult(statistic=0.2188913043478261, pvalue=0.0, statistic_location=0.007517312, statistic_sign=1),
                                240000: KstestResult(statistic=0.21837916666666668, pvalue=0.0, statistic_location=0.0075175166, statistic_sign=1),
                                250000: KstestResult(statistic=0.21894400000000003, pvalue=0.0, statistic_location=0.00752417, statistic_sign=1),
                                260000: KstestResult(statistic=0.21687692307692308, pvalue=0.0, statistic_location=0.007551597, statistic_sign=1),
                                270000: KstestResult(statistic=0.21694074074074077, pvalue=0.0, statistic_location=0.0078043565, statistic_sign=1),
                                280000: KstestResult(statistic=0.2187285714285715, pvalue=0.0, statistic_location=0.00752417, statistic_sign=1),
                                290000: KstestResult(statistic=0.21965862068965514, pvalue=0.0, statistic_location=0.0074943705, statistic_sign=1),
                                300000: KstestResult(statistic=0.21875333333333336, pvalue=0.0, statistic_location=0.0075507206, statistic_sign=1),
                                310000: KstestResult(statistic=0.2173677419354838, pvalue=0.0, statistic_location=0.007864058, statistic_sign=1),
                                320000: KstestResult(statistic=0.21924374999999996, pvalue=0.0, statistic_location=0.0074946387, statistic_sign=1),
                                330000: KstestResult(statistic=0.21814242424242425, pvalue=0.0, statistic_location=0.007433122, statistic_sign=1)},
                   'moments': {'mean_error': -0.0042404295,
                               'means': [-0.00039863147, -2.1693977e-05],
                               'stds': [0.017679268, 0.005385532],
                               'variance_ratio': 8.627582}},
 'originals': {'gan': {'mae': 0.05171003192663193,
                       'mse': 0.004362098407000303,
                       'psnr': 28.81952667236328,
                       'rmse': 0.06604618579149246,
                       'ssim': 0.7228677272796631},
               'pca': {'mae': 0.013429644517600536,
                       'mse': 0.00029108254238963127,
                       'psnr': 40.7747917175293,
                       'rmse': 0.01706114038825035,
                       'ssim': 0.9816524982452393}},
 'reconstructions': {'mae': 0.04971151053905487,
                     'mse': 0.004055059049278498,
                     'psnr': 29.33498191833496,
                     'rmse': 0.06367934495210648,
                     'ssim': 0.7297914624214172},
 'residual_spectra_pcagan': {'cosine': [0.43865642,
                                        0.24162422,
                                        0.33851382,
                                        0.2904345,
                                        0.31440586,
                                        0.27107003,
                                        0.29740414,
                                        0.26412457,
                                        0.30329663,
                                        0.31571752,
                                        0.2341939,
                                        0.30094036,
                                        0.27264938,
                                        0.28328276,
                                        0.31187657,
                                        0.30602232,
                                        0.39502403,
                                        0.35032323,
                                        0.28461316,
                                        0.2715893,
                                        0.27236634,
                                        0.28819954,
                                        0.25545248,
                                        0.30801818,
                                        0.32594854,
                                        0.35910082,
                                        0.2935288,
                                        0.30909878,
                                        0.3610874,
                                        0.37976265,
                                        0.32860368,
                                        0.33697698,
                                        0.28380537],
                             'mae': [0.010307829,
                                     0.011543067,
                                     0.009078416,
                                     0.009397869,
                                     0.009183342,
                                     0.010454051,
                                     0.0099123595,
                                     0.010413985,
                                     0.009421885,
                                     0.010166941,
                                     0.012307652,
                                     0.012033404,
                                     0.014177274,
                                     0.01385857,
                                     0.012729086,
                                     0.011991444,
                                     0.011697062,
                                     0.011068564,
                                     0.014922364,
                                     0.016551461,
                                     0.015271266,
                                     0.014176084,
                                     0.014681517,
                                     0.012756438,
                                     0.012809018,
                                     0.011260095,
                                     0.014887729,
                                     0.01216543,
                                     0.009162823,
                                     0.009436313,
                                     0.009196771,
                                     0.009405595,
                                     0.011066853],
                             'max_mae': 0.016551461,
                             'max_mse': 0.0004356272,
                             'max_rmse': 0.020871684,
                             'median_distance': 1.6654694,
                             'median_mae': 0.011543067,
                             'min_cosine': 0.2341939,
                             'mse': [0.00020070293,
                                     0.000314841,
                                     0.00018760165,
                                     0.00023998735,
                                     0.00018848691,
                                     0.00030048433,
                                     0.00024126201,
                                     0.0002852728,
                                     0.00024048776,
                                     0.00021730617,
                                     0.00032217198,
                                     0.00026426348,
                                     0.00043222724,
                                     0.0003413647,
                                     0.00027737874,
                                     0.00032536022,
                                     0.00023890019,
                                     0.0002495822,
                                     0.00038487438,
                                     0.0004356272,
                                     0.00037485873,
                                     0.00036444768,
                                     0.00036045545,
                                     0.00030593012,
                                     0.00027573522,
                                     0.00023915702,
                                     0.00037236547,
                                     0.00028663193,
                                     0.00018535437,
                                     0.00018155565,
                                     0.00020665588,
                                     0.00022121977,
                                     0.0002972659],
                             'rmse': [0.014166966,
                                      0.017743759,
                                      0.013696775,
                                      0.015491525,
                                      0.013729054,
                                      0.017334484,
                                      0.015532611,
                                      0.016890021,
                                      0.015507667,
                                      0.014741308,
                                      0.017949149,
                                      0.016256183,
                                      0.020790076,
                                      0.018476058,
                                      0.01665469,
                                      0.018037744,
                                      0.015456396,
                                      0.01579817,
                                      0.019618215,
                                      0.020871684,
                                      0.019361269,
                                      0.019090513,
                                      0.018985664,
                                      0.017490858,
                                      0.016605277,
                                      0.015464703,
                                      0.019296773,
                                      0.016930208,
                                      0.013614491,
                                      0.013474259,
                                      0.01437553,
                                      0.014873459,
                                      0.017241402]},
 'residuals': {'mae': 0.011742199771106243,
               'mse': 0.00028363082674331963,
               'psnr': 21.098011016845703,
               'rmse': 0.01684134267270565,
               'ssds': [103.19576, 9.571429],
               'ssim': 0.22103337943553925},
 'spectra_pcagan': {'cosine': [0.9963698,
                               0.99438685,
                               0.9956266,
                               0.9947156,
                               0.9958619,
                               0.9941898,
                               0.99029875,
                               0.99031955,
                               0.9854418,
                               0.9806126,
                               0.9842539,
                               0.99106264,
                               0.98436266,
                               0.9612392,
                               0.95402,
                               0.95667464,
                               0.9732843,
                               0.9759182,
                               0.9413496,
                               0.9185366,
                               0.9188191,
                               0.92797846,
                               0.90390915,
                               0.9617075,
                               0.94762224,
                               0.9649784,
                               0.9271132,
                               0.9554265,
                               0.9740822,
                               0.9776025,
                               0.98743755,
                               0.98771983,
                               0.9894869],
                    'mae': [0.02895067,
                            0.04266675,
                            0.049023084,
                            0.048572775,
                            0.056023497,
                            0.061252892,
                            0.0495633,
                            0.04903637,
                            0.042492125,
                            0.03926784,
                            0.057685602,
                            0.071342446,
                            0.07214283,
                            0.062262837,
                            0.062302727,
                            0.04457293,
                            0.04187726,
                            0.038644116,
                            0.053261742,
                            0.06150753,
                            0.059135124,
                            0.054507904,
                            0.062075067,
                            0.044807233,
                            0.0516789,
                            0.041154943,
                            0.057749476,
                            0.046301115,
                            0.03875649,
                            0.0349078,
                            0.036869936,
                            0.038954005,
                            0.04113254],
                    'max_mae': 0.07214283,
                    'max_mse': 0.0079698,
                    'max_rmse': 0.089273736,
                    'median_mae': 0.049023084,
                    'min_cosine': 0.90390915,
                    'mse': [0.0012863175,
                            0.003211473,
                            0.0038858878,
                            0.0039039506,
                            0.004709052,
                            0.006123947,
                            0.0039803,
                            0.0041435203,
                            0.0029436299,
                            0.0024493064,
                            0.004946753,
                            0.0075787306,
                            0.0079698,
                            0.0056669,
                            0.0060025654,
                            0.0030856284,
                            0.0026376077,
                            0.0024500329,
                            0.004291196,
                            0.005813097,
                            0.0052758013,
                            0.0047103073,
                            0.0061652604,
                            0.0030924445,
                            0.0038729415,
                            0.0027854885,
                            0.0051631485,
                            0.0031829113,
                            0.0024941468,
                            0.0020058854,
                            0.0023234044,
                            0.002516884,
                            0.0031486047],
                    'rmse': [0.03586527,
                             0.05666986,
                             0.06233689,
                             0.0624816,
                             0.06862253,
                             0.07825565,
                             0.06308962,
                             0.064370185,
                             0.05425523,
                             0.049490467,
                             0.07033315,
                             0.08705591,
                             0.089273736,
                             0.07527881,
                             0.077476226,
                             0.055548433,
                             0.051357646,
                             0.049497806,
                             0.06550722,
                             0.07624367,
                             0.07263471,
                             0.06863168,
                             0.07851917,
                             0.05560975,
                             0.06223296,
                             0.052777726,
                             0.07185505,
                             0.056417298,
                             0.049941435,
                             0.044787113,
                             0.048201706,
                             0.050168555,
                             0.056112427]},
 'spectra_realgan': {'cosine': [0.99594945,
                                0.993599,
                                0.9950832,
                                0.9941495,
                                0.9954565,
                                0.99380606,
                                0.9896941,
                                0.98959345,
                                0.9840586,
                                0.9780391,
                                0.98338234,
                                0.99038804,
                                0.983271,
                                0.9587497,
                                0.95064867,
                                0.95316404,
                                0.97102016,
                                0.97345513,
                                0.93828213,
                                0.9155233,
                                0.9159966,
                                0.92306614,
                                0.90216774,
                                0.95925295,
                                0.9439704,
                                0.96156967,
                                0.92616457,
                                0.95225024,
                                0.9714461,
                                0.9741205,
                                0.98563623,
                                0.98602635,
                                0.98827475],
                     'mae': [0.030195968,
                             0.04384645,
                             0.05171915,
                             0.051315956,
                             0.0585284,
                             0.064356156,
                             0.05100211,
                             0.051354375,
                             0.045245912,
                             0.04232188,
                             0.059441272,
                             0.07366079,
                             0.073836826,
                             0.063720815,
                             0.06439157,
                             0.04602444,
                             0.04345906,
                             0.040787138,
                             0.05499627,
                             0.062789485,
                             0.06026786,
                             0.056387287,
                             0.0629972,
                             0.04607277,
                             0.05318295,
                             0.04348565,
                             0.059214,
                             0.047780782,
                             0.041187927,
                             0.037686408,
                             0.039182164,
                             0.041614648,
                             0.04437734],
                     'max_mae': 0.073836826,
                     'max_mse': 0.008408905,
                     'max_rmse': 0.091700085,
                     'median_mae': 0.051315956,
                     'min_cosine': 0.90216774,
                     'mse': [0.0013965998,
                             0.0033654594,
                             0.0043091304,
                             0.0043066847,
                             0.0051687118,
                             0.00663488,
                             0.004193502,
                             0.0044916635,
                             0.0033190364,
                             0.002811561,
                             0.005270784,
                             0.008125987,
                             0.008408905,
                             0.005973664,
                             0.0064246827,
                             0.0033273175,
                             0.0029098277,
                             0.0027023253,
                             0.0045493,
                             0.0060367663,
                             0.005485335,
                             0.0050676977,
                             0.006299948,
                             0.0032926055,
                             0.0041749026,
                             0.0030507362,
                             0.0053743967,
                             0.0034350727,
                             0.0027860254,
                             0.0022955164,
                             0.0025833887,
                             0.0028579237,
                             0.0035189064],
                     'rmse': [0.03737111,
                              0.05801258,
                              0.065643966,
                              0.06562533,
                              0.07189375,
                              0.08145477,
                              0.06475726,
                              0.06701987,
                              0.057611078,
                              0.053024154,
                              0.07260016,
                              0.090144254,
                              0.091700085,
                              0.077289484,
                              0.08015412,
                              0.057682905,
                              0.05394282,
                              0.051983897,
                              0.0674485,
                              0.07769663,
                              0.07406305,
                              0.071187764,
                              0.07937221,
                              0.05738123,
                              0.064613484,
                              0.05523347,
                              0.07331028,
                              0.058609493,
                              0.052782815,
                              0.047911547,
                              0.05082705,
                              0.05345955,
                              0.05932037]},
 'spectra_realpca': {'cosine': [0.99945366,
                                0.99925643,
                                0.99947244,
                                0.99940675,
                                0.9995555,
                                0.99957067,
                                0.99914396,
                                0.9992311,
                                0.9983727,
                                0.9974544,
                                0.99898773,
                                0.9995423,
                                0.9993179,
                                0.9979795,
                                0.9975442,
                                0.9963109,
                                0.99778163,
                                0.997526,
                                0.99689245,
                                0.9968519,
                                0.9964228,
                                0.9963349,
                                0.99650675,
                                0.9971242,
                                0.9965543,
                                0.9968424,
                                0.9962396,
                                0.99634945,
                                0.99715966,
                                0.99691385,
                                0.9982245,
                                0.99834263,
                                0.9988524],
                     'mae': [0.011083274,
                             0.014802759,
                             0.015157819,
                             0.015070052,
                             0.015472084,
                             0.015633475,
                             0.014836307,
                             0.01447966,
                             0.013651306,
                             0.013377094,
                             0.014316244,
                             0.015567541,
                             0.0147403255,
                             0.013568386,
                             0.013391189,
                             0.012636981,
                             0.0118744215,
                             0.012000888,
                             0.012077513,
                             0.012086099,
                             0.012355477,
                             0.012521197,
                             0.012154227,
                             0.011967489,
                             0.012771271,
                             0.012152725,
                             0.013049042,
                             0.0125535,
                             0.013193458,
                             0.0130807385,
                             0.013555716,
                             0.013718692,
                             0.014281331],
                     'max_mae': 0.015633475,
                     'max_mse': 0.00039138744,
                     'max_rmse': 0.019783514,
                     'median_mae': 0.013377094,
                     'min_cosine': 0.9962396,
                     'mse': [0.00019629093,
                             0.00035259564,
                             0.00036871652,
                             0.00035998295,
                             0.00038198216,
                             0.00038844542,
                             0.00034976797,
                             0.00033549307,
                             0.00029904975,
                             0.00028346918,
                             0.00032609524,
                             0.00039138744,
                             0.0003502637,
                             0.00029688963,
                             0.0002853818,
                             0.00025434463,
                             0.00022532715,
                             0.0002305388,
                             0.00023599855,
                             0.00023339248,
                             0.00024187475,
                             0.00024979102,
                             0.00023534271,
                             0.00023139741,
                             0.00026069232,
                             0.00023610053,
                             0.0002807898,
                             0.0002510656,
                             0.00027758113,
                             0.00027334486,
                             0.00029565947,
                             0.00030083008,
                             0.0003258427],
                     'rmse': [0.014010387,
                              0.01877753,
                              0.019201992,
                              0.018973216,
                              0.019544363,
                              0.019709019,
                              0.018702084,
                              0.01831647,
                              0.017293055,
                              0.016836543,
                              0.018058106,
                              0.019783514,
                              0.018715333,
                              0.017230485,
                              0.016893247,
                              0.015948186,
                              0.015010901,
                              0.015183505,
                              0.015362244,
                              0.015277188,
                              0.015552323,
                              0.015804779,
                              0.015340883,
                              0.015211753,
                              0.016145969,
                              0.015365563,
                              0.016756784,
                              0.01584505,
                              0.016660767,
                              0.016533144,
                              0.017194752,
                              0.017344454,
                              0.018051114]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_65.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957
Directory path: experiments/inpainting/gann_4_night_20180723_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_65.0/images
Optimal number of principal components:  9
Reconstruction error:  29.069643
Energy conservation:  0.6546106
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_65.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.075287224842861, 3.485543817874718],
                   'kl_div': 0.21336956,
                   'ks_tests': {10000: KstestResult(statistic=0.1485, pvalue=1.510177758248013e-96, statistic_location=0.008790191, statistic_sign=1),
                                20000: KstestResult(statistic=0.15290000000000004, pvalue=1.3501916228836356e-204, statistic_location=0.010901239, statistic_sign=1),
                                30000: KstestResult(statistic=0.15570000000000006, pvalue=4.841883e-318, statistic_location=0.010598455, statistic_sign=1),
                                40000: KstestResult(statistic=0.15557500000000002, pvalue=0.0, statistic_location=0.0094526475, statistic_sign=1),
                                50000: KstestResult(statistic=0.15815999999999997, pvalue=0.0, statistic_location=0.009525715, statistic_sign=1),
                                60000: KstestResult(statistic=0.15521666666666667, pvalue=0.0, statistic_location=0.009409086, statistic_sign=1),
                                70000: KstestResult(statistic=0.15249999999999997, pvalue=0.0, statistic_location=0.009798869, statistic_sign=1),
                                80000: KstestResult(statistic=0.15513750000000004, pvalue=0.0, statistic_location=0.010332776, statistic_sign=1),
                                90000: KstestResult(statistic=0.15297777777777777, pvalue=0.0, statistic_location=0.010340561, statistic_sign=1),
                                100000: KstestResult(statistic=0.15399000000000007, pvalue=0.0, statistic_location=0.009954551, statistic_sign=1),
                                110000: KstestResult(statistic=0.15395454545454546, pvalue=0.0, statistic_location=0.010340561, statistic_sign=1)},
                   'moments': {'mean_error': 0.09137569,
                               'means': [0.00018858185, -1.7783072e-05],
                               'stds': [0.018317485, 0.007910274],
                               'variance_ratio': 4.560324}},
 'originals': {'gan': {'mae': 0.03906693309545517,
                       'mse': 0.0029807095415890217,
                       'psnr': 25.58672332763672,
                       'rmse': 0.05459587648510933,
                       'ssim': 0.6822783946990967},
               'pca': {'mae': 0.015085321851074696,
                       'mse': 0.00036569463554769754,
                       'psnr': 34.76327133178711,
                       'rmse': 0.019123144447803497,
                       'ssim': 0.9066029787063599}},
 'reconstructions': {'mae': 0.03520313650369644,
                     'mse': 0.002630791161209345,
                     'psnr': 26.19359588623047,
                     'rmse': 0.05129123851656914,
                     'ssim': 0.7244146466255188},
 'residual_spectra_pcagan': {'cosine': [0.47943386,
                                        0.32434234,
                                        0.4349865,
                                        0.43860888,
                                        0.37528747,
                                        0.44694674,
                                        0.45081976,
                                        0.43217012,
                                        0.41194096,
                                        0.41528395,
                                        0.41504443],
                             'mae': [0.01009861,
                                     0.011264267,
                                     0.011006427,
                                     0.009674212,
                                     0.010882466,
                                     0.010445912,
                                     0.010335502,
                                     0.011424734,
                                     0.011473236,
                                     0.010364133,
                                     0.01109936],
                             'max_mae': 0.011473236,
                             'max_mse': 0.0004172393,
                             'max_rmse': 0.020426435,
                             'median_distance': 1.6204014,
                             'median_mae': 0.010882466,
                             'min_cosine': 0.32434234,
                             'mse': [0.00021133652,
                                     0.0004172393,
                                     0.00025801428,
                                     0.00021881511,
                                     0.00035218854,
                                     0.00022572067,
                                     0.00024377347,
                                     0.0002727186,
                                     0.00030548382,
                                     0.00026257004,
                                     0.00028529076],
                             'rmse': [0.014537418,
                                      0.020426435,
                                      0.016062822,
                                      0.0147924,
                                      0.018766686,
                                      0.015024003,
                                      0.015613247,
                                      0.016514193,
                                      0.017478095,
                                      0.016204013,
                                      0.016890552]},
 'residuals': {'mae': 0.010733532719314098,
               'mse': 0.0002775592147372663,
               'psnr': 17.62295150756836,
               'rmse': 0.016660109162330627,
               'ssds': [36.911907, 6.8829393],
               'ssim': 0.3623639643192291},
 'spectra_pcagan': {'cosine': [0.7657288,
                               0.97621846,
                               0.97843003,
                               0.9837773,
                               0.9793712,
                               0.9774632,
                               0.98179543,
                               0.9821967,
                               0.98802125,
                               0.99348027,
                               0.9910392],
                    'mae': [0.12486847,
                            0.033226416,
                            0.028517993,
                            0.023378562,
                            0.026074268,
                            0.027883997,
                            0.02634557,
                            0.027410962,
                            0.025125979,
                            0.021081988,
                            0.023320261],
                    'max_mae': 0.12486847,
                    'max_mse': 0.016987758,
                    'max_rmse': 0.13033709,
                    'median_mae': 0.02634557,
                    'min_cosine': 0.7657288,
                    'mse': [0.016987758,
                            0.001909247,
                            0.0012962245,
                            0.0009513361,
                            0.0012551006,
                            0.0012781597,
                            0.0011375013,
                            0.0012833262,
                            0.0010896443,
                            0.0007858926,
                            0.0009645094],
                    'rmse': [0.13033709,
                             0.043694932,
                             0.03600312,
                             0.030843737,
                             0.0354274,
                             0.035751358,
                             0.033726864,
                             0.035823543,
                             0.03300976,
                             0.028033776,
                             0.031056551]},
 'spectra_realgan': {'cosine': [0.7618549,
                                0.9706873,
                                0.97191936,
                                0.9779689,
                                0.9730635,
                                0.9714499,
                                0.97603786,
                                0.97724694,
                                0.9843775,
                                0.9912112,
                                0.9883444],
                     'mae': [0.12479181,
                             0.037240792,
                             0.03284009,
                             0.028147742,
                             0.030848831,
                             0.03196701,
                             0.030468117,
                             0.031198822,
                             0.02940722,
                             0.025330761,
                             0.027495043],
                     'max_mae': 0.12479181,
                     'max_mse': 0.017305966,
                     'max_rmse': 0.13155214,
                     'median_mae': 0.030848831,
                     'min_cosine': 0.7618549,
                     'mse': [0.017305966,
                             0.0023262664,
                             0.0017000866,
                             0.0013076292,
                             0.0016374073,
                             0.0016343235,
                             0.00150781,
                             0.0016232487,
                             0.0014293803,
                             0.0010625175,
                             0.0012531689],
                     'rmse': [0.13155214,
                              0.048231382,
                              0.041232105,
                              0.036161155,
                              0.04046489,
                              0.04042677,
                              0.03883053,
                              0.040289562,
                              0.037807144,
                              0.03259628,
                              0.035400126]},
 'spectra_realpca': {'cosine': [0.99430686,
                                0.99422884,
                                0.9937409,
                                0.99363655,
                                0.9932454,
                                0.9932637,
                                0.99421227,
                                0.99477744,
                                0.9962254,
                                0.997506,
                                0.9969505],
                     'mae': [0.015107133,
                             0.01595706,
                             0.015451248,
                             0.015427372,
                             0.015855666,
                             0.01562611,
                             0.015115393,
                             0.01476729,
                             0.014618671,
                             0.013785816,
                             0.014226775],
                     'max_mae': 0.01595706,
                     'max_mse': 0.00040753008,
                     'max_rmse': 0.020187374,
                     'median_mae': 0.015115393,
                     'min_cosine': 0.9932454,
                     'mse': [0.0003735994,
                             0.00040753008,
                             0.00038187148,
                             0.00038070988,
                             0.0004001576,
                             0.0003898829,
                             0.0003670771,
                             0.00035229436,
                             0.0003430377,
                             0.00030241933,
                             0.00032406152],
                     'rmse': [0.019328719,
                              0.020187374,
                              0.019541532,
                              0.01951179,
                              0.020003939,
                              0.019745452,
                              0.019159256,
                              0.018769506,
                              0.018521277,
                              0.017390208,
                              0.01800171]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_65.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431
Directory path: experiments/inpainting/gann_4_night_20180723_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_65.0/images
Optimal number of principal components:  9
Reconstruction error:  29.069643
Energy conservation:  0.6546106
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_65.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.070708789508587, 3.4540104092405635],
                   'kl_div': 0.22374892,
                   'ks_tests': {10000: KstestResult(statistic=0.167, pvalue=4.144003287490495e-122, statistic_location=0.008664777, statistic_sign=1),
                                20000: KstestResult(statistic=0.1632, pvalue=3.3687014721787106e-233, statistic_location=0.008731676, statistic_sign=1),
                                30000: KstestResult(statistic=0.16469999999999996, pvalue=0.0, statistic_location=0.0103176655, statistic_sign=1),
                                40000: KstestResult(statistic=0.16000000000000003, pvalue=0.0, statistic_location=0.008922714, statistic_sign=1),
                                50000: KstestResult(statistic=0.1656200000000001, pvalue=0.0, statistic_location=0.009943582, statistic_sign=1),
                                60000: KstestResult(statistic=0.16108333333333325, pvalue=0.0, statistic_location=0.009299536, statistic_sign=1),
                                70000: KstestResult(statistic=0.16308571428571428, pvalue=0.0, statistic_location=0.009464534, statistic_sign=1),
                                80000: KstestResult(statistic=0.1626375, pvalue=0.0, statistic_location=0.009291226, statistic_sign=1),
                                90000: KstestResult(statistic=0.1646333333333333, pvalue=0.0, statistic_location=0.0093188975, statistic_sign=1),
                                100000: KstestResult(statistic=0.15949999999999998, pvalue=0.0, statistic_location=0.009357959, statistic_sign=1),
                                110000: KstestResult(statistic=0.16240909090909095, pvalue=0.0, statistic_location=0.00929847, statistic_sign=1),
                                120000: KstestResult(statistic=0.16322500000000006, pvalue=0.0, statistic_location=0.009408741, statistic_sign=1),
                                130000: KstestResult(statistic=0.1642, pvalue=0.0, statistic_location=0.009847813, statistic_sign=1),
                                140000: KstestResult(statistic=0.16145714285714285, pvalue=0.0, statistic_location=0.010400058, statistic_sign=1),
                                150000: KstestResult(statistic=0.16468000000000005, pvalue=0.0, statistic_location=0.009322101, statistic_sign=1),
                                160000: KstestResult(statistic=0.16457500000000003, pvalue=0.0, statistic_location=0.009527987, statistic_sign=1),
                                170000: KstestResult(statistic=0.16121764705882358, pvalue=0.0, statistic_location=0.009564986, statistic_sign=1),
                                180000: KstestResult(statistic=0.1616333333333334, pvalue=0.0, statistic_location=0.009381345, statistic_sign=1),
                                190000: KstestResult(statistic=0.16264210526315792, pvalue=0.0, statistic_location=0.0096881855, statistic_sign=1),
                                200000: KstestResult(statistic=0.16201, pvalue=0.0, statistic_location=0.009319425, statistic_sign=1),
                                210000: KstestResult(statistic=0.16111428571428565, pvalue=0.0, statistic_location=0.009322101, statistic_sign=1),
                                220000: KstestResult(statistic=0.16350909090909094, pvalue=0.0, statistic_location=0.009382491, statistic_sign=1)},
                   'moments': {'mean_error': 0.17387097,
                               'means': [0.0011001013, 8.149116e-05],
                               'stds': [0.017806092, 0.007667395],
                               'variance_ratio': 4.697821}},
 'originals': {'gan': {'mae': 0.03807393088936806,
                       'mse': 0.002808306599035859,
                       'psnr': 27.170913696289062,
                       'rmse': 0.05299345776438713,
                       'ssim': 0.6384762525558472},
               'pca': {'mae': 0.014479827135801315,
                       'mse': 0.0003426037437748164,
                       'psnr': 36.458866119384766,
                       'rmse': 0.018509557470679283,
                       'ssim': 0.9300979971885681}},
 'reconstructions': {'mae': 0.03414088115096092,
                     'mse': 0.002466152422130108,
                     'psnr': 27.88658332824707,
                     'rmse': 0.049660369753837585,
                     'ssim': 0.6710777282714844},
 'residual_spectra_pcagan': {'cosine': [0.5072842,
                                        0.39190856,
                                        0.335675,
                                        0.4338081,
                                        0.40147084,
                                        0.4016591,
                                        0.42163956,
                                        0.4974308,
                                        0.49009866,
                                        0.4562055,
                                        0.4367842,
                                        0.47184885,
                                        0.47344786,
                                        0.49100655,
                                        0.43818524,
                                        0.4192251,
                                        0.43732688,
                                        0.43886942,
                                        0.33485043,
                                        0.3703219,
                                        0.30388397,
                                        0.433464],
                             'mae': [0.008532858,
                                     0.009434311,
                                     0.010691881,
                                     0.00965251,
                                     0.010669133,
                                     0.011315709,
                                     0.0097975945,
                                     0.008755214,
                                     0.009314838,
                                     0.010093071,
                                     0.011204354,
                                     0.010682776,
                                     0.010506163,
                                     0.010327301,
                                     0.010584327,
                                     0.011002529,
                                     0.011086242,
                                     0.012493667,
                                     0.012524113,
                                     0.011681818,
                                     0.011850115,
                                     0.010296822],
                             'max_mae': 0.012524113,
                             'max_mse': 0.00044381866,
                             'max_rmse': 0.021067005,
                             'median_distance': 1.5994238,
                             'median_mae': 0.01062673,
                             'min_cosine': 0.30388397,
                             'mse': [0.00016309954,
                                     0.00026225392,
                                     0.00038318668,
                                     0.00020412002,
                                     0.0002769428,
                                     0.00033335004,
                                     0.00023928116,
                                     0.0001746855,
                                     0.00017523057,
                                     0.00021507872,
                                     0.00026704223,
                                     0.00023048974,
                                     0.00021189332,
                                     0.00022591325,
                                     0.00027153295,
                                     0.00030761256,
                                     0.00025175977,
                                     0.00031077847,
                                     0.00033021468,
                                     0.000259904,
                                     0.00044381866,
                                     0.00022244068],
                             'rmse': [0.012771043,
                                      0.016194256,
                                      0.019575154,
                                      0.014287057,
                                      0.016641598,
                                      0.018257877,
                                      0.015468716,
                                      0.013216864,
                                      0.013237468,
                                      0.014665563,
                                      0.016341427,
                                      0.015181889,
                                      0.014556556,
                                      0.015030411,
                                      0.016478257,
                                      0.017538887,
                                      0.015866939,
                                      0.01762891,
                                      0.01817181,
                                      0.016121538,
                                      0.021067005,
                                      0.014914446]},
 'residuals': {'mae': 0.010568059980869293,
               'mse': 0.00026184681337326765,
               'psnr': 17.87603759765625,
               'rmse': 0.01618168130517006,
               'ssds': [70.01845, 12.934974],
               'ssim': 0.4053768515586853},
 'spectra_pcagan': {'cosine': [0.9887081,
                               0.99013615,
                               0.9777807,
                               0.98933965,
                               0.98078686,
                               0.7844259,
                               0.98097986,
                               0.985256,
                               0.9832064,
                               0.98149127,
                               0.9735941,
                               0.98332363,
                               0.9833048,
                               0.9903286,
                               0.99244386,
                               0.99120444,
                               0.9928055,
                               0.99350035,
                               0.9940896,
                               0.9464677,
                               0.99377,
                               0.9962095],
                    'mae': [0.02620675,
                            0.027475463,
                            0.027344583,
                            0.027712073,
                            0.02947273,
                            0.12320572,
                            0.027513122,
                            0.022381624,
                            0.02405617,
                            0.02514253,
                            0.032061763,
                            0.0273455,
                            0.027698407,
                            0.02259801,
                            0.0221808,
                            0.028530814,
                            0.02313147,
                            0.024017904,
                            0.026624717,
                            0.113051735,
                            0.022485863,
                            0.020861652],
                    'max_mae': 0.12320572,
                    'max_mse': 0.016922234,
                    'max_rmse': 0.13008548,
                    'median_mae': 0.02698465,
                    'min_cosine': 0.7844259,
                    'mse': [0.0011469144,
                            0.0014904737,
                            0.0014148373,
                            0.0013287051,
                            0.0014580274,
                            0.016922234,
                            0.0013546472,
                            0.00088557036,
                            0.0010122454,
                            0.0010761875,
                            0.0016979725,
                            0.0012083409,
                            0.0012472153,
                            0.0008818047,
                            0.0009244335,
                            0.0013468493,
                            0.0009005182,
                            0.0009961083,
                            0.001242307,
                            0.013969913,
                            0.0010234542,
                            0.0007265914],
                    'rmse': [0.033866126,
                             0.038606655,
                             0.037614323,
                             0.036451407,
                             0.038184125,
                             0.13008548,
                             0.036805533,
                             0.029758533,
                             0.031815805,
                             0.032805298,
                             0.04120646,
                             0.034761198,
                             0.035315935,
                             0.029695196,
                             0.030404499,
                             0.036699444,
                             0.030008636,
                             0.031561185,
                             0.035246376,
                             0.11819439,
                             0.03199147,
                             0.026955359]},
 'spectra_realgan': {'cosine': [0.9842341,
                                0.98722214,
                                0.9718723,
                                0.98599064,
                                0.9752126,
                                0.7805495,
                                0.9755326,
                                0.979312,
                                0.97710043,
                                0.9751803,
                                0.96691114,
                                0.9775232,
                                0.97858834,
                                0.98636526,
                                0.98984134,
                                0.9881802,
                                0.99052626,
                                0.99138385,
                                0.9933155,
                                0.94527197,
                                0.9923382,
                                0.99505055],
                     'mae': [0.031438828,
                             0.033346362,
                             0.032219566,
                             0.032822162,
                             0.034172878,
                             0.12316289,
                             0.03240075,
                             0.027343579,
                             0.028824527,
                             0.030065674,
                             0.035885293,
                             0.031580657,
                             0.031070365,
                             0.027461423,
                             0.026668292,
                             0.031906247,
                             0.027129754,
                             0.028450506,
                             0.02842469,
                             0.11329332,
                             0.02588984,
                             0.024068888],
                     'max_mae': 0.12316289,
                     'max_mse': 0.01723906,
                     'max_rmse': 0.1312976,
                     'median_mae': 0.031254597,
                     'min_cosine': 0.7805495,
                     'mse': [0.0016155901,
                             0.0019649966,
                             0.0018077183,
                             0.0017646485,
                             0.0018779804,
                             0.01723906,
                             0.0017564485,
                             0.0012537389,
                             0.0013840853,
                             0.0014574648,
                             0.0020964507,
                             0.0015846726,
                             0.0015702677,
                             0.001245576,
                             0.0012404403,
                             0.0016638191,
                             0.0011866192,
                             0.001319843,
                             0.0013785671,
                             0.014190843,
                             0.0012403481,
                             0.0009435627],
                     'rmse': [0.040194403,
                              0.044328284,
                              0.04251727,
                              0.04200772,
                              0.043335672,
                              0.1312976,
                              0.041910004,
                              0.035408176,
                              0.037203297,
                              0.038176756,
                              0.045787014,
                              0.039807945,
                              0.039626602,
                              0.03529272,
                              0.035219885,
                              0.04078994,
                              0.03444734,
                              0.036329642,
                              0.03712906,
                              0.11912533,
                              0.035218578,
                              0.030717466]},
 'spectra_realpca': {'cosine': [0.9957171,
                                0.99688226,
                                0.9938373,
                                0.99650854,
                                0.9944086,
                                0.99430686,
                                0.99422884,
                                0.9937409,
                                0.99363655,
                                0.9932454,
                                0.9932637,
                                0.99421227,
                                0.99477744,
                                0.9962254,
                                0.997506,
                                0.9969505,
                                0.99745697,
                                0.99803895,
                                0.99912304,
                                0.99903554,
                                0.9985622,
                                0.99893314],
                     'mae': [0.016415805,
                             0.017069383,
                             0.015733832,
                             0.016533485,
                             0.016020432,
                             0.015107133,
                             0.01595706,
                             0.015451248,
                             0.015427372,
                             0.015855666,
                             0.01562611,
                             0.015115393,
                             0.01476729,
                             0.014618671,
                             0.013785816,
                             0.014226775,
                             0.014020894,
                             0.01363657,
                             0.010140877,
                             0.010215229,
                             0.011849044,
                             0.01098208],
                     'max_mae': 0.017069383,
                     'max_mse': 0.00046845918,
                     'max_rmse': 0.021643918,
                     'median_mae': 0.015111264,
                     'min_cosine': 0.9932454,
                     'mse': [0.00042958456,
                             0.00046845918,
                             0.00039340983,
                             0.000435175,
                             0.00041360164,
                             0.0003735994,
                             0.00040753008,
                             0.00038187148,
                             0.00038070988,
                             0.0004001576,
                             0.0003898829,
                             0.0003670771,
                             0.00035229436,
                             0.0003430377,
                             0.00030241933,
                             0.00032406152,
                             0.00031782503,
                             0.00030147404,
                             0.00016500351,
                             0.00017129481,
                             0.00022603733,
                             0.00019277607],
                     'rmse': [0.020726422,
                              0.021643918,
                              0.019834561,
                              0.020860849,
                              0.020337198,
                              0.019328719,
                              0.020187374,
                              0.019541532,
                              0.01951179,
                              0.020003939,
                              0.019745452,
                              0.019159256,
                              0.018769506,
                              0.018521277,
                              0.017390208,
                              0.01800171,
                              0.017827649,
                              0.017363008,
                              0.012845369,
                              0.013087965,
                              0.015034538,
                              0.013884382]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_65.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707
Directory path: experiments/inpainting/gann_4_night_20180723_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_65.0/images
Optimal number of principal components:  9
Reconstruction error:  29.069643
Energy conservation:  0.6546106
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_65.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.060522481510419, 3.4539063797123126],
                   'kl_div': 0.21291691,
                   'ks_tests': {10000: KstestResult(statistic=0.143, pvalue=1.5540286405170744e-89, statistic_location=0.010607754, statistic_sign=1),
                                20000: KstestResult(statistic=0.13634999999999997, pvalue=1.2850534668594392e-162, statistic_location=0.010345624, statistic_sign=1),
                                30000: KstestResult(statistic=0.13490000000000002, pvalue=1.5782736971536728e-238, statistic_location=0.011049119, statistic_sign=1),
                                40000: KstestResult(statistic=0.13690000000000002, pvalue=0.0, statistic_location=0.010435667, statistic_sign=1),
                                50000: KstestResult(statistic=0.13996000000000008, pvalue=0.0, statistic_location=0.011021348, statistic_sign=1),
                                60000: KstestResult(statistic=0.1373000000000001, pvalue=0.0, statistic_location=0.0093910415, statistic_sign=1),
                                70000: KstestResult(statistic=0.1378999999999999, pvalue=0.0, statistic_location=0.010643394, statistic_sign=1),
                                80000: KstestResult(statistic=0.13637500000000002, pvalue=0.0, statistic_location=0.010204474, statistic_sign=1),
                                90000: KstestResult(statistic=0.13611111111111118, pvalue=0.0, statistic_location=0.009591776, statistic_sign=1),
                                100000: KstestResult(statistic=0.13742, pvalue=0.0, statistic_location=0.009360238, statistic_sign=1),
                                110000: KstestResult(statistic=0.13694545454545448, pvalue=0.0, statistic_location=0.009945596, statistic_sign=1),
                                120000: KstestResult(statistic=0.13805, pvalue=0.0, statistic_location=0.009340633, statistic_sign=1),
                                130000: KstestResult(statistic=0.137876923076923, pvalue=0.0, statistic_location=0.010310618, statistic_sign=1),
                                140000: KstestResult(statistic=0.13847142857142858, pvalue=0.0, statistic_location=0.009950972, statistic_sign=1),
                                150000: KstestResult(statistic=0.1363066666666667, pvalue=0.0, statistic_location=0.010323567, statistic_sign=1),
                                160000: KstestResult(statistic=0.13721250000000007, pvalue=0.0, statistic_location=0.010027801, statistic_sign=1),
                                170000: KstestResult(statistic=0.13725882352941177, pvalue=0.0, statistic_location=0.009966313, statistic_sign=1),
                                180000: KstestResult(statistic=0.1374333333333333, pvalue=0.0, statistic_location=0.010270268, statistic_sign=1),
                                190000: KstestResult(statistic=0.13709473684210527, pvalue=0.0, statistic_location=0.010274201, statistic_sign=1),
                                200000: KstestResult(statistic=0.13573000000000002, pvalue=0.0, statistic_location=0.010007407, statistic_sign=1),
                                210000: KstestResult(statistic=0.13664761904761902, pvalue=0.0, statistic_location=0.009338907, statistic_sign=1),
                                220000: KstestResult(statistic=0.13578181818181811, pvalue=0.0, statistic_location=0.009624037, statistic_sign=1),
                                230000: KstestResult(statistic=0.13699565217391307, pvalue=0.0, statistic_location=0.010052631, statistic_sign=1),
                                240000: KstestResult(statistic=0.13723333333333332, pvalue=0.0, statistic_location=0.009572778, statistic_sign=1),
                                250000: KstestResult(statistic=0.13666, pvalue=0.0, statistic_location=0.010267274, statistic_sign=1),
                                260000: KstestResult(statistic=0.13782692307692312, pvalue=0.0, statistic_location=0.010016251, statistic_sign=1),
                                270000: KstestResult(statistic=0.13533703703703703, pvalue=0.0, statistic_location=0.009572584, statistic_sign=1),
                                280000: KstestResult(statistic=0.137575, pvalue=0.0, statistic_location=0.01004649, statistic_sign=1),
                                290000: KstestResult(statistic=0.1379137931034483, pvalue=0.0, statistic_location=0.010264229, statistic_sign=1),
                                300000: KstestResult(statistic=0.13644, pvalue=0.0, statistic_location=0.010050636, statistic_sign=1),
                                310000: KstestResult(statistic=0.1364612903225807, pvalue=0.0, statistic_location=0.009324707, statistic_sign=1),
                                320000: KstestResult(statistic=0.137384375, pvalue=0.0, statistic_location=0.010191892, statistic_sign=1),
                                330000: KstestResult(statistic=0.13652121212121215, pvalue=0.0, statistic_location=0.009695595, statistic_sign=1)},
                   'moments': {'mean_error': 0.0304986,
                               'means': [4.6829733e-05, 4.403979e-05],
                               'stds': [0.017160652, 0.007665435],
                               'variance_ratio': 4.4676547}},
 'originals': {'gan': {'mae': 0.03633112460374832,
                       'mse': 0.0025016937870532274,
                       'psnr': 28.30494499206543,
                       'rmse': 0.05001693591475487,
                       'ssim': 0.6518860459327698},
               'pca': {'mae': 0.014658764936029911,
                       'mse': 0.00035051055601798,
                       'psnr': 37.134864807128906,
                       'rmse': 0.01872192695736885,
                       'ssim': 0.9441266655921936}},
 'reconstructions': {'mae': 0.03240419179201126,
                     'mse': 0.002157372422516346,
                     'psnr': 29.24262237548828,
                     'rmse': 0.046447522938251495,
                     'ssim': 0.6734811067581177},
 'residual_spectra_pcagan': {'cosine': [0.46149343,
                                        0.4278678,
                                        0.4482231,
                                        0.37117815,
                                        0.47593,
                                        0.35643688,
                                        0.39605173,
                                        0.35862026,
                                        0.42083234,
                                        0.41962355,
                                        0.37830764,
                                        0.49183795,
                                        0.3538174,
                                        0.4666104,
                                        0.47756213,
                                        0.4222347,
                                        0.48329797,
                                        0.49239,
                                        0.45394298,
                                        0.44920045,
                                        0.461021,
                                        0.43243727,
                                        0.4512147,
                                        0.44045404,
                                        0.32804626,
                                        0.38025054,
                                        0.40232435,
                                        0.36865032,
                                        0.5032265,
                                        0.5059814,
                                        0.530364,
                                        0.46241516,
                                        0.41084766],
                             'mae': [0.009219428,
                                     0.009809652,
                                     0.009045218,
                                     0.010063326,
                                     0.008984164,
                                     0.01022181,
                                     0.00978993,
                                     0.010338131,
                                     0.0096226055,
                                     0.009999507,
                                     0.01071912,
                                     0.009878287,
                                     0.010905754,
                                     0.010434854,
                                     0.00915948,
                                     0.010257394,
                                     0.00982875,
                                     0.009774506,
                                     0.010744683,
                                     0.010963354,
                                     0.009825468,
                                     0.010772312,
                                     0.0101219835,
                                     0.011885907,
                                     0.012103633,
                                     0.01108874,
                                     0.0121538155,
                                     0.012195278,
                                     0.009462744,
                                     0.0096836975,
                                     0.008843166,
                                     0.009823163,
                                     0.010939213],
                             'max_mae': 0.012195278,
                             'max_mse': 0.000344633,
                             'max_rmse': 0.018564293,
                             'median_distance': 1.5450457,
                             'median_mae': 0.010063326,
                             'min_cosine': 0.32804626,
                             'mse': [0.00018698843,
                                     0.00022700071,
                                     0.00019159104,
                                     0.00030714378,
                                     0.00017529711,
                                     0.0003014574,
                                     0.000249886,
                                     0.00029608907,
                                     0.00023871663,
                                     0.00021651063,
                                     0.00029881258,
                                     0.00020849888,
                                     0.000344633,
                                     0.00021759252,
                                     0.00018051246,
                                     0.00027087223,
                                     0.00018780844,
                                     0.00019846339,
                                     0.0002455615,
                                     0.0002543324,
                                     0.00021246047,
                                     0.00026666024,
                                     0.0002531228,
                                     0.0002788117,
                                     0.00028002376,
                                     0.00022874164,
                                     0.00028167313,
                                     0.00030129086,
                                     0.00018818038,
                                     0.00018699137,
                                     0.00017314,
                                     0.00019882346,
                                     0.0002761493],
                             'rmse': [0.013674371,
                                      0.015066543,
                                      0.013841641,
                                      0.017525518,
                                      0.013239982,
                                      0.017362528,
                                      0.015807783,
                                      0.017207239,
                                      0.015450457,
                                      0.0147143,
                                      0.017286196,
                                      0.014439491,
                                      0.018564293,
                                      0.014751017,
                                      0.013435492,
                                      0.016458197,
                                      0.013704322,
                                      0.014087703,
                                      0.015670402,
                                      0.015947802,
                                      0.014576023,
                                      0.016329736,
                                      0.015909834,
                                      0.016697656,
                                      0.01673391,
                                      0.015124207,
                                      0.01678312,
                                      0.017357731,
                                      0.013717885,
                                      0.013674479,
                                      0.013158267,
                                      0.014100477,
                                      0.016617741]},
 'residuals': {'mae': 0.01026239525526762,
               'mse': 0.00024011630739551038,
               'psnr': 18.252290725708008,
               'rmse': 0.015495686791837215,
               'ssds': [97.18146, 19.391014],
               'ssim': 0.3985535800457001},
 'spectra_pcagan': {'cosine': [0.98909444,
                               0.98668957,
                               0.98947567,
                               0.9887927,
                               0.98810226,
                               0.99204344,
                               0.9858329,
                               0.9881136,
                               0.9771673,
                               0.98735476,
                               0.9755268,
                               0.7659058,
                               0.9764127,
                               0.97820127,
                               0.98371476,
                               0.9791421,
                               0.9772043,
                               0.9822243,
                               0.9824016,
                               0.98788345,
                               0.9931268,
                               0.9911771,
                               0.99382997,
                               0.99330264,
                               0.9944919,
                               0.9388556,
                               0.99330944,
                               0.9938291,
                               0.99658215,
                               0.9952694,
                               0.9938505,
                               0.99469995,
                               0.99499214],
                    'mae': [0.02527735,
                            0.025659261,
                            0.024626875,
                            0.026035247,
                            0.0333071,
                            0.035313606,
                            0.028472226,
                            0.030672891,
                            0.029450018,
                            0.032804523,
                            0.032647286,
                            0.1250511,
                            0.03315042,
                            0.02870227,
                            0.023414666,
                            0.026289709,
                            0.028013788,
                            0.02600881,
                            0.027317736,
                            0.025308605,
                            0.021619458,
                            0.02331099,
                            0.024986789,
                            0.025733564,
                            0.026278589,
                            0.11863606,
                            0.025281206,
                            0.02805101,
                            0.01894995,
                            0.021805484,
                            0.024518715,
                            0.021366922,
                            0.021275982],
                    'max_mae': 0.1250511,
                    'max_mse': 0.017046224,
                    'max_rmse': 0.13056119,
                    'median_mae': 0.026035247,
                    'min_cosine': 0.7659058,
                    'mse': [0.0011718872,
                            0.0012251346,
                            0.0011113522,
                            0.0013488017,
                            0.0017226558,
                            0.0023384364,
                            0.0014265848,
                            0.001825761,
                            0.0014461535,
                            0.0017971278,
                            0.0017974706,
                            0.017046224,
                            0.0018910408,
                            0.0013099808,
                            0.0009548993,
                            0.0012652916,
                            0.0012926324,
                            0.0011104343,
                            0.0012680624,
                            0.0011031765,
                            0.0008281075,
                            0.00095049775,
                            0.0011172366,
                            0.0010822598,
                            0.0012042408,
                            0.015263641,
                            0.0010509575,
                            0.0012576549,
                            0.00061868667,
                            0.0007926364,
                            0.0009820455,
                            0.00075857434,
                            0.0008336464],
                    'rmse': [0.034232836,
                             0.035001922,
                             0.03333695,
                             0.036726035,
                             0.04150489,
                             0.048357382,
                             0.037770156,
                             0.042728927,
                             0.038028326,
                             0.042392544,
                             0.042396586,
                             0.13056119,
                             0.0434861,
                             0.036193658,
                             0.030901445,
                             0.03557094,
                             0.035953198,
                             0.03332318,
                             0.035609864,
                             0.0332141,
                             0.028776858,
                             0.030830143,
                             0.03342509,
                             0.03289772,
                             0.034702174,
                             0.12354611,
                             0.032418475,
                             0.03546343,
                             0.024873413,
                             0.0281538,
                             0.031337608,
                             0.027542228,
                             0.028872935]},
 'spectra_realgan': {'cosine': [0.9853655,
                                0.9825895,
                                0.9856512,
                                0.9851382,
                                0.98433524,
                                0.9903146,
                                0.9818151,
                                0.9852888,
                                0.97053623,
                                0.9841304,
                                0.9703619,
                                0.7620184,
                                0.97087747,
                                0.9717237,
                                0.9779597,
                                0.9728207,
                                0.97121495,
                                0.97639906,
                                0.9774019,
                                0.9841939,
                                0.9908711,
                                0.98849744,
                                0.9913617,
                                0.9913589,
                                0.9938137,
                                0.9378814,
                                0.9917552,
                                0.99264306,
                                0.9952013,
                                0.9935058,
                                0.991337,
                                0.99308497,
                                0.99356794],
                     'mae': [0.030528931,
                             0.030789133,
                             0.030057438,
                             0.0313532,
                             0.037730757,
                             0.040092714,
                             0.03313761,
                             0.03589111,
                             0.03424512,
                             0.037178863,
                             0.036713164,
                             0.12497639,
                             0.03719679,
                             0.032987278,
                             0.028166208,
                             0.031042304,
                             0.03204956,
                             0.030238718,
                             0.031104187,
                             0.029622614,
                             0.025743894,
                             0.027453182,
                             0.028593924,
                             0.029359335,
                             0.027914137,
                             0.11886857,
                             0.028401194,
                             0.03043465,
                             0.02315179,
                             0.025681837,
                             0.028437365,
                             0.024687903,
                             0.02509715],
                     'max_mae': 0.12497639,
                     'max_mse': 0.01736557,
                     'max_rmse': 0.13177848,
                     'median_mae': 0.030528931,
                     'min_cosine': 0.7620184,
                     'mse': [0.0015798567,
                             0.0016176342,
                             0.0015265109,
                             0.0017766396,
                             0.0022200458,
                             0.002838482,
                             0.0018545154,
                             0.0022983176,
                             0.0018826771,
                             0.0022362096,
                             0.0021920276,
                             0.01736557,
                             0.0023081156,
                             0.0017119673,
                             0.001308172,
                             0.001648427,
                             0.0016475238,
                             0.001484801,
                             0.0016114113,
                             0.0014470918,
                             0.0011032401,
                             0.0012374116,
                             0.0014110737,
                             0.0013871462,
                             0.0013196722,
                             0.01545784,
                             0.0012947549,
                             0.0014866724,
                             0.00087773293,
                             0.0010611283,
                             0.0012999047,
                             0.0009887973,
                             0.0010745244],
                     'rmse': [0.039747413,
                              0.040219825,
                              0.039070588,
                              0.042150203,
                              0.04711736,
                              0.053277407,
                              0.043064084,
                              0.047940772,
                              0.043389827,
                              0.047288578,
                              0.046819095,
                              0.13177848,
                              0.048042852,
                              0.041375928,
                              0.03616866,
                              0.040600825,
                              0.0405897,
                              0.038533114,
                              0.040142387,
                              0.03804066,
                              0.033215057,
                              0.035176862,
                              0.037564263,
                              0.037244413,
                              0.03632729,
                              0.12432956,
                              0.035982702,
                              0.03855739,
                              0.029626558,
                              0.032574967,
                              0.03605419,
                              0.031445146,
                              0.03277994]},
 'spectra_realpca': {'cosine': [0.99596983,
                                0.9955872,
                                0.995943,
                                0.99619496,
                                0.99629,
                                0.9981127,
                                0.9957171,
                                0.99688226,
                                0.9938373,
                                0.99650854,
                                0.9944086,
                                0.99430686,
                                0.99422884,
                                0.9937409,
                                0.99363655,
                                0.9932454,
                                0.9932637,
                                0.99421227,
                                0.99477744,
                                0.9962254,
                                0.997506,
                                0.9969505,
                                0.99745697,
                                0.99803895,
                                0.99912304,
                                0.99903554,
                                0.9985622,
                                0.99893314,
                                0.9985994,
                                0.9980584,
                                0.9973595,
                                0.99821347,
                                0.99832475],
                     'mae': [0.016229892,
                             0.015987454,
                             0.01651866,
                             0.016630169,
                             0.016504273,
                             0.017479002,
                             0.016415805,
                             0.017069383,
                             0.015733832,
                             0.016533485,
                             0.016020432,
                             0.015107133,
                             0.01595706,
                             0.015451248,
                             0.015427372,
                             0.015855666,
                             0.01562611,
                             0.015115393,
                             0.01476729,
                             0.014618671,
                             0.013785816,
                             0.014226775,
                             0.014020894,
                             0.01363657,
                             0.010140877,
                             0.010215229,
                             0.011849044,
                             0.01098208,
                             0.012596618,
                             0.013300142,
                             0.014192306,
                             0.012505498,
                             0.013239081],
                     'max_mae': 0.017479002,
                     'max_mse': 0.0004873001,
                     'max_rmse': 0.022074874,
                     'median_mae': 0.015115393,
                     'min_cosine': 0.9932454,
                     'mse': [0.00042204862,
                             0.00040944476,
                             0.00043303252,
                             0.0004427132,
                             0.00043892823,
                             0.0004873001,
                             0.00042958456,
                             0.00046845918,
                             0.00039340983,
                             0.000435175,
                             0.00041360164,
                             0.0003735994,
                             0.00040753008,
                             0.00038187148,
                             0.00038070988,
                             0.0004001576,
                             0.0003898829,
                             0.0003670771,
                             0.00035229436,
                             0.0003430377,
                             0.00030241933,
                             0.00032406152,
                             0.00031782503,
                             0.00030147404,
                             0.00016500351,
                             0.00017129481,
                             0.00022603733,
                             0.00019277607,
                             0.00025626319,
                             0.00028326284,
                             0.00032213266,
                             0.000253939,
                             0.00028050097],
                     'rmse': [0.020543821,
                              0.020234741,
                              0.020809432,
                              0.02104075,
                              0.020950614,
                              0.022074874,
                              0.020726422,
                              0.021643918,
                              0.019834561,
                              0.020860849,
                              0.020337198,
                              0.019328719,
                              0.020187374,
                              0.019541532,
                              0.01951179,
                              0.020003939,
                              0.019745452,
                              0.019159256,
                              0.018769506,
                              0.018521277,
                              0.017390208,
                              0.01800171,
                              0.017827649,
                              0.017363008,
                              0.012845369,
                              0.013087965,
                              0.015034538,
                              0.013884382,
                              0.016008222,
                              0.016830415,
                              0.017948054,
                              0.015935464,
                              0.016748164]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_65.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529
Directory path: experiments/inpainting/gann_4_night_20180901_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_65.0/images
Optimal number of principal components:  22
Reconstruction error:  11.35417
Energy conservation:  0.6581386
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_65.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.932551248322828, 2.783912558753107],
                   'kl_div': 0.6128165,
                   'ks_tests': {10000: KstestResult(statistic=0.2231, pvalue=2.0805554491073277e-218, statistic_location=-0.0041650003, statistic_sign=-1),
                                20000: KstestResult(statistic=0.22995000000000002, pvalue=0.0, statistic_location=-0.0040275957, statistic_sign=-1),
                                30000: KstestResult(statistic=0.22673333333333334, pvalue=0.0, statistic_location=0.0037209792, statistic_sign=1),
                                40000: KstestResult(statistic=0.22652499999999998, pvalue=0.0, statistic_location=0.0039627324, statistic_sign=1),
                                50000: KstestResult(statistic=0.22722000000000003, pvalue=0.0, statistic_location=-0.0046557393, statistic_sign=-1),
                                60000: KstestResult(statistic=0.22843333333333335, pvalue=0.0, statistic_location=-0.004521255, statistic_sign=-1),
                                70000: KstestResult(statistic=0.22842857142857143, pvalue=0.0, statistic_location=-0.0042809844, statistic_sign=-1),
                                80000: KstestResult(statistic=0.226425, pvalue=0.0, statistic_location=0.004330819, statistic_sign=1),
                                90000: KstestResult(statistic=0.22416666666666668, pvalue=0.0, statistic_location=-0.0037474302, statistic_sign=-1),
                                100000: KstestResult(statistic=0.22659000000000007, pvalue=0.0, statistic_location=0.0040539643, statistic_sign=1),
                                110000: KstestResult(statistic=0.22583636363636372, pvalue=0.0, statistic_location=0.0040592947, statistic_sign=1)},
                   'moments': {'mean_error': 0.1995605,
                               'means': [0.0006159432, -5.780816e-06],
                               'stds': [0.023046242, 0.00444988],
                               'variance_ratio': 25.250298}},
 'originals': {'gan': {'mae': 0.10246788710355759,
                       'mse': 0.08953791111707687,
                       'psnr': 15.509013175964355,
                       'rmse': 0.29922884702682495,
                       'ssim': 0.8870316743850708},
               'pca': {'mae': 0.005126635078340769,
                       'mse': 5.973053339403123e-05,
                       'psnr': 47.54316711425781,
                       'rmse': 0.007728552911430597,
                       'ssim': 0.9937455058097839}},
 'reconstructions': {'mae': 0.10132039338350296,
                     'mse': 0.0894848182797432,
                     'psnr': 15.787637710571289,
                     'rmse': 0.2991401255130768,
                     'ssim': 0.8918135166168213},
 'residual_spectra_pcagan': {'cosine': [0.08077944,
                                        0.29214966,
                                        0.36993167,
                                        0.3489302,
                                        0.108198665,
                                        0.3657427,
                                        0.37334216,
                                        0.15456165,
                                        0.34785298,
                                        0.10989801,
                                        0.024997326],
                             'mae': [0.011382481,
                                     0.010940916,
                                     0.008885577,
                                     0.0101271365,
                                     0.01108885,
                                     0.008248968,
                                     0.009140355,
                                     0.010664234,
                                     0.008986239,
                                     0.010007451,
                                     0.0252169],
                             'max_mae': 0.0252169,
                             'max_mse': 0.003103816,
                             'max_rmse': 0.055711903,
                             'median_distance': 1.5536187,
                             'median_mae': 0.0101271365,
                             'min_cosine': 0.024997326,
                             'mse': [0.00028148433,
                                     0.00041788912,
                                     0.00021726465,
                                     0.0002451236,
                                     0.00033631406,
                                     0.00018128598,
                                     0.00017679197,
                                     0.00024137307,
                                     0.00022458854,
                                     0.00021171916,
                                     0.003103816],
                             'rmse': [0.016777495,
                                      0.020442337,
                                      0.0147399,
                                      0.015656425,
                                      0.018338867,
                                      0.013464249,
                                      0.0132963145,
                                      0.015536185,
                                      0.0149862785,
                                      0.014550572,
                                      0.055711903]},
 'residuals': {'mae': 0.011335373856127262,
               'mse': 0.0005125136813148856,
               'psnr': 10.532666206359863,
               'rmse': 0.02263876423239708,
               'ssds': [58.465424, 2.1781416],
               'ssim': 0.6261726021766663},
 'spectra_pcagan': {'cosine': [0.9990775,
                               0.9942774,
                               0.9965603,
                               0.9982474,
                               0.9987771,
                               0.99738497,
                               0.9977711,
                               0.99858654,
                               0.9979046,
                               0.9988607,
                               -0.64520854],
                    'mae': [0.015019647,
                            0.020370036,
                            0.017197175,
                            0.017082147,
                            0.014532675,
                            0.013560632,
                            0.015027124,
                            0.015267221,
                            0.013988794,
                            0.014035751,
                            0.95844316],
                    'max_mae': 0.95844316,
                    'max_mse': 0.98016924,
                    'max_rmse': 0.99003494,
                    'median_mae': 0.015027124,
                    'min_cosine': -0.64520854,
                    'mse': [0.0003782025,
                            0.0006800393,
                            0.0004926227,
                            0.00048459577,
                            0.0003681075,
                            0.00034208418,
                            0.00036601117,
                            0.00037573808,
                            0.0003506893,
                            0.00032564116,
                            0.98016924],
                    'rmse': [0.01944743,
                             0.026077563,
                             0.022195106,
                             0.022013536,
                             0.019186128,
                             0.018495519,
                             0.019131418,
                             0.019383965,
                             0.0187267,
                             0.01804553,
                             0.99003494]},
 'spectra_realgan': {'cosine': [0.99906915,
                                0.9933958,
                                0.99578017,
                                0.9978164,
                                0.9987539,
                                0.99656457,
                                0.9971878,
                                0.99853414,
                                0.99725324,
                                0.9988347,
                                -0.6451682],
                     'mae': [0.015093413,
                             0.021834007,
                             0.018909004,
                             0.01878682,
                             0.014685913,
                             0.016091838,
                             0.017106565,
                             0.015522933,
                             0.016487284,
                             0.014210428,
                             0.95841867],
                     'max_mae': 0.95841867,
                     'max_mse': 0.98011833,
                     'max_rmse': 0.99000925,
                     'median_mae': 0.016487284,
                     'min_cosine': -0.6451682,
                     'mse': [0.00038180794,
                             0.0007860678,
                             0.00059797306,
                             0.00057443464,
                             0.00037425736,
                             0.00044651533,
                             0.00046026468,
                             0.00038939103,
                             0.0004553615,
                             0.00033263222,
                             0.98011833],
                     'rmse': [0.019539906,
                              0.0280369,
                              0.024453487,
                              0.023967367,
                              0.019345732,
                              0.02113091,
                              0.02145378,
                              0.019732993,
                              0.0213392,
                              0.018238207,
                              0.99000925]},
 'spectra_realpca': {'cosine': [0.9999939,
                                0.999008,
                                0.9991892,
                                0.99958414,
                                0.9999871,
                                0.99908394,
                                0.9993856,
                                0.9999583,
                                0.9993689,
                                0.99997663,
                                0.9999973],
                     'mae': [0.0011868685,
                             0.008560578,
                             0.008262262,
                             0.007285279,
                             0.0015449405,
                             0.008497308,
                             0.0077835596,
                             0.0026333116,
                             0.007965106,
                             0.0020307025,
                             0.0006430705],
                     'max_mae': 0.008560578,
                     'max_mse': 0.00011807036,
                     'max_rmse': 0.010866019,
                     'median_mae': 0.007285279,
                     'min_cosine': 0.999008,
                     'mse': [2.2795273e-06,
                             0.00011807036,
                             0.000110420144,
                             8.556213e-05,
                             3.810519e-06,
                             0.000117135416,
                             9.886121e-05,
                             1.1164935e-05,
                             0.00010240304,
                             6.6572466e-06,
                             6.713425e-07],
                     'rmse': [0.0015098103,
                              0.010866019,
                              0.010508099,
                              0.009249981,
                              0.001952055,
                              0.010822912,
                              0.009942898,
                              0.0033413973,
                              0.010119439,
                              0.002580164,
                              0.0008193549]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_65.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319
Directory path: experiments/inpainting/gann_4_night_20180901_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_65.0/images
Optimal number of principal components:  22
Reconstruction error:  11.35417
Energy conservation:  0.6581386
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_65.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.940780002103074, 2.815673705251619],
                   'kl_div': 0.5821721,
                   'ks_tests': {10000: KstestResult(statistic=0.2305, pvalue=3.0423665103757145e-233, statistic_location=-0.0043489328, statistic_sign=-1),
                                20000: KstestResult(statistic=0.22535, pvalue=0.0, statistic_location=-0.004566743, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2263666666666667, pvalue=0.0, statistic_location=-0.0044867536, statistic_sign=-1),
                                40000: KstestResult(statistic=0.23052500000000004, pvalue=0.0, statistic_location=-0.004587218, statistic_sign=-1),
                                50000: KstestResult(statistic=0.22786, pvalue=0.0, statistic_location=-0.0046320036, statistic_sign=-1),
                                60000: KstestResult(statistic=0.22843333333333332, pvalue=0.0, statistic_location=-0.004556492, statistic_sign=-1),
                                70000: KstestResult(statistic=0.22678571428571428, pvalue=0.0, statistic_location=-0.004521304, statistic_sign=-1),
                                80000: KstestResult(statistic=0.22745000000000004, pvalue=0.0, statistic_location=-0.004779351, statistic_sign=-1),
                                90000: KstestResult(statistic=0.22804444444444444, pvalue=0.0, statistic_location=-0.0045055803, statistic_sign=-1),
                                100000: KstestResult(statistic=0.22795000000000004, pvalue=0.0, statistic_location=-0.0045969402, statistic_sign=-1),
                                110000: KstestResult(statistic=0.22584545454545457, pvalue=0.0, statistic_location=-0.004497056, statistic_sign=-1),
                                120000: KstestResult(statistic=0.228825, pvalue=0.0, statistic_location=-0.0046152547, statistic_sign=-1),
                                130000: KstestResult(statistic=0.22953076923076926, pvalue=0.0, statistic_location=-0.0046152547, statistic_sign=-1),
                                140000: KstestResult(statistic=0.22670714285714283, pvalue=0.0, statistic_location=-0.004744172, statistic_sign=-1),
                                150000: KstestResult(statistic=0.22907333333333335, pvalue=0.0, statistic_location=-0.004487247, statistic_sign=-1),
                                160000: KstestResult(statistic=0.22838750000000002, pvalue=0.0, statistic_location=-0.004572482, statistic_sign=-1),
                                170000: KstestResult(statistic=0.22827058823529414, pvalue=0.0, statistic_location=-0.004629801, statistic_sign=-1),
                                180000: KstestResult(statistic=0.22989444444444446, pvalue=0.0, statistic_location=-0.004606194, statistic_sign=-1),
                                190000: KstestResult(statistic=0.22797894736842106, pvalue=0.0, statistic_location=-0.004615155, statistic_sign=-1),
                                200000: KstestResult(statistic=0.22858, pvalue=0.0, statistic_location=-0.004615155, statistic_sign=-1),
                                210000: KstestResult(statistic=0.22551428571428572, pvalue=0.0, statistic_location=-0.004562362, statistic_sign=-1),
                                220000: KstestResult(statistic=0.22837272727272728, pvalue=0.0, statistic_location=-0.004628514, statistic_sign=-1)},
                   'moments': {'mean_error': 0.0033839967,
                               'means': [-0.00023313925, -1.6862099e-05],
                               'stds': [0.0203259, 0.0044615837],
                               'variance_ratio': 16.450632}},
 'originals': {'gan': {'mae': 0.0791468694806099,
                       'mse': 0.051039062440395355,
                       'psnr': 18.142791748046875,
                       'rmse': 0.2259182631969452,
                       'ssim': 0.575168788433075},
               'pca': {'mae': 0.006004368886351585,
                       'mse': 8.001997775863856e-05,
                       'psnr': 46.4261589050293,
                       'rmse': 0.008945388719439507,
                       'ssim': 0.9959346652030945}},
 'reconstructions': {'mae': 0.07817130535840988,
                     'mse': 0.0509767085313797,
                     'psnr': 18.384429931640625,
                     'rmse': 0.22578021883964539,
                     'ssim': 0.5773450136184692},
 'residual_spectra_pcagan': {'cosine': [0.34049705,
                                        0.29671532,
                                        0.22679156,
                                        0.25281176,
                                        0.31991905,
                                        0.08441994,
                                        0.30647856,
                                        0.39235136,
                                        0.3710995,
                                        0.114695534,
                                        0.39262283,
                                        0.37797385,
                                        0.16244459,
                                        0.3871153,
                                        0.12480844,
                                        0.022703651,
                                        0.12753628,
                                        0.034763824,
                                        0.06045514,
                                        0.37961486,
                                        0.22449395,
                                        0.3615317],
                             'mae': [0.009654097,
                                     0.010881469,
                                     0.01128157,
                                     0.011049025,
                                     0.009872341,
                                     0.011169325,
                                     0.010507843,
                                     0.00854281,
                                     0.009657998,
                                     0.010461002,
                                     0.007933471,
                                     0.009052483,
                                     0.010124166,
                                     0.0085068485,
                                     0.0094368225,
                                     0.025698047,
                                     0.010452395,
                                     0.01284989,
                                     0.011410944,
                                     0.009806503,
                                     0.011068978,
                                     0.008374206],
                             'max_mae': 0.025698047,
                             'max_mse': 0.0032339704,
                             'max_rmse': 0.05686801,
                             'median_distance': 1.5259498,
                             'median_mae': 0.01028828,
                             'min_cosine': 0.022703651,
                             'mse': [0.00021044808,
                                     0.00034388393,
                                     0.0005412181,
                                     0.0003379861,
                                     0.00028610954,
                                     0.0002698493,
                                     0.00037369135,
                                     0.00018785034,
                                     0.00021364927,
                                     0.0002735641,
                                     0.00015790969,
                                     0.00017343048,
                                     0.00020687906,
                                     0.00018101183,
                                     0.00017382979,
                                     0.0032339704,
                                     0.00021132655,
                                     0.00033315644,
                                     0.0002528816,
                                     0.00020924218,
                                     0.00029854797,
                                     0.00018126336],
                             'rmse': [0.014506829,
                                      0.018544108,
                                      0.023264095,
                                      0.018384399,
                                      0.016914774,
                                      0.01642709,
                                      0.019331098,
                                      0.013705851,
                                      0.014616746,
                                      0.016539773,
                                      0.012566212,
                                      0.013169301,
                                      0.014383291,
                                      0.013454064,
                                      0.013184452,
                                      0.05686801,
                                      0.014537075,
                                      0.018252574,
                                      0.015902251,
                                      0.014465205,
                                      0.01727854,
                                      0.013463408]},
 'residuals': {'mae': 0.010808737017214298,
               'mse': 0.00039325907710008323,
               'psnr': 17.946842193603516,
               'rmse': 0.01983076147735119,
               'ssds': [90.90281, 4.3793035],
               'ssim': 0.6383571624755859},
 'spectra_pcagan': {'cosine': [0.96932054,
                               0.98749304,
                               0.98004705,
                               0.9872944,
                               0.9962214,
                               0.9990581,
                               0.9942167,
                               0.9965835,
                               0.99825543,
                               0.99880797,
                               0.9975095,
                               0.9977033,
                               0.99857354,
                               0.9979095,
                               0.99889815,
                               -0.64455485,
                               0.9987219,
                               0.9994841,
                               0.9991665,
                               0.9958833,
                               0.005388432,
                               0.98960274],
                    'mae': [0.035729565,
                            0.04612339,
                            0.032923494,
                            0.03451071,
                            0.01732234,
                            0.015033188,
                            0.020452127,
                            0.01709672,
                            0.017021127,
                            0.014404109,
                            0.013369678,
                            0.015303586,
                            0.01531753,
                            0.014058383,
                            0.013859091,
                            0.9587074,
                            0.015577261,
                            0.014377833,
                            0.014890071,
                            0.020317953,
                            0.34514832,
                            0.028224874],
                    'max_mae': 0.9587074,
                    'max_mse': 0.98107195,
                    'max_rmse': 0.99049073,
                    'median_mae': 0.017058924,
                    'min_cosine': -0.64455485,
                    'mse': [0.0017464205,
                            0.0029865627,
                            0.0019211124,
                            0.001776303,
                            0.00054211804,
                            0.00037846732,
                            0.00068651745,
                            0.00048522378,
                            0.0004765938,
                            0.00035986805,
                            0.0003259768,
                            0.00037944433,
                            0.0003790955,
                            0.0003510491,
                            0.00031488962,
                            0.98107195,
                            0.00038866317,
                            0.000332874,
                            0.000357967,
                            0.0006333353,
                            0.124394484,
                            0.0011987758],
                    'rmse': [0.041790195,
                             0.054649454,
                             0.043830495,
                             0.04214621,
                             0.023283428,
                             0.019454237,
                             0.026201477,
                             0.022027796,
                             0.021831028,
                             0.018970188,
                             0.018054828,
                             0.01947933,
                             0.019470375,
                             0.018736305,
                             0.01774513,
                             0.99049073,
                             0.019714542,
                             0.018244835,
                             0.018920016,
                             0.025166154,
                             0.35269603,
                             0.034623343]},
 'spectra_realgan': {'cosine': [0.9670778,
                                0.9860739,
                                0.9780557,
                                0.98576266,
                                0.9951324,
                                0.99904984,
                                0.993334,
                                0.9958081,
                                0.9978229,
                                0.99878496,
                                0.99668676,
                                0.99711907,
                                0.9985224,
                                0.9972569,
                                0.99887186,
                                -0.6445148,
                                0.9986888,
                                0.9994831,
                                0.9991609,
                                0.9950985,
                                0.00620771,
                                0.98793983],
                     'mae': [0.03637817,
                             0.046589788,
                             0.034258008,
                             0.035527002,
                             0.019814119,
                             0.015101448,
                             0.02191781,
                             0.018824134,
                             0.018703619,
                             0.014546591,
                             0.015915832,
                             0.017371306,
                             0.015557715,
                             0.016533135,
                             0.014031367,
                             0.95868284,
                             0.01574498,
                             0.0143905,
                             0.014926655,
                             0.02216288,
                             0.34483683,
                             0.029416408],
                     'max_mae': 0.95868284,
                     'max_mse': 0.9810211,
                     'max_rmse': 0.9904651,
                     'median_mae': 0.018763877,
                     'min_cosine': -0.6445148,
                     'mse': [0.0018786305,
                             0.0031433513,
                             0.0020680984,
                             0.0019107212,
                             0.00067015114,
                             0.00038199013,
                             0.00079278374,
                             0.0005900748,
                             0.0005667468,
                             0.00036588818,
                             0.000430694,
                             0.00047388955,
                             0.0003922552,
                             0.0004558564,
                             0.00032200202,
                             0.9810211,
                             0.0003959076,
                             0.0003332668,
                             0.00035991942,
                             0.0007465529,
                             0.12421885,
                             0.001340763],
                     'rmse': [0.04334317,
                              0.056065597,
                              0.04547635,
                              0.043711796,
                              0.025887277,
                              0.019544568,
                              0.028156416,
                              0.024291456,
                              0.023806445,
                              0.019128203,
                              0.020753168,
                              0.021769004,
                              0.019805433,
                              0.021350794,
                              0.017944414,
                              0.9904651,
                              0.019897427,
                              0.018255597,
                              0.018971542,
                              0.02732312,
                              0.35244694,
                              0.03661643]},
 'spectra_realpca': {'cosine': [0.9974952,
                                0.9987641,
                                0.997945,
                                0.99830556,
                                0.99896896,
                                0.9999939,
                                0.999008,
                                0.9991892,
                                0.99958414,
                                0.9999871,
                                0.99908394,
                                0.9993856,
                                0.9999583,
                                0.9993689,
                                0.99997663,
                                0.9999973,
                                0.999977,
                                0.99999934,
                                0.99999607,
                                0.9992606,
                                0.9995649,
                                0.99819946],
                     'mae': [0.00952097,
                             0.010630843,
                             0.010018292,
                             0.009995851,
                             0.008532087,
                             0.0011868685,
                             0.008560578,
                             0.008262262,
                             0.007285279,
                             0.0015449405,
                             0.008497308,
                             0.0077835596,
                             0.0026333116,
                             0.007965106,
                             0.0020307025,
                             0.0006430705,
                             0.0020460035,
                             0.0005177625,
                             0.0010193747,
                             0.00806858,
                             0.005105634,
                             0.010247714],
                     'max_mae': 0.010630843,
                     'max_mse': 0.00019061226,
                     'max_rmse': 0.01380624,
                     'median_mae': 0.007874332,
                     'min_cosine': 0.9974952,
                     'mse': [0.00014489207,
                             0.00019061226,
                             0.00016073286,
                             0.0001593923,
                             0.000116962685,
                             2.2795273e-06,
                             0.00011807036,
                             0.000110420144,
                             8.556213e-05,
                             3.810519e-06,
                             0.000117135416,
                             9.886121e-05,
                             1.1164935e-05,
                             0.00010240304,
                             6.6572466e-06,
                             6.713425e-07,
                             6.720756e-06,
                             4.2708237e-07,
                             1.6726069e-06,
                             0.00010569917,
                             4.6410052e-05,
                             0.00016988185],
                     'rmse': [0.012037112,
                              0.01380624,
                              0.012678047,
                              0.012625066,
                              0.010814928,
                              0.0015098103,
                              0.010866019,
                              0.010508099,
                              0.009249981,
                              0.001952055,
                              0.010822912,
                              0.009942898,
                              0.0033413973,
                              0.010119439,
                              0.002580164,
                              0.0008193549,
                              0.002592442,
                              0.0006535154,
                              0.0012932931,
                              0.01028101,
                              0.0068124924,
                              0.013033873]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_65.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809
Directory path: experiments/inpainting/gann_4_night_20180901_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_65.0/images
Optimal number of principal components:  22
Reconstruction error:  11.35417
Energy conservation:  0.6581386
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_65.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9130967822707543, 2.845465368074473],
                   'kl_div': 0.5305349,
                   'ks_tests': {10000: KstestResult(statistic=0.2139, pvalue=1.1584599878273164e-200, statistic_location=-0.004907937, statistic_sign=-1),
                                20000: KstestResult(statistic=0.2178, pvalue=0.0, statistic_location=-0.005664673, statistic_sign=-1),
                                30000: KstestResult(statistic=0.21636666666666665, pvalue=0.0, statistic_location=-0.004340074, statistic_sign=-1),
                                40000: KstestResult(statistic=0.21539999999999998, pvalue=0.0, statistic_location=-0.005719657, statistic_sign=-1),
                                50000: KstestResult(statistic=0.2212, pvalue=0.0, statistic_location=-0.0047969203, statistic_sign=-1),
                                60000: KstestResult(statistic=0.22346666666666665, pvalue=0.0, statistic_location=-0.0051433714, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2157142857142857, pvalue=0.0, statistic_location=-0.005141998, statistic_sign=-1),
                                80000: KstestResult(statistic=0.21995, pvalue=0.0, statistic_location=-0.004687083, statistic_sign=-1),
                                90000: KstestResult(statistic=0.21660000000000001, pvalue=0.0, statistic_location=-0.005157739, statistic_sign=-1),
                                100000: KstestResult(statistic=0.21941, pvalue=0.0, statistic_location=-0.0052719405, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2176909090909091, pvalue=0.0, statistic_location=-0.005384844, statistic_sign=-1),
                                120000: KstestResult(statistic=0.21910000000000002, pvalue=0.0, statistic_location=-0.005440605, statistic_sign=-1),
                                130000: KstestResult(statistic=0.21772307692307694, pvalue=0.0, statistic_location=-0.0044573303, statistic_sign=-1),
                                140000: KstestResult(statistic=0.21939285714285717, pvalue=0.0, statistic_location=-0.0050545633, statistic_sign=-1),
                                150000: KstestResult(statistic=0.21910666666666667, pvalue=0.0, statistic_location=-0.005233559, statistic_sign=-1),
                                160000: KstestResult(statistic=0.215875, pvalue=0.0, statistic_location=-0.0053019193, statistic_sign=-1),
                                170000: KstestResult(statistic=0.21852941176470592, pvalue=0.0, statistic_location=-0.0052375942, statistic_sign=-1),
                                180000: KstestResult(statistic=0.21766666666666667, pvalue=0.0, statistic_location=-0.004499431, statistic_sign=-1),
                                190000: KstestResult(statistic=0.21939473684210525, pvalue=0.0, statistic_location=-0.0048503103, statistic_sign=-1),
                                200000: KstestResult(statistic=0.21541000000000002, pvalue=0.0, statistic_location=-0.0049428344, statistic_sign=-1),
                                210000: KstestResult(statistic=0.21832380952380953, pvalue=0.0, statistic_location=-0.004907917, statistic_sign=-1),
                                220000: KstestResult(statistic=0.21827272727272728, pvalue=0.0, statistic_location=-0.004947132, statistic_sign=-1),
                                230000: KstestResult(statistic=0.21811304347826088, pvalue=0.0, statistic_location=-0.0052145924, statistic_sign=-1),
                                240000: KstestResult(statistic=0.21796250000000003, pvalue=0.0, statistic_location=-0.005065597, statistic_sign=-1),
                                250000: KstestResult(statistic=0.21965200000000001, pvalue=0.0, statistic_location=-0.005053561, statistic_sign=-1),
                                260000: KstestResult(statistic=0.21872307692307694, pvalue=0.0, statistic_location=-0.00523917, statistic_sign=-1),
                                270000: KstestResult(statistic=0.21932592592592595, pvalue=0.0, statistic_location=-0.0051433714, statistic_sign=-1),
                                280000: KstestResult(statistic=0.21929285714285712, pvalue=0.0, statistic_location=-0.0049209595, statistic_sign=-1),
                                290000: KstestResult(statistic=0.21793793103448275, pvalue=0.0, statistic_location=-0.005288737, statistic_sign=-1),
                                300000: KstestResult(statistic=0.21764666666666665, pvalue=0.0, statistic_location=-0.0048521757, statistic_sign=-1),
                                310000: KstestResult(statistic=0.21709032258064517, pvalue=0.0, statistic_location=-0.0045072744, statistic_sign=-1),
                                320000: KstestResult(statistic=0.21826562500000002, pvalue=0.0, statistic_location=-0.005238615, statistic_sign=-1),
                                330000: KstestResult(statistic=0.21845151515151517, pvalue=0.0, statistic_location=-0.0047691464, statistic_sign=-1)},
                   'moments': {'mean_error': -0.032415662,
                               'means': [-0.00039741758, -4.347251e-05],
                               'stds': [0.018622587, 0.0045266035],
                               'variance_ratio': 13.214239}},
 'originals': {'gan': {'mae': 0.061107855290174484,
                       'mse': 0.03438358008861542,
                       'psnr': 19.85433006286621,
                       'rmse': 0.18542809784412384,
                       'ssim': 0.6147010922431946},
               'pca': {'mae': 0.0064485822804272175,
                       'mse': 8.941911801230162e-05,
                       'psnr': 45.94384002685547,
                       'rmse': 0.009456167928874493,
                       'ssim': 0.9958240389823914}},
 'reconstructions': {'mae': 0.06011296063661575,
                     'mse': 0.03431084752082825,
                     'psnr': 20.103830337524414,
                     'rmse': 0.18523187935352325,
                     'ssim': 0.6167244911193848},
 'residual_spectra_pcagan': {'cosine': [0.3470606,
                                        0.38186985,
                                        0.3362221,
                                        0.40624976,
                                        0.39938188,
                                        0.26616383,
                                        0.37226772,
                                        0.3250101,
                                        0.24673195,
                                        0.25409234,
                                        0.3389069,
                                        0.08802513,
                                        0.3260178,
                                        0.41894752,
                                        0.38236877,
                                        0.11917192,
                                        0.39535856,
                                        0.38910142,
                                        0.17251055,
                                        0.41034466,
                                        0.12873082,
                                        0.020874197,
                                        0.13784921,
                                        0.038169242,
                                        0.068323,
                                        0.38661876,
                                        0.2324775,
                                        0.39308363,
                                        0.29030073,
                                        0.25294498,
                                        0.064123824,
                                        0.11303531,
                                        0.080001324],
                             'mae': [0.00863216,
                                     0.00788265,
                                     0.008397508,
                                     0.007982431,
                                     0.007971769,
                                     0.010087903,
                                     0.00919734,
                                     0.010198744,
                                     0.0105894515,
                                     0.010990581,
                                     0.009502361,
                                     0.010741091,
                                     0.010279932,
                                     0.008175891,
                                     0.009271205,
                                     0.010117453,
                                     0.00782523,
                                     0.00881909,
                                     0.009686678,
                                     0.008292467,
                                     0.009191205,
                                     0.025858331,
                                     0.010201511,
                                     0.012564311,
                                     0.010948007,
                                     0.009589361,
                                     0.010793535,
                                     0.007873454,
                                     0.009501902,
                                     0.010850474,
                                     0.011173329,
                                     0.011455684,
                                     0.00999486],
                             'max_mae': 0.025858331,
                             'max_mse': 0.0033100715,
                             'max_rmse': 0.05753322,
                             'median_distance': 1.4534194,
                             'median_mae': 0.009686678,
                             'min_cosine': 0.020874197,
                             'mse': [0.00020634657,
                                     0.00015004427,
                                     0.00020778307,
                                     0.00015598745,
                                     0.00014201846,
                                     0.00032699056,
                                     0.00017741251,
                                     0.00028094658,
                                     0.00044994545,
                                     0.00033442522,
                                     0.00025518745,
                                     0.00024345107,
                                     0.0003216068,
                                     0.0001625086,
                                     0.00019435583,
                                     0.00023868318,
                                     0.00015613757,
                                     0.00016483426,
                                     0.00017816003,
                                     0.00016033645,
                                     0.0001658802,
                                     0.0033100715,
                                     0.00019859712,
                                     0.00031559085,
                                     0.00022772508,
                                     0.0001990058,
                                     0.00028685402,
                                     0.00014806034,
                                     0.00023679208,
                                     0.00043409748,
                                     0.00027862395,
                                     0.00026972115,
                                     0.00021124278],
                             'rmse': [0.014364768,
                                      0.0122492565,
                                      0.014414683,
                                      0.012489494,
                                      0.01191715,
                                      0.01808288,
                                      0.013319629,
                                      0.016761461,
                                      0.021211918,
                                      0.018287297,
                                      0.015974587,
                                      0.015602918,
                                      0.017933398,
                                      0.012747886,
                                      0.013941156,
                                      0.015449375,
                                      0.012495502,
                                      0.012838779,
                                      0.01334766,
                                      0.012662403,
                                      0.012879449,
                                      0.05753322,
                                      0.014092449,
                                      0.017764878,
                                      0.015090562,
                                      0.014106941,
                                      0.016936766,
                                      0.012168005,
                                      0.01538805,
                                      0.020835007,
                                      0.016692033,
                                      0.01642319,
                                      0.014534193]},
 'residuals': {'mae': 0.010140541940927505,
               'mse': 0.0003269522567279637,
               'psnr': 18.74878692626953,
               'rmse': 0.018081821501255035,
               'ssds': [114.495995, 6.76235],
               'ssim': 0.6354439854621887},
 'spectra_pcagan': {'cosine': [0.9835987,
                               0.98135924,
                               0.98557365,
                               0.9880143,
                               0.9835615,
                               0.98388773,
                               0.9690756,
                               0.98783267,
                               0.98083913,
                               0.98753023,
                               0.9962807,
                               0.99905807,
                               0.9941424,
                               0.9965419,
                               0.99827087,
                               0.9987939,
                               0.99737847,
                               0.9977007,
                               0.99855125,
                               0.9978585,
                               0.99885017,
                               -0.64594465,
                               0.99868715,
                               0.9994679,
                               0.99917275,
                               0.9956354,
                               0.0065664425,
                               0.98952067,
                               0.97946405,
                               0.9748254,
                               0.99950886,
                               0.9982248,
                               0.99903524],
                    'mae': [0.023511823,
                            0.027007397,
                            0.022288173,
                            0.022513099,
                            0.025250219,
                            0.026074212,
                            0.03598177,
                            0.045963887,
                            0.0326091,
                            0.034550752,
                            0.01688083,
                            0.015086778,
                            0.02053668,
                            0.017113015,
                            0.01687561,
                            0.014539054,
                            0.013531946,
                            0.015245141,
                            0.015467878,
                            0.0141674485,
                            0.01409092,
                            0.95922744,
                            0.015751313,
                            0.014685042,
                            0.014862763,
                            0.020793734,
                            0.3446677,
                            0.028547946,
                            0.037092976,
                            0.031631883,
                            0.014719777,
                            0.017826894,
                            0.014634158],
                    'max_mae': 0.95922744,
                    'max_mse': 0.981544,
                    'max_rmse': 0.99072903,
                    'median_mae': 0.02053668,
                    'min_cosine': -0.64594465,
                    'mse': [0.00093714526,
                            0.0010707851,
                            0.0008565976,
                            0.00079850265,
                            0.0009427229,
                            0.0011479767,
                            0.0017622198,
                            0.002964698,
                            0.0018817879,
                            0.0018014236,
                            0.00051101815,
                            0.000377965,
                            0.00069329364,
                            0.00048514086,
                            0.00046862353,
                            0.00036537118,
                            0.0003392281,
                            0.00037602085,
                            0.00038494493,
                            0.00035946644,
                            0.000328627,
                            0.981544,
                            0.00040028142,
                            0.0003454551,
                            0.0003573131,
                            0.0006638086,
                            0.124012716,
                            0.001217554,
                            0.0020753401,
                            0.0015619374,
                            0.00036048362,
                            0.0005051941,
                            0.00036013013],
                    'rmse': [0.030612828,
                             0.032722853,
                             0.02926769,
                             0.02825779,
                             0.030703792,
                             0.033881806,
                             0.041978803,
                             0.05444904,
                             0.04337958,
                             0.042443182,
                             0.02260571,
                             0.019441321,
                             0.02633047,
                             0.022025913,
                             0.021647714,
                             0.019114684,
                             0.018418146,
                             0.019391257,
                             0.019620014,
                             0.0189596,
                             0.018128073,
                             0.99072903,
                             0.020007035,
                             0.018586423,
                             0.018902728,
                             0.025764484,
                             0.3521544,
                             0.034893464,
                             0.0455559,
                             0.039521355,
                             0.018986406,
                             0.022476524,
                             0.018977094]},
 'spectra_realgan': {'cosine': [0.98116416,
                                0.9792906,
                                0.9832459,
                                0.98577976,
                                0.9814677,
                                0.98156124,
                                0.9668413,
                                0.9864012,
                                0.97883904,
                                0.9860042,
                                0.99519145,
                                0.9990496,
                                0.9932539,
                                0.9957636,
                                0.99784756,
                                0.9987711,
                                0.996565,
                                0.9971138,
                                0.9984994,
                                0.9972058,
                                0.9988238,
                                -0.64590436,
                                0.998654,
                                0.99946684,
                                0.999167,
                                0.9948542,
                                0.0073883943,
                                0.9878665,
                                0.97839326,
                                0.97260165,
                                0.99950576,
                                0.9981981,
                                0.99902624],
                     'mae': [0.025522962,
                             0.02819047,
                             0.024054082,
                             0.024406085,
                             0.026515229,
                             0.02765658,
                             0.0366096,
                             0.04644786,
                             0.033958904,
                             0.03557728,
                             0.01940579,
                             0.015161359,
                             0.022016011,
                             0.018857328,
                             0.018548708,
                             0.01466665,
                             0.016057845,
                             0.017318573,
                             0.015701028,
                             0.016630571,
                             0.01427325,
                             0.95920295,
                             0.01591568,
                             0.014694339,
                             0.014899051,
                             0.02259362,
                             0.3443543,
                             0.029696891,
                             0.03761046,
                             0.032620154,
                             0.014728023,
                             0.01795012,
                             0.014717337],
                     'max_mae': 0.95920295,
                     'max_mse': 0.9814932,
                     'max_rmse': 0.99070334,
                     'median_mae': 0.022016011,
                     'min_cosine': -0.64590436,
                     'mse': [0.0010776102,
                             0.0011927221,
                             0.0009870987,
                             0.00093792914,
                             0.0010650458,
                             0.0012817222,
                             0.0018940758,
                             0.0031226284,
                             0.0020291568,
                             0.0019350204,
                             0.0006385489,
                             0.00038157578,
                             0.000800654,
                             0.0005906596,
                             0.00055675977,
                             0.00037131037,
                             0.00044307986,
                             0.00047080207,
                             0.0003982088,
                             0.00046431867,
                             0.00033573667,
                             0.9814932,
                             0.00040745668,
                             0.00034584056,
                             0.00035928897,
                             0.00077649346,
                             0.123837024,
                             0.0013584506,
                             0.0021697725,
                             0.0016991112,
                             0.0003608177,
                             0.00051253545,
                             0.00036351563],
                     'rmse': [0.032826975,
                              0.03453581,
                              0.031418126,
                              0.030625628,
                              0.03263504,
                              0.03580115,
                              0.04352098,
                              0.055880483,
                              0.04504616,
                              0.04398887,
                              0.025269525,
                              0.019533964,
                              0.02829583,
                              0.02430349,
                              0.023595758,
                              0.019269416,
                              0.021049462,
                              0.021697974,
                              0.01995517,
                              0.021548055,
                              0.018323118,
                              0.99070334,
                              0.020185556,
                              0.018596789,
                              0.01895492,
                              0.027865632,
                              0.35190484,
                              0.036857165,
                              0.046580818,
                              0.041220278,
                              0.018995203,
                              0.022639247,
                              0.019066086]},
 'spectra_realpca': {'cosine': [0.99752074,
                                0.99754095,
                                0.9974033,
                                0.997777,
                                0.9975177,
                                0.9974823,
                                0.9974952,
                                0.9987641,
                                0.997945,
                                0.99830556,
                                0.99896896,
                                0.9999939,
                                0.999008,
                                0.9991892,
                                0.99958414,
                                0.9999871,
                                0.99908394,
                                0.9993856,
                                0.9999583,
                                0.9993689,
                                0.99997663,
                                0.9999973,
                                0.999977,
                                0.99999934,
                                0.99999607,
                                0.9992606,
                                0.9995649,
                                0.99819946,
                                0.99825454,
                                0.9975186,
                                0.9999983,
                                0.99997693,
                                0.999992],
                     'mae': [0.009363975,
                             0.009419619,
                             0.009676686,
                             0.009253078,
                             0.009444325,
                             0.009727745,
                             0.00952097,
                             0.010630843,
                             0.010018292,
                             0.009995851,
                             0.008532087,
                             0.0011868685,
                             0.008560578,
                             0.008262262,
                             0.007285279,
                             0.0015449405,
                             0.008497308,
                             0.0077835596,
                             0.0026333116,
                             0.007965106,
                             0.0020307025,
                             0.0006430705,
                             0.0020460035,
                             0.0005177625,
                             0.0010193747,
                             0.00806858,
                             0.005105634,
                             0.010247714,
                             0.010212888,
                             0.009576219,
                             0.00072955084,
                             0.0020088924,
                             0.001294128],
                     'max_mae': 0.010630843,
                     'max_mse': 0.00019061226,
                     'max_rmse': 0.01380624,
                     'median_mae': 0.008262262,
                     'min_cosine': 0.9974033,
                     'mse': [0.00014060538,
                             0.00014146359,
                             0.00014776418,
                             0.00013730362,
                             0.00014287305,
                             0.00015311537,
                             0.00014489207,
                             0.00019061226,
                             0.00016073286,
                             0.0001593923,
                             0.000116962685,
                             2.2795273e-06,
                             0.00011807036,
                             0.000110420144,
                             8.556213e-05,
                             3.810519e-06,
                             0.000117135416,
                             9.886121e-05,
                             1.1164935e-05,
                             0.00010240304,
                             6.6572466e-06,
                             6.713425e-07,
                             6.720756e-06,
                             4.2708237e-07,
                             1.6726069e-06,
                             0.00010569917,
                             4.6410052e-05,
                             0.00016988185,
                             0.00017007081,
                             0.00014718951,
                             8.5671843e-07,
                             6.4547526e-06,
                             2.694279e-06],
                     'rmse': [0.011857714,
                              0.011893847,
                              0.012155829,
                              0.011717663,
                              0.011952952,
                              0.012373979,
                              0.012037112,
                              0.01380624,
                              0.012678047,
                              0.012625066,
                              0.010814928,
                              0.0015098103,
                              0.010866019,
                              0.010508099,
                              0.009249981,
                              0.001952055,
                              0.010822912,
                              0.009942898,
                              0.0033413973,
                              0.010119439,
                              0.002580164,
                              0.0008193549,
                              0.002592442,
                              0.0006535154,
                              0.0012932931,
                              0.01028101,
                              0.0068124924,
                              0.013033873,
                              0.01304112,
                              0.012132169,
                              0.00092559087,
                              0.0025406205,
                              0.0016414259]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_65.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521
Directory path: experiments/inpainting/gann_4_night_20180904_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_65.0/images
Optimal number of principal components:  29
Reconstruction error:  8.21572
Energy conservation:  0.66402406
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_65.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9519870688369956, 1.2435703263003526],
                   'kl_div': 2.108231,
                   'ks_tests': {10000: KstestResult(statistic=0.4649, pvalue=0.0, statistic_location=0.0017738352, statistic_sign=1),
                                20000: KstestResult(statistic=0.4738, pvalue=0.0, statistic_location=0.0018030801, statistic_sign=1),
                                30000: KstestResult(statistic=0.4650333333333333, pvalue=0.0, statistic_location=0.0018146755, statistic_sign=1),
                                40000: KstestResult(statistic=0.46455, pvalue=0.0, statistic_location=0.0017823856, statistic_sign=1),
                                50000: KstestResult(statistic=0.46556, pvalue=0.0, statistic_location=0.0018107779, statistic_sign=1),
                                60000: KstestResult(statistic=0.4632166666666667, pvalue=0.0, statistic_location=0.0018187771, statistic_sign=1),
                                70000: KstestResult(statistic=0.4661571428571428, pvalue=0.0, statistic_location=0.0018007685, statistic_sign=1),
                                80000: KstestResult(statistic=0.4637875, pvalue=0.0, statistic_location=0.0018007685, statistic_sign=1),
                                90000: KstestResult(statistic=0.4658444444444445, pvalue=0.0, statistic_location=0.0018045271, statistic_sign=1),
                                100000: KstestResult(statistic=0.4659, pvalue=0.0, statistic_location=0.0018107779, statistic_sign=1),
                                110000: KstestResult(statistic=0.46413636363636357, pvalue=0.0, statistic_location=0.0017258532, statistic_sign=1)},
                   'moments': {'mean_error': 1.6285664,
                               'means': [0.00041185232, -6.054272e-06],
                               'stds': [0.018056862, 0.0008155174],
                               'variance_ratio': 459.9572}},
 'originals': {'gan': {'mae': 0.015457064844667912,
                       'mse': 0.0004065644461661577,
                       'psnr': 33.482749938964844,
                       'rmse': 0.020163442939519882,
                       'ssim': 0.9744046926498413},
               'pca': {'mae': 0.0008609635988250375,
                       'mse': 1.747244709804363e-06,
                       'psnr': 57.57645797729492,
                       'rmse': 0.0013218338135629892,
                       'ssim': 0.9999596476554871}},
 'reconstructions': {'mae': 0.01542634516954422,
                     'mse': 0.00040502441697753966,
                     'psnr': 33.92518615722656,
                     'rmse': 0.020125217735767365,
                     'ssim': 0.9744207859039307},
 'residual_spectra_pcagan': {'cosine': [0.029002959,
                                        0.05006982,
                                        0.030080246,
                                        0.026086243,
                                        0.022720115,
                                        0.010703348,
                                        0.033862792,
                                        0.022850856,
                                        0.06224721,
                                        0.08260906,
                                        0.057308204],
                             'mae': [0.011259458,
                                     0.0131243635,
                                     0.012182267,
                                     0.011823758,
                                     0.013404303,
                                     0.011490107,
                                     0.011098122,
                                     0.010492757,
                                     0.010602672,
                                     0.010367691,
                                     0.010774228],
                             'max_mae': 0.013404303,
                             'max_mse': 0.000539078,
                             'max_rmse': 0.023218054,
                             'median_distance': 1.7332019,
                             'median_mae': 0.011259458,
                             'min_cosine': 0.010703348,
                             'mse': [0.00026680582,
                                     0.00048432493,
                                     0.00031815743,
                                     0.0002931827,
                                     0.000539078,
                                     0.00030191356,
                                     0.00028530578,
                                     0.00025484682,
                                     0.0003003989,
                                     0.00023430522,
                                     0.00030434065],
                             'rmse': [0.016334191,
                                      0.022007383,
                                      0.017836967,
                                      0.017122578,
                                      0.023218054,
                                      0.01737566,
                                      0.016890997,
                                      0.015963923,
                                      0.01733202,
                                      0.015307032,
                                      0.017445361]},
 'residuals': {'mae': 0.011510884389281273,
               'mse': 0.0003256963682360947,
               'psnr': -2.9123990535736084,
               'rmse': 0.018047058954834938,
               'ssds': [35.88386, 0.07316092],
               'ssim': 0.29169270396232605},
 'spectra_pcagan': {'cosine': [0.99921393,
                               0.9991777,
                               0.9991695,
                               0.9996016,
                               0.99972045,
                               0.99956834,
                               0.99955696,
                               0.99922764,
                               0.9983872,
                               0.99858797,
                               0.998144],
                    'mae': [0.01621699,
                            0.016137479,
                            0.016541949,
                            0.014095194,
                            0.013365887,
                            0.013898489,
                            0.013643158,
                            0.014645822,
                            0.017070087,
                            0.016922455,
                            0.017152283],
                    'max_mae': 0.017152283,
                    'max_mse': 0.00051277695,
                    'max_rmse': 0.02264458,
                    'median_mae': 0.016137479,
                    'min_cosine': 0.998144,
                    'mse': [0.00042963962,
                            0.00046828613,
                            0.00044459096,
                            0.00031641993,
                            0.00032542454,
                            0.0003163187,
                            0.00030619925,
                            0.0003577448,
                            0.00051277695,
                            0.00047295517,
                            0.0005049122],
                    'rmse': [0.02072775,
                             0.02163992,
                             0.021085326,
                             0.017788196,
                             0.018039526,
                             0.017785352,
                             0.01749855,
                             0.018914143,
                             0.02264458,
                             0.021747533,
                             0.022470253]},
 'spectra_realgan': {'cosine': [0.99921256,
                                0.9991765,
                                0.99916816,
                                0.9996011,
                                0.9997202,
                                0.9995683,
                                0.9995564,
                                0.9992265,
                                0.99837536,
                                0.99857473,
                                0.9981255],
                     'mae': [0.01623479,
                             0.016154584,
                             0.016564991,
                             0.014099701,
                             0.013370254,
                             0.013901636,
                             0.013646783,
                             0.014649214,
                             0.017152928,
                             0.0170039,
                             0.017248929],
                     'max_mae': 0.017248929,
                     'max_mse': 0.0005166707,
                     'max_rmse': 0.022730391,
                     'median_mae': 0.016154584,
                     'min_cosine': 0.9981255,
                     'mse': [0.0004304205,
                             0.00046923233,
                             0.0004453967,
                             0.0003167209,
                             0.00032555513,
                             0.00031649068,
                             0.0003063425,
                             0.00035819178,
                             0.0005166707,
                             0.00047747145,
                             0.00050971593],
                     'rmse': [0.020746578,
                              0.021661771,
                              0.021104423,
                              0.017796654,
                              0.018043146,
                              0.017790185,
                              0.017502643,
                              0.018925956,
                              0.022730391,
                              0.02185112,
                              0.022576889]},
 'spectra_realpca': {'cosine': [0.99999845,
                                0.99999875,
                                0.99999815,
                                0.99999964,
                                0.9999999,
                                0.9999997,
                                0.99999964,
                                0.9999978,
                                0.9999857,
                                0.999987,
                                0.9999755],
                     'mae': [0.00069927244,
                             0.000647671,
                             0.00077206513,
                             0.00033129437,
                             0.0002400477,
                             0.0003150358,
                             0.00037708526,
                             0.00079852494,
                             0.0016572834,
                             0.0016061211,
                             0.0020261977],
                     'max_mae': 0.0020261977,
                     'max_mse': 6.5759873e-06,
                     'max_rmse': 0.0025643688,
                     'median_mae': 0.00069927244,
                     'min_cosine': 0.9999755,
                     'mse': [7.887549e-07,
                             6.646653e-07,
                             9.545251e-07,
                             1.7618862e-07,
                             9.3566356e-08,
                             1.6032695e-07,
                             2.2896855e-07,
                             1.0211955e-06,
                             4.40431e-06,
                             4.1512044e-06,
                             6.5759873e-06],
                     'rmse': [0.00088811875,
                              0.0008152701,
                              0.000976998,
                              0.00041974828,
                              0.00030588618,
                              0.00040040846,
                              0.00047850658,
                              0.0010105422,
                              0.0020986449,
                              0.0020374504,
                              0.0025643688]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_65.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743
Directory path: experiments/inpainting/gann_4_night_20180904_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_65.0/images
Optimal number of principal components:  29
Reconstruction error:  8.21572
Energy conservation:  0.66402406
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_65.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9538435048012626, 1.7888682897762331],
                   'kl_div': 1.5521905,
                   'ks_tests': {10000: KstestResult(statistic=0.3736, pvalue=0.0, statistic_location=0.0021566683, statistic_sign=1),
                                20000: KstestResult(statistic=0.35885, pvalue=0.0, statistic_location=0.0018661935, statistic_sign=1),
                                30000: KstestResult(statistic=0.36563333333333325, pvalue=0.0, statistic_location=0.002013187, statistic_sign=1),
                                40000: KstestResult(statistic=0.37012500000000004, pvalue=0.0, statistic_location=0.002214355, statistic_sign=1),
                                50000: KstestResult(statistic=0.37041999999999997, pvalue=0.0, statistic_location=0.0022542318, statistic_sign=1),
                                60000: KstestResult(statistic=0.36219999999999997, pvalue=0.0, statistic_location=0.0021358388, statistic_sign=1),
                                70000: KstestResult(statistic=0.36240000000000006, pvalue=0.0, statistic_location=0.0021412862, statistic_sign=1),
                                80000: KstestResult(statistic=0.36395, pvalue=0.0, statistic_location=0.0020462312, statistic_sign=1),
                                90000: KstestResult(statistic=0.36421111111111115, pvalue=0.0, statistic_location=0.0020851705, statistic_sign=1),
                                100000: KstestResult(statistic=0.36349, pvalue=0.0, statistic_location=0.0019435487, statistic_sign=1),
                                110000: KstestResult(statistic=0.3659636363636364, pvalue=0.0, statistic_location=0.0021266462, statistic_sign=1),
                                120000: KstestResult(statistic=0.3658416666666666, pvalue=0.0, statistic_location=0.0021143956, statistic_sign=1),
                                130000: KstestResult(statistic=0.3662846153846153, pvalue=0.0, statistic_location=0.002134082, statistic_sign=1),
                                140000: KstestResult(statistic=0.36415, pvalue=0.0, statistic_location=0.0021366403, statistic_sign=1),
                                150000: KstestResult(statistic=0.36353333333333326, pvalue=0.0, statistic_location=0.00207955, statistic_sign=1),
                                160000: KstestResult(statistic=0.364575, pvalue=0.0, statistic_location=0.0021301508, statistic_sign=1),
                                170000: KstestResult(statistic=0.3659588235294118, pvalue=0.0, statistic_location=0.0021239612, statistic_sign=1),
                                180000: KstestResult(statistic=0.3671000000000001, pvalue=0.0, statistic_location=0.0020086616, statistic_sign=1),
                                190000: KstestResult(statistic=0.36526315789473685, pvalue=0.0, statistic_location=0.0021243147, statistic_sign=1),
                                200000: KstestResult(statistic=0.366545, pvalue=0.0, statistic_location=0.0020327265, statistic_sign=1),
                                210000: KstestResult(statistic=0.36502380952380953, pvalue=0.0, statistic_location=0.0019877704, statistic_sign=1),
                                220000: KstestResult(statistic=0.36516363636363636, pvalue=0.0, statistic_location=0.0021296125, statistic_sign=1)},
                   'moments': {'mean_error': 0.09368665,
                               'means': [-0.00020164356, -6.8848453e-06],
                               'stds': [0.016210506, 0.002159122],
                               'variance_ratio': 75.40351}},
 'originals': {'gan': {'mae': 0.02280348539352417,
                       'mse': 0.0012679299106821418,
                       'psnr': 29.031415939331055,
                       'rmse': 0.03560800477862358,
                       'ssim': 0.9156923890113831},
               'pca': {'mae': 0.0022551557049155235,
                       'mse': 2.23103506868938e-05,
                       'psnr': 46.86574935913086,
                       'rmse': 0.004723383579403162,
                       'ssim': 0.9996493458747864}},
 'reconstructions': {'mae': 0.0225111935287714,
                     'mse': 0.001247033360414207,
                     'psnr': 29.392032623291016,
                     'rmse': 0.03531336039304733,
                     'ssim': 0.9156901240348816},
 'residual_spectra_pcagan': {'cosine': [0.04242542,
                                        0.07621727,
                                        0.015658068,
                                        0.029641965,
                                        0.010330061,
                                        0.029987028,
                                        0.054813035,
                                        0.02638188,
                                        0.02782871,
                                        0.03466927,
                                        0.0074208197,
                                        0.01835863,
                                        0.059001893,
                                        0.045133706,
                                        0.08366845,
                                        0.062598415,
                                        0.049867447,
                                        0.15497597,
                                        0.39264354,
                                        0.3494016,
                                        0.09399274,
                                        0.31063777],
                             'mae': [0.009647916,
                                     0.010192515,
                                     0.011318488,
                                     0.011753726,
                                     0.011312,
                                     0.010614905,
                                     0.012176946,
                                     0.010806959,
                                     0.011551018,
                                     0.012154915,
                                     0.010566634,
                                     0.011262726,
                                     0.009839474,
                                     0.011218358,
                                     0.012001195,
                                     0.010711298,
                                     0.010330809,
                                     0.010750109,
                                     0.008412169,
                                     0.008529104,
                                     0.010941841,
                                     0.009241535],
                             'max_mae': 0.012176946,
                             'max_mse': 0.00036514437,
                             'max_rmse': 0.019108752,
                             'median_distance': 1.5774081,
                             'median_mae': 0.010778534,
                             'min_cosine': 0.0074208197,
                             'mse': [0.00019313168,
                                     0.0002456802,
                                     0.00033689127,
                                     0.00027180422,
                                     0.00029887006,
                                     0.00022116076,
                                     0.00035567937,
                                     0.0002333632,
                                     0.00026208782,
                                     0.00034544294,
                                     0.00023090343,
                                     0.00025198303,
                                     0.0001901883,
                                     0.00036514437,
                                     0.00029143706,
                                     0.00025498495,
                                     0.00022103207,
                                     0.00024567774,
                                     0.00014406742,
                                     0.0001642207,
                                     0.0003381544,
                                     0.00022998908],
                             'rmse': [0.013897182,
                                      0.015674189,
                                      0.018354598,
                                      0.016486486,
                                      0.017287858,
                                      0.014871475,
                                      0.018859463,
                                      0.01527623,
                                      0.016189126,
                                      0.018586095,
                                      0.015195507,
                                      0.015873974,
                                      0.013790878,
                                      0.019108752,
                                      0.017071528,
                                      0.015968248,
                                      0.014867147,
                                      0.01567411,
                                      0.012002809,
                                      0.012814863,
                                      0.018388975,
                                      0.01516539]},
 'residuals': {'mae': 0.010697029531002045,
               'mse': 0.00025872240075841546,
               'psnr': 11.32429027557373,
               'rmse': 0.01608484983444214,
               'ssds': [57.820404, 1.0256034],
               'ssim': 0.3383095860481262},
 'spectra_pcagan': {'cosine': [0.99874485,
                               0.9989302,
                               0.9988634,
                               0.99955565,
                               0.9990189,
                               0.9992806,
                               0.99923724,
                               0.99929243,
                               0.9996027,
                               0.9997596,
                               0.99960375,
                               0.9995225,
                               0.99922335,
                               0.9980702,
                               0.99763334,
                               0.9979978,
                               0.9666551,
                               0.99513066,
                               0.98605794,
                               0.9896623,
                               0.9953438,
                               0.9912136],
                    'mae': [0.016717946,
                            0.017757049,
                            0.017109167,
                            0.013824496,
                            0.016743692,
                            0.015703794,
                            0.015638042,
                            0.015715178,
                            0.013694015,
                            0.011834677,
                            0.012667685,
                            0.0139253475,
                            0.015926652,
                            0.018222641,
                            0.025222892,
                            0.01865232,
                            0.12166165,
                            0.022646988,
                            0.028413458,
                            0.021249646,
                            0.020206815,
                            0.02171208],
                    'max_mae': 0.12166165,
                    'max_mse': 0.015763963,
                    'max_rmse': 0.12555462,
                    'median_mae': 0.01692643,
                    'min_cosine': 0.9666551,
                    'mse': [0.0004523711,
                            0.00051382295,
                            0.00051581004,
                            0.00031405655,
                            0.0004668766,
                            0.00039255805,
                            0.00042532748,
                            0.00039424014,
                            0.00030273607,
                            0.00023659262,
                            0.00027297367,
                            0.0003143204,
                            0.00041297666,
                            0.0006057531,
                            0.0009972181,
                            0.0005823979,
                            0.015763963,
                            0.00086475076,
                            0.0012135372,
                            0.00078964804,
                            0.00078114326,
                            0.0008216618],
                    'rmse': [0.021269018,
                             0.022667663,
                             0.022711452,
                             0.01772164,
                             0.021607328,
                             0.019813078,
                             0.02062347,
                             0.01985548,
                             0.017399313,
                             0.015381567,
                             0.016521916,
                             0.017729083,
                             0.020321827,
                             0.024612052,
                             0.03157876,
                             0.024132922,
                             0.12555462,
                             0.029406644,
                             0.03483586,
                             0.028100677,
                             0.02794894,
                             0.028664643]},
 'spectra_realgan': {'cosine': [0.99874,
                                0.9989247,
                                0.9988628,
                                0.9995551,
                                0.9990175,
                                0.99927944,
                                0.999236,
                                0.9992909,
                                0.99960226,
                                0.99975944,
                                0.9996037,
                                0.99952215,
                                0.99922097,
                                0.99805784,
                                0.997614,
                                0.99797595,
                                0.9666729,
                                0.9949557,
                                0.9843059,
                                0.98795134,
                                0.99525464,
                                0.98986495],
                     'mae': [0.016758276,
                             0.017770711,
                             0.017112738,
                             0.013835871,
                             0.016758608,
                             0.01572735,
                             0.015651798,
                             0.01573359,
                             0.0136988405,
                             0.011841817,
                             0.012671857,
                             0.013935804,
                             0.015933895,
                             0.018292842,
                             0.02528515,
                             0.018783584,
                             0.12164892,
                             0.023066299,
                             0.029758139,
                             0.023322843,
                             0.02048743,
                             0.02360029],
                     'max_mae': 0.12164892,
                     'max_mse': 0.015762845,
                     'max_rmse': 0.12555017,
                     'median_mae': 0.016935673,
                     'min_cosine': 0.9666729,
                     'mse': [0.00045422188,
                             0.0005153609,
                             0.0005156602,
                             0.0003145151,
                             0.00046752824,
                             0.00039331385,
                             0.00042609978,
                             0.0003952325,
                             0.0003030318,
                             0.00023686624,
                             0.00027311375,
                             0.0003145904,
                             0.00041395874,
                             0.0006094857,
                             0.0010027568,
                             0.0005876446,
                             0.015762845,
                             0.0008939748,
                             0.0013501779,
                             0.00091971434,
                             0.00079522183,
                             0.00094914454],
                     'rmse': [0.021312483,
                              0.022701561,
                              0.022708153,
                              0.017734574,
                              0.0216224,
                              0.019832142,
                              0.020642184,
                              0.019880455,
                              0.017407808,
                              0.015390459,
                              0.016526153,
                              0.017736696,
                              0.020345977,
                              0.024687765,
                              0.031666335,
                              0.024241382,
                              0.12555017,
                              0.02989941,
                              0.036744766,
                              0.030326793,
                              0.028199678,
                              0.03080819]},
 'spectra_realpca': {'cosine': [0.99999386,
                                0.99999714,
                                0.9999981,
                                0.9999997,
                                0.999998,
                                0.99999845,
                                0.99999875,
                                0.99999815,
                                0.99999964,
                                0.9999999,
                                0.9999997,
                                0.99999964,
                                0.9999978,
                                0.9999857,
                                0.999987,
                                0.9999755,
                                0.99998814,
                                0.9998434,
                                0.99804324,
                                0.9981344,
                                0.9999162,
                                0.99858683],
                     'mae': [0.0011075969,
                             0.0008463398,
                             0.00069020526,
                             0.00035078355,
                             0.00073081953,
                             0.00069927244,
                             0.000647671,
                             0.00077206513,
                             0.00033129437,
                             0.0002400477,
                             0.0003150358,
                             0.00037708526,
                             0.00079852494,
                             0.0016572834,
                             0.0016061211,
                             0.0020261977,
                             0.0013684175,
                             0.0040035876,
                             0.0097010145,
                             0.0093962215,
                             0.00284301,
                             0.009104829],
                     'max_mae': 0.0097010145,
                     'max_mse': 0.00015194209,
                     'max_rmse': 0.012326479,
                     'median_mae': 0.00082243234,
                     'min_cosine': 0.99804324,
                     'mse': [1.9709657e-06,
                             1.1529575e-06,
                             7.660499e-07,
                             1.98227e-07,
                             8.585346e-07,
                             7.887549e-07,
                             6.646653e-07,
                             9.545251e-07,
                             1.7618862e-07,
                             9.3566356e-08,
                             1.6032695e-07,
                             2.2896855e-07,
                             1.0211955e-06,
                             4.40431e-06,
                             4.1512044e-06,
                             6.5759873e-06,
                             3.0162487e-06,
                             2.5457006e-05,
                             0.00015194209,
                             0.00014039446,
                             1.2956497e-05,
                             0.00013289497],
                     'rmse': [0.0014039109,
                              0.0010737586,
                              0.00087524275,
                              0.0004452269,
                              0.00092657143,
                              0.00088811875,
                              0.0008152701,
                              0.000976998,
                              0.00041974828,
                              0.00030588618,
                              0.00040040846,
                              0.00047850658,
                              0.0010105422,
                              0.0020986449,
                              0.0020374504,
                              0.0025643688,
                              0.0017367351,
                              0.0050454936,
                              0.012326479,
                              0.011848817,
                              0.0035995133,
                              0.011528009]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_65.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658
Directory path: experiments/inpainting/gann_4_night_20180904_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_65.0/images
Optimal number of principal components:  29
Reconstruction error:  8.21572
Energy conservation:  0.66402406
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_65.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9187742426194503, 2.2328952110415723],
                   'kl_div': 1.1006945,
                   'ks_tests': {10000: KstestResult(statistic=0.3145, pvalue=1e-323, statistic_location=0.0023310725, statistic_sign=1),
                                20000: KstestResult(statistic=0.3103, pvalue=0.0, statistic_location=0.0022737721, statistic_sign=1),
                                30000: KstestResult(statistic=0.3143666666666667, pvalue=0.0, statistic_location=0.0022227, statistic_sign=1),
                                40000: KstestResult(statistic=0.31862500000000005, pvalue=0.0, statistic_location=0.0020398851, statistic_sign=1),
                                50000: KstestResult(statistic=0.3145, pvalue=0.0, statistic_location=0.0025137875, statistic_sign=1),
                                60000: KstestResult(statistic=0.3139166666666666, pvalue=0.0, statistic_location=0.0021814425, statistic_sign=1),
                                70000: KstestResult(statistic=0.31337142857142863, pvalue=0.0, statistic_location=0.0023474721, statistic_sign=1),
                                80000: KstestResult(statistic=0.3142625, pvalue=0.0, statistic_location=0.0024722985, statistic_sign=1),
                                90000: KstestResult(statistic=0.31179999999999997, pvalue=0.0, statistic_location=0.0024756556, statistic_sign=1),
                                100000: KstestResult(statistic=0.3168599999999999, pvalue=0.0, statistic_location=0.002249898, statistic_sign=1),
                                110000: KstestResult(statistic=0.3132999999999999, pvalue=0.0, statistic_location=0.002311608, statistic_sign=1),
                                120000: KstestResult(statistic=0.3121499999999999, pvalue=0.0, statistic_location=0.0023563076, statistic_sign=1),
                                130000: KstestResult(statistic=0.313623076923077, pvalue=0.0, statistic_location=0.0021984242, statistic_sign=1),
                                140000: KstestResult(statistic=0.3143285714285715, pvalue=0.0, statistic_location=0.0023476575, statistic_sign=1),
                                150000: KstestResult(statistic=0.31066000000000005, pvalue=0.0, statistic_location=0.0024235253, statistic_sign=1),
                                160000: KstestResult(statistic=0.31425625, pvalue=0.0, statistic_location=0.0022825839, statistic_sign=1),
                                170000: KstestResult(statistic=0.31451764705882357, pvalue=0.0, statistic_location=0.0022225755, statistic_sign=1),
                                180000: KstestResult(statistic=0.3138833333333334, pvalue=0.0, statistic_location=0.0023530202, statistic_sign=1),
                                190000: KstestResult(statistic=0.3107578947368421, pvalue=0.0, statistic_location=0.0022985828, statistic_sign=1),
                                200000: KstestResult(statistic=0.31331, pvalue=0.0, statistic_location=0.0023108772, statistic_sign=1),
                                210000: KstestResult(statistic=0.31306190476190476, pvalue=0.0, statistic_location=0.0022211678, statistic_sign=1),
                                220000: KstestResult(statistic=0.3121454545454546, pvalue=0.0, statistic_location=0.0022194816, statistic_sign=1),
                                230000: KstestResult(statistic=0.31283478260869557, pvalue=0.0, statistic_location=0.002248475, statistic_sign=1),
                                240000: KstestResult(statistic=0.31419583333333334, pvalue=0.0, statistic_location=0.0022208407, statistic_sign=1),
                                250000: KstestResult(statistic=0.31362, pvalue=0.0, statistic_location=0.0022537792, statistic_sign=1),
                                260000: KstestResult(statistic=0.31446153846153846, pvalue=0.0, statistic_location=0.0022447184, statistic_sign=1),
                                270000: KstestResult(statistic=0.31322962962962964, pvalue=0.0, statistic_location=0.0023198607, statistic_sign=1),
                                280000: KstestResult(statistic=0.31398214285714277, pvalue=0.0, statistic_location=0.0022841173, statistic_sign=1),
                                290000: KstestResult(statistic=0.3143482758620689, pvalue=0.0, statistic_location=0.002298409, statistic_sign=1),
                                300000: KstestResult(statistic=0.31153, pvalue=0.0, statistic_location=0.0023585819, statistic_sign=1),
                                310000: KstestResult(statistic=0.31269354838709673, pvalue=0.0, statistic_location=0.002279758, statistic_sign=1),
                                320000: KstestResult(statistic=0.312590625, pvalue=0.0, statistic_location=0.002279663, statistic_sign=1),
                                330000: KstestResult(statistic=0.3127939393939394, pvalue=0.0, statistic_location=0.0022580912, statistic_sign=1)},
                   'moments': {'mean_error': 0.20556246,
                               'means': [0.00036934364, -7.468332e-06],
                               'stds': [0.015899327, 0.0032176804],
                               'variance_ratio': 21.910273}},
 'originals': {'gan': {'mae': 0.02468349225819111,
                       'mse': 0.0012824201257899404,
                       'psnr': 30.239980697631836,
                       'rmse': 0.03581089526414871,
                       'ssim': 0.911983847618103},
               'pca': {'mae': 0.0040687741711735725,
                       'mse': 5.568244159803726e-05,
                       'psnr': 44.26586151123047,
                       'rmse': 0.007462067063897848,
                       'ssim': 0.9983826875686646}},
 'reconstructions': {'mae': 0.0240945927798748,
                     'mse': 0.001226681750267744,
                     'psnr': 30.835731506347656,
                     'rmse': 0.035024017095565796,
                     'ssim': 0.9129639267921448},
 'residual_spectra_pcagan': {'cosine': [0.36008638,
                                        0.41282213,
                                        0.35997427,
                                        0.08306374,
                                        0.0697632,
                                        0.03071789,
                                        0.05356549,
                                        0.07535987,
                                        0.028497756,
                                        0.024194166,
                                        0.02337412,
                                        0.033251222,
                                        0.057384904,
                                        0.05013555,
                                        0.025810989,
                                        0.017876543,
                                        0.0031064972,
                                        0.029758587,
                                        0.044489995,
                                        0.08787982,
                                        0.089869194,
                                        0.041571423,
                                        0.056047454,
                                        0.1796565,
                                        0.38818458,
                                        0.350037,
                                        0.0954906,
                                        0.38932362,
                                        0.33928645,
                                        0.25827295,
                                        0.33930802,
                                        0.34075746,
                                        0.39708632],
                             'mae': [0.008744247,
                                     0.008023649,
                                     0.008359441,
                                     0.009776205,
                                     0.009364236,
                                     0.011153423,
                                     0.010570853,
                                     0.011432426,
                                     0.012336009,
                                     0.01260292,
                                     0.011016228,
                                     0.01099888,
                                     0.011485741,
                                     0.010216718,
                                     0.011370993,
                                     0.01147129,
                                     0.011449962,
                                     0.010747612,
                                     0.009350273,
                                     0.00975323,
                                     0.008832885,
                                     0.012350348,
                                     0.009942836,
                                     0.010077071,
                                     0.008558201,
                                     0.008747656,
                                     0.010942746,
                                     0.008118277,
                                     0.00928342,
                                     0.0102823805,
                                     0.009114175,
                                     0.009748429,
                                     0.0081230765],
                             'max_mae': 0.01260292,
                             'max_mse': 0.00047203194,
                             'max_rmse': 0.021726295,
                             'median_distance': 1.5008718,
                             'median_mae': 0.010077071,
                             'min_cosine': 0.0031064972,
                             'mse': [0.00021046832,
                                     0.00014776783,
                                     0.00018778768,
                                     0.00019823777,
                                     0.00016906603,
                                     0.00030915142,
                                     0.0002173607,
                                     0.00029611305,
                                     0.00047203194,
                                     0.0003488851,
                                     0.00028533614,
                                     0.00025758363,
                                     0.0002982989,
                                     0.00020223609,
                                     0.00026330556,
                                     0.00027611371,
                                     0.0002906897,
                                     0.00023321602,
                                     0.00016673892,
                                     0.00018487063,
                                     0.00014530227,
                                     0.00037929084,
                                     0.00019934057,
                                     0.00023198112,
                                     0.00016024408,
                                     0.0001791881,
                                     0.00034002162,
                                     0.0001517199,
                                     0.0002252616,
                                     0.00038986056,
                                     0.00023690844,
                                     0.00020909049,
                                     0.00014816671],
                             'rmse': [0.0145075265,
                                      0.012155979,
                                      0.013703564,
                                      0.014079694,
                                      0.013002539,
                                      0.017582702,
                                      0.014743158,
                                      0.017207935,
                                      0.021726295,
                                      0.018678466,
                                      0.016891895,
                                      0.016049411,
                                      0.017271332,
                                      0.0142209735,
                                      0.016226692,
                                      0.01661667,
                                      0.017049626,
                                      0.015271412,
                                      0.012912743,
                                      0.013596714,
                                      0.012054139,
                                      0.019475391,
                                      0.014118802,
                                      0.015230927,
                                      0.012658755,
                                      0.013386115,
                                      0.018439675,
                                      0.012317463,
                                      0.015008718,
                                      0.019744888,
                                      0.01539183,
                                      0.014459962,
                                      0.012172375]},
 'residuals': {'mae': 0.01013169251382351,
               'mse': 0.000242776790400967,
               'psnr': 12.573671340942383,
               'rmse': 0.01558129582554102,
               'ssds': [83.46498, 3.416652],
               'ssim': 0.3808039426803589},
 'spectra_pcagan': {'cosine': [0.98403656,
                               0.98669046,
                               0.98370135,
                               0.9987031,
                               0.9987714,
                               0.9986992,
                               0.9982833,
                               0.99867964,
                               0.99838394,
                               0.99947155,
                               0.9990599,
                               0.99915886,
                               0.99931866,
                               0.9992595,
                               0.999595,
                               0.9997633,
                               0.99955946,
                               0.99957746,
                               0.99922377,
                               0.99849135,
                               0.9986845,
                               0.99774784,
                               0.9669835,
                               0.9956776,
                               0.9858884,
                               0.98257947,
                               0.9941563,
                               0.9904649,
                               0.9770033,
                               0.9793644,
                               0.9887921,
                               0.9854615,
                               0.9840633],
                    'mae': [0.027469775,
                            0.024847034,
                            0.025789188,
                            0.016649298,
                            0.017323706,
                            0.01793141,
                            0.02316953,
                            0.017603211,
                            0.020318951,
                            0.014703485,
                            0.016863266,
                            0.016436731,
                            0.015127216,
                            0.01540172,
                            0.013862536,
                            0.012074447,
                            0.013570233,
                            0.013173032,
                            0.015757907,
                            0.017236652,
                            0.01607594,
                            0.021078553,
                            0.119021095,
                            0.020074893,
                            0.027528295,
                            0.030028977,
                            0.022437792,
                            0.025842974,
                            0.04097729,
                            0.037693303,
                            0.022804266,
                            0.027612524,
                            0.028636422],
                    'max_mae': 0.119021095,
                    'max_mse': 0.015220352,
                    'max_rmse': 0.12337079,
                    'median_mae': 0.020074893,
                    'min_cosine': 0.9669835,
                    'mse': [0.0012346504,
                            0.001019891,
                            0.0011184756,
                            0.0004665774,
                            0.00047993756,
                            0.0005566999,
                            0.0008018295,
                            0.00054060813,
                            0.0007699977,
                            0.0003837535,
                            0.0004755353,
                            0.0004378818,
                            0.00039144696,
                            0.000396542,
                            0.00030853963,
                            0.0002435373,
                            0.00030754143,
                            0.000277817,
                            0.00040827456,
                            0.00048400863,
                            0.00041931254,
                            0.0007665756,
                            0.015220352,
                            0.0007026584,
                            0.0011298971,
                            0.0013244755,
                            0.00090215605,
                            0.0010103481,
                            0.0022736324,
                            0.0023376455,
                            0.00090744515,
                            0.0011518722,
                            0.0012305811],
                    'rmse': [0.035137594,
                             0.031935733,
                             0.03344362,
                             0.021600403,
                             0.021907477,
                             0.023594487,
                             0.028316595,
                             0.023250982,
                             0.027748832,
                             0.019589627,
                             0.021806771,
                             0.020925626,
                             0.019785019,
                             0.019913362,
                             0.017565297,
                             0.015605682,
                             0.01753686,
                             0.016667843,
                             0.020205805,
                             0.022000195,
                             0.020477122,
                             0.027687103,
                             0.12337079,
                             0.026507704,
                             0.033613943,
                             0.036393344,
                             0.030035913,
                             0.031785972,
                             0.04768262,
                             0.048349205,
                             0.03012383,
                             0.033939242,
                             0.03507964]},
 'spectra_realgan': {'cosine': [0.9814176,
                                0.9843973,
                                0.98138136,
                                0.9986946,
                                0.9987651,
                                0.99869525,
                                0.99827707,
                                0.9986742,
                                0.998383,
                                0.99947107,
                                0.99905777,
                                0.99915767,
                                0.9993173,
                                0.9992574,
                                0.9995946,
                                0.9997632,
                                0.9995594,
                                0.9995768,
                                0.99922174,
                                0.99847776,
                                0.9986741,
                                0.9977264,
                                0.967004,
                                0.9954849,
                                0.98399085,
                                0.9809019,
                                0.9940693,
                                0.9890101,
                                0.97492063,
                                0.97704434,
                                0.9866518,
                                0.983715,
                                0.98208505],
                     'mae': [0.029628504,
                             0.02700228,
                             0.027750049,
                             0.016724963,
                             0.01736097,
                             0.017963937,
                             0.023198536,
                             0.017638812,
                             0.020329492,
                             0.0147159025,
                             0.01687589,
                             0.016449261,
                             0.015146681,
                             0.015429585,
                             0.013867978,
                             0.012076131,
                             0.013570889,
                             0.0131820785,
                             0.01576691,
                             0.017303094,
                             0.016132511,
                             0.02117235,
                             0.11901435,
                             0.020584386,
                             0.029043375,
                             0.031275105,
                             0.022661641,
                             0.027385306,
                             0.041743476,
                             0.0392853,
                             0.025128022,
                             0.02908134,
                             0.030066114],
                     'max_mae': 0.11901435,
                     'max_mse': 0.0152186435,
                     'max_rmse': 0.12336387,
                     'median_mae': 0.020329492,
                     'min_cosine': 0.967004,
                     'mse': [0.0014244368,
                             0.0011916814,
                             0.0012814328,
                             0.00047000928,
                             0.00048252012,
                             0.00055835187,
                             0.00080453337,
                             0.00054252474,
                             0.00076979765,
                             0.00038417958,
                             0.00047643346,
                             0.00043857828,
                             0.00039242857,
                             0.00039765792,
                             0.00030882162,
                             0.00024363809,
                             0.00030758217,
                             0.00027812924,
                             0.00040911845,
                             0.00048807907,
                             0.00042269577,
                             0.0007709878,
                             0.0152186435,
                             0.0007337465,
                             0.0012791628,
                             0.001453272,
                             0.0009157299,
                             0.0011495681,
                             0.0024376858,
                             0.0025422527,
                             0.0010732939,
                             0.0012943285,
                             0.0013785596],
                     'rmse': [0.037741713,
                              0.034520738,
                              0.035797108,
                              0.021679698,
                              0.02196634,
                              0.02362947,
                              0.028364297,
                              0.02329216,
                              0.027745228,
                              0.0196005,
                              0.021827355,
                              0.020942261,
                              0.01980981,
                              0.019941362,
                              0.017573321,
                              0.0156089105,
                              0.01753802,
                              0.016677206,
                              0.020226676,
                              0.022092512,
                              0.020559566,
                              0.027766667,
                              0.12336387,
                              0.027087756,
                              0.035765387,
                              0.038121805,
                              0.03026103,
                              0.033905283,
                              0.049372926,
                              0.050420757,
                              0.032761164,
                              0.03597678,
                              0.03712896]},
 'spectra_realpca': {'cosine': [0.99756175,
                                0.9977683,
                                0.99759567,
                                0.9999948,
                                0.9999946,
                                0.9999979,
                                0.99999386,
                                0.99999714,
                                0.9999981,
                                0.9999997,
                                0.999998,
                                0.99999845,
                                0.99999875,
                                0.99999815,
                                0.99999964,
                                0.9999999,
                                0.9999997,
                                0.99999964,
                                0.9999978,
                                0.9999857,
                                0.999987,
                                0.9999755,
                                0.99998814,
                                0.9998434,
                                0.99804324,
                                0.9981344,
                                0.9999162,
                                0.99858683,
                                0.9978835,
                                0.9976822,
                                0.99788016,
                                0.99803877,
                                0.99788755],
                     'mae': [0.010442406,
                             0.010068124,
                             0.010220705,
                             0.0010329329,
                             0.0010921175,
                             0.00074581977,
                             0.0011075969,
                             0.0008463398,
                             0.00069020526,
                             0.00035078355,
                             0.00073081953,
                             0.00069927244,
                             0.000647671,
                             0.00077206513,
                             0.00033129437,
                             0.0002400477,
                             0.0003150358,
                             0.00037708526,
                             0.00079852494,
                             0.0016572834,
                             0.0016061211,
                             0.0020261977,
                             0.0013684175,
                             0.0040035876,
                             0.0097010145,
                             0.0093962215,
                             0.00284301,
                             0.009104829,
                             0.009976559,
                             0.011151462,
                             0.010153674,
                             0.009924429,
                             0.009847878],
                     'max_mae': 0.011151462,
                     'max_mse': 0.00019917665,
                     'max_rmse': 0.014112996,
                     'median_mae': 0.0013684175,
                     'min_cosine': 0.99756175,
                     'mse': [0.0001741029,
                             0.00016477135,
                             0.00016683846,
                             1.704216e-06,
                             1.9142246e-06,
                             8.828598e-07,
                             1.9709657e-06,
                             1.1529575e-06,
                             7.660499e-07,
                             1.98227e-07,
                             8.585346e-07,
                             7.887549e-07,
                             6.646653e-07,
                             9.545251e-07,
                             1.7618862e-07,
                             9.3566356e-08,
                             1.6032695e-07,
                             2.2896855e-07,
                             1.0211955e-06,
                             4.40431e-06,
                             4.1512044e-06,
                             6.5759873e-06,
                             3.0162487e-06,
                             2.5457006e-05,
                             0.00015194209,
                             0.00014039446,
                             1.2956497e-05,
                             0.00013289497,
                             0.00015973831,
                             0.00019917665,
                             0.00016539033,
                             0.00015676508,
                             0.00015540865],
                     'rmse': [0.013194806,
                              0.01283633,
                              0.012916597,
                              0.0013054563,
                              0.0013835551,
                              0.0009396062,
                              0.0014039109,
                              0.0010737586,
                              0.00087524275,
                              0.0004452269,
                              0.00092657143,
                              0.00088811875,
                              0.0008152701,
                              0.000976998,
                              0.00041974828,
                              0.00030588618,
                              0.00040040846,
                              0.00047850658,
                              0.0010105422,
                              0.0020986449,
                              0.0020374504,
                              0.0025643688,
                              0.0017367351,
                              0.0050454936,
                              0.012326479,
                              0.011848817,
                              0.0035995133,
                              0.011528009,
                              0.012638763,
                              0.014112996,
                              0.012860417,
                              0.012520586,
                              0.0124663]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_65.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734
Directory path: experiments/inpainting/gann_4_night_20210905_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_65.0/images
Optimal number of principal components:  31
Reconstruction error:  5.9583387
Energy conservation:  0.6607108
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_65.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.8998554886731998, 2.5650369934302595],
                   'kl_div': 0.7568063,
                   'ks_tests': {10000: KstestResult(statistic=0.2798, pvalue=1e-323, statistic_location=-0.004308121, statistic_sign=-1),
                                20000: KstestResult(statistic=0.2769, pvalue=0.0, statistic_location=-0.0038520675, statistic_sign=-1),
                                30000: KstestResult(statistic=0.27153333333333335, pvalue=0.0, statistic_location=-0.0041561127, statistic_sign=-1),
                                40000: KstestResult(statistic=0.278625, pvalue=0.0, statistic_location=-0.004193639, statistic_sign=-1),
                                50000: KstestResult(statistic=0.27656000000000003, pvalue=0.0, statistic_location=-0.004188789, statistic_sign=-1),
                                60000: KstestResult(statistic=0.2785, pvalue=0.0, statistic_location=-0.0042759674, statistic_sign=-1),
                                70000: KstestResult(statistic=0.27304285714285714, pvalue=0.0, statistic_location=-0.0041952254, statistic_sign=-1),
                                80000: KstestResult(statistic=0.278275, pvalue=0.0, statistic_location=-0.0040234104, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2738333333333333, pvalue=0.0, statistic_location=-0.0039963843, statistic_sign=-1),
                                100000: KstestResult(statistic=0.27688999999999997, pvalue=0.0, statistic_location=-0.0045354203, statistic_sign=-1),
                                110000: KstestResult(statistic=0.27766363636363633, pvalue=0.0, statistic_location=-0.0040555336, statistic_sign=-1)},
                   'moments': {'mean_error': -0.34887296,
                               'means': [-0.0013864677, 8.459068e-06],
                               'stds': [0.016771028, 0.003407324],
                               'variance_ratio': 18.196287}},
 'originals': {'gan': {'mae': 0.0230482816696167,
                       'mse': 0.0009045737679116428,
                       'psnr': 30.321165084838867,
                       'rmse': 0.030076133087277412,
                       'ssim': 0.9525884985923767},
               'pca': {'mae': 0.00536742340773344,
                       'mse': 6.241806113393977e-05,
                       'psnr': 42.42479705810547,
                       'rmse': 0.007900509983301163,
                       'ssim': 0.9968135952949524}},
 'reconstructions': {'mae': 0.022181229665875435,
                     'mse': 0.0008420856902375817,
                     'psnr': 31.124338150024414,
                     'rmse': 0.029018713161349297,
                     'ssim': 0.9555263519287109},
 'residual_spectra_pcagan': {'cosine': [0.06450167,
                                        0.038480606,
                                        0.060264032,
                                        0.16467783,
                                        0.11790473,
                                        0.1889627,
                                        0.256142,
                                        0.31669253,
                                        0.2506617,
                                        0.2934452,
                                        0.2586343],
                             'mae': [0.010572846,
                                     0.011929464,
                                     0.010133696,
                                     0.010983413,
                                     0.011032082,
                                     0.009713887,
                                     0.009984106,
                                     0.0084004365,
                                     0.009415866,
                                     0.010283616,
                                     0.010357154],
                             'max_mae': 0.011929464,
                             'max_mse': 0.00040199014,
                             'max_rmse': 0.020049691,
                             'median_distance': 1.6362227,
                             'median_mae': 0.010283616,
                             'min_cosine': 0.038480606,
                             'mse': [0.00023311436,
                                     0.00037887105,
                                     0.00023575459,
                                     0.0002732905,
                                     0.00040199014,
                                     0.0002677225,
                                     0.00023189945,
                                     0.00015743166,
                                     0.0002914706,
                                     0.00024064205,
                                     0.00028185215],
                             'rmse': [0.015268083,
                                      0.01946461,
                                      0.015354302,
                                      0.016531501,
                                      0.020049691,
                                      0.016362227,
                                      0.015228245,
                                      0.012547177,
                                      0.01707251,
                                      0.0155126415,
                                      0.016788453]},
 'residuals': {'mae': 0.010255142115056515,
               'mse': 0.0002721853379625827,
               'psnr': 8.301422119140625,
               'rmse': 0.016498040407896042,
               'ssds': [31.150585, 1.2770805],
               'ssim': 0.3387376070022583},
 'spectra_pcagan': {'cosine': [0.99846345,
                               0.99866104,
                               0.9980869,
                               0.9955916,
                               0.994395,
                               0.9960728,
                               0.9849383,
                               0.9856675,
                               0.9871598,
                               0.98828936,
                               0.989591],
                    'mae': [0.017720541,
                            0.017553903,
                            0.017618403,
                            0.024437258,
                            0.02331512,
                            0.019432148,
                            0.026361365,
                            0.025685346,
                            0.023323426,
                            0.023348415,
                            0.025197601],
                    'max_mae': 0.026361365,
                    'max_mse': 0.0011331578,
                    'max_rmse': 0.03366241,
                    'median_mae': 0.023323426,
                    'min_cosine': 0.9849383,
                    'mse': [0.00052482623,
                            0.0005371953,
                            0.00051507814,
                            0.00097158755,
                            0.00090359,
                            0.00068714406,
                            0.0011331578,
                            0.0010411721,
                            0.0009544931,
                            0.0009439637,
                            0.0010507349],
                    'rmse': [0.022909086,
                             0.023177475,
                             0.022695333,
                             0.0311703,
                             0.030059773,
                             0.026213434,
                             0.03366241,
                             0.032267198,
                             0.030894872,
                             0.030723993,
                             0.03241504]},
 'spectra_realgan': {'cosine': [0.99845797,
                                0.99865544,
                                0.99807423,
                                0.99538565,
                                0.9942761,
                                0.99583805,
                                0.983467,
                                0.9838163,
                                0.98543966,
                                0.98703045,
                                0.9884631],
                     'mae': [0.017760888,
                             0.017581698,
                             0.017672965,
                             0.024944259,
                             0.023610031,
                             0.02020955,
                             0.027729604,
                             0.027509531,
                             0.02518396,
                             0.024925869,
                             0.02640274],
                     'max_mae': 0.027729604,
                     'max_mse': 0.0012457673,
                     'max_rmse': 0.03529543,
                     'median_mae': 0.024925869,
                     'min_cosine': 0.983467,
                     'mse': [0.0005266277,
                             0.00053919153,
                             0.0005184781,
                             0.0010091306,
                             0.0009227267,
                             0.0007264141,
                             0.0012457673,
                             0.0011788851,
                             0.0010823946,
                             0.0010480658,
                             0.0011526301],
                     'rmse': [0.022948371,
                              0.023220498,
                              0.022770114,
                              0.031766817,
                              0.030376418,
                              0.026952071,
                              0.03529543,
                              0.034334898,
                              0.032899767,
                              0.032373846,
                              0.033950407]},
 'spectra_realpca': {'cosine': [0.99999326,
                                0.9999966,
                                0.9999901,
                                0.99980736,
                                0.99991435,
                                0.99974716,
                                0.9983853,
                                0.99830335,
                                0.99835104,
                                0.9985456,
                                0.9988177],
                     'mae': [0.0011779757,
                             0.00091623125,
                             0.0012816523,
                             0.0045699165,
                             0.0029260365,
                             0.0050996644,
                             0.0087483805,
                             0.008812489,
                             0.008727003,
                             0.008573349,
                             0.008208961],
                     'max_mae': 0.008812489,
                     'max_mse': 0.00012448007,
                     'max_rmse': 0.011157064,
                     'median_mae': 0.0050996644,
                     'min_cosine': 0.99830335,
                     'mse': [2.2280067e-06,
                             1.3391204e-06,
                             2.6489433e-06,
                             3.346457e-05,
                             1.3749911e-05,
                             4.1788287e-05,
                             0.00012243602,
                             0.00012448007,
                             0.00012156526,
                             0.00011623578,
                             0.00010666266],
                     'rmse': [0.001492651,
                              0.0011572037,
                              0.0016275574,
                              0.005784857,
                              0.0037080871,
                              0.006464386,
                              0.011065081,
                              0.011157064,
                              0.011025663,
                              0.0107812695,
                              0.010327761]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_65.0

Running comparison for experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726
Directory path: experiments/inpainting/gann_4_night_20210905_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_65.0/images
Optimal number of principal components:  31
Reconstruction error:  5.9583387
Energy conservation:  0.6607108
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_65.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9022391383209563, 2.607567038665393],
                   'kl_div': 0.71085966,
                   'ks_tests': {10000: KstestResult(statistic=0.2707, pvalue=1.2e-322, statistic_location=-0.0039727353, statistic_sign=-1),
                                20000: KstestResult(statistic=0.28165, pvalue=0.0, statistic_location=-0.004369435, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2719, pvalue=0.0, statistic_location=-0.0044959467, statistic_sign=-1),
                                40000: KstestResult(statistic=0.27255, pvalue=0.0, statistic_location=-0.0046584643, statistic_sign=-1),
                                50000: KstestResult(statistic=0.27856, pvalue=0.0, statistic_location=-0.0045384946, statistic_sign=-1),
                                60000: KstestResult(statistic=0.2738166666666667, pvalue=0.0, statistic_location=-0.0044031143, statistic_sign=-1),
                                70000: KstestResult(statistic=0.27337142857142854, pvalue=0.0, statistic_location=-0.0045011044, statistic_sign=-1),
                                80000: KstestResult(statistic=0.27435, pvalue=0.0, statistic_location=-0.0045848796, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2739111111111111, pvalue=0.0, statistic_location=-0.004508976, statistic_sign=-1),
                                100000: KstestResult(statistic=0.27418000000000003, pvalue=0.0, statistic_location=-0.0045017162, statistic_sign=-1),
                                110000: KstestResult(statistic=0.27299090909090906, pvalue=0.0, statistic_location=-0.0046108095, statistic_sign=-1),
                                120000: KstestResult(statistic=0.27395, pvalue=0.0, statistic_location=-0.0044986745, statistic_sign=-1),
                                130000: KstestResult(statistic=0.2725384615384615, pvalue=0.0, statistic_location=-0.004588669, statistic_sign=-1),
                                140000: KstestResult(statistic=0.27287142857142854, pvalue=0.0, statistic_location=-0.004424654, statistic_sign=-1),
                                150000: KstestResult(statistic=0.27542, pvalue=0.0, statistic_location=-0.004500497, statistic_sign=-1),
                                160000: KstestResult(statistic=0.27318125, pvalue=0.0, statistic_location=-0.0046624728, statistic_sign=-1),
                                170000: KstestResult(statistic=0.27141764705882354, pvalue=0.0, statistic_location=-0.004546293, statistic_sign=-1),
                                180000: KstestResult(statistic=0.2729222222222222, pvalue=0.0, statistic_location=-0.004621133, statistic_sign=-1),
                                190000: KstestResult(statistic=0.27227894736842106, pvalue=0.0, statistic_location=-0.0045023747, statistic_sign=-1),
                                200000: KstestResult(statistic=0.27266999999999997, pvalue=0.0, statistic_location=-0.004587474, statistic_sign=-1),
                                210000: KstestResult(statistic=0.27308095238095237, pvalue=0.0, statistic_location=-0.0046211067, statistic_sign=-1),
                                220000: KstestResult(statistic=0.27325454545454547, pvalue=0.0, statistic_location=-0.004508976, statistic_sign=-1)},
                   'moments': {'mean_error': -0.32335982,
                               'means': [-0.0014589109, 1.8532734e-06],
                               'stds': [0.01597184, 0.003569635],
                               'variance_ratio': 15.05885}},
 'originals': {'gan': {'mae': 0.029287617653608322,
                       'mse': 0.001597834867425263,
                       'psnr': 30.15612030029297,
                       'rmse': 0.039972927421331406,
                       'ssim': 0.841049313545227},
               'pca': {'mae': 0.006054113619029522,
                       'mse': 7.932088919915259e-05,
                       'psnr': 43.24998092651367,
                       'rmse': 0.0089062275364995,
                       'ssim': 0.9927018284797668}},
 'reconstructions': {'mae': 0.028336340561509132,
                     'mse': 0.0015200156485661864,
                     'psnr': 30.42537498474121,
                     'rmse': 0.038987379521131516,
                     'ssim': 0.8439077138900757},
 'residual_spectra_pcagan': {'cosine': [0.2868544,
                                        0.21273597,
                                        0.042448517,
                                        0.03501098,
                                        0.056127906,
                                        0.05964541,
                                        0.04018985,
                                        0.07095069,
                                        0.17699616,
                                        0.13122483,
                                        0.22494602,
                                        0.29222593,
                                        0.35514474,
                                        0.2602485,
                                        0.29460832,
                                        0.27592552,
                                        0.27609873,
                                        0.26661742,
                                        0.3227772,
                                        0.31967965,
                                        0.25661623,
                                        0.23693363],
                             'mae': [0.00960541,
                                     0.009501337,
                                     0.011746742,
                                     0.012689076,
                                     0.011126469,
                                     0.009939952,
                                     0.011323065,
                                     0.009618909,
                                     0.010558771,
                                     0.010888321,
                                     0.009043665,
                                     0.009301116,
                                     0.007858102,
                                     0.009258995,
                                     0.010280089,
                                     0.0098919505,
                                     0.008432917,
                                     0.010403915,
                                     0.008516788,
                                     0.008724985,
                                     0.0101617575,
                                     0.0109392125],
                             'max_mae': 0.012689076,
                             'max_mse': 0.0004084178,
                             'max_rmse': 0.02020935,
                             'median_distance': 1.5660608,
                             'median_mae': 0.009915952,
                             'min_cosine': 0.03501098,
                             'mse': [0.0002005529,
                                     0.00025032245,
                                     0.0004084178,
                                     0.00031510636,
                                     0.00029170047,
                                     0.000198834,
                                     0.00032219768,
                                     0.00019487273,
                                     0.00024154506,
                                     0.00034451528,
                                     0.000206273,
                                     0.0001749376,
                                     0.00012358278,
                                     0.00026244044,
                                     0.00024334101,
                                     0.00024745433,
                                     0.00021123109,
                                     0.00024717572,
                                     0.00015035275,
                                     0.00017721555,
                                     0.00030751934,
                                     0.0002736551],
                             'rmse': [0.01416167,
                                      0.015821582,
                                      0.02020935,
                                      0.017751236,
                                      0.017079242,
                                      0.014100851,
                                      0.017949866,
                                      0.013959683,
                                      0.01554172,
                                      0.018561123,
                                      0.014362208,
                                      0.013226397,
                                      0.011116779,
                                      0.016200013,
                                      0.015599391,
                                      0.01573068,
                                      0.014533792,
                                      0.015721822,
                                      0.012261841,
                                      0.013312234,
                                      0.017536229,
                                      0.016542524]},
 'residuals': {'mae': 0.009991434402763844,
               'mse': 0.0002451474138069898,
               'psnr': 15.034449577331543,
               'rmse': 0.01565718464553356,
               'ssds': [56.58993, 2.8032928],
               'ssim': 0.3834158778190613},
 'spectra_pcagan': {'cosine': [0.99195117,
                               0.990978,
                               0.9871897,
                               0.99796784,
                               0.9989055,
                               0.9984691,
                               0.99860954,
                               0.99805397,
                               0.9954133,
                               0.9937773,
                               0.9960485,
                               0.98474306,
                               0.98547906,
                               0.9863872,
                               0.98717636,
                               0.9884928,
                               0.98984134,
                               0.9818945,
                               0.9905792,
                               0.9921602,
                               0.9876321,
                               0.9865551],
                    'mae': [0.03253363,
                            0.02480037,
                            0.10233207,
                            0.023034995,
                            0.018330447,
                            0.017627545,
                            0.017858453,
                            0.017891154,
                            0.024880841,
                            0.025036959,
                            0.020457197,
                            0.026711224,
                            0.026122516,
                            0.024424274,
                            0.024910765,
                            0.025791332,
                            0.024410855,
                            0.03185233,
                            0.02804414,
                            0.027042245,
                            0.028358283,
                            0.030947926],
                    'max_mae': 0.10233207,
                    'max_mse': 0.01133159,
                    'max_rmse': 0.10644994,
                    'median_mae': 0.024973862,
                    'min_cosine': 0.9818945,
                    'mse': [0.0014921526,
                            0.0010362033,
                            0.01133159,
                            0.0008593363,
                            0.0005650519,
                            0.0005182844,
                            0.0005547552,
                            0.00052909786,
                            0.0009938492,
                            0.0010091865,
                            0.0007327677,
                            0.0011463539,
                            0.0010598336,
                            0.0010350128,
                            0.0010497167,
                            0.0010920926,
                            0.0010318186,
                            0.0016837677,
                            0.0013553131,
                            0.0013115056,
                            0.0014328538,
                            0.0016198048],
                    'rmse': [0.038628392,
                             0.032190114,
                             0.10644994,
                             0.029314438,
                             0.02377082,
                             0.02276586,
                             0.023553243,
                             0.023002127,
                             0.031525373,
                             0.031767696,
                             0.027069682,
                             0.03385785,
                             0.032555085,
                             0.032171614,
                             0.032399334,
                             0.033046823,
                             0.032121934,
                             0.041033737,
                             0.036814578,
                             0.036214713,
                             0.037853055,
                             0.0402468]},
 'spectra_realgan': {'cosine': [0.9912336,
                                0.99026203,
                                0.9871945,
                                0.99796146,
                                0.99890083,
                                0.9984643,
                                0.9986038,
                                0.998041,
                                0.9952042,
                                0.99365604,
                                0.9958092,
                                0.98329645,
                                0.9835995,
                                0.9846977,
                                0.98593867,
                                0.9873876,
                                0.988223,
                                0.9803028,
                                0.9895245,
                                0.9912506,
                                0.9861601,
                                0.9852595],
                     'mae': [0.03329359,
                             0.025828274,
                             0.10231925,
                             0.023086227,
                             0.018353626,
                             0.017655553,
                             0.017890245,
                             0.017943805,
                             0.025359012,
                             0.025302539,
                             0.021158887,
                             0.028,
                             0.027902283,
                             0.026169024,
                             0.026348945,
                             0.026939694,
                             0.026174989,
                             0.033333894,
                             0.02974317,
                             0.029067956,
                             0.029867144,
                             0.032589473],
                     'max_mae': 0.10231925,
                     'max_mse': 0.011328931,
                     'max_rmse': 0.10643745,
                     'median_mae': 0.026261967,
                     'min_cosine': 0.9803028,
                     'mse': [0.001588687,
                             0.001112226,
                             0.011328931,
                             0.0008625765,
                             0.0005671638,
                             0.0005198472,
                             0.00055676664,
                             0.0005326463,
                             0.0010319065,
                             0.0010287457,
                             0.0007730381,
                             0.0012569604,
                             0.0011995457,
                             0.0011607124,
                             0.0011528946,
                             0.0011925157,
                             0.001162743,
                             0.0018269913,
                             0.001506282,
                             0.0014590365,
                             0.0015643099,
                             0.0017678385],
                     'rmse': [0.039858337,
                              0.033350054,
                              0.10643745,
                              0.029369652,
                              0.023815202,
                              0.022800159,
                              0.023595903,
                              0.02307913,
                              0.0321233,
                              0.032074064,
                              0.027803563,
                              0.035453636,
                              0.03463446,
                              0.03406923,
                              0.0339543,
                              0.034532823,
                              0.034099016,
                              0.042743318,
                              0.03881085,
                              0.038197335,
                              0.03955136,
                              0.04204567]},
 'spectra_realpca': {'cosine': [0.9993712,
                                0.99922585,
                                0.99999803,
                                0.99999726,
                                0.9999966,
                                0.99999326,
                                0.9999966,
                                0.9999901,
                                0.99980736,
                                0.99991435,
                                0.99974716,
                                0.9983853,
                                0.99830335,
                                0.99835104,
                                0.9985456,
                                0.9988177,
                                0.99835575,
                                0.99842083,
                                0.99883866,
                                0.99901855,
                                0.9984479,
                                0.99866664],
                     'mae': [0.0070559517,
                             0.0071046706,
                             0.0006354302,
                             0.0007782336,
                             0.0009592189,
                             0.0011779757,
                             0.00091623125,
                             0.0012816523,
                             0.0045699165,
                             0.0029260365,
                             0.0050996644,
                             0.0087483805,
                             0.008812489,
                             0.008727003,
                             0.008573349,
                             0.008208961,
                             0.009139615,
                             0.0093117505,
                             0.009977932,
                             0.010028896,
                             0.009434551,
                             0.009722602],
                     'max_mae': 0.010028896,
                     'max_mse': 0.00016441615,
                     'max_rmse': 0.012822486,
                     'median_mae': 0.007656816,
                     'min_cosine': 0.99830335,
                     'mse': [8.010098e-05,
                             8.0830905e-05,
                             6.456539e-07,
                             9.662139e-07,
                             1.483319e-06,
                             2.2280067e-06,
                             1.3391204e-06,
                             2.6489433e-06,
                             3.346457e-05,
                             1.3749911e-05,
                             4.1788287e-05,
                             0.00012243602,
                             0.00012448007,
                             0.00012156526,
                             0.00011623578,
                             0.00010666266,
                             0.0001342123,
                             0.00013979574,
                             0.00016441615,
                             0.0001623811,
                             0.00014208525,
                             0.00015154328],
                     'rmse': [0.008949915,
                              0.008990601,
                              0.0008035259,
                              0.0009829617,
                              0.0012179158,
                              0.001492651,
                              0.0011572037,
                              0.0016275574,
                              0.005784857,
                              0.0037080871,
                              0.006464386,
                              0.011065081,
                              0.011157064,
                              0.011025663,
                              0.0107812695,
                              0.010327761,
                              0.011585003,
                              0.011823525,
                              0.012822486,
                              0.012742884,
                              0.011919952,
                              0.012310292]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_65.0

Running comparison for experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226
Directory path: experiments/inpainting/gann_4_night_20210905_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 65.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_65.0/images
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_65.0/images
Optimal number of principal components:  31
Reconstruction error:  5.9583387
Energy conservation:  0.6607108
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_65.0
saved spectra in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_65.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_65.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_65.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.867696224533345, 2.5264696582070254],
                   'kl_div': 0.74857634,
                   'ks_tests': {10000: KstestResult(statistic=0.2666, pvalue=7.50130739086e-313, statistic_location=-0.0038659945, statistic_sign=-1),
                                20000: KstestResult(statistic=0.25875000000000004, pvalue=0.0, statistic_location=-0.003984579, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2617, pvalue=0.0, statistic_location=-0.004266763, statistic_sign=-1),
                                40000: KstestResult(statistic=0.266775, pvalue=0.0, statistic_location=-0.0037945136, statistic_sign=-1),
                                50000: KstestResult(statistic=0.26376, pvalue=0.0, statistic_location=-0.0040697763, statistic_sign=-1),
                                60000: KstestResult(statistic=0.2665666666666667, pvalue=0.0, statistic_location=-0.0038806119, statistic_sign=-1),
                                70000: KstestResult(statistic=0.2623857142857143, pvalue=0.0, statistic_location=-0.0037737675, statistic_sign=-1),
                                80000: KstestResult(statistic=0.26535, pvalue=0.0, statistic_location=-0.0038874391, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2648111111111111, pvalue=0.0, statistic_location=-0.003948397, statistic_sign=-1),
                                100000: KstestResult(statistic=0.26529, pvalue=0.0, statistic_location=-0.0040416317, statistic_sign=-1),
                                110000: KstestResult(statistic=0.26200909090909086, pvalue=0.0, statistic_location=-0.0040008575, statistic_sign=-1),
                                120000: KstestResult(statistic=0.2649083333333333, pvalue=0.0, statistic_location=-0.00405485, statistic_sign=-1),
                                130000: KstestResult(statistic=0.2636153846153846, pvalue=0.0, statistic_location=-0.0037598014, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2629, pvalue=0.0, statistic_location=-0.003934342, statistic_sign=-1),
                                150000: KstestResult(statistic=0.26406, pvalue=0.0, statistic_location=-0.0041119643, statistic_sign=-1),
                                160000: KstestResult(statistic=0.26500625, pvalue=0.0, statistic_location=-0.00419694, statistic_sign=-1),
                                170000: KstestResult(statistic=0.2655176470588235, pvalue=0.0, statistic_location=-0.0037717521, statistic_sign=-1),
                                180000: KstestResult(statistic=0.26526111111111106, pvalue=0.0, statistic_location=-0.0037570987, statistic_sign=-1),
                                190000: KstestResult(statistic=0.26348421052631577, pvalue=0.0, statistic_location=-0.003886831, statistic_sign=-1),
                                200000: KstestResult(statistic=0.26495, pvalue=0.0, statistic_location=-0.003837984, statistic_sign=-1),
                                210000: KstestResult(statistic=0.2634761904761905, pvalue=0.0, statistic_location=-0.0040140934, statistic_sign=-1),
                                220000: KstestResult(statistic=0.2650136363636364, pvalue=0.0, statistic_location=-0.0038309179, statistic_sign=-1),
                                230000: KstestResult(statistic=0.26246956521739134, pvalue=0.0, statistic_location=-0.0038986122, statistic_sign=-1),
                                240000: KstestResult(statistic=0.26414583333333336, pvalue=0.0, statistic_location=-0.003878084, statistic_sign=-1),
                                250000: KstestResult(statistic=0.264392, pvalue=0.0, statistic_location=-0.0040409644, statistic_sign=-1),
                                260000: KstestResult(statistic=0.26516153846153845, pvalue=0.0, statistic_location=-0.004014723, statistic_sign=-1),
                                270000: KstestResult(statistic=0.2647481481481482, pvalue=0.0, statistic_location=-0.0040159593, statistic_sign=-1),
                                280000: KstestResult(statistic=0.2637571428571429, pvalue=0.0, statistic_location=-0.0040153423, statistic_sign=-1),
                                290000: KstestResult(statistic=0.2647862068965517, pvalue=0.0, statistic_location=-0.0038695382, statistic_sign=-1),
                                300000: KstestResult(statistic=0.2633066666666667, pvalue=0.0, statistic_location=-0.0038832724, statistic_sign=-1),
                                310000: KstestResult(statistic=0.2648483870967742, pvalue=0.0, statistic_location=-0.0038296846, statistic_sign=-1),
                                320000: KstestResult(statistic=0.26546875000000003, pvalue=0.0, statistic_location=-0.0039363243, statistic_sign=-1),
                                330000: KstestResult(statistic=0.26426363636363637, pvalue=0.0, statistic_location=-0.0040488355, statistic_sign=-1)},
                   'moments': {'mean_error': -0.1348416,
                               'means': [-0.00065364566, -9.945171e-06],
                               'stds': [0.015172766, 0.003389335],
                               'variance_ratio': 16.363256}},
 'originals': {'gan': {'mae': 0.047601405531167984,
                       'mse': 0.015234644524753094,
                       'psnr': 23.570749282836914,
                       'rmse': 0.12342870235443115,
                       'ssim': 0.8455910682678223},
               'pca': {'mae': 0.005566350184381008,
                       'mse': 7.154665217967704e-05,
                       'psnr': 47.13739776611328,
                       'rmse': 0.008458525873720646,
                       'ssim': 0.9940136671066284}},
 'reconstructions': {'mae': 0.04681812599301338,
                     'mse': 0.015170566737651825,
                     'psnr': 23.873273849487305,
                     'rmse': 0.12316885590553284,
                     'ssim': 0.8488107919692993},
 'residual_spectra_pcagan': {'cosine': [0.22896187,
                                        0.046737358,
                                        0.10580225,
                                        0.03335675,
                                        0.074091926,
                                        0.06156895,
                                        0.32215235,
                                        0.23471776,
                                        0.039330233,
                                        0.038269337,
                                        0.05584254,
                                        0.060774017,
                                        0.04339352,
                                        0.0787191,
                                        0.18782352,
                                        0.13483952,
                                        0.23366183,
                                        0.31813154,
                                        0.37870687,
                                        0.2905184,
                                        0.31637183,
                                        0.28628388,
                                        0.29766667,
                                        0.29140303,
                                        0.346198,
                                        0.33339775,
                                        0.25744385,
                                        0.24441077,
                                        0.2885177,
                                        0.28147095,
                                        0.039978165,
                                        0.2947332,
                                        0.33152193],
                             'mae': [0.008566918,
                                     0.009109103,
                                     0.008229781,
                                     0.010227899,
                                     0.009056857,
                                     0.010175155,
                                     0.008367774,
                                     0.008824363,
                                     0.011248946,
                                     0.012267404,
                                     0.010826942,
                                     0.009628803,
                                     0.010695892,
                                     0.009128108,
                                     0.009900262,
                                     0.010190306,
                                     0.008807185,
                                     0.0085569965,
                                     0.0073025436,
                                     0.008557225,
                                     0.009530964,
                                     0.009376971,
                                     0.008056002,
                                     0.009638666,
                                     0.008067383,
                                     0.008232465,
                                     0.009882035,
                                     0.010340801,
                                     0.009112478,
                                     0.010404001,
                                     0.013189691,
                                     0.010607228,
                                     0.007837343],
                             'max_mae': 0.013189691,
                             'max_mse': 0.00045976485,
                             'max_rmse': 0.021442128,
                             'median_distance': 1.4344505,
                             'median_mae': 0.009376971,
                             'min_cosine': 0.03335675,
                             'mse': [0.0001767642,
                                     0.00017873617,
                                     0.00013849618,
                                     0.0002666573,
                                     0.0001646911,
                                     0.00031129512,
                                     0.00015453708,
                                     0.0002111928,
                                     0.00034147143,
                                     0.0002909169,
                                     0.00027326145,
                                     0.00019252521,
                                     0.00027373893,
                                     0.00016913646,
                                     0.00020576482,
                                     0.00030266886,
                                     0.00019677627,
                                     0.00015063345,
                                     0.00010725622,
                                     0.00021531711,
                                     0.00019870698,
                                     0.00022899885,
                                     0.00017973226,
                                     0.00020954816,
                                     0.00013197689,
                                     0.00015221405,
                                     0.00029196872,
                                     0.00024888848,
                                     0.0001993876,
                                     0.00025610003,
                                     0.00045976485,
                                     0.0002178896,
                                     0.00015446368],
                             'rmse': [0.01329527,
                                      0.013369225,
                                      0.01176844,
                                      0.016329644,
                                      0.012833203,
                                      0.017643558,
                                      0.012431295,
                                      0.014532474,
                                      0.018478945,
                                      0.017056286,
                                      0.016530622,
                                      0.013875346,
                                      0.016545057,
                                      0.013005247,
                                      0.014344505,
                                      0.017397381,
                                      0.014027696,
                                      0.012273282,
                                      0.010356458,
                                      0.0146736875,
                                      0.014096347,
                                      0.015132708,
                                      0.013406426,
                                      0.014475779,
                                      0.01148812,
                                      0.012337506,
                                      0.017087093,
                                      0.0157762,
                                      0.014120468,
                                      0.016003126,
                                      0.021442128,
                                      0.014761084,
                                      0.012428341]},
 'residuals': {'mae': 0.009513470344245434,
               'mse': 0.00021974170522298664,
               'psnr': 15.50959587097168,
               'rmse': 0.014823687262833118,
               'ssds': [76.11101, 3.7909267],
               'ssim': 0.48529860377311707},
 'spectra_pcagan': {'cosine': [0.9958079,
                               0.99877137,
                               0.99884486,
                               0.9975696,
                               0.9983894,
                               0.9977553,
                               0.99281,
                               0.99089277,
                               0.98750067,
                               0.99805087,
                               0.9988887,
                               0.99843824,
                               0.9986709,
                               0.99811596,
                               0.9956064,
                               0.99421585,
                               0.9960709,
                               0.9853473,
                               0.98508745,
                               0.9872408,
                               0.98775196,
                               0.9892546,
                               0.9895774,
                               0.983464,
                               0.99085116,
                               0.99224544,
                               0.98729473,
                               0.9868015,
                               0.9878892,
                               0.9507011,
                               0.22023407,
                               0.9525604,
                               0.9883897],
                    'mae': [0.019292133,
                            0.015843503,
                            0.014326196,
                            0.023817603,
                            0.016447641,
                            0.02016279,
                            0.030621149,
                            0.024831101,
                            0.10157329,
                            0.022743559,
                            0.018360239,
                            0.017747037,
                            0.017494513,
                            0.017523946,
                            0.024103744,
                            0.023927227,
                            0.0200704,
                            0.026144167,
                            0.026118426,
                            0.023354009,
                            0.024014216,
                            0.02547551,
                            0.023827668,
                            0.030086648,
                            0.02789932,
                            0.026811441,
                            0.028093114,
                            0.030493336,
                            0.026504938,
                            0.052120276,
                            0.66081566,
                            0.061458617,
                            0.022894695],
                    'max_mae': 0.66081566,
                    'max_mse': 0.4540344,
                    'max_rmse': 0.67382073,
                    'median_mae': 0.024014216,
                    'min_cosine': 0.22023407,
                    'mse': [0.0006400994,
                            0.00041799617,
                            0.00035190457,
                            0.0008340721,
                            0.00044282762,
                            0.00071227906,
                            0.0013132871,
                            0.0010434814,
                            0.011162464,
                            0.0008335802,
                            0.0005685043,
                            0.00052973186,
                            0.0005326108,
                            0.0005078479,
                            0.0009465912,
                            0.00093707524,
                            0.0007138781,
                            0.0011042899,
                            0.0010832025,
                            0.00094873866,
                            0.0009829649,
                            0.0010619749,
                            0.000994423,
                            0.0015298036,
                            0.0013247151,
                            0.0012880327,
                            0.0014110197,
                            0.0015676277,
                            0.0012476261,
                            0.0035704917,
                            0.4540344,
                            0.0051016817,
                            0.0008895354],
                    'rmse': [0.025300186,
                             0.020444954,
                             0.01875912,
                             0.028880307,
                             0.02104347,
                             0.026688557,
                             0.036239304,
                             0.032302964,
                             0.10565256,
                             0.02887179,
                             0.02384333,
                             0.023015905,
                             0.023078362,
                             0.02253548,
                             0.030766722,
                             0.030611685,
                             0.026718497,
                             0.033230856,
                             0.032912042,
                             0.030801602,
                             0.03135227,
                             0.032587957,
                             0.031534474,
                             0.039112706,
                             0.036396638,
                             0.035889175,
                             0.037563544,
                             0.03959328,
                             0.035321753,
                             0.059753593,
                             0.67382073,
                             0.07142606,
                             0.02982508]},
 'spectra_realgan': {'cosine': [0.99551576,
                                0.99876493,
                                0.998834,
                                0.99756604,
                                0.9983778,
                                0.9977363,
                                0.9921044,
                                0.99015844,
                                0.9875056,
                                0.9980448,
                                0.99888396,
                                0.9984333,
                                0.9986653,
                                0.99810314,
                                0.99539846,
                                0.9940976,
                                0.9958295,
                                0.9838769,
                                0.9832136,
                                0.9855096,
                                0.986527,
                                0.98814726,
                                0.987965,
                                0.98184514,
                                0.9897907,
                                0.99135804,
                                0.9858406,
                                0.9855282,
                                0.98651797,
                                0.9485285,
                                0.2206193,
                                0.95217985,
                                0.98690045],
                     'mae': [0.02003698,
                             0.015912153,
                             0.0143911755,
                             0.02383693,
                             0.016507097,
                             0.020245394,
                             0.031399265,
                             0.025884539,
                             0.10155931,
                             0.022796027,
                             0.018384203,
                             0.017779544,
                             0.01753393,
                             0.01757063,
                             0.024619756,
                             0.02419462,
                             0.020818396,
                             0.027516235,
                             0.027907703,
                             0.025198758,
                             0.025496442,
                             0.026611729,
                             0.025614306,
                             0.031711236,
                             0.029571796,
                             0.028770648,
                             0.02958012,
                             0.03204787,
                             0.02830688,
                             0.052726887,
                             0.66074806,
                             0.061087005,
                             0.024480823],
                     'max_mae': 0.66074806,
                     'max_mse': 0.4539355,
                     'max_rmse': 0.67374736,
                     'median_mae': 0.025496442,
                     'min_cosine': 0.2206193,
                     'mse': [0.00068471365,
                             0.00042060376,
                             0.00035518824,
                             0.0008353023,
                             0.00044599563,
                             0.000717825,
                             0.0014077849,
                             0.001121486,
                             0.011159779,
                             0.0008367291,
                             0.0005706385,
                             0.00053134764,
                             0.0005346133,
                             0.00051127456,
                             0.0009843842,
                             0.00095615484,
                             0.00075438793,
                             0.0012168908,
                             0.0012226267,
                             0.0010774302,
                             0.0010844271,
                             0.0011621406,
                             0.0011252105,
                             0.0016750996,
                             0.0014774465,
                             0.0014325453,
                             0.001541325,
                             0.0017133416,
                             0.0013875178,
                             0.0037366485,
                             0.4539355,
                             0.0051225,
                             0.0010044037],
                     'rmse': [0.026167033,
                              0.020508626,
                              0.01884644,
                              0.028901597,
                              0.02111861,
                              0.026792256,
                              0.03752046,
                              0.033488594,
                              0.10563985,
                              0.02892627,
                              0.02388804,
                              0.023050979,
                              0.023121707,
                              0.022611381,
                              0.031374898,
                              0.030921753,
                              0.027466124,
                              0.03488396,
                              0.034966078,
                              0.032824233,
                              0.032930642,
                              0.034090184,
                              0.033544157,
                              0.04092798,
                              0.038437568,
                              0.03784898,
                              0.039259713,
                              0.04139253,
                              0.0372494,
                              0.061128132,
                              0.67374736,
                              0.07157164,
                              0.03169233]},
 'spectra_realpca': {'cosine': [0.99971443,
                                0.9999953,
                                0.99998647,
                                0.99999315,
                                0.9999908,
                                0.99998134,
                                0.9993712,
                                0.99922585,
                                0.99999803,
                                0.99999726,
                                0.9999966,
                                0.99999326,
                                0.9999966,
                                0.9999901,
                                0.99980736,
                                0.99991435,
                                0.99974716,
                                0.9983853,
                                0.99830335,
                                0.99835104,
                                0.9985456,
                                0.9988177,
                                0.99835575,
                                0.99842083,
                                0.99883866,
                                0.99901855,
                                0.9984479,
                                0.99866664,
                                0.9985693,
                                0.99818754,
                                0.9999605,
                                0.99848145,
                                0.99838674],
                     'mae': [0.0052340305,
                             0.0009849762,
                             0.0016064198,
                             0.0011297235,
                             0.0012415698,
                             0.0018167804,
                             0.0070559517,
                             0.0071046706,
                             0.0006354302,
                             0.0007782336,
                             0.0009592189,
                             0.0011779757,
                             0.00091623125,
                             0.0012816523,
                             0.0045699165,
                             0.0029260365,
                             0.0050996644,
                             0.0087483805,
                             0.008812489,
                             0.008727003,
                             0.008573349,
                             0.008208961,
                             0.009139615,
                             0.0093117505,
                             0.009977932,
                             0.010028896,
                             0.009434551,
                             0.009722602,
                             0.009615157,
                             0.0091212345,
                             0.0013544039,
                             0.009646479,
                             0.008748288],
                     'max_mae': 0.010028896,
                     'max_mse': 0.00016441615,
                     'max_rmse': 0.012822486,
                     'median_mae': 0.0070559517,
                     'min_cosine': 0.99818754,
                     'mse': [4.3624987e-05,
                             1.5602401e-06,
                             4.143731e-06,
                             2.0416305e-06,
                             2.472643e-06,
                             5.2918786e-06,
                             8.010098e-05,
                             8.0830905e-05,
                             6.456539e-07,
                             9.662139e-07,
                             1.483319e-06,
                             2.2280067e-06,
                             1.3391204e-06,
                             2.6489433e-06,
                             3.346457e-05,
                             1.3749911e-05,
                             4.1788287e-05,
                             0.00012243602,
                             0.00012448007,
                             0.00012156526,
                             0.00011623578,
                             0.00010666266,
                             0.0001342123,
                             0.00013979574,
                             0.00016441615,
                             0.0001623811,
                             0.00014208525,
                             0.00015154328,
                             0.00014716902,
                             0.00013477243,
                             2.981468e-06,
                             0.00014901484,
                             0.00012290697],
                     'rmse': [0.0066049215,
                              0.0012490957,
                              0.0020356157,
                              0.0014288564,
                              0.001572464,
                              0.0023004084,
                              0.008949915,
                              0.008990601,
                              0.0008035259,
                              0.0009829617,
                              0.0012179158,
                              0.001492651,
                              0.0011572037,
                              0.0016275574,
                              0.005784857,
                              0.0037080871,
                              0.006464386,
                              0.011065081,
                              0.011157064,
                              0.011025663,
                              0.0107812695,
                              0.010327761,
                              0.011585003,
                              0.011823525,
                              0.012822486,
                              0.012742884,
                              0.011919952,
                              0.012310292,
                              0.012131324,
                              0.011609153,
                              0.0017266928,
                              0.0122071635,
                              0.011086342]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_65.0
