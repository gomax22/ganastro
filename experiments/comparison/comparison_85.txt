
Running comparison for experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805
Directory path: experiments/inpainting/gann_4_night_20180708_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_85.0/images
Optimal number of principal components:  38
Reconstruction error:  8.059699
Energy conservation:  0.8535732
saved images in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_85.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [3.933204310299706, 3.047135230255707],
                   'kl_div': 0.40481064,
                   'ks_tests': {10000: KstestResult(statistic=0.1885, pvalue=1.1673092425758777e-155, statistic_location=0.0061662155, statistic_sign=1),
                                20000: KstestResult(statistic=0.18125000000000002, pvalue=6.151002222233393e-288, statistic_location=0.006933407, statistic_sign=1),
                                30000: KstestResult(statistic=0.18233333333333335, pvalue=0.0, statistic_location=0.006740251, statistic_sign=1),
                                40000: KstestResult(statistic=0.181025, pvalue=0.0, statistic_location=0.006421201, statistic_sign=1),
                                50000: KstestResult(statistic=0.18200000000000005, pvalue=0.0, statistic_location=0.0064856913, statistic_sign=1),
                                60000: KstestResult(statistic=0.18431666666666668, pvalue=0.0, statistic_location=0.006238575, statistic_sign=1),
                                70000: KstestResult(statistic=0.18392857142857144, pvalue=0.0, statistic_location=0.0065570073, statistic_sign=1),
                                80000: KstestResult(statistic=0.18343750000000003, pvalue=0.0, statistic_location=0.006377888, statistic_sign=1),
                                90000: KstestResult(statistic=0.18332222222222228, pvalue=0.0, statistic_location=0.006474319, statistic_sign=1),
                                100000: KstestResult(statistic=0.18182999999999994, pvalue=0.0, statistic_location=0.0064537544, statistic_sign=1),
                                110000: KstestResult(statistic=0.18435454545454544, pvalue=0.0, statistic_location=0.006377986, statistic_sign=1)},
                   'moments': {'mean_error': 0.07575324,
                               'means': [-1.1889718e-05, -7.132733e-05],
                               'stds': [0.017084507, 0.0054604835],
                               'variance_ratio': 8.470948}},
 'originals': {'gan': {'mae': 0.044734351336956024,
                       'mse': 0.00500925537198782,
                       'psnr': 27.338207244873047,
                       'rmse': 0.0707760900259018,
                       'ssim': 0.9471726417541504},
               'pca': {'mae': 0.011487552896142006,
                       'mse': 0.000257835810771212,
                       'psnr': 40.180580139160156,
                       'rmse': 0.016057265922427177,
                       'ssim': 0.9974243640899658}},
 'reconstructions': {'mae': 0.042423516511917114,
                     'mse': 0.004788749385625124,
                     'psnr': 27.491792678833008,
                     'rmse': 0.0692007914185524,
                     'ssim': 0.9488345980644226},
 'residual_spectra_pcagan': {'cosine': [0.3296385,
                                        0.03319515,
                                        0.35561585,
                                        0.35329515,
                                        0.035281245,
                                        0.382392,
                                        0.38441274,
                                        0.42544857,
                                        0.41392413,
                                        0.4007847,
                                        0.2596957],
                             'mae': [0.010821682,
                                     0.013461957,
                                     0.009017001,
                                     0.010108004,
                                     0.012181086,
                                     0.008424058,
                                     0.008751986,
                                     0.00865216,
                                     0.008791669,
                                     0.008867206,
                                     0.011552309],
                             'max_mae': 0.013461957,
                             'max_mse': 0.0004221323,
                             'max_rmse': 0.020545859,
                             'median_distance': 1.4584734,
                             'median_mae': 0.009017001,
                             'min_cosine': 0.03319515,
                             'mse': [0.00029546095,
                                     0.0004195296,
                                     0.0002127145,
                                     0.00024564253,
                                     0.00039203235,
                                     0.00018685135,
                                     0.00016490954,
                                     0.00018208673,
                                     0.00020052232,
                                     0.00017987049,
                                     0.0004221323],
                             'rmse': [0.017188977,
                                      0.02048242,
                                      0.014584735,
                                      0.015672987,
                                      0.019799806,
                                      0.013669358,
                                      0.012841711,
                                      0.013493951,
                                      0.01416059,
                                      0.013411581,
                                      0.020545859]},
 'residuals': {'mae': 0.010057192295789719,
               'mse': 0.0002637956931721419,
               'psnr': 20.765117645263672,
               'rmse': 0.016241788864135742,
               'ssds': [32.106564, 3.2803864],
               'ssim': 0.42179644107818604},
 'spectra_pcagan': {'cosine': [0.9930323,
                               0.9993869,
                               0.99795413,
                               0.9906714,
                               0.9924489,
                               0.99755746,
                               0.99707884,
                               0.97463256,
                               0.99522847,
                               0.99129474,
                               0.98502105],
                    'mae': [0.028905926,
                            0.021969529,
                            0.03679005,
                            0.024338061,
                            0.021393133,
                            0.03831908,
                            0.03004456,
                            0.19371323,
                            0.022785101,
                            0.021159861,
                            0.027240103],
                    'max_mae': 0.19371323,
                    'max_mse': 0.039608955,
                    'max_rmse': 0.19901998,
                    'median_mae': 0.027240103,
                    'min_cosine': 0.97463256,
                    'mse': [0.0015296348,
                            0.00069339055,
                            0.0021678105,
                            0.001043072,
                            0.0008085888,
                            0.0022406415,
                            0.0014773912,
                            0.039608955,
                            0.00093675154,
                            0.0007780571,
                            0.0013919408],
                    'rmse': [0.039110545,
                             0.02633231,
                             0.04655975,
                             0.032296624,
                             0.028435696,
                             0.047335416,
                             0.03843685,
                             0.19901998,
                             0.030606396,
                             0.027893675,
                             0.037308723]},
 'spectra_realgan': {'cosine': [0.99175346,
                                0.9993864,
                                0.9974738,
                                0.9885626,
                                0.992407,
                                0.99695754,
                                0.996352,
                                0.97315854,
                                0.99355114,
                                0.98881245,
                                0.9826634],
                     'mae': [0.032277416,
                             0.021971023,
                             0.039228965,
                             0.027653707,
                             0.021448666,
                             0.04044802,
                             0.03310232,
                             0.19353077,
                             0.027468923,
                             0.024600843,
                             0.030347247],
                     'max_mae': 0.19353077,
                     'max_mse': 0.039805513,
                     'max_rmse': 0.1995132,
                     'median_mae': 0.030347247,
                     'min_cosine': 0.97315854,
                     'mse': [0.001811758,
                             0.00069365103,
                             0.0024994803,
                             0.0012799344,
                             0.00081188173,
                             0.002571155,
                             0.0017536087,
                             0.039805513,
                             0.0012606264,
                             0.0009979114,
                             0.0016162823],
                     'rmse': [0.04256475,
                              0.026337255,
                              0.049994804,
                              0.03577617,
                              0.028493538,
                              0.050706558,
                              0.04187611,
                              0.1995132,
                              0.035505302,
                              0.031589735,
                              0.040203013]},
 'spectra_realpca': {'cosine': [0.99864066,
                                0.9999997,
                                0.99948215,
                                0.9976703,
                                0.999979,
                                0.9993455,
                                0.9991489,
                                0.9983802,
                                0.9983868,
                                0.9972706,
                                0.99743515],
                     'mae': [0.013680675,
                             0.00028602028,
                             0.015590407,
                             0.012680924,
                             0.0011426514,
                             0.01546774,
                             0.015212387,
                             0.013913962,
                             0.013962807,
                             0.012250941,
                             0.012174582],
                     'max_mae': 0.015590407,
                     'max_mse': 0.00039124064,
                     'max_rmse': 0.019779803,
                     'median_mae': 0.013680675,
                     'min_cosine': 0.9972706,
                     'mse': [0.0002997343,
                             1.3201564e-07,
                             0.00039124064,
                             0.00025937238,
                             2.1058029e-06,
                             0.00038220087,
                             0.00037056004,
                             0.00033877458,
                             0.0003141616,
                             0.00023868479,
                             0.00023922668],
                     'rmse': [0.017312836,
                              0.00036333958,
                              0.019779803,
                              0.016105043,
                              0.0014511385,
                              0.019549958,
                              0.019249937,
                              0.01840583,
                              0.017724603,
                              0.015449427,
                              0.015466955]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_20/models/GANASTRO/0111_144805/comparison_85.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628
Directory path: experiments/inpainting/gann_4_night_20180708_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_85.0/images
Optimal number of principal components:  38
Reconstruction error:  8.059699
Energy conservation:  0.8535732
saved images in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_85.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.079875858281184, 2.795570027080257],
                   'kl_div': 0.7579896,
                   'ks_tests': {10000: KstestResult(statistic=0.2586, pvalue=3.624778270499522e-294, statistic_location=-0.004995317, statistic_sign=-1),
                                20000: KstestResult(statistic=0.26055, pvalue=0.0, statistic_location=-0.005157845, statistic_sign=-1),
                                30000: KstestResult(statistic=0.26383333333333336, pvalue=0.0, statistic_location=-0.0053027826, statistic_sign=-1),
                                40000: KstestResult(statistic=0.2662, pvalue=0.0, statistic_location=-0.0048752693, statistic_sign=-1),
                                50000: KstestResult(statistic=0.26324000000000003, pvalue=0.0, statistic_location=-0.0052485093, statistic_sign=-1),
                                60000: KstestResult(statistic=0.2625666666666666, pvalue=0.0, statistic_location=-0.0052032312, statistic_sign=-1),
                                70000: KstestResult(statistic=0.26128571428571434, pvalue=0.0, statistic_location=-0.0052356683, statistic_sign=-1),
                                80000: KstestResult(statistic=0.26032500000000003, pvalue=0.0, statistic_location=-0.005266009, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2622888888888889, pvalue=0.0, statistic_location=-0.0049416646, statistic_sign=-1),
                                100000: KstestResult(statistic=0.26433, pvalue=0.0, statistic_location=-0.0052616717, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2629636363636364, pvalue=0.0, statistic_location=-0.005159678, statistic_sign=-1),
                                120000: KstestResult(statistic=0.2634916666666667, pvalue=0.0, statistic_location=-0.0053735552, statistic_sign=-1),
                                130000: KstestResult(statistic=0.2642538461538462, pvalue=0.0, statistic_location=-0.0052817236, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2633142857142857, pvalue=0.0, statistic_location=-0.0053103957, statistic_sign=-1),
                                150000: KstestResult(statistic=0.26054666666666665, pvalue=0.0, statistic_location=-0.0052316887, statistic_sign=-1),
                                160000: KstestResult(statistic=0.2621875, pvalue=0.0, statistic_location=-0.005243293, statistic_sign=-1),
                                170000: KstestResult(statistic=0.26135882352941175, pvalue=0.0, statistic_location=-0.0051575303, statistic_sign=-1),
                                180000: KstestResult(statistic=0.26289999999999997, pvalue=0.0, statistic_location=-0.005156891, statistic_sign=-1),
                                190000: KstestResult(statistic=0.2632473684210527, pvalue=0.0, statistic_location=-0.005434678, statistic_sign=-1),
                                200000: KstestResult(statistic=0.26134500000000005, pvalue=0.0, statistic_location=-0.0052317306, statistic_sign=-1),
                                210000: KstestResult(statistic=0.263052380952381, pvalue=0.0, statistic_location=-0.0053570066, statistic_sign=-1),
                                220000: KstestResult(statistic=0.26255, pvalue=0.0, statistic_location=-0.005159555, statistic_sign=-1)},
                   'moments': {'mean_error': -0.22432098,
                               'means': [-0.0014181881, -4.506837e-05],
                               'stds': [0.01881039, 0.0046881246],
                               'variance_ratio': 13.859422}},
 'originals': {'gan': {'mae': 0.041415736079216,
                       'mse': 0.003690463025122881,
                       'psnr': 29.55628204345703,
                       'rmse': 0.06074918061494827,
                       'ssim': 0.9063164591789246},
               'pca': {'mae': 0.008980254642665386,
                       'mse': 0.0001948178542079404,
                       'psnr': 42.495643615722656,
                       'rmse': 0.013957716524600983,
                       'ssim': 0.9948095083236694}},
 'reconstructions': {'mae': 0.04018126428127289,
                     'mse': 0.003516249591484666,
                     'psnr': 29.93113136291504,
                     'rmse': 0.05929797142744064,
                     'ssim': 0.90903240442276},
 'residual_spectra_pcagan': {'cosine': [0.039391562,
                                        0.0075635714,
                                        0.08588097,
                                        0.27643418,
                                        0.29399738,
                                        0.38761333,
                                        0.022048108,
                                        0.3045165,
                                        0.33588436,
                                        0.02267861,
                                        0.36145726,
                                        0.32942048,
                                        0.3772896,
                                        0.31218305,
                                        0.30050617,
                                        0.3292717,
                                        0.33455837,
                                        0.35755613,
                                        0.0816558,
                                        0.012721884,
                                        0.18741547,
                                        0.008808147],
                             'mae': [0.014152316,
                                     0.015150787,
                                     0.013741974,
                                     0.013913014,
                                     0.012020721,
                                     0.009993402,
                                     0.0145119,
                                     0.011288451,
                                     0.012087702,
                                     0.013690298,
                                     0.009895585,
                                     0.011200803,
                                     0.010107454,
                                     0.011171816,
                                     0.012129896,
                                     0.011928365,
                                     0.010079074,
                                     0.011397698,
                                     0.011946815,
                                     0.012822403,
                                     0.011197105,
                                     0.011921217],
                             'max_mae': 0.015150787,
                             'max_mse': 0.0004914307,
                             'max_rmse': 0.022168236,
                             'median_distance': 1.7925301,
                             'median_mae': 0.01193759,
                             'min_cosine': 0.0075635714,
                             'mse': [0.0003963546,
                                     0.0004914307,
                                     0.00043757109,
                                     0.0003704588,
                                     0.00031824494,
                                     0.0002039262,
                                     0.00043681497,
                                     0.00031413446,
                                     0.00030437554,
                                     0.0004886732,
                                     0.00022067764,
                                     0.00026784913,
                                     0.00024956645,
                                     0.0004110795,
                                     0.00032661267,
                                     0.00033812257,
                                     0.00025674584,
                                     0.00028651048,
                                     0.00026095388,
                                     0.00033052673,
                                     0.00032440267,
                                     0.00030966822],
                             'rmse': [0.019908655,
                                      0.022168236,
                                      0.0209182,
                                      0.019247307,
                                      0.01783942,
                                      0.014280274,
                                      0.02090012,
                                      0.01772384,
                                      0.017446361,
                                      0.022105955,
                                      0.014855223,
                                      0.016366096,
                                      0.015797673,
                                      0.020275095,
                                      0.018072428,
                                      0.01838811,
                                      0.016023291,
                                      0.01692662,
                                      0.016154068,
                                      0.018180395,
                                      0.018011183,
                                      0.017597392]},
 'residuals': {'mae': 0.012106764130294323,
               'mse': 0.00033384995185770094,
               'psnr': 19.74228286743164,
               'rmse': 0.018271561712026596,
               'ssds': [78.28488, 4.835697],
               'ssim': 0.32229527831077576},
 'spectra_pcagan': {'cosine': [0.9989457,
                               0.9994022,
                               0.98173815,
                               0.99469817,
                               0.99687576,
                               0.9930305,
                               0.9991667,
                               0.9968068,
                               0.98457396,
                               0.98853296,
                               0.99668115,
                               0.99483603,
                               0.9781579,
                               0.99187106,
                               0.9591031,
                               0.97964555,
                               0.9887622,
                               0.9810919,
                               0.98838973,
                               0.9993161,
                               0.98187965,
                               0.997417],
                    'mae': [0.017116886,
                            0.020176688,
                            0.028519787,
                            0.04845823,
                            0.057345666,
                            0.030470971,
                            0.019979334,
                            0.054262176,
                            0.032669246,
                            0.026166193,
                            0.046953976,
                            0.04290582,
                            0.17979285,
                            0.030740436,
                            0.05773637,
                            0.033251822,
                            0.026320495,
                            0.040318202,
                            0.027362805,
                            0.01770847,
                            0.02556654,
                            0.02016486],
                    'max_mae': 0.17979285,
                    'max_mse': 0.0350112,
                    'max_rmse': 0.1871128,
                    'median_mae': 0.030605704,
                    'min_cosine': 0.9591031,
                    'mse': [0.00047153968,
                            0.0005930977,
                            0.0013456028,
                            0.0036595108,
                            0.0054634567,
                            0.0015653111,
                            0.00062296964,
                            0.004309231,
                            0.0017553212,
                            0.0011687988,
                            0.003267669,
                            0.0029095134,
                            0.0350112,
                            0.001801965,
                            0.004312452,
                            0.0019079506,
                            0.0011886841,
                            0.0024748805,
                            0.0012120667,
                            0.00047674432,
                            0.0011637186,
                            0.0006758113],
                    'rmse': [0.021714965,
                             0.024353597,
                             0.03668246,
                             0.06049389,
                             0.0739152,
                             0.039564013,
                             0.02495936,
                             0.06564473,
                             0.04189655,
                             0.0341877,
                             0.05716353,
                             0.053939905,
                             0.1871128,
                             0.042449556,
                             0.06566926,
                             0.043680094,
                             0.034477297,
                             0.04974817,
                             0.03481475,
                             0.021834476,
                             0.03411332,
                             0.025996372]},
 'spectra_realgan': {'cosine': [0.99894327,
                                0.99940234,
                                0.98145306,
                                0.99415404,
                                0.9965239,
                                0.991695,
                                0.99916625,
                                0.99628097,
                                0.9822146,
                                0.9884819,
                                0.9960184,
                                0.994058,
                                0.97664857,
                                0.99022675,
                                0.95710987,
                                0.97679853,
                                0.98647827,
                                0.9784223,
                                0.9882579,
                                0.99931574,
                                0.98092294,
                                0.997411],
                     'mae': [0.017146079,
                             0.020168345,
                             0.028706223,
                             0.050800398,
                             0.059404463,
                             0.033509545,
                             0.019985925,
                             0.055692036,
                             0.03531207,
                             0.02621587,
                             0.048675243,
                             0.044680182,
                             0.17965956,
                             0.03404801,
                             0.05834632,
                             0.035970166,
                             0.028960349,
                             0.04211721,
                             0.02753194,
                             0.017711489,
                             0.026319312,
                             0.020185553],
                     'max_mae': 0.17965956,
                     'max_mse': 0.035222843,
                     'max_rmse': 0.1876775,
                     'median_mae': 0.03377878,
                     'min_cosine': 0.95710987,
                     'mse': [0.00047266626,
                             0.00059270527,
                             0.0013652463,
                             0.00403947,
                             0.005812725,
                             0.0018575729,
                             0.0006232374,
                             0.004649755,
                             0.0020181779,
                             0.0011730588,
                             0.0036266067,
                             0.0031747771,
                             0.035222843,
                             0.0021111243,
                             0.004506634,
                             0.0021810574,
                             0.0014073155,
                             0.0027539334,
                             0.0012253452,
                             0.00047697028,
                             0.0012224708,
                             0.0006764928],
                     'rmse': [0.02174089,
                              0.02434554,
                              0.03694924,
                              0.06355683,
                              0.07624123,
                              0.04309957,
                              0.024964724,
                              0.068189114,
                              0.044924136,
                              0.034249946,
                              0.060221314,
                              0.05634516,
                              0.1876775,
                              0.045946974,
                              0.06713147,
                              0.046701793,
                              0.037514202,
                              0.052477933,
                              0.035004932,
                              0.021839648,
                              0.03496385,
                              0.026009476]},
 'spectra_realpca': {'cosine': [0.99999845,
                                0.99999994,
                                0.99975187,
                                0.9994233,
                                0.99963766,
                                0.99864066,
                                0.9999997,
                                0.99948215,
                                0.9976703,
                                0.999979,
                                0.9993455,
                                0.9991489,
                                0.9983802,
                                0.9983868,
                                0.9972706,
                                0.99743515,
                                0.9976402,
                                0.99726665,
                                0.99992853,
                                0.9999998,
                                0.99907905,
                                0.9999937],
                     'mae': [0.00060666597,
                             0.0002421348,
                             0.0033515526,
                             0.015773915,
                             0.016803324,
                             0.013680675,
                             0.00028602028,
                             0.015590407,
                             0.012680924,
                             0.0011426514,
                             0.01546774,
                             0.015212387,
                             0.013913962,
                             0.013962807,
                             0.012250941,
                             0.012174582,
                             0.011898683,
                             0.013490455,
                             0.002014434,
                             0.00023955484,
                             0.0058406754,
                             0.00094109774],
                     'max_mae': 0.016803324,
                     'max_mse': 0.00045370957,
                     'max_rmse': 0.02130046,
                     'median_mae': 0.012212762,
                     'min_cosine': 0.99726665,
                     'mse': [5.8861957e-07,
                             9.3501484e-08,
                             1.8041765e-05,
                             0.00039918342,
                             0.00045370957,
                             0.0002997343,
                             1.3201564e-07,
                             0.00039124064,
                             0.00025937238,
                             2.1058029e-06,
                             0.00038220087,
                             0.00037056004,
                             0.00033877458,
                             0.0003141616,
                             0.00023868479,
                             0.00023922668,
                             0.0002255934,
                             0.00028941504,
                             6.6201655e-06,
                             9.3409874e-08,
                             5.5032862e-05,
                             1.4271834e-06],
                     'rmse': [0.00076721545,
                              0.00030578012,
                              0.0042475597,
                              0.019979576,
                              0.02130046,
                              0.017312836,
                              0.00036333958,
                              0.019779803,
                              0.016105043,
                              0.0014511385,
                              0.019549958,
                              0.019249937,
                              0.01840583,
                              0.017724603,
                              0.015449427,
                              0.015466955,
                              0.015019767,
                              0.017012203,
                              0.0025729681,
                              0.0003056303,
                              0.0074184136,
                              0.0011946479]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_40/models/GANASTRO/0111_165628/comparison_85.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354
Directory path: experiments/inpainting/gann_4_night_20180708_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_85.0/images
Optimal number of principal components:  38
Reconstruction error:  8.059699
Energy conservation:  0.8535732
saved images in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_85.0/spectra/obs_0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180708_cb4240_ce4340.npz
{'distributions': {'entropies': [4.061857105227111, 2.494869886875946],
                   'kl_div': 1.0126709,
                   'ks_tests': {10000: KstestResult(statistic=0.2879, pvalue=1e-323, statistic_location=-0.0041099507, statistic_sign=-1),
                                20000: KstestResult(statistic=0.2902, pvalue=0.0, statistic_location=-0.0038327267, statistic_sign=-1),
                                30000: KstestResult(statistic=0.2857, pvalue=0.0, statistic_location=-0.003790848, statistic_sign=-1),
                                40000: KstestResult(statistic=0.285, pvalue=0.0, statistic_location=-0.0036825435, statistic_sign=-1),
                                50000: KstestResult(statistic=0.28752, pvalue=0.0, statistic_location=-0.0038089622, statistic_sign=-1),
                                60000: KstestResult(statistic=0.28864999999999996, pvalue=0.0, statistic_location=-0.0035392535, statistic_sign=-1),
                                70000: KstestResult(statistic=0.28345714285714285, pvalue=0.0, statistic_location=-0.0037715146, statistic_sign=-1),
                                80000: KstestResult(statistic=0.28679999999999994, pvalue=0.0, statistic_location=-0.003706077, statistic_sign=-1),
                                90000: KstestResult(statistic=0.2852111111111111, pvalue=0.0, statistic_location=-0.0038029533, statistic_sign=-1),
                                100000: KstestResult(statistic=0.28616, pvalue=0.0, statistic_location=-0.003642276, statistic_sign=-1),
                                110000: KstestResult(statistic=0.2873272727272727, pvalue=0.0, statistic_location=-0.0034340909, statistic_sign=-1),
                                120000: KstestResult(statistic=0.286225, pvalue=0.0, statistic_location=-0.0036520055, statistic_sign=-1),
                                130000: KstestResult(statistic=0.28673076923076923, pvalue=0.0, statistic_location=-0.0035473108, statistic_sign=-1),
                                140000: KstestResult(statistic=0.2889285714285714, pvalue=0.0, statistic_location=-0.0039421157, statistic_sign=-1),
                                150000: KstestResult(statistic=0.28817333333333334, pvalue=0.0, statistic_location=-0.003770006, statistic_sign=-1),
                                160000: KstestResult(statistic=0.2890625, pvalue=0.0, statistic_location=-0.003802978, statistic_sign=-1),
                                170000: KstestResult(statistic=0.28564117647058823, pvalue=0.0, statistic_location=-0.003672164, statistic_sign=-1),
                                180000: KstestResult(statistic=0.2870611111111111, pvalue=0.0, statistic_location=-0.0035491586, statistic_sign=-1),
                                190000: KstestResult(statistic=0.28646315789473686, pvalue=0.0, statistic_location=-0.0038334904, statistic_sign=-1),
                                200000: KstestResult(statistic=0.286335, pvalue=0.0, statistic_location=-0.0034340909, statistic_sign=-1),
                                210000: KstestResult(statistic=0.28703333333333336, pvalue=0.0, statistic_location=-0.0034404173, statistic_sign=-1),
                                220000: KstestResult(statistic=0.28714545454545454, pvalue=0.0, statistic_location=-0.003859553, statistic_sign=-1),
                                230000: KstestResult(statistic=0.2864478260869565, pvalue=0.0, statistic_location=-0.0036799256, statistic_sign=-1),
                                240000: KstestResult(statistic=0.2869333333333334, pvalue=0.0, statistic_location=-0.0038024634, statistic_sign=-1),
                                250000: KstestResult(statistic=0.28537999999999997, pvalue=0.0, statistic_location=-0.003531754, statistic_sign=-1),
                                260000: KstestResult(statistic=0.28750769230769235, pvalue=0.0, statistic_location=-0.0039058598, statistic_sign=-1),
                                270000: KstestResult(statistic=0.28726666666666667, pvalue=0.0, statistic_location=-0.0038036807, statistic_sign=-1),
                                280000: KstestResult(statistic=0.28801785714285716, pvalue=0.0, statistic_location=-0.0039128847, statistic_sign=-1),
                                290000: KstestResult(statistic=0.28557241379310344, pvalue=0.0, statistic_location=-0.0034404173, statistic_sign=-1),
                                300000: KstestResult(statistic=0.28692666666666666, pvalue=0.0, statistic_location=-0.0036770646, statistic_sign=-1),
                                310000: KstestResult(statistic=0.2891483870967742, pvalue=0.0, statistic_location=-0.003541001, statistic_sign=-1),
                                320000: KstestResult(statistic=0.28698125, pvalue=0.0, statistic_location=-0.003673438, statistic_sign=-1),
                                330000: KstestResult(statistic=0.2861969696969697, pvalue=0.0, statistic_location=-0.003803607, statistic_sign=-1)},
                   'moments': {'mean_error': -0.070997596,
                               'means': [-0.0005078844, -2.8056289e-05],
                               'stds': [0.017889043, 0.0039174934],
                               'variance_ratio': 19.631315}},
 'originals': {'gan': {'mae': 0.03434796258807182,
                       'mse': 0.0026877636555582285,
                       'psnr': 30.955209732055664,
                       'rmse': 0.05184364691376686,
                       'ssim': 0.9331125020980835},
               'pca': {'mae': 0.0065816245041787624,
                       'mse': 0.000133077337522991,
                       'psnr': 44.233036041259766,
                       'rmse': 0.011535915546119213,
                       'ssim': 0.9967113733291626}},
 'reconstructions': {'mae': 0.03347129374742508,
                     'mse': 0.0025681802071630955,
                     'psnr': 31.377822875976562,
                     'rmse': 0.05067721754312515,
                     'ssim': 0.9348869323730469},
 'residual_spectra_pcagan': {'cosine': [0.060659446,
                                        0.055439,
                                        0.20909882,
                                        0.049155105,
                                        0.17233942,
                                        0.04794868,
                                        0.036098283,
                                        0.004389877,
                                        0.0873201,
                                        0.2722534,
                                        0.30510888,
                                        0.39975694,
                                        0.023824526,
                                        0.30935168,
                                        0.35962138,
                                        0.026964376,
                                        0.3763373,
                                        0.33157527,
                                        0.38140655,
                                        0.32210174,
                                        0.31272635,
                                        0.3418912,
                                        0.3479123,
                                        0.37350088,
                                        0.08245227,
                                        0.008420926,
                                        0.18458024,
                                        0.009594074,
                                        0.09827718,
                                        0.0646855,
                                        0.09809185,
                                        0.038312487,
                                        0.019629197],
                             'mae': [0.010832161,
                                     0.011651498,
                                     0.010150054,
                                     0.012096193,
                                     0.010922632,
                                     0.014452257,
                                     0.014288587,
                                     0.015052249,
                                     0.013615228,
                                     0.013924718,
                                     0.011630555,
                                     0.009684814,
                                     0.014330687,
                                     0.011142464,
                                     0.011524293,
                                     0.0131745655,
                                     0.009496488,
                                     0.011073417,
                                     0.009857831,
                                     0.0108886715,
                                     0.0118522635,
                                     0.011667297,
                                     0.009859499,
                                     0.011128497,
                                     0.011854802,
                                     0.012619176,
                                     0.011088376,
                                     0.011984118,
                                     0.011330075,
                                     0.0109030185,
                                     0.010405586,
                                     0.0115875015,
                                     0.013455183],
                             'max_mae': 0.015052249,
                             'max_mse': 0.0004728138,
                             'max_rmse': 0.021744281,
                             'median_distance': 1.7270299,
                             'median_mae': 0.0115875015,
                             'min_cosine': 0.004389877,
                             'mse': [0.00021895635,
                                     0.00025568367,
                                     0.00021167114,
                                     0.00035815756,
                                     0.00022217527,
                                     0.00043171807,
                                     0.00040694608,
                                     0.0004728138,
                                     0.00042370238,
                                     0.00037749243,
                                     0.00029826316,
                                     0.00019374005,
                                     0.0004205414,
                                     0.00030233126,
                                     0.00026082832,
                                     0.00041669232,
                                     0.00019669475,
                                     0.00026775384,
                                     0.0002359209,
                                     0.00037798146,
                                     0.00030196676,
                                     0.00032540143,
                                     0.00023480396,
                                     0.00026256294,
                                     0.00025324212,
                                     0.00032365078,
                                     0.00031595412,
                                     0.0003220785,
                                     0.00027547413,
                                     0.0002173461,
                                     0.0002312479,
                                     0.00028000216,
                                     0.0003651353],
                             'rmse': [0.014797173,
                                      0.015990112,
                                      0.014548922,
                                      0.01892505,
                                      0.014905545,
                                      0.020777827,
                                      0.020172905,
                                      0.021744281,
                                      0.020584032,
                                      0.019429164,
                                      0.017270297,
                                      0.013919054,
                                      0.020507107,
                                      0.017387675,
                                      0.01615018,
                                      0.020413043,
                                      0.01402479,
                                      0.016363185,
                                      0.0153597165,
                                      0.019441744,
                                      0.01737719,
                                      0.018038888,
                                      0.015323314,
                                      0.016203795,
                                      0.015913583,
                                      0.017990297,
                                      0.017775098,
                                      0.017946545,
                                      0.016597413,
                                      0.014742662,
                                      0.015206837,
                                      0.016733265,
                                      0.019108513]},
 'residuals': {'mae': 0.011803779751062393,
               'mse': 0.00030481608700938523,
               'psnr': 20.137418746948242,
               'rmse': 0.01745898276567459,
               'ssds': [105.69071, 5.064673],
               'ssim': 0.3103387951850891},
 'spectra_pcagan': {'cosine': [0.99726325,
                               0.99922484,
                               0.98415,
                               0.99426717,
                               0.98327285,
                               0.99849164,
                               0.9989266,
                               0.9994086,
                               0.98158014,
                               0.99464685,
                               0.99689454,
                               0.9930728,
                               0.9991749,
                               0.99681133,
                               0.98491323,
                               0.9890103,
                               0.996745,
                               0.99483097,
                               0.9781043,
                               0.9921086,
                               0.9595816,
                               0.98029464,
                               0.9889729,
                               0.98125917,
                               0.98835486,
                               0.9993121,
                               0.9817062,
                               0.9973716,
                               0.9843288,
                               0.99538153,
                               0.99521804,
                               0.9983494,
                               0.9996882],
                    'mae': [0.018503107,
                            0.0149582885,
                            0.023180323,
                            0.02100646,
                            0.02383233,
                            0.01827737,
                            0.01731185,
                            0.019913815,
                            0.028603937,
                            0.048578158,
                            0.057146907,
                            0.030329913,
                            0.019975562,
                            0.053550348,
                            0.032350745,
                            0.02572012,
                            0.046672948,
                            0.04333711,
                            0.18039164,
                            0.029958114,
                            0.057439893,
                            0.032712996,
                            0.026006317,
                            0.04043233,
                            0.027405288,
                            0.017821645,
                            0.025505012,
                            0.020158524,
                            0.025088273,
                            0.020609843,
                            0.022037469,
                            0.018911563,
                            0.016824523],
                    'max_mae': 0.18039164,
                    'max_mse': 0.035245396,
                    'max_rmse': 0.18773757,
                    'median_mae': 0.025505012,
                    'min_cosine': 0.9595816,
                    'mse': [0.0005556445,
                            0.00035733593,
                            0.000901652,
                            0.00075355807,
                            0.00094397,
                            0.00057218655,
                            0.00048392863,
                            0.0005793288,
                            0.0013534928,
                            0.0036935837,
                            0.0054206094,
                            0.0015526207,
                            0.0006218818,
                            0.004226217,
                            0.0017166233,
                            0.0011144634,
                            0.003227586,
                            0.0029387386,
                            0.035245396,
                            0.0017289479,
                            0.004263877,
                            0.0018435935,
                            0.0011568619,
                            0.0024543493,
                            0.0012179083,
                            0.00048146877,
                            0.0011707165,
                            0.0006813621,
                            0.0010224533,
                            0.0006853072,
                            0.0007958041,
                            0.00057609763,
                            0.0004123649],
                    'rmse': [0.023572113,
                             0.018903332,
                             0.03002752,
                             0.027451012,
                             0.030724095,
                             0.02392042,
                             0.021998378,
                             0.02406925,
                             0.036789846,
                             0.06077486,
                             0.07362479,
                             0.03940331,
                             0.024937559,
                             0.06500936,
                             0.041432153,
                             0.03338358,
                             0.056811847,
                             0.054210134,
                             0.18773757,
                             0.041580617,
                             0.06529837,
                             0.04293709,
                             0.03401267,
                             0.04954139,
                             0.034898542,
                             0.021942398,
                             0.034215733,
                             0.026102914,
                             0.031975824,
                             0.026178373,
                             0.02821,
                             0.024002034,
                             0.02030677]},
 'spectra_realgan': {'cosine': [0.9972508,
                                0.9992217,
                                0.9832243,
                                0.9942407,
                                0.9827068,
                                0.99848765,
                                0.9989239,
                                0.99940866,
                                0.981297,
                                0.9941067,
                                0.9965379,
                                0.99172515,
                                0.99917454,
                                0.99628705,
                                0.98253846,
                                0.98896176,
                                0.9960904,
                                0.9940449,
                                0.9766165,
                                0.9904791,
                                0.95758724,
                                0.9774088,
                                0.98670197,
                                0.97857785,
                                0.9882232,
                                0.99931186,
                                0.9807606,
                                0.99736637,
                                0.9840904,
                                0.9953628,
                                0.9951784,
                                0.99834573,
                                0.9996884],
                     'mae': [0.01854198,
                             0.014985778,
                             0.023866238,
                             0.021071851,
                             0.024249308,
                             0.018311145,
                             0.017341811,
                             0.019904904,
                             0.028784158,
                             0.050913114,
                             0.059168078,
                             0.03345968,
                             0.019981595,
                             0.055011444,
                             0.03497756,
                             0.025771726,
                             0.048374493,
                             0.04506426,
                             0.18023531,
                             0.033359133,
                             0.05806259,
                             0.03555152,
                             0.02864439,
                             0.04216679,
                             0.02758377,
                             0.017824937,
                             0.026277814,
                             0.02017742,
                             0.02529138,
                             0.020647043,
                             0.022136098,
                             0.018928431,
                             0.016816907],
                     'max_mae': 0.18023531,
                     'max_mse': 0.035449803,
                     'max_rmse': 0.18828118,
                     'median_mae': 0.025771726,
                     'min_cosine': 0.95758724,
                     'mse': [0.00055797707,
                             0.00035868314,
                             0.00095437886,
                             0.0007570537,
                             0.0009759421,
                             0.0005737491,
                             0.00048503513,
                             0.0005789536,
                             0.0013730456,
                             0.004070556,
                             0.0057761464,
                             0.0018476741,
                             0.0006221682,
                             0.0045668185,
                             0.0019810996,
                             0.0011185808,
                             0.0035820708,
                             0.0032059634,
                             0.035449803,
                             0.0020360278,
                             0.004457984,
                             0.0021198776,
                             0.0013743723,
                             0.0027345,
                             0.0012311836,
                             0.00048168088,
                             0.0012288577,
                             0.0006819425,
                             0.0010366923,
                             0.0006882518,
                             0.0008001526,
                             0.0005767722,
                             0.0004122014],
                     'rmse': [0.023621539,
                              0.018938933,
                              0.030893022,
                              0.027514609,
                              0.031240072,
                              0.02395306,
                              0.022023514,
                              0.024061454,
                              0.03705463,
                              0.06380091,
                              0.076000966,
                              0.04298458,
                              0.0249433,
                              0.06757824,
                              0.044509545,
                              0.03344519,
                              0.059850402,
                              0.056621227,
                              0.18828118,
                              0.045122366,
                              0.06676814,
                              0.04604213,
                              0.03707253,
                              0.052292448,
                              0.035088226,
                              0.02194723,
                              0.035055067,
                              0.026114028,
                              0.032197706,
                              0.026234554,
                              0.02828697,
                              0.024016082,
                              0.020302743]},
 'spectra_realpca': {'cosine': [0.9999952,
                                0.9999992,
                                0.999131,
                                0.9999853,
                                0.999479,
                                0.9999985,
                                0.99999845,
                                0.99999994,
                                0.99975187,
                                0.9994233,
                                0.99963766,
                                0.99864066,
                                0.9999997,
                                0.99948215,
                                0.9976703,
                                0.999979,
                                0.9993455,
                                0.9991489,
                                0.9983802,
                                0.9983868,
                                0.9972706,
                                0.99743515,
                                0.9976402,
                                0.99726665,
                                0.99992853,
                                0.9999998,
                                0.99907905,
                                0.9999937,
                                0.999734,
                                0.9999826,
                                0.99996376,
                                0.99999785,
                                0.9999999],
                     'mae': [0.0007719345,
                             0.0004846299,
                             0.0054987217,
                             0.0010900582,
                             0.004256303,
                             0.000584437,
                             0.00060666597,
                             0.0002421348,
                             0.0033515526,
                             0.015773915,
                             0.016803324,
                             0.013680675,
                             0.00028602028,
                             0.015590407,
                             0.012680924,
                             0.0011426514,
                             0.01546774,
                             0.015212387,
                             0.013913962,
                             0.013962807,
                             0.012250941,
                             0.012174582,
                             0.011898683,
                             0.013490455,
                             0.002014434,
                             0.00023955484,
                             0.0058406754,
                             0.00094109774,
                             0.0031483704,
                             0.0012560021,
                             0.0017040813,
                             0.000622265,
                             0.00021118912],
                     'max_mae': 0.016803324,
                     'max_mse': 0.00045370957,
                     'max_rmse': 0.02130046,
                     'median_mae': 0.0033515526,
                     'min_cosine': 0.99726665,
                     'mse': [9.737037e-07,
                             3.7825367e-07,
                             4.865579e-05,
                             1.9189754e-06,
                             2.9155082e-05,
                             5.5406855e-07,
                             5.8861957e-07,
                             9.3501484e-08,
                             1.8041765e-05,
                             0.00039918342,
                             0.00045370957,
                             0.0002997343,
                             1.3201564e-07,
                             0.00039124064,
                             0.00025937238,
                             2.1058029e-06,
                             0.00038220087,
                             0.00037056004,
                             0.00033877458,
                             0.0003141616,
                             0.00023868479,
                             0.00023922668,
                             0.0002255934,
                             0.00028941504,
                             6.6201655e-06,
                             9.3409874e-08,
                             5.5032862e-05,
                             1.4271834e-06,
                             1.597058e-05,
                             2.5704976e-06,
                             4.6849614e-06,
                             6.2626304e-07,
                             7.1649346e-08],
                     'rmse': [0.0009867642,
                              0.0006150233,
                              0.0069753705,
                              0.0013852709,
                              0.0053995447,
                              0.0007443578,
                              0.00076721545,
                              0.00030578012,
                              0.0042475597,
                              0.019979576,
                              0.02130046,
                              0.017312836,
                              0.00036333958,
                              0.019779803,
                              0.016105043,
                              0.0014511385,
                              0.019549958,
                              0.019249937,
                              0.01840583,
                              0.017724603,
                              0.015449427,
                              0.015466955,
                              0.015019767,
                              0.017012203,
                              0.0025729681,
                              0.0003056303,
                              0.0074184136,
                              0.0011946479,
                              0.0039963205,
                              0.0016032772,
                              0.0021644772,
                              0.00079136784,
                              0.00026767395]}}
saved metrics in experiments/inpainting/gann_4_night_20180708_60/models/GANASTRO/0111_170354/comparison_85.0
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516
Directory path: experiments/inpainting/gann_4_night_20180722_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_85.0/images
Optimal number of principal components:  6
Reconstruction error:  14.858379
Energy conservation:  0.85331845
saved images in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_85.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.35918432275619, 3.0787149838966523],
                   'kl_div': 0.87764966,
                   'ks_tests': {10000: KstestResult(statistic=0.3033, pvalue=1e-323, statistic_location=0.008709056, statistic_sign=1),
                                20000: KstestResult(statistic=0.30215000000000003, pvalue=0.0, statistic_location=0.0087820375, statistic_sign=1),
                                30000: KstestResult(statistic=0.30389999999999995, pvalue=0.0, statistic_location=0.008725265, statistic_sign=1),
                                40000: KstestResult(statistic=0.30455, pvalue=0.0, statistic_location=0.008384475, statistic_sign=1),
                                50000: KstestResult(statistic=0.3034, pvalue=0.0, statistic_location=0.008411695, statistic_sign=1),
                                60000: KstestResult(statistic=0.30200000000000005, pvalue=0.0, statistic_location=0.008389483, statistic_sign=1),
                                70000: KstestResult(statistic=0.29965714285714284, pvalue=0.0, statistic_location=0.008685963, statistic_sign=1),
                                80000: KstestResult(statistic=0.30127500000000007, pvalue=0.0, statistic_location=0.008558279, statistic_sign=1),
                                90000: KstestResult(statistic=0.3019333333333334, pvalue=0.0, statistic_location=0.008730125, statistic_sign=1),
                                100000: KstestResult(statistic=0.3043, pvalue=0.0, statistic_location=0.008509729, statistic_sign=1),
                                110000: KstestResult(statistic=0.30369999999999997, pvalue=0.0, statistic_location=0.008769479, statistic_sign=1)},
                   'moments': {'mean_error': -0.006464453,
                               'means': [-0.00073593855, -3.6269714e-05],
                               'stds': [0.022726193, 0.005258862],
                               'variance_ratio': 8.888414}},
 'originals': {'gan': {'mae': 0.05885758250951767,
                       'mse': 0.005448393989354372,
                       'psnr': 27.10418128967285,
                       'rmse': 0.07381323724985123,
                       'ssim': 0.603545069694519},
               'pca': {'mae': 0.012440066784620285,
                       'mse': 0.00025148235727101564,
                       'psnr': 40.96150207519531,
                       'rmse': 0.01585819572210312,
                       'ssim': 0.9882647395133972}},
 'reconstructions': {'mae': 0.05746050551533699,
                     'mse': 0.005187508184462786,
                     'psnr': 27.816991806030273,
                     'rmse': 0.07202436029911041,
                     'ssim': 0.6042559742927551},
 'residual_spectra_pcagan': {'cosine': [0.25572246,
                                        0.2067584,
                                        0.22024022,
                                        0.2488746,
                                        0.22585282,
                                        0.2940679,
                                        0.26403168,
                                        0.21488567,
                                        0.21754636,
                                        0.20162937,
                                        0.24697572],
                             'mae': [0.014998587,
                                     0.0172103,
                                     0.017144931,
                                     0.016228022,
                                     0.014986597,
                                     0.014883407,
                                     0.013391846,
                                     0.018351156,
                                     0.020064678,
                                     0.019054046,
                                     0.016888456],
                             'max_mae': 0.020064678,
                             'max_mse': 0.0006294679,
                             'max_rmse': 0.025089199,
                             'median_distance': 2.2055933,
                             'median_mae': 0.016888456,
                             'min_cosine': 0.20162937,
                             'mse': [0.00038924225,
                                     0.0006187263,
                                     0.00051087275,
                                     0.00041959115,
                                     0.0004864643,
                                     0.00037425276,
                                     0.00036216335,
                                     0.0005400015,
                                     0.0006294679,
                                     0.00057147606,
                                     0.00047637383],
                             'rmse': [0.019729223,
                                      0.02487421,
                                      0.022602495,
                                      0.020483924,
                                      0.022055935,
                                      0.019345613,
                                      0.01903059,
                                      0.023237932,
                                      0.025089199,
                                      0.023905566,
                                      0.02182599]},
 'residuals': {'mae': 0.016654731705784798,
               'mse': 0.0004889665287919343,
               'psnr': 8.061763763427734,
               'rmse': 0.022112587466835976,
               'ssds': [56.87184, 3.0422363],
               'ssim': 0.12725834548473358},
 'spectra_pcagan': {'cosine': [0.9910517,
                               0.9840461,
                               0.9604736,
                               0.9508335,
                               0.95528704,
                               0.97188675,
                               0.97469074,
                               0.93886614,
                               0.9159937,
                               0.91675335,
                               0.9260121],
                    'mae': [0.07148678,
                            0.0727182,
                            0.062534206,
                            0.06504021,
                            0.045279723,
                            0.04310361,
                            0.03948433,
                            0.054657355,
                            0.062389098,
                            0.060016338,
                            0.055355683],
                    'max_mae': 0.0727182,
                    'max_mse': 0.00802603,
                    'max_rmse': 0.08958811,
                    'median_mae': 0.060016338,
                    'min_cosine': 0.9159937,
                    'mse': [0.0075815353,
                            0.00802603,
                            0.005713263,
                            0.006516446,
                            0.0031481492,
                            0.002813297,
                            0.0025313445,
                            0.004503888,
                            0.0059676515,
                            0.005409155,
                            0.0048518274],
                    'rmse': [0.087072015,
                             0.08958811,
                             0.07558613,
                             0.08072451,
                             0.05610837,
                             0.053040523,
                             0.05031247,
                             0.067111015,
                             0.07725058,
                             0.07354696,
                             0.06965506]},
 'spectra_realgan': {'cosine': [0.99050224,
                                0.98320454,
                                0.958425,
                                0.9485156,
                                0.95228004,
                                0.96986884,
                                0.97265184,
                                0.9365318,
                                0.912984,
                                0.91408354,
                                0.92231876],
                     'mae': [0.073525995,
                             0.07423982,
                             0.06392931,
                             0.066407725,
                             0.046533234,
                             0.044256676,
                             0.041072655,
                             0.05594315,
                             0.06368616,
                             0.06099438,
                             0.056844275],
                     'max_mae': 0.07423982,
                     'max_mse': 0.00842498,
                     'max_rmse': 0.09178769,
                     'median_mae': 0.06099438,
                     'min_cosine': 0.912984,
                     'mse': [0.008046477,
                             0.00842498,
                             0.0059988564,
                             0.0067990287,
                             0.0033501007,
                             0.0030101966,
                             0.0027172633,
                             0.004679983,
                             0.006192801,
                             0.005587246,
                             0.0051254076],
                     'rmse': [0.08970216,
                              0.09178769,
                              0.07745229,
                              0.08245622,
                              0.057880055,
                              0.05486526,
                              0.052127376,
                              0.068410404,
                              0.07869435,
                              0.07474788,
                              0.07159195]},
 'spectra_realpca': {'cosine': [0.9995509,
                                0.99933225,
                                0.99806756,
                                0.9976029,
                                0.99681157,
                                0.99814165,
                                0.9978321,
                                0.9973551,
                                0.99700516,
                                0.99680537,
                                0.99647766],
                     'mae': [0.015350708,
                             0.0144719845,
                             0.0132142715,
                             0.0131817935,
                             0.011729642,
                             0.01081063,
                             0.011233364,
                             0.011127689,
                             0.011770149,
                             0.011671161,
                             0.012279343],
                     'max_mae': 0.015350708,
                     'max_mse': 0.00037923397,
                     'max_rmse': 0.01947393,
                     'median_mae': 0.011770149,
                     'min_cosine': 0.99647766,
                     'mse': [0.00037923397,
                             0.0003374965,
                             0.00028295646,
                             0.00027776975,
                             0.00021992967,
                             0.00018771504,
                             0.00020198434,
                             0.00020095438,
                             0.00022203894,
                             0.0002161667,
                             0.00024006011],
                     'rmse': [0.01947393,
                              0.018371077,
                              0.01682131,
                              0.016666425,
                              0.014830026,
                              0.013700914,
                              0.014212119,
                              0.014175838,
                              0.014900971,
                              0.014702609,
                              0.0154938735]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_20/models/GANASTRO/0112_004516/comparison_85.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115
Directory path: experiments/inpainting/gann_4_night_20180722_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_85.0/images
Optimal number of principal components:  6
Reconstruction error:  14.858379
Energy conservation:  0.85331845
saved images in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_85.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.22363691969865, 3.0701138204831673],
                   'kl_div': 0.6636355,
                   'ks_tests': {10000: KstestResult(statistic=0.2669, pvalue=1.45498276194e-313, statistic_location=0.008201122, statistic_sign=1),
                                20000: KstestResult(statistic=0.25955000000000006, pvalue=0.0, statistic_location=0.0077779414, statistic_sign=1),
                                30000: KstestResult(statistic=0.25660000000000005, pvalue=0.0, statistic_location=0.008529748, statistic_sign=1),
                                40000: KstestResult(statistic=0.259675, pvalue=0.0, statistic_location=0.008110693, statistic_sign=1),
                                50000: KstestResult(statistic=0.25862000000000007, pvalue=0.0, statistic_location=0.008294651, statistic_sign=1),
                                60000: KstestResult(statistic=0.2606833333333334, pvalue=0.0, statistic_location=0.008293704, statistic_sign=1),
                                70000: KstestResult(statistic=0.2556285714285714, pvalue=0.0, statistic_location=0.0083758775, statistic_sign=1),
                                80000: KstestResult(statistic=0.25778749999999995, pvalue=0.0, statistic_location=0.007950671, statistic_sign=1),
                                90000: KstestResult(statistic=0.2576555555555555, pvalue=0.0, statistic_location=0.008303807, statistic_sign=1),
                                100000: KstestResult(statistic=0.26026000000000005, pvalue=0.0, statistic_location=0.008310685, statistic_sign=1),
                                110000: KstestResult(statistic=0.25861818181818186, pvalue=0.0, statistic_location=0.00837902, statistic_sign=1),
                                120000: KstestResult(statistic=0.2593416666666667, pvalue=0.0, statistic_location=0.008293487, statistic_sign=1),
                                130000: KstestResult(statistic=0.258423076923077, pvalue=0.0, statistic_location=0.007918483, statistic_sign=1),
                                140000: KstestResult(statistic=0.2591785714285715, pvalue=0.0, statistic_location=0.00837902, statistic_sign=1),
                                150000: KstestResult(statistic=0.25924, pvalue=0.0, statistic_location=0.007998537, statistic_sign=1),
                                160000: KstestResult(statistic=0.26025, pvalue=0.0, statistic_location=0.008194479, statistic_sign=1),
                                170000: KstestResult(statistic=0.2568529411764705, pvalue=0.0, statistic_location=0.008329721, statistic_sign=1),
                                180000: KstestResult(statistic=0.2583500000000001, pvalue=0.0, statistic_location=0.008288745, statistic_sign=1),
                                190000: KstestResult(statistic=0.2583263157894736, pvalue=0.0, statistic_location=0.008282907, statistic_sign=1),
                                200000: KstestResult(statistic=0.2587499999999999, pvalue=0.0, statistic_location=0.00840148, statistic_sign=1),
                                210000: KstestResult(statistic=0.25668095238095245, pvalue=0.0, statistic_location=0.007907844, statistic_sign=1),
                                220000: KstestResult(statistic=0.25863636363636366, pvalue=0.0, statistic_location=0.008001009, statistic_sign=1)},
                   'moments': {'mean_error': -0.013360852,
                               'means': [-0.00054423965, 2.2725493e-05],
                               'stds': [0.019667108, 0.0052194363],
                               'variance_ratio': 9.2002735}},
 'originals': {'gan': {'mae': 0.05455929413437843,
                       'mse': 0.004739472642540932,
                       'psnr': 27.725784301757812,
                       'rmse': 0.06884382665157318,
                       'ssim': 0.6566916704177856},
               'pca': {'mae': 0.012568891979753971,
                       'mse': 0.0002560514258220792,
                       'psnr': 40.88330841064453,
                       'rmse': 0.016001606360077858,
                       'ssim': 0.9804759621620178}},
 'reconstructions': {'mae': 0.0529976561665535,
                     'mse': 0.004478157963603735,
                     'psnr': 28.455585479736328,
                     'rmse': 0.06691904366016388,
                     'ssim': 0.6622613668441772},
 'residual_spectra_pcagan': {'cosine': [0.2785318,
                                        0.25612715,
                                        0.2719957,
                                        0.2980816,
                                        0.23090169,
                                        0.28141546,
                                        0.22556463,
                                        0.24825507,
                                        0.28165257,
                                        0.25088263,
                                        0.32290062,
                                        0.28913975,
                                        0.24027161,
                                        0.24552172,
                                        0.23129483,
                                        0.26700652,
                                        0.24387686,
                                        0.27241877,
                                        0.30368307,
                                        0.29788584,
                                        0.22852823,
                                        0.27433208],
                             'mae': [0.010549919,
                                     0.010800126,
                                     0.010094786,
                                     0.01039124,
                                     0.012842427,
                                     0.012951688,
                                     0.015281592,
                                     0.014935955,
                                     0.013959332,
                                     0.013080693,
                                     0.013073372,
                                     0.011952297,
                                     0.016185611,
                                     0.01785202,
                                     0.016706811,
                                     0.015223551,
                                     0.016025385,
                                     0.013850446,
                                     0.013873619,
                                     0.012508666,
                                     0.016561162,
                                     0.012982447],
                             'max_mae': 0.01785202,
                             'max_mse': 0.000505837,
                             'max_rmse': 0.02249082,
                             'median_distance': 1.8178384,
                             'median_mae': 0.013465569,
                             'min_cosine': 0.22556463,
                             'mse': [0.00025992878,
                                     0.0003051241,
                                     0.00030076035,
                                     0.00024344465,
                                     0.0003310378,
                                     0.0003057252,
                                     0.000505837,
                                     0.00039803877,
                                     0.0003238747,
                                     0.00039539527,
                                     0.00029489637,
                                     0.00029989058,
                                     0.00043791847,
                                     0.0005039896,
                                     0.0004499341,
                                     0.00040082244,
                                     0.00041660853,
                                     0.000356986,
                                     0.0003208107,
                                     0.000297503,
                                     0.00045107736,
                                     0.00032987024],
                             'rmse': [0.016122308,
                                      0.017467802,
                                      0.017342445,
                                      0.0156027125,
                                      0.018194444,
                                      0.017485,
                                      0.02249082,
                                      0.01995091,
                                      0.01799652,
                                      0.01988455,
                                      0.017172547,
                                      0.01731735,
                                      0.020926502,
                                      0.022449711,
                                      0.02121165,
                                      0.02002055,
                                      0.02041099,
                                      0.018894073,
                                      0.01791119,
                                      0.017248275,
                                      0.021238582,
                                      0.01816233]},
 'residuals': {'mae': 0.013712870888411999,
               'mse': 0.0003604306257329881,
               'psnr': 16.499614715576172,
               'rmse': 0.01898501068353653,
               'ssds': [85.1597, 5.993439],
               'ssim': 0.16754741966724396},
 'spectra_pcagan': {'cosine': [0.99040973,
                               0.9906209,
                               0.9860444,
                               0.9814924,
                               0.98478353,
                               0.9912269,
                               0.9844414,
                               0.9614565,
                               0.9523153,
                               0.95611835,
                               0.9726373,
                               0.9753405,
                               0.9405952,
                               0.91707194,
                               0.91799515,
                               0.92587334,
                               0.90424246,
                               0.9610479,
                               0.94651675,
                               0.96379215,
                               0.92783105,
                               0.9553481],
                    'mae': [0.049118426,
                            0.048394598,
                            0.042097647,
                            0.03867554,
                            0.056876715,
                            0.07064319,
                            0.07162472,
                            0.06180849,
                            0.06370803,
                            0.044770665,
                            0.04268048,
                            0.039010737,
                            0.05376623,
                            0.061983466,
                            0.05943373,
                            0.055391166,
                            0.06211817,
                            0.045103498,
                            0.0520935,
                            0.041774448,
                            0.05863616,
                            0.04623897],
                    'max_mae': 0.07162472,
                    'max_mse': 0.00784383,
                    'max_rmse': 0.088565394,
                    'median_mae': 0.052929863,
                    'min_cosine': 0.90424246,
                    'mse': [0.003931162,
                            0.0040353113,
                            0.0029357914,
                            0.002388913,
                            0.004789679,
                            0.007420387,
                            0.00784383,
                            0.0055872244,
                            0.0062758033,
                            0.0031145092,
                            0.0027494226,
                            0.0025012202,
                            0.0043771532,
                            0.0059028617,
                            0.0053340713,
                            0.0048645954,
                            0.0061294534,
                            0.0031280352,
                            0.003936399,
                            0.0028676295,
                            0.0052265157,
                            0.0031795045],
                    'rmse': [0.062698975,
                             0.0635241,
                             0.054182943,
                             0.048876505,
                             0.069207504,
                             0.08614167,
                             0.088565394,
                             0.07474774,
                             0.07921997,
                             0.055807788,
                             0.052434936,
                             0.0500122,
                             0.06616006,
                             0.07683008,
                             0.073034726,
                             0.06974665,
                             0.07829083,
                             0.05592884,
                             0.06274073,
                             0.05355025,
                             0.072294645,
                             0.056387097]},
 'spectra_realgan': {'cosine': [0.9896691,
                                0.9898579,
                                0.98456603,
                                0.9791487,
                                0.983875,
                                0.9906742,
                                0.9836056,
                                0.95940924,
                                0.950004,
                                0.9531188,
                                0.9706316,
                                0.9733282,
                                0.93827266,
                                0.91403544,
                                0.91530865,
                                0.92216086,
                                0.9011053,
                                0.9585088,
                                0.94279194,
                                0.9608301,
                                0.92520034,
                                0.95235986],
                     'mae': [0.05091956,
                             0.05065085,
                             0.044404034,
                             0.041118804,
                             0.058669947,
                             0.07273627,
                             0.07316233,
                             0.063168325,
                             0.06512662,
                             0.046040375,
                             0.04382759,
                             0.040590435,
                             0.05506352,
                             0.06331624,
                             0.060418434,
                             0.056880366,
                             0.06340985,
                             0.046374947,
                             0.05363102,
                             0.043673262,
                             0.059573457,
                             0.04754814],
                     'max_mae': 0.07316233,
                     'max_mse': 0.008238449,
                     'max_rmse': 0.0907659,
                     'median_mae': 0.05434727,
                     'min_cosine': 0.9011053,
                     'mse': [0.0042169,
                             0.00437998,
                             0.003240988,
                             0.0026799885,
                             0.0051155905,
                             0.007887149,
                             0.008238449,
                             0.005872001,
                             0.006557111,
                             0.0033155568,
                             0.0029443847,
                             0.0026845408,
                             0.004551976,
                             0.006129314,
                             0.005513082,
                             0.0051394324,
                             0.0063526644,
                             0.0033178928,
                             0.004240858,
                             0.0030703791,
                             0.005419961,
                             0.0034001968],
                     'rmse': [0.064937666,
                              0.066181414,
                              0.056929674,
                              0.051768605,
                              0.07152335,
                              0.088809624,
                              0.0907659,
                              0.07662898,
                              0.080975994,
                              0.057580873,
                              0.054262184,
                              0.051812556,
                              0.06746833,
                              0.07828993,
                              0.07425013,
                              0.07168984,
                              0.07970361,
                              0.057601154,
                              0.06512187,
                              0.055411004,
                              0.07362039,
                              0.058311205]},
 'spectra_realpca': {'cosine': [0.999165,
                                0.99924165,
                                0.9984206,
                                0.99752736,
                                0.99899054,
                                0.9995509,
                                0.99933225,
                                0.99806756,
                                0.9976029,
                                0.99681157,
                                0.99814165,
                                0.9978321,
                                0.9973551,
                                0.99700516,
                                0.99680537,
                                0.99647766,
                                0.99665725,
                                0.997292,
                                0.9965603,
                                0.9970874,
                                0.9978292,
                                0.9965389],
                     'mae': [0.0144260265,
                             0.014347557,
                             0.013361859,
                             0.013169621,
                             0.014276566,
                             0.015350708,
                             0.0144719845,
                             0.0132142715,
                             0.0131817935,
                             0.011729642,
                             0.01081063,
                             0.011233364,
                             0.011127689,
                             0.011770149,
                             0.011671161,
                             0.012279343,
                             0.011873404,
                             0.011649324,
                             0.012757539,
                             0.011669243,
                             0.009942609,
                             0.01220113],
                     'max_mae': 0.015350708,
                     'max_mse': 0.00037923397,
                     'max_rmse': 0.01947393,
                     'median_mae': 0.012240237,
                     'min_cosine': 0.99647766,
                     'mse': [0.00033261604,
                             0.00032892296,
                             0.0002864772,
                             0.00027393203,
                             0.00032424188,
                             0.00037923397,
                             0.0003374965,
                             0.00028295646,
                             0.00027776975,
                             0.00021992967,
                             0.00018771504,
                             0.00020198434,
                             0.00020095438,
                             0.00022203894,
                             0.0002161667,
                             0.00024006011,
                             0.0002251918,
                             0.00021817308,
                             0.00026021592,
                             0.0002180013,
                             0.00016108624,
                             0.00023796703],
                     'rmse': [0.018237764,
                              0.018136233,
                              0.016925639,
                              0.016550893,
                              0.018006718,
                              0.01947393,
                              0.018371077,
                              0.01682131,
                              0.016666425,
                              0.014830026,
                              0.013700914,
                              0.014212119,
                              0.014175838,
                              0.014900971,
                              0.014702609,
                              0.0154938735,
                              0.015006392,
                              0.014770683,
                              0.01613121,
                              0.014764867,
                              0.012691976,
                              0.01542618]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_40/models/GANASTRO/0112_005115/comparison_85.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453
Directory path: experiments/inpainting/gann_4_night_20180722_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_85.0/images
Optimal number of principal components:  6
Reconstruction error:  14.858379
Energy conservation:  0.85331845
saved images in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_85.0/spectra/obs_1
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180722_cb4240_ce4340.npz
{'distributions': {'entropies': [4.111089078084709, 3.0387153224849186],
                   'kl_div': 0.54672253,
                   'ks_tests': {10000: KstestResult(statistic=0.2232, pvalue=1.3214384633841424e-218, statistic_location=0.007233382, statistic_sign=1),
                                20000: KstestResult(statistic=0.22815000000000007, pvalue=0.0, statistic_location=0.007306533, statistic_sign=1),
                                30000: KstestResult(statistic=0.22306666666666664, pvalue=0.0, statistic_location=0.0074391775, statistic_sign=1),
                                40000: KstestResult(statistic=0.22919999999999996, pvalue=0.0, statistic_location=0.0071588755, statistic_sign=1),
                                50000: KstestResult(statistic=0.22840000000000005, pvalue=0.0, statistic_location=0.0075071054, statistic_sign=1),
                                60000: KstestResult(statistic=0.22678333333333334, pvalue=0.0, statistic_location=0.0074869487, statistic_sign=1),
                                70000: KstestResult(statistic=0.22859999999999991, pvalue=0.0, statistic_location=0.0071239527, statistic_sign=1),
                                80000: KstestResult(statistic=0.22826250000000003, pvalue=0.0, statistic_location=0.007227804, statistic_sign=1),
                                90000: KstestResult(statistic=0.2274666666666667, pvalue=0.0, statistic_location=0.0073488113, statistic_sign=1),
                                100000: KstestResult(statistic=0.22778999999999994, pvalue=0.0, statistic_location=0.0073874826, statistic_sign=1),
                                110000: KstestResult(statistic=0.2278, pvalue=0.0, statistic_location=0.0074782986, statistic_sign=1),
                                120000: KstestResult(statistic=0.22666666666666657, pvalue=0.0, statistic_location=0.0072267065, statistic_sign=1),
                                130000: KstestResult(statistic=0.22686923076923082, pvalue=0.0, statistic_location=0.0073093837, statistic_sign=1),
                                140000: KstestResult(statistic=0.2270714285714286, pvalue=0.0, statistic_location=0.0078081037, statistic_sign=1),
                                150000: KstestResult(statistic=0.22642000000000007, pvalue=0.0, statistic_location=0.0074329246, statistic_sign=1),
                                160000: KstestResult(statistic=0.22623749999999998, pvalue=0.0, statistic_location=0.007451563, statistic_sign=1),
                                170000: KstestResult(statistic=0.22739999999999994, pvalue=0.0, statistic_location=0.007387613, statistic_sign=1),
                                180000: KstestResult(statistic=0.22524444444444447, pvalue=0.0, statistic_location=0.007077033, statistic_sign=1),
                                190000: KstestResult(statistic=0.22799473684210525, pvalue=0.0, statistic_location=0.0074293795, statistic_sign=1),
                                200000: KstestResult(statistic=0.22675, pvalue=0.0, statistic_location=0.0072267964, statistic_sign=1),
                                210000: KstestResult(statistic=0.22660952380952382, pvalue=0.0, statistic_location=0.0073149325, statistic_sign=1),
                                220000: KstestResult(statistic=0.22763636363636364, pvalue=0.0, statistic_location=0.007463075, statistic_sign=1),
                                230000: KstestResult(statistic=0.22775217391304348, pvalue=0.0, statistic_location=0.007494823, statistic_sign=1),
                                240000: KstestResult(statistic=0.22759166666666675, pvalue=0.0, statistic_location=0.0073971096, statistic_sign=1),
                                250000: KstestResult(statistic=0.227244, pvalue=0.0, statistic_location=0.0074293013, statistic_sign=1),
                                260000: KstestResult(statistic=0.2263423076923078, pvalue=0.0, statistic_location=0.007433501, statistic_sign=1),
                                270000: KstestResult(statistic=0.22825925925925927, pvalue=0.0, statistic_location=0.0074293795, statistic_sign=1),
                                280000: KstestResult(statistic=0.22790357142857143, pvalue=0.0, statistic_location=0.0076490436, statistic_sign=1),
                                290000: KstestResult(statistic=0.22905172413793107, pvalue=0.0, statistic_location=0.007226671, statistic_sign=1),
                                300000: KstestResult(statistic=0.22704333333333337, pvalue=0.0, statistic_location=0.007233382, statistic_sign=1),
                                310000: KstestResult(statistic=0.2278870967741936, pvalue=0.0, statistic_location=0.0073827086, statistic_sign=1),
                                320000: KstestResult(statistic=0.22586249999999997, pvalue=0.0, statistic_location=0.00746092, statistic_sign=1),
                                330000: KstestResult(statistic=0.22777575757575763, pvalue=0.0, statistic_location=0.0075534433, statistic_sign=1)},
                   'moments': {'mean_error': -0.014879102,
                               'means': [-0.00039863147, 1.29266e-05],
                               'stds': [0.017679268, 0.0050642],
                               'variance_ratio': 9.739556}},
 'originals': {'gan': {'mae': 0.05171003192663193,
                       'mse': 0.004362098407000303,
                       'psnr': 28.81952667236328,
                       'rmse': 0.06604618579149246,
                       'ssim': 0.7228677272796631},
               'pca': {'mae': 0.012744254432618618,
                       'mse': 0.0002692169800866395,
                       'psnr': 41.164588928222656,
                       'rmse': 0.016407832503318787,
                       'ssim': 0.9835413098335266}},
 'reconstructions': {'mae': 0.049897875636816025,
                     'mse': 0.004084094427525997,
                     'psnr': 29.354658126831055,
                     'rmse': 0.06390692293643951,
                     'ssim': 0.7298417687416077},
 'residual_spectra_pcagan': {'cosine': [0.101706944,
                                        0.2439521,
                                        0.3370185,
                                        0.28546196,
                                        0.31338564,
                                        0.26876622,
                                        0.28950402,
                                        0.26525563,
                                        0.3031825,
                                        0.31592172,
                                        0.23263156,
                                        0.2950086,
                                        0.23963208,
                                        0.26926893,
                                        0.30104238,
                                        0.27276346,
                                        0.34433705,
                                        0.31769958,
                                        0.25628924,
                                        0.26414353,
                                        0.25129172,
                                        0.27646792,
                                        0.26007423,
                                        0.29538965,
                                        0.32697004,
                                        0.32915565,
                                        0.24377407,
                                        0.28975314,
                                        0.35249537,
                                        0.3567038,
                                        0.31058562,
                                        0.33352196,
                                        0.28384143],
                             'mae': [0.011659389,
                                     0.011474382,
                                     0.009088354,
                                     0.009421959,
                                     0.009197904,
                                     0.010482831,
                                     0.009970845,
                                     0.010412204,
                                     0.00945218,
                                     0.010142486,
                                     0.012312412,
                                     0.012030024,
                                     0.014281182,
                                     0.013904574,
                                     0.012783734,
                                     0.012099585,
                                     0.011969734,
                                     0.011233678,
                                     0.015060774,
                                     0.016584326,
                                     0.015351825,
                                     0.01423609,
                                     0.014695827,
                                     0.012806919,
                                     0.012808981,
                                     0.011383738,
                                     0.015249809,
                                     0.012222333,
                                     0.009230198,
                                     0.009584928,
                                     0.009278684,
                                     0.0094287675,
                                     0.0110754315],
                             'max_mae': 0.016584326,
                             'max_mse': 0.0004391983,
                             'max_rmse': 0.020957058,
                             'median_distance': 1.6715423,
                             'median_mae': 0.011659389,
                             'min_cosine': 0.101706944,
                             'mse': [0.00024605187,
                                     0.0003142581,
                                     0.0001878134,
                                     0.00024074907,
                                     0.00018862315,
                                     0.00030087976,
                                     0.00024249668,
                                     0.00028506378,
                                     0.00024046807,
                                     0.00021719698,
                                     0.00032244142,
                                     0.0002652778,
                                     0.0004391983,
                                     0.00034420053,
                                     0.00027940536,
                                     0.00033232887,
                                     0.00024914023,
                                     0.00025582357,
                                     0.00039129172,
                                     0.00043749332,
                                     0.00037936468,
                                     0.00036704543,
                                     0.00035938073,
                                     0.00030852342,
                                     0.00027554526,
                                     0.0002447834,
                                     0.0003835082,
                                     0.00029033492,
                                     0.00018665905,
                                     0.00018515276,
                                     0.00020946117,
                                     0.00022179382,
                                     0.00029725966],
                             'rmse': [0.01568604,
                                      0.017727327,
                                      0.013704503,
                                      0.01551609,
                                      0.013734015,
                                      0.017345887,
                                      0.015572305,
                                      0.016883831,
                                      0.015507033,
                                      0.014737604,
                                      0.017956654,
                                      0.016287351,
                                      0.020957058,
                                      0.018552642,
                                      0.016715422,
                                      0.018229889,
                                      0.015784176,
                                      0.015994485,
                                      0.019781094,
                                      0.02091634,
                                      0.019477285,
                                      0.01915843,
                                      0.01895734,
                                      0.017564835,
                                      0.016599556,
                                      0.015645556,
                                      0.019583365,
                                      0.017039217,
                                      0.013662322,
                                      0.013607085,
                                      0.014472773,
                                      0.014892744,
                                      0.017241219]},
 'residuals': {'mae': 0.011845942586660385,
               'mse': 0.0002875459031201899,
               'psnr': 17.480758666992188,
               'rmse': 0.016957178711891174,
               'ssds': [103.19576, 8.463252],
               'ssim': 0.21634668111801147},
 'spectra_pcagan': {'cosine': [0.9959901,
                               0.9942805,
                               0.9956221,
                               0.9947213,
                               0.9958708,
                               0.9942073,
                               0.9904281,
                               0.99035895,
                               0.9855384,
                               0.98041004,
                               0.9842835,
                               0.99094474,
                               0.9841096,
                               0.96082896,
                               0.95297694,
                               0.9561671,
                               0.97304094,
                               0.9754945,
                               0.9405972,
                               0.9185696,
                               0.9186701,
                               0.9267548,
                               0.90530497,
                               0.96182734,
                               0.94765425,
                               0.9645024,
                               0.92882156,
                               0.9552111,
                               0.97402406,
                               0.97684294,
                               0.9872028,
                               0.98770225,
                               0.98947597],
                    'mae': [0.03000419,
                            0.04156178,
                            0.049124934,
                            0.04893663,
                            0.056179687,
                            0.061594855,
                            0.049161077,
                            0.049115546,
                            0.043043397,
                            0.039969843,
                            0.057684496,
                            0.07156101,
                            0.07225951,
                            0.062333472,
                            0.06296484,
                            0.04471446,
                            0.04228636,
                            0.03916494,
                            0.05367107,
                            0.061472204,
                            0.059255272,
                            0.054896045,
                            0.061663967,
                            0.044791203,
                            0.05169516,
                            0.04159628,
                            0.058252208,
                            0.04647698,
                            0.03894222,
                            0.035169035,
                            0.03680134,
                            0.03918225,
                            0.041103676],
                    'max_mae': 0.07225951,
                    'max_mse': 0.008013888,
                    'max_rmse': 0.08952032,
                    'median_mae': 0.049115546,
                    'min_cosine': 0.90530497,
                    'mse': [0.001380031,
                            0.0031039845,
                            0.003899328,
                            0.003948024,
                            0.0047347494,
                            0.006177174,
                            0.003908931,
                            0.00414606,
                            0.0030134656,
                            0.0025168003,
                            0.004945621,
                            0.0076558013,
                            0.008013888,
                            0.0056852666,
                            0.006141476,
                            0.003126366,
                            0.0027136581,
                            0.0025170662,
                            0.0043753977,
                            0.0058101267,
                            0.005307863,
                            0.004794548,
                            0.0060772435,
                            0.0031020688,
                            0.0038733024,
                            0.0028509002,
                            0.0051797777,
                            0.0032158196,
                            0.002513394,
                            0.002041333,
                            0.002321407,
                            0.0025376843,
                            0.0031465571],
                    'rmse': [0.03714877,
                             0.055713415,
                             0.062444597,
                             0.0628333,
                             0.06880952,
                             0.078595,
                             0.06252144,
                             0.06438991,
                             0.05489504,
                             0.05016772,
                             0.07032511,
                             0.087497436,
                             0.08952032,
                             0.07540071,
                             0.07836757,
                             0.055913918,
                             0.052092783,
                             0.050170373,
                             0.06614679,
                             0.076224186,
                             0.072855085,
                             0.06924267,
                             0.07795668,
                             0.05569622,
                             0.062235862,
                             0.053393822,
                             0.07197067,
                             0.056708198,
                             0.05013376,
                             0.04518111,
                             0.048180982,
                             0.05037543,
                             0.05609418]},
 'spectra_realgan': {'cosine': [0.99594945,
                                0.993599,
                                0.9950832,
                                0.9941495,
                                0.9954565,
                                0.99380606,
                                0.9896941,
                                0.98959345,
                                0.9840586,
                                0.9780391,
                                0.98338234,
                                0.99038804,
                                0.983271,
                                0.9587497,
                                0.95064867,
                                0.95316404,
                                0.97102016,
                                0.97345513,
                                0.93828213,
                                0.9155233,
                                0.9159966,
                                0.92306614,
                                0.90216774,
                                0.95925295,
                                0.9439704,
                                0.96156967,
                                0.92616457,
                                0.95225024,
                                0.9714461,
                                0.9741205,
                                0.98563623,
                                0.98602635,
                                0.98827475],
                     'mae': [0.030195968,
                             0.04384645,
                             0.05171915,
                             0.051315956,
                             0.0585284,
                             0.064356156,
                             0.05100211,
                             0.051354375,
                             0.045245912,
                             0.04232188,
                             0.059441272,
                             0.07366079,
                             0.073836826,
                             0.063720815,
                             0.06439157,
                             0.04602444,
                             0.04345906,
                             0.040787138,
                             0.05499627,
                             0.062789485,
                             0.06026786,
                             0.056387287,
                             0.0629972,
                             0.04607277,
                             0.05318295,
                             0.04348565,
                             0.059214,
                             0.047780782,
                             0.041187927,
                             0.037686408,
                             0.039182164,
                             0.041614648,
                             0.04437734],
                     'max_mae': 0.073836826,
                     'max_mse': 0.008408905,
                     'max_rmse': 0.091700085,
                     'median_mae': 0.051315956,
                     'min_cosine': 0.90216774,
                     'mse': [0.0013965998,
                             0.0033654594,
                             0.0043091304,
                             0.0043066847,
                             0.0051687118,
                             0.00663488,
                             0.004193502,
                             0.0044916635,
                             0.0033190364,
                             0.002811561,
                             0.005270784,
                             0.008125987,
                             0.008408905,
                             0.005973664,
                             0.0064246827,
                             0.0033273175,
                             0.0029098277,
                             0.0027023253,
                             0.0045493,
                             0.0060367663,
                             0.005485335,
                             0.0050676977,
                             0.006299948,
                             0.0032926055,
                             0.0041749026,
                             0.0030507362,
                             0.0053743967,
                             0.0034350727,
                             0.0027860254,
                             0.0022955164,
                             0.0025833887,
                             0.0028579237,
                             0.0035189064],
                     'rmse': [0.03737111,
                              0.05801258,
                              0.065643966,
                              0.06562533,
                              0.07189375,
                              0.08145477,
                              0.06475726,
                              0.06701987,
                              0.057611078,
                              0.053024154,
                              0.07260016,
                              0.090144254,
                              0.091700085,
                              0.077289484,
                              0.08015412,
                              0.057682905,
                              0.05394282,
                              0.051983897,
                              0.0674485,
                              0.07769663,
                              0.07406305,
                              0.071187764,
                              0.07937221,
                              0.05738123,
                              0.064613484,
                              0.05523347,
                              0.07331028,
                              0.058609493,
                              0.052782815,
                              0.047911547,
                              0.05082705,
                              0.05345955,
                              0.05932037]},
 'spectra_realpca': {'cosine': [0.99998254,
                                0.99928737,
                                0.99947566,
                                0.9994146,
                                0.99955606,
                                0.99957377,
                                0.999165,
                                0.99924165,
                                0.9984206,
                                0.99752736,
                                0.99899054,
                                0.9995509,
                                0.99933225,
                                0.99806756,
                                0.9976029,
                                0.99681157,
                                0.99814165,
                                0.9978321,
                                0.9973551,
                                0.99700516,
                                0.99680537,
                                0.99647766,
                                0.99665725,
                                0.997292,
                                0.9965603,
                                0.9970874,
                                0.9978292,
                                0.9965389,
                                0.9972962,
                                0.99706537,
                                0.99825066,
                                0.9983682,
                                0.99885654],
                     'mae': [0.0019340931,
                             0.014208445,
                             0.015111459,
                             0.014947891,
                             0.015458226,
                             0.01551427,
                             0.0144260265,
                             0.014347557,
                             0.013361859,
                             0.013169621,
                             0.014276566,
                             0.015350708,
                             0.0144719845,
                             0.0132142715,
                             0.0131817935,
                             0.011729642,
                             0.01081063,
                             0.011233364,
                             0.011127689,
                             0.011770149,
                             0.011671161,
                             0.012279343,
                             0.011873404,
                             0.011649324,
                             0.012757539,
                             0.011669243,
                             0.009942609,
                             0.01220113,
                             0.012869708,
                             0.01271216,
                             0.013430655,
                             0.01361274,
                             0.014245132],
                     'max_mae': 0.01551427,
                     'max_mse': 0.00038298656,
                     'max_rmse': 0.019570043,
                     'median_mae': 0.013169621,
                     'min_cosine': 0.99647766,
                     'mse': [6.0553884e-06,
                             0.00032616267,
                             0.00036631175,
                             0.00035447557,
                             0.0003806159,
                             0.00038298656,
                             0.00033261604,
                             0.00032892296,
                             0.0002864772,
                             0.00027393203,
                             0.00032424188,
                             0.00037923397,
                             0.0003374965,
                             0.00028295646,
                             0.00027776975,
                             0.00021992967,
                             0.00018771504,
                             0.00020198434,
                             0.00020095438,
                             0.00022203894,
                             0.0002161667,
                             0.00024006011,
                             0.0002251918,
                             0.00021817308,
                             0.00026021592,
                             0.0002180013,
                             0.00016108624,
                             0.00023796703,
                             0.00026381176,
                             0.0002595092,
                             0.000290415,
                             0.00029589457,
                             0.00032478946],
                     'rmse': [0.0024607698,
                              0.018059975,
                              0.019139273,
                              0.018827522,
                              0.01950938,
                              0.019570043,
                              0.018237764,
                              0.018136233,
                              0.016925639,
                              0.016550893,
                              0.018006718,
                              0.01947393,
                              0.018371077,
                              0.01682131,
                              0.016666425,
                              0.014830026,
                              0.013700914,
                              0.014212119,
                              0.014175838,
                              0.014900971,
                              0.014702609,
                              0.0154938735,
                              0.015006392,
                              0.014770683,
                              0.01613121,
                              0.014764867,
                              0.012691976,
                              0.01542618,
                              0.016242282,
                              0.01610929,
                              0.017041566,
                              0.017201586,
                              0.018021917]}}
saved metrics in experiments/inpainting/gann_4_night_20180722_60/models/GANASTRO/0112_100453/comparison_85.0
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957
Directory path: experiments/inpainting/gann_4_night_20180723_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_85.0/images
Optimal number of principal components:  32
Reconstruction error:  12.537442
Energy conservation:  0.851037
saved images in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_85.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.075287224842861, 2.5393062582998147],
                   'kl_div': 0.9968593,
                   'ks_tests': {10000: KstestResult(statistic=0.3316, pvalue=1e-323, statistic_location=0.004513504, statistic_sign=1),
                                20000: KstestResult(statistic=0.32735000000000003, pvalue=0.0, statistic_location=0.004468613, statistic_sign=1),
                                30000: KstestResult(statistic=0.32889999999999997, pvalue=0.0, statistic_location=0.0042645726, statistic_sign=1),
                                40000: KstestResult(statistic=0.3267, pvalue=0.0, statistic_location=0.004738318, statistic_sign=1),
                                50000: KstestResult(statistic=0.33216, pvalue=0.0, statistic_location=0.0042715115, statistic_sign=1),
                                60000: KstestResult(statistic=0.3285, pvalue=0.0, statistic_location=0.004427818, statistic_sign=1),
                                70000: KstestResult(statistic=0.32807142857142857, pvalue=0.0, statistic_location=0.0045526503, statistic_sign=1),
                                80000: KstestResult(statistic=0.33266249999999997, pvalue=0.0, statistic_location=0.0044613723, statistic_sign=1),
                                90000: KstestResult(statistic=0.32943333333333336, pvalue=0.0, statistic_location=0.0042902846, statistic_sign=1),
                                100000: KstestResult(statistic=0.32867, pvalue=0.0, statistic_location=0.004464301, statistic_sign=1),
                                110000: KstestResult(statistic=0.33123636363636366, pvalue=0.0, statistic_location=0.0044712313, statistic_sign=1)},
                   'moments': {'mean_error': 0.29321426,
                               'means': [0.00018858185, -7.672756e-05],
                               'stds': [0.018317485, 0.0032920414],
                               'variance_ratio': 36.17662}},
 'originals': {'gan': {'mae': 0.03907756134867668,
                       'mse': 0.002982331905514002,
                       'psnr': 25.586721420288086,
                       'rmse': 0.0546107292175293,
                       'ssim': 0.681746780872345},
               'pca': {'mae': 0.00579272024333477,
                       'mse': 7.068861305015162e-05,
                       'psnr': 42.43689727783203,
                       'rmse': 0.008407652378082275,
                       'ssim': 0.983896791934967}},
 'reconstructions': {'mae': 0.038356125354766846,
                     'mse': 0.002912241267040372,
                     'psnr': 26.288116455078125,
                     'rmse': 0.05396518483757973,
                     'ssim': 0.6876377463340759},
 'residual_spectra_pcagan': {'cosine': [0.10300923,
                                        0.2809828,
                                        0.1874966,
                                        0.2589704,
                                        0.1591521,
                                        0.15520221,
                                        0.13536471,
                                        0.123569444,
                                        0.06844458,
                                        0.08686532,
                                        0.083898045],
                             'mae': [0.011787178,
                                     0.011698332,
                                     0.01242215,
                                     0.010942348,
                                     0.012384292,
                                     0.011998146,
                                     0.012072949,
                                     0.012988281,
                                     0.013250084,
                                     0.012175791,
                                     0.012947287],
                             'max_mae': 0.013250084,
                             'max_mse': 0.00042945915,
                             'max_rmse': 0.020723397,
                             'median_distance': 1.7727097,
                             'median_mae': 0.012175791,
                             'min_cosine': 0.06844458,
                             'mse': [0.00027150058,
                                     0.00042945915,
                                     0.00030703613,
                                     0.000252567,
                                     0.00039983646,
                                     0.00027527928,
                                     0.00030045377,
                                     0.00033023403,
                                     0.0003664825,
                                     0.00031425,
                                     0.00034194888],
                             'rmse': [0.016477276,
                                      0.020723397,
                                      0.017522447,
                                      0.015892357,
                                      0.019995911,
                                      0.016591541,
                                      0.017333603,
                                      0.018172342,
                                      0.019143732,
                                      0.017727097,
                                      0.01849186]},
 'residuals': {'mae': 0.01224244013428688,
               'mse': 0.00032627704786136746,
               'psnr': 10.201699256896973,
               'rmse': 0.018063141033053398,
               'ssds': [36.911907, 1.192766],
               'ssim': 0.2583480477333069},
 'spectra_pcagan': {'cosine': [0.7624338,
                               0.9747453,
                               0.97321004,
                               0.9799618,
                               0.97498727,
                               0.97219783,
                               0.9763849,
                               0.9776971,
                               0.98459893,
                               0.99132836,
                               0.98846775],
                    'mae': [0.12471779,
                            0.034638893,
                            0.03198089,
                            0.026626827,
                            0.029567942,
                            0.03148797,
                            0.030287912,
                            0.030939685,
                            0.029195098,
                            0.025116999,
                            0.02735735],
                    'max_mae': 0.12471779,
                    'max_mse': 0.01726911,
                    'max_rmse': 0.13141198,
                    'median_mae': 0.030287912,
                    'min_cosine': 0.7624338,
                    'mse': [0.01726911,
                            0.0020447313,
                            0.0016213411,
                            0.001186338,
                            0.0015308332,
                            0.0015930646,
                            0.0014867126,
                            0.0015956282,
                            0.001414288,
                            0.001049829,
                            0.0012427769],
                    'rmse': [0.13141198,
                             0.045218706,
                             0.04026588,
                             0.03444326,
                             0.039125863,
                             0.039913215,
                             0.038557913,
                             0.039945316,
                             0.03760702,
                             0.032401063,
                             0.03525304]},
 'spectra_realgan': {'cosine': [0.7618223,
                                0.9706532,
                                0.9719387,
                                0.9779798,
                                0.9730728,
                                0.97146857,
                                0.9760714,
                                0.977285,
                                0.98440665,
                                0.9912269,
                                0.9883661],
                     'mae': [0.12482577,
                             0.037250925,
                             0.03284903,
                             0.0281554,
                             0.030857226,
                             0.03197571,
                             0.030476414,
                             0.031207312,
                             0.029415226,
                             0.025337655,
                             0.027502527],
                     'max_mae': 0.12482577,
                     'max_mse': 0.017315388,
                     'max_rmse': 0.13158795,
                     'median_mae': 0.030857226,
                     'min_cosine': 0.7618223,
                     'mse': [0.017315388,
                             0.002327533,
                             0.001701012,
                             0.0013083412,
                             0.0016382989,
                             0.001635213,
                             0.0015086309,
                             0.0016241322,
                             0.0014301583,
                             0.0010630961,
                             0.0012538511],
                     'rmse': [0.13158795,
                              0.048244514,
                              0.041243326,
                              0.036171,
                              0.040475905,
                              0.04043777,
                              0.0388411,
                              0.040300522,
                              0.037817433,
                              0.032605156,
                              0.03540976]},
 'spectra_realpca': {'cosine': [0.99973154,
                                0.9955847,
                                0.9988941,
                                0.9977992,
                                0.9984082,
                                0.99901783,
                                0.99962306,
                                0.9995603,
                                0.99979204,
                                0.99989355,
                                0.99990076],
                     'mae': [0.003309465,
                             0.014001186,
                             0.0065057594,
                             0.009111987,
                             0.00773577,
                             0.005985069,
                             0.003892016,
                             0.004307635,
                             0.003439179,
                             0.002847533,
                             0.0025843144],
                     'max_mae': 0.014001186,
                     'max_mse': 0.00031196035,
                     'max_rmse': 0.017662399,
                     'median_mae': 0.004307635,
                     'min_cosine': 0.9955847,
                     'mse': [1.7695424e-05,
                             0.00031196035,
                             6.772909e-05,
                             0.00013206896,
                             9.466458e-05,
                             5.708593e-05,
                             2.4033741e-05,
                             2.9790583e-05,
                             1.8986177e-05,
                             1.2964699e-05,
                             1.0595275e-05],
                     'rmse': [0.0042065927,
                              0.017662399,
                              0.008229769,
                              0.011492126,
                              0.009729573,
                              0.007555523,
                              0.004902422,
                              0.005458075,
                              0.004357313,
                              0.0036006526,
                              0.0032550383]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_20/models/GANASTRO/0112_100957/comparison_85.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431
Directory path: experiments/inpainting/gann_4_night_20180723_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_85.0/images
Optimal number of principal components:  32
Reconstruction error:  12.537442
Energy conservation:  0.851037
saved images in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_85.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.070708789508587, 2.608668566920494],
                   'kl_div': 0.93037254,
                   'ks_tests': {10000: KstestResult(statistic=0.3226, pvalue=1e-323, statistic_location=0.0037780884, statistic_sign=1),
                                20000: KstestResult(statistic=0.31445, pvalue=0.0, statistic_location=0.003876976, statistic_sign=1),
                                30000: KstestResult(statistic=0.31566666666666665, pvalue=0.0, statistic_location=0.0039226804, statistic_sign=1),
                                40000: KstestResult(statistic=0.31735, pvalue=0.0, statistic_location=0.003956274, statistic_sign=1),
                                50000: KstestResult(statistic=0.31522000000000006, pvalue=0.0, statistic_location=0.003750544, statistic_sign=1),
                                60000: KstestResult(statistic=0.3099166666666666, pvalue=0.0, statistic_location=0.003782752, statistic_sign=1),
                                70000: KstestResult(statistic=0.31585714285714284, pvalue=0.0, statistic_location=0.0037229368, statistic_sign=1),
                                80000: KstestResult(statistic=0.31489999999999996, pvalue=0.0, statistic_location=0.0043836124, statistic_sign=1),
                                90000: KstestResult(statistic=0.3128777777777778, pvalue=0.0, statistic_location=0.0038561423, statistic_sign=1),
                                100000: KstestResult(statistic=0.31562, pvalue=0.0, statistic_location=0.0038635498, statistic_sign=1),
                                110000: KstestResult(statistic=0.31233636363636363, pvalue=0.0, statistic_location=0.0039078994, statistic_sign=1),
                                120000: KstestResult(statistic=0.3136916666666667, pvalue=0.0, statistic_location=0.003782752, statistic_sign=1),
                                130000: KstestResult(statistic=0.3140615384615385, pvalue=0.0, statistic_location=0.0037911665, statistic_sign=1),
                                140000: KstestResult(statistic=0.31273571428571423, pvalue=0.0, statistic_location=0.0037521496, statistic_sign=1),
                                150000: KstestResult(statistic=0.3138266666666667, pvalue=0.0, statistic_location=0.0039358456, statistic_sign=1),
                                160000: KstestResult(statistic=0.3152499999999999, pvalue=0.0, statistic_location=0.0038968595, statistic_sign=1),
                                170000: KstestResult(statistic=0.31205294117647053, pvalue=0.0, statistic_location=0.0039111217, statistic_sign=1),
                                180000: KstestResult(statistic=0.3124, pvalue=0.0, statistic_location=0.00395862, statistic_sign=1),
                                190000: KstestResult(statistic=0.3148526315789474, pvalue=0.0, statistic_location=0.0039341003, statistic_sign=1),
                                200000: KstestResult(statistic=0.31335500000000005, pvalue=0.0, statistic_location=0.0039394693, statistic_sign=1),
                                210000: KstestResult(statistic=0.3144714285714286, pvalue=0.0, statistic_location=0.0040157754, statistic_sign=1),
                                220000: KstestResult(statistic=0.31357272727272734, pvalue=0.0, statistic_location=0.0039282143, statistic_sign=1)},
                   'moments': {'mean_error': 0.39371267,
                               'means': [0.0011001013, -2.004904e-05],
                               'stds': [0.017806092, 0.0039099804],
                               'variance_ratio': 21.826675}},
 'originals': {'gan': {'mae': 0.03808429464697838,
                       'mse': 0.0028098353650420904,
                       'psnr': 27.170915603637695,
                       'rmse': 0.05300787836313248,
                       'ssim': 0.6383784413337708},
               'pca': {'mae': 0.006576152052730322,
                       'mse': 0.00011373525921953842,
                       'psnr': 41.26032638549805,
                       'rmse': 0.010664673522114754,
                       'ssim': 0.9861446619033813}},
 'reconstructions': {'mae': 0.03679738938808441,
                     'mse': 0.0026963669806718826,
                     'psnr': 27.51148796081543,
                     'rmse': 0.05192655324935913,
                     'ssim': 0.6389365792274475},
 'residual_spectra_pcagan': {'cosine': [0.47676536,
                                        0.37441015,
                                        0.182619,
                                        0.41375092,
                                        0.37545434,
                                        0.08600993,
                                        0.3631239,
                                        0.20780683,
                                        0.2976517,
                                        0.20410712,
                                        0.15602614,
                                        0.10857109,
                                        0.13303436,
                                        0.0929916,
                                        0.06595226,
                                        0.08513971,
                                        0.04214496,
                                        0.037259094,
                                        0.05396367,
                                        0.061301276,
                                        0.049365345,
                                        0.04395231],
                             'mae': [0.00875358,
                                     0.009574694,
                                     0.012123543,
                                     0.009807673,
                                     0.010965593,
                                     0.013170338,
                                     0.010255396,
                                     0.010430484,
                                     0.010585998,
                                     0.011611578,
                                     0.012854474,
                                     0.01246539,
                                     0.012054561,
                                     0.012358206,
                                     0.012604812,
                                     0.013000702,
                                     0.012869775,
                                     0.014450116,
                                     0.013658239,
                                     0.012742214,
                                     0.013412772,
                                     0.01188551],
                             'max_mae': 0.014450116,
                             'max_mse': 0.00048733692,
                             'max_rmse': 0.022075709,
                             'median_distance': 1.714816,
                             'median_mae': 0.012240875,
                             'min_cosine': 0.037259094,
                             'mse': [0.00016967684,
                                     0.00026644891,
                                     0.00041705847,
                                     0.0002083906,
                                     0.0002835837,
                                     0.00039452835,
                                     0.00025267334,
                                     0.0002220434,
                                     0.00021010957,
                                     0.00026039852,
                                     0.00032198362,
                                     0.00029300016,
                                     0.00026828222,
                                     0.00029512047,
                                     0.00033481276,
                                     0.00037050724,
                                     0.00031022695,
                                     0.000384529,
                                     0.0003708282,
                                     0.00030009693,
                                     0.00048733692,
                                     0.00027334632],
                             'rmse': [0.0130260065,
                                      0.016323263,
                                      0.02042201,
                                      0.01443574,
                                      0.016839944,
                                      0.019862738,
                                      0.015895702,
                                      0.01490112,
                                      0.014495157,
                                      0.016136868,
                                      0.017943902,
                                      0.017117247,
                                      0.016379323,
                                      0.01717907,
                                      0.01829789,
                                      0.019248566,
                                      0.01761326,
                                      0.01960941,
                                      0.019256901,
                                      0.017323306,
                                      0.022075709,
                                      0.016533189]},
 'residuals': {'mae': 0.011892530135810375,
               'mse': 0.00030431736377067864,
               'psnr': 11.455252647399902,
               'rmse': 0.01744469441473484,
               'ssds': [70.01845, 3.363421],
               'ssim': 0.3047734498977661},
 'spectra_pcagan': {'cosine': [0.9882002,
                               0.98991996,
                               0.9734539,
                               0.98904115,
                               0.97986865,
                               0.7811176,
                               0.9795436,
                               0.9804479,
                               0.9793012,
                               0.97687405,
                               0.9676623,
                               0.97784483,
                               0.97901285,
                               0.9865852,
                               0.98997027,
                               0.988319,
                               0.99057204,
                               0.9914177,
                               0.99333596,
                               0.94549525,
                               0.99240756,
                               0.995065],
                    'mae': [0.026933197,
                            0.027930956,
                            0.031121176,
                            0.028179724,
                            0.030379498,
                            0.12309216,
                            0.028941808,
                            0.026468737,
                            0.027249292,
                            0.028838236,
                            0.035564043,
                            0.031408243,
                            0.030841248,
                            0.027268616,
                            0.026452735,
                            0.03181689,
                            0.027108822,
                            0.028422225,
                            0.028448306,
                            0.11327305,
                            0.025761567,
                            0.024042068],
                    'max_mae': 0.12309216,
                    'max_mse': 0.017199328,
                    'max_rmse': 0.13114621,
                    'median_mae': 0.028435266,
                    'min_cosine': 0.7811176,
                    'mse': [0.001207621,
                            0.0015254532,
                            0.0017082111,
                            0.0013695874,
                            0.0015265476,
                            0.017199328,
                            0.0014737936,
                            0.0011842612,
                            0.0012506415,
                            0.0013591545,
                            0.002054096,
                            0.0015680075,
                            0.0015444878,
                            0.0012286095,
                            0.0012260705,
                            0.0016543181,
                            0.0011833629,
                            0.001317074,
                            0.0013792806,
                            0.01418287,
                            0.0012344753,
                            0.00094282324],
                    'rmse': [0.03475084,
                             0.03905705,
                             0.041330513,
                             0.037007935,
                             0.039071057,
                             0.13114621,
                             0.03839002,
                             0.034413096,
                             0.03536441,
                             0.036866713,
                             0.045322135,
                             0.039598074,
                             0.039299972,
                             0.035051525,
                             0.03501529,
                             0.040673308,
                             0.034400042,
                             0.036291514,
                             0.037138667,
                             0.11909185,
                             0.0351351,
                             0.030705428]},
 'spectra_realgan': {'cosine': [0.9842137,
                                0.98720497,
                                0.97187227,
                                0.9859724,
                                0.97520006,
                                0.78048676,
                                0.97551155,
                                0.97932756,
                                0.97711176,
                                0.9751855,
                                0.9669456,
                                0.9775585,
                                0.97862583,
                                0.98639005,
                                0.98985976,
                                0.9882041,
                                0.9905434,
                                0.99139863,
                                0.99332654,
                                0.9454301,
                                0.99235106,
                                0.9950587],
                     'mae': [0.03144739,
                             0.03335544,
                             0.032228336,
                             0.032831095,
                             0.034182176,
                             0.12319641,
                             0.032409564,
                             0.027351022,
                             0.02883237,
                             0.030073855,
                             0.03589506,
                             0.031589247,
                             0.031078821,
                             0.027468897,
                             0.026675552,
                             0.03191493,
                             0.027137136,
                             0.028458253,
                             0.028432429,
                             0.11332416,
                             0.025896886,
                             0.02407544],
                     'max_mae': 0.12319641,
                     'max_mse': 0.017248446,
                     'max_rmse': 0.13133334,
                     'median_mae': 0.031263106,
                     'min_cosine': 0.78048676,
                     'mse': [0.0016164696,
                             0.0019660664,
                             0.0018087025,
                             0.001765609,
                             0.0018790028,
                             0.017248446,
                             0.0017574048,
                             0.0012544214,
                             0.0013848387,
                             0.001458258,
                             0.0020975918,
                             0.001585535,
                             0.0015711228,
                             0.0012462541,
                             0.0012411156,
                             0.0016647249,
                             0.0011872652,
                             0.0013205616,
                             0.0013793176,
                             0.014198567,
                             0.0012410233,
                             0.00094407634],
                     'rmse': [0.040205345,
                              0.044340346,
                              0.04252884,
                              0.04201915,
                              0.043347467,
                              0.13133334,
                              0.04192141,
                              0.035417814,
                              0.037213422,
                              0.038187146,
                              0.045799475,
                              0.03981878,
                              0.03963739,
                              0.035302322,
                              0.03522947,
                              0.04080104,
                              0.034456715,
                              0.036339533,
                              0.037139166,
                              0.11915774,
                              0.03522816,
                              0.030725826]},
 'spectra_realpca': {'cosine': [0.9961419,
                                0.9970751,
                                0.99809647,
                                0.9968,
                                0.9952287,
                                0.99973154,
                                0.9955847,
                                0.9988941,
                                0.9977992,
                                0.9984082,
                                0.99901783,
                                0.99962306,
                                0.9995603,
                                0.99979204,
                                0.99989355,
                                0.99990076,
                                0.99996406,
                                0.99996424,
                                0.99997544,
                                0.9999832,
                                0.9999563,
                                0.99999136],
                     'mae': [0.015536282,
                             0.016497986,
                             0.008694158,
                             0.015810456,
                             0.014737346,
                             0.003309465,
                             0.014001186,
                             0.0065057594,
                             0.009111987,
                             0.00773577,
                             0.005985069,
                             0.003892016,
                             0.004307635,
                             0.003439179,
                             0.002847533,
                             0.0025843144,
                             0.0016847786,
                             0.0018569317,
                             0.0017076491,
                             0.0013719334,
                             0.0020717112,
                             0.0009861767],
                     'max_mae': 0.016497986,
                     'max_mse': 0.00043888282,
                     'max_rmse': 0.02094953,
                     'median_mae': 0.0040998254,
                     'min_cosine': 0.9952287,
                     'mse': [0.00038639587,
                             0.00043888282,
                             0.00012186892,
                             0.00039837317,
                             0.0003529409,
                             1.7695424e-05,
                             0.00031196035,
                             6.772909e-05,
                             0.00013206896,
                             9.466458e-05,
                             5.708593e-05,
                             2.4033741e-05,
                             2.9790583e-05,
                             1.8986177e-05,
                             1.2964699e-05,
                             1.0595275e-05,
                             4.513845e-06,
                             5.514424e-06,
                             4.659367e-06,
                             2.9949076e-06,
                             6.890376e-06,
                             1.5656201e-06],
                     'rmse': [0.019656954,
                              0.02094953,
                              0.011039426,
                              0.019959288,
                              0.018786721,
                              0.0042065927,
                              0.017662399,
                              0.008229769,
                              0.011492126,
                              0.009729573,
                              0.007555523,
                              0.004902422,
                              0.005458075,
                              0.004357313,
                              0.0036006526,
                              0.0032550383,
                              0.002124581,
                              0.0023482812,
                              0.0021585566,
                              0.0017305801,
                              0.0026249525,
                              0.0012512474]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_40/models/GANASTRO/0112_122431/comparison_85.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707
Directory path: experiments/inpainting/gann_4_night_20180723_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_85.0/images
Optimal number of principal components:  32
Reconstruction error:  12.537442
Energy conservation:  0.851037
saved images in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_85.0/spectra/obs_2
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180723_cb4240_ce4340.npz
{'distributions': {'entropies': [4.060522481510419, 2.694122301899087],
                   'kl_div': 0.8356093,
                   'ks_tests': {10000: KstestResult(statistic=0.2651, pvalue=2.65407387105964e-309, statistic_location=0.0038640755, statistic_sign=1),
                                20000: KstestResult(statistic=0.2712, pvalue=0.0, statistic_location=0.004333243, statistic_sign=1),
                                30000: KstestResult(statistic=0.2639, pvalue=0.0, statistic_location=0.0038129645, statistic_sign=1),
                                40000: KstestResult(statistic=0.26932500000000004, pvalue=0.0, statistic_location=0.004093483, statistic_sign=1),
                                50000: KstestResult(statistic=0.26334, pvalue=0.0, statistic_location=0.003580356, statistic_sign=1),
                                60000: KstestResult(statistic=0.2673, pvalue=0.0, statistic_location=0.0044570775, statistic_sign=1),
                                70000: KstestResult(statistic=0.2698857142857143, pvalue=0.0, statistic_location=0.0038536265, statistic_sign=1),
                                80000: KstestResult(statistic=0.2626625, pvalue=0.0, statistic_location=0.004338042, statistic_sign=1),
                                90000: KstestResult(statistic=0.2656333333333334, pvalue=0.0, statistic_location=0.0045917593, statistic_sign=1),
                                100000: KstestResult(statistic=0.2655799999999999, pvalue=0.0, statistic_location=0.0039326744, statistic_sign=1),
                                110000: KstestResult(statistic=0.2665272727272727, pvalue=0.0, statistic_location=0.003935508, statistic_sign=1),
                                120000: KstestResult(statistic=0.2667583333333333, pvalue=0.0, statistic_location=0.003965372, statistic_sign=1),
                                130000: KstestResult(statistic=0.26746153846153853, pvalue=0.0, statistic_location=0.003797757, statistic_sign=1),
                                140000: KstestResult(statistic=0.26697142857142864, pvalue=0.0, statistic_location=0.0039680097, statistic_sign=1),
                                150000: KstestResult(statistic=0.26692666666666665, pvalue=0.0, statistic_location=0.0037061716, statistic_sign=1),
                                160000: KstestResult(statistic=0.26507500000000006, pvalue=0.0, statistic_location=0.0039745197, statistic_sign=1),
                                170000: KstestResult(statistic=0.2650529411764706, pvalue=0.0, statistic_location=0.0041029933, statistic_sign=1),
                                180000: KstestResult(statistic=0.26388888888888895, pvalue=0.0, statistic_location=0.0041027786, statistic_sign=1),
                                190000: KstestResult(statistic=0.2648631578947368, pvalue=0.0, statistic_location=0.00394, statistic_sign=1),
                                200000: KstestResult(statistic=0.26351, pvalue=0.0, statistic_location=0.0039475956, statistic_sign=1),
                                210000: KstestResult(statistic=0.2654714285714286, pvalue=0.0, statistic_location=0.003935508, statistic_sign=1),
                                220000: KstestResult(statistic=0.2667272727272728, pvalue=0.0, statistic_location=0.004101838, statistic_sign=1),
                                230000: KstestResult(statistic=0.26437391304347824, pvalue=0.0, statistic_location=0.0043070205, statistic_sign=1),
                                240000: KstestResult(statistic=0.2647791666666667, pvalue=0.0, statistic_location=0.003971461, statistic_sign=1),
                                250000: KstestResult(statistic=0.2621, pvalue=0.0, statistic_location=0.004281454, statistic_sign=1),
                                260000: KstestResult(statistic=0.26506538461538465, pvalue=0.0, statistic_location=0.0043234765, statistic_sign=1),
                                270000: KstestResult(statistic=0.26598888888888883, pvalue=0.0, statistic_location=0.0041885288, statistic_sign=1),
                                280000: KstestResult(statistic=0.2662392857142857, pvalue=0.0, statistic_location=0.0039368425, statistic_sign=1),
                                290000: KstestResult(statistic=0.2663724137931035, pvalue=0.0, statistic_location=0.0043331925, statistic_sign=1),
                                300000: KstestResult(statistic=0.2661733333333334, pvalue=0.0, statistic_location=0.0038530112, statistic_sign=1),
                                310000: KstestResult(statistic=0.26671612903225805, pvalue=0.0, statistic_location=0.0039602267, statistic_sign=1),
                                320000: KstestResult(statistic=0.26445937500000005, pvalue=0.0, statistic_location=0.0040379316, statistic_sign=1),
                                330000: KstestResult(statistic=0.2634939393939394, pvalue=0.0, statistic_location=0.0039467257, statistic_sign=1)},
                   'moments': {'mean_error': 0.06320851,
                               'means': [4.6829733e-05, 1.9046267e-05],
                               'stds': [0.017160652, 0.004342081],
                               'variance_ratio': 15.444928}},
 'originals': {'gan': {'mae': 0.03634100407361984,
                       'mse': 0.0025030553806573153,
                       'psnr': 28.304943084716797,
                       'rmse': 0.05003054440021515,
                       'ssim': 0.6518757939338684},
               'pca': {'mae': 0.007482700049877167,
                       'mse': 0.00014794919115956873,
                       'psnr': 40.919960021972656,
                       'rmse': 0.012163436971604824,
                       'ssim': 0.9873913526535034}},
 'reconstructions': {'mae': 0.03475131839513779,
                     'mse': 0.002356517594307661,
                     'psnr': 28.898378372192383,
                     'rmse': 0.04854397475719452,
                     'ssim': 0.6531364917755127},
 'residual_spectra_pcagan': {'cosine': [0.43023512,
                                        0.4120459,
                                        0.38435805,
                                        0.35608324,
                                        0.44668445,
                                        0.35037783,
                                        0.37728873,
                                        0.34927556,
                                        0.23115477,
                                        0.40020415,
                                        0.3528145,
                                        0.10409811,
                                        0.31010374,
                                        0.20112172,
                                        0.2790071,
                                        0.18741576,
                                        0.17472985,
                                        0.1456467,
                                        0.13756631,
                                        0.07342598,
                                        0.099607006,
                                        0.08895216,
                                        0.05432394,
                                        0.05915879,
                                        0.06384371,
                                        0.07263394,
                                        0.08100716,
                                        0.03426777,
                                        0.056538187,
                                        0.05232301,
                                        0.08389805,
                                        0.045090456,
                                        0.058791693],
                             'mae': [0.009447669,
                                     0.009946445,
                                     0.009538256,
                                     0.010169998,
                                     0.009189594,
                                     0.010267492,
                                     0.009955299,
                                     0.010438683,
                                     0.010972135,
                                     0.010120643,
                                     0.010990047,
                                     0.011685455,
                                     0.0113126375,
                                     0.011929864,
                                     0.010476138,
                                     0.01182401,
                                     0.0114539685,
                                     0.011611593,
                                     0.012438138,
                                     0.012862268,
                                     0.011695721,
                                     0.012701881,
                                     0.012164059,
                                     0.013673471,
                                     0.013073581,
                                     0.012115463,
                                     0.013589482,
                                     0.013450076,
                                     0.011551143,
                                     0.011678419,
                                     0.011134491,
                                     0.011572708,
                                     0.012748699],
                             'max_mae': 0.013673471,
                             'max_mse': 0.00035598804,
                             'max_rmse': 0.018867645,
                             'median_distance': 1.6492019,
                             'median_mae': 0.011572708,
                             'min_cosine': 0.03426777,
                             'mse': [0.00019362973,
                                     0.00023068757,
                                     0.00020426416,
                                     0.00031104416,
                                     0.00018144504,
                                     0.0003029474,
                                     0.0002541194,
                                     0.00029824482,
                                     0.00027434534,
                                     0.00022068676,
                                     0.0003052395,
                                     0.00027198676,
                                     0.00035598804,
                                     0.00026690197,
                                     0.00021551902,
                                     0.00031820618,
                                     0.00023752911,
                                     0.00025652643,
                                     0.00030344815,
                                     0.00031726318,
                                     0.0002667253,
                                     0.00032525038,
                                     0.00031673675,
                                     0.00034461488,
                                     0.00031191073,
                                     0.00026595886,
                                     0.00033390516,
                                     0.00034825315,
                                     0.00025119336,
                                     0.00025062377,
                                     0.00023918247,
                                     0.00025232855,
                                     0.0003302725],
                             'rmse': [0.01391509,
                                      0.0151884025,
                                      0.014292101,
                                      0.017636444,
                                      0.013470153,
                                      0.017405383,
                                      0.015941123,
                                      0.017269766,
                                      0.016563373,
                                      0.01485553,
                                      0.017471105,
                                      0.01649202,
                                      0.018867645,
                                      0.016337134,
                                      0.014680566,
                                      0.017838335,
                                      0.0154119795,
                                      0.016016442,
                                      0.017419763,
                                      0.017811883,
                                      0.016331727,
                                      0.018034698,
                                      0.0177971,
                                      0.018563805,
                                      0.017660994,
                                      0.016308246,
                                      0.018273072,
                                      0.018661542,
                                      0.01584908,
                                      0.015831102,
                                      0.015465525,
                                      0.015884852,
                                      0.0181734]},
 'residuals': {'mae': 0.011447864584624767,
               'mse': 0.0002774841559585184,
               'psnr': 12.644499778747559,
               'rmse': 0.016657855361700058,
               'ssds': [97.18146, 6.2218103],
               'ssim': 0.30272209644317627},
 'spectra_pcagan': {'cosine': [0.98862135,
                               0.9864023,
                               0.9884762,
                               0.98846674,
                               0.9876982,
                               0.9919738,
                               0.9854364,
                               0.98791736,
                               0.9721656,
                               0.987041,
                               0.97454,
                               0.7625934,
                               0.97493124,
                               0.97300375,
                               0.979946,
                               0.97475356,
                               0.97195494,
                               0.9767509,
                               0.9778609,
                               0.984417,
                               0.99098825,
                               0.9886192,
                               0.99142313,
                               0.99140066,
                               0.99384147,
                               0.93812585,
                               0.9918465,
                               0.9926693,
                               0.99523705,
                               0.9935377,
                               0.9914249,
                               0.9931008,
                               0.9936012],
                    'mae': [0.025913225,
                            0.026109844,
                            0.02614278,
                            0.026470667,
                            0.033684473,
                            0.03542756,
                            0.029126862,
                            0.031047696,
                            0.033227537,
                            0.033302806,
                            0.033498,
                            0.12489978,
                            0.034561522,
                            0.032144446,
                            0.026654055,
                            0.029750671,
                            0.03158731,
                            0.030062806,
                            0.03084295,
                            0.029421283,
                            0.025530534,
                            0.027305732,
                            0.028500559,
                            0.029323865,
                            0.027925875,
                            0.118848465,
                            0.028277801,
                            0.030411396,
                            0.023066288,
                            0.025664752,
                            0.028333832,
                            0.024687486,
                            0.025040666],
                    'max_mae': 0.12489978,
                    'max_mse': 0.017328762,
                    'max_rmse': 0.13163875,
                    'median_mae': 0.029323865,
                    'min_cosine': 0.7625934,
                    'mse': [0.0012220177,
                            0.001253058,
                            0.0012171834,
                            0.0013839961,
                            0.0017669811,
                            0.0023556473,
                            0.0014778136,
                            0.0018588771,
                            0.0017800403,
                            0.0018448824,
                            0.0018742657,
                            0.017328762,
                            0.0020267921,
                            0.001633841,
                            0.0011872647,
                            0.001541263,
                            0.0016067136,
                            0.001463331,
                            0.0015831579,
                            0.0014319204,
                            0.0010906929,
                            0.0012271651,
                            0.0014032909,
                            0.001384249,
                            0.001319147,
                            0.015450382,
                            0.001283848,
                            0.0014847403,
                            0.00087337283,
                            0.0010602041,
                            0.0012906874,
                            0.0009886433,
                            0.0010708601],
                    'rmse': [0.034957368,
                             0.035398558,
                             0.034888156,
                             0.037202097,
                             0.042035475,
                             0.04853501,
                             0.03844234,
                             0.043114696,
                             0.042190526,
                             0.042952094,
                             0.04329279,
                             0.13163875,
                             0.04501991,
                             0.0404208,
                             0.034456708,
                             0.039258923,
                             0.040083833,
                             0.03825351,
                             0.039788917,
                             0.037840724,
                             0.03302564,
                             0.035030916,
                             0.037460525,
                             0.037205495,
                             0.036320064,
                             0.12429956,
                             0.035830826,
                             0.038532328,
                             0.029552883,
                             0.032560777,
                             0.035926137,
                             0.031442698,
                             0.032723997]},
 'spectra_realgan': {'cosine': [0.9853493,
                                0.98257256,
                                0.98563534,
                                0.98512113,
                                0.98430985,
                                0.99030226,
                                0.98179233,
                                0.9852682,
                                0.9705348,
                                0.98410577,
                                0.9703454,
                                0.7619834,
                                0.9708436,
                                0.97174317,
                                0.97797066,
                                0.97283,
                                0.97123414,
                                0.9764319,
                                0.9774398,
                                0.9842234,
                                0.9908876,
                                0.98851883,
                                0.9913782,
                                0.9913742,
                                0.9938238,
                                0.93806106,
                                0.99176943,
                                0.9926557,
                                0.9952091,
                                0.99351734,
                                0.9913544,
                                0.9930972,
                                0.9935787],
                     'mae': [0.030537238,
                             0.030797513,
                             0.030065618,
                             0.031361733,
                             0.037741028,
                             0.040103626,
                             0.03314663,
                             0.035900876,
                             0.03425444,
                             0.037188984,
                             0.036723156,
                             0.1250104,
                             0.037206914,
                             0.032996252,
                             0.028173871,
                             0.031050755,
                             0.032058284,
                             0.030246949,
                             0.03111265,
                             0.029630676,
                             0.0257509,
                             0.027460653,
                             0.02860171,
                             0.029367328,
                             0.02792173,
                             0.11890092,
                             0.02840892,
                             0.030442933,
                             0.023158094,
                             0.02568883,
                             0.028445108,
                             0.024694622,
                             0.025103979],
                     'max_mae': 0.1250104,
                     'max_mse': 0.017375024,
                     'max_rmse': 0.13181436,
                     'median_mae': 0.030537238,
                     'min_cosine': 0.7619834,
                     'mse': [0.0015807168,
                             0.0016185148,
                             0.001527342,
                             0.0017776066,
                             0.0022212546,
                             0.0028400272,
                             0.0018555252,
                             0.0022995688,
                             0.0018837021,
                             0.0022374268,
                             0.0021932207,
                             0.017375024,
                             0.002309372,
                             0.0017128992,
                             0.0013088842,
                             0.0016493244,
                             0.0016484209,
                             0.0014856092,
                             0.0016122885,
                             0.0014478798,
                             0.0011038405,
                             0.0012380853,
                             0.001411842,
                             0.0013879013,
                             0.0013203906,
                             0.015466257,
                             0.0012954597,
                             0.0014874816,
                             0.00087821076,
                             0.001061706,
                             0.0013006123,
                             0.0009893356,
                             0.0010751092],
                     'rmse': [0.039758228,
                              0.04023077,
                              0.039081223,
                              0.042161673,
                              0.04713019,
                              0.053291906,
                              0.043075807,
                              0.04795382,
                              0.043401636,
                              0.047301445,
                              0.046831835,
                              0.13181436,
                              0.048055924,
                              0.041387185,
                              0.036178507,
                              0.040611874,
                              0.04060075,
                              0.0385436,
                              0.040153313,
                              0.038051017,
                              0.033224095,
                              0.035186436,
                              0.037574485,
                              0.037254546,
                              0.03633718,
                              0.12436341,
                              0.035992496,
                              0.038567882,
                              0.029634621,
                              0.03258383,
                              0.036064003,
                              0.031453706,
                              0.032788858]},
 'spectra_realpca': {'cosine': [0.99639374,
                                0.99591106,
                                0.99702704,
                                0.99648315,
                                0.9966275,
                                0.9981571,
                                0.9961419,
                                0.9970751,
                                0.99809647,
                                0.9968,
                                0.9952287,
                                0.99973154,
                                0.9955847,
                                0.9988941,
                                0.9977992,
                                0.9984082,
                                0.99901783,
                                0.99962306,
                                0.9995603,
                                0.99979204,
                                0.99989355,
                                0.99990076,
                                0.99996406,
                                0.99996424,
                                0.99997544,
                                0.9999832,
                                0.9999563,
                                0.99999136,
                                0.99997777,
                                0.99998087,
                                0.99994564,
                                0.9999722,
                                0.99996966],
                     'mae': [0.015374764,
                             0.015395652,
                             0.014179433,
                             0.015968233,
                             0.015759574,
                             0.017270891,
                             0.015536282,
                             0.016497986,
                             0.008694158,
                             0.015810456,
                             0.014737346,
                             0.003309465,
                             0.014001186,
                             0.0065057594,
                             0.009111987,
                             0.00773577,
                             0.005985069,
                             0.003892016,
                             0.004307635,
                             0.003439179,
                             0.002847533,
                             0.0025843144,
                             0.0016847786,
                             0.0018569317,
                             0.0017076491,
                             0.0013719334,
                             0.0020717112,
                             0.0009861767,
                             0.0015901659,
                             0.0013236047,
                             0.0020351924,
                             0.0015733149,
                             0.0017829919],
                     'max_mae': 0.017270891,
                     'max_mse': 0.0004755511,
                     'max_rmse': 0.021807134,
                     'median_mae': 0.004307635,
                     'min_cosine': 0.9952287,
                     'mse': [0.00037749438,
                             0.00037925874,
                             0.00031746613,
                             0.00040883216,
                             0.00039896273,
                             0.0004755511,
                             0.00038639587,
                             0.00043888282,
                             0.00012186892,
                             0.00039837317,
                             0.0003529409,
                             1.7695424e-05,
                             0.00031196035,
                             6.772909e-05,
                             0.00013206896,
                             9.466458e-05,
                             5.708593e-05,
                             2.4033741e-05,
                             2.9790583e-05,
                             1.8986177e-05,
                             1.2964699e-05,
                             1.0595275e-05,
                             4.513845e-06,
                             5.514424e-06,
                             4.659367e-06,
                             2.9949076e-06,
                             6.890376e-06,
                             1.5656201e-06,
                             4.0700033e-06,
                             2.8058478e-06,
                             6.6456714e-06,
                             3.9638853e-06,
                             5.0983444e-06],
                     'rmse': [0.019429214,
                              0.019474566,
                              0.01781758,
                              0.020219598,
                              0.019974051,
                              0.021807134,
                              0.019656954,
                              0.02094953,
                              0.011039426,
                              0.019959288,
                              0.018786721,
                              0.0042065927,
                              0.017662399,
                              0.008229769,
                              0.011492126,
                              0.009729573,
                              0.007555523,
                              0.004902422,
                              0.005458075,
                              0.004357313,
                              0.0036006526,
                              0.0032550383,
                              0.002124581,
                              0.0023482812,
                              0.0021585566,
                              0.0017305801,
                              0.0026249525,
                              0.0012512474,
                              0.002017425,
                              0.0016750665,
                              0.00257792,
                              0.001990951,
                              0.0022579513]}}
saved metrics in experiments/inpainting/gann_4_night_20180723_60/models/GANASTRO/0112_123707/comparison_85.0
Skipping 20180901...
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529
Directory path: experiments/inpainting/gann_4_night_20180901_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_85.0/images
Optimal number of principal components:  40
Reconstruction error:  4.720863
Energy conservation:  0.85786015
saved images in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_85.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.932551248322828, 1.0610392128784691],
                   'kl_div': 2.242943,
                   'ks_tests': {10000: KstestResult(statistic=0.4355, pvalue=0.0, statistic_location=0.001455321, statistic_sign=1),
                                20000: KstestResult(statistic=0.43489999999999995, pvalue=0.0, statistic_location=0.0014793724, statistic_sign=1),
                                30000: KstestResult(statistic=0.43706666666666666, pvalue=0.0, statistic_location=-0.0014715483, statistic_sign=-1),
                                40000: KstestResult(statistic=0.43522500000000003, pvalue=0.0, statistic_location=-0.0013981154, statistic_sign=-1),
                                50000: KstestResult(statistic=0.43320000000000003, pvalue=0.0, statistic_location=-0.0016395515, statistic_sign=-1),
                                60000: KstestResult(statistic=0.43233333333333335, pvalue=0.0, statistic_location=-0.0014514923, statistic_sign=-1),
                                70000: KstestResult(statistic=0.4322428571428571, pvalue=0.0, statistic_location=-0.0014672689, statistic_sign=-1),
                                80000: KstestResult(statistic=0.43185, pvalue=0.0, statistic_location=-0.0015636684, statistic_sign=-1),
                                90000: KstestResult(statistic=0.4323222222222222, pvalue=0.0, statistic_location=-0.0013568318, statistic_sign=-1),
                                100000: KstestResult(statistic=0.43481, pvalue=0.0, statistic_location=-0.0015639355, statistic_sign=-1),
                                110000: KstestResult(statistic=0.4339545454545455, pvalue=0.0, statistic_location=-0.0015606182, statistic_sign=-1)},
                   'moments': {'mean_error': 1.2890428,
                               'means': [0.0006159432, 1.4550488e-05],
                               'stds': [0.023046242, 0.00063241756],
                               'variance_ratio': 1392.2281}},
 'originals': {'gan': {'mae': 0.102467842400074,
                       'mse': 0.08953781425952911,
                       'psnr': 15.509012222290039,
                       'rmse': 0.299228698015213,
                       'ssim': 0.8870316743850708},
               'pca': {'mae': 0.000771047081798315,
                       'mse': 1.1945392088819062e-06,
                       'psnr': 64.56503295898438,
                       'rmse': 0.0010929497657343745,
                       'ssim': 0.9998999238014221}},
 'reconstructions': {'mae': 0.10242990404367447,
                     'mse': 0.0895344614982605,
                     'psnr': 15.817144393920898,
                     'rmse': 0.2992230951786041,
                     'ssim': 0.8870628476142883},
 'residual_spectra_pcagan': {'cosine': [0.0070474152,
                                        0.04115005,
                                        0.052158277,
                                        0.027304973,
                                        0.067986265,
                                        0.06540131,
                                        0.05473818,
                                        0.026593173,
                                        0.01944696,
                                        0.02978537,
                                        0.0061622714],
                             'mae': [0.011424642,
                                     0.012136182,
                                     0.010256832,
                                     0.011233117,
                                     0.011174241,
                                     0.009477069,
                                     0.0102377,
                                     0.010801865,
                                     0.010309319,
                                     0.010100772,
                                     0.025215382],
                             'max_mae': 0.025215382,
                             'max_mse': 0.0031048984,
                             'max_rmse': 0.055721615,
                             'median_distance': 1.5982189,
                             'median_mae': 0.010801865,
                             'min_cosine': 0.0061622714,
                             'mse': [0.00028330975,
                                     0.0004560828,
                                     0.0002510747,
                                     0.0002789042,
                                     0.00033885692,
                                     0.00020786958,
                                     0.000204595,
                                     0.00024705942,
                                     0.00025543038,
                                     0.00021410019,
                                     0.0031048984],
                             'rmse': [0.016831808,
                                      0.021356095,
                                      0.015845336,
                                      0.016700424,
                                      0.018408068,
                                      0.014417683,
                                      0.01430367,
                                      0.015718125,
                                      0.01598219,
                                      0.014632163,
                                      0.055721615]},
 'residuals': {'mae': 0.012033374048769474,
               'mse': 0.0005311074201017618,
               'psnr': -6.291515827178955,
               'rmse': 0.023045767098665237,
               'ssds': [58.465424, 0.04401761],
               'ssim': 0.5867553353309631},
 'spectra_pcagan': {'cosine': [0.9990695,
                               0.9934737,
                               0.99579674,
                               0.9978215,
                               0.99875826,
                               0.9965823,
                               0.9972009,
                               0.99853617,
                               0.9972659,
                               0.9988361,
                               -0.64515734],
                    'mae': [0.015085404,
                            0.02168548,
                            0.01886199,
                            0.018769473,
                            0.014659014,
                            0.0160443,
                            0.017054055,
                            0.015507975,
                            0.016446942,
                            0.014203593,
                            0.95841086],
                    'max_mae': 0.95841086,
                    'max_mse': 0.98010135,
                    'max_rmse': 0.99000067,
                    'median_mae': 0.016446942,
                    'min_cosine': -0.64515734,
                    'mse': [0.00038144947,
                            0.0007770413,
                            0.0005957269,
                            0.00057345437,
                            0.0003730066,
                            0.0004441922,
                            0.00045806347,
                            0.00038885203,
                            0.00045368256,
                            0.0003322494,
                            0.98010135],
                    'rmse': [0.019530732,
                             0.02787546,
                             0.024407517,
                             0.023946907,
                             0.019313378,
                             0.021075867,
                             0.021402417,
                             0.01971933,
                             0.021299826,
                             0.01822771,
                             0.99000067]},
 'spectra_realgan': {'cosine': [0.99906915,
                                0.9933958,
                                0.99578017,
                                0.9978165,
                                0.99875385,
                                0.9965646,
                                0.99718785,
                                0.9985342,
                                0.99725324,
                                0.99883455,
                                -0.6451681],
                     'mae': [0.0150934,
                             0.021833993,
                             0.01890899,
                             0.018786807,
                             0.014685906,
                             0.016091827,
                             0.017106555,
                             0.015522923,
                             0.016487274,
                             0.014210421,
                             0.9584182],
                     'max_mae': 0.9584182,
                     'max_mse': 0.98011726,
                     'max_rmse': 0.9900087,
                     'median_mae': 0.016487274,
                     'min_cosine': -0.6451681,
                     'mse': [0.0003818074,
                             0.0007860668,
                             0.00059797225,
                             0.0005744338,
                             0.00037425687,
                             0.0004465148,
                             0.0004602641,
                             0.0003893906,
                             0.00045536095,
                             0.00033263178,
                             0.98011726],
                     'rmse': [0.019539893,
                              0.028036883,
                              0.02445347,
                              0.02396735,
                              0.01934572,
                              0.021130897,
                              0.021453766,
                              0.019732982,
                              0.021339187,
                              0.018238196,
                              0.9900087]},
 'spectra_realpca': {'cosine': [0.99999946,
                                0.99996024,
                                0.9999914,
                                0.9999956,
                                0.9999981,
                                0.9999853,
                                0.9999922,
                                0.99999833,
                                0.9999912,
                                0.9999986,
                                0.9999995],
                     'mae': [0.00035880055,
                             0.0017127842,
                             0.00085635245,
                             0.0007624932,
                             0.00057763176,
                             0.001079229,
                             0.0008873331,
                             0.00051664386,
                             0.0009520196,
                             0.00048564567,
                             0.0002925843],
                     'max_mae': 0.0017127842,
                     'max_mse': 4.745527e-06,
                     'max_rmse': 0.002178423,
                     'median_mae': 0.0007624932,
                     'min_cosine': 0.99996024,
                     'mse': [2.06168e-07,
                             4.745527e-06,
                             1.1743152e-06,
                             9.359567e-07,
                             5.3931393e-07,
                             1.8758602e-06,
                             1.2693209e-06,
                             4.311424e-07,
                             1.4415184e-06,
                             3.828412e-07,
                             1.3796829e-07],
                     'rmse': [0.00045405727,
                              0.002178423,
                              0.0010836583,
                              0.0009674485,
                              0.00073438,
                              0.0013696204,
                              0.0011266414,
                              0.0006566144,
                              0.0012006325,
                              0.0006187416,
                              0.00037144084]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_20/models/GANASTRO/0112_124529/comparison_85.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319
Directory path: experiments/inpainting/gann_4_night_20180901_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_85.0/images
Optimal number of principal components:  40
Reconstruction error:  4.720863
Energy conservation:  0.85786015
saved images in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_85.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.940780002103074, 1.7892700946343647],
                   'kl_div': 1.5341641,
                   'ks_tests': {10000: KstestResult(statistic=0.3637, pvalue=0.0, statistic_location=-0.0016369494, statistic_sign=-1),
                                20000: KstestResult(statistic=0.35765, pvalue=0.0, statistic_location=-0.001718591, statistic_sign=-1),
                                30000: KstestResult(statistic=0.36336666666666667, pvalue=0.0, statistic_location=-0.0016369494, statistic_sign=-1),
                                40000: KstestResult(statistic=0.36395, pvalue=0.0, statistic_location=-0.0016973182, statistic_sign=-1),
                                50000: KstestResult(statistic=0.36164, pvalue=0.0, statistic_location=-0.0017512916, statistic_sign=-1),
                                60000: KstestResult(statistic=0.35885, pvalue=0.0, statistic_location=-0.0017063282, statistic_sign=-1),
                                70000: KstestResult(statistic=0.3617142857142857, pvalue=0.0, statistic_location=-0.001689204, statistic_sign=-1),
                                80000: KstestResult(statistic=0.35818750000000005, pvalue=0.0, statistic_location=-0.0016056877, statistic_sign=-1),
                                90000: KstestResult(statistic=0.3623111111111111, pvalue=0.0, statistic_location=-0.0017064856, statistic_sign=-1),
                                100000: KstestResult(statistic=0.36004, pvalue=0.0, statistic_location=-0.0016984036, statistic_sign=-1),
                                110000: KstestResult(statistic=0.3608090909090909, pvalue=0.0, statistic_location=-0.0017474592, statistic_sign=-1),
                                120000: KstestResult(statistic=0.3603, pvalue=0.0, statistic_location=-0.0017018192, statistic_sign=-1),
                                130000: KstestResult(statistic=0.3581076923076923, pvalue=0.0, statistic_location=-0.0017071795, statistic_sign=-1),
                                140000: KstestResult(statistic=0.35914285714285715, pvalue=0.0, statistic_location=-0.001629997, statistic_sign=-1),
                                150000: KstestResult(statistic=0.35668, pvalue=0.0, statistic_location=-0.0017170701, statistic_sign=-1),
                                160000: KstestResult(statistic=0.36243125, pvalue=0.0, statistic_location=-0.001688607, statistic_sign=-1),
                                170000: KstestResult(statistic=0.3609823529411765, pvalue=0.0, statistic_location=-0.0017063161, statistic_sign=-1),
                                180000: KstestResult(statistic=0.36044444444444446, pvalue=0.0, statistic_location=-0.0016884059, statistic_sign=-1),
                                190000: KstestResult(statistic=0.3609578947368421, pvalue=0.0, statistic_location=-0.0016884059, statistic_sign=-1),
                                200000: KstestResult(statistic=0.36185500000000004, pvalue=0.0, statistic_location=-0.0017162114, statistic_sign=-1),
                                210000: KstestResult(statistic=0.36116190476190474, pvalue=0.0, statistic_location=-0.0016977703, statistic_sign=-1),
                                220000: KstestResult(statistic=0.3611363636363636, pvalue=0.0, statistic_location=-0.0016356218, statistic_sign=-1)},
                   'moments': {'mean_error': -0.0010313477,
                               'means': [-0.00023313925, -6.7012315e-06],
                               'stds': [0.0203259, 0.0023825003],
                               'variance_ratio': 76.21503}},
 'originals': {'gan': {'mae': 0.07914682477712631,
                       'mse': 0.05103900656104088,
                       'psnr': 18.142791748046875,
                       'rmse': 0.22591814398765564,
                       'ssim': 0.5751686692237854},
               'pca': {'mae': 0.0027392811607569456,
                       'mse': 3.434914833633229e-05,
                       'psnr': 50.12746047973633,
                       'rmse': 0.0058608148247003555,
                       'ssim': 0.9998654723167419}},
 'reconstructions': {'mae': 0.07888862490653992,
                     'mse': 0.051004838198423386,
                     'psnr': 18.41050148010254,
                     'rmse': 0.22584250569343567,
                     'ssim': 0.5752179622650146},
 'residual_spectra_pcagan': {'cosine': [0.24292065,
                                        0.28649962,
                                        0.22199516,
                                        0.24395901,
                                        0.0427128,
                                        0.011004816,
                                        0.048021667,
                                        0.059529282,
                                        0.031277034,
                                        0.0762599,
                                        0.07184019,
                                        0.055513147,
                                        0.025624465,
                                        0.026452823,
                                        0.03273927,
                                        0.004527035,
                                        0.024918107,
                                        0.018684305,
                                        0.028195994,
                                        0.03539296,
                                        0.030553916,
                                        0.36169752],
                             'mae': [0.010165277,
                                     0.010949777,
                                     0.011338064,
                                     0.011115124,
                                     0.011158696,
                                     0.011213458,
                                     0.011754435,
                                     0.0099143,
                                     0.010787229,
                                     0.01053917,
                                     0.009186664,
                                     0.010174945,
                                     0.010254434,
                                     0.009875668,
                                     0.009535512,
                                     0.025695747,
                                     0.010560313,
                                     0.0128674805,
                                     0.011435594,
                                     0.010993773,
                                     0.011420995,
                                     0.008380466],
                             'max_mae': 0.025695747,
                             'max_mse': 0.0032349876,
                             'max_rmse': 0.05687695,
                             'median_distance': 1.5828948,
                             'median_mae': 0.010868503,
                             'min_cosine': 0.004527035,
                             'mse': [0.00022419705,
                                     0.00034606046,
                                     0.00054245105,
                                     0.0003395685,
                                     0.00031820548,
                                     0.00027170387,
                                     0.00041141626,
                                     0.00022131889,
                                     0.0002475235,
                                     0.00027585946,
                                     0.00018532392,
                                     0.00020152569,
                                     0.0002123272,
                                     0.00021279653,
                                     0.00017638467,
                                     0.0032349876,
                                     0.00021468129,
                                     0.000333443,
                                     0.0002536061,
                                     0.00024419941,
                                     0.00031386942,
                                     0.00018125566],
                             'rmse': [0.014973211,
                                      0.0186027,
                                      0.023290578,
                                      0.018427385,
                                      0.017838314,
                                      0.016483443,
                                      0.0202834,
                                      0.01487679,
                                      0.01573288,
                                      0.016609017,
                                      0.013613373,
                                      0.014195974,
                                      0.014571452,
                                      0.014587547,
                                      0.013280989,
                                      0.05687695,
                                      0.014652006,
                                      0.018260421,
                                      0.015925014,
                                      0.015626881,
                                      0.01771636,
                                      0.013463122]},
 'residuals': {'mae': 0.011332595720887184,
               'mse': 0.0004073956806678325,
               'psnr': 16.449068069458008,
               'rmse': 0.020184045657515526,
               'ssds': [90.90281, 1.2487922],
               'ssim': 0.6082359552383423},
 'spectra_pcagan': {'cosine': [0.9689194,
                               0.98745686,
                               0.97998184,
                               0.98722667,
                               0.9951661,
                               0.9990503,
                               0.9934111,
                               0.995825,
                               0.9978276,
                               0.9987895,
                               0.99670476,
                               0.9971315,
                               0.9985244,
                               0.9972692,
                               0.99887335,
                               -0.6445037,
                               0.9986924,
                               0.9994831,
                               0.9991618,
                               0.99511546,
                               0.0061910697,
                               0.9896424],
                    'mae': [0.035640888,
                            0.045922574,
                            0.032867413,
                            0.034510843,
                            0.019753283,
                            0.015093158,
                            0.021771377,
                            0.018783005,
                            0.018685674,
                            0.014520126,
                            0.015875483,
                            0.017321145,
                            0.015539221,
                            0.01649268,
                            0.014023862,
                            0.9586749,
                            0.015723078,
                            0.014387802,
                            0.014917254,
                            0.022131426,
                            0.34484383,
                            0.028071158],
                    'max_mae': 0.9586749,
                    'max_mse': 0.981004,
                    'max_rmse': 0.99045646,
                    'median_mae': 0.01873434,
                    'min_cosine': -0.6445037,
                    'mse': [0.0017695971,
                            0.0029709833,
                            0.001920614,
                            0.0017800872,
                            0.00066698,
                            0.00038164307,
                            0.0007838843,
                            0.00058781373,
                            0.00056582707,
                            0.000364645,
                            0.0004283,
                            0.00047175447,
                            0.00039172615,
                            0.0004542659,
                            0.0003216278,
                            0.981004,
                            0.0003950672,
                            0.0003331523,
                            0.0003594832,
                            0.0007438583,
                            0.12422303,
                            0.0011882756],
                    'rmse': [0.042066578,
                             0.054506727,
                             0.04382481,
                             0.04219108,
                             0.025825955,
                             0.019535687,
                             0.027997933,
                             0.024244871,
                             0.02378712,
                             0.01909568,
                             0.02069541,
                             0.02171991,
                             0.019792072,
                             0.021313515,
                             0.017933985,
                             0.99045646,
                             0.019876298,
                             0.01825246,
                             0.018960042,
                             0.027273765,
                             0.35245287,
                             0.034471374]},
 'spectra_realgan': {'cosine': [0.9670779,
                                0.9860741,
                                0.9780557,
                                0.98576254,
                                0.9951324,
                                0.99904984,
                                0.99333394,
                                0.9958081,
                                0.9978229,
                                0.9987851,
                                0.99668664,
                                0.997119,
                                0.9985224,
                                0.9972569,
                                0.99887174,
                                -0.6445146,
                                0.9986887,
                                0.99948317,
                                0.99916077,
                                0.99509853,
                                0.0062074484,
                                0.98793983],
                     'mae': [0.03637815,
                             0.046589766,
                             0.034258008,
                             0.035527002,
                             0.019814106,
                             0.015101437,
                             0.021917798,
                             0.018824121,
                             0.018703608,
                             0.0145465825,
                             0.01591582,
                             0.017371297,
                             0.015557705,
                             0.016533125,
                             0.01403136,
                             0.95868224,
                             0.015744971,
                             0.014390492,
                             0.014926642,
                             0.022162866,
                             0.34483668,
                             0.029416403],
                     'max_mae': 0.95868224,
                     'max_mse': 0.9810199,
                     'max_rmse': 0.9904645,
                     'median_mae': 0.018763864,
                     'min_cosine': -0.6445146,
                     'mse': [0.0018786279,
                             0.003143348,
                             0.0020680975,
                             0.0019107206,
                             0.0006701502,
                             0.00038198958,
                             0.00079278264,
                             0.00059007417,
                             0.00056674605,
                             0.0003658877,
                             0.00043069344,
                             0.00047388897,
                             0.0003922547,
                             0.00045585586,
                             0.00032200164,
                             0.9810199,
                             0.0003959071,
                             0.0003332664,
                             0.00035991872,
                             0.0007465519,
                             0.12421874,
                             0.0013407621],
                     'rmse': [0.04334314,
                              0.05606557,
                              0.04547634,
                              0.04371179,
                              0.02588726,
                              0.019544553,
                              0.028156396,
                              0.024291443,
                              0.023806429,
                              0.019128192,
                              0.020753155,
                              0.02176899,
                              0.01980542,
                              0.02135078,
                              0.017944405,
                              0.9904645,
                              0.019897414,
                              0.018255586,
                              0.018971523,
                              0.027323103,
                              0.3524468,
                              0.03661642]},
 'spectra_realpca': {'cosine': [0.99847674,
                                0.998824,
                                0.99803716,
                                0.9984155,
                                0.9999673,
                                0.99999946,
                                0.99996024,
                                0.9999914,
                                0.9999956,
                                0.9999981,
                                0.9999853,
                                0.9999922,
                                0.99999833,
                                0.9999912,
                                0.9999986,
                                0.9999995,
                                0.9999986,
                                0.99999976,
                                0.9999993,
                                0.9999873,
                                0.9999922,
                                0.99826413],
                     'mae': [0.0074146376,
                             0.010388022,
                             0.009796961,
                             0.009648138,
                             0.0015173738,
                             0.00035880055,
                             0.0017127842,
                             0.00085635245,
                             0.0007624932,
                             0.00057763176,
                             0.001079229,
                             0.0008873331,
                             0.00051664386,
                             0.0009520196,
                             0.00048564567,
                             0.0002925843,
                             0.00049963023,
                             0.00026610983,
                             0.00041620564,
                             0.0010616665,
                             0.00071409176,
                             0.010059827],
                     'max_mae': 0.010388022,
                     'max_mse': 0.00018107214,
                     'max_rmse': 0.013456305,
                     'median_mae': 0.0008718428,
                     'min_cosine': 0.99803716,
                     'mse': [8.813668e-05,
                             0.00018107214,
                             0.00015349672,
                             0.00014903209,
                             3.7228592e-06,
                             2.06168e-07,
                             4.745527e-06,
                             1.1743152e-06,
                             9.359567e-07,
                             5.3931393e-07,
                             1.8758602e-06,
                             1.2693209e-06,
                             4.311424e-07,
                             1.4415184e-06,
                             3.828412e-07,
                             1.3796829e-07,
                             4.003562e-07,
                             1.1397997e-07,
                             2.790301e-07,
                             1.811027e-06,
                             8.2593283e-07,
                             0.00016365056],
                     'rmse': [0.009388113,
                              0.013456305,
                              0.01238938,
                              0.012207869,
                              0.0019294713,
                              0.00045405727,
                              0.002178423,
                              0.0010836583,
                              0.0009674485,
                              0.00073438,
                              0.0013696204,
                              0.0011266414,
                              0.0006566144,
                              0.0012006325,
                              0.0006187416,
                              0.00037144084,
                              0.00063273706,
                              0.0003376092,
                              0.000528233,
                              0.001345744,
                              0.0009088085,
                              0.0127925975]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_40/models/GANASTRO/0112_154319/comparison_85.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809
Directory path: experiments/inpainting/gann_4_night_20180901_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_85.0/images
Optimal number of principal components:  40
Reconstruction error:  4.720863
Energy conservation:  0.85786015
saved images in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_85.0/spectra/obs_3
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180901_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9130967822707543, 2.0956914033901506],
                   'kl_div': 1.2108848,
                   'ks_tests': {10000: KstestResult(statistic=0.3215, pvalue=1e-323, statistic_location=-0.0023821266, statistic_sign=-1),
                                20000: KstestResult(statistic=0.31534999999999996, pvalue=0.0, statistic_location=-0.0022890237, statistic_sign=-1),
                                30000: KstestResult(statistic=0.31353333333333333, pvalue=0.0, statistic_location=-0.0024852306, statistic_sign=-1),
                                40000: KstestResult(statistic=0.32175, pvalue=0.0, statistic_location=-0.002289961, statistic_sign=-1),
                                50000: KstestResult(statistic=0.31566, pvalue=0.0, statistic_location=-0.002123952, statistic_sign=-1),
                                60000: KstestResult(statistic=0.3157, pvalue=0.0, statistic_location=-0.002417706, statistic_sign=-1),
                                70000: KstestResult(statistic=0.3163857142857143, pvalue=0.0, statistic_location=-0.0022918312, statistic_sign=-1),
                                80000: KstestResult(statistic=0.31489999999999996, pvalue=0.0, statistic_location=-0.0022294857, statistic_sign=-1),
                                90000: KstestResult(statistic=0.31438888888888894, pvalue=0.0, statistic_location=-0.0022832658, statistic_sign=-1),
                                100000: KstestResult(statistic=0.31683000000000006, pvalue=0.0, statistic_location=-0.0022749323, statistic_sign=-1),
                                110000: KstestResult(statistic=0.3161090909090909, pvalue=0.0, statistic_location=-0.0022709165, statistic_sign=-1),
                                120000: KstestResult(statistic=0.31535833333333335, pvalue=0.0, statistic_location=-0.0024143127, statistic_sign=-1),
                                130000: KstestResult(statistic=0.3164230769230769, pvalue=0.0, statistic_location=-0.0022709165, statistic_sign=-1),
                                140000: KstestResult(statistic=0.3153642857142857, pvalue=0.0, statistic_location=-0.0022724126, statistic_sign=-1),
                                150000: KstestResult(statistic=0.31338, pvalue=0.0, statistic_location=-0.002202034, statistic_sign=-1),
                                160000: KstestResult(statistic=0.31576875, pvalue=0.0, statistic_location=-0.002376536, statistic_sign=-1),
                                170000: KstestResult(statistic=0.3148058823529412, pvalue=0.0, statistic_location=-0.0022921767, statistic_sign=-1),
                                180000: KstestResult(statistic=0.31459444444444445, pvalue=0.0, statistic_location=-0.002197668, statistic_sign=-1),
                                190000: KstestResult(statistic=0.3163263157894737, pvalue=0.0, statistic_location=-0.002288876, statistic_sign=-1),
                                200000: KstestResult(statistic=0.31554, pvalue=0.0, statistic_location=-0.0020114677, statistic_sign=-1),
                                210000: KstestResult(statistic=0.3149857142857143, pvalue=0.0, statistic_location=-0.0022906393, statistic_sign=-1),
                                220000: KstestResult(statistic=0.3153818181818182, pvalue=0.0, statistic_location=-0.0021904167, statistic_sign=-1),
                                230000: KstestResult(statistic=0.3156434782608696, pvalue=0.0, statistic_location=-0.002288876, statistic_sign=-1),
                                240000: KstestResult(statistic=0.31597916666666664, pvalue=0.0, statistic_location=-0.002288876, statistic_sign=-1),
                                250000: KstestResult(statistic=0.31398800000000004, pvalue=0.0, statistic_location=-0.0023998725, statistic_sign=-1),
                                260000: KstestResult(statistic=0.3164730769230769, pvalue=0.0, statistic_location=-0.002164742, statistic_sign=-1),
                                270000: KstestResult(statistic=0.3152111111111111, pvalue=0.0, statistic_location=-0.0021604504, statistic_sign=-1),
                                280000: KstestResult(statistic=0.31446428571428575, pvalue=0.0, statistic_location=-0.0021956747, statistic_sign=-1),
                                290000: KstestResult(statistic=0.3164, pvalue=0.0, statistic_location=-0.0021176394, statistic_sign=-1),
                                300000: KstestResult(statistic=0.3150033333333333, pvalue=0.0, statistic_location=-0.0022862493, statistic_sign=-1),
                                310000: KstestResult(statistic=0.31576774193548385, pvalue=0.0, statistic_location=-0.0022583902, statistic_sign=-1),
                                320000: KstestResult(statistic=0.315778125, pvalue=0.0, statistic_location=-0.0022124546, statistic_sign=-1),
                                330000: KstestResult(statistic=0.3166333333333334, pvalue=0.0, statistic_location=-0.0022888752, statistic_sign=-1)},
                   'moments': {'mean_error': -0.07538599,
                               'means': [-0.00039741758, 4.6275596e-07],
                               'stds': [0.018622587, 0.0027903297],
                               'variance_ratio': 38.762882}},
 'originals': {'gan': {'mae': 0.061107829213142395,
                       'mse': 0.03438354656100273,
                       'psnr': 19.85433006286621,
                       'rmse': 0.18542800843715668,
                       'ssim': 0.6147012114524841},
               'pca': {'mae': 0.003598924959078431,
                       'mse': 4.376417200546712e-05,
                       'psnr': 49.0754280090332,
                       'rmse': 0.006615449674427509,
                       'ssim': 0.9985086917877197}},
 'reconstructions': {'mae': 0.06070539727807045,
                     'mse': 0.03434036299586296,
                     'psnr': 20.128568649291992,
                     'rmse': 0.18531152606010437,
                     'ssim': 0.6156152486801147},
 'residual_spectra_pcagan': {'cosine': [0.27925608,
                                        0.19701411,
                                        0.2371256,
                                        0.22595209,
                                        0.33800146,
                                        0.22167939,
                                        0.27344108,
                                        0.3159873,
                                        0.24197942,
                                        0.24555689,
                                        0.04360043,
                                        0.012931757,
                                        0.053947363,
                                        0.05741421,
                                        0.03863511,
                                        0.07047228,
                                        0.073744915,
                                        0.06377034,
                                        0.027924592,
                                        0.03337969,
                                        0.029457178,
                                        0.0034213753,
                                        0.025161028,
                                        0.02109712,
                                        0.034047958,
                                        0.032366306,
                                        0.036607742,
                                        0.39405644,
                                        0.27744758,
                                        0.17934869,
                                        0.02595765,
                                        0.029944485,
                                        0.01614678],
                             'mae': [0.009069541,
                                     0.008705184,
                                     0.008978487,
                                     0.008976616,
                                     0.008357658,
                                     0.010487955,
                                     0.009707981,
                                     0.010264189,
                                     0.0106428815,
                                     0.0110553475,
                                     0.01083381,
                                     0.010790809,
                                     0.011531825,
                                     0.009585826,
                                     0.010400869,
                                     0.010194695,
                                     0.009105993,
                                     0.009975709,
                                     0.00981686,
                                     0.00966319,
                                     0.009309209,
                                     0.02585625,
                                     0.010322848,
                                     0.012579976,
                                     0.010980288,
                                     0.010768085,
                                     0.01116287,
                                     0.007879147,
                                     0.009576238,
                                     0.011398124,
                                     0.0111925565,
                                     0.011568193,
                                     0.010037471],
                             'max_mae': 0.02585625,
                             'max_mse': 0.0033110233,
                             'max_rmse': 0.057541493,
                             'median_distance': 1.511748,
                             'median_mae': 0.010264189,
                             'min_cosine': 0.0034213753,
                             'mse': [0.00021634524,
                                     0.00016874875,
                                     0.00022106108,
                                     0.00017734084,
                                     0.00014963484,
                                     0.00033453075,
                                     0.00019063699,
                                     0.00028273577,
                                     0.00045106726,
                                     0.00033594162,
                                     0.00028783327,
                                     0.00024526234,
                                     0.00035875107,
                                     0.00019649373,
                                     0.0002272959,
                                     0.00024100528,
                                     0.00018368669,
                                     0.00019334324,
                                     0.00018346979,
                                     0.0001925942,
                                     0.00016852554,
                                     0.0033110233,
                                     0.00020228329,
                                     0.00031590892,
                                     0.00022853818,
                                     0.00023379951,
                                     0.000302555,
                                     0.00014794253,
                                     0.00023863907,
                                     0.00044890947,
                                     0.00027953694,
                                     0.0002729458,
                                     0.00021259584],
                             'rmse': [0.014708679,
                                      0.012990333,
                                      0.014868123,
                                      0.013316939,
                                      0.012232532,
                                      0.018290183,
                                      0.013807136,
                                      0.016814748,
                                      0.021238344,
                                      0.01832871,
                                      0.01696565,
                                      0.015660854,
                                      0.018940724,
                                      0.014017622,
                                      0.0150763355,
                                      0.0155243445,
                                      0.013553106,
                                      0.013904792,
                                      0.013545102,
                                      0.013877831,
                                      0.012981739,
                                      0.057541493,
                                      0.014222633,
                                      0.017773828,
                                      0.0151174795,
                                      0.015290504,
                                      0.017394109,
                                      0.012163162,
                                      0.015447947,
                                      0.021187484,
                                      0.016719358,
                                      0.016521072,
                                      0.014580667]},
 'residuals': {'mae': 0.010629596188664436,
               'mse': 0.0003394237719476223,
               'psnr': 17.241809844970703,
               'rmse': 0.018423456698656082,
               'ssds': [114.495995, 2.5693524],
               'ssim': 0.6100449562072754},
 'spectra_pcagan': {'cosine': [0.9829738,
                               0.98000425,
                               0.98458785,
                               0.98638314,
                               0.9830328,
                               0.9832042,
                               0.9686925,
                               0.98779756,
                               0.98077494,
                               0.9874576,
                               0.99522585,
                               0.99905,
                               0.993333,
                               0.99577993,
                               0.99785256,
                               0.99877524,
                               0.9965843,
                               0.99712723,
                               0.99850166,
                               0.99721766,
                               0.99882525,
                               -0.6458936,
                               0.9986575,
                               0.99946684,
                               0.99916804,
                               0.9948711,
                               0.0073726433,
                               0.98955965,
                               0.97955257,
                               0.97424275,
                               0.9995061,
                               0.99820226,
                               0.9990268],
                    'mae': [0.024053952,
                            0.027698206,
                            0.022895193,
                            0.023939475,
                            0.025533777,
                            0.02639812,
                            0.035851374,
                            0.045757562,
                            0.032553155,
                            0.034551073,
                            0.01933711,
                            0.015150919,
                            0.021861322,
                            0.018815884,
                            0.018530251,
                            0.014644823,
                            0.016014557,
                            0.017265517,
                            0.015684707,
                            0.01659455,
                            0.014267195,
                            0.959195,
                            0.015895441,
                            0.014692703,
                            0.01488931,
                            0.022556728,
                            0.34436134,
                            0.028392706,
                            0.036831494,
                            0.031707726,
                            0.014724949,
                            0.017928738,
                            0.014703664],
                    'max_mae': 0.959195,
                    'max_mse': 0.9814762,
                    'max_rmse': 0.9906948,
                    'median_mae': 0.021861322,
                    'min_cosine': -0.6458936,
                    'mse': [0.0009728485,
                            0.0011507719,
                            0.0009094217,
                            0.0008997469,
                            0.0009722904,
                            0.001180324,
                            0.0017844097,
                            0.0029488201,
                            0.0018811737,
                            0.0018055514,
                            0.000635214,
                            0.0003812255,
                            0.000791677,
                            0.0005884462,
                            0.00055577967,
                            0.000370126,
                            0.0004405711,
                            0.00046859647,
                            0.00039761973,
                            0.00046277128,
                            0.00033537348,
                            0.9814762,
                            0.00040667772,
                            0.00034571288,
                            0.0003588621,
                            0.0007738413,
                            0.123841114,
                            0.0012069737,
                            0.0020554436,
                            0.0015992308,
                            0.00036076593,
                            0.000511294,
                            0.00036310495],
                    'rmse': [0.03119052,
                             0.03392303,
                             0.03015662,
                             0.02999578,
                             0.031181572,
                             0.034355845,
                             0.042242274,
                             0.05430304,
                             0.0433725,
                             0.04249178,
                             0.025203452,
                             0.019524997,
                             0.028136754,
                             0.02425791,
                             0.02357498,
                             0.01923866,
                             0.020989785,
                             0.021647088,
                             0.019940404,
                             0.02151212,
                             0.018313205,
                             0.9906948,
                             0.020166252,
                             0.018593356,
                             0.018943656,
                             0.027818004,
                             0.35191065,
                             0.03474153,
                             0.045337,
                             0.039990384,
                             0.01899384,
                             0.022611812,
                             0.019055312]},
 'spectra_realgan': {'cosine': [0.9811641,
                                0.9792906,
                                0.9832458,
                                0.9857797,
                                0.98146766,
                                0.9815613,
                                0.96684116,
                                0.9864013,
                                0.97883916,
                                0.9860043,
                                0.9951914,
                                0.99904966,
                                0.9932538,
                                0.99576354,
                                0.9978477,
                                0.9987711,
                                0.9965648,
                                0.997114,
                                0.99849933,
                                0.9972057,
                                0.9988238,
                                -0.6459043,
                                0.99865395,
                                0.9994668,
                                0.99916714,
                                0.9948543,
                                0.007388159,
                                0.9878666,
                                0.9783933,
                                0.97260183,
                                0.9995058,
                                0.9981981,
                                0.9990262],
                     'mae': [0.025522947,
                             0.02819045,
                             0.024054067,
                             0.02440607,
                             0.02651521,
                             0.02765656,
                             0.036609575,
                             0.04644784,
                             0.03395891,
                             0.035577275,
                             0.019405777,
                             0.015161348,
                             0.022015996,
                             0.018857317,
                             0.018548695,
                             0.014666641,
                             0.016057838,
                             0.017318564,
                             0.01570102,
                             0.01663056,
                             0.014273242,
                             0.95920235,
                             0.015915673,
                             0.01469433,
                             0.014899037,
                             0.022593604,
                             0.34435415,
                             0.029696887,
                             0.03761045,
                             0.032620132,
                             0.0147280125,
                             0.017950106,
                             0.0147173265],
                     'max_mae': 0.95920235,
                     'max_mse': 0.9814919,
                     'max_rmse': 0.99070275,
                     'median_mae': 0.022015996,
                     'min_cosine': -0.6459043,
                     'mse': [0.0010776088,
                             0.0011927206,
                             0.0009870975,
                             0.000937928,
                             0.0010650444,
                             0.0012817205,
                             0.0018940733,
                             0.0031226252,
                             0.002029156,
                             0.0019350199,
                             0.000638548,
                             0.00038157526,
                             0.0008006529,
                             0.0005906589,
                             0.00055675907,
                             0.0003713099,
                             0.00044307928,
                             0.0004708014,
                             0.00039820833,
                             0.0004643181,
                             0.00033573623,
                             0.9814919,
                             0.00040745622,
                             0.00034584006,
                             0.0003592883,
                             0.0007764925,
                             0.12383691,
                             0.00135845,
                             0.0021697714,
                             0.0016991089,
                             0.0003608172,
                             0.00051253487,
                             0.00036351514],
                     'rmse': [0.032826953,
                              0.034535788,
                              0.031418107,
                              0.03062561,
                              0.03263502,
                              0.035801124,
                              0.043520954,
                              0.055880453,
                              0.045046154,
                              0.04398886,
                              0.025269506,
                              0.01953395,
                              0.028295811,
                              0.024303475,
                              0.023595743,
                              0.019269403,
                              0.02104945,
                              0.021697959,
                              0.019955158,
                              0.021548042,
                              0.018323107,
                              0.99070275,
                              0.020185545,
                              0.018596776,
                              0.018954901,
                              0.027865615,
                              0.3519047,
                              0.036857158,
                              0.046580806,
                              0.041220248,
                              0.01899519,
                              0.022639234,
                              0.019066073]},
 'spectra_realpca': {'cosine': [0.9982769,
                                0.99932367,
                                0.9986835,
                                0.9994152,
                                0.998256,
                                0.9983227,
                                0.99847674,
                                0.998824,
                                0.99803716,
                                0.9984155,
                                0.9999673,
                                0.99999946,
                                0.99996024,
                                0.9999914,
                                0.9999956,
                                0.9999981,
                                0.9999853,
                                0.9999922,
                                0.99999833,
                                0.9999912,
                                0.9999986,
                                0.9999995,
                                0.9999986,
                                0.99999976,
                                0.9999993,
                                0.9999873,
                                0.9999922,
                                0.99826413,
                                0.99840933,
                                0.99861205,
                                0.9999998,
                                0.9999977,
                                0.99999875],
                     'mae': [0.0078069414,
                             0.0049416223,
                             0.00684089,
                             0.0047377516,
                             0.007920729,
                             0.007941159,
                             0.0074146376,
                             0.010388022,
                             0.009796961,
                             0.009648138,
                             0.0015173738,
                             0.00035880055,
                             0.0017127842,
                             0.00085635245,
                             0.0007624932,
                             0.00057763176,
                             0.001079229,
                             0.0008873331,
                             0.00051664386,
                             0.0009520196,
                             0.00048564567,
                             0.0002925843,
                             0.00049963023,
                             0.00026610983,
                             0.00041620564,
                             0.0010616665,
                             0.00071409176,
                             0.010059827,
                             0.009747664,
                             0.0071779657,
                             0.0002417567,
                             0.0006435462,
                             0.00050031237],
                     'max_mae': 0.010388022,
                     'max_mse': 0.00018107214,
                     'max_rmse': 0.013456305,
                     'median_mae': 0.0010616665,
                     'min_cosine': 0.99803716,
                     'mse': [9.777128e-05,
                             3.8947706e-05,
                             7.4940705e-05,
                             3.614457e-05,
                             0.00010040259,
                             0.00010198799,
                             8.813668e-05,
                             0.00018107214,
                             0.00015349672,
                             0.00014903209,
                             3.7228592e-06,
                             2.06168e-07,
                             4.745527e-06,
                             1.1743152e-06,
                             9.359567e-07,
                             5.3931393e-07,
                             1.8758602e-06,
                             1.2693209e-06,
                             4.311424e-07,
                             1.4415184e-06,
                             3.828412e-07,
                             1.3796829e-07,
                             4.003562e-07,
                             1.1397997e-07,
                             2.790301e-07,
                             1.811027e-06,
                             8.2593283e-07,
                             0.00016365056,
                             0.0001548024,
                             8.237977e-05,
                             9.409344e-08,
                             6.624378e-07,
                             4.0279656e-07],
                     'rmse': [0.009887936,
                              0.00624081,
                              0.00865683,
                              0.0060120355,
                              0.010020109,
                              0.010098911,
                              0.009388113,
                              0.013456305,
                              0.01238938,
                              0.012207869,
                              0.0019294713,
                              0.00045405727,
                              0.002178423,
                              0.0010836583,
                              0.0009674485,
                              0.00073438,
                              0.0013696204,
                              0.0011266414,
                              0.0006566144,
                              0.0012006325,
                              0.0006187416,
                              0.00037144084,
                              0.00063273706,
                              0.0003376092,
                              0.000528233,
                              0.001345744,
                              0.0009088085,
                              0.0127925975,
                              0.012441961,
                              0.00907633,
                              0.00030674654,
                              0.0008139028,
                              0.0006346626]}}
saved metrics in experiments/inpainting/gann_4_night_20180901_60/models/GANASTRO/0112_154809/comparison_85.0
Skipping 20180904...
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521
Directory path: experiments/inpainting/gann_4_night_20180904_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_85.0/images
Optimal number of principal components:  43
Reconstruction error:  3.458256
Energy conservation:  0.85857713
saved images in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_85.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9519870688369956, 0.7533011202179051],
                   'kl_div': 2.5952466,
                   'ks_tests': {10000: KstestResult(statistic=0.5111, pvalue=0.0, statistic_location=0.0010192079, statistic_sign=1),
                                20000: KstestResult(statistic=0.5161, pvalue=0.0, statistic_location=0.000890348, statistic_sign=1),
                                30000: KstestResult(statistic=0.5082333333333333, pvalue=0.0, statistic_location=0.000905314, statistic_sign=1),
                                40000: KstestResult(statistic=0.5134000000000001, pvalue=0.0, statistic_location=0.0009107024, statistic_sign=1),
                                50000: KstestResult(statistic=0.5088, pvalue=0.0, statistic_location=0.00090055447, statistic_sign=1),
                                60000: KstestResult(statistic=0.5098666666666667, pvalue=0.0, statistic_location=0.00093824044, statistic_sign=1),
                                70000: KstestResult(statistic=0.508357142857143, pvalue=0.0, statistic_location=0.0009357529, statistic_sign=1),
                                80000: KstestResult(statistic=0.5071625, pvalue=0.0, statistic_location=0.0009006988, statistic_sign=1),
                                90000: KstestResult(statistic=0.5117, pvalue=0.0, statistic_location=0.000890348, statistic_sign=1),
                                100000: KstestResult(statistic=0.51274, pvalue=0.0, statistic_location=0.00093824044, statistic_sign=1),
                                110000: KstestResult(statistic=0.5096454545454545, pvalue=0.0, statistic_location=0.00090030534, statistic_sign=1)},
                   'moments': {'mean_error': 3.7543285,
                               'means': [0.00041185232, -1.7864536e-06],
                               'stds': [0.018056862, 0.0003287744],
                               'variance_ratio': 2552.4194}},
 'originals': {'gan': {'mae': 0.015457476489245892,
                       'mse': 0.0004065860412083566,
                       'psnr': 33.482994079589844,
                       'rmse': 0.02016397938132286,
                       'ssim': 0.9744044542312622},
               'pca': {'mae': 0.00035991508048027754,
                       'mse': 2.644076460001088e-07,
                       'psnr': 65.77725982666016,
                       'rmse': 0.000514205836225301,
                       'ssim': 0.9999908208847046}},
 'reconstructions': {'mae': 0.015452149324119091,
                     'mse': 0.00040634884499013424,
                     'psnr': 33.911006927490234,
                     'rmse': 0.02015809714794159,
                     'ssim': 0.9744076132774353},
 'residual_spectra_pcagan': {'cosine': [0.02531458,
                                        0.030679045,
                                        0.027883768,
                                        0.032908004,
                                        -0.007713974,
                                        0.00092720345,
                                        0.017662518,
                                        0.029896576,
                                        0.025106225,
                                        0.029114924,
                                        0.021551581],
                             'mae': [0.0112598995,
                                     0.013139067,
                                     0.012191817,
                                     0.011823534,
                                     0.013411135,
                                     0.011487971,
                                     0.011103602,
                                     0.010493478,
                                     0.010642837,
                                     0.010408003,
                                     0.010811163],
                             'max_mae': 0.013411135,
                             'max_mse': 0.0005393795,
                             'max_rmse': 0.023224546,
                             'median_distance': 1.7359531,
                             'median_mae': 0.0112598995,
                             'min_cosine': -0.007713974,
                             'mse': [0.00026684778,
                                     0.0004849676,
                                     0.00031821022,
                                     0.00029317875,
                                     0.0005393795,
                                     0.0003019597,
                                     0.00028552837,
                                     0.00025465756,
                                     0.00030135326,
                                     0.00023571911,
                                     0.00030501562],
                             'rmse': [0.016335476,
                                      0.022021981,
                                      0.017838448,
                                      0.017122462,
                                      0.023224546,
                                      0.017376987,
                                      0.016897585,
                                      0.015957994,
                                      0.017359529,
                                      0.015353147,
                                      0.017464697]},
 'residuals': {'mae': 0.011524773202836514,
               'mse': 0.0003260742814745754,
               'psnr': -11.98957633972168,
               'rmse': 0.018057527020573616,
               'ssds': [35.88386, 0.011890432],
               'ssim': 0.2912208139896393},
 'spectra_pcagan': {'cosine': [0.999213,
                               0.99917686,
                               0.99916905,
                               0.9996015,
                               0.99972016,
                               0.99956834,
                               0.99955654,
                               0.9992273,
                               0.99837756,
                               0.99857575,
                               0.998127],
                    'mae': [0.016231796,
                            0.01615042,
                            0.016558673,
                            0.01409855,
                            0.013370706,
                            0.013903228,
                            0.013648282,
                            0.014644051,
                            0.017132608,
                            0.016996067,
                            0.017239261],
                    'max_mae': 0.017239261,
                    'max_mse': 0.0005158821,
                    'max_rmse': 0.022713037,
                    'median_mae': 0.01615042,
                    'min_cosine': 0.998127,
                    'mse': [0.00043029757,
                            0.00046907025,
                            0.00044504277,
                            0.00031662898,
                            0.00032566243,
                            0.0003164994,
                            0.00030634733,
                            0.0003579783,
                            0.0005158821,
                            0.00047695093,
                            0.00050947745],
                    'rmse': [0.020743616,
                             0.02165803,
                             0.021096036,
                             0.01779407,
                             0.01804612,
                             0.017790431,
                             0.017502781,
                             0.018920315,
                             0.022713037,
                             0.021839207,
                             0.022571607]},
 'spectra_realgan': {'cosine': [0.9992128,
                                0.99917656,
                                0.9991683,
                                0.9996012,
                                0.9997203,
                                0.9995683,
                                0.99955654,
                                0.99922675,
                                0.99837565,
                                0.99857485,
                                0.99812585],
                     'mae': [0.016235227,
                             0.016155018,
                             0.016565438,
                             0.014100077,
                             0.013370612,
                             0.013902008,
                             0.013647148,
                             0.014649606,
                             0.017153379,
                             0.017004343,
                             0.017249389],
                     'max_mae': 0.017249389,
                     'max_mse': 0.0005166979,
                     'max_rmse': 0.02273099,
                     'median_mae': 0.016155018,
                     'min_cosine': 0.99812585,
                     'mse': [0.00043044367,
                             0.00046925736,
                             0.0004454207,
                             0.0003167377,
                             0.0003255725,
                             0.00031650756,
                             0.00030635882,
                             0.00035821093,
                             0.0005166979,
                             0.00047749648,
                             0.000509743],
                     'rmse': [0.020747136,
                              0.021662349,
                              0.021104993,
                              0.017797127,
                              0.018043628,
                              0.01779066,
                              0.017503109,
                              0.018926462,
                              0.02273099,
                              0.021851692,
                              0.022577489]},
 'spectra_realpca': {'cosine': [0.99999964,
                                0.99999976,
                                0.99999964,
                                0.9999999,
                                0.9999999,
                                0.99999994,
                                1.0,
                                0.99999934,
                                0.9999978,
                                0.99999887,
                                0.9999969],
                     'mae': [0.00034334615,
                             0.00032952116,
                             0.00033183966,
                             0.00019931085,
                             0.000117734315,
                             0.00018580454,
                             0.00015252983,
                             0.00044547295,
                             0.0006529584,
                             0.00048465433,
                             0.0007158941],
                     'max_mae': 0.0007158941,
                     'max_mse': 8.190352e-07,
                     'max_rmse': 0.00090500567,
                     'median_mae': 0.00033183966,
                     'min_cosine': 0.9999969,
                     'mse': [1.8866483e-07,
                             1.7213702e-07,
                             1.7622585e-07,
                             6.329772e-08,
                             2.2406827e-08,
                             5.576238e-08,
                             3.719776e-08,
                             3.2258177e-07,
                             6.769214e-07,
                             3.7425337e-07,
                             8.190352e-07],
                     'rmse': [0.00043435564,
                              0.000414894,
                              0.00041979263,
                              0.0002515904,
                              0.0001496891,
                              0.0002361406,
                              0.00019286721,
                              0.0005679628,
                              0.0008227523,
                              0.0006117625,
                              0.00090500567]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_20/models/GANASTRO/0112_155521/comparison_85.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743
Directory path: experiments/inpainting/gann_4_night_20180904_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_85.0/images
Optimal number of principal components:  43
Reconstruction error:  3.458256
Energy conservation:  0.85857713
saved images in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_85.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9538435048012626, 1.050211969259981],
                   'kl_div': 2.2699754,
                   'ks_tests': {10000: KstestResult(statistic=0.4362, pvalue=0.0, statistic_location=0.0012738446, statistic_sign=1),
                                20000: KstestResult(statistic=0.4385, pvalue=0.0, statistic_location=0.0012685289, statistic_sign=1),
                                30000: KstestResult(statistic=0.4328333333333334, pvalue=0.0, statistic_location=0.001291645, statistic_sign=1),
                                40000: KstestResult(statistic=0.437175, pvalue=0.0, statistic_location=0.0012656893, statistic_sign=1),
                                50000: KstestResult(statistic=0.43188000000000004, pvalue=0.0, statistic_location=0.0014196889, statistic_sign=1),
                                60000: KstestResult(statistic=0.43118333333333325, pvalue=0.0, statistic_location=0.0012590326, statistic_sign=1),
                                70000: KstestResult(statistic=0.4351285714285714, pvalue=0.0, statistic_location=0.0012930031, statistic_sign=1),
                                80000: KstestResult(statistic=0.432825, pvalue=0.0, statistic_location=0.001270042, statistic_sign=1),
                                90000: KstestResult(statistic=0.43195555555555554, pvalue=0.0, statistic_location=0.0012680031, statistic_sign=1),
                                100000: KstestResult(statistic=0.43199, pvalue=0.0, statistic_location=0.001327388, statistic_sign=1),
                                110000: KstestResult(statistic=0.43433636363636363, pvalue=0.0, statistic_location=0.001336454, statistic_sign=1),
                                120000: KstestResult(statistic=0.4353916666666666, pvalue=0.0, statistic_location=0.0012837099, statistic_sign=1),
                                130000: KstestResult(statistic=0.4320923076923078, pvalue=0.0, statistic_location=0.0013311999, statistic_sign=1),
                                140000: KstestResult(statistic=0.4343785714285714, pvalue=0.0, statistic_location=0.001270042, statistic_sign=1),
                                150000: KstestResult(statistic=0.43656000000000006, pvalue=0.0, statistic_location=0.0012788218, statistic_sign=1),
                                160000: KstestResult(statistic=0.4332625, pvalue=0.0, statistic_location=0.0013365018, statistic_sign=1),
                                170000: KstestResult(statistic=0.43186470588235293, pvalue=0.0, statistic_location=0.0013119862, statistic_sign=1),
                                180000: KstestResult(statistic=0.4354055555555555, pvalue=0.0, statistic_location=0.0013373706, statistic_sign=1),
                                190000: KstestResult(statistic=0.4356052631578947, pvalue=0.0, statistic_location=0.0013695452, statistic_sign=1),
                                200000: KstestResult(statistic=0.43284500000000004, pvalue=0.0, statistic_location=0.0012808833, statistic_sign=1),
                                210000: KstestResult(statistic=0.43251428571428574, pvalue=0.0, statistic_location=0.0013345042, statistic_sign=1),
                                220000: KstestResult(statistic=0.4353818181818182, pvalue=0.0, statistic_location=0.0013290803, statistic_sign=1)},
                   'moments': {'mean_error': 0.27215353,
                               'means': [-0.00020164356, -1.8816023e-06],
                               'stds': [0.016210506, 0.0006464562],
                               'variance_ratio': 881.734}},
 'originals': {'gan': {'mae': 0.02280409075319767,
                       'mse': 0.0012679973151534796,
                       'psnr': 29.031415939331055,
                       'rmse': 0.03560895100235939,
                       'ssim': 0.9156926274299622},
               'pca': {'mae': 0.0007456006715074182,
                       'mse': 1.8404322190690436e-06,
                       'psnr': 57.80451583862305,
                       'rmse': 0.0013566253473982215,
                       'ssim': 0.9999615550041199}},
 'reconstructions': {'mae': 0.02277768775820732,
                     'mse': 0.0012661089422181249,
                     'psnr': 29.429006576538086,
                     'rmse': 0.03558242321014404,
                     'ssim': 0.9156883358955383},
 'residual_spectra_pcagan': {'cosine': [0.026396543,
                                        0.033685107,
                                        0.014733987,
                                        0.012955669,
                                        0.01754448,
                                        0.0155188,
                                        0.037722085,
                                        0.027774625,
                                        0.027297545,
                                        0.00571362,
                                        0.0055345786,
                                        -8.863568e-05,
                                        0.04634963,
                                        0.019009048,
                                        0.016196202,
                                        0.022427658,
                                        0.012890286,
                                        0.0798017,
                                        0.07053485,
                                        0.111362904,
                                        0.04449989,
                                        0.08747372],
                             'mae': [0.009661689,
                                     0.010209842,
                                     0.011320228,
                                     0.0117596835,
                                     0.011306976,
                                     0.010616629,
                                     0.01218916,
                                     0.010807988,
                                     0.011548716,
                                     0.012161033,
                                     0.010563153,
                                     0.011269211,
                                     0.00984875,
                                     0.011242043,
                                     0.012051112,
                                     0.01076254,
                                     0.010347042,
                                     0.010899559,
                                     0.00938908,
                                     0.00940018,
                                     0.011052956,
                                     0.010149369],
                             'max_mae': 0.01218916,
                             'max_mse': 0.0003656276,
                             'max_rmse': 0.019121392,
                             'median_distance': 1.5884743,
                             'median_mae': 0.010853773,
                             'min_cosine': -8.863568e-05,
                             'mse': [0.00019329056,
                                     0.00024661943,
                                     0.00033681997,
                                     0.0002719833,
                                     0.0002986258,
                                     0.00022127967,
                                     0.0003562184,
                                     0.0002332732,
                                     0.0002621386,
                                     0.00034573098,
                                     0.00023087564,
                                     0.00025208408,
                                     0.0001904918,
                                     0.0003656276,
                                     0.0002933747,
                                     0.00025567846,
                                     0.00022157562,
                                     0.00025017644,
                                     0.00016941302,
                                     0.00018459094,
                                     0.00034056758,
                                     0.00025256615],
                             'rmse': [0.013902897,
                                      0.015704121,
                                      0.018352656,
                                      0.016491916,
                                      0.017280793,
                                      0.014875472,
                                      0.01887375,
                                      0.015273284,
                                      0.016190695,
                                      0.018593842,
                                      0.015194592,
                                      0.015877156,
                                      0.013801876,
                                      0.019121392,
                                      0.017128184,
                                      0.015989948,
                                      0.014885416,
                                      0.015816966,
                                      0.013015876,
                                      0.013586425,
                                      0.018454473,
                                      0.01589233]},
 'residuals': {'mae': 0.010843499563634396,
               'mse': 0.00026240915758535266,
               'psnr': -0.8121442794799805,
               'rmse': 0.01619904860854149,
               'ssds': [57.820404, 0.09193959],
               'ssim': 0.33476847410202026},
 'spectra_pcagan': {'cosine': [0.9987414,
                               0.99892586,
                               0.9988633,
                               0.9995552,
                               0.99901843,
                               0.99927974,
                               0.99923664,
                               0.9992917,
                               0.99960256,
                               0.9997594,
                               0.99960375,
                               0.999522,
                               0.99922246,
                               0.9980598,
                               0.9976147,
                               0.9979788,
                               0.96667725,
                               0.9949884,
                               0.9844112,
                               0.98809624,
                               0.9952643,
                               0.9900208],
                    'mae': [0.016756173,
                            0.017763937,
                            0.017113239,
                            0.0138369845,
                            0.016744308,
                            0.01572313,
                            0.015650421,
                            0.015725764,
                            0.013697751,
                            0.011839832,
                            0.012670531,
                            0.013938147,
                            0.015922202,
                            0.018291663,
                            0.025295172,
                            0.018762441,
                            0.12166391,
                            0.022983393,
                            0.029669665,
                            0.023180038,
                            0.020462759,
                            0.023417639],
                    'max_mae': 0.12166391,
                    'max_mse': 0.015765583,
                    'max_rmse': 0.12556107,
                    'median_mae': 0.016934706,
                    'min_cosine': 0.96667725,
                    'mse': [0.00045388512,
                            0.00051494234,
                            0.0005157265,
                            0.0003145025,
                            0.00046687378,
                            0.00039319744,
                            0.00042589198,
                            0.0003948029,
                            0.0003029838,
                            0.00023687696,
                            0.00027307347,
                            0.0003147284,
                            0.0004133444,
                            0.00060912303,
                            0.0010033521,
                            0.0005870953,
                            0.015765583,
                            0.00088922406,
                            0.0013420574,
                            0.0009088087,
                            0.00079312763,
                            0.0009351948],
                    'rmse': [0.02130458,
                             0.022692341,
                             0.022709614,
                             0.017734218,
                             0.021607263,
                             0.019829206,
                             0.02063715,
                             0.019869648,
                             0.01740643,
                             0.015390808,
                             0.016524935,
                             0.017740587,
                             0.020330872,
                             0.024680419,
                             0.031675734,
                             0.024230048,
                             0.12556107,
                             0.029819861,
                             0.036634102,
                             0.030146455,
                             0.028162522,
                             0.030580955]},
 'spectra_realgan': {'cosine': [0.99874014,
                                0.9989248,
                                0.9988631,
                                0.99955505,
                                0.99901754,
                                0.9992794,
                                0.9992361,
                                0.9992909,
                                0.99960226,
                                0.9997594,
                                0.9996037,
                                0.9995222,
                                0.9992211,
                                0.9980584,
                                0.9976143,
                                0.9979762,
                                0.96668136,
                                0.9949567,
                                0.9843088,
                                0.987953,
                                0.9952553,
                                0.98986655],
                     'mae': [0.016758714,
                             0.017771184,
                             0.017113196,
                             0.0138362385,
                             0.016759055,
                             0.015727771,
                             0.015652215,
                             0.015734013,
                             0.013699204,
                             0.011842132,
                             0.012672195,
                             0.013936176,
                             0.01593432,
                             0.018293323,
                             0.025285814,
                             0.018784083,
                             0.12165216,
                             0.023066914,
                             0.02975893,
                             0.023323461,
                             0.020487975,
                             0.02360092],
                     'max_mae': 0.12165216,
                     'max_mse': 0.015763685,
                     'max_rmse': 0.12555352,
                     'median_mae': 0.016936125,
                     'min_cosine': 0.96668136,
                     'mse': [0.00045424566,
                             0.0005153884,
                             0.00051568775,
                             0.00031453185,
                             0.00046755315,
                             0.00039333498,
                             0.0004261225,
                             0.0003952537,
                             0.00030304788,
                             0.00023687884,
                             0.00027312833,
                             0.00031460717,
                             0.00041398086,
                             0.00060951785,
                             0.0010028094,
                             0.00058767566,
                             0.015763685,
                             0.00089402235,
                             0.0013502499,
                             0.00091976335,
                             0.00079526426,
                             0.000949195],
                     'rmse': [0.02131304,
                              0.022702167,
                              0.022708759,
                              0.017735045,
                              0.021622978,
                              0.019832674,
                              0.020642735,
                              0.019880988,
                              0.01740827,
                              0.015390868,
                              0.016526595,
                              0.017737169,
                              0.02034652,
                              0.024688415,
                              0.031667165,
                              0.024242023,
                              0.12555352,
                              0.029900206,
                              0.036745746,
                              0.030327601,
                              0.02820043,
                              0.030809008]},
 'spectra_realpca': {'cosine': [0.9999983,
                                0.9999994,
                                0.99999946,
                                1.0,
                                0.99999934,
                                0.99999964,
                                0.99999976,
                                0.99999964,
                                0.9999999,
                                0.9999999,
                                0.99999994,
                                1.0,
                                0.99999934,
                                0.9999978,
                                0.99999887,
                                0.9999969,
                                0.99999726,
                                0.99997544,
                                0.9999422,
                                0.9998261,
                                0.9999924,
                                0.9998653],
                     'mae': [0.0006001765,
                             0.0004005117,
                             0.00039297357,
                             0.0001904498,
                             0.0003925855,
                             0.00034334615,
                             0.00032952116,
                             0.00033183966,
                             0.00019931085,
                             0.000117734315,
                             0.00018580454,
                             0.00015252983,
                             0.00044547295,
                             0.0006529584,
                             0.00048465433,
                             0.0007158941,
                             0.0006759703,
                             0.0015767588,
                             0.0016724573,
                             0.0028676228,
                             0.0008592308,
                             0.0028154117],
                     'max_mae': 0.0028676228,
                     'max_mse': 1.3103533e-05,
                     'max_rmse': 0.0036198802,
                     'median_mae': 0.00042299234,
                     'min_cosine': 0.9998261,
                     'mse': [5.768945e-07,
                             2.5671216e-07,
                             2.4951663e-07,
                             5.8080076e-08,
                             2.4684124e-07,
                             1.8866483e-07,
                             1.7213702e-07,
                             1.7622585e-07,
                             6.329772e-08,
                             2.2406827e-08,
                             5.576238e-08,
                             3.719776e-08,
                             3.2258177e-07,
                             6.769214e-07,
                             3.7425337e-07,
                             8.190352e-07,
                             7.371906e-07,
                             4.001657e-06,
                             4.48371e-06,
                             1.3103533e-05,
                             1.1835617e-06,
                             1.2683327e-05],
                     'rmse': [0.0007595357,
                              0.0005066677,
                              0.0004995164,
                              0.00024099808,
                              0.0004968312,
                              0.00043435564,
                              0.000414894,
                              0.00041979263,
                              0.0002515904,
                              0.0001496891,
                              0.0002361406,
                              0.00019286721,
                              0.0005679628,
                              0.0008227523,
                              0.0006117625,
                              0.00090500567,
                              0.00085859804,
                              0.0020004143,
                              0.0021174774,
                              0.0036198802,
                              0.0010879162,
                              0.003561366]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_40/models/GANASTRO/0113_112743/comparison_85.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658
Directory path: experiments/inpainting/gann_4_night_20180904_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_85.0/images
Optimal number of principal components:  43
Reconstruction error:  3.458256
Energy conservation:  0.85857713
saved images in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_85.0/spectra/obs_4
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20180904_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9187742426194503, 1.41303059325899],
                   'kl_div': 1.8733274,
                   'ks_tests': {10000: KstestResult(statistic=0.4101, pvalue=0.0, statistic_location=0.001995861, statistic_sign=1),
                                20000: KstestResult(statistic=0.41015, pvalue=0.0, statistic_location=0.0016151071, statistic_sign=1),
                                30000: KstestResult(statistic=0.40593333333333337, pvalue=0.0, statistic_location=0.001941965, statistic_sign=1),
                                40000: KstestResult(statistic=0.40965000000000007, pvalue=0.0, statistic_location=0.0017256339, statistic_sign=1),
                                50000: KstestResult(statistic=0.4115, pvalue=0.0, statistic_location=0.0018051758, statistic_sign=1),
                                60000: KstestResult(statistic=0.4068666666666667, pvalue=0.0, statistic_location=0.0018423405, statistic_sign=1),
                                70000: KstestResult(statistic=0.4072285714285715, pvalue=0.0, statistic_location=0.001691194, statistic_sign=1),
                                80000: KstestResult(statistic=0.40927499999999994, pvalue=0.0, statistic_location=0.0018881853, statistic_sign=1),
                                90000: KstestResult(statistic=0.4080555555555556, pvalue=0.0, statistic_location=0.0018943676, statistic_sign=1),
                                100000: KstestResult(statistic=0.4073500000000001, pvalue=0.0, statistic_location=0.0017844406, statistic_sign=1),
                                110000: KstestResult(statistic=0.4060818181818182, pvalue=0.0, statistic_location=0.0017473055, statistic_sign=1),
                                120000: KstestResult(statistic=0.40865000000000007, pvalue=0.0, statistic_location=0.0018375341, statistic_sign=1),
                                130000: KstestResult(statistic=0.4078923076923078, pvalue=0.0, statistic_location=0.0018427763, statistic_sign=1),
                                140000: KstestResult(statistic=0.4062, pvalue=0.0, statistic_location=0.0018745544, statistic_sign=1),
                                150000: KstestResult(statistic=0.40684, pvalue=0.0, statistic_location=0.0018876065, statistic_sign=1),
                                160000: KstestResult(statistic=0.408875, pvalue=0.0, statistic_location=0.0017729728, statistic_sign=1),
                                170000: KstestResult(statistic=0.40888823529411766, pvalue=0.0, statistic_location=0.0018116822, statistic_sign=1),
                                180000: KstestResult(statistic=0.4090555555555555, pvalue=0.0, statistic_location=0.0018160208, statistic_sign=1),
                                190000: KstestResult(statistic=0.4071473684210527, pvalue=0.0, statistic_location=0.0017988617, statistic_sign=1),
                                200000: KstestResult(statistic=0.40824499999999997, pvalue=0.0, statistic_location=0.0018637904, statistic_sign=1),
                                210000: KstestResult(statistic=0.40729523809523804, pvalue=0.0, statistic_location=0.0019156339, statistic_sign=1),
                                220000: KstestResult(statistic=0.40609090909090917, pvalue=0.0, statistic_location=0.0018841345, statistic_sign=1),
                                230000: KstestResult(statistic=0.40641739130434784, pvalue=0.0, statistic_location=0.0018843175, statistic_sign=1),
                                240000: KstestResult(statistic=0.4074749999999999, pvalue=0.0, statistic_location=0.0017988617, statistic_sign=1),
                                250000: KstestResult(statistic=0.40546800000000005, pvalue=0.0, statistic_location=0.0017988617, statistic_sign=1),
                                260000: KstestResult(statistic=0.4093307692307693, pvalue=0.0, statistic_location=0.001762347, statistic_sign=1),
                                270000: KstestResult(statistic=0.40652222222222223, pvalue=0.0, statistic_location=0.0017985096, statistic_sign=1),
                                280000: KstestResult(statistic=0.40915, pvalue=0.0, statistic_location=0.0018762741, statistic_sign=1),
                                290000: KstestResult(statistic=0.40503448275862064, pvalue=0.0, statistic_location=0.0018424009, statistic_sign=1),
                                300000: KstestResult(statistic=0.4075133333333333, pvalue=0.0, statistic_location=0.0018426246, statistic_sign=1),
                                310000: KstestResult(statistic=0.4073612903225807, pvalue=0.0, statistic_location=0.0017865944, statistic_sign=1),
                                320000: KstestResult(statistic=0.407384375, pvalue=0.0, statistic_location=0.0018754373, statistic_sign=1),
                                330000: KstestResult(statistic=0.40636969696969694, pvalue=0.0, statistic_location=0.0017865944, statistic_sign=1)},
                   'moments': {'mean_error': 0.6066416,
                               'means': [0.00036934364, -1.7279211e-06],
                               'stds': [0.015899327, 0.0012691128],
                               'variance_ratio': 233.53975}},
 'originals': {'gan': {'mae': 0.024684147909283638,
                       'mse': 0.0012824882287532091,
                       'psnr': 30.239980697631836,
                       'rmse': 0.03581184521317482,
                       'ssim': 0.9119897484779358},
               'pca': {'mae': 0.0014780614292249084,
                       'mse': 9.75544116954552e-06,
                       'psnr': 51.83942413330078,
                       'rmse': 0.0031233702320605516,
                       'ssim': 0.9997918605804443}},
 'reconstructions': {'mae': 0.024590160697698593,
                     'mse': 0.001272388850338757,
                     'psnr': 30.685697555541992,
                     'rmse': 0.03567055985331535,
                     'ssim': 0.9117017388343811},
 'residual_spectra_pcagan': {'cosine': [0.14481549,
                                        0.14244503,
                                        0.10470551,
                                        0.019467786,
                                        0.024815505,
                                        0.018760756,
                                        0.028411288,
                                        0.03006524,
                                        0.018351218,
                                        0.010269847,
                                        0.033555813,
                                        0.013506025,
                                        0.030928714,
                                        0.034655277,
                                        0.038567,
                                        -0.012630398,
                                        -0.0044519887,
                                        0.026061427,
                                        0.042876646,
                                        0.039984815,
                                        0.023742976,
                                        0.021231078,
                                        0.025791464,
                                        0.09073841,
                                        0.06354936,
                                        0.104375154,
                                        0.03423775,
                                        0.121175446,
                                        0.09682687,
                                        0.23826449,
                                        0.091644675,
                                        0.037648655,
                                        0.14248842],
                             'mae': [0.0098337075,
                                     0.009102542,
                                     0.00950255,
                                     0.009810976,
                                     0.009386608,
                                     0.011163407,
                                     0.010587895,
                                     0.01145152,
                                     0.012345496,
                                     0.012606134,
                                     0.0110167395,
                                     0.0110027585,
                                     0.011500171,
                                     0.010232898,
                                     0.011367098,
                                     0.011477182,
                                     0.011446707,
                                     0.010751509,
                                     0.0093534915,
                                     0.009786546,
                                     0.008861197,
                                     0.012400114,
                                     0.0099612875,
                                     0.010269005,
                                     0.009619555,
                                     0.009690495,
                                     0.011047493,
                                     0.009142994,
                                     0.010347464,
                                     0.010440066,
                                     0.010229394,
                                     0.010751431,
                                     0.009181067],
                             'max_mae': 0.012606134,
                             'max_mse': 0.00047225968,
                             'max_rmse': 0.021731537,
                             'median_distance': 1.5386984,
                             'median_mae': 0.010347464,
                             'min_cosine': -0.012630398,
                             'mse': [0.00023675928,
                                     0.00017451824,
                                     0.00021338253,
                                     0.00019939573,
                                     0.0001697843,
                                     0.0003093345,
                                     0.00021780925,
                                     0.00029720072,
                                     0.00047225968,
                                     0.0003490458,
                                     0.00028518375,
                                     0.00025782108,
                                     0.00029889535,
                                     0.00020253893,
                                     0.00026325512,
                                     0.00027628528,
                                     0.0002906847,
                                     0.00023331861,
                                     0.00016677911,
                                     0.00018601297,
                                     0.0001463923,
                                     0.0003793718,
                                     0.00019981587,
                                     0.00023784647,
                                     0.00018791444,
                                     0.0002019681,
                                     0.00034275613,
                                     0.00017619839,
                                     0.00025221106,
                                     0.00039401487,
                                     0.00026549064,
                                     0.00023616715,
                                     0.00017232742],
                             'rmse': [0.015386984,
                                      0.013210535,
                                      0.014607619,
                                      0.014120755,
                                      0.01303013,
                                      0.017587908,
                                      0.014758362,
                                      0.017239511,
                                      0.021731537,
                                      0.018682767,
                                      0.016887384,
                                      0.016056808,
                                      0.01728859,
                                      0.014231618,
                                      0.016225139,
                                      0.016621832,
                                      0.017049478,
                                      0.015274771,
                                      0.012914299,
                                      0.0136386575,
                                      0.012099269,
                                      0.01947747,
                                      0.014135624,
                                      0.015422272,
                                      0.013708189,
                                      0.0142115485,
                                      0.018513674,
                                      0.013273974,
                                      0.015881155,
                                      0.019849807,
                                      0.016293883,
                                      0.0153677305,
                                      0.013127354]},
 'residuals': {'mae': 0.010474774055182934,
               'mse': 0.00025129516143351793,
               'psnr': 8.801145553588867,
               'rmse': 0.015852291136980057,
               'ssds': [83.46498, 0.53151304],
               'ssim': 0.3674754798412323},
 'spectra_pcagan': {'cosine': [0.98192686,
                               0.9845711,
                               0.98152775,
                               0.9986957,
                               0.9987663,
                               0.99869674,
                               0.99827814,
                               0.9986752,
                               0.9983835,
                               0.99947125,
                               0.9990587,
                               0.99915826,
                               0.99931765,
                               0.99925834,
                               0.99959487,
                               0.9997632,
                               0.9995595,
                               0.99957716,
                               0.999223,
                               0.9984797,
                               0.9986754,
                               0.99773043,
                               0.9670082,
                               0.99552184,
                               0.9840955,
                               0.9809554,
                               0.9940748,
                               0.9891991,
                               0.9750823,
                               0.9791543,
                               0.9868385,
                               0.98373574,
                               0.982246],
                    'mae': [0.029197846,
                            0.026888344,
                            0.027620904,
                            0.016720036,
                            0.017347746,
                            0.01795511,
                            0.023196839,
                            0.017633881,
                            0.02033115,
                            0.014709683,
                            0.016859235,
                            0.01644515,
                            0.015144033,
                            0.015421346,
                            0.013864937,
                            0.012077037,
                            0.013569222,
                            0.013180804,
                            0.015760584,
                            0.017292019,
                            0.016129162,
                            0.02115275,
                            0.11902578,
                            0.020495735,
                            0.028974194,
                            0.031283244,
                            0.02264166,
                            0.027161028,
                            0.041700676,
                            0.03772763,
                            0.024911188,
                            0.029065613,
                            0.029990748],
                    'max_mae': 0.11902578,
                    'max_mse': 0.015221304,
                    'max_rmse': 0.12337465,
                    'median_mae': 0.02033115,
                    'min_cosine': 0.9670082,
                    'mse': [0.0013873514,
                            0.0011790149,
                            0.0012707803,
                            0.00046975064,
                            0.00048201848,
                            0.0005578286,
                            0.0008043859,
                            0.0005422523,
                            0.0007699701,
                            0.00038405618,
                            0.0004756691,
                            0.00043842822,
                            0.00039227965,
                            0.0003972439,
                            0.00030869636,
                            0.00024372678,
                            0.0003075977,
                            0.0002780593,
                            0.0004086003,
                            0.00048772164,
                            0.00042230473,
                            0.000770314,
                            0.015221304,
                            0.0007276384,
                            0.001271162,
                            0.0014492116,
                            0.0009149332,
                            0.0011309093,
                            0.002425465,
                            0.0023512444,
                            0.0010589571,
                            0.0012928541,
                            0.0013670982],
                    'rmse': [0.037247166,
                             0.034336787,
                             0.035648007,
                             0.021673732,
                             0.02195492,
                             0.023618395,
                             0.028361699,
                             0.023286313,
                             0.027748335,
                             0.019597352,
                             0.021809839,
                             0.020938678,
                             0.019806052,
                             0.019930977,
                             0.017569756,
                             0.015611751,
                             0.017538464,
                             0.01667511,
                             0.020213863,
                             0.02208442,
                             0.020550054,
                             0.027754532,
                             0.12337465,
                             0.026974773,
                             0.035653356,
                             0.03806851,
                             0.030247863,
                             0.033628996,
                             0.049249012,
                             0.048489634,
                             0.03254162,
                             0.03595628,
                             0.036974292]},
 'spectra_realgan': {'cosine': [0.9814204,
                                0.98439974,
                                0.9813833,
                                0.9986947,
                                0.9987653,
                                0.9986954,
                                0.9982772,
                                0.99867445,
                                0.9983834,
                                0.999471,
                                0.9990577,
                                0.9991578,
                                0.9993174,
                                0.99925756,
                                0.99959457,
                                0.9997632,
                                0.99955946,
                                0.9995769,
                                0.99922186,
                                0.9984782,
                                0.99867445,
                                0.9977266,
                                0.9670122,
                                0.9954856,
                                0.9839935,
                                0.9809048,
                                0.9940702,
                                0.98901224,
                                0.9749258,
                                0.97704077,
                                0.98665345,
                                0.9837173,
                                0.98208797],
                     'mae': [0.029629294,
                             0.027003,
                             0.027750785,
                             0.0167254,
                             0.017361425,
                             0.017964417,
                             0.02319914,
                             0.017639283,
                             0.020330032,
                             0.014716296,
                             0.01687634,
                             0.016449705,
                             0.015147087,
                             0.015430002,
                             0.013868349,
                             0.012076452,
                             0.013571252,
                             0.013182431,
                             0.01576733,
                             0.017303549,
                             0.016132932,
                             0.021172913,
                             0.11901753,
                             0.020584933,
                             0.029044148,
                             0.03127594,
                             0.022662243,
                             0.027386032,
                             0.041744586,
                             0.03928635,
                             0.02512869,
                             0.029082114,
                             0.030066917],
                     'max_mae': 0.11901753,
                     'max_mse': 0.015219455,
                     'max_rmse': 0.12336715,
                     'median_mae': 0.020330032,
                     'min_cosine': 0.9670122,
                     'mse': [0.0014245127,
                             0.0011917448,
                             0.001281501,
                             0.000470034,
                             0.00048254547,
                             0.0005583816,
                             0.0008045756,
                             0.0005425536,
                             0.0007698388,
                             0.00038420002,
                             0.0004764589,
                             0.00043860183,
                             0.00039244958,
                             0.0003976793,
                             0.00030883806,
                             0.00024365105,
                             0.00030759853,
                             0.00027814406,
                             0.0004091403,
                             0.00048810476,
                             0.00042271792,
                             0.00077102886,
                             0.015219455,
                             0.0007337855,
                             0.0012792309,
                             0.0014533493,
                             0.00091577874,
                             0.0011496294,
                             0.0024378155,
                             0.0025423882,
                             0.001073351,
                             0.0012943974,
                             0.001378633],
                     'rmse': [0.03774272,
                              0.034521658,
                              0.035798058,
                              0.021680268,
                              0.021966917,
                              0.0236301,
                              0.028365042,
                              0.02329278,
                              0.02774597,
                              0.019601021,
                              0.021827938,
                              0.020942822,
                              0.01981034,
                              0.019941898,
                              0.017573789,
                              0.015609326,
                              0.017538488,
                              0.016677652,
                              0.020227216,
                              0.022093093,
                              0.020560104,
                              0.027767407,
                              0.12336715,
                              0.027088476,
                              0.035766337,
                              0.038122818,
                              0.030261837,
                              0.033906184,
                              0.04937424,
                              0.0504221,
                              0.032762036,
                              0.035977736,
                              0.037129946]},
 'spectra_realpca': {'cosine': [0.99963045,
                                0.9997583,
                                0.9997724,
                                0.999999,
                                0.99999917,
                                0.99999905,
                                0.9999983,
                                0.9999994,
                                0.99999946,
                                1.0,
                                0.99999934,
                                0.99999964,
                                0.99999976,
                                0.99999964,
                                0.9999999,
                                0.9999999,
                                0.99999994,
                                1.0,
                                0.99999934,
                                0.9999978,
                                0.99999887,
                                0.9999969,
                                0.99999726,
                                0.99997544,
                                0.9999422,
                                0.9998261,
                                0.9999924,
                                0.9998653,
                                0.99986774,
                                0.9979667,
                                0.9998274,
                                0.99997985,
                                0.9997221],
                     'mae': [0.004073018,
                             0.0033464718,
                             0.0031487343,
                             0.00047078117,
                             0.00042755672,
                             0.00048680464,
                             0.0006001765,
                             0.0004005117,
                             0.00039297357,
                             0.0001904498,
                             0.0003925855,
                             0.00034334615,
                             0.00032952116,
                             0.00033183966,
                             0.00019931085,
                             0.000117734315,
                             0.00018580454,
                             0.00015252983,
                             0.00044547295,
                             0.0006529584,
                             0.00048465433,
                             0.0007158941,
                             0.0006759703,
                             0.0015767588,
                             0.0016724573,
                             0.0028676228,
                             0.0008592308,
                             0.0028154117,
                             0.0025100925,
                             0.010416528,
                             0.0028964528,
                             0.0010074232,
                             0.0035889542],
                     'max_mae': 0.010416528,
                     'max_mse': 0.00017475533,
                     'max_rmse': 0.013219506,
                     'median_mae': 0.0006001765,
                     'min_cosine': 0.9979667,
                     'mse': [2.6419853e-05,
                             1.786246e-05,
                             1.5816422e-05,
                             3.5614931e-07,
                             2.9129788e-07,
                             3.7978836e-07,
                             5.768945e-07,
                             2.5671216e-07,
                             2.4951663e-07,
                             5.8080076e-08,
                             2.4684124e-07,
                             1.8866483e-07,
                             1.7213702e-07,
                             1.7622585e-07,
                             6.329772e-08,
                             2.2406827e-08,
                             5.576238e-08,
                             3.719776e-08,
                             3.2258177e-07,
                             6.769214e-07,
                             3.7425337e-07,
                             8.190352e-07,
                             7.371906e-07,
                             4.001657e-06,
                             4.48371e-06,
                             1.3103533e-05,
                             1.1835617e-06,
                             1.2683327e-05,
                             9.989604e-06,
                             0.00017475533,
                             1.3480243e-05,
                             1.614777e-06,
                             2.0474117e-05],
                     'rmse': [0.0051400247,
                              0.0042264005,
                              0.0039769867,
                              0.0005967825,
                              0.0005397202,
                              0.0006162697,
                              0.0007595357,
                              0.0005066677,
                              0.0004995164,
                              0.00024099808,
                              0.0004968312,
                              0.00043435564,
                              0.000414894,
                              0.00041979263,
                              0.0002515904,
                              0.0001496891,
                              0.0002361406,
                              0.00019286721,
                              0.0005679628,
                              0.0008227523,
                              0.0006117625,
                              0.00090500567,
                              0.00085859804,
                              0.0020004143,
                              0.0021174774,
                              0.0036198802,
                              0.0010879162,
                              0.003561366,
                              0.0031606336,
                              0.013219506,
                              0.003671545,
                              0.0012707388,
                              0.0045248335]}}
saved metrics in experiments/inpainting/gann_4_night_20180904_60/models/GANASTRO/0113_133658/comparison_85.0
Skipping 20210905...

Running comparison for experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734
Directory path: experiments/inpainting/gann_4_night_20210905_20
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_85.0/images
Optimal number of principal components:  45
Reconstruction error:  2.4844959
Energy conservation:  0.8585239
saved images in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_85.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.8998554886731998, 1.650423901481936],
                   'kl_div': 1.6224215,
                   'ks_tests': {10000: KstestResult(statistic=0.3991, pvalue=0.0, statistic_location=-0.0025530932, statistic_sign=-1),
                                20000: KstestResult(statistic=0.39430000000000004, pvalue=0.0, statistic_location=-0.002448067, statistic_sign=-1),
                                30000: KstestResult(statistic=0.39676666666666666, pvalue=0.0, statistic_location=-0.002226974, statistic_sign=-1),
                                40000: KstestResult(statistic=0.39735000000000004, pvalue=0.0, statistic_location=-0.0023698807, statistic_sign=-1),
                                50000: KstestResult(statistic=0.39178, pvalue=0.0, statistic_location=-0.002210563, statistic_sign=-1),
                                60000: KstestResult(statistic=0.39503333333333335, pvalue=0.0, statistic_location=-0.0023716316, statistic_sign=-1),
                                70000: KstestResult(statistic=0.3936857142857143, pvalue=0.0, statistic_location=-0.0023268303, statistic_sign=-1),
                                80000: KstestResult(statistic=0.391, pvalue=0.0, statistic_location=-0.0024429443, statistic_sign=-1),
                                90000: KstestResult(statistic=0.3949888888888889, pvalue=0.0, statistic_location=-0.0024391282, statistic_sign=-1),
                                100000: KstestResult(statistic=0.39858, pvalue=0.0, statistic_location=-0.002325818, statistic_sign=-1),
                                110000: KstestResult(statistic=0.3941818181818182, pvalue=0.0, statistic_location=-0.002446183, statistic_sign=-1)},
                   'moments': {'mean_error': -0.8909378,
                               'means': [-0.0013864677, 1.8286617e-05],
                               'stds': [0.016771028, 0.001459502],
                               'variance_ratio': 138.20102}},
 'originals': {'gan': {'mae': 0.023048721253871918,
                       'mse': 0.0009046081686392426,
                       'psnr': 30.321165084838867,
                       'rmse': 0.030076704919338226,
                       'ssim': 0.9525943994522095},
               'pca': {'mae': 0.0020839720964431763,
                       'mse': 1.2273450010980014e-05,
                       'psnr': 49.65119552612305,
                       'rmse': 0.003503348445519805,
                       'ssim': 0.9995836615562439}},
 'reconstructions': {'mae': 0.022847944870591164,
                     'mse': 0.0008905922877602279,
                     'psnr': 31.044071197509766,
                     'rmse': 0.029842792078852654,
                     'ssim': 0.9530105590820312},
 'residual_spectra_pcagan': {'cosine': [0.026264995,
                                        0.01181906,
                                        0.02720378,
                                        0.016357556,
                                        0.04079959,
                                        0.033691034,
                                        0.077277325,
                                        0.12994197,
                                        0.17083652,
                                        0.10534505,
                                        0.11792706],
                             'mae': [0.01059657,
                                     0.011936969,
                                     0.010159289,
                                     0.0112383235,
                                     0.011167245,
                                     0.010134365,
                                     0.010518996,
                                     0.0090380125,
                                     0.009782349,
                                     0.010866652,
                                     0.0109543055],
                             'max_mae': 0.011936969,
                             'max_mse': 0.00040674448,
                             'max_rmse': 0.020167908,
                             'median_distance': 1.665325,
                             'median_mae': 0.01059657,
                             'min_cosine': 0.01181906,
                             'mse': [0.00023392586,
                                     0.00037939523,
                                     0.00023645363,
                                     0.00028103712,
                                     0.00040674448,
                                     0.00027733072,
                                     0.00024641296,
                                     0.00017190824,
                                     0.00030214983,
                                     0.00026044415,
                                     0.00029813655],
                             'rmse': [0.015294635,
                                      0.019478071,
                                      0.015377049,
                                      0.016764162,
                                      0.020167908,
                                      0.016653249,
                                      0.015697546,
                                      0.013111378,
                                      0.017382458,
                                      0.016138282,
                                      0.017266631]},
 'residuals': {'mae': 0.010581189766526222,
               'mse': 0.000281267159152776,
               'psnr': 5.369853496551514,
               'rmse': 0.016771022230386734,
               'ssds': [31.150585, 0.23435073],
               'ssim': 0.3108970522880554},
 'spectra_pcagan': {'cosine': [0.99845904,
                               0.99865717,
                               0.99807703,
                               0.99539506,
                               0.99429405,
                               0.99584174,
                               0.9837023,
                               0.98397714,
                               0.9864767,
                               0.98724455,
                               0.9887177],
                    'mae': [0.0177572,
                            0.01756779,
                            0.017661748,
                            0.024942217,
                            0.02357116,
                            0.020204246,
                            0.027497938,
                            0.027384982,
                            0.024044583,
                            0.024649795,
                            0.026045715],
                    'max_mae': 0.027497938,
                    'max_mse': 0.0012281021,
                    'max_rmse': 0.035044286,
                    'median_mae': 0.024044583,
                    'min_cosine': 0.9837023,
                    'mse': [0.00052627583,
                            0.0005386925,
                            0.0005177706,
                            0.001008264,
                            0.0009199681,
                            0.0007259889,
                            0.0012281021,
                            0.0011666334,
                            0.001005962,
                            0.001030562,
                            0.0011282953],
                    'rmse': [0.022940703,
                             0.02320975,
                             0.022754572,
                             0.031753175,
                             0.030330976,
                             0.026944181,
                             0.035044286,
                             0.034156017,
                             0.031716906,
                             0.03210237,
                             0.03359011]},
 'spectra_realgan': {'cosine': [0.99845815,
                                0.99865544,
                                0.9980743,
                                0.99538624,
                                0.9942768,
                                0.9958385,
                                0.9834681,
                                0.9838169,
                                0.9854402,
                                0.98703146,
                                0.9884645],
                     'mae': [0.017761227,
                             0.017582031,
                             0.0176733,
                             0.024944736,
                             0.023610482,
                             0.020209933,
                             0.027730133,
                             0.027510053,
                             0.02518444,
                             0.024926346,
                             0.02640324],
                     'max_mae': 0.027730133,
                     'max_mse': 0.0012458147,
                     'max_rmse': 0.0352961,
                     'median_mae': 0.024926346,
                     'min_cosine': 0.9834681,
                     'mse': [0.00052664767,
                             0.000539212,
                             0.00051849784,
                             0.001009169,
                             0.0009227619,
                             0.00072644174,
                             0.0012458147,
                             0.0011789299,
                             0.0010824356,
                             0.0010481058,
                             0.0011526741],
                     'rmse': [0.022948805,
                              0.02322094,
                              0.022770548,
                              0.03176742,
                              0.030376997,
                              0.026952583,
                              0.0352961,
                              0.03433555,
                              0.03290039,
                              0.03237446,
                              0.033951055]},
 'spectra_realpca': {'cosine': [0.9999991,
                                0.9999992,
                                0.9999964,
                                0.9999872,
                                0.99999094,
                                0.9999953,
                                0.99984646,
                                0.9997199,
                                0.9990004,
                                0.9998612,
                                0.9998672],
                     'mae': [0.00040553918,
                             0.0004451569,
                             0.00076954573,
                             0.0011791036,
                             0.0009568643,
                             0.00069974136,
                             0.0027046215,
                             0.0035881726,
                             0.0067972313,
                             0.0026382583,
                             0.0027394595],
                     'max_mae': 0.0067972313,
                     'max_mse': 7.37127e-05,
                     'max_rmse': 0.0085856095,
                     'median_mae': 0.0011791036,
                     'min_cosine': 0.9990004,
                     'mse': [2.6376196e-07,
                             3.173281e-07,
                             9.460682e-07,
                             2.2125012e-06,
                             1.4556492e-06,
                             7.8478195e-07,
                             1.1653169e-05,
                             2.0561636e-05,
                             7.37127e-05,
                             1.1110256e-05,
                             1.1990108e-05],
                     'rmse': [0.0005135776,
                              0.00056331884,
                              0.0009726604,
                              0.0014874479,
                              0.0012065029,
                              0.0008858792,
                              0.003413674,
                              0.004534494,
                              0.0085856095,
                              0.0033332051,
                              0.0034626734]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_20/models/GANASTRO/0112_184734/comparison_85.0

Running comparison for experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726
Directory path: experiments/inpainting/gann_4_night_20210905_40
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_85.0/images
Optimal number of principal components:  45
Reconstruction error:  2.4844959
Energy conservation:  0.8585239
saved images in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_85.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.9022391383209563, 2.0562357681432246],
                   'kl_div': 1.22127,
                   'ks_tests': {10000: KstestResult(statistic=0.3495, pvalue=0.0, statistic_location=-0.00263053, statistic_sign=-1),
                                20000: KstestResult(statistic=0.34614999999999996, pvalue=0.0, statistic_location=-0.0025686026, statistic_sign=-1),
                                30000: KstestResult(statistic=0.3471, pvalue=0.0, statistic_location=-0.0027409494, statistic_sign=-1),
                                40000: KstestResult(statistic=0.349, pvalue=0.0, statistic_location=-0.0028343815, statistic_sign=-1),
                                50000: KstestResult(statistic=0.34944000000000003, pvalue=0.0, statistic_location=-0.0028394703, statistic_sign=-1),
                                60000: KstestResult(statistic=0.34865, pvalue=0.0, statistic_location=-0.0028341273, statistic_sign=-1),
                                70000: KstestResult(statistic=0.34872857142857144, pvalue=0.0, statistic_location=-0.0027698986, statistic_sign=-1),
                                80000: KstestResult(statistic=0.349625, pvalue=0.0, statistic_location=-0.00258643, statistic_sign=-1),
                                90000: KstestResult(statistic=0.3480111111111111, pvalue=0.0, statistic_location=-0.002669244, statistic_sign=-1),
                                100000: KstestResult(statistic=0.34963, pvalue=0.0, statistic_location=-0.0025669006, statistic_sign=-1),
                                110000: KstestResult(statistic=0.34993636363636366, pvalue=0.0, statistic_location=-0.0025355075, statistic_sign=-1),
                                120000: KstestResult(statistic=0.34718333333333334, pvalue=0.0, statistic_location=-0.0026218798, statistic_sign=-1),
                                130000: KstestResult(statistic=0.34936923076923077, pvalue=0.0, statistic_location=-0.0025981143, statistic_sign=-1),
                                140000: KstestResult(statistic=0.35037142857142856, pvalue=0.0, statistic_location=-0.0026219748, statistic_sign=-1),
                                150000: KstestResult(statistic=0.35004, pvalue=0.0, statistic_location=-0.0025829542, statistic_sign=-1),
                                160000: KstestResult(statistic=0.34785, pvalue=0.0, statistic_location=-0.0024840133, statistic_sign=-1),
                                170000: KstestResult(statistic=0.3512411764705882, pvalue=0.0, statistic_location=-0.00268225, statistic_sign=-1),
                                180000: KstestResult(statistic=0.34746666666666665, pvalue=0.0, statistic_location=-0.0026150085, statistic_sign=-1),
                                190000: KstestResult(statistic=0.3487315789473684, pvalue=0.0, statistic_location=-0.0024812594, statistic_sign=-1),
                                200000: KstestResult(statistic=0.35068499999999997, pvalue=0.0, statistic_location=-0.0025340617, statistic_sign=-1),
                                210000: KstestResult(statistic=0.35023809523809524, pvalue=0.0, statistic_location=-0.002544133, statistic_sign=-1),
                                220000: KstestResult(statistic=0.34920454545454543, pvalue=0.0, statistic_location=-0.0024877787, statistic_sign=-1)},
                   'moments': {'mean_error': -0.5125042,
                               'means': [-0.0014589109, 7.001687e-06],
                               'stds': [0.01597184, 0.002393891],
                               'variance_ratio': 39.425842}},
 'originals': {'gan': {'mae': 0.029288172721862793,
                       'mse': 0.001597895403392613,
                       'psnr': 30.15612030029297,
                       'rmse': 0.03997368365526199,
                       'ssim': 0.8410302996635437},
               'pca': {'mae': 0.003699228633195162,
                       'mse': 4.183735291007906e-05,
                       'psnr': 46.028564453125,
                       'rmse': 0.006468180101364851,
                       'ssim': 0.9975106120109558}},
 'reconstructions': {'mae': 0.02877841331064701,
                     'mse': 0.001556031289510429,
                     'psnr': 30.324018478393555,
                     'rmse': 0.03944656252861023,
                     'ssim': 0.8410078883171082},
 'residual_spectra_pcagan': {'cosine': [0.074729644,
                                        0.04516012,
                                        0.0008558117,
                                        0.023993772,
                                        0.019553151,
                                        0.025419472,
                                        0.006785402,
                                        0.03664995,
                                        0.024828121,
                                        0.051822037,
                                        0.02718425,
                                        0.0950593,
                                        0.14175192,
                                        0.18353775,
                                        0.10532901,
                                        0.1192492,
                                        0.26238465,
                                        0.21651267,
                                        0.30211976,
                                        0.31649125,
                                        0.2433533,
                                        0.22865677],
                             'mae': [0.010200486,
                                     0.010018469,
                                     0.0117614865,
                                     0.0126928715,
                                     0.011144762,
                                     0.009957175,
                                     0.011336515,
                                     0.009648981,
                                     0.010806851,
                                     0.011019268,
                                     0.009467212,
                                     0.009836062,
                                     0.0085304035,
                                     0.009607664,
                                     0.010871026,
                                     0.010544523,
                                     0.008525023,
                                     0.010631281,
                                     0.008612268,
                                     0.00876077,
                                     0.010274481,
                                     0.010990057],
                             'max_mae': 0.0126928715,
                             'max_mse': 0.00040905818,
                             'max_rmse': 0.020225186,
                             'median_distance': 1.6044606,
                             'median_mae': 0.010237483,
                             'min_cosine': 0.0008558117,
                             'mse': [0.00021735406,
                                     0.00026127705,
                                     0.00040905818,
                                     0.00031531483,
                                     0.00029248124,
                                     0.00019941601,
                                     0.00032275857,
                                     0.00019558969,
                                     0.000249318,
                                     0.00034937504,
                                     0.00021709775,
                                     0.00018922728,
                                     0.00013849043,
                                     0.00027217198,
                                     0.00026354822,
                                     0.000264225,
                                     0.00021288404,
                                     0.00025361028,
                                     0.00015253373,
                                     0.00017763322,
                                     0.0003097803,
                                     0.0002747639],
                             'rmse': [0.014742932,
                                      0.016164066,
                                      0.020225186,
                                      0.017757107,
                                      0.017102083,
                                      0.014121474,
                                      0.017965483,
                                      0.013985339,
                                      0.015789807,
                                      0.018691577,
                                      0.014734237,
                                      0.013755991,
                                      0.011768196,
                                      0.016497636,
                                      0.016234169,
                                      0.016254999,
                                      0.0145905465,
                                      0.015925147,
                                      0.012350455,
                                      0.0133279115,
                                      0.017600577,
                                      0.016576003]},
 'residuals': {'mae': 0.010238072834908962,
               'mse': 0.0002517231332603842,
               'psnr': 13.921353340148926,
               'rmse': 0.015865784138441086,
               'ssds': [56.58993, 1.2607623],
               'ssim': 0.35897698998451233},
 'spectra_pcagan': {'cosine': [0.9913247,
                               0.9903006,
                               0.98719424,
                               0.9979639,
                               0.99890125,
                               0.99846524,
                               0.9986056,
                               0.99804395,
                               0.99521434,
                               0.9936754,
                               0.99581146,
                               0.9835444,
                               0.9837395,
                               0.9857522,
                               0.98616624,
                               0.9876463,
                               0.98960716,
                               0.981408,
                               0.99043256,
                               0.99211794,
                               0.987469,
                               0.9864421],
                    'mae': [0.033157635,
                            0.025756933,
                            0.10232215,
                            0.023075521,
                            0.01835773,
                            0.017653877,
                            0.017876752,
                            0.017934946,
                            0.0253561,
                            0.025257671,
                            0.021160152,
                            0.027767248,
                            0.027767448,
                            0.025093226,
                            0.026058387,
                            0.026588697,
                            0.024688654,
                            0.032223552,
                            0.02831981,
                            0.027139118,
                            0.02848261,
                            0.031086994],
                    'max_mae': 0.10232215,
                    'max_mse': 0.011329825,
                    'max_rmse': 0.106441654,
                    'median_mae': 0.02590766,
                    'min_cosine': 0.981408,
                    'mse': [0.0015746325,
                            0.0011087953,
                            0.011329825,
                            0.00086158427,
                            0.00056712644,
                            0.0005194928,
                            0.0005562849,
                            0.0005319038,
                            0.0010308888,
                            0.0010257672,
                            0.0007729027,
                            0.0012384432,
                            0.001188596,
                            0.0010832866,
                            0.00113428,
                            0.0011685276,
                            0.001050366,
                            0.0017231905,
                            0.0013763227,
                            0.0013171023,
                            0.0014425836,
                            0.001630787],
                    'rmse': [0.03968164,
                             0.033298578,
                             0.106441654,
                             0.029352756,
                             0.023814417,
                             0.022792384,
                             0.023585692,
                             0.02306304,
                             0.032107458,
                             0.0320276,
                             0.027801128,
                             0.03519152,
                             0.03447602,
                             0.03291332,
                             0.03367907,
                             0.034183733,
                             0.03240935,
                             0.04151133,
                             0.037098825,
                             0.036291905,
                             0.037981357,
                             0.040383004]},
 'spectra_realgan': {'cosine': [0.9912347,
                                0.99026316,
                                0.9871963,
                                0.99796176,
                                0.99890083,
                                0.99846447,
                                0.99860394,
                                0.99804103,
                                0.99520475,
                                0.9936569,
                                0.9958095,
                                0.98329765,
                                0.9835999,
                                0.984698,
                                0.9859396,
                                0.9873891,
                                0.98822236,
                                0.98030156,
                                0.98952353,
                                0.99124986,
                                0.9861594,
                                0.98525864],
                     'mae': [0.033294223,
                             0.025828766,
                             0.10232119,
                             0.023086667,
                             0.018353976,
                             0.017655889,
                             0.017890586,
                             0.017944146,
                             0.025359493,
                             0.025303021,
                             0.02115929,
                             0.028000534,
                             0.02790281,
                             0.026169525,
                             0.026349448,
                             0.026940206,
                             0.026175488,
                             0.033334527,
                             0.029743722,
                             0.0290685,
                             0.029867712,
                             0.032590088],
                     'max_mae': 0.10232119,
                     'max_mse': 0.011329362,
                     'max_rmse': 0.10643948,
                     'median_mae': 0.026262468,
                     'min_cosine': 0.98030156,
                     'mse': [0.0015887473,
                             0.0011122684,
                             0.011329362,
                             0.0008626093,
                             0.00056718534,
                             0.000519867,
                             0.0005567879,
                             0.0005326666,
                             0.0010319458,
                             0.0010287849,
                             0.0007730675,
                             0.0012570083,
                             0.0011995912,
                             0.0011607567,
                             0.0011529385,
                             0.0011925612,
                             0.0011627872,
                             0.0018270607,
                             0.0015063379,
                             0.001459091,
                             0.0015643693,
                             0.0017679054],
                     'rmse': [0.039859094,
                              0.033350687,
                              0.10643948,
                              0.029370211,
                              0.023815654,
                              0.022800593,
                              0.023596354,
                              0.023079572,
                              0.032123912,
                              0.03207468,
                              0.027804092,
                              0.035454314,
                              0.034635115,
                              0.03406988,
                              0.03395495,
                              0.03453348,
                              0.034099665,
                              0.04274413,
                              0.03881157,
                              0.03819805,
                              0.039552107,
                              0.04204647]},
 'spectra_realpca': {'cosine': [0.9999399,
                                0.99995357,
                                0.9999996,
                                0.99999917,
                                0.99999934,
                                0.9999991,
                                0.9999992,
                                0.9999964,
                                0.9999872,
                                0.99999094,
                                0.9999953,
                                0.99984646,
                                0.9997199,
                                0.9990004,
                                0.9998612,
                                0.9998672,
                                0.9985668,
                                0.9989826,
                                0.99895686,
                                0.99905765,
                                0.99868715,
                                0.99875516],
                     'mae': [0.0021804832,
                             0.0017345387,
                             0.00031127615,
                             0.0004696022,
                             0.00042113065,
                             0.00040553918,
                             0.0004451569,
                             0.00076954573,
                             0.0011791036,
                             0.0009568643,
                             0.00069974136,
                             0.0027046215,
                             0.0035881726,
                             0.0067972313,
                             0.0026382583,
                             0.0027394595,
                             0.008499034,
                             0.007480302,
                             0.009492294,
                             0.009854524,
                             0.008628663,
                             0.009387495],
                     'max_mae': 0.009854524,
                     'max_mse': 0.00015589247,
                     'max_rmse': 0.01248569,
                     'median_mae': 0.0024093706,
                     'min_cosine': 0.9985668,
                     'mse': [7.645023e-06,
                             4.8444053e-06,
                             1.5522039e-07,
                             3.5262852e-07,
                             2.8393615e-07,
                             2.6376196e-07,
                             3.173281e-07,
                             9.460682e-07,
                             2.2125012e-06,
                             1.4556492e-06,
                             7.8478195e-07,
                             1.1653169e-05,
                             2.0561636e-05,
                             7.37127e-05,
                             1.1110256e-05,
                             1.1990108e-05,
                             0.00011699017,
                             9.010248e-05,
                             0.00014749718,
                             0.00015589247,
                             0.00012016795,
                             0.00014148233],
                     'rmse': [0.0027649635,
                              0.002201001,
                              0.00039398018,
                              0.0005938253,
                              0.0005328566,
                              0.0005135776,
                              0.00056331884,
                              0.0009726604,
                              0.0014874479,
                              0.0012065029,
                              0.0008858792,
                              0.003413674,
                              0.004534494,
                              0.0085856095,
                              0.0033332051,
                              0.0034626734,
                              0.0108162,
                              0.009492232,
                              0.012144841,
                              0.01248569,
                              0.010962115,
                              0.011894635]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_40/models/GANASTRO/0112_224726/comparison_85.0

Running comparison for experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/checkpoint-epoch20000.pth...
Experiment directory: experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226
Directory path: experiments/inpainting/gann_4_night_20210905_60
Arguments:
{'device': device(type='cpu'),
 'energy_threshold': 85.0,
 'shape': (58, 10000),
 'source_dir': 'experiments/inpainting/',
 'wl_grid': (4240, 4340, 10000)}
Parameters are loaded.
Data loader is set up.
Skipping 20180708...
Skipping 20180722...
Skipping 20180723...
Skipping 20180901...
Skipping 20180904...
assert real_imgs == generated_imgs: False
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_85.0/images
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_85.0/images
Optimal number of principal components:  45
Reconstruction error:  2.4844959
Energy conservation:  0.8585239
saved images in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_85.0
saved spectra in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_85.0/spectra/obs_5
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_85.0
saved histograms in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_85.0

Metrics for image /projects/data/HARPN/K9_preprocessed_v2/night_20210905_cb4240_ce4340.npz
{'distributions': {'entropies': [3.867696224533345, 1.9807254183622662],
                   'kl_div': 1.2546618,
                   'ks_tests': {10000: KstestResult(statistic=0.3444, pvalue=0.0, statistic_location=-0.0023330115, statistic_sign=-1),
                                20000: KstestResult(statistic=0.3338, pvalue=0.0, statistic_location=-0.002239257, statistic_sign=-1),
                                30000: KstestResult(statistic=0.3367, pvalue=0.0, statistic_location=-0.0025149584, statistic_sign=-1),
                                40000: KstestResult(statistic=0.33544999999999997, pvalue=0.0, statistic_location=-0.0024810825, statistic_sign=-1),
                                50000: KstestResult(statistic=0.33976, pvalue=0.0, statistic_location=-0.0024030376, statistic_sign=-1),
                                60000: KstestResult(statistic=0.3360666666666666, pvalue=0.0, statistic_location=-0.0022222833, statistic_sign=-1),
                                70000: KstestResult(statistic=0.33651428571428577, pvalue=0.0, statistic_location=-0.0024479665, statistic_sign=-1),
                                80000: KstestResult(statistic=0.3342, pvalue=0.0, statistic_location=-0.0023331027, statistic_sign=-1),
                                90000: KstestResult(statistic=0.3361888888888889, pvalue=0.0, statistic_location=-0.0026918054, statistic_sign=-1),
                                100000: KstestResult(statistic=0.33657000000000004, pvalue=0.0, statistic_location=-0.0023750723, statistic_sign=-1),
                                110000: KstestResult(statistic=0.33349090909090906, pvalue=0.0, statistic_location=-0.0023286454, statistic_sign=-1),
                                120000: KstestResult(statistic=0.33653333333333335, pvalue=0.0, statistic_location=-0.002476762, statistic_sign=-1),
                                130000: KstestResult(statistic=0.33576923076923076, pvalue=0.0, statistic_location=-0.002173543, statistic_sign=-1),
                                140000: KstestResult(statistic=0.33397142857142853, pvalue=0.0, statistic_location=-0.0025513424, statistic_sign=-1),
                                150000: KstestResult(statistic=0.3367733333333333, pvalue=0.0, statistic_location=-0.0021734107, statistic_sign=-1),
                                160000: KstestResult(statistic=0.33738124999999997, pvalue=0.0, statistic_location=-0.0024234056, statistic_sign=-1),
                                170000: KstestResult(statistic=0.3368529411764706, pvalue=0.0, statistic_location=-0.0023744432, statistic_sign=-1),
                                180000: KstestResult(statistic=0.3367611111111111, pvalue=0.0, statistic_location=-0.002335499, statistic_sign=-1),
                                190000: KstestResult(statistic=0.33711052631578947, pvalue=0.0, statistic_location=-0.0022745426, statistic_sign=-1),
                                200000: KstestResult(statistic=0.33718, pvalue=0.0, statistic_location=-0.0021992307, statistic_sign=-1),
                                210000: KstestResult(statistic=0.33649523809523807, pvalue=0.0, statistic_location=-0.002392033, statistic_sign=-1),
                                220000: KstestResult(statistic=0.3366363636363636, pvalue=0.0, statistic_location=-0.0023874207, statistic_sign=-1),
                                230000: KstestResult(statistic=0.3364956521739131, pvalue=0.0, statistic_location=-0.0024132729, statistic_sign=-1),
                                240000: KstestResult(statistic=0.33760416666666665, pvalue=0.0, statistic_location=-0.0022736583, statistic_sign=-1),
                                250000: KstestResult(statistic=0.3353, pvalue=0.0, statistic_location=-0.0023292918, statistic_sign=-1),
                                260000: KstestResult(statistic=0.3379115384615385, pvalue=0.0, statistic_location=-0.0024249959, statistic_sign=-1),
                                270000: KstestResult(statistic=0.3385740740740741, pvalue=0.0, statistic_location=-0.0023254692, statistic_sign=-1),
                                280000: KstestResult(statistic=0.33648214285714284, pvalue=0.0, statistic_location=-0.002483368, statistic_sign=-1),
                                290000: KstestResult(statistic=0.3377137931034483, pvalue=0.0, statistic_location=-0.002446672, statistic_sign=-1),
                                300000: KstestResult(statistic=0.33655999999999997, pvalue=0.0, statistic_location=-0.002425231, statistic_sign=-1),
                                310000: KstestResult(statistic=0.3353774193548387, pvalue=0.0, statistic_location=-0.002392033, statistic_sign=-1),
                                320000: KstestResult(statistic=0.3379375, pvalue=0.0, statistic_location=-0.0023825783, statistic_sign=-1),
                                330000: KstestResult(statistic=0.3380121212121212, pvalue=0.0, statistic_location=-0.0022469917, statistic_sign=-1)},
                   'moments': {'mean_error': -0.209104,
                               'means': [-0.00065364566, -5.346155e-06],
                               'stds': [0.015172766, 0.0022909504],
                               'variance_ratio': 40.351482}},
 'originals': {'gan': {'mae': 0.04760230705142021,
                       'mse': 0.01523522287607193,
                       'psnr': 23.570749282836914,
                       'rmse': 0.12343104183673859,
                       'ssim': 0.8455835580825806},
               'pca': {'mae': 0.003412986872717738,
                       'mse': 3.780189945246093e-05,
                       'psnr': 49.999427795410156,
                       'rmse': 0.006148324813693762,
                       'ssim': 0.9967406392097473}},
 'reconstructions': {'mae': 0.047183435410261154,
                     'mse': 0.015198960900306702,
                     'psnr': 23.9564266204834,
                     'rmse': 0.12328406423330307,
                     'ssim': 0.8477097749710083},
 'residual_spectra_pcagan': {'cosine': [0.046008233,
                                        0.010699322,
                                        0.009317551,
                                        0.054631867,
                                        0.035935305,
                                        0.0015073072,
                                        0.084477775,
                                        0.05188928,
                                        0.0026193606,
                                        0.032433365,
                                        0.018531535,
                                        0.02858072,
                                        0.012949032,
                                        0.04428806,
                                        0.025530046,
                                        0.05450898,
                                        0.028482435,
                                        0.09984275,
                                        0.14899403,
                                        0.20585953,
                                        0.11316138,
                                        0.1274475,
                                        0.28298694,
                                        0.23929077,
                                        0.3275025,
                                        0.33187327,
                                        0.24342942,
                                        0.23655175,
                                        0.27263343,
                                        0.12155591,
                                        0.0042350055,
                                        0.25933358,
                                        0.23896605],
                             'mae': [0.008952417,
                                     0.009126317,
                                     0.0082776295,
                                     0.010236971,
                                     0.009088531,
                                     0.010241993,
                                     0.009044651,
                                     0.009382238,
                                     0.01125789,
                                     0.012265972,
                                     0.010847233,
                                     0.009647367,
                                     0.010709493,
                                     0.009150735,
                                     0.0101532405,
                                     0.010319795,
                                     0.009249484,
                                     0.009176088,
                                     0.008029908,
                                     0.008930913,
                                     0.010173388,
                                     0.0100544235,
                                     0.008157648,
                                     0.009881115,
                                     0.008156035,
                                     0.008263257,
                                     0.010011291,
                                     0.010392672,
                                     0.0092115095,
                                     0.010996737,
                                     0.013192074,
                                     0.0107206935,
                                     0.0083321035],
                             'max_mae': 0.013192074,
                             'max_mse': 0.00046047114,
                             'max_rmse': 0.021458592,
                             'median_distance': 1.4693096,
                             'median_mae': 0.009647367,
                             'min_cosine': 0.0015073072,
                             'mse': [0.00018614448,
                                     0.00017917094,
                                     0.00014007743,
                                     0.00026636175,
                                     0.0001653869,
                                     0.00031267773,
                                     0.00017123946,
                                     0.00022258634,
                                     0.00034197132,
                                     0.00029107012,
                                     0.00027400508,
                                     0.00019308791,
                                     0.00027422907,
                                     0.00016984518,
                                     0.00021326348,
                                     0.00030721433,
                                     0.0002079475,
                                     0.00016569538,
                                     0.00012236093,
                                     0.00022530308,
                                     0.00021803394,
                                     0.00024563534,
                                     0.00018137805,
                                     0.00021588706,
                                     0.00013386039,
                                     0.00015239962,
                                     0.00029420914,
                                     0.00024986814,
                                     0.00020133772,
                                     0.00027407723,
                                     0.00046047114,
                                     0.00022259378,
                                     0.00016358569],
                             'rmse': [0.013643477,
                                      0.013385475,
                                      0.011835432,
                                      0.016320594,
                                      0.012860283,
                                      0.017682696,
                                      0.01308585,
                                      0.014919328,
                                      0.018492466,
                                      0.017060777,
                                      0.016553098,
                                      0.013895608,
                                      0.016559863,
                                      0.013032466,
                                      0.014603543,
                                      0.01752753,
                                      0.014420385,
                                      0.012872272,
                                      0.011061687,
                                      0.015010099,
                                      0.014765972,
                                      0.015672758,
                                      0.013467667,
                                      0.014693095,
                                      0.011569805,
                                      0.012345024,
                                      0.017152525,
                                      0.015807219,
                                      0.014189352,
                                      0.016555278,
                                      0.021458592,
                                      0.014919577,
                                      0.012790062]},
 'residuals': {'mae': 0.009746420197188854,
               'mse': 0.00022554468887392431,
               'psnr': 14.398255348205566,
               'rmse': 0.015018145553767681,
               'ssds': [76.11101, 1.7319939],
               'ssim': 0.46680203080177307},
 'spectra_pcagan': {'cosine': [0.99553883,
                               0.9987662,
                               0.99883443,
                               0.99756706,
                               0.998381,
                               0.9977372,
                               0.9921961,
                               0.99019855,
                               0.9875053,
                               0.9980473,
                               0.99888474,
                               0.99843436,
                               0.9986672,
                               0.9981061,
                               0.99540806,
                               0.9941167,
                               0.9958329,
                               0.9841166,
                               0.9833657,
                               0.9865862,
                               0.9867486,
                               0.98840225,
                               0.9893531,
                               0.98296624,
                               0.9907147,
                               0.9922087,
                               0.98713934,
                               0.98669535,
                               0.9877436,
                               0.94890773,
                               0.2205771,
                               0.95268613,
                               0.98764354],
                    'mae': [0.019981097,
                            0.015894303,
                            0.0143910535,
                            0.023832513,
                            0.01648435,
                            0.020234026,
                            0.03125249,
                            0.025825538,
                            0.10156277,
                            0.02278325,
                            0.018386276,
                            0.017775092,
                            0.017517054,
                            0.01756466,
                            0.024617309,
                            0.024150537,
                            0.02082036,
                            0.02727826,
                            0.027758414,
                            0.024044707,
                            0.025205292,
                            0.026248727,
                            0.024106136,
                            0.030513903,
                            0.02817427,
                            0.02689021,
                            0.028208539,
                            0.030626647,
                            0.02670542,
                            0.052564684,
                            0.6607535,
                            0.061191164,
                            0.02371093],
                    'max_mae': 0.6607535,
                    'max_mse': 0.45394278,
                    'max_rmse': 0.6737528,
                    'median_mae': 0.024617309,
                    'min_cosine': 0.2205771,
                    'mse': [0.00068120525,
                            0.00042005492,
                            0.0003550838,
                            0.0008351443,
                            0.00044511099,
                            0.0007177115,
                            0.0013938354,
                            0.0011178951,
                            0.01116068,
                            0.0008356865,
                            0.0005704925,
                            0.0005309794,
                            0.00053409755,
                            0.00051056285,
                            0.000983461,
                            0.0009532009,
                            0.00075406773,
                            0.001198853,
                            0.0012110003,
                            0.0009981855,
                            0.0010663494,
                            0.001137994,
                            0.0010123099,
                            0.0015704836,
                            0.001344605,
                            0.0012929537,
                            0.0014204191,
                            0.0015780522,
                            0.0012618406,
                            0.0037069344,
                            0.45394278,
                            0.005076457,
                            0.0009472745],
                    'rmse': [0.02609991,
                             0.020495242,
                             0.018843668,
                             0.028898863,
                             0.021097654,
                             0.026790138,
                             0.037334107,
                             0.03343494,
                             0.10564412,
                             0.028908243,
                             0.023884986,
                             0.02304299,
                             0.02311055,
                             0.022595638,
                             0.031360183,
                             0.030873952,
                             0.027460294,
                             0.034624457,
                             0.03479943,
                             0.031594075,
                             0.032655008,
                             0.033734165,
                             0.031816818,
                             0.039629325,
                             0.036668856,
                             0.035957664,
                             0.03768845,
                             0.039724704,
                             0.035522394,
                             0.0608846,
                             0.6737528,
                             0.07124926,
                             0.030777825]},
 'spectra_realgan': {'cosine': [0.9955164,
                                0.9987649,
                                0.99883413,
                                0.99756616,
                                0.9983779,
                                0.9977365,
                                0.9921055,
                                0.9901596,
                                0.98750746,
                                0.998045,
                                0.998884,
                                0.99843335,
                                0.99866533,
                                0.99810344,
                                0.9953992,
                                0.99409825,
                                0.99583006,
                                0.9838781,
                                0.9832142,
                                0.9855101,
                                0.9865281,
                                0.9881487,
                                0.9879645,
                                0.981844,
                                0.98978984,
                                0.99135745,
                                0.98583984,
                                0.9855272,
                                0.986517,
                                0.9485304,
                                0.22053947,
                                0.9521743,
                                0.98690134],
                     'mae': [0.02003736,
                             0.015912456,
                             0.01439145,
                             0.023837384,
                             0.016507413,
                             0.02024578,
                             0.03139986,
                             0.025885034,
                             0.101561256,
                             0.022796463,
                             0.018384555,
                             0.017779883,
                             0.017534263,
                             0.017570963,
                             0.024620226,
                             0.024195084,
                             0.020818792,
                             0.02751676,
                             0.027908234,
                             0.025199236,
                             0.025496928,
                             0.026612235,
                             0.025614794,
                             0.03171184,
                             0.029572342,
                             0.028771188,
                             0.029580686,
                             0.032048475,
                             0.028307416,
                             0.052727886,
                             0.6607605,
                             0.061088167,
                             0.024481287],
                     'max_mae': 0.6607605,
                     'max_mse': 0.45395273,
                     'max_rmse': 0.6737601,
                     'median_mae': 0.025496928,
                     'min_cosine': 0.22053947,
                     'mse': [0.00068473973,
                             0.00042061973,
                             0.00035520172,
                             0.000835334,
                             0.00044601268,
                             0.0007178525,
                             0.0014078384,
                             0.0011215287,
                             0.011160203,
                             0.0008367609,
                             0.0005706602,
                             0.0005313679,
                             0.00053463364,
                             0.00051129406,
                             0.0009844217,
                             0.00095619133,
                             0.0007544167,
                             0.0012169371,
                             0.0012226732,
                             0.0010774712,
                             0.0010844683,
                             0.0011621849,
                             0.0011252535,
                             0.0016751633,
                             0.0014775015,
                             0.0014325989,
                             0.0015413836,
                             0.0017134062,
                             0.0013875705,
                             0.0037367907,
                             0.45395273,
                             0.005122695,
                             0.0010044419],
                     'rmse': [0.026167532,
                              0.020509016,
                              0.018846795,
                              0.028902145,
                              0.021119012,
                              0.02679277,
                              0.037521172,
                              0.03348923,
                              0.105641864,
                              0.02892682,
                              0.023888495,
                              0.023051418,
                              0.023122147,
                              0.022611812,
                              0.031375494,
                              0.030922344,
                              0.027466647,
                              0.034884624,
                              0.034966744,
                              0.032824855,
                              0.03293127,
                              0.034090832,
                              0.033544797,
                              0.04092876,
                              0.038438283,
                              0.037849687,
                              0.03926046,
                              0.04139331,
                              0.03725011,
                              0.061129294,
                              0.6737601,
                              0.071573004,
                              0.03169293]},
 'spectra_realpca': {'cosine': [0.99998575,
                                0.9999984,
                                0.9999993,
                                0.9999985,
                                0.9999982,
                                0.99999696,
                                0.9999399,
                                0.99995357,
                                0.9999996,
                                0.99999917,
                                0.99999934,
                                0.9999991,
                                0.9999992,
                                0.9999964,
                                0.9999872,
                                0.99999094,
                                0.9999953,
                                0.99984646,
                                0.9997199,
                                0.9990004,
                                0.9998612,
                                0.9998672,
                                0.9985668,
                                0.9989826,
                                0.99895686,
                                0.99905765,
                                0.99868715,
                                0.99875516,
                                0.9986928,
                                0.99972934,
                                0.9999984,
                                0.9988855,
                                0.99923414],
                     'mae': [0.0011650181,
                             0.0005638092,
                             0.0003893279,
                             0.0004993705,
                             0.00055522635,
                             0.00072832906,
                             0.0021804832,
                             0.0017345387,
                             0.00031127615,
                             0.0004696022,
                             0.00042113065,
                             0.00040553918,
                             0.0004451569,
                             0.00076954573,
                             0.0011791036,
                             0.0009568643,
                             0.00069974136,
                             0.0027046215,
                             0.0035881726,
                             0.0067972313,
                             0.0026382583,
                             0.0027394595,
                             0.008499034,
                             0.007480302,
                             0.009492294,
                             0.009854524,
                             0.008628663,
                             0.009387495,
                             0.009184354,
                             0.0035603424,
                             0.00028991356,
                             0.008274592,
                             0.0060352613],
                     'max_mae': 0.009854524,
                     'max_mse': 0.00015589247,
                     'max_rmse': 0.01248569,
                     'median_mae': 0.0017345387,
                     'min_cosine': 0.9985668,
                     'mse': [2.1608405e-06,
                             5.139298e-07,
                             2.4224298e-07,
                             3.9719865e-07,
                             4.946983e-07,
                             8.5087345e-07,
                             7.645023e-06,
                             4.8444053e-06,
                             1.5522039e-07,
                             3.5262852e-07,
                             2.8393615e-07,
                             2.6376196e-07,
                             3.173281e-07,
                             9.460682e-07,
                             2.2125012e-06,
                             1.4556492e-06,
                             7.8478195e-07,
                             1.1653169e-05,
                             2.0561636e-05,
                             7.37127e-05,
                             1.1110256e-05,
                             1.1990108e-05,
                             0.00011699017,
                             9.010248e-05,
                             0.00014749718,
                             0.00015589247,
                             0.00012016795,
                             0.00014148233,
                             0.00013446038,
                             2.0144793e-05,
                             1.3413988e-07,
                             0.00010926207,
                             5.837977e-05],
                     'rmse': [0.0014699798,
                              0.000716889,
                              0.00049218186,
                              0.000630237,
                              0.00070334796,
                              0.00092242804,
                              0.0027649635,
                              0.002201001,
                              0.00039398018,
                              0.0005938253,
                              0.0005328566,
                              0.0005135776,
                              0.00056331884,
                              0.0009726604,
                              0.0014874479,
                              0.0012065029,
                              0.0008858792,
                              0.003413674,
                              0.004534494,
                              0.0085856095,
                              0.0033332051,
                              0.0034626734,
                              0.0108162,
                              0.009492232,
                              0.012144841,
                              0.01248569,
                              0.010962115,
                              0.011894635,
                              0.0115957055,
                              0.004488295,
                              0.00036625113,
                              0.01045285,
                              0.0076406654]}}
saved metrics in experiments/inpainting/gann_4_night_20210905_60/models/GANASTRO/0112_225226/comparison_85.0
